(this.webpackJsonp=this.webpackJsonp||[]).push([["common~e21604ee"],{"008d473b9e":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NUMBER_FORMAT_TYPE=void 0,function(e){e.GENERAL="auto",e.TEXT="text",e.NUMBER="number",e.PERCENT="percent",e.CURRENCY="currency",e.DATE="date",e.TIME="time",e.DATE_TIME="date-time",e.FRACTION="fraction",e.SCIENTIFIC="scientific",e.ACCOUNTING="accounting",e.SPECIAL="special",e.CUSTOM="custom"}(t.NUMBER_FORMAT_TYPE||(t.NUMBER_FORMAT_TYPE={}))},"03979ee444":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSO_FORMAT_MAP=t.MONTHS=t.DAYS=void 0,t.DAYS=[["Sun","Sunday","星期天","周日"],["Mon","Monday","星期一","周一"],["Tue","Tuesday","星期二","周二"],["Wed","Wednesday","星期三","周三"],["Thu","Thursday","星期四","周四"],["Fri","Friday","星期五","周五"],["Sat","Saturday","星期六","周六"]],t.MONTHS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],t.MSO_FORMAT_MAP={Standard:"#,##0.00",Scientific:"0.00E+00",Percent:"0.00%","Short Date":"yyyy/m/d","Long Date":'yyyy"年"m"月"d"日"',"General Date":"yyyy/m/d hh:mm","Medium Date":"d-mmm-yy","Long Time":"h:mm:ss AM/PM","Medium Time":"h:mm AM/PM","Short Time":"hh:mm",'AM/PMh"时"mm"分"':'上午/下午h"时"mm"分"','AM/PMh"时"mm"分"ss"秒"':'上午/下午h"时"mm"分"ss"秒"',Fixed:"#,##0.00_ ;@"}},"066d34132a":function(e,t,r){var n=r("9b27c0c855"),o=r("3c938bfeff"),i=r("9c64746af9"),a=r("c2e01418c7");e.exports=function(e,t){return n(e)||o(e,t)||i(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},"0774a881b4":function(e,t,r){var n=r("c1e2057026");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},"0c3f2faab4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eval_fmt=void 0;var n=r("b44aa559ae"),o=r("9e693e40c2"),i=r("4cb35c5fee"),a=r("d976dcd8bb"),s=r("6e8701fae0"),c=r("f281127eb3");t.eval_fmt=function(e,t,r,u){var l=new n.Tokenizer(e,t,r,u);l.run();var d=l.getTokenizedResult(),f=d.formatDate,h=d.hourSystemType,m=d.tokenizedList;if(!l.isValid)return[c.INVALID_VALUE,null];var p={formatDate:f,hourSystemType:h,subsecondDecimalNumber:0};if(f){var v=new o.Regulator(m,h);v.run(),p.subsecondDecimalNumber=v.getRegulatedResult()}var _=new i.Parser(t,m,p);_.run();var E=_.getParsedResult(),b=E.parsedNumberString,y=E.outputNumType,T=E.needCutEndPercentageLabel,g=E.numberFormatTokenIndexes,R=E.colorFormat;if(b){var C={parsedNumberString:b,needCutEndPercentageLabel:T,numberFormatTokenIndexes:g,formatListLength:r};s.calculateNumberFormat(t,m,C)}return y!==c.NumberLanguageCaseType.Default&&a.numberTransfer(m,y),[m.reduce((function(e,t){return null!==t?e+t.value:e}),""),R]}},"1da623efac":function(e,t,r){"use strict";var n=r("0774a881b4"),o=r.n(n),i=r("dfc6e2583a"),a=r.n(i),s=r("edd91f1601"),c=r.n(s),u=r("c1e2057026"),l=r.n(u),d=r("ea5c19bfd3"),f=new(function(){function e(){a()(this,e),l()(this,"options",{ignoreDomainDetect:!1,ignoreHosts:[d.a]})}return c()(e,[{key:"register",value:function(e){e&&(this.options.ignoreDomainDetect=!!e.ignoreDomainDetect,this.options=o()(o()({},this.options),e))}},{key:"getOptions",value:function(){return this.options}}]),e}());t.a=f},"1dd43b336f":function(e,t,r){"use strict";(function(e){r.d(t,"c",(function(){return i})),r.d(t,"f",(function(){return a})),r.d(t,"d",(function(){return c})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"e",(function(){return f})),r.d(t,"g",(function(){return h}));r("ea5c19bfd3");var n=r("f293d5439a"),o=r("1da623efac");function i(t,r){var n=function(e){if("string"==typeof e)return e;return e.search}(r||e.location||"").match(new RegExp("(\\?|&)".concat(t,"=([^&]*)(#|&|$)")));return n?decodeURIComponent(n[2]):""}function a(e,t){var r=e.split("?");if(r.length>=2){for(var n="".concat(encodeURIComponent(t),"="),o=r[1].split(/[&]/g),i=o.length;i-- >0;)-1!==o[i].lastIndexOf(n,0)&&o.splice(i,1);return e=r[0]+(o.length>0?"?".concat(o.join("&")):"")}return e}function s(e){return e.startsWith("https://docs.qq.com/scenario/link.html")||e.startsWith("https://doc.weixin.qq.com/scenario/link.html")}function c(e){return/\.qq\.com/.test(e)}function u(e){return c(e)?e.replace(/^(http:)?\/\//i,"https://"):e}function l(e,t,r){var n=(t||{}).ignoreDomainDetect,o=function(e,t){var r=t||{},n=r.ignoreHosts,o=!1;if(n){var i=location.host;o=n.includes(i)}return o}(0,t),i=!c(e)&&!s(e),a=!c(e)&&!s(e);return(o||null!=r&&r.ignoreDomainDetect||n)&&(i=!1),(i||a)&&n||(a=!1),{needRedirect:i,needOpenPanel:a}}function d(e,t){var r=location.host,i=Object(n.l)(e);if(!i)return null;var a=o.a.getOptions();i=u(e);var s=l(e,a,t),c=s.needRedirect,d=s.needOpenPanel;if(c){i="https://".concat(r,"/scenario/link.html?url=").concat(encodeURIComponent(i));var f=window.clientVars;f&&(i="".concat(i,"&pid=").concat(f.globalPadId,"&cid=").concat(f.creatorId))}return(null==t?void 0:t.noUserIndex)||(i=Object(n.g)(i)),{url:i,callback:d?a.ignoreDomainDetectCallback:void 0}}function f(e,t){var r=location.host,i=Object(n.l)(e);if(!i)return null;var a=o.a.getOptions();if(i=u(e),function(e,t){return(!c(e)||s(e))&&!(null!=t&&t.ignoreDomainDetect)}(e,a)){i="https://".concat(r,"/scenario/link.html?url=").concat(encodeURIComponent(i));var l=window.clientVars;l&&(i="".concat(i,"&pid=").concat(l.globalPadId,"&cid=").concat(l.creatorId))}return(null==t?void 0:t.noUserIndex)||(i=Object(n.g)(i)),i}function h(e){if(e.href!==location.href||"_self"!==e.target){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}else location.reload()}}).call(this,r("5ef37df1a0"))},"36c2825c3b":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpperChineseNumberString=t.LowerChineseNumberString=t.NumberLanguageCaseType=void 0,function(e){e.Default="0",e.ChineseLowerCase="1",e.ChineseUpperCase="2"}(t.NumberLanguageCaseType||(t.NumberLanguageCaseType={})),t.LowerChineseNumberString={cnNums:["〇","一","二","三","四","五","六","七","八","九"],cnIntRadice:["","十","百","千"],cnIntUnits:["","万","亿","兆"]},t.UpperChineseNumberString={cnNums:["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],cnIntRadice:["","拾","佰","仟"],cnIntUnits:["","万","亿","兆"]}},"3c938bfeff":function(e,t){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},"46d006027f":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dropTrailingZero=t.getGeneralFloatValueGreaterThan10=t.getGeneralFloatValueLessThan10=t.generalFormatFloat=t.generalFormat=t.isGeneral=void 0;var n=r("6a2a1748de"),o=r("f50ba37686");function i(e){var t=Math.floor(n.mathLog10(Math.abs(e)));return c(t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?a(e):10===t?e.toFixed(10).substr(0,12):s(e))}function a(e){var t=e<0?12:11,r=c(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}function s(e){var t=e<0?12:11,r=e.toFixed(11).replace(/\.(\d*[1-9])0+$/,".$1");return r.length>t&&(r=e.toPrecision(6)),r}function c(e){var t=/(?:\.0*|(\.\d+?)0+)$/;if(/[Ee]/.test(e)){var r=e.split(/[Ee]/),n=r[0],o=r[1];return(n=/\./.test(n)?n.replace(t,"$1"):n)+"E"+(o=o.replace(/([+-])(\d)$/,"$10$2"))}return/\./.test(e)?e.replace(t,"$1"):e}t.isGeneral=function(e,t){return void 0===t&&(t=0),e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))},t.generalFormat=function(e){if(o.isNumeric(e)&&!/\n/.test(String(e))){var t=Number(e);return t===1/0||t===-1/0?String(e):(0|t)===t?String(t):i(t)}return String(e)},t.generalFormatFloat=i,t.getGeneralFloatValueLessThan10=a,t.getGeneralFloatValueGreaterThan10=s,t.dropTrailingZero=c},"48edcd5139":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NUMBER_FORMAT_NAME=t.RESERVED_NUMBER_FORMAT_NUM=t.INVALID_VALUE=t.DEFAULT_FORMAT=t.DEFAULT_FORMAT_PATTERN=void 0;var n="General";t.DEFAULT_FORMAT_PATTERN=n;var o={id:0,pattern:n};t.DEFAULT_FORMAT=o;t.INVALID_VALUE="#INVALID_DATE!";var i;t.RESERVED_NUMBER_FORMAT_NUM=164,function(e){e.GENERAL="auto",e.TEXT="text",e.NUMBER="number",e.PERCENT="percent",e.CURRENCY="currency",e.DATE="date",e.TIME="time",e.DATE_TIME="date-time",e.FRACTION="fraction",e.SCIENTIFIC="scientific",e.ACCOUNTING="accounting",e.SPECIAL="special",e.CUSTOM="custom"}(i||(i={}));var a=[{type:i.GENERAL,name:"常规"},{type:i.TEXT,name:"文本"},{type:i.NUMBER,name:"数值"},{type:i.PERCENT,name:"百分比"},{type:i.SCIENTIFIC,name:"科学记数"},{type:i.CURRENCY,name:"货币"},{type:i.TIME,name:"时间"},{type:i.DATE,name:"日期"},{type:i.DATE_TIME,name:"日期"},{type:i.ACCOUNTING,name:"会计专用"},{type:i.FRACTION,name:"分数"},{type:i.SPECIAL,name:"特殊"},{type:i.CUSTOM,name:"自定义"}];t.NUMBER_FORMAT_NAME=a},"4cb35c5fee":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;var n=r("f281127eb3"),o=r("55c6175634"),i=function(){function e(e,t,r){this.currentIndex=0,this.isNumberStringContainsFraction=!1,this.parsedNumberString="",this.outputNumberType=n.NumberLanguageCaseType.Default,this.needCutEndPercentageLabel=!1,this.numberFormatTokenIndexes=[],this.colorFormat=null,this.value=e,this.tokenizedList=t,this.formatDate=null==r?void 0:r.formatDate,this.subsecondDecimalNumber=null==r?void 0:r.subsecondDecimalNumber}return e.prototype.run=function(){for(;this.currentIndex<this.tokenizedList.length;this.currentIndex++)switch(this.currentToken=this.tokenizedList[this.currentIndex],this.currentTokenType=this.currentToken.type,this.currentTokenValue=this.currentToken.value,this.currentTokenType){case n.TokenType.Text:case n.TokenType.TextPlaceholder:case n.TokenType.Space:case n.TokenType.Digit:break;case n.TokenType.SpecialStartGenesis:this.handleSpecialStartGenesis();break;case n.TokenType.Day:case n.TokenType.Month:case n.TokenType.Year:case n.TokenType.HalfDayHours:case n.TokenType.FullDayHours:case n.TokenType.Minute:case n.TokenType.Second:case n.TokenType.Era:case n.TokenType.BuddhistYear:case n.TokenType.AbsoluteTime:case n.TokenType.Week:this.handleDateTimeRelated();break;case n.TokenType.Number:case n.TokenType.LeftParenthesis:case n.TokenType.QuestionMark:this.handleNumeralRelated();break;case n.TokenType.General:this.handleGeneral();break;case n.TokenType.ChineseNumber:this.handleNumberType();break;case n.TokenType.Color:this.handleColor()}},e.prototype.getParsedResult=function(){return{parsedNumberString:this.parsedNumberString,outputNumType:this.outputNumberType,needCutEndPercentageLabel:this.needCutEndPercentageLabel,numberFormatTokenIndexes:this.numberFormatTokenIndexes,colorFormat:this.colorFormat}},e.prototype.handleSpecialStartGenesis=function(){this.currentToken.value="",this.currentToken.type=n.TokenType.Empty},e.prototype.handleDateTimeRelated=function(){this.currentTokenValue&&(this.currentToken.value=o.write_date(this.currentTokenType.charCodeAt(0),this.currentTokenValue,this.convertFormatDate(),this.subsecondDecimalNumber),this.currentToken.type=n.TokenType.Text)},e.prototype.handleNumeralRelated=function(){var e=this.currentIndex+1;if(this.currentTokenType===n.TokenType.Number&&"%"===this.currentTokenValue)return this.parsedNumberString+=this.currentTokenValue,void(this.needCutEndPercentageLabel=!0);for(;this.isTokenTypeNumber(e);)this.currentToken.value+=String(this.tokenizedList[e].value),this.tokenizedList[e]={value:"",type:n.TokenType.Empty},e+=1;this.isIncludedParsedNumberString(e)?(this.parsedNumberString+=this.tokenizedList[this.currentIndex].value,this.numberFormatTokenIndexes.push(this.currentIndex),this.currentIndex=e-1,this.tokenizedList[this.currentIndex].value=String(this.tokenizedList[this.currentIndex].value).replace(/([0#?]+),+$/,"$1")):this.currentIndex=e-1},e.prototype.handleNumberType=function(){this.outputNumberType=String(this.currentTokenValue).replace(/\[DBNum(\d)\]/,"$1"),this.currentToken.type=n.TokenType.Text,this.currentToken.value=""},e.prototype.handleGeneral=function(){this.currentToken.type=n.TokenType.Text,this.currentToken.value=o.general_fmt(this.value)},e.prototype.handleColor=function(){this.colorFormat=this.currentToken.value,this.currentToken.type=n.TokenType.Text,this.currentToken.value=""},e.prototype.isTokenTypeNumber=function(e){if(!this.tokenizedList[e])return!1;var t=this.tokenizedList[e].type,r=this.tokenizedList[e].value;if(t===n.TokenType.QuestionMark)return!0;if(t===n.TokenType.Digit&&this.isNumberStringContainsFraction)return!0;if(this.currentTokenType===n.TokenType.LeftParenthesis&&(t===n.TokenType.Space||t===n.TokenType.Number||t===n.TokenType.RightParenthesis))return!0;if(!this.tokenizedList[e+1])return!1;var o=this.tokenizedList[e+1].type,i=this.tokenizedList[e+1].value;return t===n.TokenType.Text&&"/"===r?(this.isNumberStringContainsFraction=!0,!0):t===n.TokenType.Space&&o===n.TokenType.QuestionMark||!(t!==n.TokenType.Space&&t!==n.TokenType.Text||!(o===n.TokenType.QuestionMark||o===n.TokenType.Text&&"/"===i||this.isNumberStringContainsFraction&&o===n.TokenType.Digit))},e.prototype.isIncludedParsedNumberString=function(e){var t;if(this.currentTokenType===n.TokenType.LeftParenthesis&&"("===this.tokenizedList[this.currentIndex].value){if(e===this.tokenizedList.length)return!1;if((null===(t=this.tokenizedList[e])||void 0===t?void 0:t.type)!==n.TokenType.Number)return!1}return!0},e.prototype.convertFormatDate=function(){var e=this;if(!this.formatDate)return null;var t={date:"D",time:"T",subsecond:"u",year:"y",month:"m",day:"d",hour:"H",minute:"M",second:"S",week:"q"};return Object.keys(this.formatDate).reduce((function(r,n){return r[t[n]]=e.formatDate[n],r}),{})},e}();t.Parser=i},"555963f6e7":function(e,t){function r(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,c,"next",e)}function c(e){r(a,o,i,s,c,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},"55c6175634":function(e,t,r){"use strict";(function(e){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrencySymbol=t.getNumberFormatByOldFormat=t.getCurrentCellDotNum=t.modifyFormat=t.decreaseDecimalFormat=t.increaseDecimalFormat=t.getNumberFormatByFormatCode=t.getCellNumberFormatType=t.format2TypeMapping=t.txSheetToMsoFormatMapping=t.isDateCell=t.isFractionFormat=t.isTextCell=t.isGeneralCell2=t.isGeneralCell=t.isDateTimeCell=t.clearQuotationMask=t.isBuildInSpecialFormat=t.getFormatType=t.getFormatCodeByNumberFormat=t.getNumberFormatNameByType=t.getDefaultNumberFormat=t.getColorByFormat=t.isColorFormat=t.checkNumericValue=t.write_num=t.write_date=t.general_fmt=t.parse_date_code=void 0;var o=r("f50ba37686"),i=r("69672a4655"),a=n(r("24d5b39d83")),s=n(r("d292a8cd59")),c=r("008d473b9e"),u=n(r("6ab9983a4e"));function l(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,c=0,u=1,l=0,d=0,f=Math.floor(i);l<t&&(c=(f=Math.floor(i))*s+a,d=f*l+u,!(i-f<5e-8));)i=1/(i-f),a=s,s=c,u=l,l=d;if(d>t&&(l>t?(d=u,c=a):(d=l,c=s)),!r)return[0,n*c,d];var h=Math.floor(n*c/d);return[o.getRealNumValueStr(""+h),n*c-h*d,d]}t.parse_date_code=function(e,t,r){if(e>=2958466||e<0)return null;var n=0|e,o=Math.floor(86400*(e-n)),i=0,a=[],s={D:n,T:o,u:86400*(e-n)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),(null==t?void 0:t.date1904)&&(n+=1462),s.u>=.95&&(s.u=0,86400===(o+=1)&&(s.T=o=0,n+=1,s.D+=1)),60===n)a=r?[1317,10,29]:[1900,3,1],i=4;else if(0===n)a=r?[1317,8,29]:[1900,1,0],i=6;else{var c=n,u=new Date(1900,0,1);u.setDate(c),a=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=0)}return s.y=a[0],s.m=a[1],s.d=a[2],s.S=o%60,o=Math.floor(o/60),s.M=o%60,o=Math.floor(o/60),s.H=o,s.q=i,s};var d=function(){var e=/\.(\d*[1-9])0+$/,t=/\.0*$/,r=/(\.\d*[1-9])(0+)([Ee])/,n=/\.0*[Ee]/,o=/(E[+-])(\d)$/;function i(r){return r.indexOf(".")>-1?r.replace(t,"").replace(e,".$1"):r}return function(t){var a,s=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return a=s>=-4&&s<=-1?t.toPrecision(10+s):Math.abs(s)<=9?function(e){var t=e<0?12:11,r=i(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(t):10===s?t.toFixed(10).substr(0,12):function(t){var r=t.toFixed(11).replace(e,".$1");return r.length>(t<0?12:11)&&(r=t.toPrecision(6)),r}(t),i(function(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(r,"$1$3").replace(n,"E").replace("e","E").replace(o,"$10$2");return e}(a))}}();function f(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}function h(e){var t=e.indexOf(".");return-1!==t?f(e.substr(0,t))+e.substr(t):f(e)}function m(e){return e?e.split("").reverse().join(""):""}function p(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}function v(e,t){function r(e){var t="";e=e||"";for(var r=0;r<e.length;r++)switch(e.charAt(r)){case"0":t+="0";break;case"?":t+=" "}return t}var n=t&&t.length||0;"number"==typeof e&&(e=e.toString()),-1!==e.toUpperCase().indexOf("E")&&(e=o.getRealNumValueStr(e));var i=e.length,a=e.indexOf(".");if(-1===a)e=e+"."+r(t);else if(i-a-1<=n)e+=r(t.substr(i-a-1));else if(i-a-1>n){i=(e=e.substr(0,a+1+n+1)).length;var s=e.substr(-1);if(parseInt(s)>=5){for(var c=!0,u=i-2,l="";u>=0;){var d=e.charAt(u);"."===d?l=d+l:c?9===parseInt(d)?(l="0"+l,c=!0):(l=parseInt(d)+1+l,c=!1):(l=d+l,c=!1),u--}c&&(l="1"+l),0===n&&-1===e.indexOf(".")&&l.length===i&&(l=l.substr(1)),(e=l).length<i-1&&(e=o.fill("0",i-e.length-1)+e)}else e=e.substr(0,e.length-1)}return e.toString()}function _(e){return"number"==typeof e?e:parseFloat(e)}function E(e){return"number"==typeof e?-e:e.slice(1)}t.general_fmt=function(e){if(o.isNumeric(e)&&!/\n/.test(e)){var t=Number(e);return t===1/0||t===-1/0?e:(0|t)===t?function(e){return e.toString(10)}(t):d(t)}return e},t.write_date=function(e,t,r,n){var a,s="",c=0,u=0,l=r.y,d=0;switch(e){case 97:if("aaaa"===t)return i.DAYS[r.q][2];if("aaa"===t)return i.DAYS[r.q][3];break;case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,d=2;break;default:a=l%1e4,d=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,d=t.length;break;case 3:return i.MONTHS[r.m-1][1];case 5:return i.MONTHS[r.m-1][0];default:return i.MONTHS[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,d=t.length;break;case 3:return i.DAYS[r.q][0];default:return i.DAYS[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(n||(n=0),u=n>=2?3===n?1e3:100:1===n?10:1,(c=Math.round(u*(r.S+r.u)))>=60*u&&(c=0),"s"===t?0===c?"0":""+c/u:(s=o.pad0(c,2+n),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):o.pad0(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=3===t.length?1:2;break;case 101:a=l,d=1}return d>0?o.pad0(a,d):""},t.write_num=function(){var e=/%/g;function r(r,n,i){var a=n.replace(e,""),s=n.length-a.length;return t.write_num(r,a,function(e,t){-1===e.indexOf("e")&&-1===e.indexOf("E")||(e=o.getRealNumValueStr(e));var r,n=e.indexOf(".");if(-1!==n){var i=e.slice(0,n),a=e.slice(n+1);r=i,r=(r+=a.substr(0,t)).replace(/^([+-])?(0*)([\d]+)/,"$1$3"),a.length>t?(r+=".",r+=a.substr(t)):r+=o.fill("0",t-a.length)}else r=e+o.fill("0",t);return r}(i.toString(),2*s))+o.fill("%",s)}function n(e,t){if(!isNaN(t)&&t<0)return"-"+n(e,-t);var r,i=(e=e.toUpperCase()).indexOf("E")-e.indexOf(".")-1,s=e.match(/^(#+0).0E\+0?$/);if(s){if(0==t)return o.fill("0",s[1].length)+".0E+0";if(t<0)return"-"+n(e,-t);var c=e.indexOf(".");-1===c&&(c=e.indexOf("E"));var u=Math.floor(Math.log(t)*Math.LOG10E)%c;if(u<0&&(u+=c),-1===(r=(t/Math.pow(10,u)).toPrecision(i+1+(c+u)%c)).indexOf("e")){var l=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+u):r+="E+"+(l-u);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,c)+"."+r.substr(2+c)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(c+u)%c)+"."+n.substr(u)+"E"}))}else if(-1!==e.indexOf(".")){var d=new a.default(t).toExponential(i+2),f=d.indexOf("e")||d.indexOf("E"),h=v(d.substr(0,f),e.substr(e.indexOf(".")+1,i)),m=h.indexOf(".");if(m>1){var p=parseInt(d.substr(f+1));r=(h=h.charAt(0)+"."+h.substr(1).replace(".","").substr(0,i))+"E"+((p+=m-1)>=0?"+":"-")+o.pad0(Math.abs(p),2)}else r=h.toString()+d.substr(f)}else r=t.toExponential(0);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var i=/# (\?+)(\s*)\/(\s*)(\d+)/;var s=/^#*0*\.([0#?]+)/,c=/\).*[0#]/,u=/\(###\) ###\\?-####/;function d(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function b(e,y,T){if(40===e.charCodeAt(0)&&!y.match(c)){var g=/\) */.test(y),R=y.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return T>=0?b("n",R,T):"("+b("n",R,E(T))+(g?")":"")}if(44===y.charCodeAt(y.length-1))return function(e,r,n){for(var o=r.length-1;44===r.charCodeAt(o-1);)--o;return t.write_num(e,r.substr(0,o),n/Math.pow(10,3*(r.length-o)))}(e,y,_(T));if(-1!==y.indexOf("%"))return r(e,y,_(T));if(-1!==y.indexOf("E"))return n(y,_(T));if(36===y.charCodeAt(0))return"$"+b(e,y.substr(" "==y.charAt(1)?2:1),T);var C,O,S,w,A;A=function(e){if("number"==typeof e)return!1;if(!e)return!1;var t=e.indexOf(".");-1!==t&&(e=e.substr(0,t)+e.substr(t+1,e.length));var r=(e=(e=e.replace(/[+-]/,"")).toUpperCase()).indexOf("E");-1!==r&&(e=e.substr(0,r));var n=e.match(/0*([1-9]([0-9]*[1-9])?)0*$/);return!!(n&&n[1].length>16)}(T)?T<0?E(T):T:Math.abs(_(T));var I=T<0?"-":"";if(y.match(/^00+$/)){var F=o.pad0r(A,y.length);return F=o.getRealNumValueStr(F),/^0+$/.test(F)?F:I+F}if(y.match(/^[#?]+$/))return"0"===(C=o.pad0r(T,0))&&(C=""),C.length>y.length?C:d(y.substr(0,y.length-C.length))+C;if(O=y.match(i))return function(e,t,r){var n=parseInt(e[4],10),i=new a.default(t).mul(n).round(),s=i.div(n).floor(),c=i.minus(s.mul(n)),u=n,l=0===c.toNumber()?o.fill(" ",e[1].length+1+e[4].length):o.pad_(c.toString(),e[1].length)+e[2]+"/"+e[3]+o.pad0(u.toString(),e[4].length);return""===l.trim()&&0===s.toNumber()?r+"0 "+l:r+(0===s.toNumber()?"":""+o.getRealNumValueStr(s.toString()))+" "+l}(O,A,I);if(y.match(/^#+0+$/))return I+o.pad0r(A,y.length-y.indexOf("0"));if(O=y.match(s))return-1!==(C=I+v(A,O[1]).replace(/^([^\.]+)$/,"$1."+d(O[1])).replace(/\.$/,"."+d(O[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+o.fill("0",d(O[1]).length-t.length)}))).indexOf("e")||-1!==C.indexOf("E")&&parseFloat(C)>0?o.getRealNumValueStr(C):-1!==y.indexOf("0.")?C:C.replace(/^0\./,".");if(y=y.replace(/^#+([0.])/,"$1"),O=y.match(/^(0*)\.(#*)$/))return I+v(A,O[2]).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,O[1].length?"0.":".");if(O=y.match(/^#{1,3},##0(\.?)$/)){var N=A.toString();if(-1!==N.indexOf("e")||-1!==N.indexOf("E")){T=Math.abs(_(T));var D=v(o.getRealNumValueStr(T),"");return O[1]||(D=D.substr(0,D.length-1)),I+f(D)}return I+f(o.pad0r(A,0))}if(O=y.match(/^#,##0\.([#0?]*[0?])$/)){var k=T.toString();return-1!==k.indexOf("e")||-1!==k.indexOf("E")&&T>0?(T=Math.abs(_(T)),I+h(v(o.getRealNumValueStr(T),O[1]))):T<0?"-"+b(e,y,E(T)):h(v(T,O[1]))}if(O=y.match(/^#,#*,#0/))return b(e,y.replace(/^#,#*,/,""),T);if(O=y.match(/^([0#]+)(\\?-([0#]+))+$/))return C=o._strrev(b(e,y.replace(/[\\-]/g,""),T)),S=0,o._strrev(o._strrev(y.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return S<C.length?C.charAt(S++):"0"===e?"0":""})));if(y.match(u))return"("+(C=b(e,"##########",T)).substr(0,3)+") "+C.substr(3,3)+"-"+C.substr(6);var M="";if(O=y.match(/^([#0?]+)(\s*)\/(\s*)([#0?]+)/))return S=Math.min(O[4].length,7),w=l(_(A),Math.pow(10,S)-1,!1),C=""+I," "==(M=t.write_num("n",O[1],w[1])).charAt(M.length-1)&&(M=M.substr(0,M.length-1)+"0"),C+=M+O[2]+"/"+O[3],(M=o.rpad_(w[2],S)).length<O[4].length&&(M=d(O[4].substr(O[4].length-M.length))+M),C+=M;if(O=y.match(/^([#0?]+)(\s*)(\?+)\/(\s*)([#0?]+)/))return S=Math.min(O[5].length,7),w=l(_(A),Math.pow(10,S)-1,!0),C="","0"!==(M=t.write_num("n",O[3],w[1])||"").trim()&&""!==M.trim()?(C+=O[2]+M+"/"+O[4],(M=o.rpad_(w[2],S)).length<O[5].length&&(M=d(O[5].substr(O[5].length-M.length))+M),C+=M):C+=o.fill(" ",y.length-O[1].length),M=t.write_num("n",O[1],w[0])||"",""===C.trim()?C=""===M.trim()?"0"+C:M+C:"0"!==M.trim()&&(C=M+C),C=""+I+C;if(O=y.match(/^# ([#0?]+)(\s*)\/(\s*)([#0?]+)/))return S=Math.min(Math.max(O[1].length,O[4].length),7),I+(("0"!==(w=l(_(A),Math.pow(10,S)-1,!0))[0]?w[0]:"")||(w[1]?"":"0"))+" "+(w[1]?o.pad_(w[1],S)+O[2]+"/"+O[3]+o.rpad_(w[2],S):o.fill(" ",2*S+1+O[2].length+O[3].length));if(O=y.match(/^[#0?]+$/))return-1===(C=o.pad0r(T,0)).indexOf("e")&&-1===C.indexOf("E")||(C=o.getRealNumValueStr(C)),y.length<=C.length?C:d(y.substr(0,y.length-C.length))+C;if(O=y.match(/^([#0?]+)\.([#0?]+)$/)){C=""+_(T).toFixed(Math.min(O[2].length,10)).replace(/([^0])0+$/,"$1"),S=C.indexOf(".");var P=y.indexOf(".")-S,L=y.length-C.length-P;return d(y.substr(0,P)+C+y.substr(y.length-L))}if(O=y.match(/^00,000\.([#0?]*0)$/))return S=function(e,t){var r=v(e,t);return r.substr(r.indexOf(".")+1)}(T,O[1]),T<0?"-"+b(e,y,E(T)):f(p(_(T))).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?o.pad0(0,3-e.length):"")+e}))+"."+o.pad0(S,O[1].length);if(O=y.match(/^(([0#?]{1,3},)?([0#?]{3},)*([0#?]{3})?)(\.|\.([0#?]+))?$/)){if(T<0)return"-"+b(e,y,E(T));var x=function(e,t){for(var r=m(p(e)),n=m(t).replace(/,/g,""),o=0,i=0,a="",s=-1!==t.indexOf(",");o<r.length&&i<n.length;)","!==n[i]?(a+=r[o],o++,i++):(a+=",",i++);if(o<r.length)if(s)for(var c=Math.max(0,a.lastIndexOf(",")),u=a.length-c;o<r.length;o++)u%3==0&&(a+=","),a+=r[o],u++;else a+=r.substr(o);else if(i<n.length){if(s)for(c=Math.max(0,a.lastIndexOf(",")),u=a.length-c;i<n.length;i++)u%3==0&&(a+=","),a+=n[i],u++;else a+=n.substr(i);a=a.replace(/#/g,"").replace(/\?/g," ")}return(a=m(a)).replace(/(\ +),/g,"$1")}(_(T),O[1]);return 0===x.indexOf(",")&&(x=x.slice(1)),O[6]?x+v(T,O[6]).replace(/(\d*)\./,"."):x}switch(y){case"###,##0.00":return b(e,"#,##0.00",T);case"###,###":case"##,###":case"#,###":var U=f(o.pad0r(A,0));return"0"!==U?I+U:"";case"###,###.00":return b(e,"###,##0.00",T).replace(/^0\./,".");case"#,###.00":return b(e,"#,##0.00",T).replace(/^0\./,".")}return""+T}function y(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1,i=e.match(/^(#+0).0E\+0?$/);if(i){if(0==t)return o.fill("0",i[1].length)+".0E+0";if(t<0)return"-"+y(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+s):r+="E+"+(c-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"}))}else r=-1===e.indexOf(".")?t.toExponential(0):o.extToExponential(t,n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function T(r,n,a){if(40===r.charCodeAt(0)&&!n.match(c)){var h=/\) */.test(n),m=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?T("n",m,a):"("+T("n",m,-a)+(h?")":"")}if(44===n.charCodeAt(n.length-1))return function(e,r,n){for(var o=r.length-1;44===r.charCodeAt(o-1);)--o;return t.write_num(e,r.substr(0,o),n/Math.pow(10,3*(r.length-o)))}(r,n,a);if(-1!==n.indexOf("%"))return function(r,n,i){var a=n.replace(e,""),s=n.length-a.length;return t.write_num(r,a,i*Math.pow(10,2*s))+o.fill("%",s)}(r,n,a);if(-1!==n.indexOf("E"))return y(n,a);if(36===n.charCodeAt(0))return"$"+T(r,n.substr(" "==n.charAt(1)?2:1),a);var p,v,_,E,b=Math.abs(a),g=a<0?"-":"";if(n.match(/^00+$/)){var R=o.pad0(b,n.length);return R=o.getRealNumValueStr(R),/^0+$/.test(R)?R:g+R}if(n.match(/^[#?]+$/))return"0"===(p=""+a)&&(p=""),p.length>n.length?p:d(n.substr(0,n.length-p.length))+p;if(v=n.match(i))return function(e,t,r){return r+t+o.fill(" ",e[1].length+2+e[4].length)}(v,b,g);if(n.match(/^#+0+$/))return g+o.pad0(b,n.length-n.indexOf("0"));if(v=n.match(s))return p=(p=(""+a).replace(/^([^\.]+)$/,"$1."+d(v[1])).replace(/\.$/,"."+d(v[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+o.fill("0",d(v[1]).length-t.length)})),-1!==n.indexOf("0.")?p:p.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),v=n.match(/^(0*)\.(#*)$/))return g+(""+b).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,v[1].length?"0.":".");if(v=n.match(/^#{1,3},##0(\.?)$/))return g+f(""+b);if(v=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+T(r,n,-a):f(""+a)+"."+o.fill("0",v[1].length);if(v=n.match(/^#,#*,#0/))return T(r,n.replace(/^#,#*,/,""),a);if(v=n.match(/^([0#]+)(\\?-([0#]+))+$/))return p=o._strrev(T(r,n.replace(/[\\-]/g,""),a)),_=0,o._strrev(o._strrev(n.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return _<p.length?p.charAt(_++):"0"===e?"0":""})));if(n.match(u))return"("+(p=T(r,"##########",a)).substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var C="";if(v=n.match(/^([#0?]+)(\s*)\/(\s*)([#0?]+)/))return _=Math.min(v[4].length,7),E=l(b,Math.pow(10,_)-1,!1),p=""+g," "==(C=t.write_num("n",v[1],E[1])).charAt(C.length-1)&&(C=C.substr(0,C.length-1)+"0"),p+=C+v[2]+"/"+v[3],(C=o.rpad_(E[2],_)).length<v[4].length&&(C=d(v[4].substr(v[4].length-C.length))+C),p+=C;if(v=n.match(/^# ([#0?]+)(\s*)\/(\s*)([#0?]+)/)){_=Math.min(Math.max(v[1].length,v[4].length),7);var O=""+(g+(("0"!==(E=l(b,Math.pow(10,_)-1,!0))[0]?E[0]:"")||(E[1]?"":"0"))),S=E[1]?o.pad_(E[1],_)+v[2]+"/"+v[3]+o.rpad_(E[2],_):"";return O+(S?" ":"")+S}if(v=n.match(/^[#0?]+$/))return p=""+a,n.length<=p.length?p:d(n.substr(0,n.length-p.length))+p;if(v=n.match(/^([#0]+)\.([#0]+)$/)){p=""+a.toFixed(Math.min(v[2].length,10)).replace(/([^0])0+$/,"$1"),_=p.indexOf(".");var w=n.indexOf(".")-_,A=n.length-p.length-w;return d(n.substr(0,w)+p+n.substr(n.length-A))}if(v=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+T(r,n,-a):f(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?o.pad0(0,3-e.length):"")+e}))+"."+o.pad0(0,v[1].length);switch(n){case"###,###":case"##,###":case"#,###":var I=f(""+b);return"0"!==I?g+I:"";default:if(n.match(/\.[0#?]*$/))return T(r,n.slice(0,n.lastIndexOf(".")),a)+d(n.slice(n.lastIndexOf(".")))}return""+a}return function(e,t,r){var n=r;return o.isNumeric(r)&&(0!==(n=parseFloat(r.toString()))||"0"===r.toString()||/0+[Ee]0+/.test(r.toString())||/0+(\.0+)?/.test(r.toString()))?n===1/0||n===-1/0?r.toString():(n.toString()!==r.toString()&&(n=r.toString()),(0|_(n))===n?T(e,t,n):b(e,t,n)):r.toString()}}();function b(){return s.default.createInstance({id:0,pattern:i.DEFAULT_FORMAT_PATTERN})}function y(e){return e.pattern||b().toString()}function T(e){var r,n,o,a=c.NUMBER_FORMAT_TYPE.GENERAL,s=c.NUMBER_FORMAT_TYPE.GENERAL;if("@"===e||-1===e.indexOf(";")&&-1!==e.indexOf("@"))a=c.NUMBER_FORMAT_TYPE.TEXT,s=c.NUMBER_FORMAT_TYPE.TEXT;else if("General"===e)a=c.NUMBER_FORMAT_TYPE.GENERAL,s=c.NUMBER_FORMAT_TYPE.GENERAL;else if(n=function(e){var t=R(e);if(/[0#?]+(\.[0#?]?)?[Ee][+-]?[0#?]+/.test(t))return!0;return!1}(e))a=c.NUMBER_FORMAT_TYPE.SCIENTIFIC,s="exponential";else if(n=function(e){var t=R(e);if(/%/.test(t))return!0;return!1}(e))a=c.NUMBER_FORMAT_TYPE.PERCENT,s=c.NUMBER_FORMAT_TYPE.PERCENT;else if(n=function(e){i.SUPPORT_CURRENCY_LIST.sort((function(e,t){return t.symbol.length-e.symbol.length}));var t=R(e,!0),r=t.match(/\[\$(.+)-(.+)\]/);if(r){if(C(t.replace(/(\[\$.+-.+\])/,"")))for(var n=r[1],o=(r[2],0);o<i.SUPPORT_CURRENCY_LIST.length;o+=1)if(n===i.SUPPORT_CURRENCY_LIST[o].symbol)return i.SUPPORT_CURRENCY_LIST[o].type}else{t=t.replace(/\[.*\]/,"");for(o=0;o<i.SUPPORT_CURRENCY_LIST.length;o+=1)if(-1!==t.indexOf(i.SUPPORT_CURRENCY_LIST[o].symbol)||-1!==e.indexOf('"'+i.SUPPORT_CURRENCY_LIST[o].symbol+'"'))return i.SUPPORT_CURRENCY_LIST[o].type}}(e))a=c.NUMBER_FORMAT_TYPE.CURRENCY,s=n;else if(n=S(e))a=c.NUMBER_FORMAT_TYPE.FRACTION,s=c.NUMBER_FORMAT_TYPE.FRACTION;else if(n=O(e)){a=s=function(e){var t=0;e&&(e.year&&(t|=w),e.month&&(t|=A),e.day&&(t|=I),e.hour&&(t|=F),e.minute&&(t|=N),e.second&&(t|=D),e.week&&(t|=k));for(var r=0;r<M.length;r+=1)if(M[r].key===t)return M[r].type}(n)||c.NUMBER_FORMAT_TYPE.DATE,(s=t.format2TypeMapping[e])||(s=c.NUMBER_FORMAT_TYPE.CUSTOM),r=n}else(n="000000"===(o=e)||"[DBNum1][$-804]General"===o||"[DBNum2][$-804]General"===o)?(a=c.NUMBER_FORMAT_TYPE.SPECIAL,s=c.NUMBER_FORMAT_TYPE.SPECIAL):(n=C(e))?(a=c.NUMBER_FORMAT_TYPE.NUMBER,s="numeral"):e&&"General"!==e?(a=c.NUMBER_FORMAT_TYPE.CUSTOM,s=c.NUMBER_FORMAT_TYPE.CUSTOM):(a=c.NUMBER_FORMAT_TYPE.GENERAL,s=c.NUMBER_FORMAT_TYPE.GENERAL);return{group:a,type:s,extraInfo:r}}function g(e){if(/^#,##0(\.0+)?;\[Red\]-#,##0(\.0+)?$/.test(e)||/^#,##0(\.0+)?;\[红色\]-#,##0(\.0+)?$/.test(e)||/^#,##0(\.0+)?$/.test(e))return{group:c.NUMBER_FORMAT_TYPE.CURRENCY,type:c.NUMBER_FORMAT_TYPE.CURRENCY}}function R(e,t){if(!e)return"";var r,n,o=!1,a=!1,s="",c="";for(r=0,n=e.length;r<n;r+=1)if(o)34===e.charCodeAt(r)&&(o=!o);else switch(e.charCodeAt(r)){case 34:o=!o;break;case 91:a=!0;break;case 93:a=!1;for(var u=t,l=Object.keys(i.COLOR_MAP),d=0;d<l.length;d+=1)if(l[d]===c){u=!1;break}u&&(s+="["+c+"]"),c="";break;case 95:case 92:case 42:a||(t?s+=e[r]:r+=1);break;default:a?c+=e[r]:s+=e[r]}return s}function C(e){var t=R(e);return"_ * #,##0.00_ "!==e&&'_ * "-"??_ '!==e&&"_ * -#,##0.00_ "!==e&&"_ @_ "!==e&&!(!/^[-]?[0#?,]+(\.[0#?]+)?(_ )?$/.test(t)&&!/^\([0#?,]+(\.[0#?]+)?\)$/.test(t))}function O(e){var t=R(e);t=t.replace(/\[.*\]/,"");var r={year:!1,month:!1,day:!1,hour:!1,minute:!1,second:!1,week:!1},n=!1;if(/[y|Y]/.test(t)&&(r.year=!0,n=!0),/[mM]/.test(t)){var o=t.replace(/[\s:]/g,"");o=(o=o.replace(/AM|PM|am|PM/g,"")).replace(/m+/g,"m"),/[^hHsS][mM][^hHsS]|[^hHsS][mM]$|^[mM][^hHsS]|^[mM]$/.test(o)&&(r.month=!0,n=!0)}if(/[d|D]/.test(t)&&(r.day=!0,n=!0),/[h|H]/.test(t)&&(r.hour=!0,n=!0),/([hHsS]+(:|\s|(".*"))*[mM])|([mM](:|\s|(".*"))*[hHsS]+)/.test(t)&&(r.minute=!0,n=!0),/[s|S]/.test(t)&&(r.second=!0,n=!0),/a{3,4}/.test(t)&&(r.week=!0,n=!0),n)return r}function S(e){var t=R(e);return!(!t||!/[0#]*\s*\?+\/([\d]+|[\?]+)/.test(t.trim()))}t.checkNumericValue=function(e){var t=!1;if(o.isNumeric(e)){var r=parseFloat(e);if(0!==r||"0"===e.toString()||/0+[Ee]0+/.test(e)||/0+(\.0+)?/.test(e)){if(r!==1/0&&r!==-1/0)return!0;t=!1}else t=!1}return t},t.isColorFormat=function(e){var t,r=e.match(/\[(.+)\]/);if(!r)return!1;t=r[1];for(var n=Object.keys(i.COLOR_MAP),o=0;o<n.length;o++)if(n[o]===t)return!0;return!1},t.getColorByFormat=function(e){var t,r=e.match(/\[(.+)\]/);return r?(t=r[1],i.COLOR_MAP[t]):null},t.getDefaultNumberFormat=b,t.getNumberFormatNameByType=function(e){if(e)for(var t=0;t<i.NUMBER_FORMAT_NAME.length;t+=1)if(i.NUMBER_FORMAT_NAME[t].type===e)return i.NUMBER_FORMAT_NAME[t].name;return"常规"},t.getFormatCodeByNumberFormat=y,t.getFormatType=T,t.isBuildInSpecialFormat=g,t.clearQuotationMask=R,t.isDateTimeCell=O,t.isGeneralCell=function(e){return!e||void 0===e.id||0===e.id},t.isGeneralCell2=function(e){return!e||"General"===e.pattern},t.isTextCell=function(e){if(e){var t=y(e);if("@"===t||-1===t.indexOf(";")&&-1!==t.indexOf("@"))return!0}return!1},t.isFractionFormat=S,t.isDateCell=function(e,t){if(!t)return!1;var r=y(t),n=o.choose_fmt(r,e);return!!o.fmtIsDate(n.fmt)};var w=64,A=32,I=16,F=8,N=4,D=2,k=1,M=[{key:w|A|I,type:c.NUMBER_FORMAT_TYPE.DATE},{key:w|A,type:c.NUMBER_FORMAT_TYPE.DATE},{key:A|I,type:c.NUMBER_FORMAT_TYPE.DATE},{key:w|I,type:c.NUMBER_FORMAT_TYPE.DATE},{key:w,type:c.NUMBER_FORMAT_TYPE.DATE},{key:A,type:c.NUMBER_FORMAT_TYPE.DATE},{key:I,type:c.NUMBER_FORMAT_TYPE.DATE},{key:w|A|I|F|N,type:c.NUMBER_FORMAT_TYPE.DATE_TIME},{key:w|A|I|F|N|D,type:c.NUMBER_FORMAT_TYPE.DATE_TIME},{key:F|N|D,type:c.NUMBER_FORMAT_TYPE.TIME},{key:F|N,type:c.NUMBER_FORMAT_TYPE.TIME},{key:N|D,type:c.NUMBER_FORMAT_TYPE.TIME},{key:F|D,type:c.NUMBER_FORMAT_TYPE.TIME},{key:F,type:c.NUMBER_FORMAT_TYPE.TIME},{key:D,type:c.NUMBER_FORMAT_TYPE.TIME},{key:N,type:c.NUMBER_FORMAT_TYPE.TIME}];var P,L,x,U,B=(L=(null===(P=e.navigator)||void 0===P?void 0:P.userAgent)||"",x=!L.match(/(iPad).*OS\s([\d_]+)/)&&L.match(/(iPhone\sOS)\s([\d_]+)/),U=L.match(/(Android)\s+([\d.]+)/),!(!x&&!U));function j(e,t,r){var n=[];return e&&(n=e.split(";").map((function(e,n){return 2===n&&-1!==e.indexOf("?")?e:function(e,t,r){var n="";return e.split('"').forEach((function(e,o){o%2==0&&(e=e.replace(t,r)),o>0&&(e='"'+e),n+=e})),n}(e,t,r)}))),n.join(";")}function $(e){var t=(e=e||"").split(";")[0],r=(t=(t=R(t)).toUpperCase()).indexOf("E"),n=0;-1!==r&&(t=t.substr(0,r));var o=t.match(/([0#?,]*)[.]([0#?]+)?/);return o&&(n=o[2]?o[2].length:n),n}t.txSheetToMsoFormatMapping=B?{auto:"General",default:"General",text:"@",numeral:"#,##0.00_ ",percentage:"0.00%","percentage-int":"0%",exponential:"0.00E+00","currency-chs":'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)',"currency-hk":"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)","currency-en":"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)",time:"h:mm:ss;@","date-time":"yyyy/m/d h:mm:ss;@",date:"yyyy/m/d","date-chs":'yyyy"年"m"月"d"日";@',"date-chs-ym":'yyyy"年"m"月";@',"date-chs-md":'m"月"d"日";@',fraction:"# ?/?",m_d_yy:"m/d/yy;@","mmm-yy":"[$-409]mmm-yy;@",m_d:"m/d;@","yyyy-mm-dd":"yyyy-mm-dd;@",yyyy_mm_dd:"yyyy/mm/dd;@","yyyy_m_d-h-m":"yyyy/m/d h:mm;@","h-mm":"h:mm;@",yy_m_d:"yy/m/d;@","h-mm-ss-am_pm":"[$-409]h:mm:ss\\ AM/PM;@"}:{default:"General",auto:"General",text:"@",numeral:"#,##0.00_ ",percentage:"0.00%","percentage-int":"0%",exponential:"0.00E+00",currency:"#,##0.00","currency-chs":'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)',"currency-hk":"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)","currency-en":"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)",time:"h:mm:ss;@","date-time":"yyyy/m/d h:mm:ss",date:"yyyy/m/d",accounting:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_',"date-chs":'yyyy"年"m"月"d"日";@',"date-chs-ym":'yyyy"年"m"月";@',"date-chs-md":'m"月"d"日";@',fraction:"# ?/?"},t.format2TypeMapping=o.invertObject(t.txSheetToMsoFormatMapping),t.getCellNumberFormatType=function(e){if(null==e)return{group:c.NUMBER_FORMAT_TYPE.GENERAL,type:c.NUMBER_FORMAT_TYPE.GENERAL};var t;"string"==typeof e?t=e:(void 0===e&&(e=b()),t=y(e));var r=u.default.get(t);if(r)return r;var n=t.split(";");if(n.length>4)r={group:c.NUMBER_FORMAT_TYPE.CUSTOM,type:c.NUMBER_FORMAT_TYPE.CUSTOM};else if(r=g(t));else{var o=!1,i=n[n.length-1];i=R(i),2===n.length&&"@"===n[1]?(n=[])[0]=t:"@"===i&&(n=n.slice(0,n.length-1),o=!0);for(var a=n.map((function(e){return T(e)})),s=void 0,l=void 0,d=!1,f=a.length-1;f>=0;f--)if(l){if(l!==a[f].type){d=!0;break}}else s=a[f].group,l=a[f].type;s=s||(o?c.NUMBER_FORMAT_TYPE.TEXT:c.NUMBER_FORMAT_TYPE.GENERAL),l=l||(o?c.NUMBER_FORMAT_TYPE.TEXT:c.NUMBER_FORMAT_TYPE.GENERAL),r=d?{group:c.NUMBER_FORMAT_TYPE.CUSTOM,type:c.NUMBER_FORMAT_TYPE.CUSTOM}:{group:s,type:l}}return u.default.put(t,r),r},t.getNumberFormatByFormatCode=function(e){return e=t.txSheetToMsoFormatMapping[e||"General"]||e||"General",s.default.createInstance({pattern:e})},t.increaseDecimalFormat=function(e,t){if(S(t))return t;if("General"!==t&&t){var r=j(t,/((\]|^)[^\[]*)([0#,.?]+)(E\+[0#,.?]+)?/g,(function(e){return e=-1!==e.indexOf("E+")?-1===e.indexOf(".")?e.replace(/([0#?]+)(?=E\+)/g,"$1.0"):e.replace(/(\.[0#?]+)E/g,"$10E"):-1===e.indexOf(".")?e.replace(/([0#,?]+)/g,"$1.0"):e.replace(/(\.[0#?]+)/g,"$10")}));$(r)<=127&&(t=r)}else if(""===e||null==e||isNaN(e))t="General";else{var n=e.toString().match(/^[-]?(\d+)(.(\d+))?([e|E][-+]\d+)?$/),i=n&&void 0!==n[3]?n[3].length:0,a=n?n[1].length:1;a>=12?t="0.000000E+00":(i=Math.min(10-a,i),t=0===(i=Math.max(0,i))?"0.0_ ":"0."+o.fill("0",i+1)+"_ ")}return t&&0!==t.length||(t="General"),t},t.decreaseDecimalFormat=function(e,t){function r(e){return-1===e.indexOf(".")||(e=e.indexOf(".")>=e.length-2?e.slice(0,e.indexOf(".")):/(\.[0#?])(?![0#?])/g.test(e)?e.replace(/(\.[0#?])([^0#?]*)/g,"$2"):e.replace(/(\.[0#?]+?)/g,".")),e}if(S(t))return t;if("General"!==t&&t)t=j(t,/((\]|^)[^\[]*)([0#,.?]+)(E\+[0#,.?]+)?/g,(function(e){return-1!==e.indexOf("E+")?-1===e.indexOf(".")||(e=e.replace(new RegExp("\\.[0#?]*","g"),r)):e=r(e),""===e&&(e="#"),e}));else if(""===e||null==e||isNaN(e))t="General";else{var n=e.toString().match(/^[-]?(\d+)(.(\d+))?([e|E][-+]\d+)?$/),i=n&&void 0!==n[3]?n[3].length:0,a=n?n[1].length:1;a>=12?t="0.0000E+00":(i=Math.min(10-a,i),t=(i=Math.max(0,i))<=1?"0_ ":"0."+o.fill("0",i-1)+"_ ")}return t&&0!==t.length||(t="General"),t},t.modifyFormat=j,t.getCurrentCellDotNum=$,t.getNumberFormatByOldFormat=function(e){var r;return r=e&&t.txSheetToMsoFormatMapping[e]||"General",s.default.createInstance({pattern:r})},t.getCurrencySymbol=function(e){i.SUPPORT_CURRENCY_LIST.sort((function(e,t){return t.symbol.length-e.symbol.length}));var t,r=R(e,!0),n=r.match(/\[\$(.+)-(.+)\]/);if(n)C(r.replace(/(\[\$.+-.+\])/,""))&&(t=n[1]);else{r=r.replace(/\[.*\]/,"");for(var o=0;o<i.SUPPORT_CURRENCY_LIST.length;o+=1)-1===r.indexOf(i.SUPPORT_CURRENCY_LIST[o].symbol)&&-1===e.indexOf('"'+i.SUPPORT_CURRENCY_LIST[o].symbol+'"')||(t=i.SUPPORT_CURRENCY_LIST[o].symbol)}return t}}).call(this,r("5ef37df1a0"))},"570b26a0fa":function(e,t,r){"use strict";r.r(t),r.d(t,"Application",(function(){return U})),r.d(t,"Auth",(function(){return x})),r.d(t,"KVR",(function(){return ot})),r.d(t,"LogPadType",(function(){return S})),r.d(t,"Page",(function(){return j})),r.d(t,"Platform",(function(){return B})),r.d(t,"cube",(function(){return it})),r.d(t,"default",(function(){return pt})),r.d(t,"esLogReport",(function(){return nt})),r.d(t,"getAuth",(function(){return Ee})),r.d(t,"getCookieUid",(function(){return ce})),r.d(t,"getCookieUin",(function(){return se})),r.d(t,"getDefaultTdwData",(function(){return lt})),r.d(t,"getFileTypeForReport",(function(){return ve})),r.d(t,"getPlatform",(function(){return Ie})),r.d(t,"getSource1",(function(){return Fe})),r.d(t,"huatuo",(function(){return mt})),r.d(t,"idkey",(function(){return ct})),r.d(t,"monitor",(function(){return dt})),r.d(t,"reportErrorCode",(function(){return Ze})),r.d(t,"resetDefaultTdwData",(function(){return ut})),r.d(t,"retcode",(function(){return ft})),r.d(t,"retcodeEnt",(function(){return ht})),r.d(t,"tdw",(function(){return Xe})),r.d(t,"tdwSingle",(function(){return Je})),r.d(t,"tipReport",(function(){return tt})),r.d(t,"webLog",(function(){return rt})),r.d(t,"webLogAndEsReport",(function(){return et})),r.d(t,"zzsStatus",(function(){return at})),r.d(t,"zzsValue",(function(){return st}));var n,o,i,a=r("4f3b15d017"),s=r("d7a2286b24"),c=["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/kswps","application/kswpt","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],u=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","text/csv","text/csv; charset=utf-8","application/vnd.ms-excel.sheet.binary.macroEnabled.12","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-excel.template.macroEnabled.12","application/kset","application/ksett"],l=["application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/ksdps","application/ksdpt","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.template.macroEnabled.12","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],d=["text/lrc","text/asp; charset=utf-8","application/x-msdownload","text/richtext; charset=utf-8","text/plain","text/plain; charset=utf-8","text/xml","text/html","text/html; charset=utf-8","text/markdown"],f=["text/x-c; charset=utf-8","text/x-c; charset=utf-8","text/x-chdr","text/x-asm; charset=utf-8","text/x-java-source; charset=utf-8","text/javascript","text/x-go"],h=["image/x-sony-arw","image/bmp","image/vnd.zbrush.pcx","image/x-pcx","image/tiff","image/gif","image/x-exif","image/jpeg","image/vnd.fpx","image/svg+xml","image/vnd.adobe.photoshop","image/x-cdr","image/x-photo-cd","image/vnd.dxf","image/x-ufo","application/postscript","image/png","image/wmf","image/webp","image/x-tga"],m=["audio/mpeg","audio/aac","audio/x-flac","audio/amr","audio/AMR","audio/mp4","audio/x-ms-wma","audio/x-wav","audio/x-cd","audio/x-wave","audio/x-aiff","audio/midi","audio/x-realaudio","audio/x-twinvq","audio/ogg","audio/x-ape","audio/webm","audio/mpeg-4"],p=["video/mp4","video/3gpp","video/x-ms-asf","video/x-msvideo","video/dv","video/x-flv","video/x-f4v","application/vnd.apple.mpegurl","video/x-matroska","video/quicktime","video/mpeg","video/mp2t","application/vnd.rn-realmedia","audio/x-pn-realaudio","video/x-ms-wmv","video/dat"],v=["application/vnd.ms-visio.drawing","application/x-visio","application/vnd.ms-visio.drawing.main+xml"],_=["application/vnd.pos"];function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function b(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(e){return e.Doc="application/vnd.tdocs-apps.doc",e.Sheet="application/vnd.tdocs-apps.sheet",e.Form="application/vnd.tdocs-apps.form",e.Folder="application/vnd.tdocs-apps.folder",e.CollaborationSpace="application/vnd.tdocs-apps.collaboration-space",e.CollaborationSpaceRoot="application/vnd.tdocs-apps.collaboration-space-root",e.SharedFolder="application/vnd.tdocs-apps.shared-folder",e.Share="application/vnd.tdocs-apps.share-folder",e.Slide="application/vnd.tdocs-apps.slide",e.Pdf="application/pdf",e.Aio="application/vnd.tdocs-apps.aio",e.SmartCanvas="application/vnd.tdocs-apps.smartcanvas",e.SmartSheet="application/vnd.tdocs-apps.smartsheet",e.Mind="application/vnd.tdocs-apps.mind",e.FlowChart="application/vnd.tdocs-apps.flowchart",e.Rec="application/vnd.tdocs-apps.rec",e.Word="application/vnd.ms-word",e.Excel="application/vnd.ms-excel",e.Powerpoint="application/vnd.ms-powerpoint",e.Zip="application/zip",e}({}),T=function(e){return e[e.Doc=0]="Doc",e[e.Sheet=1]="Sheet",e[e.Form=2]="Form",e[e.Folder=3]="Folder",e[e.Slide=4]="Slide",e[e.Pdf=6]="Pdf",e[e.Aio=7]="Aio",e[e.SmartCanvas=8]="SmartCanvas",e[e.Unknown=10]="Unknown",e[e.SmartSheet=9]="SmartSheet",e[e.Mind=90]="Mind",e[e.Flowchart=91]="Flowchart",e[e.FlowChart=91]="FlowChart",e[e.Drive=101]="Drive",e[e.Rec=102]="Rec",e}({}),g=function(e){return e.Doc="doc",e.Sheet="sheet",e.Slide="slide",e.Form="form",e.Pdf="pdf",e.Mind="mind",e.FlowChart="flowchart",e.Aio="Aio",e.Folder="folder",e.SmartCanvas="smartcanvas",e.SmartSheet="smartsheet",e.Drive="drive",e.Rec="rec",e}({});b(n={},T.Doc,y.Doc),b(n,T.Sheet,y.Sheet),b(n,T.Slide,y.Slide),b(n,T.Form,y.Form),b(n,T.SmartCanvas,y.SmartCanvas),b(n,T.Mind,y.Mind),b(n,T.FlowChart,y.FlowChart),b(n,T.Rec,y.Rec),b(n,T.Pdf,y.Pdf),b(n,T.Aio,y.Aio),T.Doc,T.Sheet,T.Slide,y.Form,T.Form,y.SmartCanvas,T.SmartCanvas,y.SmartSheet,T.SmartSheet,y.Doc,T.Doc,y.Sheet,T.Sheet,y.Slide,T.Slide,y.Mind,T.Mind,y.FlowChart,T.FlowChart,T.Doc,T.Doc,y.Pdf,T.Pdf,T.FlowChart,T.Mind,y.Folder,T.Folder,b(o={},g.Doc,y.Word),b(o,g.Sheet,y.Excel),b(o,g.Slide,y.Powerpoint),b(i={},g.Doc,y.Doc),b(i,g.Sheet,y.Sheet),b(i,g.Slide,y.Slide),b(i,g.Form,y.Form),b(i,g.SmartCanvas,y.SmartCanvas),b(i,g.Mind,y.Mind),b(i,g.FlowChart,y.FlowChart),b(i,g.Pdf,y.Pdf),b(i,g.Aio,y.Aio),g.Drive,g.Drive,g.Drive,y.Form,g.Form,y.SmartCanvas,g.SmartCanvas,y.SmartSheet,g.SmartSheet,y.Doc,g.Doc,y.Sheet,g.Sheet,y.Slide,g.Slide,y.Mind,g.Mind,y.FlowChart,g.FlowChart,g.Drive,g.Drive,y.Pdf,g.Pdf,g.FlowChart,g.Mind,g.Drive,g.Drive,g.Drive,y.Rec,g.Rec;var R=function(e){return c.includes(e)},C=function(e){return u.includes(e)},O=function(e){return l.includes(e)};const S={Sheet:"sheet",Backend:"backend",WxJsSdk:"WxJsSdk",Mqq:"Mqq",Fc:"fc",Sc:"sc",Ark:"ark",DC:"dc",Doc:"doc",BlankPage:"blankPage",Slide:"slide",PDF:"pdf",Board:"board",Form:"form",Scenario:"scenario",SmartSheet:"smartSheet"};function w(){return window.basicClientVars}function A(){var e;return null!==(e=window.clientVars)&&void 0!==e?e:{}}function I(e){const t=new RegExp(`(?:^|;+|\\s+)${e}=([^;]*)`),r="object"==typeof document&&document.cookie.match(t);return r?r[1]:null}function F(e,t,r,n,o){const i=new Date;i.setTime(i.getTime()+(r?36e5*r:2592e6)),"undefined"!=typeof document&&(document.cookie=`${e}=${t};expires=${i.toGMTString()};path=${o||"/"};${n?`domain=${n};`:""}`)}function N(e){const t=window.location.search.substring(1);if(!t)return;const r=t.split("&");for(const t of r){const[r,n]=t.split("=");if(r===e)return n}}function D(e,t){return new URL(e).searchParams.get(t)}function k(e,t=window.navigator.userAgent){try{const r=new RegExp(`\\b${e}\\/((\\d+\\.){1,3}\\d+)`,"i").exec(t);return r&&r.length>1&&r[1]||""}catch(e){return""}}(()=>{const e="undefined"==typeof document?null:document.createElement("a")})();const M={doc:1,sheet:2,form:3,slide:4,pdf:7,mind:8,flowchart:9,rec:10,smartcanvas:14,resume:15,board:12},P=-1,L={errorNumber:-1,trueNumber:1,falseNumber:0};var x,U,B,j,$;function W(e){let t="";for(let r=0;r<e;r++)t+=Math.random().toString(36).substr(2);return t}!function(e){e[e.error=-1]="error",e[e.owner=0]="owner",e[e.writer=1]="writer",e[e.reader=2]="reader"}(x||(x={})),function(e){e.CLIENT="client",e.MOBILE="mobile",e.WECHAT="wechat",e.BROWSER="browser",e.OTHER="other"}(U||(U={})),function(e){e.ANDROID="android",e.iOS="iOS",e.WIN="win",e.MAC="mac",e.OTHER="other"}(B||(B={})),function(e){e.tab_timeline="tab-timeline",e.tab_all="tab-all",e.detail="detail",e.setting_auth="setting-auth",e.template="template",e.error="error",e.activities="activities",e.login="login",e.member="member",e.tab_container="tab-container",e.tab_icon="tab-icon",e.m_setting_auth="m-setting-auth",e.m_detail_menu="m-detail-menu",e.m_tab_all_menu="m-tab-all-menu",e.m_activities="m- activities",e.m_member="m-member",e.m_form_app="m-form-app",e.m_gourp_form_app="m-gourp-form-app",e.m_tab_timeline="m-tab-timeline",e.m_tab_all="m-tab-all",e.m_group_doc="m-group-doc"}(j||(j={})),function(e){e.Doc="doc",e.Sheet="sheet",e.Slide="slide",e.Form="form",e.Pdf="pdf",e.Board="board",e.Mind="mind",e.FlowChart="flowchart",e.Aio="Aio",e.Folder="folder",e.SmartSheet="smartsheet",e.Drive="drive"}($||($={}));const G=(s.default.default||s.default).getInstance(),H=G.getConfig('npm["@tencent/tencent-doc-report"]')||{},V=(location.host,H.SDK_BUNDLE_URL||"https://docs.gtimg.com/alloy-report-sdk/latest/v4/alloyreport.sdk.js"),q=H.ENT_SDK_BUNDLE_URL||"https://res.wx.qq.com/d/alloy-report-sdk/latest/v4/alloyreport.sdk.js";H.docrpWeixinOrigin;const K=H.wecomMainHost||"doc.weixin.qq.com",Y=H.wecomAddonHost||"wecom-addon.tencentsuite.com",Q=H.cookieDomain||".docs.qq.com";H.reportIdqqimgOrigin,H.reportIdqqimgHost,H.reportUrlOrigin,H.reportUrlHost,H.reportHuatuoOrigin,H.beaconOrigin,H.tencentDocCdnGoOrigin,H.qqwebQQHost,H.qunQQHost,H.interceptorIgnoreUrls,G.getConfig("runtime.apiRoot"),G.getConfig("domain"),G.getConfig("domain"),G.getConfig("runtime.domainName");const z=[K,Y],X=function(){const e=z.includes("undefined"!=typeof location&&location.origin.split("//")[1]||"");return()=>e}(),J=e=>{const t=e.match(/TDAppDesktopChannel\/[\d]{5}/g);return t?t[0].slice(-5):null};const Z=new class{get domain(){var e,t,r,n;return(null===(t=null===(e=window.AppConfig)||void 0===e?void 0:e.normal)||void 0===t?void 0:t.domain)||(null===(n=null===(r=window.AppConfig)||void 0===r?void 0:r.normal)||void 0===n?void 0:n.instance)||location.host}get tenant(){var e,t,r,n;return(null===(e=window.clientVars)||void 0===e?void 0:e.creatorCorpId)?X()?`${null===(t=window.clientVars)||void 0===t?void 0:t.creatorCorpId}`:`${null===(r=window.clientVars)||void 0===r?void 0:r.creatorCorpName}:${null===(n=window.clientVars)||void 0===n?void 0:n.creatorCorpId}`:""}get client(){var e,t,r;return null!==(r=null===(t=null===(e=window.AppConfig)||void 0===e?void 0:e.normal)||void 0===t?void 0:t.client)&&void 0!==r?r:""}get platform(){return a.default.isIPhone?"iPhone":a.default.isIPad?"iPad":a.default.isAndroidPad?"androidPad":a.default.isAndroidPhone?"androidPhone":a.default.isMac?"mac":a.default.isWindows?"windows":"other"}get source(){const e=[[a.default.isWxMiniProgram,"wxMiniProgram"],[a.default.isQQMiniProgram,"qqMiniProgram"],[a.default.isWxWork,"wxWork"],[a.default.isChrome,"chrome"],[a.default.isSafari,"safari"],[a.default.isFirefox,"firefox"],[a.default.isChromiumEdge,"chromiumEdge"],[a.default.isQQBrowser,"qqBrowser"],[a.default.isTencentDocsApp,"tencentDocsApp"],[a.default.isPCTencentDocsClient,"pcTencentDocsClient"],[a.default.isWeiYunApp,"weiYunApp"],[a.default.isElectronTencentDocsClient,"electronTencentDocsClient"],[a.default.isWeChat,"weChat"],[a.default.isQQ,"qq"],[a.default.isTim,"tim"],[a.default.isWindowsUWP,"windowsUwp"]];for(let t=0;t<e.length;t++)if(e[t][0])return e[t][1];return""}get env(){var e;return null===(e=window.__DWS_INFO__)||void 0===e?void 0:e.curEnvId}},ee="undefined"!=typeof window&&window&&window.navigator?window:null,te=re()?qq||wx:null;function re(){return"object"==typeof qq&&qq.canIUse?qq.canIUse("request"):!("object"!=typeof wx||!wx.canIUse)&&wx.canIUse("request")}ee&&ee.localStorage&&"function"==typeof ee.localStorage.getItem||!re()||te.getStorage;const ne=()=>"undefined"!=typeof document;let oe=null,ie=null,ae=null;if(ne()){const e=a.default.getWxWorkVersion();e&&a.default.isWxWorkQt}function se(){if(oe)return oe;const e=I("p_luin")||I("p_uin");return e&&(oe=e.replace(/^[o0]+/i,"")),oe}function ce(){if(ie)return ie;const e=I("uid")||I("wedrive_uin")||I("tdoc_uid");return e&&(ie=e),ie}function ue(){return se()||(null===(t=null===(e=w())||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.uin)||A().uin||null||le();var e,t}function le(){return(null===(e=window.global_multi_user)||void 0===e?void 0:e.uid)||ce()||function(){var e,t,r;return(null===(t=null===(e=w())||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.userId)||(null===(r=A().userInfo)||void 0===r?void 0:r.uid)||null}();var e}function de(){var e;try{let t=null===(e=window.localStorage)||void 0===e?void 0:e.getItem("browserStr");return t||(t=W(5),window.localStorage&&window.localStorage.setItem("browserStr",t)),t}catch(e){return W(5)}}function fe(){if(ae)return ae;const e=N("adtag");if(e)ae=e,F("adtag",e,8760,Q,"/"),localStorage.setItem("tdsourcetag",e);else{const e=N("tdsourcetag");if(e)ae=e,F("adtag",e,8760,Q,"/"),localStorage.setItem("tdsourcetag",e);else{const e=N("from_page");e&&(ae=e,F("adtag",e,8760,Q,"/"),localStorage.setItem("tdsourcetag",e))}}return ae||(ae=localStorage.getItem("tdsourcetag")||I("adtag")||""),ae}function he(){var e,t,r;return(null===(t=null===(e=w())||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.loginType)||(null===(r=A().userInfo)||void 0===r?void 0:r.loginType)||P}const me={flowchart:"flow"};function pe(e=!1){var t,r,n;const o=(null===(n=null===(r=null===(t=w())||void 0===t?void 0:t.docInfo)||void 0===r?void 0:r.padInfo)||void 0===n?void 0:n.padType)||A().padType;return e&&me[o]?me[o]:o}function ve(e=""){var t;let r=pe()||e;return r?("drive"===r&&(r=function(){var e,t,r;const n={doc:"doc",sheet:"sheet",slide:"slide"};try{const o=null!==(r=null===(t=null===(e=w())||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.mimeType)&&void 0!==r?r:"";return R(o)?n.doc:C(o)?n.sheet:O(o)?n.slide:""}catch(e){return""}}()),null!==(t=M[r])&&void 0!==t?t:P):P}function _e(){var e,t;const r=(null===(t=null===(e=w())||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.isOwner)||A().isOwner;return void 0===r?P:r?L.trueNumber:L.falseNumber}function Ee(e){var t,r;return e||(null===(r=null===(t=w())||void 0===t?void 0:t.authInfo)||void 0===r?void 0:r.privilegeFlag)||A().rightFlag||P}function be(){var e,t,r;if(X())return"***";const n=(null===(r=null===(t=null===(e=w())||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.padInfo)||void 0===r?void 0:r.padTitle)||A().padTitle;return n?n.replace(/&/g,"\\&").replace(/\|/g,"\\|").replace(/=/g,"\\=").replace(/%/g,"\\%").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t"):null}function ye(){const e=ge(),t=Re();return e&&t?`${e}$${t}`:A().globalPadId||null}function Te(){var e,t,r;return(null===(r=null===(t=null===(e=w())||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.createInfo)||void 0===r?void 0:r.creatorId)||A().creatorId||null}function ge(){var e,t,r;return(null===(r=null===(t=null===(e=w())||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.padInfo)||void 0===r?void 0:r.domainId)||A().domainId||null}function Re(){var e,t,r;return(null===(r=null===(t=null===(e=w())||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.padInfo)||void 0===r?void 0:r.padId)||A().padId||null}function Ce(){var e,t,r;return(null===(r=null===(t=null===(e=w())||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.ownerInfo)||void 0===r?void 0:r.ownerId)||A().ownerId||null}function Oe(){var e;return(null===(e=window.__DWS_INFO__)||void 0===e?void 0:e.releaseVersion)||window.__globalReleaseVersion||null}function Se(){var e,t,r,n;return(null===(t=null===(e=A())||void 0===e?void 0:e.collab_client_vars)||void 0===t?void 0:t.dver)||(null===(n=null===(r=w())||void 0===r?void 0:r.docInfo)||void 0===n?void 0:n.dver)||null}function we(){if(a.default.isWxWorkQt)return"wxworkQT"}function Ae(){var e;if(a.default.isWxWorkCEF){const t=a.default.getWxWorkCEFVersion();if("string"==typeof t){return null===(e=t.split("."))||void 0===e?void 0:e[0]}}}function Ie(){return a.default.isMobile?a.default.isAndroid?2:a.default.isIOS?a.default.isIPad?6:3:4:a.default.isMac?5:a.default.isLinuxUOS?9:a.default.isLinuxKylin?8:a.default.isLinux?7:a.default.isPCTencentDocsClient||a.default.isWindows?1:P}function Fe(){const e=[[a.default.isPCTencentDocsClient,10],[a.default.isTencentMeeting,14],[a.default.isTim,2],[a.default.isWxMiniProgram,3],[a.default.isWeChat,4],[a.default.isTencentDocsApp,6],[a.default.isWindowsUWP,8],[a.default.isQQ,1],[a.default.isWxWork,9],[a.default.isWeiYunApp,11],[a.default.isQQMiniProgram,12],[a.default.isElectronTencentDocsClient,13],[a.default.isQQBrowser,5],[a.default.isMobileQQBrowser,5],[a.default.isChrome,5],[a.default.isQQBrowser,5],[a.default.isSafari,5],[a.default.isOldEdge,5],[a.default.isIE,5],[a.default.isChromiumEdge,5],[a.default.isFirefox,5]];for(let t=0;t<e.length;t++){const[r,n]=e[t];if(r)return n}return P}function Ne(){const e=A();let t=e.userLoginCorpName,r=e.userLoginCorpId;if(!t||!r){const n=e.userInfo||{};t=n.corp_name,r=n.corp_id}return t&&r?X()?`${r}`:`${t}-${r}`:null}function De(){if(X())return"";const{userAgent:e}=a.default;return JSON.stringify({channel:J(e),domain:Z.domain,tenant:Z.tenant,client:Z.client,quadrant:Me(),suffix:Pe()})}const ke={local:"local",drive:"drive",online:"online"};function Me(){var e,t,r,n;return"desktop_local"===D(null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.href,"client")?ke.local:"pdf"===pe()||(null===(n=null===(r=null===(t=w())||void 0===t?void 0:t.docInfo)||void 0===r?void 0:r.cosInfo)||void 0===n?void 0:n.driveExt)?ke.drive:ke.online}function Pe(){var e,t,r,n,o,i;if(Me()===ke.local){const r=D(null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.href,"localFilePath");if(!r||!r.includes(".")){return null!==(t={doc:".docx",sheet:".xlsx",slide:".pptx",pdf:".pdf"}[pe()])&&void 0!==t?t:""}return`.${r.split(".").pop()}`}if("pdf"===pe())return".pdf";if(Me()===ke.drive){return`.${null!==(i=null===(o=null===(n=null===(r=w())||void 0===r?void 0:r.docInfo)||void 0===n?void 0:n.cosInfo)||void 0===o?void 0:o.driveExt)&&void 0!==i?i:""}`}return""}const Le={};let xe=!1,Ue=!1,Be=!1;function je(e={}){var t,r;Object.assign(Le,Object.assign({table:"dc03111",third_appid:(null===(r=null===(t=A().collab_client_vars)||void 0===t?void 0:t.apid)||void 0===r?void 0:r.apid)||null,uin:ue(),uid:le(),user_mac:de(),uin_type:he(),platform:Ie(),appid:a.default.isElectronTencentDocsClient?k("TDAppDesktop"):a.default.isPCTencentDocsClient?k("TxDocsPC"):a.default.isTencentDocsApp?k("TencentDocs"):void 0,touin:Te(),isOwner:_e(),file_type:ve(),id:Re(),source1:Fe(),source2:"",source3:Ne()||fe(),obj1:Ee(),obj2:be(),ver1:ye(),ver2:Te(),ver3:ge(),ver4:Ce(),web_version:Oe(),abtest:window.ExpIdList||null,frontend_ext:De()},function(){return X()?{work_weixin_ext:JSON.stringify({corpid:(null===(t=null===(e=w())||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.corpId)||(null===(r=A().userInfo)||void 0===r?void 0:r.corp_id)||null,itemname:"",vid:le(),logid:"",platform:we(),dver:Se(),wxwork_version:a.default.getWxWorkVersion(),cef_version:Ae()}),work_weixin_source:""}:{};var e,t,r}()),e);const n=I("free_go_proxy")||I("env_name")||I("env_id")||I("fd");n&&(Le.dev_route_id=n)}const $e="@tencent-tencent-doc-report";function We(e){const t=new Set;return JSON.stringify(e,((e,r)=>{if(function(e){return function(e,t){return Object.prototype.toString.call(t)===`[object ${e}]`}("Object",e)}(r)||Array.isArray(r)){if(t.has(r))return"[Circular]";t.add(r)}return r}))}function Ge(e){return"className"in e}function He(e,t,r){var n,o;try{if(null===(n=window.TencentDocReport)||void 0===n?void 0:n.tencentDocReportSDK)return void(null===(o=window.TencentDocReport.tencentDocReportSDK)||void 0===o?void 0:o[e][t]).apply(null,r);qe({className:e,methodName:t,argsStringified:We(r)})}catch(e){console.error(e)}}function Ve(e,t){var r,n;try{if(null===(r=window.TencentDocReport)||void 0===r?void 0:r.tencentDocReportSDK)return void(null===(n=window.TencentDocReport)||void 0===n||n.tencentDocReportSDK[e].apply(null,t));qe({functionName:e,argsStringified:We(t)})}catch(e){console.error(e)}}function qe(e){var t;window.tencentDocReportBuffers=null!==(t=window.tencentDocReportBuffers)&&void 0!==t?t:[],window.tencentDocReportBuffers.push(e)}function Ke(){window.tencentDocReportBuffers=[],delete window.tencentDocReportBuffers}var Ye,Qe,ze;function Xe(...e){Ve("tdw",e)}function Je(...e){Ve("tdwSingle",e)}function Ze(...e){}function et(...e){Ve("webLogAndEsReport",e)}function tt(...e){Ve("tipReport",e)}function rt(...e){Ve("webLog",e)}function nt(...e){}ne()&&(Ye=X()?q:V,(null===(Qe=window.TencentDocReport)||void 0===Qe?void 0:Qe.tencentDocReportInjected)||(window.TencentDocReport||(window.TencentDocReport={tencentDocReportBundleURL:Ye,tencentDocReportInjected:!1}),(ze=Ye,new Promise((e=>{const t=document.createElement("script");t.async=!0,t.src=ze,t.id=$e,t.crossOrigin="anonymous",t.setAttribute("retry-when-error","true"),t.onload=()=>{var t;e(null===(t=window.TencentDocReport)||void 0===t?void 0:t.tencentDocReportSDK)},window.TencentDocReport||(window.TencentDocReport={}),window.TencentDocReport.tencentDocReportInjected||(window.TencentDocReport.tencentDocReportInjected=!0,window.tencentDocReportInjected=!0,(document.head||document.body).appendChild(t))}))).then((()=>{var e,t,r,n,o;if(window.tencentDocReportBuffers)for(const i of window.tencentDocReportBuffers)Ge(i)?(null===(t=null===(e=window.TencentDocReport)||void 0===e?void 0:e.tencentDocReportSDK)||void 0===t?void 0:t[i.className][i.methodName]).apply(null,JSON.parse(i.argsStringified)):null===(o=null===(n=null===(r=window.TencentDocReport)||void 0===r?void 0:r.tencentDocReportSDK)||void 0===n?void 0:n[i.functionName])||void 0===o||o.apply(null,JSON.parse(i.argsStringified))})).then((()=>{Ke()})).catch((()=>{Ke()}))));const ot={init:(...e)=>{He("KVR","init",e)},oss:(...e)=>{He("KVR","oss",e)},resetDefaultOssData:(...e)=>{He("KVR","resetDefaultOssData",e)}},it={init:(...e)=>{He("cube","initCubeReport",e)},report:(...e)=>{He("cube","report",e)},wecomDocs:(...e)=>{He("cube","wecomDocs",e)},tips:(...e)=>{He("cube","tips",e)},wdocs:(...e)=>{He("cube","wdocs",e)},retcode:(...e)=>{He("cube","retcode",e)},tdw:(...e)=>{He("cube","tdw",e)}};function at(...e){Ve("zzsStatus",e)}function st(...e){Ve("zzsValue",e)}function ct(...e){Ve("idkey",e)}function ut(...e){Ve("resetDefaultTdwData",e)}function lt(){return function(){const e=A();return!xe&&e.ownerId&&(xe=!0,je()),!Ue&&e.userInfo&&(Ue=!0,je()),!Be&&Se()&&(Be=!0,je()),Le}()}function dt(...e){Ve("monitor",e)}function ft(...e){Ve("retcode",e)}function ht(...e){Ve("retcodeEnt",e)}function mt(...e){Ve("huatuo",e)}var pt={tdw:Xe,tdwSingle:Je,reportErrorCode:Ze,webLogAndEsReport:et,tipReport:tt,webLog:rt,esLogReport:nt,KVR:ot,cube:it,zzsStatus:at,zzsValue:st,idkey:ct,resetDefaultTdwData:ut,getDefaultTdwData:lt,monitor:dt,retcode:ft,retcodeEnt:ht,huatuo:mt}},"5b34b47c3b":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return p}));r("342844cefa"),r("a84962d637"),r("c554310b5c"),r("bcb5d93d36");var n,o=r("7a5536c9bf"),i=r.n(o),a=r("9132715560"),s=r.n(a),c=r("6a364eb35c"),u=r.n(c),l=r("85d0a7609b"),d=r.n(l),f=(r("8a35b54c1d"),r("8ee19818c4"),r("cd88b12bb6"),r("4a351e9268"));function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.Init=0]="Init",e[e.Sending=1]="Sending",e[e.Retrying=2]="Retrying",e[e.BaseRevTooLow=3]="BaseRevTooLow",e[e.Error=4]="Error",e[e.Accepted=5]="Accepted"}(n||(n={}));var p=function(){function e(t){s()(this,e),d()(this,"status",n.Init),d()(this,"expectedRev",void 0),d()(this,"blockTimer",void 0),d()(this,"blockedRetryCount",0),this.upSteamData=t}return u()(e,[{key:"taskId",get:function(){return this.upSteamData.taskId}},{key:"revision",get:function(){return this.upSteamData.baseRev}},{key:"commands",get:function(){return this.upSteamData.commands}},{key:"serialize",value:function(){var e=this.upSteamData.commands.filter((function(e){var t=e.mutations;return!(null==t||!t.length)})),t=[{mutations:[]}];e.forEach((function(e){var r;return(r=t[0].mutations).push.apply(r,i()(e.mutations))}));var r=f.a.fromCommandData(e).toBase64String(),n=r?"".concat(r,"\n"):"[]\n",o=m(m({},this.upSteamData),{},{changeset:n});return Reflect.deleteProperty(o,"commands"),o}},{key:"setStatus",value:function(e){this.status=e}},{key:"getStatus",value:function(){return this.status}},{key:"getExpectedRev",value:function(){return this.expectedRev}},{key:"setExpectedRev",value:function(e){this.expectedRev=e}},{key:"startDetectIsBlocked",value:function(e){var t=this;this.stopDetectIsBlocked(),this.blockTimer=setTimeout((function(){t.status!==n.Sending||e()}),75e3)}},{key:"stopDetectIsBlocked",value:function(){void 0!==this.blockTimer&&(clearTimeout(this.blockTimer),this.blockTimer=void 0)}},{key:"increaseBlockedRetryCount",value:function(){this.blockedRetryCount+=1}},{key:"getBlockedRetryCount",value:function(){return this.blockedRetryCount}}]),e}()},"5c5dc9725b":function(e,t,r){"use strict";var n,o,i;r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),function(e){e.AcceptCommit="ACCEPT_COMMIT",e.CommitError="COMMIT_ERROR",e.TaskDuplicate="TASK_DUPLICATE"}(n||(n={})),function(e){e.Room="room",e.Server="server"}(o||(o={})),function(e){e.Block="block",e.RoomError="roomError",e.CommitError="commitError"}(i||(i={}))},"695327e097":function(e,t,r){var n=r("e4a614173c").default;function o(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=o=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),s=new A(n||[]);return a(i,"_invoke",{value:C(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var m={};function p(){}function v(){}function _(){}var E={};d(E,c,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(I([])));y&&y!==r&&i.call(y,c)&&(E=y);var T=_.prototype=p.prototype=Object.create(E);function g(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(o,a,s,c){var u=h(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==n(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function C(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return F()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=O(a,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=h(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,m;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:F}}function F(){return{value:void 0,done:!0}}return v.prototype=_,a(T,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:v,configurable:!0}),v.displayName=d(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},g(R.prototype),d(R.prototype,u,(function(){return this})),t.AsyncIterator=R,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new R(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(T),d(T,l,"Generator"),d(T,c,(function(){return this})),d(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),w(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;w(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),m}},t}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},"69672a4655":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NUMBER_FORMAT_NAME=t.CUSTOM_FORMAT_TABLE=t.MSO_FORMAT_MAP=t.SUPPORT_CURRENCY_LIST=t.COLOR_MAP=t.MONTHS=t.DAYS=t.RESERVED_NUMBER_FORMAT_NUM=t.BUILDIN_NUMBER_FORMAT=t.INVALID_VALUE=t.DEFAULT_FORMAT_PATTERN=t.DEFAULT_FORMAT=void 0;var n="General";t.DEFAULT_FORMAT_PATTERN=n;var o={id:0,pattern:n};t.DEFAULT_FORMAT=o;t.INVALID_VALUE="#INVALID_DATE!";t.RESERVED_NUMBER_FORMAT_NUM=164;var i=[n,"0","0.00","#,##0","#,##0.00","\\¥#,##0;\\¥-#,##0","\\¥#,##0;]\\¥-#,##0","\\¥#,##0.00;\\¥-#,##0.00","\\¥#,##0.00;]\\¥-#,##0.00","0%","0.00%","0.00E+00","# ?/?","# ??/??","yyyy/m/d","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","hh:mm:ss","yyyy/m/d h:mm","\\$#,##0_);(\\$#,##0)","\\$#,##0_);](\\$#,##0)","\\$#,##0.00_);(\\$#,##0.00)","\\$#,##0.00_);](\\$#,##0.00)",'yyyy"年"m"月"','m"月"d"日"','m"月"d"日"',"m/d/yy",'yyyy"年"m"月"d"日"','h"时"mm"分"','h"时"mm"分"ss"秒"','上午/下午h"时"mm"分"','上午/下午h"时"mm"分"ss"秒"','yyyy"年"m"月"',"#,##0;-#,##0","#,##0;]-#,##0","#,##0.00;-#,##0.00","#,##0.00;]-#,##0.00",'_ * #,##0_ ;_ * -#,##0_ ;_ * "-"_ ;_ @_ ','_ \\¥* #,##0_ ;_ \\¥* -#,##0_ ;_ \\¥* "-"_ ;_ @_ ','_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ \\¥* #,##0.00_ ;_ \\¥* -#,##0.00_ ;_ \\¥* "-"??_ ;_ @_ ',"mm:ss","mm:ss","mm:ss.0","##0.0E+0","@",'yyyy"年"m"月"','m"月"d"日"','yyyy"年"m"月"','m"月"d"日"','m"月"d"日"','上午/下午h"时"mm"分"','上午/下午h"时"mm"分"ss"秒"','yyyy"年"m"月"','m"月"d"日"',"0","0.00","#,##0","#,##0.00","\\¥#,##0;\\¥-#,##0","\\¥#,##0;]\\¥-#,##0","\\¥#,##0.00;\\¥-#,##0.00","\\¥#,##0.00;]\\¥-#,##0.00","0%","0.00%","# ?/?","# ??/??","yyyy/m/d","yyyy/m/d","d-mmm-yy","d-mmm","mmm-yy","h:mm","h:mm:ss","yyyy/m/d h:mm","mm:ss","mm:ss","mm:ss.0"];t.BUILDIN_NUMBER_FORMAT=i;t.DAYS=[["Sun","Sunday","星期天","周日"],["Mon","Monday","星期一","周一"],["Tue","Tuesday","星期二","周二"],["Wed","Wednesday","星期三","周三"],["Thu","Thursday","星期四","周四"],["Fri","Friday","星期五","周五"],["Sat","Saturday","星期六","周六"]];t.MONTHS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];t.COLOR_MAP={Black:"#000000",Blue:"#0000FF",Cyan:"#00FFFF",Green:"#008000",Magenta:"#FF00FF",Red:"#FF0000",White:"#FFFFFF",Yellow:"#FFFF00","黑色":"#000000","蓝色":"#0000FF","蓝绿色":"#00FFFF","绿色":"#008000","洋红色":"#FF00FF","红色":"#FF0000","白色":"#FFFFFF","黄色":"#FFFF00","颜色0":"#00000000","颜色1":"#00FFFFFF","颜色2":"#00FF0000","颜色3":"#0000FF00","颜色4":"#000000FF","颜色5":"#00FFFF00","颜色6":"#00FF00FF","颜色7":"#0000FFFF","颜色8":"#00000000","颜色9":"#00FFFFFF","颜色10":"#00FF0000","颜色11":"#0000FF00","颜色12":"#000000FF","颜色13":"#00FFFF00","颜色14":"#00FF00FF","颜色15":"#0000FFFF","颜色16":"#00800000","颜色17":"#00008000","颜色18":"#00000080","颜色19":"#00808000","颜色20":"#00800080","颜色21":"#00008080","颜色22":"#00C0C0C0","颜色23":"#00808080","颜色24":"#009999FF","颜色25":"#00993366","颜色26":"#00FFFFCC","颜色27":"#00CCFFFF","颜色28":"#00660066","颜色29":"#00FF8080","颜色30":"#000066CC","颜色31":"#00CCCCFF","颜色32":"#00000080","颜色33":"#00FF00FF","颜色34":"#00FFFF00","颜色35":"#0000FFFF","颜色36":"#00800080","颜色37":"#00800000","颜色38":"#00008080","颜色39":"#000000FF","颜色40":"#0000CCFF","颜色41":"#00CCFFFF","颜色42":"#00CCFFCC","颜色43":"#00FFFF99","颜色44":"#0099CCFF","颜色45":"#00FF99CC","颜色46":"#00CC99FF","颜色47":"#00FFCC99","颜色48":"#003366FF","颜色49":"#0033CCCC","颜色50":"#0099CC00","颜色51":"#00FFCC00","颜色52":"#00FF9900","颜色53":"#00FF6600","颜色54":"#00666699","颜色55":"#00969696","颜色56":"#00003366","颜色57":"#00339966","颜色58":"#00003300","颜色59":"#00333300","颜色60":"#00993300","颜色61":"#00993366","颜色62":"#00333399","颜色63":"#00333333",Color0:"#00000000",Color1:"#00FFFFFF",Color2:"#00FF0000",Color3:"#0000FF00",Color4:"#000000FF",Color5:"#00FFFF00",Color6:"#00FF00FF",Color7:"#0000FFFF",Color8:"#00000000",Color9:"#00FFFFFF",Color10:"#00FF0000",Color11:"#0000FF00",Color12:"#000000FF",Color13:"#00FFFF00",Color14:"#00FF00FF",Color15:"#0000FFFF",Color16:"#00800000",Color17:"#00008000",Color18:"#00000080",Color19:"#00808000",Color20:"#00800080",Color21:"#00008080",Color22:"#00C0C0C0",Color23:"#00808080",Color24:"#009999FF",Color25:"#00993366",Color26:"#00FFFFCC",Color27:"#00CCFFFF",Color28:"#00660066",Color29:"#00FF8080",Color30:"#000066CC",Color31:"#00CCCCFF",Color32:"#00000080",Color33:"#00FF00FF",Color34:"#00FFFF00",Color35:"#0000FFFF",Color36:"#00800080",Color37:"#00800000",Color38:"#00008080",Color39:"#000000FF",Color40:"#0000CCFF",Color41:"#00CCFFFF",Color42:"#00CCFFCC",Color43:"#00FFFF99",Color44:"#0099CCFF",Color45:"#00FF99CC",Color46:"#00CC99FF",Color47:"#00FFCC99",Color48:"#003366FF",Color49:"#0033CCCC",Color50:"#0099CC00",Color51:"#00FFCC00",Color52:"#00FF9900",Color53:"#00FF6600",Color54:"#00666699",Color55:"#00969696",Color56:"#00003366",Color57:"#00339966",Color58:"#00003300",Color59:"#00333300",Color60:"#00993300",Color61:"#00993366",Color62:"#00333399",Color63:"#00333333"};t.SUPPORT_CURRENCY_LIST=[{symbol:"￥",type:"currency-chs",pattern:'"¥"#,##0_);[Red]\\("¥"#,##0\\)',pattern_decimal:'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)'},{symbol:"¥",type:"currency-chs",pattern:'"¥"#,##0_);[Red]\\("¥"#,##0\\)',pattern_decimal:'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)'},{symbol:"HK$",type:"currency-hk",pattern:"[$HK$-C04]#,##0_);[Red]\\([$HK$-C04]#,##0\\)",pattern_decimal:"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)"},{symbol:"$",type:"currency-en",pattern:"\\$#,##0_);[Red]\\(\\$#,##0\\)",pattern_decimal:"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)"},{symbol:"US$",type:"currency-en",pattern:"\\U\\S\\$#,##0_);[Red]\\(\\U\\S\\$#,##0\\)",pattern_decimal:"\\U\\S\\$#,##0.00_);[Red]\\(\\U\\S\\$#,##0.00\\)"},{symbol:"€",type:"currency-eu",pattern:"#,##0€_);[Red](#,##0€)",pattern_decimal:"#,##0.00€_);[Red](#,##0.00€)"},{symbol:"€",type:"currency-eu",pattern:"€#,##0_);[Red](€#,##0)",pattern_decimal:"€#,##0.00_);[Red](€#,##0.00)"},{symbol:"£",type:"currency-uk",pattern:"£#,##0_);[Red](£#,##0)",pattern_decimal:"£#,##0.00_);[Red](£#,##0.00)"}];t.MSO_FORMAT_MAP={Standard:"#,##0.00",Scientific:"0.00E+00",Percent:"0.00%","Short Date":"yyyy/m/d","Long Date":'yyyy"年"m"月"d"日"',"General Date":"yyyy/m/d hh:mm","Medium Date":"d-mmm-yy","Long Time":"h:mm:ss AM/PM","Medium Time":"h:mm AM/PM","Short Time":"hh:mm",'AM/PMh"时"mm"分"':'上午/下午h"时"mm"分"','AM/PMh"时"mm"分"ss"秒"':'上午/下午h"时"mm"分"ss"秒"',Fixed:"#,##0.00_ ;@"};var a;t.CUSTOM_FORMAT_TABLE=[{label:"G/通用格式",formatData:"General"},{label:"0",formatData:"0"},{label:"0.00",formatData:"0.00"},{label:"#,##0",formatData:"#,##0"},{label:"#,##0.00",formatData:"#,##0.00"},{label:"#,##0;-#,##0",formatData:"#,##0;-#,##0"},{label:"#,##0;[Red]-#,##0",formatData:"#,##0;[Red]-#,##0"},{label:"#,##0.00;-#,##0.00",formatData:"#,##0.00;-#,##0.00"},{label:"#,##0.00;[Red]-#,##0.00",formatData:"#,##0.00;[Red]-#,##0.00"},{label:"¥#,##0;¥-#,##0",formatData:'"¥"#,##0;"¥"-#,##0'},{label:"¥#,##0;[Red]¥-#,##0",formatData:'"¥"#,##0;[Red]"¥"-#,##0'},{label:"¥#,##0.00;¥-#,##0.00",formatData:'"¥"#,##0.00;"¥"-#,##0.00'},{label:"¥#,##0.00;[Red]¥-#,##0.00",formatData:'"¥"#,##0.00;[Red]"¥"-#,##0.00'},{label:"0%",formatData:"0%"},{label:"0.00%",formatData:"0.00%"},{label:"0.00E+00",formatData:"0.00E+00"},{label:"##0.0E+0",formatData:"##0.0E+0"},{label:"# ?/?",formatData:"# ?/?"},{label:"# ??/??",formatData:"# ??/??"},{label:"$#,##0_);($#,##0)",formatData:"$#,##0_);($#,##0)"},{label:"$#,##0_);[Red]($#,##0)",formatData:"$#,##0_);[Red]($#,##0)"},{label:"$#,##0.00_);($#,##0.00)",formatData:"$#,##0.00_);($#,##0.00)"},{label:"$#,##0.00_);[Red]($#,##0.00)",formatData:"$#,##0.00_);[Red]($#,##0.00)"},{label:'yyyy"年"m"月"',formatData:'yyyy"年"m"月"'},{label:'m"月"d"日"',formatData:'m"月"d"日"'},{label:"yyyy/m/d",formatData:"yyyy/m/d"},{label:'yyyy"年"m"月"d"日"',formatData:'yyyy"年"m"月"d"日"'},{label:"m/d/yy",formatData:"m/d/yy"},{label:"d-mmm-yy",formatData:"d-mmm-yy"},{label:"d-mmm",formatData:"d-mmm"},{label:"mmm-yy",formatData:"mmm-yy"},{label:"h:mm AM/PM",formatData:"h:mm AM/PM"},{label:"h:mm:ss AM/PM",formatData:"h:mm:ss AM/PM"},{label:"h:mm",formatData:"h:mm"},{label:"h:mm:ss",formatData:"h:mm:ss"},{label:'h"时"mm"分"',formatData:'h"时"mm"分"'},{label:'h"时"mm"分"ss"秒"',formatData:'h"时"mm"分"ss"秒"'},{label:'上午/下午h"时"mm"分"',formatData:'上午/下午h"时"mm"分"'},{label:'上午/下午h"时"mm"分"ss"秒"',formatData:'上午/下午h"时"mm"分"ss"秒"'},{label:"yyyy/m/d h:mm",formatData:"yyyy/m/d h:mm"},{label:"mm:ss",formatData:"mm:ss"},{label:"mm:ss.0",formatData:"mm:ss.0"},{label:"@",formatData:"@"},{label:"[h]:mm:ss",formatData:"[h]:mm:ss"}],function(e){e.GENERAL="auto",e.TEXT="text",e.NUMBER="number",e.PERCENT="percent",e.CURRENCY="currency",e.DATE="date",e.TIME="time",e.DATE_TIME="date-time",e.FRACTION="fraction",e.SCIENTIFIC="scientific",e.ACCOUNTING="accounting",e.SPECIAL="special",e.CUSTOM="custom"}(a||(a={}));var s=[{type:a.GENERAL,name:"常规"},{type:a.TEXT,name:"文本"},{type:a.NUMBER,name:"数值"},{type:a.PERCENT,name:"百分比"},{type:a.SCIENTIFIC,name:"科学记数"},{type:a.CURRENCY,name:"货币"},{type:a.TIME,name:"时间"},{type:a.DATE,name:"日期"},{type:a.DATE_TIME,name:"日期"},{type:a.ACCOUNTING,name:"会计专用"},{type:a.FRACTION,name:"分数"},{type:a.SPECIAL,name:"特殊"},{type:a.CUSTOM,name:"自定义"}];t.NUMBER_FORMAT_NAME=s},"6a2a1748de":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.positiveNumberOrString=t.isPrecisionBiggerThan16=t.mathFloor=t.mathLog10=void 0,t.mathLog10=function(e){return Math.log10?Math.log10(e):Math.log(e)*Math.LOG10E},t.mathFloor=function(e){return e>-2147483648&&e<2147483647?""+(e>=0?0|e:e-1|0):""+Math.floor(e)},t.isPrecisionBiggerThan16=function(e){if("number"==typeof e)return!1;if(!e)return!1;var t=e.indexOf("."),r=e;-1!==t&&(r=e.substr(0,t)+e.substr(t+1,e.length));var n=(r=(r=r.replace(/[+-]/,"")).toUpperCase()).indexOf("E");-1!==n&&(r=r.substr(0,n));var o=r.match(/0*([1-9]([0-9]*[1-9])?)0*$/);return!!(o&&o[1].length>16)},t.positiveNumberOrString=function(e){return"number"==typeof e?-e:e.slice(1)}},"6ab9983a4e":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=new(n(r("d3a0d3eb66")).default)(100);t.default=o},"6e8701fae0":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateNumberFormat=void 0;var n=r("6a2a1748de"),o=r("f281127eb3"),i=r("55c6175634");t.calculateNumberFormat=function(e,t,r){var a,s,c=r.parsedNumberString,u=r.needCutEndPercentageLabel,l=r.numberFormatTokenIndexes,d=r.formatListLength;40===c.charCodeAt(0)?a=i.write_num(o.TokenType.LeftParenthesis,c,e):(s=Number(e)<0&&d>1?n.positiveNumberOrString(e):e,a=i.write_num(o.TokenType.Number,c,s)),u&&(null==a?void 0:a.endsWith("%"))&&(a=a.substr(0,a.length-1)),1!==l.length?function(e,t,r){var n=t.length,i=n,a=r.length-1;for(;a>=1&&n;){var s=r[a],c=String(e[s].value);n-=Math.min(c.length,i),e[s].type=o.TokenType.Text,e[s].value=t.substring(n,i),a-=1,i=n}if(0===a){return e[s=r[0]].type=o.TokenType.Text,void(e[s].value=t.substring(0,i))}for(;a>=0;){e[s=r[a]].type=o.TokenType.Text,e[s].value="",a-=1}}(t,a,l):t[l[0]].value=a}},"72cd22511f":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NumberFormat=void 0;var o=r("008d473b9e"),i=r("69672a4655"),a=n(r("d292a8cd59")),s=r("55c6175634"),c=function(){function e(e){0!==e.id&&e.pattern!==i.DEFAULT_FORMAT_PATTERN||(this._type=o.NUMBER_FORMAT_TYPE.GENERAL),this._type=null,this._id=e.id||null,this._pattern=e.pattern||null}return e.newInstance=function(e){return a.default.createInstance(e)},e.serialize=function(e,t){return void 0===t&&(t={}),t.simpleSerialize?[[0],[e.id]]:[[0,1],[e.id,e.pattern]]},e.deserialize=function(e){return a.default.createInstance({id:e[1][0],pattern:e[1][1]})},e.prototype.getOptions=function(){return{id:this.id,pattern:this.pattern}},Object.defineProperty(e.prototype,"id",{get:function(){return this._id||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pattern",{get:function(){return this._pattern||i.DEFAULT_FORMAT_PATTERN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){if(!this._type){var e=s.getCellNumberFormatType(this.pattern);this._type=e.group}return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_key",{get:function(){return"N"+this.toString()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(e){return void 0===e&&(e={}),e.simpleSerialize?[this.id]:[this.id,this.pattern]},e.prototype.equals=function(e){return this.id===e.id&&this.type===e.type&&this.pattern===e.pattern},e.prototype.clone=function(){return this},e.prototype.toString=function(){return"{"+this.id+","+this.pattern+"}"},e}();t.NumberFormat=c},"73cf07311d":function(e,t,r){var n=r("e4a614173c").default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},"7718930a1d":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return s}));class n{next(){return this.number+=1,`${this.session}-${this.number}`}constructor(){this.number=0,this.session=Math.random().toString(36).slice(2)}}var o;!function(e){e.Ping="ping",e.Pong="pong",e.Request="request",e.Response="response",e.Channel="channel"}(o||(o={}));const i="__PORTAL__";class a{register(e,t){this.services[e]=t,this.transport.receive("request",(r=>{if(r.$owner!==i||r.payload.serviceName!==e)return;const{apiName:n,seq:o}=r.payload,a=(e,t)=>{this.readyPromise.then((()=>{this.transport.send({type:"response",payload:{seq:o,error:e,data:t},$owner:i})}))},c=t[n];if("function"!=typeof c)return void a(`PortalService ${e}::${n} is not a function`);let u;try{u=c.call(t,...r.payload.args)}catch(t){return void a(`PortalService ${e}::${n} throws an error: ${s(t)}`)}"function"!=typeof(null==u?void 0:u.then)&&(u=Promise.resolve(u)),u.then((e=>a(void 0,e))).catch((t=>{a(`PortalService ${e}::${n} rejects an error: ${s(t)}`)}))}))}service(e){return this.services[e]||(this.services[e]=function(e,t,r,n){return new Proxy({},{get:(a,s)=>(...a)=>{const c=r.next();return n.then((()=>{t.send({type:o.Request,payload:{seq:c,serviceName:e,apiName:String(s),args:a},$owner:i})})),new Promise(((e,r)=>{const n=t.receive(o.Response,(t=>{if(t.$owner!==i||t.payload.seq!==c)return;n();const{error:o,data:a}=t.payload;o?r(new Error(o)):e(a)}))}))}})}(e,this.transport,this.seq,this.readyPromise)),this.services[e]}channel(e){return function(e,t,r){const n=[];return t.receive(o.Channel,(t=>{if(t.$owner===i&&t.payload.channelName===e)for(const e of n)e(t.payload.data)})),{publish(n){r.then((()=>{t.send({type:o.Channel,payload:{channelName:e,data:n},$owner:i})}))},subscribe:e=>(n.push(e),()=>{const t=n.indexOf(e);t>=0&&n.splice(t,1)})}}(e,this.transport,this.readyPromise)}dispose(){this.transport.close()}open(){const e=setInterval((()=>{this.transport.send({type:"ping",payload:void 0,$owner:i})}),100);this.readyPromise=new Promise((t=>{const r=this.transport.receive("pong",(()=>{r(),clearInterval(e),t()}))}))}constructor(e){this.transport=e,this.seq=new n,this.services={},e.receive("ping",(t=>{t.$owner===i&&e.send({type:"pong",payload:void 0,$owner:i})})),this.open()}}function s(e){var t,r;return e instanceof Error&&null!==(r=null!==(t=e.stack)&&void 0!==t?t:e.message)&&void 0!==r?r:String(e)}},"7f1cfe4422":function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return h}));var n,o,i,a=r("85d0a7609b"),s=r.n(a),c=(r("8a35b54c1d"),r("fce3077cdf"),r("8ee19818c4"),r("c6244f7705"),r("bd80bf2d0f"),r("7264fb5e8f"));!function(e){e[e.None=0]="None",e[e.Unknown=1]="Unknown",e[e.ServerError=2]="ServerError",e[e.Timeout=3]="Timeout",e[e.LoginExpired=4]="LoginExpired",e[e.AuthExpired=5]="AuthExpired",e[e.SizeLimit=6]="SizeLimit",e[e.DataError=7]="DataError",e[e.SecurityStrike=8]="SecurityStrike",e[e.FullRoom=9]="FullRoom",e[e.Cancel=10]="Cancel"}(o||(o={})),function(e){e[e.COMMIT_DUPLICATE=604460]="COMMIT_DUPLICATE",e[e.COMMIT_NO_AUTH=6044103]="COMMIT_NO_AUTH",e[e.COMMIT_ERROR_BASEREV_LIMIT_ERROR=640033]="COMMIT_ERROR_BASEREV_LIMIT_ERROR",e[e.INVALID_COMMIT_ATTRS=640028]="INVALID_COMMIT_ATTRS",e[e.OVERSIZE_COMMIT=640029]="OVERSIZE_COMMIT",e[e.APPLY_REVISION_CGO=640035]="APPLY_REVISION_CGO",e[e.META_DATA_NOT_EXIST=604424]="META_DATA_NOT_EXIST",e[e.CGO_TRANSFORM=604488]="CGO_TRANSFORM",e[e.COMMIT_ERROR_CANCEL_SENDING=999999]="COMMIT_ERROR_CANCEL_SENDING",e[e.COMMIT_ERROR_CANCEL_WAITING=999998]="COMMIT_ERROR_CANCEL_WAITING"}(i||(i={}));var u,l=(n={0:o.None},s()(n,c.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_CLIENT_DATA_ERROR,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,o.LoginExpired),s()(n,c.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,o.AuthExpired),s()(n,c.RoomWebsocketErrorCode.SOCKET_PACKAGE_SIZE_TOO_LARGE,o.SizeLimit),s()(n,c.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_ALREADY_EXIST,o.None),s()(n,c.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,o.FullRoom),s()(n,c.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE,o.AuthExpired),s()(n,c.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_COMMAND_NOT_SUPPORTED,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_ERROR,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_SUBID_ERROR,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_ACTION_LENGTH,o.DataError),s()(n,40004,o.AuthExpired),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_CHANGESET_EASYSYNC,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL,o.ServerError),s()(n,40007,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_READ_FAIL,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_BASEREV_ERROR,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_TYPE,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_PROTO,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_GRAY_VERSION_INCONFORMITY,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT,o.SecurityStrike),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_CONTENT_LIMIT,o.SizeLimit),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_REV_DIFF_UPPER_TEN,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_EASYSYNC_TIMEOUT,o.SizeLimit),s()(n,c.RoomWebsocketErrorCode.SOCKET_CLIENT_VERSION_TOO_OLD,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_JS_TOO_OLD,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_NOT_CONFILCT_TO_COMMIT,o.DataError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_UNKNOWN_ERROR,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR,o.ServerError),s()(n,c.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL,o.FullRoom),s()(n,c.RoomWebsocketErrorCode.SOCKET_SEND_MESSAGE_TIMEOUT,o.Timeout),s()(n,c.RoomWebsocketErrorCode.LOGIN_INVALIDATE,o.LoginExpired),s()(n,c.RoomWebsocketErrorCode.LOGIN_FORBIDDEN,o.LoginExpired),s()(n,c.RoomWebsocketErrorCode.INACTIVE,o.Timeout),s()(n,i.COMMIT_DUPLICATE,o.Timeout),s()(n,i.COMMIT_NO_AUTH,o.AuthExpired),s()(n,i.COMMIT_ERROR_BASEREV_LIMIT_ERROR,o.DataError),s()(n,i.INVALID_COMMIT_ATTRS,o.DataError),s()(n,i.OVERSIZE_COMMIT,o.SizeLimit),s()(n,i.APPLY_REVISION_CGO,o.ServerError),s()(n,i.META_DATA_NOT_EXIST,o.ServerError),s()(n,i.CGO_TRANSFORM,o.ServerError),s()(n,i.COMMIT_ERROR_CANCEL_SENDING,o.Cancel),s()(n,i.COMMIT_ERROR_CANCEL_WAITING,o.Cancel),n);!function(e){e[e.SLIDE_ERROR_BASE=13e3]="SLIDE_ERROR_BASE",e[e.SLIDE_ERROR_UNKNOWN=13001]="SLIDE_ERROR_UNKNOWN",e[e.SLIDE_ERROR_MUT_INVALID=13002]="SLIDE_ERROR_MUT_INVALID",e[e.SLIDE_ERROR_PAGE_NOT_FOUND=13003]="SLIDE_ERROR_PAGE_NOT_FOUND",e[e.SLIDE_ERROR_PAGE_NOT_LOADED=13004]="SLIDE_ERROR_PAGE_NOT_LOADED",e[e.SLIDE_ERROR_LAYOUT_NOT_BELONG_TO_MASTER=13005]="SLIDE_ERROR_LAYOUT_NOT_BELONG_TO_MASTER",e[e.SLIDE_ERROR_PAGE_POSITION_OUT_OF_RANGE=13006]="SLIDE_ERROR_PAGE_POSITION_OUT_OF_RANGE",e[e.SLIDE_ERROR_PAGE_INSERT_POSITION_OUT_OF_RANGE=13007]="SLIDE_ERROR_PAGE_INSERT_POSITION_OUT_OF_RANGE",e[e.SLIDE_ERROR_PAGE_NOT_IN_POSITION=13008]="SLIDE_ERROR_PAGE_NOT_IN_POSITION",e[e.SLIDE_ERROR_PAGE_SHAPE_TREE_NOT_EXIST=13009]="SLIDE_ERROR_PAGE_SHAPE_TREE_NOT_EXIST",e[e.SLIDE_ERROR_CONVERT_TO_TEXTBODY=13021]="SLIDE_ERROR_CONVERT_TO_TEXTBODY",e[e.SLIDE_ERROR_INVALID_TEXT_CONTENT=13022]="SLIDE_ERROR_INVALID_TEXT_CONTENT",e[e.SLIDE_ERROR_INVALID_RUN_PROPERTIES=13023]="SLIDE_ERROR_INVALID_RUN_PROPERTIES",e[e.SLIDE_ERROR_INVALID_PARAGRAPH_PROPERTIES=13024]="SLIDE_ERROR_INVALID_PARAGRAPH_PROPERTIES",e[e.SLIDE_ERROR_INVALID_FIELD_PROPERTIES=13025]="SLIDE_ERROR_INVALID_FIELD_PROPERTIES",e[e.SLIDE_ERROR_INVALID_TEXT_PROPERTIES=13026]="SLIDE_ERROR_INVALID_TEXT_PROPERTIES",e[e.SLIDE_ERROR_INVALID_PROPERTY_UPDATE=13027]="SLIDE_ERROR_INVALID_PROPERTY_UPDATE",e[e.SLIDE_ERROR_INVALID_TEXT_OPERATION_POSITION=13028]="SLIDE_ERROR_INVALID_TEXT_OPERATION_POSITION",e[e.SLIDE_ERROR_UNKNOWN_SHAPE_TYPE=13041]="SLIDE_ERROR_UNKNOWN_SHAPE_TYPE",e[e.SLIDE_ERROR_SHAPE_NOT_FOUND_IN_PAGE=13042]="SLIDE_ERROR_SHAPE_NOT_FOUND_IN_PAGE",e[e.SLIDE_ERROR_SHAPE_NOT_FOUND=13043]="SLIDE_ERROR_SHAPE_NOT_FOUND",e[e.SLIDE_ERROR_SHAPE_NOT_IN_PAGE=13044]="SLIDE_ERROR_SHAPE_NOT_IN_PAGE",e[e.SLIDE_ERROR_SHAPE_NOT_CHILD_OF_SHAPE_TREE=13045]="SLIDE_ERROR_SHAPE_NOT_CHILD_OF_SHAPE_TREE",e[e.SLIDE_ERROR_SHAPE_TYPE_NOT_MATCH=13046]="SLIDE_ERROR_SHAPE_TYPE_NOT_MATCH",e[e.SLIDE_ERROR_SHAPE_INSERT_POS_OUT_OF_RANGE=13047]="SLIDE_ERROR_SHAPE_INSERT_POS_OUT_OF_RANGE",e[e.SLIDE_ERROR_SHAPE_NOTE_FOUND_EXIST=13048]="SLIDE_ERROR_SHAPE_NOTE_FOUND_EXIST",e[e.SLIDE_ERROR_SHAPE_NOT_IN_POSITION=13049]="SLIDE_ERROR_SHAPE_NOT_IN_POSITION",e[e.SLIDE_ERROR_SHAPE_NOT_CHILD_OF_GROUP_SHAPE=13050]="SLIDE_ERROR_SHAPE_NOT_CHILD_OF_GROUP_SHAPE",e[e.SLIDE_ERROR_SHAPE_PLACEHOLDER_NOT_EXIST=13051]="SLIDE_ERROR_SHAPE_PLACEHOLDER_NOT_EXIST",e[e.SLIDE_ERROR_SHAPE_INVALIDE_TYPE=13052]="SLIDE_ERROR_SHAPE_INVALIDE_TYPE",e[e.SLIDE_ERROR_SHAPE_ALREADY_EXISTS=13053]="SLIDE_ERROR_SHAPE_ALREADY_EXISTS",e[e.SLIDE_ERROR_SUB_CHART_INDEX_OUT_OF_BOUNDS=13061]="SLIDE_ERROR_SUB_CHART_INDEX_OUT_OF_BOUNDS",e[e.SLIDE_ERROR_CHART_NOT_FOUND=13062]="SLIDE_ERROR_CHART_NOT_FOUND",e[e.SLIDE_ERROR_SUB_CHART_POSITION_OUT_OF_RANGE=13063]="SLIDE_ERROR_SUB_CHART_POSITION_OUT_OF_RANGE",e[e.SLIDE_ERROR_SUB_CHART_NOT_FOUND=13064]="SLIDE_ERROR_SUB_CHART_NOT_FOUND",e[e.SLIDE_ERROR_SUB_CHART_TYPE_NOT_MATCH=13065]="SLIDE_ERROR_SUB_CHART_TYPE_NOT_MATCH",e[e.SLIDE_ERROR_TABLE_MUT_OUT_OF_RANGE=13071]="SLIDE_ERROR_TABLE_MUT_OUT_OF_RANGE",e[e.SLIDE_ERROR_MUT_EXCEED_TABLE_LIMIT=13072]="SLIDE_ERROR_MUT_EXCEED_TABLE_LIMIT",e[e.SLIDE_ERROR_MUT_EMPTY_TABLE=13073]="SLIDE_ERROR_MUT_EMPTY_TABLE",e[e.SLIDE_ERROR_MUT_UNMERGE_TABLE_RANGE_INVALID=13074]="SLIDE_ERROR_MUT_UNMERGE_TABLE_RANGE_INVALID",e[e.SLIDE_ERROR_MUT_MERGE_TABLE_RANGE_INVALID=13075]="SLIDE_ERROR_MUT_MERGE_TABLE_RANGE_INVALID",e[e.SLIDE_ERROR_MUT_TABLE_NOT_FOUND=13076]="SLIDE_ERROR_MUT_TABLE_NOT_FOUND",e[e.SLIDE_ERROR_MUT_TABLE_RANGE_INVALID=13077]="SLIDE_ERROR_MUT_TABLE_RANGE_INVALID",e[e.SLIDE_ERROR_TIMING_SEQ_NOT_FOUND=13081]="SLIDE_ERROR_TIMING_SEQ_NOT_FOUND",e[e.SLIDE_ERROR_UNIT_TIME_NODE_POSITION_OUT_OF_RANGE=13082]="SLIDE_ERROR_UNIT_TIME_NODE_POSITION_OUT_OF_RANGE",e[e.SLIDE_ERROR_UNIT_TIME_NODE_INSERT_POSITION_OUT_OF_RANGE=13083]="SLIDE_ERROR_UNIT_TIME_NODE_INSERT_POSITION_OUT_OF_RANGE",e[e.SLIDE_ERROR_SECTION_NOT_FOUND=13091]="SLIDE_ERROR_SECTION_NOT_FOUND",e[e.SLIDE_ERROR_SECTION_BINDING_SLIDE_INDEX_OUT_OF_RANGE=13092]="SLIDE_ERROR_SECTION_BINDING_SLIDE_INDEX_OUT_OF_RANGE",e[e.SLIDE_ERROR_SECTION_INSERT_POSITION_OUT_OF_RANGE=13093]="SLIDE_ERROR_SECTION_INSERT_POSITION_OUT_OF_RANGE",e[e.SLIDE_ERROR_THEME_HAS_EXISTED=13094]="SLIDE_ERROR_THEME_HAS_EXISTED",e[e.SLIDE_ERROR_THEME_USED=13095]="SLIDE_ERROR_THEME_USED",e[e.SLIDE_ERROR_THEME_NOT_EXIST=13096]="SLIDE_ERROR_THEME_NOT_EXIST",e[e.SLIDE_ERROR_RESOURCE_TYPE_NOT_MATCH=13097]="SLIDE_ERROR_RESOURCE_TYPE_NOT_MATCH",e[e.SLIDE_ERROR_SECTION_ALREADY_EXISTS=13098]="SLIDE_ERROR_SECTION_ALREADY_EXISTS",e[e.SLIDE_ERROR_INVALID_TRANSFORM_ARGUMENT=13111]="SLIDE_ERROR_INVALID_TRANSFORM_ARGUMENT",e[e.SLIDE_ERROR_NO_SHAPE_TO_COMPUTE_TRANSFORM=13112]="SLIDE_ERROR_NO_SHAPE_TO_COMPUTE_TRANSFORM"}(u||(u={}));var d,f=Object.values(u).filter((function(e){return"number"==typeof e}));function h(e){var t;return null!==(t=l[e.toString()])&&void 0!==t?t:o.Unknown}f.forEach((function(e){l[e.toString()]=o.DataError})),function(e){e[e.ResponseError=1]="ResponseError",e[e.CGIError=2]="CGIError",e[e.ResultError=3]="ResultError",e[e.ParamError=4]="ParamError",e[e.Timeout=5]="Timeout"}(d||(d={}))},"822fa1925c":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("311f2fc38c"),o=r("7718930a1d");class i{open(){return Object(n.a)((function*(){}))()}close(){var e=this;return Object(n.a)((function*(){var t,r;null===(t=(r=e.target).terminate)||void 0===t||t.call(r)}))()}send(e){this.target.postMessage(e)}receive(e,t){const r=r=>{const n=r.data;(null==n?void 0:n.type)===e&&(null==n?void 0:n.$owner)===o.a&&t(n)};return this.target.addEventListener("message",r),()=>this.target.removeEventListener("message",r)}constructor(e){this.target=e}}},"8959d513b6":function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return y})),function(e){e.INIT="openapi_init"}(n||(n={}));var o,i={fcbd12e670db451faf79ba72a0c70f5e:["registerMentionCallbacks","removeMentionCallbacks","insertMention","cancelInsertMention"],b367ba8923dd41f28af142ddfcdcfd6a:["registerMentionCallbacks","removeMentionCallbacks","insertMention","cancelInsertMention"],"https://docs.qq.com":["on:openLink","off:openLink","transferToPDF","transferToImage","transferToWord","transferToExcel","transferToPPT","showSearchReplace","setFeatureConfig","playPresentation","registerMentionCallbacks","removeMentionCallbacks","insertMention","cancelInsertMention","expandMobileOptionsMenu","onDrivePermissionChange","showOutline","setScreenLayout","getScreenLayout"]},a=["https://fanbook.mobi","https://docs.fanbook.cn","https://docs.qq.com"];!function(e){e[e.SCROLL=1]="SCROLL",e[e.PAGED=3]="PAGED"}(o||(o={}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function u(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function l(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function d(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function f(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}var p,v="OpenAPI";!function(e){e.CLIENT_API_READY="ClientAPIReady",e.EXECUTE_CALLBACK="ExecuteCallBack",e.CALL_FUNCTION="CallFunction",e.CALL_MQQ="CallMqq"}(p||(p={}));var _=function(){function e(e){var t=this;this.docsIframe=e,this.callbackMap=new Map,this.isClientAPIReady=!1,this.receiveMessage=function(e){var r,n,o,i,a,s,c,u,l=e.origin,d=e.data,f=e.source;if("https://docs.qq.com"===l&&f&&f===(null===(r=t.docsIframe)||void 0===r?void 0:r.contentWindow)&&"OpenAPI"===d.channel)if(d.type!==p.CLIENT_API_READY)if(d.type!==p.EXECUTE_CALLBACK){if(d.type===p.CALL_MQQ){if("ui"===(null===(i=d.params)||void 0===i?void 0:i[0])&&"setTitleButtons"===(null===(a=d.params)||void 0===a?void 0:a[1]))return;null===(c=null===(s=window.mqq)||void 0===s?void 0:s[d.functionName])||void 0===c||c.call.apply(c,m([s],h(t.parseFunctionParams(null!==(u=d.params)&&void 0!==u?u:[])),!1))}}else null===(n=t.callbackMap.get(d.callbackId))||void 0===n||n.apply(void 0,m([],h(null!==(o=d.params)&&void 0!==o?o:[]),!1));else t.handleClientAPIReady()}}return e.generateCallbackId=function(){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t="",r=0;r<8;r+=1)t+=e[Math.floor(62*Math.random())];return t},e.prototype.listenMessage=function(){window.addEventListener("message",this.receiveMessage)},e.prototype.callFunction=function(e,t){this.postMessage({channel:"OpenAPI",type:p.CALL_FUNCTION,functionName:e,params:this.formatFunctionParams(t)})},e.prototype.executeAfterClientAPIReady=function(e){this.clientAPIReadyCallback=e,this.isClientAPIReady&&e()},e.prototype.postMessage=function(e,t){var r,n;void 0===t&&(t="https://docs.qq.com"),null===(n=null===(r=this.docsIframe)||void 0===r?void 0:r.contentWindow)||void 0===n||n.postMessage(e,t)},e.prototype.formatFunctionParams=function(e){var t=this;if(Array.isArray(e))return e.map((function(e){return t.formatFunctionParams(e)}));if("function"==typeof e){var r=this.registerCallback(e);return"".concat("open-docs-sdk-callback-id=").concat(r)}return e instanceof Error?Object.fromEntries(["name","message","stack","code"].filter((function(t){return void 0!==e[t]})).map((function(t){return[t,e[t]]}))):"[object Object]"===Object.prototype.toString.call(e)?Object.fromEntries(Object.entries(e).map((function(e){var r=h(e,2),n=r[0],o=r[1];return[n,t.formatFunctionParams(o)]}))):e},e.prototype.parseFunctionParams=function(e){var t=this;if(Array.isArray(e))return e.map((function(e){return t.parseFunctionParams(e)}));if("string"==typeof e&&e.startsWith("open-docs-sdk-callback-id=")){var r=e.slice(26);if(this.callbackMap.has(r))return this.callbackMap.get(r);var n=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.postMessage({channel:"OpenAPI",type:p.EXECUTE_CALLBACK,callbackId:r,params:t.formatFunctionParams(e)})};return this.callbackMap.set(r,n),n}return"[object Object]"===Object.prototype.toString.call(e)?Object.fromEntries(Object.entries(e).map((function(e){var r=h(e,2),n=r[0],o=r[1];return[n,t.parseFunctionParams(o)]}))):e},e.prototype.registerCallback=function(t){var r,n;try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.callbackMap),i=o.next();!i.done;i=o.next()){var a=h(i.value,2),s=a[0];if(a[1]===t)return s}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}var c=e.generateCallbackId();return this.callbackMap.set(c,t),c},e.prototype.handleClientAPIReady=function(){var e;this.isClientAPIReady=!0,null===(e=this.clientAPIReadyCallback)||void 0===e||e.call(this)},e}(),E=function(){function e(e){var t=this;this.injectedAPIMethods=[],this.configure=function(e,r,n,o){var i=function(e,r){e&&t.injectAPIMethods(r),null==o||o(e,r)};t.messageHandler.executeAfterClientAPIReady((function(){t.messageHandler.callFunction("configure",[e,r,n,i])}))},this.messageHandler=new _(e),this.messageHandler.listenMessage()}return e.prototype.injectAPIMethods=function(e){var t=this,r={},n={};e.forEach((function(e){if(e.includes(":")){var o=h(e.split(":"),2),i=o[0],a=o[1];n[i]?n[i].push(a):n[i]=[a]}else r[e]={configurable:!0,value:function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.messageHandler.callFunction(e,r)}}})),Object.entries(n).forEach((function(e){var n=h(e,2),o=n[0],i=n[1];r[o]={configurable:!0,value:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(!i.some((function(t){return t===e[0]})))throw new Error("Not allowed to call `".concat(o,"` with params: ").concat(e.join(", ")));t.messageHandler.callFunction(o,e)}}})),this.injectedAPIMethods=Object.keys(r),Object.defineProperties(this,r)},e.prototype.clearAPIMethods=function(){var e=this;this.injectedAPIMethods.forEach((function(t){delete e[t]})),this.injectedAPIMethods=[]},e}(),b=["invoke","invokeClient","invokeSchema"],y=function(e){function t(t){var r=e.call(this)||this;return r.clientAPI=t,r.receiveMessage=function(e){var t,n,o,i,s,c=e.origin,u=e.data;a.includes(c)&&u.channel===v&&(r.parentOrigin=c,u.type!==p.CALL_FUNCTION?u.type===p.EXECUTE_CALLBACK&&(null===(i=r.callbackMap.get(u.callbackId))||void 0===i||i.apply(void 0,f([],d(null!==(s=u.params)&&void 0!==s?s:[]),!1))):null===(n=null===(t=r.openAPIInstance)||void 0===t?void 0:t[u.functionName])||void 0===n||n.call.apply(n,f([t],d(r.parseFunctionParams(null!==(o=u.params)&&void 0!==o?o:[])),!1)))},r}return c(t,e),t.prototype.configure=function(e){this.openAPIInstance=this.injectNamespace(e,"openApi"),this.injectConfigureMethod(this.openAPIInstance),this.injectConnectMethod(this.openAPIInstance),this.openAPIReady()},t.prototype.postMessage=function(e,t){var r;void 0===t&&(t=null!==(r=this.parentOrigin)&&void 0!==r?r:""),window.parent.postMessage(e,t)},t.prototype.openAPIReady=function(){document.body.dispatchEvent(new CustomEvent(n.INIT,{bubbles:!0})),this.isInIframe()&&(window.addEventListener("message",this.receiveMessage),this.postMessage({channel:v,type:p.CLIENT_API_READY},"*"))},t.prototype.injectNamespace=function(e,t){var r={};return Object.defineProperty(e,t,{value:r,configurable:!0}),r},t.prototype.injectConfigureMethod=function(e){var t=this;Object.defineProperties(e,{configure:{value:function(r,n,o,a){return u(t,void 0,void 0,(function(){var t=this;return l(this,(function(s){return this.verifyUserToken(r,n,o).then((function(){var n=i[r]||[];t.injectAPIMethods(e,n),null==a||a(!0,n)})).catch((function(e){null==a||a(!1,e)})),[2]}))}))}}})},t.prototype.injectConnectMethod=function(e){var t=this;Object.defineProperties(e,{connect:{value:function(r){return u(t,void 0,void 0,(function(){var t,n;return l(this,(function(o){return this.parentOrigin!==window.location.origin?(t=new Error("connect 仅支持同域调用"),null==r||r(t),[2]):(this.proxyMqq(),n=i[this.parentOrigin]||[],this.injectAPIMethods(e,n),null==r||r(null,{allowedMethods:n}),[2])}))}))}}})},t.prototype.injectAPIMethods=function(e,t){var r=this,n={},o={};t.forEach((function(e){if(e.includes(":")){var t=d(e.split(":"),2),i=t[0],a=t[1];o[i]?o[i].push(a):o[i]=[a]}else n[e]={configurable:!0,value:function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];(t=r.clientAPI)[e].apply(t,f([],d(n),!1))}}})),Object.entries(o).forEach((function(e){var t=d(e,2),o=t[0],i=t[1];n[o]={configurable:!0,value:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!i.some((function(e){return e===t[0]})))throw new Error("Not allowed to call `".concat(o,"` with params: ").concat(t.join(", ")));(e=r.clientAPI)[o].apply(e,f([],d(t),!1))}}})),Object.defineProperties(e,n)},t.prototype.proxyMqq=function(){var e=this;b.forEach((function(t){var r;(null===(r=window.mqq)||void 0===r?void 0:r[t])?Object.defineProperty(window.mqq,t,{value:function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];e.postMessage({channel:v,type:p.CALL_MQQ,functionName:t,params:e.formatFunctionParams(r)},window.location.origin)},writable:!1}):console.error("mqq 没有方法 ".concat(t))}))},t.prototype.verifyUserToken=function(e,t,r){return u(this,void 0,void 0,(function(){var n,o,i,a,s;return l(this,(function(c){switch(c.label){case 0:return n="https://docs.qq.com/oauth/v2/test?access_token=".concat(r),[4,fetch(n)];case 1:return[4,c.sent().json()];case 2:if(o=c.sent(),i=o.client_id,a=o.user_id,s=o.scope,e===i&&t===a&&s.split(",").includes("scope.file.modifiable"))return[2];throw new Error("invalid user token")}}))}))},t.prototype.isInIframe=function(){return window.self!==window.parent},t}(_);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}c(t,e),t.prototype.connect=function(e){var t=this,r=function(r,n){var o;r||(t.clearAPIMethods(),t.injectAPIMethods(null!==(o=null==n?void 0:n.allowedMethods)&&void 0!==o?o:[])),null==e||e(r,n)};this.messageHandler.executeAfterClientAPIReady((function(){t.messageHandler.callFunction("connect",[r])}))}}(E)},"8b13fcae36":function(e,t,r){"use strict";r.r(t),r.d(t,"setDefaultConfiguration",(function(){return Z})),r.d(t,"getMultUrl",(function(){return ee})),r.d(t,"newBlankWindow",(function(){return te})),r.d(t,"openNewBlankWindow",(function(){return re})),r.d(t,"tencentDocOpenUrlReload",(function(){return ne})),r.d(t,"setNewWindowUrl",(function(){return oe})),r.d(t,"isNeedScenarioRedirectLink",(function(){return ie})),r.d(t,"tencentDocOpenUrlForAll",(function(){return ae})),r.d(t,"tencentDocOpenUrl",(function(){return se}));var n=r("0774a881b4"),o=r.n(n),i=r("4f3b15d017"),a=r("dfdfcc8cff");var s=function(){var e,t,r,n;return/from=miniprogram/.test(null===(e=window)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.search)||/from=miniprogram_wedoc/.test(null===(r=window)||void 0===r||null===(n=r.location)||void 0===n?void 0:n.search)};function c(e,t){var r=t.wxUrl,n=t.replace,o=t.supportIFrame,i=Object(a.b)(o),c=Object(a.c)(o);if(s())c.location.href=e;else{if(null==i||!i.miniProgram)return function(e,t){var r,n=t.replace,o=t.windowName,i=t.windowFeatures,s=t.supportIFrame,c=Object(a.c)(s);n?null==c||null===(r=c.location)||void 0===r||r.replace(e):null==c||c.open(e,o,i)}(e,t),void console.error("no miniProgram sdk");var u=null!=r?r:function(e){if(/^https:\/\/docs\.qq\.com\/(sheet|doc|slide|form|pdf|file|mind|flowchart|rec|aio)\/(.*)$/.test(e))return"/pages/detail/detail?url=".concat(encodeURIComponent(e));return"/pages/webview/webview?url=".concat(encodeURIComponent(e))}(e);n?i.miniProgram.redirectTo({url:u}):i.miniProgram.navigateTo({url:u})}}var u,l=r("b4b29a3aa3"),d=r("695327e097"),f=r.n(d),h=r("555963f6e7"),m=r.n(h);!function(e){e[e.WxworkBrowser=1]="WxworkBrowser"}(u||(u={}));var p,v=r("f293d5439a"),_=r("dfc6e2583a"),E=r.n(_),b=r("edd91f1601"),y=r.n(b),T=r("c1e2057026"),g=r.n(T),R=i.default.isMac||i.default.isIPad,C=new(function(){function e(){var t=this;E()(this,e),g()(this,"isPressed",!1),g()(this,"handleKeyboardEvent",(function(e){e.key===(R?"Meta":"Control")&&t.setCtrlKeyStatus("keydown"===e.type)})),g()(this,"handleBlurEvent",(function(){t.setCtrlKeyStatus(!1)}));var r=["keydown","keyup"];"undefined"!=typeof window&&"undefined"!=typeof document?(r.forEach((function(e){document.addEventListener(e,t.handleKeyboardEvent)})),window.addEventListener("blur",this.handleBlurEvent),window.addEventListener("beforeunload",(function(){r.forEach((function(e){document.removeEventListener(e,t.handleKeyboardEvent)})),window.removeEventListener("blur",t.handleBlurEvent)}))):console.debug("CtrlKeyManager skip init, window or document is undefined")}return y()(e,[{key:"setCtrlKeyStatus",value:function(e){this.isPressed=e}}]),e}()),O=function(){return Object(v.a)(Object(v.h)("wdocs"),"1.0.0")>=0},S=function(e){return Object(v.i)()?function(e){return[/^http(s):\/\/drive\.weixin\.qq\.com\/s\?/i,/^http(s):\/\/drive\.weixin\.qq\.com\/cgi-bin\/disk\/s\?/i].some((function(t){return t.test(e)}))}(e):/^http(s):\/\/drive\.weixin\.qq\.com\//i.test(e)},w=function(e){return[/^http(s):\/\/doc\.weixin\.qq\.com\/doc/i,/^http(s):\/\/doc\.weixin\.qq\.com\/sheet/i,/^http(s):\/\/doc\.weixin\.qq\.com\/forms/i,/^http(s):\/\/doc\.weixin\.qq\.com\/mind/i,/^http(s):\/\/doc\.weixin\.qq\.com\/flowchart/i,/^http(s):\/\/doc\.weixin\.qq\.com\/slide/i,/^http(s):\/\/doc\.weixin\.qq\.com\/home/i,/^http(s):\/\/doc\.weixin\.qq\.com\/mall\/m\/profile\/craft/i,/^http(s):\/\/doc\.weixin\.qq\.com\/scenario\/login/i,/^http(s):\/\/doc\.weixin\.qq\.com\/txdoc/i,/^http(s):\/\/doc\.weixin\.qq\.com\/formcol/i].some((function(t){return t.test(e)}))};!function(e){e[e.REPLACE=0]="REPLACE",e[e.FORK_WEBVIEW=1]="FORK_WEBVIEW",e[e.BROWSER=2]="BROWSER",e[e.NEW_WEBVIEW=3]="NEW_WEBVIEW"}(p||(p={}));var A=function(e,t){var r,n;if(null!==(r=window)&&void 0!==r&&null!==(n=r.tdocs)&&void 0!==n&&n.openUrl){var i=t.replace?p.REPLACE:w(e)?p.FORK_WEBVIEW:p.NEW_WEBVIEW;return console.log("doOpenUrlForWxworkOrWedrive use window.tdocs.openUrl",e,o()(o()({},t),{},{target:i})),window.tdocs.openUrl({url:e,target:i,style:3})}return I(e,t)},I=function(e,t){var r,n,o,i,a;return null!==(r=window)&&void 0!==r&&null!==(n=r.mqq)&&void 0!==n&&null!==(o=n.ui)&&void 0!==o&&o.openUrl?(console.log("doOpenUrlForWxworkOrWedrive use window.mqq.ui.openUrl",e,t),window.mqq.ui.openUrl({url:e,target:t.replace?0:1,style:3,useQQBrowser:!0})):null!==(i=window)&&void 0!==i&&null!==(a=i.qmailBridge)&&void 0!==a&&a.openDocLink?(console.log("doOpenUrlForWxworkOrWedrive use window.qmailBridge.openDocLink",e,t),window.qmailBridge.openDocLink({url:e})):D(e,t)},F=function(){var e=m()(f()().mark((function e(t,r){var n,o,i,a,s;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=window)||void 0===n||null===(o=n.qmailBridge)||void 0===o||!o.openFileInWedrive||!S(t)){e.next=6;break}return e.next=3,M(t);case 3:return s=e.sent,console.log("doOpenUrlForWxworkOrWedrive use window.qmailBridge.openFileInWedrive",t,r),e.abrupt("return",window.qmailBridge.openFileInWedrive(s,t));case 6:if(null===(i=window)||void 0===i||null===(a=i.tdocs)||void 0===a||!a.openInTab||!w(t)){e.next=9;break}return console.log("doOpenUrlForWxworkOrWedrive use window.tdocs.openInTab",t,r),e.abrupt("return",window.tdocs.openInTab({url:t}));case 9:return e.abrupt("return",D(t,r));case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),N=function(){var e=m()(f()().mark((function e(t,r){var n,o,i,a,s,c,u;return f()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.replace){e.next=4;break}return console.log("doOpenUrlForWxworkOrWedrive use window.location.href",t,r),window.location.href=t,e.abrupt("return");case 4:if(null===(n=window)||void 0===n||null===(o=n.tdocs)||void 0===o||!o.openFileInWedrive||!S(t)){e.next=10;break}return e.next=7,M(t);case 7:return u=e.sent,console.log("doOpenUrlForWxworkOrWedrive use window.tdocs.openFileInWedrive",t,r),e.abrupt("return",window.tdocs.openFileInWedrive({fileId:u,url:t}));case 10:if(null===(i=window)||void 0===i||null===(a=i.tdocs)||void 0===a||!a.openInBrowser||!ie(t)){e.next=13;break}return console.log("doOpenUrlForWxworkOrWedrive use window.tdocs.openInBrowser",t,r),e.abrupt("return",window.tdocs.openInBrowser({url:Object(v.b)(t)}));case 13:if(null===(s=window)||void 0===s||null===(c=s.tdocs)||void 0===c||!c.openInTab){e.next=16;break}return console.log("doOpenUrlForWxworkOrWedrive use window.tdocs.openInTab",t,r),e.abrupt("return",window.tdocs.openInTab({is_silent:C.isPressed,url:t}));case 16:return e.abrupt("return",D(t,r));case 17:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),D=function(e,t){t.replace?(console.log("doOpenUrlForWxworkOrWedrive use window.location.href",e,t),window.location.href=e):(console.log("doOpenUrlForWxworkOrWedrive use window.open",e,t),window.open(e))},k=function(e){var t;null===(t=window.tdocs)||void 0===t||t.openInWxworkBrowser({url:e})},M=function(e){return new Promise((function(t){var r="https://doc.weixin.qq.com/wedoc/getfileinfobyurl?url=".concat(e),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var e=n.responseText;try{var r,o=JSON.parse(e),i=null==o||null===(r=o.body)||void 0===r?void 0:r.fileid;t(i||null)}catch(e){console.error("fetchFileIdFromSvr error",e),t(null)}}},n.onerror=function(e){console.error("fetchFileIdFromSvr error",e),t(null)},n.ontimeout=function(e){console.error("fetchFileIdFromSvr timeout",e),t(null)},n.open("GET",r,!0),n.setRequestHeader("Content-type","text/plain"),n.send()}))};var P=r("066d34132a"),L=r.n(P);function x(e,t,r){var n=t.replace,i=t.noHistory,a=t.safariNeedReplace,s=t.launchClient,c=e;if("docs.qq.com"===new URL(c).hostname&&!s){var u=c.split("#"),l=L()(u,2),d=l[0],f=l[1];c=d.includes("?")?"".concat(d,"&").concat("nlc","=1"):"".concat(d,"?").concat("nlc","=1"),f&&(c="".concat(c,"#").concat(f))}if(a)r.location.href=c;else if(!function(e){var t=e.url,r=e.windowName,n=e.windowFeatures;if(r&&n)return window.open(t,r,n),!0;return!1}(o()(o()({},t),{},{url:c}))){var h=document.createElement("a");h.href=c,n?h.target="_self":(h.target="_blank",h.rel="noreferrer"),i&&history.replaceState(null,document.title,c),Object(v.n)(h)}}var U=r("1da623efac"),B=i.default.isIPad,j=i.default.isMobile,$=i.default.isMiniProgram,W=i.default.isWxMiniProgram,G=i.default.isQQMiniProgram,H=i.default.isTimOrQQ,V=i.default.isIOS,q=i.default.isWeChat,K=i.default.isWxWork,Y=i.default.isTencentDocsApp,Q=i.default.isPCTencentDocsClient,z=i.default.isIE,X=i.default.isSafari,J=i.default.isWxDrive;function Z(e){U.a.register(e)}var ee=v.d;function te(){return W||G?"miniProgram":window.open()}function re(e){var t=Object(v.d)(e);return window.open(t)}function ne(){ae({url:location.href,replace:!0})}function oe(e,t){if("miniProgram"!==e){if(t){var r=Object(v.k)(t);e?e.location=r:r&&(window.location.href=r)}}else ae({url:t})}function ie(e,t){return!(Object(v.j)(e)||null!=t&&t.ignoreDomainDetect)}function ae(e){var t=e.url,r=e.wxUrl,n=e.replace,i=e.style,s=e.supportIFrame,c=e.safariNeedReplace,u=(Object(a.c)(s),Object(v.e)(t,e)||{}),l=u.url,d=u.callback;l&&(d?d((function(){ce(l,o()({ignoreDomainDetect:!0},e))})):(console.log("open_url 参数》》》》》》",l,r,n,W,G,H,V,j,B,z,window.mqq,i,c,e,Object(v.e)(t,e)),ce(l,e)))}function se(e,t,r,n){if(void 0!==e){var o=Object(v.k)(e);if(j||z)window.open.apply(window,[e,t,r,n]);else{var i=document.createElement("a");i.href=o,!j&&$&&(t="_self"),i.target=t||"_blank",i.rel="noreferrer",Object(v.n)(i)}}}function ce(e,t){var r=t.supportIFrame,n=t.safariNeedReplace,o=Object(a.c)(r);W||G?c(e,t):q||X&&n?o.location.href=e:H||Y?l.a(e,t):K||J?function(e,t){try{return i.default.isMobile?O()?A(e,t):I(e,t):i.default.isWxDrive?F(e,t):i.default.isWxWorkVersionAboveOrEqual("3.1.18")||i.default.isWxWorkPrivateVersionAboveOrEqual("2.7.2000")?t.openType===u.WxworkBrowser&&i.default.isWxWorkVersionAboveOrEqual("4.0.0")?(console.log("trigger openInWxworkBrowser"),k(e)):N(e,t):D(e,t)}catch(r){return console.error("doOpenUrlForWxworkOrWedrive error",r),D(e,t)}}(e,t):z?function(e,t){var r=t.replace,n=t.windowFeatures,o=t.windowName;r?window.location.href=e:window.open(e,o,n)}(e,t):Q?function(e,t){var r=t.replace,n=t.windowFeatures,o=t.windowName,i=t.supportIFrame,s=Object(a.c)(i);r?s.location.href=e:s.open((c=e,u="opennew=1",l=c,u?(l.indexOf("?")>=0?l+="&".concat(u):l+="?".concat(u),l):l),o,n);var c,u,l}(e,t):x(e,t,o)}},"8da3ae381a":function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));r("342844cefa"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n,o=r("176815363d"),i=r.n(o),a=r("9132715560"),s=r.n(a),c=r("6a364eb35c"),u=r.n(c),l=r("85d0a7609b"),d=r.n(l),f=r("3ef2352f0b"),h=r.n(f),m=(r("8ee19818c4"),r("8e7cce0ada"),r("29f8c5f672"),r("c6244f7705"),r("85d48ef22b"),r("2a6f332b5e"),r("a84962d637"),r("f45588a8ad"),r("081c8cafea"),r("3bf1976a4f"),r("7264fb5e8f")),p=r("025e3e9b74"),v=r("b2a64db471"),_=r("7f1cfe4422"),E=r("c7530f2183"),b=r("4f3b15d017");function y(){return"doc.weixin.qq.com"===window.location.hostname}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.NEW_CHANGES="NEW_CHANGES",e.USER_NEWINFO="USER_NEWINFO",e.USER_NEWINFOS="USER_NEWINFOS",e.USER_LEAVE="USER_LEAVE",e.CURSOR_MESSAGE="CURSOR_MESSAGE",e.CURSOR_MESSAGES="CURSOR_MESSAGES",e.RIGHT_MESSAGE="RIGHT_MESSAGE",e.TITLE_MESSAGE="TITLE_MESSAGE",e.HANDLE_DELETE="HANDLE_DELETE",e.COMM_NOTICE="COMM_NOTICE",e.CODEREV_NEW="CODEREV_NEW",e.LAST_REVERSION="LAST_REVERSION",e.REVERT_MESSAGE="REVERT_MESSAGE",e.ALL_LOCK_INFO="ALL_LOCK_INFO",e.UNLOCK_INFO="UNLOCK_INFO",e.LIVE_MESSAGE="LIVE_MESSAGE",e.COMMERCIALIZE_MESSAGE="COMMERCIALIZE_MESSAGE",e.MARK_MESSAGE="MARK_MESSAGE",e.PRESENT_INFO="PRESENT_INFO"}(n||(n={}));var R,C="[SDK][Soc]";!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.TIMEOUT=2]="TIMEOUT"}(R||(R={}));var O=function(){function e(t,r,n,o){var i=this;s()(this,e),d()(this,"connectionController",void 0),d()(this,"inRenewTicketFlow",!1),d()(this,"estMoreThan90",!0),d()(this,"reportEstTimer",void 0),d()(this,"connectMode",b.default.isIOS||b.default.isSafari?m.ConnectMode.WEBSOCKET_FORCED:m.ConnectMode.WEBSOCKET),d()(this,"socketConfig",void 0),d()(this,"switchBigCollabMode",(function(){return i.switchConnectMode(m.ConnectMode.BIG_COLLAB)})),d()(this,"handleNewChanges",(function(e){e&&i.event.emit(p.g.NewChanges,e)})),d()(this,"handleUserNewInfo",(function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notice;r&&i.event.emit(p.g.UserEnter,r)})),d()(this,"handleUsersNewInfo",(function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notices;null==r||r.forEach((function(e){return i.event.emit(p.g.UserEnter,e)}))})),d()(this,"handleUserLeave",(function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notice;r&&i.event.emit(p.g.UserLeave,r)})),d()(this,"handleCursorMessage",(function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notice;r&&i.event.emit(p.g.CursorMessage,r)})),d()(this,"handleCursorMessages",(function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notices;null==r||r.forEach((function(e){return i.event.emit(p.g.CursorMessage,e)}))})),d()(this,"handleRightMessage",(function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notice;r&&i.event.emit(p.g.RightMessage,r)})),d()(this,"handleTitleMessage",(function(e){var t=e.body.notice;t&&i.event.emit(p.g.TitleMessage,t)})),d()(this,"handleDeletePad",(function(){i.event.emit(p.g.DeleteDoc)})),d()(this,"handleLastRevision",(function(e){var t=e.body.notice;if(t){var r=t.lastRev;i.logger.info(C,"receive last revision: ".concat(r)),i.event.emit(p.g.LatestVersion,r)}})),d()(this,"handleRevertMessage",(function(e){e&&i.event.emit(p.g.RevertMessage,e)})),d()(this,"handleLockMessage",(function(e){var t=e.body.notice;t&&i.event.emit(p.g.AllLockInfo,t)})),d()(this,"handleUnlockMessage",(function(e){var t=e.body.notice;t&&i.event.emit(p.g.UnLockInfo,t)})),d()(this,"handleWatermarkMessage",(function(e){var t=e.body.notice;t&&i.event.emit(p.g.WaterMarkChange,t)})),d()(this,"handleEditingPresentNotice",(function(e){var t=e.body.notice;t&&i.event.emit(p.g.PresentInfo,t)})),d()(this,"handleCommonNotice",(function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notice;"rollback"===(null==r?void 0:r.type)&&i.event.emit(p.g.WebOfficeRevert)})),this.clientVarProvider=t,this.messageHandler=r,this.event=n,this.logger=o,this.event}var t;return u()(e,[{key:"connectionInstance",get:function(){return this.connectionController}},{key:"opened",get:function(){var e;return null===(e=this.connectionController)||void 0===e?void 0:e.isConnected()}},{key:"isShutDown",get:function(){var e;return null===(e=this.connectionController)||void 0===e?void 0:e.isDisconnected()}},{key:"updateBaseRevision",value:function(e){var t;null===(t=this.connectionController)||void 0===t||t.setVersion(e)}},{key:"open",value:function(){var e,t=this;this.monitor4OpenSocketTimeout(),null===(e=this.connectionController)||void 0===e||e.connect(this.connectMode),window.addEventListener("unload",(function(){var e;t.logger.info(C,"unload");null===(e=t.connectionController)||void 0===e||e.disconnect({reason:"unload",shutDown:!0})}))}},{key:"close",value:function(e,t){var r,n={reason:e,errCode:t,shutDown:!0};null===(r=this.connectionController)||void 0===r||r.disconnect(n)}},{key:"reConnect",value:function(){var e;this.logger.info(C,"reConnect"),null===(e=this.connectionController)||void 0===e||e.reconnect()}},{key:"sendMessage",value:function(e){var t,r=this,n=g(g({},e),{},{onsend:e.onsend&&function(t,n,o,i){var a;return r.reportWebsocketOnSend(n,i),null===(a=e.onsend)||void 0===a?void 0:a.call(e,t,n,o,i)},onsendAccept:e.onsendAccept&&function(t,n,o,i,a){var s;return r.reportWebsocketOnAck(n,a),null===(s=e.onsendAccept)||void 0===s?void 0:s.call(e,t,n,o,i,a)}});null===(t=this.connectionController)||void 0===t||t.sendMessage(n)}},{key:"cancelMessageByTaskId",value:function(e){var t;this.connectMode!==m.ConnectMode.BIG_COLLAB&&(null===(t=this.connectionController)||void 0===t||t.cancelMessageBySeq(e))}},{key:"init",value:function(e){Object(m.initLogAndManager)(console),this.socketConfig=e,this.connectionController=this.createConnectionController(e),this.initConnectionEvent(this.connectionController)}},{key:"reInit",value:function(e){var t;Object(m.initLogAndManager)(console),this.socketConfig=e,null===(t=this.connectionController)||void 0===t||t.dispose(),this.connectionController=this.createConnectionController(e),this.initConnectionEvent(this.connectionController)}},{key:"getSocketConfig",value:function(){return this.socketConfig}},{key:"switchConnectMode",value:function(e){var t;null===(t=this.connectionController)||void 0===t||t.reconnect(void 0,e),this.connectMode=e}},{key:"createConnectionController",value:function(e){var t=e.serverVars,r=e.userId,n=e.uid,o=e.nowUserIndex,i=e.headerGeneralPacket,a={serverVars:t,uuId:Object(v.a)(),userid:r,module:m.DOCUMENT_TYPE.SLIDE,nowUserIndex:o,uid:n,config:{isUseAllCookie:y(),headerGeneralPacket:i,messagePriority:new Map([[m.Command.CURSOR_MESSAGE,m.MessagePriority.LOW],[m.Command.NEW_CHANGES,m.MessagePriority.HIGH]])}},s=new m.ConnectionController(a);return s.setVersion(null==t?void 0:t.rev),s}},{key:"initConnectionEvent",value:function(e){var t=this;null==e||e.onConnectionEvent((function(e){var r;null===(r=new Map([[m.ConnectionCallBackEvent.onRoomOpen,function(){return t.handleOnRoomOpen()}],[m.ConnectionCallBackEvent.onRoomClose,function(){var r,n;return t.handleOnRoomClose(null!==(r=null===(n=e.data)||void 0===n?void 0:n.closeReason)&&void 0!==r?r:{shutDown:!1})}],[m.ConnectionCallBackEvent.onNetReconnectedFail,function(){return t.onNetReconnectedFail()}],[m.ConnectionCallBackEvent.onRoomShutDown,function(){var r,n;return t.handleOnRoomShutDown(null!==(r=null===(n=e.data)||void 0===n?void 0:n.closeReason)&&void 0!==r?r:{shutDown:!0})}],[m.ConnectionCallBackEvent.onRoomStateChange,function(){var r,n,o,i,a,s;return t.handleOnRoomStateChange(null!==(r=null===(n=e.data)||void 0===n||null===(o=n.roomState)||void 0===o?void 0:o.roomState)&&void 0!==r?r:"",null!==(i=null===(a=e.data)||void 0===a||null===(s=a.roomState)||void 0===s?void 0:s.description)&&void 0!==i?i:"")}],[m.ConnectionCallBackEvent.onReceiveMsgFromServer,function(){var r;return t.handleOnReceivMsgFromServer(null===(r=e.data)||void 0===r?void 0:r.serverMsg)}]]).get(e.event))||void 0===r||r()}))}},{key:"handleMessageFromServer",value:function(e,t){switch(this.event.emit(p.g.ReceiveMessage,e,t),e){case n.NEW_CHANGES:return this.handleNewChanges(t);case n.USER_NEWINFO:return this.handleUserNewInfo(t);case n.USER_NEWINFOS:return this.handleUsersNewInfo(t);case n.USER_LEAVE:return this.handleUserLeave(t);case n.CURSOR_MESSAGE:return this.handleCursorMessage(t);case n.CURSOR_MESSAGES:return this.handleCursorMessages(t);case n.RIGHT_MESSAGE:return this.handleRightMessage(t);case n.TITLE_MESSAGE:return this.handleTitleMessage(t);case n.HANDLE_DELETE:return this.handleDeletePad();case n.COMM_NOTICE:return this.handleCommonNotice(t);case n.LAST_REVERSION:return this.handleLastRevision(t);case n.REVERT_MESSAGE:return this.handleRevertMessage(t);case n.ALL_LOCK_INFO:return this.handleLockMessage(t);case n.UNLOCK_INFO:return this.handleUnlockMessage(t);case n.COMMERCIALIZE_MESSAGE:return this.handleCommercialMsg(t);case n.MARK_MESSAGE:return this.handleWatermarkMessage(t);case n.PRESENT_INFO:return this.handleEditingPresentNotice(t)}}},{key:"handleCommercialMsg",value:function(e){var t,r=null==e||null===(t=e.body)||void 0===t?void 0:t.notice;if("anonymous_status"!==(null==r?void 0:r.type));else{var n=r.payload,o=n.anonymous_status,i=n.operator;this.event.emit(p.g.AnonymousChange,{status:o,operator:i})}}},{key:"handleRoomStateChange",value:function(e,t){this.logger.log(C,"room state change to ".concat(e));var r=e.toUpperCase();"RECONNECTING_IN_CLOSED"===r&&this.opened?this.handleOffline(t):"OPENED"!==r||this.opened||this.handleOnline(t)}},{key:"needRenewTicket",value:function(e){return y()&&60006===e}},{key:"handleSocketShutDown",value:function(e,t){var r;if("unload"!==e){if(this.logger.error(C,"socket is closed ".concat(t)),this.inRenewTicketFlow)this.inRenewTicketFlow=!1;else if(this.needRenewTicket(t))return this.logger.info(C,"Login Expired, start renew ticket then reopen socket"),void this.renewTicketAndReOpenSocket(e,t);var n=null!==(r=Object(_.a)(t))&&void 0!==r?r:_.d.Unknown;this.reportWebsocketOnShutdown(t,e),this.event.emit(p.g.ShutDown,{reason:e,code:t,error:n})}else this.logger.info(C,"socket is closed by unload : ".concat(e))}},{key:"handleOnline",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.logger.info(C,"online".concat(e)),this.event.emit(p.g.ChangeToOnline)}},{key:"handleOffline",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.logger.info(C,"offline".concat(e)),this.event.emit(p.g.ChangeToOffline)}},{key:"renewTicketAndReOpenSocket",value:(t=i()(h.a.mark((function e(t,r){var n,o,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(o=this.messageHandler.renewService)||!o.renewTicket(location.href)){e.next=13;break}return e.prev=2,e.next=5,o.awaitLoginTicket(location.href);case 5:return this.inRenewTicketFlow=!0,this.reConnect(),e.abrupt("return");case 10:e.prev=10,e.t0=e.catch(2),this.logger.error("[rev] renew service failed");case 13:i=null!==(n=Object(_.a)(r))&&void 0!==n?n:_.d.Unknown,this.event.emit(p.g.ShutDown,{reason:t,error:i,code:r});case 15:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(e,r){return t.apply(this,arguments)})},{key:"handleOnRoomClose",value:function(e){this.logger.info(C,"socket is closed ",e),e.errCode!==m.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB?e.errCode!==m.RoomErrorCode.BIG_COLLAB_CONNECT_TIMEOUT?this.handleOffline():this.switchConnectMode(m.ConnectMode.WEBSOCKET_FORCED):this.switchConnectMode(m.ConnectMode.BIG_COLLAB)}},{key:"handleOnRoomOpen",value:function(){var e;(this.logger.info(C,"socket is opened"),this.inRenewTicketFlow)&&(this.inRenewTicketFlow=!1,null===(e=this.messageHandler.renewService)||void 0===e||e.renewSuccess(location.href));this.monitor4OpenSocketSucceed(),this.handleOnline()}},{key:"onNetReconnectedFail",value:function(){this.logger.info(C,"socket reconnect fail")}},{key:"handleOnRoomShutDown",value:function(e){e.errCode!==m.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB?e.errCode!==m.RoomErrorCode.BIG_COLLAB_CONNECT_TIMEOUT?this.handleSocketShutDown(e.reason||"unknown",e.errCode||0):this.switchConnectMode(m.ConnectMode.WEBSOCKET_FORCED):this.switchConnectMode(m.ConnectMode.BIG_COLLAB)}},{key:"handleOnRoomStateChange",value:function(e,t){this.handleRoomStateChange(e,t)}},{key:"handleOnReceivMsgFromServer",value:function(e){var t=this;if(e){var r=e.type,n=e.data;n instanceof Array?n.forEach((function(e){return t.handleMessageFromServer(r,e)})):this.logger.error(C,"handleOnReceivMsgFromServer - data is not array")}}},{key:"reportWebsocketOnSend",value:function(e,t){var r,n,o,i,a,s,c,u,l,d,f,h,m="sdk_websocket_send",p="".concat(m,"/").concat(e);if(0===(null==t?void 0:t.errCode))return null===(l=this.logger.monitor)||void 0===l||null===(d=l.reportStatus)||void 0===d||d.call(l,m,R.SUCCESS),void(null===(f=this.logger.monitor)||void 0===f||null===(h=f.reportStatus)||void 0===h||h.call(f,p,R.SUCCESS));null===(r=this.logger.monitor)||void 0===r||null===(n=r.reportStatus)||void 0===n||n.call(r,m,R.ERROR),null===(o=this.logger.monitor)||void 0===o||null===(i=o.reportStatus)||void 0===i||i.call(o,p,R.ERROR,"".concat(null==t?void 0:t.errCode)),null===(a=this.logger.aegis)||void 0===a||null===(s=a.report)||void 0===s||s.call(a,new Error("errorCode:".concat(null==t?void 0:t.errCode))),null===(c=(u=this.logger).tdrec)||void 0===c||c.call(u,null==t?void 0:t.errCode,"websocket")}},{key:"reportWebsocketOnAck",value:function(e,t){var r,n,o,i,a,s,c,u,l,d,f,h,m="sdk_websocket_send_ack",p="".concat(m,"/").concat(e);if(0===(null==t?void 0:t.errCode))return null===(l=this.logger.monitor)||void 0===l||null===(d=l.reportStatus)||void 0===d||d.call(l,m,R.SUCCESS),void(null===(f=this.logger.monitor)||void 0===f||null===(h=f.reportStatus)||void 0===h||h.call(f,p,R.SUCCESS));null===(r=this.logger.monitor)||void 0===r||null===(n=r.reportStatus)||void 0===n||n.call(r,m,R.ERROR),null===(o=this.logger.monitor)||void 0===o||null===(i=o.reportStatus)||void 0===i||i.call(o,p,R.ERROR,"".concat(null==t?void 0:t.errCode)),null===(a=this.logger.aegis)||void 0===a||null===(s=a.report)||void 0===s||s.call(a,new Error("errorCode:".concat(null==t?void 0:t.errCode))),null===(c=(u=this.logger).tdrec)||void 0===c||c.call(u,null==t?void 0:t.errCode,"websocket")}},{key:"reportWebsocketOnShutdown",value:function(e,t){var r,n,o,i,a,s;null===(r=this.logger.monitor)||void 0===r||null===(n=r.reportStatus)||void 0===n||n.call(r,"sdk_websocket_shutdown",R.ERROR,"".concat(e,"_").concat(t)),null===(o=this.logger.aegis)||void 0===o||null===(i=o.report)||void 0===i||i.call(o,new Error("".concat(t,", errorCode:").concat(e))),null===(a=(s=this.logger).tdrec)||void 0===a||a.call(s,e,"websocket")}},{key:"monitor4OpenSocketTimeout",value:function(){var e=this,t=9e4,r=performance.now(),n=function n(){if(e.isShutDown||e.clientVarProvider.isOverConNum&&!e.clientVarProvider.isCreator||e.clientVarProvider.isDriveFile&&!e.clientVarProvider.isCreator)return clearTimeout(e.reportEstTimer),void window.removeEventListener("visibilitychange",n);"visible"===document.visibilityState?(r=performance.now(),e.reportEstTimer=setTimeout((function(){!e.estMoreThan90||e.opened||e.isShutDown||e.reportOpenSocketMoreThan90S(),window.removeEventListener("visibilitychange",n)}),t)):(t=Math.max(t-(performance.now()-r),0),clearTimeout(e.reportEstTimer))};n(),window.addEventListener("visibilitychange",n)}},{key:"monitor4OpenSocketSucceed",value:function(){this.estMoreThan90=!1}},{key:"reportOpenSocketMoreThan90S",value:function(){var e,t,r;E.network.isOnline&&(null===(e=this.logger.monitor)||void 0===e||null===(t=e.reportStatus)||void 0===t||t.call(e,"90秒以内未和后台建立编辑通道",R.ERROR,"",[null!==(r=this.socketConfig.serverVars.globalPadId)&&void 0!==r?r:"",this.connectMode]))}}]),e}()},"921944efcf":function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},"925868c7f2":function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("176815363d"),o=r.n(n),i=r("9132715560"),a=r.n(i),s=r("6a364eb35c"),c=r.n(s),u=r("85d0a7609b"),l=r.n(u),d=r("3ef2352f0b"),f=r.n(d),h=(r("3bf1976a4f"),r("b8217400dc"),r("e6f68cdf2e"),r("c6244f7705"),r("081c8cafea"),r("75563bc376"),r("7264fb5e8f")),m=r("025e3e9b74"),p=r("7f1cfe4422"),v=r("5c5dc9725b"),_=(r("73b854064b"),r("547611bd96")),E=r.n(_),b=r("bd29e2df90"),y=r.n(b),T=r("ab5eb40518"),g=r.n(T),R=r("1b4cdd6a36"),C=r.n(R),O=r("7a5536c9bf"),S=r.n(O);r("fce3077cdf");var w=function(){function e(t,r){var n=this;a()(this,e),l()(this,"errorSource",void 0),l()(this,"handleRoomErrorCode",(function(e,t,r){switch(n.submitHandler.logger.warn(n.moduleName,"handle room error: ".concat(t)),t){case h.RoomErrorCode.EXIST:case h.RoomErrorCode.ROOM_STATE_ERR:break;case h.RoomErrorCode.TIMEOUT:case h.RoomErrorCode.ROOM_DISCONNECT:case h.RoomErrorCode.ROOM_CLOSE:n.submitHandler.retrySubmit(v.b.RoomError,1e5);break;case h.RoomErrorCode.PARA_ERROR:case h.RoomErrorCode.ROOM_SHUTDOWN:n.submitHandler.dispatchError({error:p.d.Timeout,code:t,taskId:e,message:null!=r?r:"房间已关闭",shutDown:!0,source:n.errorSource});break;default:n.submitHandler.dispatchError({error:p.d.Timeout,code:t,taskId:e,message:null!=r?r:"unknown",source:n.errorSource})}})),this.submitHandler=t,this.moduleName=r}return c()(e,[{key:"retryCommitCount",get:function(){return this.submitHandler.getRetrySubmitCount()}},{key:"handleResponseError",value:function(e,t){var r,n,o=this.getErrorCode(t),i=((null==t||null===(r=t.response)||void 0===r||null===(n=r.body)||void 0===n?void 0:n.data)||{}).msg,a=void 0===i?"":i,s=[h.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB],c=[h.RoomWebsocketErrorCode.SOCKET_DATA_BASEREV_ERROR,h.RoomWebsocketErrorCode.SOCKET_DATA_REV_DIFF_UPPER_TEN,p.c.COMMIT_ERROR_BASEREV_LIMIT_ERROR],u=[h.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL,h.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_SEND_MESSAGE_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT,h.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG,h.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT],l=[h.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_UNKNOWN_ERROR,h.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK,h.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_ERROR,h.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST,h.RoomWebsocketErrorCode.SOCKET_DATA_SUBID_ERROR,h.RoomWebsocketErrorCode.SOCKET_DATA_ACTION_LENGTH,h.RoomWebsocketErrorCode.SOCKET_DATA_READ_FAIL,h.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_TYPE,h.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_PROTO,h.RoomWebsocketErrorCode.SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT,h.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR,h.RoomWebsocketErrorCode.SOCKET_DATA_EASYSYNC_TIMEOUT,h.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR,h.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR,h.RoomWebsocketErrorCode.SOCKET_COLLABROOM_DOC_DELETED,p.c.INVALID_COMMIT_ATTRS,p.c.APPLY_REVISION_CGO,p.c.CGO_TRANSFORM].concat(S()(p.b)),d=[p.c.COMMIT_NO_AUTH,h.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,h.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,h.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE,h.RoomWebsocketErrorCode.LOGIN_INVALIDATE,h.RoomWebsocketErrorCode.LOGIN_FORBIDDEN,h.RoomWebsocketErrorCode.SOCKET_IP_BLACK_LIST,h.RoomWebsocketErrorCode.SOCKET_USER_BLACK_LIST,h.RoomWebsocketErrorCode.SOCKET_DOCMENT_BLACK_LIST,h.RoomWebsocketErrorCode.SOCKET_USERAGENT_BLACK_LIST,p.c.META_DATA_NOT_EXIST],f=[h.RoomWebsocketErrorCode.SOCKET_DATA_CONTENT_LIMIT,h.RoomWebsocketErrorCode.SOCKET_PACKAGE_SIZE_TOO_LARGE,p.c.OVERSIZE_COMMIT],m=[h.RoomWebsocketErrorCode.INACTIVE,h.RoomWebsocketErrorCode.CODEREV_NEW];return Object.values(h.RoomErrorCode).filter((function(e){return"number"==typeof e&&0!==e})).includes(o)?this.handleRoomErrorCode(e,o,a):c.includes(o)?this.submitHandler.handleBaseVersionTooLow(e,o):[].concat(S()(l),f,d,m).includes(o)?this.submitHandler.handleFatalError(e,o,a,this.errorSource):([].concat(u,[s]).includes(o),this.handleCommitErrorForRetry(e,t,o,a))}},{key:"getErrorCode",value:function(e){var t,r,n,o,i=null===(t=e.response)||void 0===t||null===(r=t.onpost)||void 0===r?void 0:r.result,a=(null===(n=e.response)||void 0===n||null===(o=n.body)||void 0===o?void 0:o.data.reason)||e.errCode;return i||a}},{key:"handleConnectionLayerResponse",value:function(e){var t=0;return 0===e.errCode&&e.response||(t=this.getErrorCode(e)),t}},{key:"handleCommitErrorForRetry",value:function(e,t,r,n){if(n.includes("".concat(p.c.COMMIT_DUPLICATE)))return this.submitHandler.handleDuplicateSubmit(e,r,this.errorSource);if(r===h.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB&&this.submitHandler.switchBigCollabMode(),this.retryCommitCount<3){var o,i,a;this.submitHandler.updateRetrySubmitCount(this.retryCommitCount+1),this.submitHandler.logger.info(this.moduleName,"retry commit for commit error, limit (".concat(this.retryCommitCount," / 3), errCode:").concat(r));var s=null!==(o=null===(i=t.response.body)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.retry_interval)&&void 0!==o?o:function(e){switch(e){case 0:case 1:return 3e3;case 2:return 5e3;default:return 8e3}}(this.retryCommitCount);this.submitHandler.retrySubmit(v.b.CommitError,s)}else this.submitHandler.logger.error(this.moduleName,"commit failed for reaching retry limit ",r),this.submitHandler.handleFatalError(e,r,null!=n?n:"commit retry exceed limit",this.errorSource)}}]),e}();function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=C()(e);if(t){var o=C()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var I=function(e){y()(r,e);var t=A(r);function r(e,n){var o;return a()(this,r),o=t.call(this,e,n),l()(E()(o),"errorSource",v.a.Room),l()(E()(o),"onSubmitError",(function(e,t,r,n){0!==o.handleConnectionLayerResponse(n)&&o.handleResponseError(e,n)})),l()(E()(o),"onSubmitSend",(function(e,t,r,n){var i=o.handleConnectionLayerResponse(n);0!==i?(o.submitHandler.logger.warn(o.moduleName,"[".concat(e,"] send userChange failed, reason: ").concat(i)),o.handleResponseError(e,n)):o.submitHandler.updateRetryPostCount(0)})),o}return r}(w);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=C()(e);if(t){var o=C()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var N=function(e){y()(r,e);var t=F(r);function r(e,n){var o;return a()(this,r),o=t.call(this,e,n),l()(E()(o),"errorSource",v.a.Server),l()(E()(o),"onSubmitAccept",(function(e,t,r,n,i){if(t===h.Command.USER_CHANGES)switch(n){case v.c.AcceptCommit:o.handleAcceptCommit(e,t,i);break;case v.c.CommitError:default:o.handleCommitError(e,i)}})),o}return c()(r,[{key:"handleAcceptCommit",value:function(e,t,r){if(0===r.errCode&&r.response){var n=r.response.new_rev,o=r.response.body.data.changeset;this.acceptCommit(e,n,o)}else this.handleCommitError(e,r)}},{key:"acceptCommit",value:function(e,t,r){var n,o,i=null!==(n=null===(o=this.submitHandler.getSubmittingUserChange())||void 0===o?void 0:o.revision)&&void 0!==n?n:-1;this.submitHandler.updateRetrySubmitCount(0),this.submitHandler.commitSuccess(e,i,t,r)}},{key:"handleCommitError",value:function(e,t){var r,n,o=this.getErrorCode(t),i=((null==t||null===(r=t.response)||void 0===r||null===(n=r.body)||void 0===n?void 0:n.data)||{}).msg,a=void 0===i?"":i;this.submitHandler.logger.warn(this.moduleName," [".concat(e,"] maybe have some problems, reason: ").concat(o,", message: ").concat(a)),this.handleResponseError(e,t)}}]),r}(w),D=r("96459a5fec"),k=r("5b34b47c3b");function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var P="[SDK][Rev]",L=function(){function e(t,r,n,i){var s=this;a()(this,e),l()(this,"submitSendErrorHandler",void 0),l()(this,"submitAcceptHandler",void 0),l()(this,"userChangeManager",void 0),l()(this,"revisionNumber",void 0),l()(this,"retryPostCount",0),l()(this,"retrySubmitCount",0),l()(this,"revisionConfig",void 0),l()(this,"submittingUserChange",void 0),l()(this,"updateRevisionNumber",(function(e){if(!(e<=s.revisionNumber))return s.logger.info(P,"update base revision ".concat(s.revisionNumber," to ").concat(e)),s.revisionNumber=e,s.socket.updateBaseRevision(e),s.event.emit(m.f.UpdateBaseRevision,e),s.userChangeManager.removeUserChangeBelowOrEqualVersion(e),!0})),l()(this,"getRevisionNumber",(function(){return s.revisionNumber})),l()(this,"getRetryPostCount",(function(){return s.retryPostCount})),l()(this,"updateRetryPostCount",(function(e){s.retryPostCount=e})),l()(this,"getRetrySubmitCount",(function(){return s.retrySubmitCount})),l()(this,"updateRetrySubmitCount",(function(e){s.retrySubmitCount=e})),l()(this,"getRevisionConfig",(function(){return s.revisionConfig})),l()(this,"getSubmittingUserChange",(function(){return s.submittingUserChange})),l()(this,"dispatchError",(function(e){var t=e.taskId,r=e.error,n=e.code,o=e.message,i=e.shutDown,a=e.source;if(n===h.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT&&null!=o&&o.includes("".concat(p.c.COMMIT_DUPLICATE)))return s.changeUserChangeStatus(s.getSubmittingUserChange(),k.b.Accepted),void setTimeout((function(){var e,r,n,o;(null===(e=(r=s.revisionChangesetHandler).getUserChangeFromLocalCache)||void 0===e?void 0:e.call(r,t))&&!(null!==(n=(o=s.revisionChangesetHandler).getUserChangeFromRemoteCache)&&void 0!==n&&n.call(o,t))&&s.event.emit(m.f.FetchMissingDataError,!1,D.a.Duplicate)}),1e4);s.changeUserChangeStatus(s.getSubmittingUserChange(),k.b.Error),s.logger.error(P,"error: ".concat(r,", code: ").concat(n,", message: ").concat(o,", shutdown: ").concat(i||!1)),s.event.emit(m.f.CommitFail,{taskId:t,error:r,code:n,message:o,shutDown:!!i,source:a})})),l()(this,"handleDuplicateSubmit",(function(e,t,r){s.dispatchError({error:p.d.ServerError,code:t,taskId:e,message:"duplicate submit ".concat(p.c.COMMIT_DUPLICATE),source:r})})),l()(this,"handleBaseVersionTooLow",o()(f.a.mark((function e(){var t,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.event.emit(m.f.BaseVersionToLow),r=s.revisionNumber+200,s.changeUserChangeStatus(s.getSubmittingUserChange(),k.b.BaseRevTooLow),null===(t=s.getSubmittingUserChange())||void 0===t||t.setExpectedRev(r),e.next=6,s.updateLastRevision(r);case 6:case"end":return e.stop()}}),e)})))),l()(this,"handleFatalError",(function(e,t,r,n){s.shutDownRevision({taskId:e,errCode:t,msg:null!=r?r:"unknown fatal error",source:n})})),l()(this,"handleNewChanges",(function(e){var t,r,n=e.newRev,o=e.body;if(o.data){var i=o.data,a=i.changeset,c=i.commitId,u=void 0===c?0:c;if(a){s.logger.info(P,"receive new changes,",u,"rev:",n);var l={revision:n,keyframe:a,taskId:u};s.userChangeManager.addUserChange(l),null===(t=(r=s.revisionChangesetHandler).handleNewUserChanges)||void 0===t||t.call(r,[l])}}})),l()(this,"submitCommand",(function(e,t){var r;if(t!==(null===(r=s.submittingUserChange)||void 0===r?void 0:r.taskId)){var n=s.createUserChange(e,t);s.submitUserChange(n),s.event.emit(m.f.Enqueue,n)}})),l()(this,"resetSubmittingUserChange",(function(){var e;null===(e=s.submittingUserChange)||void 0===e||e.stopDetectIsBlocked(),s.submittingUserChange=void 0})),l()(this,"retrySubmit",function(){var e=o()(f.a.mark((function e(t){var r,n,o=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:3e3,n=s.getSubmittingUserChange()){e.next=4;break}return e.abrupt("return");case 4:if(s.changeUserChangeStatus(n,k.b.Retrying),s.socket.cancelMessageByTaskId(n.taskId),!(r>=0)){e.next=10;break}return s.logger.info(P,"retry submit taskId ".concat(n.taskId," after ").concat(r,"ms, source: ").concat(t)),e.next=10,new Promise((function(e){return setTimeout(e,r)}));case 10:if(n.getStatus()===k.b.Retrying){e.next=13;break}return s.logger.info(P,"no need to retry taskId",n.taskId,"status:",n.getStatus()),e.abrupt("return");case 13:s.logger.info(P,"retry submit taskId ".concat(n.taskId," immediately, source: ").concat(t)),s.submitUserChange(n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l()(this,"switchBigCollabMode",(function(){s.socket.switchBigCollabMode()})),l()(this,"updateLastRevision",function(){var e=o()(f.a.mark((function e(t){var r,n,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s.revisionNumber<t)){e.next=6;break}return s.logger.info(P,"update last revision to ".concat(t,", current is ").concat(s.revisionNumber)),e.next=4,s.getMissingChanges(s.revisionNumber+1,t,D.a.LatestVersion);case 4:o=e.sent,null===(r=(n=s.revisionChangesetHandler).handleNewUserChanges)||void 0===r||r.call(n,o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l()(this,"submitUserChange",(function(e){s.logger.info(P,"submit userChange, taskId:",e.taskId,"revision",e.revision,e.commands),s.submittingUserChange=e,s.changeUserChangeStatus(s.getSubmittingUserChange(),k.b.Sending),e.startDetectIsBlocked((function(){e.getBlockedRetryCount()>1?s.shutDownRevision({taskId:e.taskId,errCode:h.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,msg:"userChange is blocked",source:v.a.Room}):(e.increaseBlockedRetryCount(),s.retrySubmit(v.b.Block,-1))})),s.socket.sendMessage({cmd:h.Command.USER_CHANGES,taskId:e.taskId,data:e.serialize(),customParam:{timeout:25e3,maxRetryCount:3,waitAcceptCmd:[v.c.AcceptCommit,v.c.CommitError,v.c.TaskDuplicate]},onError:s.submitSendErrorHandler.onSubmitError,onsend:s.submitSendErrorHandler.onSubmitSend,onsendAccept:s.submitAcceptHandler.onSubmitAccept})})),this.revisionChangesetHandler=t,this.socket=r,this.event=n,this.logger=i,this.submitSendErrorHandler=new I(this,P),this.submitAcceptHandler=new N(this,P),this.userChangeManager=new D.b(this,P),this.event.on(m.g.NewChanges,this.handleNewChanges),this.event.on(m.g.LatestVersion,this.updateLastRevision)}var t;return c()(e,[{key:"init",value:function(e){this.revisionConfig=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),this.revisionNumber=e.baseRev}},{key:"commitSuccess",value:function(e,t,r,n){this.changeUserChangeStatus(this.getSubmittingUserChange(),k.b.Accepted),this.userChangeManager.addUserChange({revision:r,keyframe:n,taskId:e}),this.event.emit(m.f.CommitSucceed,{taskId:e,baseRev:t,newRev:r,revisionData:n})}},{key:"getMissingChanges",value:(t=o()(f.a.mark((function e(t,r,n){var o,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=!1,e.prev=1,e.next=4,this.userChangeManager.getUserChange(t,r,n);case 4:if(i=e.sent,!(o=!!i.find((function(e){return!e.keyframe})))){e.next=8;break}throw new Error("doc is reverted");case 8:return e.abrupt("return",i);case 11:throw e.prev=11,e.t0=e.catch(1),this.event.emit(m.f.FetchMissingDataError,o,n),e.t0;case 15:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(e,r,n){return t.apply(this,arguments)})},{key:"createUserChange",value:function(e,t){var r=this.revisionConfig,n=r.uuId,o=r.subId,i=r.oSubId;return new k.a({type:h.Command.USER_CHANGES,baseRev:this.revisionNumber,commands:e,keydata:!1,head:!1,uuId:n,subId:o,oSubId:i,pver:1,taskId:t})}},{key:"shutDownRevision",value:function(e){var t=e.taskId,r=void 0===t?-1:t,n=e.errCode,o=void 0===n?-1:n,i=e.msg,a=e.source;this.socket.close("".concat(o),o),this.dispatchError({taskId:r,error:Object(p.a)(o),code:o,shutDown:!0,message:i,source:a})}},{key:"changeUserChangeStatus",value:function(e,t){null==e||e.setStatus(t),null==e||e.stopDetectIsBlocked()}}]),e}()},"96459a5fec":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return _}));var n,o=r("176815363d"),i=r.n(o),a=r("9132715560"),s=r.n(a),c=r("6a364eb35c"),u=r.n(c),l=r("85d0a7609b"),d=r.n(l),f=r("3ef2352f0b"),h=r.n(f),m=(r("8e7cce0ada"),r("29f8c5f672"),r("c6244f7705"),r("85d48ef22b"),r("2a6f332b5e"),r("081c8cafea"),r("8ee19818c4"),r("3bf1976a4f"),r("968ee3f7e6"),r("bd80bf2d0f"),r("6e20b6a7d8"),r("963f2eaace"),r("f4e4ed5c17")),p=r("7264fb5e8f"),v=r("c7530f2183");!function(e){e.Offline="offline",e.CommitSuccess="commitSuccess",e.LatestVersion="latestVersion",e.Transform="transform",e.Duplicate="duplicate"}(n||(n={}));var _=function(){function e(t,r){s()(this,e),d()(this,"retryCount",0),d()(this,"userChangeCache",new Map),this.submitHandler=t,this.moduleName=r}var t,r,n,o,a,c;return u()(e,[{key:"addUserChange",value:function(e){this.userChangeCache.set(e.revision,Promise.resolve(e))}},{key:"removeUserChangeBelowOrEqualVersion",value:function(e){var t=this,r=[];this.userChangeCache.forEach((function(t,n){n<=e&&r.push(n)})),r.forEach((function(e){return t.userChangeCache.delete(e)}))}},{key:"getUserChange",value:(c=i()(h.a.mark((function e(t,r,n){var o,i,a,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.submitHandler.logger.info(this.moduleName,"getUserChange from ".concat(t," to ").concat(r)),this.requestUserChange(t,r,n),o=[],i=t;case 4:if(!(i<=r)){e.next=15;break}if(!(a=this.userChangeCache.get(i))){e.next=10;break}o.push(a),e.next=12;break;case 10:throw this.submitHandler.logger.error(this.moduleName,"getUserChange ".concat(i," not found")),new Error("getUserChange ".concat(i," not found"));case 12:i++,e.next=4;break;case 15:return e.next=17,Promise.all(o);case 17:return s=e.sent,this.submitHandler.logger.info(this.moduleName,"success getUserChange from ".concat(t," to ").concat(r)),e.abrupt("return",s.flat());case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return c.apply(this,arguments)})},{key:"requestUserChange",value:function(e,t,r){for(var n=this,o=[],i=-99,a=e;a<=t;a++)if(!this.userChangeCache.get(a)){if(i+1!==a)o.push([a]);else o[o.length-1].push(a);i=a}o.forEach((function(e){n.requestFromServer(e[0],e[e.length-1],r)}))}},{key:"requestFromServer",value:(a=i()(h.a.mark((function e(t,r,n){var o,i,a,s,c=this,u=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=u.length>3&&void 0!==u[3]?u[3]:this.createPendingPromise(),this.submitHandler.logger.info(this.moduleName,"requestFromServer from ".concat(t," to ").concat(r||"latest")),i=function(e){c.userChangeCache.set(e,o.promise.then((function(r){return r[e-t]})))},a=t;a<=r;a++)i(a);return e.prev=4,e.next=7,this.fetchUserChanges(this.submitHandler.getRevisionConfig().globalPadId,t,r);case 7:if(s=e.sent,this.checkContinuity(s)){e.next=12;break}throw this.submitHandler.logger.error(this.moduleName,"requestFromServer res not continuous",s),new Error("requestFromServer res not continuous");case 12:o.resolve(s),this.submitHandler.logger.info(this.moduleName,"success requestFromServer from ".concat(t," to ").concat(r||"latest")),this.retryCount=0,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),this.retryRequestFromServer(t,r,n,o,e.t0);case 20:case"end":return e.stop()}}),e,this,[[4,17]])}))),function(e,t,r){return a.apply(this,arguments)})},{key:"retryRequestFromServer",value:(o=i()(h.a.mark((function e(t,r,n,o,i){var a,s,c=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.retryCount<5&&v.network.isOnline)){e.next=7;break}return this.retryCount+=1,this.submitHandler.logger.info(this.moduleName,"retry requestFromServer, limit (".concat(this.retryCount," / 5)")),e.next=5,new Promise((function(e){return setTimeout(e,1e3*c.retryCount)}));case 5:return this.requestFromServer(t,r,n,o),e.abrupt("return");case 7:null===(a=this.submitHandler.logger.monitor)||void 0===a||null===(s=a.reportStatus)||void 0===s||s.call(a,"fetchMissing",1,null==i?void 0:i.toString(),[n,"".concat(v.network.isOnline)]),this.submitHandler.logger.error("requestFromServer failed exceed limit"),o.reject(i);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i){return o.apply(this,arguments)})},{key:"fetchUserChanges",value:(n=i()(h.a.mark((function e(t,r,n){var o,i,a,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(void 0!==n&&n<r)){e.next=3;break}throw this.submitHandler.logger.error(this.moduleName,"is inValid, to ".concat(n," is less than from ").concat(r)),new Error("requestFromServer failed");case 3:return i=n?"&to=".concat(n):"",a=null!==(o=window.location)&&void 0!==o&&o.hostname?"//".concat(window.location.hostname,"/"):"//docs.qq.com/",e.next=7,m.a.get("".concat(a,"dop-api/get/changes?padId=").concat(t,"&from=").concat(r).concat(i,"&xsrf=").concat(this.submitHandler.getRevisionConfig().xsrf),{timeout:p.DEFAULT_SEND_MESSAGE_TIMEOUT});case 7:return s=e.sent,e.abrupt("return",this.handleFetchChangesResponse(s,t,r,n));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"handleFetchChangesResponse",value:(r=i()(h.a.mark((function e(t,r,n,o){var i,a,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(i=t||{}).data,s=i.status,c=i.statusText,a&&200===s){e.next=4;break}throw this.submitHandler.logger.error(this.moduleName,"".concat(n," to ").concat(o||"latest"," response is ").concat(c||"void")),new Error("requestFromServer failed");case 4:if(0===(null==a?void 0:a.retcode)){e.next=7;break}throw this.submitHandler.logger.error(this.moduleName,"".concat(n," to ").concat(o||"latest"," retcode error, ").concat(a.retcode)),Error("requestFromServer failed");case 7:return e.abrupt("return",this.handleFetchChangesSuccess(a,r,n,o));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"handleFetchChangesSuccess",value:(t=i()(h.a.mark((function e(t,r,n,o){var i,a,s,c,u,l,d;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.result,a=i.rev,s=i.changes,c=i.to,s.length){e.next=4;break}throw this.submitHandler.logger.error(this.moduleName,"".concat(n," to ").concat(o||"latest"," changes is empty")),Error("requestFromServer failed");case 4:if(u=s.map((function(e){var t=e.data;return{revision:t.newRev,keyframe:t.changeset,taskId:+t.commitId}})),!(void 0===o&&a>c)){e.next=10;break}return e.next=8,this.fetchUserChanges(r,c+1,a);case 8:return l=e.sent,e.abrupt("return",u.concat(l));case 10:if(!(void 0!==o&&o<=a&&o>c)){e.next=15;break}return e.next=13,this.fetchUserChanges(r,c+1,o);case 13:return d=e.sent,e.abrupt("return",u.concat(d));case 15:return e.abrupt("return",u);case 16:case"end":return e.stop()}}),e,this)}))),function(e,r,n,o){return t.apply(this,arguments)})},{key:"checkContinuity",value:function(e){if(!e.length)return!1;var t=e[0].revision;return e.slice(1).every((function(e){var r=e.revision,n=r===t+1;return t=r,n}))}},{key:"createPendingPromise",value:function(){var e=function(){return[]},t=function(e){return e};return{promise:new Promise((function(r,n){e=r,t=n})),resolve:e,reject:t}}}]),e}()},"9b27c0c855":function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},"9c64746af9":function(e,t,r){var n=r("921944efcf");e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},"9cd4e1be22":function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d})),r.d(t,"c",(function(){return a}));const n={$scope:o(),$effect:null,$transaction:null};function o(){const e=new Set;return{$effects:e,$dispose:()=>{Array.from(e).reverse().forEach((e=>e.$dispose()))}}}function i(e){let t=null;const r=function(e,t=(()=>{})){return{$deps:new Set,$update:e,$dispose:t}}((()=>{n.$effect=r,null==t||t(),t=e(),n.$effect=null}),(()=>{null==t||t(),t=null,r.$deps.forEach((e=>e.delete(r))),r.$deps.clear()}));return n.$scope.$effects.add(r),r.$update(),r.$dispose}function a(e){const t=o(),r=n.$scope;n.$scope=t;const i=e(t.$dispose);return n.$scope=r,i}function s(){let e;return t=>(void 0!==t&&(e=t),e)}function c(e){const t=n.$effect;n.$effect=null;const r=e();return n.$effect=t,r}function u(){return{dependsOn:e=>{const[t,r]=function(e){const t=new Set;let r=e;return[()=>(n.$effect&&(t.add(n.$effect),n.$effect.$deps.add(t)),r),e=>{r!==e&&(r=e,t.forEach((e=>{n.$transaction?n.$transaction.$effects.add(e):e.$update()})))}]}(null),o=s(),a=s(),u=s(),l=s();o(new Promise((e=>{a(e)})));const d=o=>{const i=function(e=[]){return e.map((e=>e()))}(e);return c((()=>{if("function"==typeof o&&!i.some((e=>!e))){if(t())throw new Error("tttt");!function(e,t){if("function"==typeof(null==e?void 0:e.then))return void e.then(t);t(e)}(o(...i),(e=>{!function(e){if(n.$transaction)return e();const t={$effects:new Set};n.$transaction=t,e(),t.$effects.forEach((e=>e.$update())),n.$transaction=null}((()=>{r(e)}))}))}}))};i((()=>{d(u())})),i((()=>{const e=t();return c((()=>{if(!e)return;const t=o();return a()(e),o(Promise.resolve(e)),()=>{t.finally((()=>{var t;null===(t=l())||void 0===t||t(e)}))}}))}));return Object.assign(t,{deps:()=>e,promise:()=>o(),register:(e,t)=>{u(e),l(t),d(u())},isRegistered:()=>!!u()})}}}function l(){return{dependsOn:e=>{const t=u().dependsOn(e),r=s();let n=!1;const o=()=>{t()||!r()||n||(t.register(...r()),n=!0)},i=()=>(o(),t());return Object.assign(i,{deps:()=>e,promise:()=>(o(),t.promise()),register:(e,t)=>r([e,t]),isRegistered:()=>!!r()}),i}}}function d(e){return(...t)=>new e(...t)}},"9e693e40c2":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Regulator=void 0;var n=r("f281127eb3"),o=function(){function e(e,t){this.subsecondMatchResult=null,this.lastParsedType=n.TokenType.Text,this.subsecondDecimalNumber=0,this.tokenizedList=e,this.hourSystemType=t,this.currentIndex=this.tokenizedList.length-1}return e.prototype.run=function(){for(;this.currentIndex>=0;this.currentIndex--)switch(this.currentToken=this.tokenizedList[this.currentIndex],this.currentToken.type){case n.TokenType.HalfDayHours:case n.TokenType.FullDayHours:this.handleHour();break;case n.TokenType.Second:this.handleSecond();case n.TokenType.Day:case n.TokenType.Year:case n.TokenType.Minute:case n.TokenType.Era:this.handleOtherTimeRelated();break;case n.TokenType.Month:this.handleMonth();case n.TokenType.SpecialStartGenesis:case n.TokenType.AbsoluteTime:}},e.prototype.getRegulatedResult=function(){return this.subsecondDecimalNumber},e.prototype.handleMonth=function(){this.lastParsedType===n.TokenType.Second&&String(this.currentToken.value).length<=2&&(this.currentToken.type=n.TokenType.Minute)},e.prototype.handleHour=function(){this.currentToken.type=this.hourSystemType},e.prototype.handleSecond=function(){this.subsecondMatchResult=String(this.currentToken.value).match(/\.0+$/),this.subsecondMatchResult&&(this.subsecondDecimalNumber=Math.max(this.subsecondDecimalNumber,this.subsecondMatchResult[0].length-1))},e.prototype.handleOtherTimeRelated=function(){this.lastParsedType=this.currentToken.type},e}();t.Regulator=o},a19d1845de:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.isEnterNormalString=t.isEnterEmpty=t.format=t.formatValue=void 0;var o=r("46d006027f"),i=r("cfee364b0d"),a=r("0c3f2faab4"),s=r("55c6175634");function c(e,t,r){var c=n({},r),d=t;if(null==r&&(c={}),o.isGeneral(e,0))return[s.general_fmt(d),null];var f=i.choose_fmt(e,d),h=f.chosenFormatCode,m=f.formatListLength;return o.isGeneral(h)?[s.general_fmt(d),null]:u(d)?["",null]:"string"==typeof d&&l(d,h)?[d,null]:("boolean"==typeof d&&(d=String(d)),a.eval_fmt(h,d,m,c))}function u(e){return""===e||null===e||"string"==typeof e&&""===e.trim()}function l(e,t){return!s.checkNumericValue(e)&&"@"===t}t.formatValue=function(e,t,r){var n=s.getFormatCodeByNumberFormat(t),o=c(n,e,r);return{formatCode:n,value:o[0],color:o[1]}},t.format=c,t.isEnterEmpty=u,t.isEnterNormalString=l},a2a6099311:function(e,t,r){var n=r("e4a614173c").default,o=r("73cf07311d");e.exports=function(e){var t=o(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},a5d0c84e2b:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COLOR_MAP=void 0,t.COLOR_MAP={Black:"#000000",Blue:"#0000FF",Cyan:"#00FFFF",Green:"#008000",Magenta:"#FF00FF",Red:"#FF0000",White:"#FFFFFF",Yellow:"#FFFF00","黑色":"#000000","蓝色":"#0000FF","蓝绿色":"#00FFFF","绿色":"#008000","洋红色":"#FF00FF","红色":"#FF0000","白色":"#FFFFFF","黄色":"#FFFF00","颜色0":"#00000000","颜色1":"#00FFFFFF","颜色2":"#00FF0000","颜色3":"#0000FF00","颜色4":"#000000FF","颜色5":"#00FFFF00","颜色6":"#00FF00FF","颜色7":"#0000FFFF","颜色8":"#00000000","颜色9":"#00FFFFFF","颜色10":"#00FF0000","颜色11":"#0000FF00","颜色12":"#000000FF","颜色13":"#00FFFF00","颜色14":"#00FF00FF","颜色15":"#0000FFFF","颜色16":"#00800000","颜色17":"#00008000","颜色18":"#00000080","颜色19":"#00808000","颜色20":"#00800080","颜色21":"#00008080","颜色22":"#00C0C0C0","颜色23":"#00808080","颜色24":"#009999FF","颜色25":"#00993366","颜色26":"#00FFFFCC","颜色27":"#00CCFFFF","颜色28":"#00660066","颜色29":"#00FF8080","颜色30":"#000066CC","颜色31":"#00CCCCFF","颜色32":"#00000080","颜色33":"#00FF00FF","颜色34":"#00FFFF00","颜色35":"#0000FFFF","颜色36":"#00800080","颜色37":"#00800000","颜色38":"#00008080","颜色39":"#000000FF","颜色40":"#0000CCFF","颜色41":"#00CCFFFF","颜色42":"#00CCFFCC","颜色43":"#00FFFF99","颜色44":"#0099CCFF","颜色45":"#00FF99CC","颜色46":"#00CC99FF","颜色47":"#00FFCC99","颜色48":"#003366FF","颜色49":"#0033CCCC","颜色50":"#0099CC00","颜色51":"#00FFCC00","颜色52":"#00FF9900","颜色53":"#00FF6600","颜色54":"#00666699","颜色55":"#00969696","颜色56":"#00003366","颜色57":"#00339966","颜色58":"#00003300","颜色59":"#00333300","颜色60":"#00993300","颜色61":"#00993366","颜色62":"#00333399","颜色63":"#00333333",Color0:"#00000000",Color1:"#00FFFFFF",Color2:"#00FF0000",Color3:"#0000FF00",Color4:"#000000FF",Color5:"#00FFFF00",Color6:"#00FF00FF",Color7:"#0000FFFF",Color8:"#00000000",Color9:"#00FFFFFF",Color10:"#00FF0000",Color11:"#0000FF00",Color12:"#000000FF",Color13:"#00FFFF00",Color14:"#00FF00FF",Color15:"#0000FFFF",Color16:"#00800000",Color17:"#00008000",Color18:"#00000080",Color19:"#00808000",Color20:"#00800080",Color21:"#00008080",Color22:"#00C0C0C0",Color23:"#00808080",Color24:"#009999FF",Color25:"#00993366",Color26:"#00FFFFCC",Color27:"#00CCFFFF",Color28:"#00660066",Color29:"#00FF8080",Color30:"#000066CC",Color31:"#00CCCCFF",Color32:"#00000080",Color33:"#00FF00FF",Color34:"#00FFFF00",Color35:"#0000FFFF",Color36:"#00800080",Color37:"#00800000",Color38:"#00008080",Color39:"#000000FF",Color40:"#0000CCFF",Color41:"#00CCFFFF",Color42:"#00CCFFCC",Color43:"#00FFFF99",Color44:"#0099CCFF",Color45:"#00FF99CC",Color46:"#00CC99FF",Color47:"#00FFCC99",Color48:"#003366FF",Color49:"#0033CCCC",Color50:"#0099CC00",Color51:"#00FFCC00",Color52:"#00FF9900",Color53:"#00FF6600",Color54:"#00666699",Color55:"#00969696",Color56:"#00003366",Color57:"#00339966",Color58:"#00003300",Color59:"#00333300",Color60:"#00993300",Color61:"#00993366",Color62:"#00333399",Color63:"#00333333"}},aaab5eaa3c:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenType=void 0,function(e){e.General="G",e.Text="t",e.TextPlaceholder="T",e.Month="m",e.Minute="M",e.Day="d",e.Year="y",e.HalfDayHours="h",e.FullDayHours="H",e.Second="s",e.Week="a",e.Era="e",e.DatePadding="g",e.BuddhistYear="b",e.AbsoluteTime="Z",e.SpecialStartGenesis="X",e.Number="n",e.ChineseNumber="DN",e.Color="Color",e.QuestionMark="?",e.LeftParenthesis="(",e.RightParenthesis=")",e.Digit="D",e.Space=" ",e.Empty=";"}(t.TokenType||(t.TokenType={}))},b44aa559ae:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tokenizer=void 0;var n=r("f281127eb3"),o=r("46d006027f"),i=r("c3de12fe35"),a=r("55c6175634"),s=r("f50ba37686"),c=function(){function e(e,t,r,o){this.isValid=!0,this.lastParsedType=n.TokenType.Text,this.isNeedToBreak=!1,this.index=0,this.formatDate=null,this.tokenizedList=[],this.hourSystemType=n.TokenType.FullDayHours,this.format=e,this.value=t,this.formatListLength=r,this.options=o}return e.prototype.run=function(){for(;this.index<this.format.length&&this.isValid;)switch(this.currentChar=this.format.charAt(this.index),this.currentChar){case"G":this.handleGeneral();break;case'"':this.handleQuotation();break;case"\\":this.handleBackSlash();break;case"_":this.handleUnderline();break;case"@":this.handleAt();break;case"B":case"b":if(this.handleBOrb(),this.isNeedToBreak){this.isNeedToBreak=!1;break}case"M":case"D":case"Y":case"H":case"S":case"E":this.handleUpperCaseTimeRelated();case"m":case"d":case"y":case"h":case"s":case"e":case"g":this.handleLowerCaseTimeRelated();break;case"A":case"a":this.handleAOra();break;case"上":this.handleChineseDayTime();break;case"[":this.handleLeftBracket();break;case".":if(this.handleDot(),this.isNeedToBreak){this.isNeedToBreak=!1;break}case"0":case"#":this.handleZeroOrPound();break;case"?":this.handleQuestionMark();break;case"*":this.handleAsterisk();break;case"(":case")":this.handleParentheses();break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this.handleNumber();break;case" ":this.handleSpace();break;case"%":this.handlePercent();break;default:this.handleOthers()}},e.prototype.getTokenizedResult=function(){return{formatDate:this.formatDate,hourSystemType:this.hourSystemType,tokenizedList:this.tokenizedList}},e.prototype.addNewToken=function(e,t){this.tokenizedList.push({type:e,value:t})},e.prototype.updateFormatDate=function(e){return null!==this.formatDate||(this.formatDate=i.parse_date_code(Number(this.value),this.options,e),null!==this.formatDate)||(this.isValid=!1,this.isNeedToBreak=!0,!1)},e.prototype.handleGeneral=function(){if(!o.isGeneral(this.format,this.index))throw new Error("unrecognized character "+this.currentChar+" in "+this.format);this.addNewToken(n.TokenType.General,"General"),this.index+=7},e.prototype.handleQuotation=function(){for(this.index+=1,this.tempString="";this.index<this.format.length&&(this.tempChar=this.format.charAt(this.index),'"'!==this.tempChar);this.index++)this.tempString+=this.tempChar;this.addNewToken(n.TokenType.Text,this.tempString),this.index+=1},e.prototype.handleBackSlash=function(){this.index+=1,this.tempChar=this.format.charAt(this.index),"("===this.tempChar||")"===this.tempChar?this.addNewToken(this.tempChar,this.tempChar):this.addNewToken(n.TokenType.Text,this.tempChar),this.index+=1},e.prototype.handleUnderline=function(){this.addNewToken(n.TokenType.Text," "),this.index+=2},e.prototype.handleAt=function(){this.addNewToken(n.TokenType.TextPlaceholder,String(this.value)),this.index+=1},e.prototype.handleBOrb=function(){if("1"===this.format.charAt(this.index+1)||"2"===this.format.charAt(this.index+1)){if(!this.updateFormatDate("2"===this.format.charAt(this.index+1)))return;this.addNewToken(n.TokenType.SpecialStartGenesis,this.format.substr(this.index,2)),this.lastParsedType=n.TokenType.BuddhistYear,this.index+=2,this.isNeedToBreak=!0}},e.prototype.handleUpperCaseTimeRelated=function(){this.currentChar=this.currentChar.toLowerCase()},e.prototype.handleLowerCaseTimeRelated=function(){if(!s.isNumeric(this.value)||Number(this.value)<0)this.isValid=!1;else if(this.updateFormatDate()){for(this.tempString=this.currentChar,this.index+=1;this.index<this.format.length&&this.format.charAt(this.index).toLowerCase()===this.currentChar;)this.tempString+=this.currentChar,this.index+=1;"m"===this.currentChar&&("h"===this.lastParsedType.toLowerCase()||"s"===this.lastParsedType.toLowerCase())&&this.tempString.length<=2&&(this.currentChar="M"),"h"===this.currentChar&&(this.currentChar=this.hourSystemType),this.addNewToken(this.currentChar,this.tempString),this.lastParsedType=this.currentChar}},e.prototype.handleAOra=function(){this.tempToken={type:this.currentChar,value:this.currentChar},this.updateFormatDate()&&("A/P"===this.format.substr(this.index,3).toUpperCase()?(this.tempToken.value=this.formatDate&&this.formatDate.hour>=12?"P":"A",this.tempToken.type=n.TokenType.TextPlaceholder,this.hourSystemType=n.TokenType.HalfDayHours,this.index+=3):"AM/PM"===this.format.substr(this.index,5).toUpperCase()?(this.tempToken.value=this.formatDate&&this.formatDate.hour>=12?"PM":"AM",this.tempToken.type=n.TokenType.TextPlaceholder,this.hourSystemType=n.TokenType.HalfDayHours,this.index+=5):"aaaa"===this.format.substr(this.index,4)?(this.tempToken.type=n.TokenType.Week,this.tempToken.value="aaaa",this.index+=4):"aaa"===this.format.substr(this.index,3)?(this.tempToken.type=n.TokenType.Week,this.tempToken.value="aaa",this.index+=3):(this.tempToken.type=n.TokenType.Text,this.index+=1),this.addNewToken(this.tempToken.type,this.tempToken.value),this.lastParsedType=this.tempToken.type)},e.prototype.handleChineseDayTime=function(){this.tempToken={type:this.currentChar,value:this.currentChar},this.updateFormatDate()&&("上午/下午"===this.format.substr(this.index,5).toUpperCase()?(this.tempToken.value=this.formatDate&&this.formatDate.hour>=12?"下午":"上午",this.tempToken.type=n.TokenType.TextPlaceholder,this.index+=5,this.hourSystemType=n.TokenType.HalfDayHours):(this.tempToken.type=n.TokenType.Text,this.index+=1),this.addNewToken(this.tempToken.type,this.tempToken.value),this.lastParsedType=this.tempToken.type)},e.prototype.handleLeftBracket=function(){for(this.tempString=this.currentChar;"]"!==this.format.charAt(this.index)&&this.index+1<this.format.length;)this.index+=1,this.tempString+=this.format.charAt(this.index);if(this.index+=1,"]"!==this.tempString.slice(-1))throw'unterminated "[" block: |'+this.tempString+"|";if(this.tempString.match(/\[[HhMmSs]*\]/)){if(!this.updateFormatDate())return;this.addNewToken(n.TokenType.AbsoluteTime,this.tempString.toLowerCase()),this.lastParsedType=this.tempString.charAt(1)}else{if("[$-f800]"===this.tempString.toLowerCase())return void(this.format=this.format.substr(0,this.index)+'yyyy"年"m"月"d"日" aaaa');if("[$-f400]"===this.tempString.toLowerCase())return void(this.format=this.format.substr(0,this.index)+"上午/下午 h:mm:ss");if(this.tempString.indexOf("$")>-1){if(this.tempString=(this.tempString.match(/\$([^-[\]]*)/)||[])[1]||"$",/\[\$-\d+\].*a{3,4}/.test(this.format))return;i.fmtIsDate(this.format)||this.addNewToken(n.TokenType.Text,this.tempString)}else if(this.tempString.match(/DBNum\d+/)){if(this.addNewToken(n.TokenType.ChineseNumber,this.tempString),this.tempString="",this.index<this.format.length&&"["===this.format.charAt(this.index)){for(;"]"!==this.format.charAt(this.index)&&this.index+1<this.format.length;)this.index+=1,this.tempString+=this.format.charAt(this.index);if(this.index+=1,"]"!==this.tempString.slice(-1))throw'unterminated "[" block: |'+this.tempString+"|"}}else a.isColorFormat(this.tempString)&&this.addNewToken(n.TokenType.Color,a.getColorByFormat(this.tempString))}},e.prototype.handleDot=function(){if(null!==this.formatDate){for(this.tempString=this.currentChar,this.index+=1;this.index<this.format.length&&(this.currentChar=this.format.charAt(this.index),"0"===this.currentChar);)this.tempString+=this.currentChar,this.index+=1;this.addNewToken(n.TokenType.Second,this.tempString),this.isNeedToBreak=!0}},e.prototype.handleZeroOrPound=function(){var e=this;for(this.tempString=this.currentChar,this.index+=1;this.index<this.format.length;){this.currentChar=this.format.charAt(this.index);if(!("0#?.,E+-%".indexOf(e.currentChar)>-1||/^\\-[0#]$/.test(e.format.substr(e.index,3))))break;this.tempString+=this.currentChar,this.index+=1}this.addNewToken(n.TokenType.Number,this.tempString)},e.prototype.handleQuestionMark=function(){for(this.tempString=this.currentChar,this.index+=1;this.format.charAt(this.index)===this.currentChar;)this.tempString+=this.currentChar,this.index+=1;this.addNewToken(n.TokenType.QuestionMark,this.tempString),this.lastParsedType=n.TokenType.QuestionMark},e.prototype.handleAsterisk=function(){this.index+=2},e.prototype.handleParentheses=function(){var e=1===this.formatListLength?n.TokenType.Text:this.currentChar;this.addNewToken(e,this.currentChar),this.index+=1},e.prototype.handleNumber=function(){for(this.tempString=this.currentChar;this.index<this.format.length&&(this.index+=1,this.currentChar=this.format.charAt(this.index),-1!=="0123456789".indexOf(this.currentChar));)this.tempString+=this.format.charAt(this.index);this.addNewToken(n.TokenType.Digit,this.tempString)},e.prototype.handleSpace=function(){for(this.tempString=this.currentChar;this.index<this.format.length&&(this.index+=1,this.currentChar=this.format.charAt(this.index)," "===this.currentChar);)this.tempString+=this.format.charAt(this.index);this.addNewToken(n.TokenType.Space,this.tempString)},e.prototype.handlePercent=function(){this.addNewToken(n.TokenType.Number,this.currentChar),this.index+=1},e.prototype.handleOthers=function(){-1!==",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(this.currentChar)?(this.addNewToken(n.TokenType.Text,this.currentChar),this.index+=1):this.isValid=!1},e}();t.Tokenizer=c},b4b29a3aa3:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return d}));var n=r("0774a881b4"),o=r.n(n),i=r("dfdfcc8cff"),a=r("4f3b15d017"),s=a.default.isTencentDocsApp,c=a.default.isQQ,u=a.default.isWindows;function l(){var t,r;return(null===(t=e)||void 0===t?void 0:t.ntqq)||(null===(r=e)||void 0===r?void 0:r.ntQQApi)}function d(e,t){var r=t.replace,n=t.style,a=t.useNewConfig,d=t.supportIFrame,f=t.appOption,h=Object(i.a)(d),m=Object(i.c)(d),p=n||2;r||!u||!c||l()?r&&!l()||!h?function(e,t){var r=Object(i.c)(t);s?(r.history.replaceState(null,document.title,e),r.location.replace("")):r.location.replace(e)}(e,d):null==h||h.invoke("ui","openUrl",o()(o()({},f),{},{url:e,target:1,style:p,useQQBrowser:!0,useNewConfig:a}),(function(){})):m.open(e)}}).call(this,r("5ef37df1a0"))},b9b0089083:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUPPORT_CURRENCY_LIST=void 0,t.SUPPORT_CURRENCY_LIST=[{symbol:"¥",type:"currency-chs",pattern:'"¥"#,##0_);[Red]\\("¥"#,##0\\)',pattern_decimal:'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)'},{symbol:"HK$",type:"currency-hk",pattern:"[$HK$-C04]#,##0_);[Red]\\([$HK$-C04]#,##0\\)",pattern_decimal:"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)"},{symbol:"$",type:"currency-en",pattern:"\\$#,##0_);[Red]\\(\\$#,##0\\)",pattern_decimal:"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)"},{symbol:"US$",type:"currency-en",pattern:"\\U\\S\\$#,##0_);[Red]\\(\\U\\S\\$#,##0\\)",pattern_decimal:"\\U\\S\\$#,##0.00_);[Red]\\(\\U\\S\\$#,##0.00\\)"}]},c1e2057026:function(e,t,r){var n=r("a2a6099311");e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},c2e01418c7:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},c3de12fe35:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse_date_code=t.fmtIsDate=void 0;var n=r("46d006027f");t.fmtIsDate=function(e){for(var t,r=0;r<e.length;)switch(t=e.charAt(r)){case"G":n.isGeneral(e,r)&&(r+=6),r+=1;break;case'"':for(var o=!1;r+1<e.length;)if(r+=1,34===e.charCodeAt(r)){o=!0;break}if(!o)return!1;r+=1;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;r+=1;break;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":var i=e.substr(r,3);if("A/P"===i.toUpperCase())return!0;if("AAA"===i.toUpperCase())return!0;if("AAAA"===(i=e.substr(r,4)).toUpperCase())return!0;if("AM/PM"===(i=e.substr(r,5)).toUpperCase())return!0;r+=1;break;case"上":if("上午/下午"===e.substr(r,5).toUpperCase())return!0;r+=1;break;case"[":for(var a=t;"]"!==e.charAt(r)&&!((r+=1)>=e.length);)a+=e.charAt(r);if(a.match(/\[[HhMmSs]*\]/))return!0;break;case".":case"0":case"#":for(;r<e.length&&(r+=1,t=e.charAt(r),"0#?.,E+-%".indexOf(t)>-1||"\\"===t&&"-"==e.charAt(r+1)&&"0#".indexOf(e.charAt(r+2))>-1););break;default:r+=1}return!1},t.parse_date_code=function(e,t,r){if("number"!=typeof e)return null;var n={default:[1317,8,29],twoMonth:[1317,10,29]},o={default:[1900,1,0],twoMonth:[1900,3,1]};if(e>=2958466||e<0)return null;var i=0|e,a=Math.floor(86400*(e-i)),s=0,c=[],u={date:i,time:a,subsecond:86400*(e-i)-a,year:0,month:0,day:0,hour:0,minute:0,second:0,week:0};if(Math.abs(u.subsecond)<1e-6&&(u.subsecond=0),(null==t?void 0:t.date1904)&&(i+=1462),u.subsecond>=.95&&(u.subsecond=0,86400===(a+=1)&&(a=0,u.time=0,i+=1,u.day+=1)),60===i)c=r?n.twoMonth:o.twoMonth,s=4;else if(0===i)c=r?n.default:o.default,s=6;else{var l=i,d=new Date(1900,0,1);d.setDate(l),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],s=d.getDay(),i<60&&(s=(s+6)%7),r&&(s=0)}return u.year=c[0],u.month=c[1],u.day=c[2],u.second=a%60,a=Math.floor(a/60),u.minute=a%60,a=Math.floor(a/60),u.hour=a,u.week=s,u}},cfee364b0d:function(e,t,r){"use strict";function n(e){for(var t=[],r=!1,n=0,o=0;o<e.length;o++)switch(e.charCodeAt(o)){case 34:r=!r;break;case 95:case 92:case 42:r||(o+=1);break;case 59:r||(t.push(e.substr(n,o-n)),n=o+1)}if(!0===r)throw new Error("Format |"+e+"| unterminated string ");return t.push(e.substr(n)),t}function o(e,t){var r={"+":function(){return!!t[1].match(/>|>=|<>/)},0:function(){return!!t[1].match(/<=|>=|=/)},"-":function(){return!!t[1].match(/<|<=|<>/)}},n=e-parseFloat(t[2]);return r[n>0?"+":n<0?"-":"0"]()}function i(e,t){var r;switch(e.length){case 1:r=t?[e[0],e[0],e[0],e[0]]:[e[0],e[0],e[0],"@"];break;case 2:r=t?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:r=t?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;default:r=e}return r}function a(e,t){var r=/\[[=<>]/,n=/\[(=|>|>=|<|<=|<>)(-?\d+(?:\.\d*)?)\]/,i=/\[(=|>|>=|<|<=|<>)(-Infinity)\]/,a=!1,s=t.slice(0,2);-1===s[0].indexOf("[]")||s[0].match(r)||(s[0]="[>0]"+s[0]),-1===s[1].indexOf("[]")||s[1].match(r)||(s[1]="[>"+Number.NEGATIVE_INFINITY+"]"+s[1]);for(var c=0,u=0,l=s;u<l.length;u++){var d=l[u];if(d.match(r)){a=!0;var f=d.match(n)||d.match(i);if(!f)continue;if(c+=1,o(e,f))return d}}return a?2===c?t[2]:s[1]:null}Object.defineProperty(t,"__esModule",{value:!0}),t.choose_fmt=t.getConditionFormat=t.getFullFormatList=t.checkConditon=t.splitFormat=void 0,t.splitFormat=n,t.checkConditon=o,t.getFullFormatList=i,t.getConditionFormat=a,t.choose_fmt=function(e,t){var r,o=Number(t);try{r=n(e)}catch(e){r=["General"]}var s,c=r.length,u=r[c-1].indexOf("@")>-1;if(c<4&&u&&(c-=1),r=i(r,u),isNaN(o))return{formatListLength:c,chosenFormatCode:r[3]};if(s=0===o?r[2]:o>0?r[0]:r[1],-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return{formatListLength:c,chosenFormatCode:s};var l=a(o,r);return l?{formatListLength:c,chosenFormatCode:l}:{formatListLength:c,chosenFormatCode:s}}},d292a8cd59:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("72cd22511f"),o=r("69672a4655"),i=function(){function e(){this.pool=new Map,this.maxId=o.RESERVED_NUMBER_FORMAT_NUM}return e.prototype.createInstance=function(e){var t,r=e.id,n=e.pattern;return"string"==typeof n&&n?(t=this.pool.get(n))?t:(-1===(r=o.BUILDIN_NUMBER_FORMAT.indexOf(n))&&(r=this.maxId,this.maxId+=1),t=this.addNumberFormatToPool(r,n)):"number"!=typeof r||isNaN(r)?this.getDefaultNumberFormat():((t=this.pool.get(r))||(r<o.BUILDIN_NUMBER_FORMAT.length?(n=o.BUILDIN_NUMBER_FORMAT[r],t=this.addNumberFormatToPool(r,n)):t=this.getDefaultNumberFormat()),t)},e.prototype.clear=function(){this.pool=new Map},e.prototype.getDefaultNumberFormat=function(){var e=this.pool.get(0);return e||(e=this.addNumberFormatToPool(0,o.DEFAULT_FORMAT_PATTERN)),e},e.prototype.addNumberFormatToPool=function(e,t){var r=new n.NumberFormat({id:e,pattern:t});return this.pool.set(e,r),this.pool.set(t,r),r},e}();t.default=new i},d3a0d3eb66:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e=100),this.capacity=e,this.map={}}return e.prototype.delete=function(e){var t=this.map[e];return!!t&&(this.remove(t),delete this.map[t.key],!0)},e.prototype.get=function(e){var t=this.map[e];if(t)return this.remove(t),this.setHead(t),t.value},e.prototype.keys=function(){for(var e=[],t=this.head;t;)e.push(t.key),t=t.next;return e},e.prototype.latest=function(){return this.head.value},e.prototype.oldest=function(){return this.end.value},e.prototype.remove=function(e){return e.previous?e.previous.next=e.next:this.head=e.next,null!=e.next?e.next.previous=e.previous:this.end=e.previous,e},e.prototype.put=function(e,t){var r=this.map[e],n={key:void 0,value:void 0};if(r)return r.value=t,n=this.remove(r),this.setHead(r),n.value;var o={key:e,value:t};return Object.keys(this.map).length>=this.capacity?(delete this.map[this.end.key],n=this.remove(this.end),this.setHead(o)):this.setHead(o),this.map[e]=o,n.value},e.prototype.setHead=function(e){e.next=this.head,e.previous=null,this.head&&(this.head.previous=e),this.head=e,this.end||(this.end=this.head)},e.prototype.size=function(){return Object.keys(this.map).length},e.prototype.toString=function(){for(var e="(newest) ",t=this.head;t;)e+=String(t.key)+":"+t.value,(t=t.next)&&(e+=" > ");return e+" (oldest)"},e}();t.default=n},d976dcd8bb:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberTransfer=void 0;var n=r("f281127eb3"),o=r("fbdde940b1"),i=r("f50ba37686");t.numberTransfer=function(e,t){e=e.filter((function(r,a){if(r.type===n.TokenType.Text&&i.isNumeric(r.value)){var s=void 0;if(a+1<e.length)switch(e[a+1].value){case"年":s={unit:!1,fill:!0};break;case"月":case"日":case"分":case"时":s={unit:!0,fill:!0}}s=s||{unit:!0,fill:!1,showTenOne:!0},r.value=o.convertNumToChinese(String(r.value),t,s)}return!0}))}},df9f2e35bb:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CUSTOM_FORMAT_TABLE=t.BUILDIN_NUMBER_FORMAT=void 0,t.BUILDIN_NUMBER_FORMAT=["General","0","0.00","#,##0","#,##0.00","\\¥#,##0;\\¥-#,##0","\\¥#,##0;]\\¥-#,##0","\\¥#,##0.00;\\¥-#,##0.00","\\¥#,##0.00;]\\¥-#,##0.00","0%","0.00%","0.00E+00","# ?/?","# ??/??","yyyy/m/d","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","hh:mm:ss","yyyy/m/d h:mm","\\$#,##0_);(\\$#,##0)","\\$#,##0_);](\\$#,##0)","\\$#,##0.00_);(\\$#,##0.00)","\\$#,##0.00_);](\\$#,##0.00)",'yyyy"年"m"月"','m"月"d"日"','m"月"d"日"',"m/d/yy",'yyyy"年"m"月"d"日"','h"时"mm"分"','h"时"mm"分"ss"秒"','上午/下午h"时"mm"分"','上午/下午h"时"mm"分"ss"秒"','yyyy"年"m"月"',"#,##0;-#,##0","#,##0;]-#,##0","#,##0.00;-#,##0.00","#,##0.00;]-#,##0.00",'_ * #,##0_ ;_ * -#,##0_ ;_ * "-"_ ;_ @_ ','_ \\¥* #,##0_ ;_ \\¥* -#,##0_ ;_ \\¥* "-"_ ;_ @_ ','_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ \\¥* #,##0.00_ ;_ \\¥* -#,##0.00_ ;_ \\¥* "-"??_ ;_ @_ ',"mm:ss","mm:ss","mm:ss.0","##0.0E+0","@",'yyyy"年"m"月"','m"月"d"日"','yyyy"年"m"月"','m"月"d"日"','m"月"d"日"','上午/下午h"时"mm"分"','上午/下午h"时"mm"分"ss"秒"','yyyy"年"m"月"','m"月"d"日"',"0","0.00","#,##0","#,##0.00","\\¥#,##0;\\¥-#,##0","\\¥#,##0;]\\¥-#,##0","\\¥#,##0.00;\\¥-#,##0.00","\\¥#,##0.00;]\\¥-#,##0.00","0%","0.00%","# ?/?","# ??/??","yyyy/m/d","yyyy/m/d","d-mmm-yy","d-mmm","mmm-yy","h:mm","h:mm:ss","yyyy/m/d h:mm","mm:ss","mm:ss","mm:ss.0"],t.CUSTOM_FORMAT_TABLE=[{label:"G/通用格式",formatData:"General"},{label:"0",formatData:"0"},{label:"0.00",formatData:"0.00"},{label:"#,##0",formatData:"#,##0"},{label:"#,##0.00",formatData:"#,##0.00"},{label:"#,##0;-#,##0",formatData:"#,##0;-#,##0"},{label:"#,##0;[Red]-#,##0",formatData:"#,##0;[Red]-#,##0"},{label:"#,##0.00;-#,##0.00",formatData:"#,##0.00;-#,##0.00"},{label:"#,##0.00;[Red]-#,##0.00",formatData:"#,##0.00;[Red]-#,##0.00"},{label:"¥#,##0;¥-#,##0",formatData:'"¥"#,##0;"¥"-#,##0'},{label:"¥#,##0;[Red]¥-#,##0",formatData:'"¥"#,##0;[Red]"¥"-#,##0'},{label:"¥#,##0.00;¥-#,##0.00",formatData:'"¥"#,##0.00;"¥"-#,##0.00'},{label:"¥#,##0.00;[Red]¥-#,##0.00",formatData:'"¥"#,##0.00;[Red]"¥"-#,##0.00'},{label:"0%",formatData:"0%"},{label:"0.00%",formatData:"0.00%"},{label:"0.00E+00",formatData:"0.00E+00"},{label:"##0.0E+0",formatData:"##0.0E+0"},{label:"# ?/?",formatData:"# ?/?"},{label:"# ??/??",formatData:"# ??/??"},{label:"$#,##0_);($#,##0)",formatData:"$#,##0_);($#,##0)"},{label:"$#,##0_);[Red]($#,##0)",formatData:"$#,##0_);[Red]($#,##0)"},{label:"$#,##0.00_);($#,##0.00)",formatData:"$#,##0.00_);($#,##0.00)"},{label:"$#,##0.00_);[Red]($#,##0.00)",formatData:"$#,##0.00_);[Red]($#,##0.00)"},{label:'yyyy"年"m"月"',formatData:'yyyy"年"m"月"'},{label:'m"月"d"日"',formatData:'m"月"d"日"'},{label:"yyyy/m/d",formatData:"yyyy/m/d"},{label:'yyyy"年"m"月"d"日"',formatData:'yyyy"年"m"月"d"日"'},{label:"m/d/yy",formatData:"m/d/yy"},{label:"d-mmm-yy",formatData:"d-mmm-yy"},{label:"d-mmm",formatData:"d-mmm"},{label:"mmm-yy",formatData:"mmm-yy"},{label:"h:mm AM/PM",formatData:"h:mm AM/PM"},{label:"h:mm:ss AM/PM",formatData:"h:mm:ss AM/PM"},{label:"h:mm",formatData:"h:mm"},{label:"h:mm:ss",formatData:"h:mm:ss"},{label:'h"时"mm"分"',formatData:'h"时"mm"分"'},{label:'h"时"mm"分"ss"秒"',formatData:'h"时"mm"分"ss"秒"'},{label:'上午/下午h"时"mm"分"',formatData:'上午/下午h"时"mm"分"'},{label:'上午/下午h"时"mm"分"ss"秒"',formatData:'上午/下午h"时"mm"分"ss"秒"'},{label:"yyyy/m/d h:mm",formatData:"yyyy/m/d h:mm"},{label:"mm:ss",formatData:"mm:ss"},{label:"mm:ss.0",formatData:"mm:ss.0"},{label:"@",formatData:"@"},{label:"[h]:mm:ss",formatData:"[h]:mm:ss"}]},dfc6e2583a:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},dfdfcc8cff:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=function(e){return e&&window.frameElement&&window.top||window},o=function(e){var t;return e&&window.frameElement?null===(t=window.top)||void 0===t?void 0:t.mqq:window.mqq},i=function(e){var t;return e&&window.frameElement?null===(t=window.top)||void 0===t?void 0:t.wx:window.wx}},e447b6c213:function(e,t,r){"use strict";var n,o,i;r.d(t,"i",(function(){return a})),r.d(t,"h",(function(){return o})),r.d(t,"f",(function(){return i})),r.d(t,"j",(function(){return f})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return Q})),r.d(t,"b",(function(){return K})),r.d(t,"e",(function(){return X})),r.d(t,"l",(function(){return w})),r.d(t,"g",(function(){return R})),r.d(t,"d",(function(){return n})),function(e){e[e.ClientDB=0]="ClientDB",e[e.IndexDB=1]="IndexDB"}(n||(n={})),function(e){e[e.IN=0]="IN",e[e.LOWER_BOUND=1]="LOWER_BOUND",e[e.UPPER_BOUND=2]="UPPER_BOUND",e[e.BOUND=3]="BOUND",e[e.ONLY=4]="ONLY",e[e.NOT_IN=5]="NOT_IN"}(o||(o={})),function(e){e[e.INCREASE=0]="INCREASE",e[e.DECREASE=1]="DECREASE",e[e.INCREASE_BY_TEXT=2]="INCREASE_BY_TEXT",e[e.DECREASE_BY_TEXT=3]="DECREASE_BY_TEXT"}(i||(i={}));var a=function(){function e(){this._conditions=new Array,this._limitCount=Number.MAX_VALUE,this._offsetCount=0,this._orders=[]}return e.newInstance=function(){return new e},e.prototype.addCondition=function(e,t,r){var n=r;if(t===o.LOWER_BOUND)(i=r).open=void 0===i.open||i.open,n=i;else if(t===o.UPPER_BOUND){(i=r).open=void 0===i.open||i.open,n=i}else if(t===o.BOUND){var i;(i=r).lowerOpen=void 0===i.lowerOpen||i.lowerOpen,i.upperOpen=void 0===i.upperOpen||i.upperOpen,n=i}return this._conditions.push({type:t,column:e,value:n}),this},e.prototype.index=function(e){this._index=e},e.prototype.getIndexKey=function(){return this._index},e.prototype.limit=function(e,t){if(void 0===t?this._limitCount=e:(this._limitCount=t,this._offsetCount=e),this._limitCount<=0)throw new Error("limit size must be opposite value.");return this},e.prototype.offset=function(e){if(e<0)throw new Error("offset size must be opposite value or zero.");return this._offsetCount=e,this},e.prototype.orderby=function(e,t){return this._orders.push({key:e,type:t}),this},e.prototype.hasOrder=function(){return this._orders.length>0},e.prototype.getOrders=function(){return this._orders},e.prototype.hasIndex=function(){return void 0!==this._index},e.prototype.limitSize=function(){return this._limitCount},e.prototype.offsetCount=function(){return this._offsetCount},Object.defineProperty(e.prototype,"conditions",{get:function(){return this._conditions},enumerable:!0,configurable:!0}),e}();window.QueryCondition=a,window.QUERY_CONDITION_TYPE=o;var s,c,u=(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},s(e,t)},function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t){var r=e.call(this,t)||this;return r.errorType="BaseError",r}return u(t,e),t.copyFrom=function(e){var r=new t(e.message);return r.name=e.name,r.stack=e.stack,r},t}(Error),d=l,f=function(e,t){void 0!==e&&(void 0===e.errorType?this.error=d.copyFrom(e):this.error=e),void 0!==t&&(this.data=t)},h=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){e.NO_RESULT_ERROR="noResultError"}(c||(c={}));var m=function(e){function t(t,r){var n=e.call(this,r)||this;return n.name="DataError",n.errorType=t,n}return h(t,e),t}(d),p=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},v=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},_=function(){function e(e){this._canAutoResume=!0,this._dbName=e.databaseName,this._dbVersion=e.version,this._tables=e.tables}return e.prototype.setAutoResume=function(e){void 0===e&&(e=!0),this._canAutoResume=e},e.prototype.disConnect=function(e){return void 0===e&&(e=!0),p(this,void 0,void 0,(function(){return v(this,(function(e){return[2,Promise.resolve(new f(void 0,!0))]}))}))},e}(),E=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},b=window,y=function(){function e(){}return e.debug=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{b.log?(t=b.log).debug.apply(t,r):console.debug.apply(console,r)}catch(t){e.error("日志发生错误","debug",r)}},e.log=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{b.log?(t=b.log).info.apply(t,r):console.log.apply(console,r)}catch(t){e.error("日志发生错误","log",r)}},e.warn=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{b.log?(t=b.log).warn.apply(t,r):console.warn.apply(console,r)}catch(t){e.error("日志发生错误","warn",r)}},e.error=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{b.log?(e=b.log).error.apply(e,t):console.error.apply(console,t)}catch(e){console.error("日志发生错误","error",t)}},e.time=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={time:Date.now(),options:t};this.sTimeLableMap.set(e,n)},e.timeEnd=function(t){var r=Date.now(),n=e.sTimeLableMap.get(t);if(void 0!==n){var o=r-n.time,i="";n.options&&3===n.options.length&&"clientDatabaseRequest"===n.options[1]&&(i=n.options[2]),e.log.apply(e,E(["label: "+t+": "+o+"ms."],n.options)),e.speedReport(o,i),this.sTimeLableMap.delete(t)}},e.speedReport=function(e,t){t&&b.dbjsApiSpeedReport&&b.dbjsApiSpeedReport(e,t)},e.sTimeLableMap=new Map,e}(),T=y,g=function(){function e(){this.canUseNativeAndroid=window.mqq&&window.mqq.android&&window._mqqWebViewJSInterface&&window._mqqWebViewJSInterface.invoke,this.currentSeqId=0,this.reqCallbacks=new Map}return e.prototype.JSApiCallback=function(e){var t=this.reqCallbacks.get(e.callbackId);if(t){var r=t.callback,n=t.command,o=t.startTime;r&&(T.debug("callback invokeNative-"+e.callbackId+"-"+n+"-"+(Date.now()-o)+"ms",this.canUseNativeAndroid,"response="+JSON.stringify(e)),r(e))}else T.warn("callback invokeNative-"+e.callbackId+" reqCallback not found")},e.prototype.createReqSeq=function(){return this.currentSeqId++},e.prototype.invokeNative=function(e,t,r,n){var o=this.createReqSeq(),i=r.command;this.reqCallbacks.set(o,{callback:n,command:i,startTime:Date.now()}),T.debug("start call invokeNative-"+o+"-"+i,e,t,i,this.canUseNativeAndroid,"request="+JSON.stringify(r)),r.callbackId=o,this.canUseNativeAndroid?this.invokeNativeAndroid(e,t,r):window.mqq&&window.mqq.invoke(e,t,r)},e.prototype.invokeNativeAndroid=function(e,t,r){var n="jsbridge://"+encodeURIComponent(e)+"/"+encodeURIComponent(t);r&&(n+="?p="+encodeURIComponent(JSON.stringify(r))),window._mqqWebViewJSInterface.invoke(n)},e.prototype.defaultOfflineCodeVersion=function(e,t){T.debug("defaultOfflineCodeVersion-"+e),window.mqq&&window.mqq.invoke("docx","defaultOfflineCodeVersion",{type:e},(function(r){T.debug("defaultOfflineCodeVersion-"+e),t&&t(r)}))},e}(),R=window.jsApi;window.jsApi||(R=new g,window.jsApi=R,window.JSApiCallback||(window.JSApiCallback=R.JSApiCallback.bind(R)));var C,O,S;window;function w(e){return e.errorType===c.NO_RESULT_ERROR}function A(e,t){return function(r,n,o){var i=o.value;o.value=function(){var r=i.apply(this,arguments);return arguments[0]===t?r.then((function(t){return t.error||(t.data=(r=t.data,n=e,Array.isArray(r)?r.map((function(e){return new n.prototype.constructor(e)})):new n.prototype.constructor(r))),t;var r,n})):r}}}function I(e,t,r){return void 0===r&&(r=!0),r?e<t:e<=t}!function(e){e[e.EXCEL=1]="EXCEL",e[e.WORD=0]="WORD"}(C||(C={})),function(e){e.NEW="new",e.LOCAL="local",e.DELETED="deleted",e.NORMAL="normal"}(O||(O={})),function(e){e.INIT="init",e.DOCUMENT="document",e.WORKBOOK="workbook",e.CHUNK="chunk",e.ACCEPTED="accepted",e.MISS_CHANGE="misschange",e.NEW_CHANGE="newchange",e.COMMITING="commiting",e.WATTING="watting",e.QUEUE="queue"}(S||(S={}));var F,N=function(){function e(t){this.chunkId=0,this.default=!1,t.taskId||(t.taskId=e.createMessageSeq()),t.key||(t.chunkId=t.chunkId||0,t.type===S.INIT?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid:t.type===S.DOCUMENT?t.key=t.globalPadId+"_"+t.uid+"_version_"+t.version:t.type===S.WORKBOOK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_version_"+t.version:t.type===S.CHUNK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.chunkId+"_"+t.uid+"_version_"+t.version:t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_taskId_"+t.taskId),t.default=t.default||!1,this.key=t.key,this.uid=t.uid,this.globalPadId=t.globalPadId,this.secretId=t.secretId,this.subSheetId=t.subSheetId,this.chunkId=t.chunkId,this.type=t.type,this.docType=t.docType,this.padStatus=t.padStatus,this.taskId=t.taskId,this.version=t.version,this.data=t.data||t._data,this.default=t.default,this.createTime=t.createTime,this.dver=t.dver}return e.createMessageSeq=function(){return Math.ceil(2147483648*Math.random())},e.prototype.disableConvert=function(){return this.docType===C.WORD&&"BB08J2"!==this.subSheetId},Object.defineProperty(e.prototype,"data",{get:function(){if("string"==typeof this._data&&!this.disableConvert()){var e=this._data;try{e=JSON.parse(this._data)}catch(e){y.error(e)}return e}return this._data},set:function(e){this._data="string"!=typeof e?JSON.stringify(e):e},enumerable:!0,configurable:!0}),e}(),D=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),k=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},M=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},L=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x="client_data_base_performance",U=function(e){function t(t){return e.call(this,t)||this}return D(t,e),t.isValidResponse=function(e){return"object"==typeof e},t.prototype.init=function(){var e=this;return new Promise((function(t,r){var n=Date.now(),o={command:"init",table:e._tables,dbName:e._dbName};R.invokeNative("docx","clientDatabaseRequest",o,(function(r){if(r.err_msg||r.err_code){var i=new Error(r.err_msg||r.err_code);t(new f(i))}else t(new f(void 0,void 0));e.reportBeacon(x,n,o,r)}))}))},t.prototype.set=function(e,t){var r=this;return new Promise((function(n,o){var i=Date.now(),a={command:"set",tableName:e,data:t,dbName:r._dbName};R.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);n(new f(t))}else n(new f(void 0,e.result));r.reportBeacon(x,i,a,e)}))}))},t.prototype.update=function(e,t){var r=this;return new Promise((function(n,o){var i=Date.now(),a={command:"update",tableName:e,data:t,dbName:r._dbName};R.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);n(new f(t))}else n(new f(void 0,e.result));r.reportBeacon(x,i,a,e)}))}))},t.prototype.updateField=function(e,t,r){var n=this;return new Promise((function(o,i){var a=Date.now(),s={command:"updateField",tableName:e,where:t,toBeUpdated:r,dbName:n._dbName};R.invokeNative("docx","clientDatabaseRequest",s,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);o(new f(t))}else o(new f(void 0,e.result));n.reportBeacon(x,a,s,e)}))}))},t.prototype.updateMultiTableData=function(e){var t=this;return new Promise((function(r,n){var o=Date.now(),i={command:"updateMultiTableData",multiData:e,dbName:t._dbName};R.invokeNative("docx","clientDatabaseRequest",i,(function(e){if(e.err_msg||e.err_code){var n=new Error(e.err_msg||e.err_code);r(new f(n))}else r(new f(void 0,e.result));t.reportBeacon(x,o,i,e)}))}))},t.prototype.delete=function(e,t){var r=this;return new Promise((function(n,o){var i=Date.now(),a={command:"delete",tableName:e,where:t,dbName:r._dbName};R.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);n(new f(t))}else n(new f(void 0,e.result));r.reportBeacon(x,i,a,e)}))}))},t.prototype.deleteAndWrite=function(e,t,r){var n=this;return new Promise((function(o,i){var a=Date.now(),s={command:"deleteAndWrite",tableName:e,where:t,newData:r,dbName:n._dbName};R.invokeNative("docx","clientDatabaseRequest",s,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);o(new f(t))}else o(new f(void 0,e.result));n.reportBeacon(x,a,s,e)}))}))},t.prototype.get=function(e,t){return P(this,void 0,void 0,(function(){var r=this;return L(this,(function(n){return[2,new Promise((function(n,o){var i=Date.now(),a={command:"get",tableName:e,where:t,dbName:r._dbName};R.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);n(new f(t))}else e.result?n(new f(void 0,e.result)):n(new f(new m(c.NO_RESULT_ERROR,"没有找到符合条件的内容")));r.reportBeacon(x,i,a,e)}))}))]}))}))},t.prototype.getAll=function(e,t){var r=this;return new Promise((function(n,o){var i=Date.now(),a={command:"getAll",tableName:e,where:t,dbName:r._dbName};R.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);n(new f(t))}else n(new f(void 0,e.result||[]));r.reportBeacon(x,i,a,e)}))}))},t.prototype.reportBeacon=function(e,t,r,n){try{window.beaconHandler&&window.beaconHandler.onUserAction(e,{tableName:r.tableName||"",command:r.command||"",dbName:r.dbName||"",error_msg:n.err_msg||"",consume_time:Date.now()-t,event_result:n.err_code||0,cost:Date.now()-t,resultCode:n.err_code||0})}catch(e){y.error(e)}},k([A(N,"OfflineData"),A(N,"DocumentData"),M("design:type",Function),M("design:paramtypes",[String,a]),M("design:returntype",Promise)],t.prototype,"get",null),k([A(N,"OfflineData"),A(N,"DocumentData"),M("design:type",Function),M("design:paramtypes",[String,a]),M("design:returntype",void 0)],t.prototype,"getAll",null),t}(_),B=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){e.NOT_SUPPORT_INDEXEDDB="notSupportIndexedDB",e.OPEN_FAIL="openFail",e.TRANSACTION_FAIL="transactionFail",e.DB_BLOCKED="DBBlocked",e.CHECK_FAIL="checkFail",e.REQUEST_ERROR="requestError"}(F||(F={}));var j=function(e){function t(t,r){var n=e.call(this,r)||this;return n.name="DBError",n.errorType=t,n}return B(t,e),t}(d),$=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),W=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},G=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},H=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},V=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},q=function(e){function t(t){var r=e.call(this,t)||this;return r.openErrorCount=0,r}return $(t,e),t.prototype.init=function(e){return H(this,void 0,void 0,(function(){var t=this;return V(this,(function(r){return[2,new Promise((function(r,n){return H(t,void 0,void 0,(function(){var t,n,o,i;return V(this,(function(a){switch(a.label){case 0:return T.time("IndexedDatabaseInit"),(t=this)._indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,t._indexedDB?e?[4,this.deleteDB()]:[3,2]:(T.error("IndexedDatabase","NOT_SUPPORT_INDEXEDDB"),t.database=null,n=new j(F.NOT_SUPPORT_INDEXEDDB),r(new f(n)),[2]);case 1:(o=a.sent()).error&&T.error(o.error),a.label=2;case 2:try{i=t._indexedDB.open(t._dbName,t._dbVersion)}catch(e){return T.error("IndexedDatabase","open() error",e),t.database=null,n=new j(F.OPEN_FAIL,e.name||e.message||""),r(new f(n)),[2]}return i.onerror=function(e){return H(this,void 0,void 0,(function(){var o,a,s,c;return V(this,(function(u){switch(u.label){case 0:return t.openErrorCount++,i.error&&"InvalidStateError"===i.error.name&&e.preventDefault(),T.error("IndexedDatabase","init() onerror()",e),t.database=null,t.openErrorCount<2&&e&&e.target&&e.target.error&&"VersionError"===e.target.error.name?(o=t._dbVersion+1,a=e.target.error.message,(s=/\((\d+)\).*\((\d+)\)/.exec(a))&&(o=Number(s[2])),t._dbVersion=o,[4,t.init()]):[3,2];case 1:return c=u.sent(),r(c),[2];case 2:return n=new j(F.REQUEST_ERROR,e),r(new f(n)),[2]}}))}))},i.onsuccess=function(e){T.timeEnd("IndexedDatabaseInit"),t.database=i.result,t.database.onversionchange=function(){window.dispatchEvent(new Event("OnTencentDocsDBVersionChanged"))},r(new f(void 0,i.result))},i.onblocked=function(e){T.error("IndexedDatabase","init() onblocked()",e),t.database=null,n=new j(F.DB_BLOCKED),r(new f(n,e))},i.onupgradeneeded=function(e){T.warn("IndexedDatabase","init() onupgradeneeded()",e);var r=e.target.result;r.objectStoreNames&&t._tables.forEach((function(e){var t;r.objectStoreNames.contains(e.tableName)||(t=e.keyName?r.createObjectStore(e.tableName,{keyPath:e.keyName}):r.createObjectStore(e.tableName,{autoIncrement:!0}),e.indexs&&e.indexs.forEach((function(e){t.createIndex(e,e,{unique:!1})})))}))},[2]}}))}))}))]}))}))},t.prototype.deleteDB=function(){return H(this,void 0,void 0,(function(){var e=this;return V(this,(function(t){return[2,new Promise((function(t){var r,n=e._indexedDB.deleteDatabase(e._dbName);n.onsuccess=function(){t(new f(r,!0))},n.onerror=function(e){r=new j(F.REQUEST_ERROR,e),t(new f(r))}}))]}))}))},t.prototype.bindCommonEvent=function(e,t,r,n){t.onabort=function(){T.error("IndexedDatabase","bindCommonEvent() onabort","TransactionAbortError");var e=new Error("TransactionAbortError");window.dispatchEvent(new Event("OnDBTransactionAbort")),r(new f(e))},t.onerror=function(){T.error("IndexedDatabase","bindCommonEvent() onerror","UnKnownTransactionError");var e=new Error("UnKnownTransactionError");window.dispatchEvent(new Event("OnDBTransactionError")),r(new f(e))}},t.prototype.getDBConnection=function(e,t,r,n,i){var a,s,c;try{if(c=(s=this.database.transaction([e],r)).objectStore(e),t&&t.hasIndex()){var u=t.getIndexKey(),l=c.index(u),d=void 0,h=-1;if(t)for(var m=0;m<t.conditions.length;m++){var p=t.conditions[m];if(p.column===u){switch(p.type){case o.ONLY:d=IDBKeyRange.only(p.value),h=m;break;case o.LOWER_BOUND:var v=p.value;d=IDBKeyRange.lowerBound(v.lower,v.open),h=m;break;case o.UPPER_BOUND:var _=p.value;d=IDBKeyRange.upperBound(_.upper,_.open),h=m;break;case o.BOUND:var E=p.value;d=IDBKeyRange.bound(E.lower,E.upper,E.lowerOpen,E.upperOpen),h=m}if(-1!==h){t.conditions.splice(h,1);break}}}a=l.openCursor(d)}else a=c.openCursor();this.bindCommonEvent(a,s,n,1e4)}catch(e){return T.error("IndexedDatabase","getDBConnection() error",e),new f(e)}return T.debug("IndexedDatabase","getDBConnection() done."),new f(void 0,{request:a,transaction:s,objectStore:c})},t.prototype.set=function(e,t){return T.time("IndexedDatabaseSet",e,t),this.setOrUpdate("Set",e,t)},t.prototype.update=function(e,t){return T.time("IndexedDatabaseUpdate",e,t),this.setOrUpdate("Update",e,t)},t.prototype.setOrUpdate=function(e,t,r){return H(this,void 0,void 0,(function(){var n=this;return V(this,(function(o){return[2,new Promise((function(o,i){return H(n,void 0,void 0,(function(){var n,a,s,c,u;return V(this,(function(l){switch(l.label){case 0:return[4,this.checkAndOpenTable(t)];case 1:if(l.sent().error)return n=new j(F.CHECK_FAIL),o(new f(n)),[2];if((a=this.getDBConnection(t,void 0,"readwrite",o,i)).error)return o(new f(a.error)),[2];if(s=a.data.objectStore,c=a.data.transaction,"set"===e)u=s.add(r);else try{u=s.put(r,r.__primaryKey)}catch(e){u=s.put(r)}return u.onerror=function(e){n=new j(F.REQUEST_ERROR,e)},c.oncomplete=function(){T.timeEnd("IndexedDatabase"+e),o(new f(n,!0))},[2]}}))}))}))]}))}))},t.prototype.updateField=function(e,t,r){var n=this;return T.time("IndexedDatabaseUpdateField",e,t,r),new Promise((function(o,i){return H(n,void 0,void 0,(function(){var n,a,s,c,u,l;return V(this,(function(d){switch(d.label){case 0:return n=this,[4,this.checkAndOpenTable(e)];case 1:return d.sent().error?(a=new j(F.CHECK_FAIL),o(new f(a)),[2]):(s=this.getDBConnection(e,t,"readwrite",o,i)).error?(o(new f(s.error)),[2]):(c=s.data.request,u=s.data.transaction,c.onerror=function(e){a=new j(F.REQUEST_ERROR,e)},l=new Array,c.onsuccess=function(e){var o=e.target.result;if(o){var i=o.value;if(n.checkCondition(i,t)){var s=Object.assign(i,r);o.update(s).onerror=function(e){a=new j(F.REQUEST_ERROR,e)},l.push(s)}o.continue()}},u.oncomplete=function(){T.timeEnd("IndexedDatabaseUpdateField"),o(new f(a,l))},[2])}}))}))}))},t.prototype.updateMultiTableData=function(e){var t=this;return T.time("IndexedDatabaseUpdateMultiTableData",e),new Promise((function(r,n){return H(t,void 0,void 0,(function(){var t,n,o,i,a,s,c,u,l,d=this;return V(this,(function(h){switch(h.label){case 0:n=0,o=e,h.label=1;case 1:return n<o.length?(i=o[n],[4,this.checkAndOpenTable(i.tableName)]):[3,4];case 2:if(h.sent().error)return t=new j(F.CHECK_FAIL),r(new f(t)),[2];h.label=3;case 3:return n++,[3,1];case 4:a=e.map((function(e){return e.tableName}));try{s=this.database.transaction(a,"readwrite"),c=e.length,u=0,l=0,e.forEach((function(e){var t,n=s.objectStore(e.tableName);try{t=n.put(e.data,e.data.__primaryKey)}catch(r){t=n.put(e.data)}t.onsuccess=function(e){u++},t.onerror=function(e){l++,T.error(e)},d.bindCommonEvent(t,s,r,1e4)})),s.oncomplete=function(){T.timeEnd("IndexedDatabaseUpdateMultiTableData"),l>0?(T.error("IndexedDatabaseUpdateMultiTableData","errorCount=",l),t=new j(F.REQUEST_ERROR),r(new f(t,{totalCount:c,successCount:u,errorCount:l}))):r(new f(void 0,{totalCount:c,successCount:u,errorCount:l}))}}catch(e){return T.error("IndexedDatabase","updateMultiTableData() onError",e),r(new f(e)),[2]}return[2]}}))}))}))},t.prototype.delete=function(e,t){var r=this;return T.time("IndexedDatabaseDelete",e,t),new Promise((function(n,o){return H(r,void 0,void 0,(function(){var r,i,a,s,c,u;return V(this,(function(l){switch(l.label){case 0:return r=this,[4,this.checkAndOpenTable(e)];case 1:return l.sent().error?(i=new j(F.CHECK_FAIL),n(new f(i)),[2]):(a=this.getDBConnection(e,t,"readwrite",n,o)).error?(n(new f(a.error)),[2]):(s=a.data.request,c=a.data.transaction,s.onerror=function(e){i=new j(F.REQUEST_ERROR,e)},u=new Array,s.onsuccess=function(e){var n=e.target.result;if(n){var o=n.value;r.checkCondition(o,t)&&(n.delete(),u.push(o)),n.continue()}},c.oncomplete=function(){T.timeEnd("IndexedDatabaseDelete"),n(new f(i,u))},[2])}}))}))}))},t.prototype.deleteAndWrite=function(e,t,r){var n=this;return T.time("IndexedDatabaseDeleteAndWrite",e,t),new Promise((function(o,i){return H(n,void 0,void 0,(function(){var n,a,s,c,u,l,d,h;return V(this,(function(m){switch(m.label){case 0:return n=this,[4,this.checkAndOpenTable(e)];case 1:return m.sent().error?(a=new j(F.CHECK_FAIL),o(new f(a)),[2]):(s=this.getDBConnection(e,t,"readwrite",o,i)).error?(o(new f(s.error)),[2]):(c=s.data.request,u=s.data.objectStore,l=s.data.transaction,c.onerror=function(e){a=new j(F.REQUEST_ERROR,e)},d=0,h=0,c.onsuccess=function(e){var o=e.target.result;if(o){var i=o.value;n.checkCondition(i,t)&&(o.delete(),d++),o.continue()}else r.forEach((function(e){u.put(e).onsuccess=function(e){h++}}))},l.oncomplete=function(){T.timeEnd("IndexedDatabaseDeleteAndWrite"),T.log("IndexedDatabaseDeleteAndWrite",d,h),o(new f(a,{deleteCount:d,writeCount:h}))},[2])}}))}))}))},t.prototype.get=function(e,t){return H(this,void 0,void 0,(function(){var r,n;return V(this,(function(o){switch(o.label){case 0:return t.limit(1),[4,this.getAll(e,t)];case 1:return(r=o.sent()).error?[2,new f(r.error)]:0===(n=r.data).length?[2,new f(new m(c.NO_RESULT_ERROR,"没有找到符合条件的内容"))]:[2,new f(void 0,n[0])]}}))}))},t.prototype.getAll=function(e,t){var r=this;return T.time("IndexedDatabaseGetAll",e,t),new Promise((function(n,o){return H(r,void 0,void 0,(function(){var r,i,a,s,c,u;return V(this,(function(l){switch(l.label){case 0:return r=this,[4,this.checkAndOpenTable(e)];case 1:return l.sent().error?(i=new j(F.CHECK_FAIL),n(new f(i)),[2]):(a=this.getDBConnection(e,t,"readonly",n,o)).error?(n(new f(a.error)),[2]):(s=a.data.request,c=a.data.transaction,s.onerror=function(e){i=new j(F.REQUEST_ERROR,e)},u=new Array,s.onsuccess=function(e){var n=e.target.result;if(n){var o=n.value;if(r.checkCondition(o,t)&&(o.__primaryKey=n.primaryKey,u.push(o)),!t.hasOrder()&&u.length>=t.limitSize()+t.offsetCount())return;n.continue()}},c.oncomplete=function(){u.length>0&&t.hasOrder()&&(u=r.sortResult(u,t.getOrders()));var e=t.offsetCount(),o=e+t.limitSize();u=u.slice(e,o),T.timeEnd("IndexedDatabaseGetAll"),n(new f(i,u))},[2])}}))}))}))},t.prototype.sortResult=function(e,t){return t.reverse().forEach((function(t,r){e.sort((function(e,r){var n=0;switch(t.type){case i.INCREASE:n=e[t.key]>r[t.key]?1:e[t.key]===r[t.key]?0:-1;break;case i.DECREASE:n=e[t.key]>r[t.key]?-1:e[t.key]===r[t.key]?0:1;break;case i.INCREASE_BY_TEXT:n=e[t.key].localeCompare(r[t.key]);break;case i.DECREASE_BY_TEXT:n=r[t.key].localeCompare(e[t.key])}return n}))})),e},t.prototype.checkCondition=function(e,t){for(var r=!0,n=0;n<t.conditions.length;n++){var i=t.conditions[n];switch(i.type){case o.ONLY:e[i.column]!==i.value&&(r=!1);break;case o.LOWER_BOUND:var a=i.value;I(e[i.column],a.lower,!a.open)&&(r=!1);break;case o.UPPER_BOUND:var s=i.value;I(s.upper,e[i.column],!s.open)&&(r=!1);break;case o.IN:-1===i.value.indexOf(e[i.column])&&(r=!1);break;case o.BOUND:var c=i.value;(I(e[i.column],c.lower,!c.lowerOpen)||I(c.upper,e[i.column],!c.upperOpen))&&(r=!1);break;case o.NOT_IN:-1!==i.value.indexOf(e[i.column])&&(r=!1)}if(!r)break}return r},t.prototype.checkAndOpenTable=function(e){return H(this,void 0,void 0,(function(){var t,r,n;return V(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(t=this).database||!t._canAutoResume?[3,2]:[4,this.init()];case 1:if((r=o.sent()).error)return T.error("IndexedDatabase","checkAndOpenTable()",e,r.error),[2,new f(new j(F.CHECK_FAIL,"database is not available."))];o.label=2;case 2:return t.database?t.database.objectStoreNames.contains(e)?[2,new f(void 0,!0)]:(T.error("IndexedDatabase","checkAndOpenTable()",e,"table "+e+" is not available."),[2,new f(new j(F.CHECK_FAIL,"table "+e+" is not available."))]):(T.error("IndexedDatabase","checkAndOpenTable()",e,"database is not available."),[2,new f(new j(F.CHECK_FAIL,"database is not available."))]);case 3:return n=o.sent(),T.error("IndexedDatabase","checkAndOpenTable()",e,"UnknownError"),[2,new f(n,!1)];case 4:return[2]}}))}))},t.prototype.setAutoResume=function(e){void 0===e&&(e=!0),this._canAutoResume=e},t.prototype.disConnect=function(e){return void 0===e&&(e=!0),H(this,void 0,void 0,(function(){var t;return V(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),T.log("IndexedDatabase","disConnect()",e,this.database),this._canAutoResume=e,this.database?[4,this.database.close()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.database=void 0,[2,Promise.resolve(new f(void 0,!0))];case 3:return t=r.sent(),T.error("IndexedDatabase","disConnect() Error.",t),[2,Promise.resolve(new f(void 0,!1))];case 4:return[2]}}))}))},t._uuid=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(),W([A(N,"OfflineData"),A(N,"DocumentData"),G("design:type",Function),G("design:paramtypes",[String,a]),G("design:returntype",void 0)],t.prototype,"getAll",null),t}(_);"undefined"!=typeof localStorage&&localStorage.getItem("isOfflineModuleDebug");var K,Y=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){e.ILLEGAL_ARGUMENT="IllegalArgument"}(K||(K={}));var Q=function(e){function t(t,r){var n=e.call(this,r)||this;return n.name="ArgumentError",n.errorType=t,n}return Y(t,e),t}(d),z=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),X=function(e){function t(t,r,n){var o=e.call(this,n)||this;return o.name="HttpError",o.errorType="HttpError",o.statusCode=t,o.errorCode=r,o}return z(t,e),t}(d),J=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Z=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ee=function(){function e(e,t,r,o){void 0===r&&(r=n.IndexDB),void 0===o&&(o=1),r===n.ClientDB?this.database=new U({databaseName:e,version:o,tables:t}):this.database=new q({databaseName:e,version:o,tables:t})}return e.prototype.init=function(){return J(this,void 0,void 0,(function(){var e;return Z(this,(function(t){switch(t.label){case 0:return[4,this.database.init(!1)];case 1:return(e=t.sent()).error?[2,e]:[2,new f(void 0,!0)]}}))}))},e}();t.k=ee},e49595a6eb:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFormatType=t.DEFAULT_FORMAT=t.DEFAULT_FORMAT_PATTERN=t.getNumberFormatNameByType=t.isDateCell=t.checkNumericValue=t.decreaseDecimalFormat=t.increaseDecimalFormat=t.formatValue=t.format=t.extToExponential=t.rpad_=t._strrev=t.pad0r=t.pad_=t.pad0=t.fill=t.getRealNumValueStr=t.isGeneral=t.choose_fmt=t.fmtIsDate=t.isNumeric=t.CUSTOM_FORMAT_TABLE=t.MSO_FORMAT_MAP=t.COLOR_MAP=t.INVALID_VALUE=t.SUPPORT_CURRENCY_LIST=t.NumberFormatFactory=t.NumberFormat=t.getCurrencySymbol=t.getCurrentCellDotNum=t.getFormatCodeByNumberFormat=t.getNumberFormatByOldFormat=t.isTextCell=t.clearQuotationMask=t.getCellNumberFormatType=t.getDefaultNumberFormat=t.getNumberFormatByFormatCode=t.isGeneralCell2=t.isGeneralCell=void 0;var o=r("55c6175634");Object.defineProperty(t,"isGeneralCell",{enumerable:!0,get:function(){return o.isGeneralCell}}),Object.defineProperty(t,"isGeneralCell2",{enumerable:!0,get:function(){return o.isGeneralCell2}}),Object.defineProperty(t,"getNumberFormatByFormatCode",{enumerable:!0,get:function(){return o.getNumberFormatByFormatCode}}),Object.defineProperty(t,"getDefaultNumberFormat",{enumerable:!0,get:function(){return o.getDefaultNumberFormat}}),Object.defineProperty(t,"getCellNumberFormatType",{enumerable:!0,get:function(){return o.getCellNumberFormatType}}),Object.defineProperty(t,"clearQuotationMask",{enumerable:!0,get:function(){return o.clearQuotationMask}}),Object.defineProperty(t,"isTextCell",{enumerable:!0,get:function(){return o.isTextCell}}),Object.defineProperty(t,"getNumberFormatByOldFormat",{enumerable:!0,get:function(){return o.getNumberFormatByOldFormat}}),Object.defineProperty(t,"getFormatCodeByNumberFormat",{enumerable:!0,get:function(){return o.getFormatCodeByNumberFormat}}),Object.defineProperty(t,"getCurrentCellDotNum",{enumerable:!0,get:function(){return o.getCurrentCellDotNum}}),Object.defineProperty(t,"getCurrencySymbol",{enumerable:!0,get:function(){return o.getCurrencySymbol}}),Object.defineProperty(t,"increaseDecimalFormat",{enumerable:!0,get:function(){return o.increaseDecimalFormat}}),Object.defineProperty(t,"decreaseDecimalFormat",{enumerable:!0,get:function(){return o.decreaseDecimalFormat}}),Object.defineProperty(t,"checkNumericValue",{enumerable:!0,get:function(){return o.checkNumericValue}}),Object.defineProperty(t,"isDateCell",{enumerable:!0,get:function(){return o.isDateCell}}),Object.defineProperty(t,"getNumberFormatNameByType",{enumerable:!0,get:function(){return o.getNumberFormatNameByType}}),Object.defineProperty(t,"getFormatType",{enumerable:!0,get:function(){return o.getFormatType}});var i=r("a19d1845de");Object.defineProperty(t,"formatValue",{enumerable:!0,get:function(){return i.formatValue}}),Object.defineProperty(t,"format",{enumerable:!0,get:function(){return i.format}});var a=r("69672a4655");Object.defineProperty(t,"SUPPORT_CURRENCY_LIST",{enumerable:!0,get:function(){return a.SUPPORT_CURRENCY_LIST}}),Object.defineProperty(t,"INVALID_VALUE",{enumerable:!0,get:function(){return a.INVALID_VALUE}}),Object.defineProperty(t,"COLOR_MAP",{enumerable:!0,get:function(){return a.COLOR_MAP}}),Object.defineProperty(t,"MSO_FORMAT_MAP",{enumerable:!0,get:function(){return a.MSO_FORMAT_MAP}}),Object.defineProperty(t,"CUSTOM_FORMAT_TABLE",{enumerable:!0,get:function(){return a.CUSTOM_FORMAT_TABLE}}),Object.defineProperty(t,"DEFAULT_FORMAT_PATTERN",{enumerable:!0,get:function(){return a.DEFAULT_FORMAT_PATTERN}}),Object.defineProperty(t,"DEFAULT_FORMAT",{enumerable:!0,get:function(){return a.DEFAULT_FORMAT}});var s=r("f50ba37686");Object.defineProperty(t,"isNumeric",{enumerable:!0,get:function(){return s.isNumeric}}),Object.defineProperty(t,"fmtIsDate",{enumerable:!0,get:function(){return s.fmtIsDate}}),Object.defineProperty(t,"choose_fmt",{enumerable:!0,get:function(){return s.choose_fmt}}),Object.defineProperty(t,"isGeneral",{enumerable:!0,get:function(){return s.isGeneral}}),Object.defineProperty(t,"getRealNumValueStr",{enumerable:!0,get:function(){return s.getRealNumValueStr}}),Object.defineProperty(t,"fill",{enumerable:!0,get:function(){return s.fill}}),Object.defineProperty(t,"pad0",{enumerable:!0,get:function(){return s.pad0}}),Object.defineProperty(t,"pad_",{enumerable:!0,get:function(){return s.pad_}}),Object.defineProperty(t,"pad0r",{enumerable:!0,get:function(){return s.pad0r}}),Object.defineProperty(t,"_strrev",{enumerable:!0,get:function(){return s._strrev}}),Object.defineProperty(t,"rpad_",{enumerable:!0,get:function(){return s.rpad_}}),Object.defineProperty(t,"extToExponential",{enumerable:!0,get:function(){return s.extToExponential}});var c=r("72cd22511f");Object.defineProperty(t,"NumberFormat",{enumerable:!0,get:function(){return c.NumberFormat}});var u=n(r("d292a8cd59"));t.NumberFormatFactory=u.default},e4a614173c:function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},ea5c19bfd3:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n="doc.weixin.qq.com",o="docs.qq.com"},edd91f1601:function(e,t,r){var n=r("a2a6099311");function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}e.exports=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},f281127eb3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpperChineseNumberString=t.LowerChineseNumberString=t.NUMBER_FORMAT_NAME=t.RESERVED_NUMBER_FORMAT_NUM=t.INVALID_VALUE=t.DEFAULT_FORMAT=t.DEFAULT_FORMAT_PATTERN=t.CUSTOM_FORMAT_TABLE=t.BUILDIN_NUMBER_FORMAT=t.MSO_FORMAT_MAP=t.MONTHS=t.DAYS=t.SUPPORT_CURRENCY_LIST=t.COLOR_MAP=t.TokenType=t.NumberLanguageCaseType=void 0;var n=r("a5d0c84e2b");Object.defineProperty(t,"COLOR_MAP",{enumerable:!0,get:function(){return n.COLOR_MAP}});var o=r("b9b0089083");Object.defineProperty(t,"SUPPORT_CURRENCY_LIST",{enumerable:!0,get:function(){return o.SUPPORT_CURRENCY_LIST}});var i=r("03979ee444");Object.defineProperty(t,"DAYS",{enumerable:!0,get:function(){return i.DAYS}}),Object.defineProperty(t,"MONTHS",{enumerable:!0,get:function(){return i.MONTHS}}),Object.defineProperty(t,"MSO_FORMAT_MAP",{enumerable:!0,get:function(){return i.MSO_FORMAT_MAP}});var a=r("df9f2e35bb");Object.defineProperty(t,"BUILDIN_NUMBER_FORMAT",{enumerable:!0,get:function(){return a.BUILDIN_NUMBER_FORMAT}}),Object.defineProperty(t,"CUSTOM_FORMAT_TABLE",{enumerable:!0,get:function(){return a.CUSTOM_FORMAT_TABLE}});var s=r("48edcd5139");Object.defineProperty(t,"DEFAULT_FORMAT_PATTERN",{enumerable:!0,get:function(){return s.DEFAULT_FORMAT_PATTERN}}),Object.defineProperty(t,"DEFAULT_FORMAT",{enumerable:!0,get:function(){return s.DEFAULT_FORMAT}}),Object.defineProperty(t,"INVALID_VALUE",{enumerable:!0,get:function(){return s.INVALID_VALUE}}),Object.defineProperty(t,"RESERVED_NUMBER_FORMAT_NUM",{enumerable:!0,get:function(){return s.RESERVED_NUMBER_FORMAT_NUM}}),Object.defineProperty(t,"NUMBER_FORMAT_NAME",{enumerable:!0,get:function(){return s.NUMBER_FORMAT_NAME}});var c=r("36c2825c3b");Object.defineProperty(t,"LowerChineseNumberString",{enumerable:!0,get:function(){return c.LowerChineseNumberString}}),Object.defineProperty(t,"UpperChineseNumberString",{enumerable:!0,get:function(){return c.UpperChineseNumberString}}),Object.defineProperty(t,"NumberLanguageCaseType",{enumerable:!0,get:function(){return c.NumberLanguageCaseType}});var u=r("aaab5eaa3c");Object.defineProperty(t,"TokenType",{enumerable:!0,get:function(){return u.TokenType}})},f293d5439a:function(e,t,r){"use strict";r.d(t,"l",(function(){return c})),r.d(t,"g",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"a",(function(){return d})),r.d(t,"h",(function(){return f})),r.d(t,"b",(function(){return h})),r.d(t,"f",(function(){return m.c})),r.d(t,"m",(function(){return m.f})),r.d(t,"j",(function(){return m.d})),r.d(t,"c",(function(){return m.a})),r.d(t,"e",(function(){return m.b})),r.d(t,"k",(function(){return m.e})),r.d(t,"n",(function(){return m.g})),r.d(t,"i",(function(){return p}));var n,o,i,a=r("4f3b15d017"),s=r("ea5c19bfd3");function c(e){var t,r=function(e){var t,r=e.match(/(http?:\/\/|https:\/\/|\/\/)?([^\/\?#]+)/i);return null!==(t=null==r?void 0:r[2])&&void 0!==t?t:""}(e);if(!a.default.isWxWork||![s.a,s.b].includes(r))return e;var i=e.split("#"),c=null!==(t=i.shift())&&void 0!==t?t:"",u=i.join("#"),l=[n.NAME,n.VID,n.DEVICE_ID,o.NAME,o.VID,o.DEVICE_ID],d=c;return l.forEach((function(e){d=Object(m.f)(d,e)})),u?"".concat(d,"#").concat(u):"".concat(d)}function u(e){var t=Object(m.a)(e),r=Object(m.c)("u",t);if(!function(e){return/^http(s)?:\/\/docs\.qq\.com/.test(e)}(t)||""!==r)return t;var n,o=(n=window.global_multi_user,window.nowUserIndex||(null==n?void 0:n.nowUserIndex)||Object(m.c)("u")||"");if(!o)return t;var i=new URL(t),a=i.protocol,s=i.host,c=i.pathname,u=i.search,l=i.hash;return t=u?"".concat(a,"//").concat(s).concat(c).concat(u,"&u=").concat(o).concat(l):"".concat(a,"//").concat(s).concat(c,"?u=").concat(o).concat(l)}function l(e){return u(e)}function d(e,t){if(e==t)return 0;for(var r=e.split("."),n=t.split("."),o=0;r[o]&&n[o];){if(+r[o]!=+n[o])return+r[o]>+n[o]?i.HEIGHT:i.LOW;o+=1}return r[o]?i.HEIGHT:n[o]?i.LOW:i.EQUQL}function f(e){var t=navigator.userAgent.toLowerCase(),r=t.match(new RegExp("".concat(e,"\\/(\\d+\\.\\d+\\.\\d+)")))||t.match(new RegExp("".concat(e,"\\/(\\d+\\.\\d+)")));return r?r[1]:""}function h(e){return/^(mailto:(\/\/)?)?([a-z\u00a1-\uffff0-9_\-.])+@([a-z\u00a1-\uffff0-9_\-.])+\.([a-z]{2,})$/i.test(e)?e=e.replace(/^(mailto:(\/\/)?)?/i,"mailto:"):/^(https?|ftp|file):\/\//i.test(e)||(e=/^(doc.weixin.qq.com)/i.test(e)?"https://".concat(e):"http://".concat(e)),e}!function(e){e.NAME="wwapp_cst",e.VID="wwapp_vid",e.DEVICE_ID="wwapp_deviceid"}(n||(n={})),function(e){e.NAME="cst",e.VID="vid",e.DEVICE_ID="deviceid"}(o||(o={})),function(e){e[e.LOW=-1]="LOW",e[e.EQUQL=0]="EQUQL",e[e.HEIGHT=1]="HEIGHT"}(i||(i={}));var m=r("1dd43b336f"),p=function(){return!!window.PRIVATE}},f50ba37686:function(e,t,r){"use strict";function n(e,t){for(var r="";r.length<t;)r+=e;return r}function o(e,t){var r=""+Math.round(e);return(r=f(r)).length>=t?r:n("0",t-r.length)+r}function i(e,t){var r=""+e;return(r=f(r)).length>=t?r:n("0",t-r.length)+r}Object.defineProperty(t,"__esModule",{value:!0}),t.invertObject=t.extToExponential=t.getRealNumValueStr=t.choose_fmt=t.splitFormat=t.fmtIsDate=t.isGeneral=t._strrev=t.pad0r=t.pad0r2=t.pad0r1=t.rpad_=t.pad_=t.pad0=t.isNumeric=t.fill=void 0,t.fill=n,t.isNumeric=function(e){var t=typeof e;return("string"!==t||0!==e.toLowerCase().indexOf("0x"))&&("number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date))},t.pad0=function(e,t){var r=""+e;return r.length>=t?r:n("0",t-r.length)+r},t.pad_=function(e,t){var r=""+e;return r.length>=t?r:n(" ",t-r.length)+r},t.rpad_=function(e,t){var r=""+e;return(r=f(r)).length>=t?r:r+n(" ",t-r.length)},t.pad0r1=o,t.pad0r2=i;var a=Math.pow(2,32);function s(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}function c(e){var t,r,n=[],o=!1;for(t=0,r=0;t<e.length;t+=1)switch(e.charCodeAt(t)){case 34:o=!o;break;case 95:case 92:case 42:o||(t+=1);break;case 59:o||(n[n.length]=e.substr(r,t-r),r=t+1)}if(n[n.length]=e.substr(r),!0===o)throw new Error("Format |"+e+"| unterminated string ");return n}t.pad0r=function(e,t){return e>a||e<-a?o(e,t):i(Math.round(e),t)},t._strrev=function(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r),r-=1;return t},t.isGeneral=s,t.fmtIsDate=function(e){for(var t,r=0;r<e.length;)switch(t=e.charAt(r)){case"G":s(e,r)&&(r+=6),r+=1;break;case'"':for(var n=!1;r+1<e.length;)if(r+=1,34===e.charCodeAt(r)){n=!0;break}if(!n)return!1;r+=1;break;case"\\":case"_":r+=2;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;r+=1;break;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":var o=e.substr(r,3);if("A/P"===o.toUpperCase())return!0;if("AAA"===o.toUpperCase())return!0;if("AAAA"===(o=e.substr(r,4)).toUpperCase())return!0;if("AM/PM"===(o=e.substr(r,5)).toUpperCase())return!0;r+=1;break;case"上":if("上午/下午"===e.substr(r,5).toUpperCase())return!0;r+=1;break;case"[":for(var i=t;"]"!==e.charAt(r)&&!((r+=1)>=e.length);)i+=e.charAt(r);if(i.match(/\[[HhMmSs]*\]/))return!0;break;case".":case"0":case"#":for(;r<e.length&&(r+=1,t=e.charAt(r),"0#?.,E+-%".indexOf(t)>-1||"\\"===t&&"-"==e.charAt(r+1)&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(r+=1;e.charAt(r)===t;)r+=1;break;case"*":r+=1," "!=e.charAt(r)&&"*"!=e.charAt(r)||(r+=1);break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&(r+=1,t=e.charAt(r),-1!=="0123456789".indexOf(t)););break;default:r+=1}return!1},t.splitFormat=c;var u=/\[[=<>]/,l=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function d(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function f(e){"string"!=typeof e&&(e=e.toString());var t=e.match(/((-?\d+\.\d+)|(-?\d+))[eE]([+-]?\d+)/);if(!t)return e;var r=t[1],o=t[4],i=e;if(void 0===o)return i;if(t){var a=e.indexOf("."),s=parseFloat(o);if(s>=0)if(-1!==a){i=e.substr(0,a);for(var c=a,u=0;u<s;u+=1)(c=a+u+1)<r.length?i+=r.charAt(c):i+="0";c<r.length-1&&(i+=".",i+=r.substr(c+1))}else{var l=e.toLowerCase().indexOf("e");i=e.substr(0,l),i+=n("0",Math.abs(s))}else{var d=(i=r.replace(".","")).startsWith("-")?"-":"";d&&(i=i.replace(d,"")),i=d+"0."+n("0",Math.abs(s)-1)+i}}return i}t.choose_fmt=function(e,t){var r=["General"];try{r=c(e)}catch(e){r=["General"]}var n=r.length,o=r[n-1].indexOf("@");switch(n<4&&o>-1&&--n,r.length){case 1:r=o>-1?[r[0],r[0],r[0],r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var i=t>0?r[0]:t<0?r[1]:r[2];if(isNaN(t))return{length:n,fmt:i=r[3]};if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return{length:n,fmt:i};if(null!=r[0].match(u)||null!=r[1].match(u)){var a=r[0].match(l),s=r[1].match(l);return d(t,a)?{length:n,fmt:r[0]}:d(t,s)?{length:n,fmt:r[1]}:{length:n,fmt:r[null!=a&&null!=s?2:1]}}return{length:n,fmt:i}},t.getRealNumValueStr=f,t.extToExponential=function(e,t){if("number"!=typeof e)return String(e);if("Infinity"===(e=e.toString())||"-Infinity"===e)return e;(e.includes("e")||e.includes("E"))&&(e=f(e)),void 0===t&&(t=e.replace(/[^\d]/g,"").length-1),e.includes(".")||(e+=".0");var r="-"===e[0],n=(e=e.replace(/^-?([0-9.]+)$/,"$1")).indexOf(".")-e.replace(/[.]/g,"").replace(/^(0*)([^0])([0-9]*)$/,"$1$2.$3").indexOf("."),o=0===n?"e+0":"e"+(n>0?"+"+n:""+n);if(e=e.replace(/[.]/g,"").replace(/^(0*)([^0])([0-9]*)$/,"$2.$30"),/^0+$/.test(e))return"0."+new Array(t).fill("0").join("")+"e+0";var i=e.match(/^([1-9])\.([0-9]+)$/),a=(null==i?void 0:i[1])||"",s=(null==i?void 0:i[2])||"";if(s.length>t){var c=s.slice(t,t+1);s=s.slice(0,t),parseInt(c)>4&&(s=s.slice(0,t-1)+(parseInt(s.slice(-1))+1).toString())}else s+=new Array(t-s.length).fill("0").join("");return(r?"-":"")+a+(s=""===s?"":"."+s)+o},t.invertObject=function(e){return Object.keys(e).reduce((function(t,r){return t[e[r]]=r,t}),{})}},fbdde940b1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertNumToChinese=void 0;var n=r("f281127eb3");function o(e,t,r,n){return 0!==e||("1"!==t||1!==r||!!(null==n?void 0:n.showTenOne))}function i(e,t,r){return 0===t&&(!(e>=4)&&!(!r||!r.unit))}t.convertNumToChinese=function(e,t,r){if(""===e)return"";var a=function(e){return e===n.NumberLanguageCaseType.ChineseLowerCase?n.LowerChineseNumberString:e===n.NumberLanguageCaseType.ChineseUpperCase?n.UpperChineseNumberString:null}(t);if(!a)return e;var s,c=a.cnNums,u="",l="",d="",f=parseFloat(e);if(f>=1e15)return e;var h=f.toString();return d+=function(e,t,r){if(!(null==r?void 0:r.fill))return"";var n="",o=e.match(/^[+-]?(0*)[\d]+/);if(!o)return"";var i=o[1].length;return n.padStart?n+=n.padStart(i,t):n+=new Array(i).fill(t).join(""),n}(e,c[0],r),0===f?d+=c[0]:(f<0&&(d+="-",h=h.substr(1)),-1===h.indexOf(".")?u=h:(u=(s=h.split("."))[0],l=s[1]),d+=function(e,t,r){var n="",a=t.cnNums,s=t.cnIntRadice,c=t.cnIntUnits;if(0===parseInt(e,10))return n+a[0];for(var u=0,l=e.length,d=0;d<l;d++){var f=e.substr(d,1),h=l-d-1,m=h/4,p=h%4;"0"===f?r&&!r.unit?n+=a[parseInt(f,10)]:u+=1:(u>0&&(n+=a[0],u=0),o(d,f,p,r)&&(n+=a[parseInt(f,10)]),(null==r?void 0:r.unit)&&(n+=s[p])),i(u,p,r)&&(n+=c[m])}return n}(u,a,r),""===(d+=function(e,t){var r="",n=e;if(e&&""!==e&&0!==Number(e)){var o=e.length;o>0&&(r+=".");for(var i=0;i<o;i++){var a=n.substr(i,1);r+=t[Number(a)]}}return r}(l,c))?c[0]:d)}}}]);
//# sourceMappingURL=slide-common~e21604ee-064243.js.map
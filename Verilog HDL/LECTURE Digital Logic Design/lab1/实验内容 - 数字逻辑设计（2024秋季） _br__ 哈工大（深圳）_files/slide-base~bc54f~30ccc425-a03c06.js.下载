(this.webpackJsonp=this.webpackJsonp||[]).push([["base~bc54f~30ccc425"],{"016175442c":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.Multi="multiply",e.Fixed="fixed"}(n||(n={}))},"0526e2ef61":function(e,t,i){"use strict";i.d(t,"a",(function(){return Ve})),i.d(t,"b",(function(){return Qe}));i("73b854064b");var n=i("176815363d"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("547611bd96"),d=i.n(c),u=i("bd29e2df90"),h=i.n(u),v=i("ab5eb40518"),f=i.n(v),p=i("1b4cdd6a36"),g=i.n(p),y=i("85d0a7609b"),m=i.n(y),b=i("3ef2352f0b"),S=i.n(b),M=(i("c6244f7705"),i("081c8cafea"),i("69084d01d3")),E=i.n(M),C=i("3c6a87698d"),k=i.n(C),w=i("6d623d55ad"),I=i.n(w),x=i("82f2dc9440"),O=i.n(x),A=(i("eb5df5b33c"),i("6e20b6a7d8"),i("3bf1976a4f"),i("52d461bc51")),L=i.n(A),R=i("11246a1392"),D=i.n(R),T=i("1748118723"),P=i.n(T),B=(i("1bab7b5fb7"),i("34cd92f77a"),i("433247001a"),i("bd80bf2d0f"),i("963f2eaace"),i("b1e2246d82"),i("9d7978d445"),i("7a3400cab1"),i("e792a3169a")),G=i.n(B),j=i("ee138eb8dc"),N=i.n(j),F={insert:"head",singleton:!1},z=(G()(N.a,F),N.a.locals||{}),H=i("5fac0349d3");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var W=function(e){h()(i,e);var t=U(i);function i(e){var n;return a()(this,i),(n=t.call(this,e)).state={unfolding:!1,mainHover:!1,subHover:!1,subHoverIndex:-1},n}return s()(i,[{key:"render",value:function(){var e=this.props.item,t=e.v,i=this.formatTime(e.t,"yyyy/MM/dd hh:mm:ss"),n=e.a,r=this.showUnfold(),o=this.props.selected&&void 0===this.props.selectedSub,a=!!e.r,l=this.getRevertInfo(),s=this.showAuthorList(),c=this.showAuthorCount(s,n),d=this.showSubItems(a),u=this.props.maxVersion===t;return E.a.createElement("div",{className:z["history-item-wrapper"],onMouseOver:this.handleMouseOver.bind(this),onMouseLeave:this.handleMouseLeave.bind(this)},E.a.createElement("div",{className:P()(z["main-content"],o?z.selected:null),onClick:this.onItemClick.bind(this)},this.renderUnfold(r),this.renderRevertIcon(o,u),E.a.createElement("div",{className:z.version},"".concat(H.a.t("第{0}版",{0:t})).concat(u?H.a.t("(当前)"):"")),E.a.createElement("div",{className:z.time},i),s?this.renderAuthorList(n):null,a?E.a.createElement("div",{className:z["revert-info"]},l):null,c?E.a.createElement("div",{className:z["author-count"]},H.a.t("等{0}人修改了文档",{0:n.length})):null),d?this.renderSubItem(e):null)}},{key:"onFoldButtonClick",value:function(e){this.setState({unfolding:!this.state.unfolding}),e.stopPropagation()}},{key:"onRevertButtonClick",value:function(e){this.props.onItemRevertClick(),e.stopPropagation()}},{key:"onSubRevertButtonClick",value:function(e,t){this.props.onItemRevertClick(e),t.stopPropagation()}},{key:"onItemClick",value:function(){this.props.onItemClick()}},{key:"onSubItemClick",value:function(e){this.props.onItemClick(e)}},{key:"handleMouseOver",value:function(){this.setState({mainHover:!0})}},{key:"handleMouseLeave",value:function(){this.setState({mainHover:!1})}},{key:"handleSubMouseOver",value:function(e){this.setState({subHover:!0,subHoverIndex:e})}},{key:"handleSubMouseLeave",value:function(){this.setState({subHover:!1,subHoverIndex:-1})}},{key:"formatTime",value:function(e,t){var i=new Date;i.setTime(e);var n={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,"".concat(i.getFullYear()).substr(4-RegExp.$1.length))),n)new RegExp("(".concat(r,")")).test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[r]:"00".concat(n[r]).substr("".concat(n[r]).length)));return t}},{key:"renderAuthorList",value:function(e){var t,i=this,n=null;return n=e.length>4?e.slice(0,5):e,E.a.createElement("ul",{className:z["author-list"]},null===(t=n)||void 0===t?void 0:t.map((function(e){var t=i.props.getAuthor(e),n=t?t.name:"";return E.a.createElement("li",{className:z.author,key:e},E.a.createElement("div",{className:z["author-dot"],style:{backgroundColor:i.props.getColor(e)}}),E.a.createElement("div",{className:z["author-text"]},n))})))}},{key:"renderSubItem",value:function(e){var t=this,i=e.v,n=this.props.maxVersion===i,r=e.l,o=this.props.selectedSub;return E.a.createElement("ul",{className:z["sub-item-list"]},r.map((function(e,i){var r=t.formatTime(e.t,"hh:mm:ss"),a=t.props.getAuthor(e.a),l=a?a.name:"",s=!(n&&0===i);return E.a.createElement("li",{className:P()(z["sub-item"],o===i?z.selected:null),key:e.i,onClick:t.onSubItemClick.bind(t,i),onMouseOver:t.handleSubMouseOver.bind(t,i),onMouseLeave:t.handleSubMouseLeave.bind(t,i)},o!==i&&t.state.subHoverIndex!==i||!s?null:E.a.createElement("div",{className:z.revert,onClick:t.onSubRevertButtonClick.bind(t,i)},E.a.createElement("div",{className:z["revert-icon"]}),E.a.createElement("div",{className:z["revert-text"]},H.a.t("还原"))),E.a.createElement("div",{className:z["sub-item-time"]},r),E.a.createElement("div",{className:z["sub-item-author"]},E.a.createElement("div",{className:z["sub-item-author-dot"],style:{backgroundColor:t.props.getColor(e.a)}}),E.a.createElement("div",{className:z["sub-item-author-text"]},l)))})))}},{key:"getRevertInfo",value:function(){var e=this.props.item;if(!!e.r){var t=0,i=0;if("string"==typeof e.r){var n=e.r.split("_");t=parseInt(n[0],10),n[1]&&(i=parseInt(n[1],10))}else t=e.r;return 0===i?H.a.t("恢复了{0}时的内容",{0:this.formatTime(t,"yyyy-MM-dd hh:mm:ss")}):H.a.t("恢复了第{0}版的内容",{0:i})}}},{key:"showAuthorList",value:function(){return!this.state.unfolding}},{key:"showAuthorCount",value:function(e,t){return e&&t.length>1}},{key:"showSubItems",value:function(e){return!e&&this.state.unfolding}},{key:"showUnfold",value:function(){var e=this.props.item;return e.l&&e.l.length>1}},{key:"renderUnfold",value:function(e){return e?E.a.createElement("div",{className:z["fold-wrapper"]},E.a.createElement(I.a,{title:this.state.unfolding?H.a.t("收起详细记录"):H.a.t("展开详细记录"),placement:"bottom"},E.a.createElement("div",{className:P()(z["fold-button"],z[this.state.unfolding?"unfolding":"folding"]),onClick:this.onFoldButtonClick.bind(this)}))):null}},{key:"renderRevertIcon",value:function(e,t){return(e||this.state.mainHover&&!this.state.subHover)&&!t?E.a.createElement("div",{className:z.revert,onClick:this.onRevertButtonClick.bind(this)},E.a.createElement("div",{className:z["revert-icon"]}),E.a.createElement("div",{className:z["revert-text"]},H.a.t("还原"))):null}}]),i}(M.Component),_=i("a6311675d9"),Y=i.n(_),V={insert:"head",singleton:!1},K=(G()(Y.a,V),Y.a.locals||{});function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var Q,Z,q=function(e){h()(i,e);var t=X(i);function i(e){var n;return a()(this,i),n=t.call(this,e),m()(d()(n),"isFirstRequired",!1),m()(d()(n),"totalPages",0),m()(d()(n),"fetchedPages",0),m()(d()(n),"maxVersion",0),m()(d()(n),"isFetching",!1),m()(d()(n),"prevScrollTop",0),m()(d()(n),"revertRev",-1),m()(d()(n),"revertVersion",-1),m()(d()(n),"modal",void 0),m()(d()(n),"showRevertModal",(function(){n.modal=L.a.confirm({title:H.a.t("提示"),content:E.a.createElement("span",null,H.a.t("确认将文档还原到该版本吗？")),okText:H.a.t("确定"),cancelText:H.a.t("取消"),onOk:n.confirmRevert,onCancel:n.hideRevertModal})})),m()(d()(n),"hideRevertModal",(function(){var e;n.revertRev=-1,n.revertVersion=-1,null===(e=n.modal)||void 0===e||e.close()})),m()(d()(n),"confirmRevert",(function(){var e,t;null===(e=(t=n.props).revert)||void 0===e||e.call(t,n.revertRev,n.revertVersion,(function(){}),(function(){setTimeout(n.showRevertFailModal,20)})),n.hideRevertModal()})),m()(d()(n),"showRevertFailModal",(function(){n.modal=L.a.confirm({title:H.a.t("提示"),content:E.a.createElement("span",null,H.a.t("恢复失败，请稍后重试。")),footer:E.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:24}},E.a.createElement(D.a,{type:"primary",style:{marginRight:16},onClick:n.gotoFeedback},H.a.t("我要反馈")),E.a.createElement(D.a,{type:"primary",onClick:n.hideRevertFailModal},H.a.t("确定")))})})),m()(d()(n),"hideRevertFailModal",(function(){var e;null===(e=n.modal)||void 0===e||e.close()})),m()(d()(n),"gotoFeedback",(function(){var e;n.props.showAccusationSupportPage(!0),null===(e=n.modal)||void 0===e||e.close()})),n.state={historyItems:[],selectingItem:{main:void 0,sub:void 0}},n}return s()(i,[{key:"componentDidMount",value:function(){this.fetchNextPage()}},{key:"fetchNextPage",value:function(){var e,t,i=this;this.hasMore()&&!this.isFetching&&(this.isFetching=!0,null===(e=(t=this.props).getHistory)||void 0===e||e.call(t,this.fetchedPages+1,(function(e){i.isFetching=!1,i.handleFetchedResult(e)}),(function(){i.isFetching=!1})))}},{key:"render",value:function(){var e=this,t=this.state.selectingItem.main,i=this.state.selectingItem.sub,n=this.props.showTab;return E.a.createElement("div",{className:P()(K["history-list"],m()({},K["history-list-tab-show"],n)),onScroll:this.onScroll.bind(this)},this.state.historyItems.map((function(n,r){return E.a.createElement(W,{item:n,key:n.v,maxVersion:e.maxVersion,selected:t===r,selectedSub:t===r?i:void 0,getAuthor:e.getAuthor.bind(e),onItemClick:e.onItemClick.bind(e,r),onItemRevertClick:e.onItemRevertClick.bind(e,r),getColor:e.props.getColor})})))}},{key:"hasMore",value:function(){return 0===this.totalPages||this.fetchedPages<this.totalPages}},{key:"handleFetchedResult",value:function(e){var t=e.history.items,i=e.history.pages,n=e.history.page,r=this.state.historyItems.concat(t);this.totalPages=i,this.fetchedPages=n,this.setState({historyItems:r}),this.isFirstRequired||(this.maxVersion=r.length>0?r[0].v:0,this.isFirstRequired=!0,this.onItemClick(0))}},{key:"onItemClick",value:function(e,t){var i,n,r=this;if(!this.isFetching){this.isFetching=!0;var o=0,a=0;if(void 0===t)o=this.state.historyItems[e].i,a=this.getFRev(e),this.setState({selectingItem:{main:e,sub:void 0}});else o=this.state.historyItems[e].l[t].i,a=this.getFRev(e,t),this.setState({selectingItem:{main:e,sub:t}});null===(i=(n=this.props).getHistorySlide)||void 0===i||i.call(n,o,a,(function(){r.isFetching=!1}),(function(){r.isFetching=!1,O.a.show({message:H.a.t("拉取失败"),duration:2e3})}))}}},{key:"onItemRevertClick",value:function(e,t){var i=this.state.historyItems[e];if(i){var n=0,r=0;if(void 0===t)n=i.i,r=i.v;else{var o=i.l[t];if(!o)return;n=o.i,r=i.v}this.revertRev=n,this.revertVersion=r,this.showRevertModal()}}},{key:"getAuthor",value:function(e){return this.props.getAuthor?this.props.getAuthor(e):""}},{key:"onScroll",value:function(e){var t=e.target,i=t.scrollTop;t.scrollHeight-(i+t.offsetHeight)<112&&i>this.prevScrollTop&&this.fetchNextPage(),this.prevScrollTop=i}},{key:"getFRev",value:function(e,t){var i=-1;if(this.state.historyItems[e].r)i=-1;else if(void 0===t){var n=this.state.historyItems[e+1];n&&(i=n.i)}else{var r=this.state.historyItems[e].l[t+1];if(r)i=r.i;else{var o=this.state.historyItems[e+1];o&&(i=o.i)}}return i}}]),i}(M.Component),J=(i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36"),i("427911adf8")),$=i.n(J),ee={insert:"head",singleton:!1},te=(G()($.a,ee),$.a.locals||{}),ie=(i("b8217400dc"),i("e6f68cdf2e"),i("19be379080")),ne=i.n(ie),re={insert:"head",singleton:!1},oe=(G()(ne.a,re),ne.a.locals||{}),ae=i("b390895db3"),le=i("8b13fcae36");!function(e){e[e.MAKE_A_COPY=1]="MAKE_A_COPY",e[e.EXPORT_TO_LOCAL=2]="EXPORT_TO_LOCAL",e[e.LIFE_GROWTH_CHART=3]="LIFE_GROWTH_CHART",e[e.SAVE_AS_MY_TEMPLATE=4]="SAVE_AS_MY_TEMPLATE",e[e.PRINT_A_DOCUMENT=5]="PRINT_A_DOCUMENT",e[e.COPY_FULL_TEXT=6]="COPY_FULL_TEXT",e[e.IMPORT_DOCUMENTS=7]="IMPORT_DOCUMENTS",e[e.NEW_DOCUMENT=8]="NEW_DOCUMENT",e[e.IMPORT_THROUGH_DRIVE=9]="IMPORT_THROUGH_DRIVE",e[e.REPLICA_CREATION=10]="REPLICA_CREATION",e[e.TEMPLATE_CREATION=11]="TEMPLATE_CREATION",e[e.EXPORT_TO_DRIVE=12]="EXPORT_TO_DRIVE"}(Q||(Q={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.PPT=1]="PPT",e[e.WORD=2]="WORD",e[e.EXCEL=3]="EXCEL",e[e.TXT=4]="TXT",e[e.PDF=5]="PDF"}(Z||(Z={}));var se=i("aba9dcef64"),ce=i("915616c11c");function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var ue=Q.MAKE_A_COPY,he=Q.EXPORT_TO_LOCAL,ve=Q.LIFE_GROWTH_CHART,fe=Q.SAVE_AS_MY_TEMPLATE,pe=Q.PRINT_A_DOCUMENT,ge=Q.COPY_FULL_TEXT,ye=Q.IMPORT_DOCUMENTS,me=Q.NEW_DOCUMENT,be=Q.IMPORT_THROUGH_DRIVE,Se=Q.REPLICA_CREATION,Me=Q.TEMPLATE_CREATION,Ee=Q.EXPORT_TO_DRIVE,Ce=Z.UNKNOWN,ke=Z.PPT,we=Z.WORD,Ie=Z.EXCEL,xe=Z.TXT,Oe=Z.PDF,Ae=function(e){h()(i,e);var t=de(i);function i(e){var n,r;return a()(this,i),r=t.call(this,e),m()(d()(r),"recordTypes",void 0),m()(d()(r),"fileTypeMap",void 0),r.state={hover:!1},r.recordTypes=[ue,he,he,fe,pe,ge,ye,me,be,Se,Me,Ee],r.fileTypeMap=(n={},m()(n,Ce,""),m()(n,ke,H.a.t("PPT文稿")),m()(n,we,H.a.t("Word文档")),m()(n,Ie,H.a.t("Excel工作表")),m()(n,xe,H.a.t("TXT文件")),m()(n,Oe,H.a.t("PDF文件")),n),r}return s()(i,[{key:"render",value:function(){var e,t=this.props.item,i=t.time,n=t.fileType,r=t.recordType,o=this.props.getColor(t.creator),a=null===(e=se.a.CollaborationManager())||void 0===e?void 0:e.getRevision().getRevisionNumber();return this.recordTypes.includes(r)?E.a.createElement("div",{className:P()(oe["version-item-wrapper"],this.props.selected?oe.selected:null),onClick:this.onItemClick.bind(this),onMouseOver:this.handleMouseOver.bind(this),onMouseLeave:this.handleMouseLeave.bind(this)},E.a.createElement("div",{className:oe["version-item-time"]},Object(ae.a)(new Date(i))),(this.props.selected||this.state.hover)&&a!==t.rev?E.a.createElement("div",{className:oe.revert,onClick:this.onRevertButtonClick.bind(this)},E.a.createElement("div",{className:oe["revert-icon"]}),E.a.createElement("div",{className:oe["revert-text"]},H.a.t("还原"))):null,E.a.createElement("div",{className:oe["version-item-content"]},E.a.createElement("div",{className:oe["version-item-dot"],style:{backgroundColor:o}}),E.a.createElement("div",{className:oe["version-item-context"]},this.getCreator()," ",this.getContext(r,n)))):E.a.createElement("div",null)}},{key:"getFileType",value:function(e){return this.fileTypeMap[e]||H.a.t("文档")}},{key:"getContext",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(t={},m()(t,ue,[H.a.t("生成一份"),this.createALabel(H.a.t("副本"))]),m()(t,he,[H.a.t("导出一份"),this.getFileType(i),H.a.t("到本地")]),m()(t,ve,[H.a.t("生成一张图片")]),m()(t,fe,[H.a.t("将此文档保存为模板")]),m()(t,pe,[H.a.t("打印此文档")]),m()(t,ye,[H.a.t("通过导入一份"),this.getFileType(i),H.a.t("创建此文档")]),m()(t,me,[H.a.t("创建此文档")]),m()(t,be,[H.a.t("通过导入一份"),this.createALabel(this.getFileType(i)),H.a.t("创建此文档")]),m()(t,Se,[H.a.t("创建此文档")]),m()(t,Me,[H.a.t("通过"),this.createALabel(H.a.t("模板")),H.a.t("创建此文档")]),m()(t,Ee,[H.a.t("导出一份"),this.createALabel(this.getFileType(i))]),t)[e]}},{key:"getCreator",value:function(){var e=this.props.creator;return e&&e.length>7?"".concat(e.substr(0,7),"..."):e}},{key:"createALabel",value:function(e){var t=this;return E.a.createElement("span",{key:e,className:oe["version-item-link"],onClick:function(){Object(ce.a)({url:Object(le.getMultUrl)("".concat(t.props.item.url))})}},e)}},{key:"handleMouseOver",value:function(){this.setState({hover:!0})}},{key:"handleMouseLeave",value:function(){this.setState({hover:!1})}},{key:"onItemClick",value:function(){var e,t;null===(e=(t=this.props).onItemClick)||void 0===e||e.call(t)}},{key:"onRevertButtonClick",value:function(e){var t,i;null===(t=(i=this.props).onItemRevertClick)||void 0===t||t.call(i),e.stopPropagation()}}]),i}(M.Component),Le=i("8f58e78419"),Re=i.n(Le),De=i("020899bf26");function Te(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Pe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(i),!0).forEach((function(t){m()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Te(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var Ge=function(e){h()(i,e);var t=Be(i);function i(e){var n;return a()(this,i),n=t.call(this,e),m()(d()(n),"totalPages",0),m()(d()(n),"fetchedPages",0),m()(d()(n),"isFetching",!1),m()(d()(n),"prevScrollTop",0),m()(d()(n),"creators",{}),m()(d()(n),"revertRev",-1),m()(d()(n),"revertVersion",-1),m()(d()(n),"modal",void 0),m()(d()(n),"showRevertModal",(function(){n.modal=L.a.confirm({title:H.a.t("提示"),content:E.a.createElement("span",null,H.a.t("确认将文档还原到该版本吗？")),okText:H.a.t("确定"),cancelText:H.a.t("取消"),onOk:n.confirmRevert,onCancel:n.hideRevertModal})})),m()(d()(n),"confirmRevert",(function(){n.props.revert(n.revertRev,n.revertVersion,(function(){}),(function(){setTimeout(n.showRevertFailModal,20)})),n.hideRevertModal()})),m()(d()(n),"hideRevertModal",(function(){var e;n.revertRev=-1,n.revertVersion=-1,null===(e=n.modal)||void 0===e||e.close()})),m()(d()(n),"showRevertFailModal",(function(){n.modal=L.a.confirm({title:H.a.t("提示"),content:E.a.createElement("span",null,H.a.t("恢复失败，请稍后重试。")),footer:E.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:24}},E.a.createElement(D.a,{type:"primary",style:{marginRight:16},onClick:n.gotoFeedback},H.a.t("我要反馈")),E.a.createElement(D.a,{type:"primary",onClick:n.hideRevertFailModal},H.a.t("确定")))})})),m()(d()(n),"hideRevertFailModal",(function(){var e;null===(e=n.modal)||void 0===e||e.close()})),m()(d()(n),"gotoFeedback",(function(){var e;n.props.showAccusationSupportPage(!0),null===(e=n.modal)||void 0===e||e.close()})),m()(d()(n),"getClass",(function(){var e=n.props.showTab;return P()(te["version-list"],m()({},te["version-list-tab-show"],e))})),n.state={versionItems:[],selectingItem:void 0},n}return s()(i,[{key:"componentDidMount",value:function(){this.fetchNextPage()}},{key:"render",value:function(){var e=this;return E.a.createElement("div",{className:this.getClass(),onScroll:this.onScroll.bind(this)},this.fetchedPages>0&&0===this.state.versionItems.length?this.renderEmptyPage():this.state.versionItems.map((function(t,i){var n,r=(null===(n=De.a.DocInfoManager())||void 0===n?void 0:n.userId)===t.creator?H.a.t("我"):Re()(e.creators[t.creator],"name","");return E.a.createElement(Ae,{item:t,key:t.v,creator:r,selected:e.state.selectingItem===i,onItemClick:e.onItemClick.bind(e,i),onItemRevertClick:e.onItemRevertClick.bind(e,i),getColor:e.props.getColor})})))}},{key:"fetchNextPage",value:function(){var e,t,i=this;this.hasMore()&&!this.isFetching&&(this.isFetching=!0,null===(e=(t=this.props).getVersion)||void 0===e||e.call(t,this.fetchedPages+1,(function(e){i.isFetching=!1,i.handleFetchedResult(e)}),(function(){i.isFetching=!1})))}},{key:"hasMore",value:function(){return 0===this.totalPages||this.fetchedPages<this.totalPages}},{key:"handleFetchedResult",value:function(e){var t,i=null!==(t=e.data.records)&&void 0!==t?t:[],n=e.data.pages,r=e.data.page,o=e.data.creators,a=this.state.versionItems.concat(i);this.totalPages=n,this.fetchedPages=r,this.creators=Pe(Pe({},this.creators),o),this.setState({versionItems:a})}},{key:"onScroll",value:function(e){var t=e.target,i=t.scrollTop;t.scrollHeight-(i+t.offsetHeight)<112&&i>this.prevScrollTop&&this.fetchNextPage(),this.prevScrollTop=i}},{key:"renderEmptyPage",value:function(){return E.a.createElement("div",{className:te["version-list-empty"]},E.a.createElement("div",{className:te["version-list-empty-icon"]}),E.a.createElement("div",{className:te["version-list-empty-text"]},H.a.t("版本记录为空")))}},{key:"onItemClick",value:function(e){var t,i,n=this;if(!this.isFetching){this.setState({selectingItem:e}),this.isFetching=!0;var r;r=this.state.versionItems[e].rev.rev,null===(t=(i=this.props).getHistorySlide)||void 0===t||t.call(i,r,-1,(function(){n.isFetching=!1}),(function(){n.isFetching=!1,O.a.show({message:H.a.t("拉取失败"),duration:2e3})}))}}},{key:"onItemRevertClick",value:function(e){var t=this.state.versionItems[e];if(t){var i,n;i=t.rev,n=t.v,this.revertRev=i,this.revertVersion=n,this.showRevertModal()}}}]),i}(M.Component),je=i("6b3d7565ba"),Ne=i("40721f7970"),Fe=i.n(Ne),ze={insert:"head",singleton:!1},He=(G()(Fe.a,ze),Fe.a.locals||{}),Ue=i("e1565a9084"),We=i("780d9b3b59"),_e=i("84c7a07f3d");function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var Ve={HISTORY_TYPE:"history",VERSION_TYPE:"version",SNAPSHOT_TYPE:"snapshot"},Ke="version",Xe="edit-record",Qe=function(e){h()(i,e);var t=Ye(i);function i(e){var n;return a()(this,i),n=t.call(this,e),m()(d()(n),"containerElement",void 0),m()(d()(n),"handleTitleClick",Object(je.c)(n.enableSnapshotList.bind(d()(n)))),m()(d()(n),"revertSuccess",(function(){We.c.getInstance().show({message:H.a.t("还原成功"),commonTipsType:We.b.SUCCESS,onlyShowOne:!0}),setTimeout((function(){Object(le.tencentDocOpenUrlReload)()}),1e3)})),m()(d()(n),"showAccusationSupportPage",(function(e){n.props.accusationService.promise().then((function(t){t.showSupportPage(e)}))})),n.state={id:e.activeId||Ve.HISTORY_TYPE,isSnapshotListEnabled:!1},n}return s()(i,[{key:"componentDidMount",value:function(){var e=this;if(this.props.isSupportArkVersionManager){var t,i,n=this.props.activeId===Ve.VERSION_TYPE?Ke:Xe;if(this.props.type===_e.d.HISTORY_VERSION)return void(null===(t=(i=this.props.injectable).showRecordComponent)||void 0===t||t.call(i,{defaultTab:n,recordType:this.props.type,targetDom:this.containerElement,onClose:this.onClose.bind(this)}));Object(Ue.c)({defaultTab:n,targetDom:this.containerElement,onClose:this.onClose.bind(this),onEditRecordRevert:function(){e.revertSuccess()},onVersionRevert:function(){e.revertSuccess()},onEditRecordSelect:function(t){var i,n,r=t.rev,o=t.fRev;(t.isRevertedVersion||void 0===o)&&(o=-1),null===(i=(n=e.props).getHistorySlide)||void 0===i||i.call(n,r,o,(function(){}),(function(){O.a.show({message:H.a.t("拉取失败"),duration:2e3})}))},onVersionSelect:function(t){var i,n;null===(i=(n=e.props).getHistorySlide)||void 0===i||i.call(n,t.rev,-1,(function(){}),(function(){O.a.show({message:H.a.t("拉取失败"),duration:2e3})}))}})}}},{key:"render",value:function(){var e=this,t=this.props,i=t.activeId,n=t.showTab,o=i||Ve.HISTORY_TYPE,a=!1!==n;return E.a.createElement("div",{className:He["history-wrapper"],ref:function(t){e.containerElement=t}},!this.props.isSupportArkVersionManager&&E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{className:He.header},E.a.createElement("div",{className:He.title,onClick:this.handleTitleClick},H.a.t("修订记录")),E.a.createElement("div",{className:He["close-wrapper"]},E.a.createElement(I.a,{placement:"bottom",title:H.a.t("关闭")},E.a.createElement("div",{className:He.close,onClick:this.onClose.bind(this)})))),E.a.createElement("div",{className:He.border}),a?E.a.createElement(k.a,{className:He.tabs,tabBarStyle:{paddingTop:"20px",paddingLeft:"20px"},tabBarItemStyle:{color:"#000000",opacity:"0.64",padding:"0 4px 8px",marginRight:"24px",fontWeight:500},indicatorStyle:{display:"none"},activeItemStyle:{borderBottom:"2px solid #136AFF",color:"#136AFF",opacity:"1"},alignment:"left",onChange:this.setActiveId.bind(this),defaultActiveId:o},E.a.createElement(k.a.TabPane,{tab:H.a.t("历史"),id:"history"}),this.props.enableHistoryVersion?E.a.createElement(k.a.TabPane,{tab:H.a.t("版本"),id:"version"}):E.a.createElement("span",{"aria-hidden":!0}),this.state.isSnapshotListEnabled?E.a.createElement(k.a.TabPane,{tab:H.a.t("本地备份"),id:"snapshot"}):E.a.createElement("span",{"aria-hidden":!0})):null,E.a.createElement("div",{className:He["record-list"],style:{display:this.state.id===Ve.HISTORY_TYPE?"inline-block":"none"}},E.a.createElement(q,{showAccusationSupportPage:this.showAccusationSupportPage,getHistorySlide:this.props.getHistorySlide.bind(this),getColor:this.props.getColor.bind(this),revert:this.props.revert.bind(this),getHistory:this.props.getHistory.bind(this),getAuthor:this.props.getAuthor.bind(this),showTab:a})),a?E.a.createElement("div",{className:He["record-list"],style:{display:this.state.id===Ve.VERSION_TYPE?"inline-block":"none"}},E.a.createElement(Ge,{showAccusationSupportPage:this.showAccusationSupportPage,getHistorySlide:this.props.getHistorySlide.bind(this),getColor:this.props.getColor.bind(this),revert:this.props.revert.bind(this),getVersion:this.props.getVersion.bind(this),showTab:a})):null,E.a.createElement("div",{className:He["record-list"],style:{display:this.state.id===Ve.SNAPSHOT_TYPE?"inline-block":"none"}},E.a.createElement(je.a,{visible:this.state.isSnapshotListEnabled,exportSnapshotFile:function(){var t=r()(S.a.mark((function t(i){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.exportManager.promise().then((function(e){e.exportSnapshotFile(i)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}))))}},{key:"onClose",value:function(){var e,t;Object(Ue.a)(),null===(e=(t=this.props).onClose)||void 0===e||e.call(t)}},{key:"setActiveId",value:function(e){this.setState({id:e})}},{key:"enableSnapshotList",value:function(){this.setState((function(){return{isSnapshotListEnabled:!0}}))}}]),i}(M.Component)},"0604c32081":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),s=i.n(l),c=function(){function e(){r()(this,e),s()(this,"masterLayoutEditService",void 0)}return a()(e,[{key:"setMasterLayoutEditServiceDelegate",value:function(e){this.masterLayoutEditService||(this.masterLayoutEditService=e)}},{key:"getCurEditTypeStyle",value:function(){return{leftBar:this.getCurLeftBarStyle(),canvasWrapper:this.getCurCanvasWrapperStyle(),groupWrapper:this.getCurGroupWrapperStyle(),slideIndex:this.getCurSlideIndexStyle()}}},{key:"getCurLeftBarStyle",value:function(){var e;return null!==(e=this.masterLayoutEditService)&&void 0!==e&&e.isMasterEditType?{backgroundColor:"#454D5A",color:"#fff"}:{backgroundColor:"#fff",color:"#000",paddingTop:"4px"}}},{key:"getCurCanvasWrapperStyle",value:function(){var e;return null!==(e=this.masterLayoutEditService)&&void 0!==e&&e.isMasterEditType?{borderColor:"#454D5A",transformOrigin:"right",transformScale:"0.83"}:{borderColor:"#e7e8e9",transformOrigin:"center",transformScale:"1"}}},{key:"getCurSlideIndexStyle",value:function(){var e;return null!==(e=this.masterLayoutEditService)&&void 0!==e&&e.isMasterEditType?{opacity:.5,selectedOpacity:1}:{opacity:.32,selectedOpacity:.48}}},{key:"getCurGroupWrapperStyle",value:function(){var e;return null!==(e=this.masterLayoutEditService)&&void 0!==e&&e.isMasterEditType?{backgroundColor:"#454D5A",color:"#fff"}:{paddingTop:7,paddingBottom:0,backgroundColor:"transparent"}}}]),e}()},"074f1710a5":function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36"),i("963f2eaace"),i("b1e2246d82"),i("8aebbf296a"),i("f45588a8ad"),i("de37db1287");var n=i("7a5536c9bf"),r=i.n(n),o=i("85d0a7609b"),a=i.n(o),l=i("9132715560"),s=i.n(l),c=i("6a364eb35c"),d=i.n(c),u=i("bd29e2df90"),h=i.n(u),v=i("ab5eb40518"),f=i.n(v),p=i("1b4cdd6a36"),g=i.n(p),y=(i("6e20b6a7d8"),i("0acdc5834b"),i("fce3077cdf"),i("8e7cce0ada"),i("29f8c5f672"),i("c6244f7705"),i("85d48ef22b"),i("2a6f332b5e"),i("8ee19818c4"),i("a42b29265b")),m=i("9657b29818"),b=i("a7888a8b87"),S=i.n(b),M=i("963dec4e9c"),E=i("b0d97736f5"),C=i("f83ba7d4f8"),k=i("8c101803a8"),w=i("9da6335152"),I=i("d3d31c86eb"),x=i("020899bf26");function O(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(l)throw o}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function L(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function R(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?L(Object(i),!0).forEach((function(t){a()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var T=function(e){h()(i,e);var t=D(i);function i(e,n){return s()(this,i),t.call(this,e,n)}return d()(i,[{key:"paste",value:function(){var e,t,i,n;null===(e=this.textSelectivePasteState)||void 0===e||e.beforePaste(),null===(t=this.undoRedoService)||void 0===t||t.undo(),null===(n=(i={},a()(i,y.c.SHAPE,this.pasteShape),a()(i,y.c.SLIDE,this.pasteSlide),a()(i,y.c.TEXT,this.pasteText),i)[this.type])||void 0===n||n.call(this),this.report()}},{key:"pasteText",value:function(){var e,t=this,i=null===(e=this.textSelectionUndoRedo)||void 0===e?void 0:e.afterUndoRedo((function(){var e,n,r;null===(e=t.copyPasteManager)||void 0===e||null===(n=e.dangerousInstance)||void 0===n||n.runTextSelectivePaste(t.clipboardData.data[0].inheritedSdkData),null==i||i(),null===(r=t.textSelectivePasteState)||void 0===r||r.afterPaste()}))}},{key:"pasteShape",value:function(){var e,t,i,n=this,r=S()(this.clipboardData).data.map((function(e){var t,i=e.inheritedSdkData;return k.a.adjustElementPosition(i,null===(t=n.selectionService)||void 0===t?void 0:t.currentSlide,y.a.INHERIT),i})),o=null===(e=this.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t||null===(i=t.sdkData)||void 0===i?void 0:i.api;null==o||o.addShapes(r)}},{key:"pasteSlide",value:function(){var e,t,i=S()(this.clipboardData),n=i.globalPadId,r=null===(e=x.a.DocInfoManager())||void 0===e?void 0:e.globalPadId,o=null===(t=this.selectionService)||void 0===t?void 0:t.uiDataService.presentation.sdkData;n!==r?this.pasteSlideInDiffDoc(i,o):this.pasteSlideInSameDoc(i,o)}},{key:"pasteSlideInSameDoc",value:function(e,t){var i,n=e.data.map((function(e){return e[y.a.OWN]}));null!==(i=t.sectionList)&&void 0!==i&&i.length?t.api.addSlidesWithSection(n,this.insertGapIndex):t.api.addSlides(n,this.insertGapIndex)}},{key:"pasteSlideInDiffDoc",value:function(e,t){var i=this,n=t.api;Object(m.b)((function(){var r,o=i.getDeduplicateData(e,t),a=o.data,l=void 0===a?[]:a,s=o.themeList,c=void 0===s?[]:s,d=o.masterList,u=void 0===d?[]:d,h=o.layoutList,v=void 0===h?[]:h,f=o.noteList,p=void 0===f?[]:f,g=o.slideSize,y=i.addTheme(c,n),m=i.addMasters(u,n,y),b=i.addLayouts(v,n,m),S=i.addSlides({data:l,api:n,layoutIdsMapArr:b,hasSection:!(null===(r=t.sectionList)||void 0===r||!r.length),slideSize:g});i.addNotes(p,n,S)}))}},{key:"getDeduplicateData",value:function(e,t){var i=this.clipboardDataToSdkData(e),n=i.ownedData,r=i.inheritedData,o=new E.a,a=new M.a(o),l=a.directDeduplicate(n,t.getOwnedData()),s=a.directDeduplicate(r,t.getOwnedData(),{disableOrganizeData:!0});return R(R({},e),this.sdkDataToClipboardData({ownedData:l,inheritedData:s}))}},{key:"clipboardDataToSdkData",value:function(e){var t=function(t){var i,n,r,o,a,l;return{slideList:null!==(i=null===(n=e.data)||void 0===n?void 0:n.map((function(e){return e[t]})))&&void 0!==i?i:[],themeList:null!==(r=null===(o=e.themeList)||void 0===o?void 0:o.map((function(e){return e[t]})))&&void 0!==r?r:[],masterList:null!==(a=null===(l=e.masterList)||void 0===l?void 0:l.map((function(e){return e[t]})))&&void 0!==a?a:[],layoutMap:e.layoutList.reduce((function(e,i){return e[i[t].id]=i[t],e}),{})}};return{ownedData:t(y.a.OWN),inheritedData:t(y.a.INHERIT)}}},{key:"sdkDataToClipboardData",value:function(e){var t,i,n,r,o,l,s,c,d=null!==(t=e.ownedData.slideList)&&void 0!==t?t:[],u=null!==(i=e.inheritedData.slideList)&&void 0!==i?i:[],h=null!==(n=e.ownedData.themeList)&&void 0!==n?n:[],v=null!==(r=e.inheritedData.themeList)&&void 0!==r?r:[],f=null!==(o=e.ownedData.masterList)&&void 0!==o?o:[],p=null!==(l=e.inheritedData.masterList)&&void 0!==l?l:[],g=Object.values(null!==(s=e.ownedData.layoutMap)&&void 0!==s?s:{}),m=Object.values(null!==(c=e.inheritedData.layoutMap)&&void 0!==c?c:{});return{data:d.map((function(e,t){var i;return i={},a()(i,y.a.OWN,d[t]),a()(i,y.a.INHERIT,u[t]),i})),themeList:h.map((function(e,t){var i;return i={},a()(i,y.a.OWN,h[t]),a()(i,y.a.INHERIT,v[t]),i})),masterList:f.map((function(e,t){var i;return i={},a()(i,y.a.OWN,f[t]),a()(i,y.a.INHERIT,p[t]),i})),layoutList:g.map((function(e,t){var i;return i={},a()(i,y.a.OWN,g[t]),a()(i,y.a.INHERIT,m[t]),i}))}}},{key:"addTheme",value:function(e,t){var i=new Map;if(e.length){var n=e.map((function(e){return e.ownSdkData}));i=t.addTheme(n)}return i}},{key:"addMasters",value:function(e,t,i){var n=[];if(e.length){var r=e.map((function(e){var t=e.ownSdkData,n=R({},t),r=i.get(t.themeId);return r&&(n.themeId=r),n}));n=t.addMasters(r)}return n}},{key:"addLayouts",value:function(e,t,i){var n=[];return e.length&&e.forEach((function(e){var o,a,l=e.ownSdkData,s=R({},l),c=l.masterId,d=O(i);try{for(d.s();!(a=d.n()).done;){if(o=a.value.get(c))break}}catch(e){d.e(e)}finally{d.f()}o&&(s.masterId=o);var u=t.addLayouts([s]);n.push.apply(n,r()(u))})),n}},{key:"addSlides",value:function(e){var t=this,i=e.data,n=e.api,r=e.layoutIdsMapArr,o=e.hasSection,a=e.slideSize,l=i.map((function(e){var i,n,o=e.ownSdkData,l=o.layoutId,s=O(r);try{for(s.s();!(n=s.n()).done;){if(i=n.value.get(l))break}}catch(e){s.e(e)}finally{s.f()}return i&&(o.layoutId=i),t.slideSdkDataModify.adjustPageData(o,a,!0),o}));return o?n.addSlidesWithSection(l,this.insertGapIndex):n.addSlides(l,this.insertGapIndex)}},{key:"addNotes",value:function(e,t,i){e.forEach((function(e){var n,r,o=e.ownSdkData,a=R({},o),l=o.slideId,s=O(i);try{for(s.s();!(r=s.n()).done;){if(n=r.value.get(l))break}}catch(e){s.e(e)}finally{s.f()}n&&(a.slideId=n),t.addNoteSlide(a)}))}},{key:"report",value:function(){Object(I.c)({opername:w.e.DOC_PPT,module:w.d.PASTE_SPECIAL,action:w.b.SOURCE_FORMAT})}}]),i}(C.a)},"0906cb953c":function(e,t,i){"use strict";i.d(t,"a",(function(){return ae}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("c554310b5c"),i("bcb5d93d36");var n=i("7a5536c9bf"),r=i.n(n),o=i("176815363d"),a=i.n(o),l=i("14502724a6"),s=i.n(l),c=i("9132715560"),d=i.n(c),u=i("6a364eb35c"),h=i.n(u),v=i("547611bd96"),f=i.n(v),p=i("bd29e2df90"),g=i.n(p),y=i("ab5eb40518"),m=i.n(y),b=i("1b4cdd6a36"),S=i.n(b),M=i("85d0a7609b"),E=i.n(M),C=i("3ef2352f0b"),k=i.n(C),w=(i("3bf1976a4f"),i("75563bc376"),i("8ee19818c4"),i("22569efd03"),i("b8217400dc"),i("8a35b54c1d"),i("c6244f7705"),i("081c8cafea"),i("8aebbf296a"),i("85d48ef22b"),i("6e20b6a7d8"),i("b1e2246d82"),i("963f2eaace"),i("0acdc5834b"),i("a2a09da1e3"),i("9e6e95de85")),I=i("375d29afab"),x=i("e0e8dd9366"),O=i("1288bffff3");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=S()(e);if(t){var r=S()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return m()(this,i)}}var L=function(e){g()(i,e);var t=A(i);function i(){var e;d()(this,i);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),E()(f()(e),"isPressed",void 0),E()(f()(e),"slideModelList",void 0),E()(f()(e),"masterModelList",void 0),E()(f()(e),"layoutModelList",void 0),E()(f()(e),"currentSlideType",void 0),E()(f()(e),"slideClearanceIndex",void 0),E()(f()(e),"slideHeight",void 0),E()(f()(e),"slideWidth",void 0),E()(f()(e),"sectionWidth",void 0),E()(f()(e),"originalDragSlide",void 0),E()(f()(e),"slideInnerHeight",void 0),E()(f()(e),"currentDragIndex",void 0),E()(f()(e),"historyTipsSlide",void 0),E()(f()(e),"historyTipsTops",void 0),E()(f()(e),"historyTipsScrollTop",void 0),E()(f()(e),"lockInfo",void 0),E()(f()(e),"outside",void 0),E()(f()(e),"originalDragIndex",void 0),E()(f()(e),"shouldUpdate",void 0),E()(f()(e),"isFirstSlideShow",void 0),E()(f()(e),"isShowingHistory",void 0),E()(f()(e),"currentSlideIndex",void 0),E()(f()(e),"editType",void 0),E()(f()(e),"viewType",void 0),E()(f()(e),"isDraggingSection",void 0),E()(f()(e),"sectionList",void 0),E()(f()(e),"isSectionDrag",void 0),E()(f()(e),"sectionFoldedState",void 0),e}return h()(i,[{key:"initModel",value:function(e,t){var i=t||{},n=i.slideWidth,r=void 0===n?0:n,o=i.slideHeight,a=void 0===o?0:o,l=i.slideInnerHeight,s=void 0===l?0:l,c=i.slideModelList,d=void 0===c?[]:c,u=i.masterModelList,h=void 0===u?[]:u,v=i.layoutModelList,f=void 0===v?[]:v,p=i.sectionList,g=void 0===p?[]:p,y=i.currentSlideType,m=void 0===y?x.d.SLIDE:y,b=i.editType,S=void 0===b?O.a.SLIDE:b,M=i.isFirstSlideShow,E=void 0!==M&&M,C=i.isShowingHistory,k=void 0!==C&&C,w=i.currentSlideIndex,I=void 0===w?0:w,A=i.slideClearanceIndex,L=void 0===A?0:A;this.slideWidth=r,this.slideHeight=a,this.slideInnerHeight=s,this.sectionWidth=180,this.slideModelList=d,this.masterModelList=h,this.layoutModelList=f,this.sectionList=g,this.currentSlideType=m,this.editType=S,this.isFirstSlideShow=E,this.isShowingHistory=k,this.currentSlideIndex=I,this.slideClearanceIndex=L,this.isPressed=!1,this.historyTipsSlide=-1,this.historyTipsTops={},this.historyTipsScrollTop=0,this.lockInfo=[],this.outside=!1,this.originalDragIndex=-1,this.originalDragSlide=null,this.currentDragIndex=-1,this.shouldUpdate=!1,this.isDraggingSection=!1,this.isSectionDrag=!1,this.sectionFoldedState=[]}}]),i}(I.a),R=i("532c3381b5"),D=i("8da38f8962"),T=(i("e6f68cdf2e"),i("4aef4ce634")),P=i.n(T),B=i("9fbcf5162b");function G(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function j(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?G(Object(i),!0).forEach((function(t){E()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):G(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var N=function(){function e(t){var i=this;d()(this,e),E()(this,"dragDelegate",void 0),E()(this,"mouseDragTimeout",void 0),E()(this,"unfoldSectionTimeoutContext",void 0),E()(this,"listRect",void 0),E()(this,"mouseOffset",void 0),E()(this,"dragPos",void 0),E()(this,"oldScrollTop",void 0),E()(this,"savedDragInfo",void 0),E()(this,"handleMouseMove",P()((function(e){if(i.dragDelegate.draggable()&&0!==Object.keys(i.savedDragInfo).length)if(0!==e.buttons){if(i.listView){var t=e.pageX,n=e.pageY,r=i.getDragItemRect(t,n),o=r.topOfItem,a=r.leftOfItem,l=r.bottomOfItem,s=r.rightOfItem;i.dragPos[0]=a,i.dragPos[1]=o;var c,d=i.isOutside(s,a,o,l),u=i.dragDelegate.getSlideSectionListHeights();if(d)c={outside:!0,currentDragIndex:-1};else{var h,v,f=i.getDragIndex(o,u),p=i.getScrollAmount(o,l);if(c={currentDragIndex:f,outside:!1,scrollAmount:p},f!==(null===(h=i.unfoldSectionTimeoutContext)||void 0===h?void 0:h[0]))(null===(v=i.unfoldSectionTimeoutContext)||void 0===v?void 0:v[1])&&clearTimeout(i.unfoldSectionTimeoutContext[1]),i.unfoldSectionTimeoutContext=[f,setTimeout((function(){var e;if(i.unfoldSectionTimeoutContext&&0!==Object.keys(i.savedDragInfo).length){var t=i.dragDelegate.getSectionList(),n=B.a.calcSectionIndexFromClearanceIndex(f,null!=t?t:[]);i.dragDelegate.unfoldCorrespondingSection(f),i.unfoldSectionTimeoutContext=void 0,null!==(e=c)&&void 0!==e&&e.currentDragIndex&&t&&(c.currentDragIndex-=t[n].numSlides,i.dragDelegate.onDragging(c))}}),3e3)]}i.savedDragInfo.currentDragIndex=c.currentDragIndex,i.savedDragInfo.outside=c.outside,i.dragDelegate.onDragging(c)}}else i.handleMouseUp(e)}),16,{trailing:!1})),E()(this,"handleSectionTitleMouseMove",P()((function(e){if(i.dragDelegate.draggable()&&0!==Object.keys(i.savedDragInfo).length)if(0!==e.buttons){if(i.listView){var t=e.pageX,n=e.pageY,r=i.getDragItemRect(t,n),o=r.topOfItem,a=r.leftOfItem,l=r.bottomOfItem,s=r.rightOfItem;i.dragPos[0]=a,i.dragPos[1]=o;var c=i.isOutside(s,a,o,l),d=i.dragDelegate.getSectionListHeights(),u={isSectionDrag:!0,currentDragIndex:i.getSectionDragIndex(o,d),outside:c,scrollAmount:i.getScrollAmount(o,l)};i.savedDragInfo.currentDragIndex=u.currentDragIndex,i.savedDragInfo.outside=u.outside,i.dragDelegate.onDragging(u)}}else i.handleMouseUp(e)}),16,{trailing:!1})),E()(this,"handleMouseUp",(function(e){if(i.mouseDragTimeout)return clearTimeout(i.mouseDragTimeout),document.removeEventListener("mouseup",i.handleMouseUp),i.mouseDragTimeout=null,void(i.savedDragInfo={});i.unRegisterListener();var t=i.getDragItemRect(e.pageX,e.pageY).topOfItem,n=i.getDragIndex(t,i.dragDelegate.getSlideSectionListHeights()),r={originalDragItem:null,currentDragIndex:-1,originalDragIndex:i.savedDragInfo.originalDragIndex,outside:!1,finalIndex:n};i.dragDelegate.onDragEnd(r),i.clearDragData()})),E()(this,"handleSectionTitleMouseUp",(function(e){var t,n,r;if(i.mouseDragTimeout)return clearTimeout(i.mouseDragTimeout),document.removeEventListener("mouseup",i.handleSectionTitleMouseUp),i.savedDragInfo={},void(i.mouseDragTimeout=null);null===(t=(n=i.savedDragInfo).toggleDraggingSection)||void 0===t||t.call(n,!1),i.listView.scrollTop=i.savedDragInfo.scrollAmount;var o=i.getDragItemRect(e.pageX,e.pageY),a=o.topOfItem,l=o.leftOfItem,s=o.bottomOfItem,c=o.rightOfItem,d=i.getSectionDragIndex(a,i.dragDelegate.getSectionListHeights());i.unRegisterListener(!0);var u=i.isOutside(c,l,a,s),h={originalDragItem:null,currentDragIndex:-1,originalDragIndex:null!==(r=i.savedDragInfo.originalDragIndex)&&void 0!==r?r:-1,outside:u,finalIndex:d,isSectionDrag:!0,originalSectionIndex:i.savedDragInfo.originalSectionIndex};i.dragDelegate.onDragEnd(h)})),this.dragDelegate=t}return h()(e,[{key:"dragMouseDown",value:function(t,i,n,r){var o=this;if(!this.onPrepareMouseDown(t)){var a=t.pageX,l=t.pageY,s=t.currentTarget;document.addEventListener("mouseup",this.handleMouseUp),this.mouseDragTimeout=setTimeout((function(){o.mouseDragTimeout=null,o.initDragInfo(s,a,l);var e=o.getDraggingArray(i,n),t={originalDragItem:o.dataList[i],originalDragIndex:r,currentDragIndex:r,outside:!1,dragPos:o.dragPos,draggingArray:e};o.dragDelegate.onDragStart(t),o.savedDragInfo=j({},t),o.registerEventListeners()}),e.MouseDragTimeout)}}},{key:"onSectionTitleDragMouseDown",value:function(t,i,n,r){var o=this;if(!this.onPrepareMouseDown(t)){var a=t.pageX,l=t.pageY,s=t.target;this.savedDragInfo=j(j({},this.savedDragInfo),{},{toggleDraggingSection:r,originalSectionIndex:i}),document.addEventListener("mouseup",this.handleSectionTitleMouseUp),this.mouseDragTimeout=setTimeout((function(){o.mouseDragTimeout=null,o.initDragInfo(s,a,l);var e={originalDragIndex:n-1,currentDragIndex:n-1,outside:!1,dragPos:o.dragPos,toggleDraggingSection:r,draggingArray:o.getSectionDraggingArray(t.target),isSectionDrag:!0};o.savedDragInfo=j(j(j({},o.savedDragInfo),e),{},{scrollTop:o.listView.scrollTop}),o.listView.scrollTop=0,r(!0),o.registerEventListeners(!0),o.dragDelegate.onDragStart(e)}),e.MouseDragTimeout)}}},{key:"onPrepareMouseDown",value:function(e){return e.preventDefault(),e.stopPropagation(),!this.dragDelegate.draggable()||(2===e.button||!!this.isCtrlKey(e))}},{key:"initDragInfo",value:function(e,t,i){var n;if(this.listView){this.listRect=this.listView.getBoundingClientRect();var r=this.listView.scrollTop,o=this.getTopOffset(this.listRect.top,r),a=null!==(n=null==e?void 0:e.getBoundingClientRect())&&void 0!==n?n:{},l=a.top,s=a.right,c=a.bottom,d=a.left;i+=o,l+=o,c+=o,this.mouseOffset={top:l-i,right:s-t,bottom:c-i,left:d-t},this.dragPos=[d,l],this.oldScrollTop=r}else this.mouseOffset={top:0,right:0,bottom:0,left:0}}},{key:"getIndexPreCount",value:function(e){for(var t=this.dragDelegate.getSelectedArray(),i=0,n=0;n<t.length;n++){var r=t[n],o=this.dataList.indexOf(r);-1!==o&&o<e&&(i+=1)}return i}},{key:"getDraggingArray",value:function(e,t){for(var i=this.dataList[e],n=this.dragDelegate.getSelectedArray(),r=[i],o=0;o<n.length&&!(n[o]!==i&&(r.push(n[o]),r.length>=3));o++);r.reverse();for(var a=0;a<r.length;a++){var l=r[a]===i;r[a].cloneDom=null==t?void 0:t.cloneDom(l)}return r}},{key:"getSectionDraggingArray",value:function(e){if(!e)return[];for(var t=e;!t.className.includes("slide-list-section-title-selected")&&t.parentElement;)t=t.parentElement;var i=t.cloneNode(!0),n=void 0;return i.classList.forEach((function(e){e.includes("selected")&&(n=e)})),n&&i.classList.remove(n),i.style.background="rgba(255, 255, 255, 0.92)",i.style.opacity="0.92",i.style.boxShadow="0px 0px 0px 0.62px rgba(0, 0, 0, 0.04), 0px 3.72px 19.84px 1.24px rgba(0, 0, 0, 0.16)",i.style.backdropFilter="blur(4.96px)",i.style.borderRadius="2.48px",[{cloneDom:i}]}},{key:"isOutside",value:function(e,t,i,n){var r=this.listRect;return e<r.left||t>r.right||i>r.bottom||n<r.top}},{key:"getDragIndex",value:function(e,t){var i=this.getEffectiveTop(e);if(i>=t.reduce((function(e,t){return e+t[0]}),0)){var n=s()(t[t.length-1],2)[1];return this.dragDelegate.hasSections()||(n+=1),n}var r=-1,o=this.getAccumulatedHeight();return t.forEach((function(e){var t=s()(e,2),n=t[0],a=t[1];-1===r&&(i>o&&i<o+n?r=a:o+=n)})),r}},{key:"getAccumulatedHeight",value:function(){var e;return(null===(e=this.getSelectionService())||void 0===e?void 0:e.currentSlideType)===x.d.LAYOUT?this.dragDelegate.getCellHeight()-10:0}},{key:"getSectionDragIndex",value:function(e,t){if(t.length<=0)return-1;var i=this.getEffectiveTop(e);if(i<=0)return-1;if(i>t.reduce((function(e,t){return e+t}),0))return t.length-1;var n=-1,r=0;return t.forEach((function(e,t){-1===n&&(i>r&&i<=r+e?n=t:r+=e)})),n>=t.length&&(n=t.length),n}},{key:"getEffectiveTop",value:function(e){var t,i=this.listRect,n=((null===(t=this.listView)||void 0===t?void 0:t.scrollTop)||0)-this.oldScrollTop,r=this.oldScrollTop+n,o=this.dragDelegate.hasSections()?0:this.dragDelegate.getCellHeight()/2;return e-i.top+r+o}},{key:"getDragItemRect",value:function(e,t){var i,n,r,o;t+=0;var a=this.mouseOffset,l=t+(null!==(i=null==a?void 0:a.top)&&void 0!==i?i:0),s=t+(null!==(n=null==a?void 0:a.bottom)&&void 0!==n?n:0);return{topOfItem:l,leftOfItem:e+(null!==(r=null==a?void 0:a.left)&&void 0!==r?r:0),bottomOfItem:s,rightOfItem:e+(null!==(o=null==a?void 0:a.right)&&void 0!==o?o:0)}}},{key:"getScrollAmount",value:function(e,t){var i=this.listRect,n=i.top,r=i.height;return e<n+100?-5:t>n+r-100?5:null}},{key:"clearDragData",value:function(){this.mouseOffset=null,this.oldScrollTop=0,this.savedDragInfo={},this.dragPos=[0,0]}},{key:"registerEventListeners",value:function(e){var t=e?this.handleSectionTitleMouseUp:this.handleMouseUp,i=e?this.handleSectionTitleMouseMove:this.handleMouseMove;window.addEventListener("mousemove",i),window.addEventListener("mouseup",t)}},{key:"unRegisterListener",value:function(e){var t=e?this.handleSectionTitleMouseUp:this.handleMouseUp,i=e?this.handleSectionTitleMouseMove:this.handleMouseMove;document.removeEventListener("mouseup",t),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",t)}},{key:"getTopOffset",value:function(e,t){return 0}},{key:"listView",get:function(){return this.dragDelegate.getListView()}},{key:"dataList",get:function(){return this.dragDelegate.getDataList()}},{key:"isCtrlKey",value:function(e){return e.metaKey||e.ctrlKey}},{key:"getSelectionService",value:function(){return this.dragDelegate.getServices().selectionService}}]),e}();E()(N,"MouseDragTimeout",300);var F=i("580eefa367"),z=function(){function e(t){var i=this;d()(this,e),E()(this,"dropDelegate",void 0),E()(this,"handlerDrop",(function(e){i.handlerCustom(e,(function(){return Object(F.a)("drop",window,e)}))})),E()(this,"handlerDragover",(function(e){i.handlerCustom(e,(function(){return Object(F.a)("dragover",window,e)}))})),E()(this,"handlerDragLeave",(function(e){i.handlerCustom(e,(function(){return Object(F.a)("dragleave",window,e)}))})),this.dropDelegate=t}var t;return h()(e,[{key:"registerDragEvent",value:function(){document.addEventListener("drop",this.handlerDrop),document.addEventListener("dragover",this.handlerDragover),document.addEventListener("dragleave",this.handlerDragLeave)}},{key:"unRegisterDragEvent",value:function(){document.removeEventListener("drop",this.handlerDrop),document.removeEventListener("dragover",this.handlerDragover),document.removeEventListener("dragleave",this.handlerDragLeave)}},{key:"handlerCustom",value:(t=a()(k.a.mark((function e(t){var i,n,r,o,a=arguments;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a.length>1&&void 0!==a[1]?a[1]:function(){})(),i=this.dropDelegate.getServices(),n=i.copyPasteImageService,e.next=5,null==n?void 0:n.promise();case 5:r=e.sent,null==(o=(r||{}).preventDefaultIfTypeIsFile)||o(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),H=i("d5c3deb8c7"),U=function(){function e(t){var i=this;d()(this,e),E()(this,"mouseDelegate",void 0),E()(this,"lastClickIndex",0),E()(this,"forMouseUp",void 0),E()(this,"datumIndex",void 0),E()(this,"handleCtrlClick",(function(e,t,n){var r=i.mouseDelegate.getServices(),o=r.uiDataService,a=r.selectionService;if(t.selected){if(!i.selectedSlidesFromStore)return;if(i.selectedSlidesFromStore.length<=1)return;if(i.selectedSlidesFromStore.remove(t),e===n){var l,s=i.selectedSlidesFromStore.length-1,c=i.selectedSlidesFromStore.objectAtIndex(s),d=null!==(l=null==o?void 0:o.presentation.indexOfSlide(c))&&void 0!==l?l:0;e!==d&&(null==a||a.changeCurrentSlideIndexByUserAction(d))}}else{var u,h=(a||{}).currentSlideType;e===n&&h===t.type||(a.currentSlideIndex=n,null==a||a.updateCurrentSlideType(t.type)),null===(u=i.selectedSlidesFromStore)||void 0===u||u.add(t)}})),E()(this,"handleShiftClick",(function(e,t,n){var r=i.mouseDelegate.getServices(),o=r.uiDataService,a=r.selectionService;if(e!==t){var l=e,s=e;e>t?l=t:s=t;for(var c=l;c<=s;c++)null==a||a.selectedSlides.remove(null==o?void 0:o.presentation.slideOfIndex(c))}var d=t,u=t,h=1;if(t>n?(d=n,h=2):(u=n,h=1),1===h)for(var v=d;v<=u;v++)null==a||a.selectedSlides.add(null==o?void 0:o.presentation.slideOfIndex(v));else for(var f=u;f>=d;f--)null==a||a.selectedSlides.add(null==o?void 0:o.presentation.slideOfIndex(f))})),E()(this,"handleRightMouseClick",(function(e,t){if(0===t){var n=i.mouseDelegate.getServices().selectionService;null==n||n.selectedSlides.clearAndAdd(e)}})),E()(this,"handleCustomClick",(function(e,t,n){Object(H.w)((function(){var r=i.mouseDelegate.getServices(),o=r.selectionService,a=r.selectedAnims;e!==t&&(null==o||o.changeCurrentSlideIndexByUserAction(t)),null==o||o.selectedElements.clear(),null==a||a.clear(),null==o||o.selectedSlides.clearAndAdd(n),null==o||o.updateCurrentSlideType(n.type)}))})),E()(this,"handleMouseUp",(function(){if(i.forMouseUp){var e=i.forMouseUp,t=e.currentSlideIndex,n=e.index,r=e.slide;i.handleCustomClick(t,n,r),i.forMouseUp=null}document.removeEventListener("mouseup",i.handleMouseUp),Object(R.a)()})),this.mouseDelegate=t}return h()(e,[{key:"handleMouseDown",value:function(e,t,i){var n=this.mouseDelegate.getServices().selectionService,r=n||{},o=r.currentSlide,a=r.currentSlideIndex,l=void 0===a?0:a,s=this.lastClickIndex,c=this.getDatumPoint(),d=null==n?void 0:n.selectedSlides.indexOfObject(i);if(this.forMouseUp=null,this.isCtrlKey(e))c=t,this.handleCtrlClick(l,i,t);else if(e.shiftKey)this.handleShiftClick(s,c,t);else if(2===e.button){var u=((null==n?void 0:n.selectedSlides)||{}).selectedArray,h=(void 0===u?[]:u).length;if(h>1)-1===d&&(c=t,this.handleCustomClick(l,t,i));else{if(l===t&&(null==o?void 0:o.type)===i.type)return void this.handleRightMouseClick(i,h);c=t,this.handleCustomClick(l,t,i)}}else{var v;null===(v=this.mouseDelegate.getServices().menuManager)||void 0===v||v.hideAllMenu(),c=t,this.handleLeftClick(t,i)}this.mouseDelegate.clearClearanceSelectIndex(),this.mouseDelegate.clearClearance(),this.datumIndex=c,this.lastClickIndex=t,document.addEventListener("mouseup",this.handleMouseUp)}},{key:"handleLeftClick",value:function(e,t){var i,n=this.mouseDelegate.getServices().selectionService,r=(n||{}).currentSlideIndex,o=void 0===r?0:r;-1===(null!==(i=null==n?void 0:n.selectedSlides.selectedArray)&&void 0!==i?i:[]).indexOf(t)?this.handleCustomClick(o,e,t):this.forMouseUp={currentSlideIndex:o,index:e,slide:t},Object(R.a)()}},{key:"clearForMouseUp",value:function(){this.forMouseUp=null}},{key:"getDatumPoint",value:function(){var e,t=this.mouseDelegate.getServices().selectionService,i=void 0===this.datumIndex?0:this.datumIndex,n=this.mouseDelegate.getCurList[i];-1===(null==t?void 0:t.selectedSlides.indexOfObject(n))&&(i=null!==(e=null==t?void 0:t.currentSlideIndex)&&void 0!==e?e:0);return i}},{key:"isCtrlKey",value:function(e){return e.metaKey||e.ctrlKey}},{key:"selectedSlidesFromStore",get:function(){var e;return null===(e=this.mouseDelegate.getServices().selectionService)||void 0===e?void 0:e.selectedSlides}}]),e}(),W=i("aba9dcef64"),_=i("bb6a177e15"),Y=i("3471fb3b60"),V=i("5cdbac46e8"),K=i("020899bf26"),X=i("2f1cded8d8"),Q=i("2f766f71b0"),Z=i.n(Q),q=i("0a8ecd6412"),J=i("2550128c65"),$=i("ec5cae33cb"),ee=i("382929c8da"),te=i("5b326a30b1"),ie=i("37091e4240");function ne(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function re(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(i),!0).forEach((function(t){E()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ne(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=S()(e);if(t){var r=S()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return m()(this,i)}}var ae=function(e){g()(i,e);var t=oe(i);function i(){var e;d()(this,i);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),E()(f()(e),"services",{}),E()(f()(e),"shouldScrollToIndex",void 0),E()(f()(e),"mouseEventHandler",void 0),E()(f()(e),"dropEventHandler",void 0),E()(f()(e),"dragEventHandler",void 0),E()(f()(e),"draggingSlideList",void 0),E()(f()(e),"dragPos",void 0),E()(f()(e),"draggingArray",void 0),E()(f()(e),"scrollAmount",void 0),E()(f()(e),"mixSlidesReaction",void 0),E()(f()(e),"slidesReaction",void 0),E()(f()(e),"mastersReaction",void 0),E()(f()(e),"slideClearanceReaction",void 0),E()(f()(e),"layoutsReaction",void 0),E()(f()(e),"sectionListReaction",void 0),E()(f()(e),"sectionFoldedStateReaction",void 0),E()(f()(e),"forceRerenderOnSectionChangeReaction",void 0),E()(f()(e),"selectedSectionIndexReaction",void 0),E()(f()(e),"nameEditingIndexReaction",void 0),E()(f()(e),"slideSizeReaction",void 0),E()(f()(e),"slideSelectedReaction",void 0),E()(f()(e),"slideIndexReaction",void 0),E()(f()(e),"currentSlideReaction",void 0),E()(f()(e),"statesReaction",void 0),E()(f()(e),"slideNumberStartIndexReaction",void 0),E()(f()(e),"getCellID",(function(e){return e.key})),E()(f()(e),"handleCellAppear",(function(t){var i,n=e.getDataList().find((function(e){return e.key===t.id}));if(n){var r=e.getCurList().find((function(e){return e.key===t.id}));if(null===(i=e.services.slideRenderStateManager)||void 0===i||i.addVisibleSlide(n),n.asyncConvertChildren){var o=r?Y.a.HIGH:Y.a.HIGH-1;n.startConvertChildrenTask(o)}else n.displayChildrenElement||(n.displayChildrenElement=!0)}})),E()(f()(e),"handleCellDisappear",(function(t){var i,n=e.services.uiDataService,r=(null==n?void 0:n.slideModelList.find((function(e){return e.key===t.id})))||(null==n?void 0:n.masterModelList.find((function(e){return e.key===t.id})))||(null==n?void 0:n.layoutModelList.find((function(e){return e.key===t.id})));r&&(null===(i=e.services.slideRenderStateManager)||void 0===i||i.removeVisibleSlide(r),r.cancelConvertChildrenTask())})),E()(f()(e),"getCurGroupWrapperStyle",(function(){var t;return null===(t=e.services.masterLayoutStyleService)||void 0===t?void 0:t.getCurGroupWrapperStyle()})),E()(f()(e),"handleVisibleCellIDsChange",(function(t){e.getShouldConvertModels(t).forEach((function(e){!e.childrenConverted&&e.asyncConvertChildren&&e.startConvertChildrenTask(Y.a.HIGH)}))})),E()(f()(e),"handleClickClearance",(function(t,i){var n,r,o,a,l,s,c,d=null==t?void 0:t.shiftKey,u=e.services.selectionService;if(null!==(n=e.getMasterLayoutEditService())&&void 0!==n&&n.isMasterEditType){var h,v,f=e.getSlideList()[i],p=null!==(h=(v={},E()(v,x.d.MASTER,e.model.masterModelList.findIndex((function(e){return e.id===f.id}))),E()(v,x.d.LAYOUT,e.model.layoutModelList.findIndex((function(e){return e.id===f.id}))),v)[f.type])&&void 0!==h?h:0;return d?void e.mouseEventHandler.handleMouseDown(t,p,f):(null==u||u.selectedSlides.clear(),null==u||u.changeCurrentSlideIndexByUserAction(p),null==u||u.updateCurrentSlideType(f.type),u.slideClearanceIndex=i,void e.updateModel({slideClearanceIndex:i}))}var g=Math.max(0,B.a.calcSlideIndexFromClearanceIndex(i,e.model.sectionList)-1);if(d){var y=e.getSlideList();e.mouseEventHandler.handleMouseDown(t,g,y[g])}else e.handleCellAppear({id:null===(r=e.getUiDataService())||void 0===r||null===(o=r.presentation.children[g])||void 0===o?void 0:o.key}),null===(a=e.getMenuManager())||void 0===a||a.hideAllMenu(),null===(l=e.services.selectionService)||void 0===l||l.selectedSlides.clear(),null===(s=e.services.selectionService)||void 0===s||s.changeCurrentSlideIndexByUserAction(g),e.services.sectionManager.selectedSectionIndex=-1,e.services.selectionService.slideClearanceIndex=i,e.updateModel({slideClearanceIndex:i}),-1!==(null===(c=e.services.sectionManager)||void 0===c?void 0:c.nameEditingIndex)&&(e.services.sectionManager.nameEditingIndex=-1,Object(R.a)())})),E()(f()(e),"clearClearanceSelectIndex",(function(){var t;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(null===(t=e.viewDelegate)||void 0===t||t.forceRender()),e.services.selectionService.slideClearanceIndex=-1})),E()(f()(e),"handleSlideListScroll",P()((function(){var t,i;null!==(t=e.services.historyManager)&&void 0!==t&&t.isShowingHistory&&e.listWrapper&&e.updateModel({historyTipsScrollTop:null===(i=e.listWrapper)||void 0===i?void 0:i.scrollTop})}),20)),E()(f()(e),"handleMouseDown",(function(t,i,n){var r,o=B.a.calcClearanceIndexFromSlideIndex(i,e.model.sectionList)-1;e.dragEventHandler.dragMouseDown(t,i,null===(r=e.viewDelegate)||void 0===r?void 0:r.getElementById("cell-".concat(n.key)),o),e.mouseEventHandler.handleMouseDown(t,i,n),e.services.sectionManager.selectedSectionIndex=-1,e.clearClearanceSelectIndex()})),E()(f()(e),"handleSectionTitleMouseDown",(function(t,i){var n=B.a.calcClearanceIndexFromSectionIndex(i,e.model.sectionList);e.dragEventHandler.onSectionTitleDragMouseDown(t,i,n,(function(t){e.updateModel({isDraggingSection:t})})),e.services.sectionManager.selectedSectionIndex=i,e.clearClearanceSelectIndex()})),E()(f()(e),"handleLeftClick",(function(t,i,n){e.mouseEventHandler.handleLeftClick(i,n),e.clearClearanceSelectIndex()})),E()(f()(e),"handleMouseEnter",(function(t,i){var n;if(null!==(n=e.services.historyManager)&&void 0!==n&&n.isShowingHistory){var r=t.currentTarget.offsetTop;e.updateModel({historyTipsSlide:i,historyTipsTops:re(E()({},i,r),e.model.historyTipsTops)})}})),E()(f()(e),"handleMouseLeave",(function(t,i){i===e.model.historyTipsSlide&&e.updateModel({historyTipsSlide:-1})})),E()(f()(e),"getListWrapperName",(function(e){return"listWrapper-".concat(e)})),E()(f()(e),"getSlideCellClass",(function(e){return"slide-cell-".concat(e)})),E()(f()(e),"showSectionContextMenu",(function(t,i){var n,r;i.preventDefault(),i.stopPropagation();var o=null===(n=e.getMenuManager())||void 0===n?void 0:n.rightMenu4Section(t),a=null===(r=e.getMenuManager())||void 0===r?void 0:r.disableItemIds();a&&e.addDisabledItemsForSectionContextMenu(a,t);var l=e.getSectionContextMenuOffset(i);e.handleShowRightMenu(o.type,o.items,a,{top:i.clientY+l.offsetY,left:i.clientX+8+l.offsetX,minWidth:200,subMinWidth:200},(function(e,i,n){o.callback(e,i,{RegionType:$.a.SLIDELIST,sectionIndex:t,TriggerFrom:q.f.LEFT,object:n},null)}))})),E()(f()(e),"handleFirstSlideShow",(function(){e.model.isFirstSlideShow=!0;var t=(e.getUiDataService()||{}).slideModelList,i=void 0===t?[]:t;e.updateModel({slideModelList:i})})),E()(f()(e),"handleSlideSizeChange",(function(){var t=e.computeSlideHeight(),i=t.slideInnerHeight,n=t.renderSlideHeight;e.updateModel({slideHeight:n,slideInnerHeight:i,shouldUpdate:!0},(function(){e.model.shouldUpdate=!1}))})),E()(f()(e),"handleSectionListChange",(function(t){e.updateModel({sectionList:t})})),E()(f()(e),"handleSectionFoldedStateChange",(function(t){e.updateModel({sectionFoldedState:null!=t?t:[]})})),E()(f()(e),"handleSlideClearanceIndexChange",(function(t){e.updateModel({slideClearanceIndex:t})})),E()(f()(e),"handleListChange",(function(t,i){if((e.services.slideRenderStateManager||{}).isFirstPageDisplay){if(e.model.editType!==O.a.MASTER_LAYOUT&&("masterModelList"===t||"layoutModelList"===t))return;e.updateModel(E()({},t,i))}})),E()(f()(e),"handleScrollWhenIndexChange",(function(){var t;if(-1!==(null===(t=e.services.editingStateManager)||void 0===t?void 0:t.keyFlag4Moving)){var i,n,r,o,a=null!==(i=null===(n=e.services.editingStateManager)||void 0===n?void 0:n.keyFlag4Moving)&&void 0!==i?i:0,l=null!==(r=null===(o=e.services.selectionService)||void 0===o?void 0:o.currentSlideIndex)&&void 0!==r?r:0;[37,38,33].includes(a)?(l*e.model.slideHeight<e.listWrapper.scrollTop&&(e.listWrapper.scrollTop=l*e.model.slideHeight),e.services.editingStateManager.keyFlag4Moving=-1,e.clearClearanceSelectIndex()):[39,40,34].includes(a)?((l+1)*e.model.slideHeight>e.listClientHeight+e.listWrapper.scrollTop&&(e.listWrapper.scrollTop=(l+1)*e.model.slideHeight-e.listClientHeight),e.clearClearanceSelectIndex(),e.services.editingStateManager.keyFlag4Moving=-1):36===a?(e.listWrapper.scrollTop=l*e.model.slideHeight,e.clearClearanceSelectIndex(),e.services.editingStateManager.keyFlag4Moving=-1):35===a&&(e.listWrapper.scrollTop=(l+1)*e.model.slideHeight-e.listClientHeight,e.clearClearanceSelectIndex(),e.services.editingStateManager.keyFlag4Moving=-1)}})),E()(f()(e),"handleCurSlideChange",(function(t){var i,n,r;(e.updateModel({currentSlideIndex:t}),null!==(i=e.getMasterLayoutEditService())&&void 0!==i&&i.isMasterEditType)?e.handleCurSlideChangeWhenMasterEditType(t):(null===(r=e.getUiDataService())||void 0===r?void 0:r.slideModelList.length)!==e.model.slideModelList.length?e.shouldScrollToIndex=t:setTimeout((function(){e.scrollToSlideIndex(t)}),10);if(null!==(n=e.services.selectionService)&&void 0!==n&&n.currentSlide){var o,a,l;null===(o=e.services.selectionService)||void 0===o||null===(a=o.currentSlide)||void 0===a||a.convertAnimDataSdkToUi(),null===(l=e.services.selectedAnims)||void 0===l||l.clear()}else{var s=e.services.rightSideBarManager;s&&(s.setIsAnimationEditorShown(!1),s.setIsSelectWindowShown(!1))}e.handleScrollWhenIndexChange()})),E()(f()(e),"handleUnLock",(function(t){var i=e.model.lockInfo.concat();t.forEach((function(e){i=i.filter((function(t){return t.slide.id!==e.slide.id}))})),e.updateModel({lockInfo:i})})),E()(f()(e),"changeDraggingSlides",(function(){for(var t=0;t<e.draggingArray.length;t++){var i=e.draggingArray[t].cloneDom;if(i){var n=s()(e.dragPos,2),r=n[0],o=n[1];i.style.transform="translate(".concat(r+25,"px, ").concat(4*(e.draggingArray.length-t)+o,"px) scale(1.1)"),i.style.width="".concat(e.model.slideWidth,"px"),i.style.height="".concat(e.model.slideHeight,"px"),i.style.position="absolute",i.parentNode||e.draggingDiv.appendChild(i)}}})),E()(f()(e),"changeDraggingSectionTitle",(function(){if(e.draggingArray&&0!==e.draggingArray.length){var t=e.draggingArray[0].cloneDom;if(t){var i=s()(e.dragPos,2),n=i[0],r=i[1];t.style.transform="translate(".concat(n,"px, ").concat(4*(e.draggingArray.length-0)+r,"px)"),t.style.width="".concat(e.model.sectionWidth,"px"),t.style.position="absolute",t.parentNode||e.draggingDiv.appendChild(t)}}})),E()(f()(e),"handleShowRightMenu",function(){var t=a()(k.a.mark((function t(i,n,r,o,a){var l,s;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(l=e.services.rightMenuManager)||void 0===l?void 0:l.promise();case 2:null==(s=t.sent)||s.showMenu(i,n,r,o,(function(){null==s||s.hideMenu(i),a.apply(void 0,arguments)}));case 4:case"end":return t.stop()}}),t)})));return function(e,i,n,r,o){return t.apply(this,arguments)}}()),e}return h()(i,[{key:"setEditServiceDelegates",value:function(e){this.services=re(re({},this.services),e)}},{key:"setViewerServiceDelegates",value:function(e){this.services=re(re({},this.services),e)}},{key:"getProps",value:function(){return this.props}},{key:"getCellHeight",value:function(){return this.model.slideHeight}},{key:"getSlideSectionListHeights",value:function(){var e=this,t=this.model.sectionList,i=(this.getSectionManager()||{}).sectionFoldedState,n=this.getSlideList();if(!t||0===t.length)return Array.from(n,(function(t,i){return[e.getCellHeight(),i]}));var r=[];return t.forEach((function(t,n,o){var a,l=B.a.calcClearanceIndexFromSectionIndex(n,o),s=null!==(a=null==i?void 0:i[n])&&void 0!==a&&a;if(s&&(l+=t.numSlides),r.push([_.a.SectionTitleHeight,l]),!s){var c=t.numSlides;n===o.length-1&&(c=e.getLastSectionSizeForCompatibility(o)),Array.from({length:c}).forEach((function(t,i){return r.push([e.getCellHeight(),l+i+1])}))}})),r}},{key:"getSectionListHeights",value:function(){var e=this.model.sectionList;return e&&0!==e.length?Array.from(e,(function(){return _.a.SectionTitleHeight})):[]}},{key:"getSelectedArray",value:function(){var e,t=((null===(e=this.services.selectionService)||void 0===e?void 0:e.selectedSlides)||{}).selectedArray;return void 0===t?[]:t}},{key:"isModelDragging",value:function(e){var t;return-1!==this.model.currentDragIndex&&-1!==(null===(t=this.services.selectionService)||void 0===t?void 0:t.selectedSlides.indexOfObject(e))}},{key:"getRenderCellIndex",value:function(e,t){var i,n;return t===O.a.SLIDE?e+(null!==(i=null===(n=this.services.uiDataService)||void 0===n?void 0:n.presentation.firstSlideNum)&&void 0!==i?i:0)-1:e}},{key:"getSizeType",value:function(){var e,t;return null!==(e=null===(t=this.getUiDataService())||void 0===t?void 0:t.presentation.props.slideSizeType)&&void 0!==e?e:te.a.SLIDE_SIZE_16_9}},{key:"getCurList",value:function(){switch(this.model.currentSlideType){case x.d.MASTER:return this.model.masterModelList;case x.d.LAYOUT:return this.model.layoutModelList;default:return this.model.slideModelList}}},{key:"getDataList",value:function(){return this.model.editType===O.a.MASTER_LAYOUT?this.model.masterModelList.concat(this.model.layoutModelList):this.model.slideModelList}},{key:"getListView",value:function(){return this.listWrapper}},{key:"getDraggingItemList",value:function(){return this.draggingSlideList}},{key:"draggable",value:function(){var e=this.getUserPriviledgeService();return!!e&&e.pptEditorState<=V.b.EDITABLE}},{key:"onDragStart",value:function(e){document.body.style.cursor="grabbing";var t=e.currentDragIndex,i=e.originalDragIndex,n=e.originalDragItem,r=e.draggingArray,o=e.dragPos,a=e.isSectionDrag;this.draggingArray=r,this.dragPos=o,this.updateModel({currentDragIndex:t,originalDragIndex:i,originalDragSlide:n,isPressed:!0,isSectionDrag:a})}},{key:"onSectionTitleDragStart",value:function(e){document.body.style.cursor="grabbing";var t=e.currentDragIndex,i=e.originalDragIndex,n=e.originalDragItem;this.updateModel({currentDragIndex:t,originalDragIndex:i,originalDragSlide:n,isPressed:!0})}},{key:"onDragging",value:function(e){var t=e.outside,i=e.scrollAmount,n=e.isSectionDrag,r=e.currentDragIndex;n&&-1!==r&&(r=this.fixDragIndexOnSectionDrag(e,r)),this.mouseEventHandler.clearForMouseUp(),this.scrollAmount=i,this.updateModel({currentDragIndex:r,outside:t})}},{key:"onDragEnd",value:function(e){document.body.style.cursor="",this.draggingArray=[],this.scrollAmount=0;var t,i=(this.getUserPriviledgeService()||{}).pptEditorState;if((void 0===i?V.b.SELECTABLE:i)>V.b.EDITABLE)return null===(t=this.services.tipsManager)||void 0===t||t.showCannotEditTips(),void this.updateModel({originalDragSlide:null,currentDragIndex:-1,originalDragIndex:-1,isPressed:!1,isSectionDrag:!1});this.handleMoveSlide(e),this.updateModel({originalDragSlide:null,currentDragIndex:-1,originalDragIndex:-1,isPressed:!1,isSectionDrag:!1})}},{key:"unfoldCorrespondingSection",value:function(e){var t=B.a.calcSectionIndexFromClearanceIndex(e,this.model.sectionList);if(this.model.sectionFoldedState[t]){var i,n=this.services.sectionManager;if(null!=n&&n.sectionFoldedState)n.sectionFoldedState[t]=!1,null===(i=this.viewDelegate)||void 0===i||i.forceRender()}}},{key:"getSectionList",value:function(){return this.model.sectionList}},{key:"updateDraggingSlideList",value:function(e){this.draggingSlideList=e}},{key:"getModifiedSlidesInfos",value:function(){var e=this,t=this.services.historyManager;return((null==t?void 0:t.modification)||[]).map((function(i,n){if(i.length>0){var r=i[i.length-1],o=null==t?void 0:t.getAuthor(r);return{authorName:null==o?void 0:o.name,color:null==t?void 0:t.getColorForId(r),y:e.model.historyTipsTops[n]-e.model.historyTipsScrollTop}}return null}))}},{key:"componentDidMount",value:function(){var e,t,i,n=this;this.dropEventHandler.registerDragEvent(),null===(e=this.services.imgLoaderManager)||void 0===e||e.setScrollTarget(this.listWrapper);var r=null===(t=this.services)||void 0===t?void 0:t.uiDataService;this.mixSlidesReaction=Object(H.r)((function(){return null==r?void 0:r.slideModelList}),(function(e){return n.handleListChange("slides",e)})),this.slidesReaction=Object(H.r)((function(){return null==r?void 0:r.slideModelList}),(function(e){return n.handleListChange("slideModelList",e)})),this.mastersReaction=Object(H.r)((function(){return null==r?void 0:r.masterModelList}),(function(e){return n.handleListChange("masterModelList",e)})),this.layoutsReaction=Object(H.r)((function(){return null==r?void 0:r.layoutModelList}),(function(e){return n.handleListChange("layoutModelList",e)})),this.sectionListReaction=Object(H.r)((function(){return null==r?void 0:r.presentation.sectionList}),(function(e){return n.handleSectionListChange(e)})),this.sectionFoldedStateReaction=Object(H.r)((function(){var e;return null===(e=n.services.sectionManager)||void 0===e?void 0:e.sectionFoldedState}),(function(e){return n.handleSectionFoldedStateChange(e)})),this.forceRerenderOnSectionChangeReaction=Object(H.r)((function(){var e;return null===(e=n.services.sectionManager)||void 0===e?void 0:e.onSectionsChangeAction}),(function(){var e;return null===(e=n.viewDelegate)||void 0===e?void 0:e.forceRender()})),this.selectedSectionIndexReaction=Object(H.r)((function(){var e;return null===(e=n.services.sectionManager)||void 0===e?void 0:e.selectedSectionIndex}),(function(){var e;return null===(e=n.viewDelegate)||void 0===e?void 0:e.forceRender()})),this.nameEditingIndexReaction=Object(H.r)((function(){var e;return null===(e=n.services.sectionManager)||void 0===e?void 0:e.nameEditingIndex}),(function(){var e;return null===(e=n.viewDelegate)||void 0===e?void 0:e.forceRender()})),this.slideClearanceReaction=Object(H.r)((function(){var e;return null===(e=n.services.selectionService)||void 0===e?void 0:e.slideClearanceIndex}),(function(e){return n.handleSlideClearanceIndexChange(null!=e?e:0)})),this.handleSectionListChange(null==r?void 0:r.presentation.sectionList),this.handleSectionFoldedStateChange(null===(i=this.services.sectionManager)||void 0===i?void 0:i.sectionFoldedState),this.statesReaction=Object(H.r)((function(){var e,t;return[null===(e=n.getMasterLayoutEditService())||void 0===e?void 0:e.editType,null===(t=n.services.selectionService)||void 0===t?void 0:t.currentSlideType]}),(function(e){var t,i=s()(e,2),r=i[0],o=i[1];if((r=null!==(t=r)&&void 0!==t?t:O.a.SLIDE)===O.a.MASTER_LAYOUT){var a=(n.getUiDataService()||{}).masterModelList,l=(n.getUiDataService()||{}).layoutModelList;n.updateModel({editType:r,masterModelList:a,layoutModelList:l,currentSlideType:o})}else n.updateModel({editType:r,currentSlideType:o})})),this.slideSizeReaction=Object(H.r)((function(){var e,t,i;return[null===(e=n.getUiDataService())||void 0===e?void 0:e.presentation.props.slideSizeType,null===(t=n.getUiDataService())||void 0===t?void 0:t.presentation.props.slideWidth,null===(i=n.getUiDataService())||void 0===i?void 0:i.presentation.props.slideHeight]}),(function(){n.handleSlideSizeChange()})),this.slideSelectedReaction=Object(H.r)((function(){var e=(n.services.selectionService||{}).selectedSlides;return{selArray:null==e?void 0:e.selectedArray,length:null==e?void 0:e.length}}),(function(){n.clearClearanceSelectIndex()})),this.slideIndexReaction=Object(H.r)((function(){var e;return null===(e=n.services.selectionService)||void 0===e?void 0:e.needClearSelectedSlideClearanceFlag}),(function(){n.clearClearanceSelectIndex()})),this.currentSlideReaction=Object(H.r)((function(){var e;return null===(e=n.services.selectionService)||void 0===e?void 0:e.currentSlideIndex}),(function(e){n.handleCurSlideChange(e)}));var o=function(e){n.updateModel({lockInfo:e})},a=function(e){n.handleUnLock(e)},l=function(e){var t=W.a.CooperationLockManager();n.updateModel({lockInfo:e||(null==t?void 0:t.lockInfo)})};K.a.EventManager.promise().then((function(e){e.on(X.a.Lock,o),e.on(X.a.Unlock,a),e.on(X.a.LockInfoUpdate,l)})),this.slideNumberStartIndexReaction=Object(H.r)((function(){var e;return null===(e=n.getUiDataService())||void 0===e?void 0:e.presentation.firstSlideNum}),(function(){n.updateModel({slideWidth:130-Object(R.b)(n.getUiDataService())})}))}},{key:"componentWillUnmount",value:function(){var e,t,i,n,r,o,a,l,s,c,d,u,h,v,f;null===(e=this.mixSlidesReaction)||void 0===e||e.call(this),null===(t=this.slidesReaction)||void 0===t||t.call(this),null===(i=this.slideSelectedReaction)||void 0===i||i.call(this),null===(n=this.mastersReaction)||void 0===n||n.call(this),null===(r=this.layoutsReaction)||void 0===r||r.call(this),null===(o=this.slideClearanceReaction)||void 0===o||o.call(this),null===(a=this.sectionListReaction)||void 0===a||a.call(this),null===(l=this.sectionFoldedStateReaction)||void 0===l||l.call(this),null===(s=this.forceRerenderOnSectionChangeReaction)||void 0===s||s.call(this),null===(c=this.selectedSectionIndexReaction)||void 0===c||c.call(this),null===(d=this.nameEditingIndexReaction)||void 0===d||d.call(this),null===(u=this.slideIndexReaction)||void 0===u||u.call(this),null===(h=this.currentSlideReaction)||void 0===h||h.call(this),null===(v=this.slideSizeReaction)||void 0===v||v.call(this),null===(f=this.slideNumberStartIndexReaction)||void 0===f||f.call(this),this.dropEventHandler.unRegisterDragEvent()}},{key:"hasSections",value:function(){var e;return!(null===(e=this.model.sectionList)||void 0===e||!e.length)}},{key:"shouldComponentUpdate",value:function(e){return!1!==e.shouldUpdate}},{key:"componentWillUpdate",value:function(e,t){this.updateModelBeforeRender(),this.clearClearanceSelectIndex(!1)}},{key:"componentDidUpdate",value:function(){var e=this,t=this.scrollAmount;t&&(this.listWrapper.scrollTop+=t),-1!==this.shouldScrollToIndex&&setTimeout((function(){e.scrollToSlideIndex(e.shouldScrollToIndex),e.shouldScrollToIndex=-1}),10),this.draggingDiv&&(this.model.originalDragSlide?this.changeDraggingSlides():this.model.isSectionDrag&&this.changeDraggingSectionTitle())}},{key:"clearClearance",value:function(){this.model.slideClearanceIndex>=0&&this.updateModel({slideClearanceIndex:-1})}},{key:"getSectionFoldedState",value:function(){var e,t;return null!==(e=null===(t=this.getSectionManager())||void 0===t?void 0:t.sectionFoldedState)&&void 0!==e?e:null}},{key:"setSectionName",value:function(e,t){var i=this.getSectionProperty(),n=this.getSectionManager();n&&i&&(i.renameSection(e,t),n.nameEditingIndex=-1)}},{key:"toggleSectionFolded",value:function(e){var t=this.getSectionFoldedState();if(t){var i=r()(t);i[e]=!i[e];var n=this.getSectionManager();n&&(n.sectionFoldedState=i)}}},{key:"isSectionSelected",value:function(e){var t=this.getSectionManager();return(null==t?void 0:t.selectedSectionIndex)===e}},{key:"setSectionSelected",value:function(e){var t=this.getSectionManager();t&&(t.selectedSectionIndex=e,this.clearClearanceSelectIndex(),this.clearClearance())}},{key:"getSelectedSectionIndex",value:function(){var e,t;return null!==(e=null===(t=this.getSectionManager())||void 0===t?void 0:t.selectedSectionIndex)&&void 0!==e?e:-1}},{key:"getSectionNameEditingIndex",value:function(){var e,t;return null!==(e=null===(t=this.getSectionManager())||void 0===t?void 0:t.nameEditingIndex)&&void 0!==e?e:-1}},{key:"setSectionNameEditingIndex",value:function(e,t){var i=this.getSectionManager();i&&(i.nameEditingIndex=t?e:-1)}},{key:"selectSection",value:function(e){var t=this.getSectionProperty(),i=this.getSectionManager();if(t&&i){var n=t.getSectionSlideModelsAndBeginSlideIndex(e),r=s()(n,2),o=r[0],a=r[1];i.selectSection(e,a,o)}}},{key:"getMasterLayoutGroupList",value:function(){var e,t,i=this;if(!(null!==(e=this.model.masterModelList)&&void 0!==e&&e.length||null!==(t=this.model.layoutModelList)&&void 0!==t&&t.length))return[[]];var n=[],r=-1;return this.model.masterModelList.forEach((function(e,t){e.listIndex=t;var o=[e];n.push(o),i.model.layoutModelList.forEach((function(t){e.id===t.masterId&&(r+=1,t.listIndex=r,o.push(t))}))})),n}},{key:"getRenderModelList",value:function(){var e,t=this,i=[];if(null===(e=this.model.sectionList)||void 0===e||!e.length||this.model.editType===O.a.MASTER_LAYOUT)return i.push(new J.a({gapIndex:0})),i.push.apply(i,r()(this.model.slideModelList.map((function(e,t){return e.listIndex=t,e})))),[i];if(this.model.sectionList){var n=0;return this.model.isDraggingSection&&i.push(new J.a({gapIndex:-1})),this.model.sectionList.forEach((function(e,o,a){var l,s;e.sectionIndex=o,i.push(e);var c=e.numSlides;if(o===a.length-1&&(c=t.getLastSectionSizeForCompatibility(a)),!(t.model.isDraggingSection||null!==(l=t.getSectionManager())&&void 0!==l&&null!==(s=l.sectionFoldedState)&&void 0!==s&&s[o])){var d=0;i.push.apply(i,r()(t.model.slideModelList.map((function(e){return e.listIndex=d,d+=1,e})).slice(n,n+c)))}n+=c})),[i]}return[]}},{key:"getHistoryManager",value:function(){return this.services.historyManager}},{key:"hideAllMenu",value:function(){var e;return null===(e=this.getMenuManager())||void 0===e?void 0:e.hideAllMenu()}},{key:"getServices",value:function(){return this.services}},{key:"initWithProps",value:function(e){var t,i,n=this;this.shouldScrollToIndex=-1,this.dragEventHandler=new N(this),this.dropEventHandler=new z(this),this.mouseEventHandler=new U(this),this.model.lockInfo=null!==(t=null===(i=this.getLockManager())||void 0===i?void 0:i.lockInfo)&&void 0!==t?t:[],ie.b.on(ie.a.FIRST_PAGE_DISPLAY,(function(){var e=(n.services.slideRenderStateManager||{}).isFirstPageDisplay;void 0!==e&&e&&n.handleFirstSlideShow()}))}},{key:"createViewModel",value:function(){return new L}},{key:"getInitModelValue",value:function(){var e,t,i,n,r,o,a,l,s,c,d,u,h=this.computeSlideHeight(),v=h.slideInnerHeight,f=h.renderSlideHeight;return{slideWidth:130-Object(R.b)(this.getUiDataService()),slideHeight:f,slideInnerHeight:v,slideModelList:null===(e=this.services.uiDataService)||void 0===e?void 0:e.slideModelList,masterModelList:null===(t=this.services.uiDataService)||void 0===t?void 0:t.masterModelList,layoutModelList:null===(i=this.services.uiDataService)||void 0===i?void 0:i.layoutModelList,sectionList:null===(n=this.services)||void 0===n||null===(r=n.uiDataService)||void 0===r?void 0:r.presentation.sectionList,currentSlideType:null===(o=this.services.selectionService)||void 0===o?void 0:o.currentSlideType,editType:this.getMasterLayoutEditType(),isFirstSlideShow:null!==(a=null===(l=this.services.slideRenderStateManager)||void 0===l?void 0:l.isFirstPageDisplay)&&void 0!==a&&a,isShowingHistory:null!==(s=null===(c=this.services.historyManager)||void 0===c?void 0:c.isShowingHistory)&&void 0!==s&&s,currentSlideIndex:null===(d=this.services.selectionService)||void 0===d?void 0:d.currentSlideIndex,slideClearanceIndex:null===(u=this.services.selectionService)||void 0===u?void 0:u.slideClearanceIndex}}},{key:"getSlideList",value:function(){var e,t;if(this.model.editType===O.a.MASTER_LAYOUT){var i=(this.getUiDataService()||{}).masterModelList,n=void 0===i?[]:i;return Z()(n.map((function(e){return[e].concat(r()(e.layoutList))})))}return null!==(e=null===(t=this.getUiDataService())||void 0===t?void 0:t.slideModelList)&&void 0!==e?e:[]}},{key:"updateModelBeforeRender",value:function(){var e,t,i,n;this.model.isShowingHistory=null!==(e=null===(t=this.services.historyManager)||void 0===t?void 0:t.isShowingHistory)&&void 0!==e&&e,this.model.currentSlideIndex=null!==(i=null===(n=this.services.selectionService)||void 0===n?void 0:n.currentSlideIndex)&&void 0!==i?i:0}},{key:"handleMoveSlide",value:function(e){var t,i,n=e.outside,r=e.finalIndex;if(e.isSectionDrag)return this.handleSectionDrag(e);var o=null!==(t=null===(i=this.services.selectionService)||void 0===i?void 0:i.currentSlideIndex)&&void 0!==t?t:0;if(!n&&-1!==r){var a;if(this.model.editType===O.a.MASTER_LAYOUT){var l=(this.getUiDataService()||{}).presentation;return null==l?void 0:l.moveLayout(r+1)}if(null!==(a=this.getUiDataService())&&void 0!==a&&a.presentation.hasSections()){var s,c=this.model.sectionList,d=B.a.calcSlideIndexFromClearanceIndex(r,c),u=B.a.calcSectionIndexFromClearanceIndex(r,c);if(u===B.a.calcSectionIndexFromClearanceIndex(o,c)&&d===o&&d-1===o)return;null===(s=this.getUiDataService())||void 0===s||s.presentation.moveSlideToSection(r,d,u),this.services.sectionManager.sectionFoldedState[u]=!1}else if(o!==r){var h;null===(h=this.getUiDataService())||void 0===h||h.presentation.moveSlide(r)}}}},{key:"handleSectionDrag",value:function(e){var t,i,n,r=e.originalSectionIndex,o=e.finalIndex;if(r!==(o+=1)){null===(t=this.getUiDataService())||void 0===t||t.presentation.getSectionProperty().moveSection(r,o),null===(i=this.services.sectionManager)||void 0===i||i.moveSectionFoldedState(r,o);var a=null===(n=this.getUiDataService())||void 0===n?void 0:n.presentation.getSectionProperty();if(a){var l,c=a.getSectionSlideModelsAndBeginSlideIndex(o),d=s()(c,2),u=d[0],h=d[1];null===(l=this.services.sectionManager)||void 0===l||l.selectSection(o,h,u)}}}},{key:"scrollToSlideIndex",value:function(e){if(this.shouldScroll(e)){var t=this.listWrapper.scrollTop,i=this.listWrapper.scrollTop+this.listClientHeight,n=this.getTopScrollMinusFoldedSlides(e),r=n+this.model.slideHeight;n<t?this.listWrapper.scrollTop=n:r>i&&(this.listWrapper.scrollTop=r-this.listClientHeight)}}},{key:"shouldScroll",value:function(e){var t;return this.listWrapper&&e>=0&&2*this.model.slideHeight<=this.listWrapper.scrollHeight&&this.listWrapper.scrollHeight>this.listClientHeight&&-1===(null===(t=this.services.selectionService)||void 0===t?void 0:t.slideClearanceIndex)}},{key:"listClientHeight",get:function(){var e=this.getCurGroupWrapperStyle()||{},t=e.paddingTop,i=void 0===t?0:t,n=e.paddingBottom,r=void 0===n?0:n;return this.listWrapper.clientHeight-i-r}},{key:"getTopScrollMinusFoldedSlides",value:function(e){var t=this,i=e*this.model.slideHeight,n=this.getSectionManager();if(!this.model.sectionList||this.model.sectionList.length<=0||null==n||!n.sectionFoldedState)return i;var r=B.a.calcSectionIndexFromSlideIndex(e,this.model.sectionList);i+=r*_.a.SectionTitleHeight;var o=n.sectionFoldedState.slice(0,r).reduce((function(e,i,n){return i&&(e+=t.model.sectionList[n].numSlides*t.model.slideHeight),e}),0);return Math.max(0,i-o)}},{key:"handleCurSlideChangeWhenMasterEditType",value:function(e){var t,i=this;if((null===(t=this.services.selectionService)||void 0===t?void 0:t.currentSlideType)===x.d.MASTER){var n,r,o=null===(n=this.services.selectionService)||void 0===n?void 0:n.currentSlide,a=-1;null===(r=this.getUiDataService())||void 0===r||r.masterModelList.find((function(e){return a+=1,e===o||(a+=e.layoutList.length,!1)})),setTimeout((function(){i.scrollToSlideIndex(a)}),10)}else{var l,s,c,d=null===(l=this.services.selectionService)||void 0===l?void 0:l.currentSlide,u=null==d?void 0:d.getRelationMasterModel(),h=(null!==(s=null===(c=this.getUiDataService())||void 0===c?void 0:c.masterModelList.indexOf(u))&&void 0!==s?s:0)+1;setTimeout((function(){i.scrollToSlideIndex(h+e)}),10)}}},{key:"listWrapper",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById(this.getListWrapperName(this.model.editType))}},{key:"draggingDiv",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById("draggingDiv")}},{key:"getSlideGroupList",value:function(){var e;return null!==(e=this.model.slideModelList)&&void 0!==e&&e.length?this.model.slideModelList.map((function(e,t){return e.listIndex=t,e})):[]}},{key:"getSectionContextMenuOffset",value:function(e){return{offsetX:0,offsetY:0}}},{key:"addDisabledItemsForSectionContextMenu",value:function(e,t){var i,n,r,o=this.model.sectionList;(null!==(i=null==o?void 0:o.length)&&void 0!==i?i:0)>t&&0===o[t].numSlides&&e.push({id:ee.a.DELETE_SECTION_AND_SLIDES}),0===t&&(null!==(n=null==o?void 0:o.length)&&void 0!==n?n:0)>=1&&o[0].numSlides>0&&e.push({id:ee.a.DELETE_SECTION},{id:ee.a.MOVE_SECTION_UP}),t===(null!==(r=null==o?void 0:o.length)&&void 0!==r?r:0)-1&&e.push({id:ee.a.MOVE_SECTION_DOWN})}},{key:"getSectionProperty",value:function(){var e;return null===(e=this.getUiDataService())||void 0===e?void 0:e.presentation.getSectionProperty()}},{key:"getSectionManager",value:function(){return this.services.sectionManager}},{key:"getLastSectionSizeForCompatibility",value:function(e){var t=e.slice(0,e.length-1).reduce((function(e,t){return e+t.numSlides}),0);return this.getSlideList().length-t}},{key:"fixDragIndexOnSectionDrag",value:function(e,t){var i,n=B.a.calcClearanceIndexFromSectionIndex(t,this.model.sectionList);return n+=null!==(i=this.model.sectionList[t].numSlides)&&void 0!==i?i:0}},{key:"getUiDataService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.uiDataService}},{key:"getUserPriviledgeService",value:function(){return this.services.userPriviledgeService}},{key:"getMasterLayoutEditService",value:function(){return this.services.masterLayoutEditService}},{key:"getMenuManager",value:function(){return this.services.menuManager}},{key:"getShouldConvertModels",value:function(e){var t=this.getDataList(),i=t.length,n=1/0,r=-1;return e.forEach((function(e){var i=t.findIndex((function(t){return t.key===e}));i<n&&(n=i),i>r&&(r=i)})),n>r?[]:(r+5<i?r+=5:r=i-1,t.slice(n,r+1))}},{key:"getLockManager",value:function(){return W.a.CooperationLockManager()}},{key:"computeSlideHeight",value:function(){var e,t=(null===(e=this.services.uiDataService)||void 0===e?void 0:e.presentation.props)||{},i=t.slideWidth,n=void 0===i?0:i,r=t.slideHeight,o=130/n*(void 0===r?0:r);return{slideInnerHeight:o,renderSlideHeight:o+16}}},{key:"getMasterLayoutEditType",value:function(){var e,t,i;return D.a.isMobile||null===(e=this.services.userPriviledgeService)||void 0===e||!e.isEditable()?O.a.SLIDE:null!==(t=null===(i=this.services.masterLayoutEditService)||void 0===i?void 0:i.editType)&&void 0!==t?t:O.a.SLIDE}}]),i}(w.a)},"16a5d071f8":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("7e61746219"),s=i("e0a67dc3fe"),c=function(){function e(){r()(this,e)}return a()(e,[{key:"isSupportArkVersionManager",get:function(){return!Object(l.b)()}},{key:"enableHistoryVersion",get:function(){return Object(s.c)(s.a.getConfig("custom.feature.history.version"),!0)}},{key:"onBeforeRevertUrlReload",value:function(){return!1}}]),e}()},"19be379080":function(e,t,i){t=e.exports=i("9dddfe0040")(!1);var n=i("c92b994f13"),r=n(i("b53db0c2a2")),o=n(i("1c08b8fac5"));t.push([e.i,".version-item-version-item-wrapper-7Ppay{position:relative;height:69px;padding-left:32px!important}.version-item-version-item-wrapper-7Ppay.version-item-selected-UlFhS{background-color:#efefef}.version-item-version-item-wrapper-7Ppay:hover{background-color:#f4f4f4}.version-item-version-item-wrapper-7Ppay .version-item-revert-bevO4{position:absolute;height:22px;right:10px;top:14px;cursor:pointer;color:rgba(0,0,0,.4);display:flex;flex-direction:row;align-items:center}.version-item-version-item-wrapper-7Ppay .version-item-revert-bevO4:hover{color:#00a4ff}.version-item-version-item-wrapper-7Ppay .version-item-revert-bevO4:hover .version-item-revert-icon-3wVM6{background-image:url("+r+")}.version-item-version-item-wrapper-7Ppay .version-item-revert-bevO4 .version-item-revert-icon-3wVM6{width:16px;height:16px;background:url("+o+") 50% no-repeat;background-size:12px 12px;display:inline-block}.version-item-version-item-wrapper-7Ppay .version-item-revert-bevO4 .version-item-revert-text-1T4nh{display:inline-block;font-size:12px;position:relative}.version-item-version-item-wrapper-7Ppay .version-item-version-item-time-1LN4M{letter-spacing:0;text-align:left;padding-top:16px;font-family:PingFangSC-Medium;font-weight:500;font-size:14px;color:rgba(0,0,0,.64);line-height:20px}.version-item-version-item-wrapper-7Ppay .version-item-version-item-content-2xBIQ .version-item-version-item-dot-2HWRn{display:inline-block;width:6px;height:6px;margin-right:6px;border-radius:50%;background-color:red}.version-item-version-item-wrapper-7Ppay .version-item-version-item-content-2xBIQ .version-item-version-item-context-2BZT2{font-family:PingFangSC-Regular;display:inline-block;vertical-align:middle;width:calc(100% - 16px);white-space:nowrap;font-size:12px;color:rgba(0,0,0,.7);line-height:17px;letter-spacing:0;text-align:left;overflow:hidden;text-overflow:ellipsis}.version-item-version-item-wrapper-7Ppay .version-item-version-item-content-2xBIQ .version-item-version-item-context-2BZT2 a:link{text-decoration:none;color:#136aff}.version-item-version-item-wrapper-7Ppay .version-item-version-item-content-2xBIQ .version-item-version-item-context-2BZT2 a:active{-webkit-text-decoration:#136aff;text-decoration:#136aff}.version-item-version-item-wrapper-7Ppay .version-item-version-item-content-2xBIQ .version-item-version-item-context-2BZT2 a:hover,.version-item-version-item-wrapper-7Ppay .version-item-version-item-content-2xBIQ .version-item-version-item-context-2BZT2 a:visited{text-decoration:none;color:#136aff}.version-item-version-item-wrapper-7Ppay .version-item-version-item-content-2xBIQ .version-item-version-item-link-2LVJn{color:#1e6fff;cursor:pointer}",""]),t.locals={"version-item-wrapper":"version-item-version-item-wrapper-7Ppay",selected:"version-item-selected-UlFhS",revert:"version-item-revert-bevO4","revert-icon":"version-item-revert-icon-3wVM6","revert-text":"version-item-revert-text-1T4nh","version-item-time":"version-item-version-item-time-1LN4M","version-item-content":"version-item-version-item-content-2xBIQ","version-item-dot":"version-item-version-item-dot-2HWRn","version-item-context":"version-item-version-item-context-2BZT2","version-item-link":"version-item-version-item-link-2LVJn"}},"1c08b8fac5":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAAl0lEQVR42mNgGAXkAWkGdVKUKzCUMugTr1yVoZyhingNOgyVDFUMVQwxDE4MlgwShJQbgRUjw2QGadzKLTGUg2AFgxEuDdZYNYCgGi4tJjg0lDDw4NKiC/W0L4Mxgx1DMEMRVIsXbp+oowQrE4MmQxrYJ9y4tSihRRwLgztDFYMZvuCVwUgaHgwRpKUuJoZIUhOk4nDKXQAv1iXQek9tqQAAAABJRU5ErkJggg=="},"23171a4a19":function(e,t,i){"use strict";i.d(t,"a",(function(){return lt}));i("73b854064b");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("8eec1e4a03"),s=i.n(l),c=i("bd29e2df90"),d=i.n(c),u=i("ab5eb40518"),h=i.n(u),v=i("1b4cdd6a36"),f=i.n(v),p=(i("8ee19818c4"),i("3f95c26bbc")),g=i("e0e8dd9366"),y=(i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36"),i("547611bd96")),m=i.n(y),b=i("85d0a7609b"),S=i.n(b),M=(i("b8217400dc"),i("e6f68cdf2e"),i("a2a09da1e3"),i("281cbdced7")),E=i.n(M),C=i("a9e0ee82c1"),k=i.n(C),w=i("ffc220634f"),I=i("f24deb6c72"),x=i("d5c3deb8c7"),O=i("1e07095161"),A=i("d3d31c86eb"),L=i("9da6335152"),R=i("9657b29818"),D=i("51b2ea9953"),T=i("c6c7cf6a47"),P=i("153bd00100"),B=i("db50d57b55"),G=(i("75563bc376"),i("176815363d")),j=i.n(G),N=i("3ef2352f0b"),F=i.n(N),z=(i("6c458f1652"),i("c6244f7705"),i("081c8cafea"),i("4112e843fb")),H=i("530271770f"),U=i("e554c15969"),W=i("d9812f1c6f"),_=i("0a8ecd6412"),Y=i("b86964b011"),V=i("6899c02841"),K=i("e5a826a0ff"),X=i("5cdbac46e8"),Q=i("f9193d718f"),Z=i("59087c860a"),q=i("4b36a541c0");function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var $=function(e){d()(i,e);var t=J(i);function i(e,n){var o;return r()(this,i),o=t.call(this,e,n),S()(m()(o),"flagEventsInstance",void 0),S()(m()(o),"reactionDisposers",[]),S()(m()(o),"hasEditorRegisterDocumentMouseUp",void 0),S()(m()(o),"mouseDown",void 0),S()(m()(o),"needMouseUp",void 0),S()(m()(o),"mouseMove",void 0),S()(m()(o),"pcMobileCommonLogic",void 0),S()(m()(o),"handleMouseDown",(function(e){var t,i;o.checkIsDoMouseAction()&&(o.mouseDown=!0,W.a&&!W.a.isMac&&H.a.getInstance().clear(),null===(t=o.getAppService().editableServiceLayer)||void 0===t||null===(i=t.selectedAnims)||void 0===i||i.clear(),Object(x.w)((function(){var t;o.factoryOptions.isGroupChildren?o.pcMobileCommonLogic.findRootGroupMouseDown(e,o.factoryOptions.model):(e.stopPropagation(),o.getSelectionService().selectedElements.clear(K.a.GROUP),o.isSpecialKey(e.nativeEvent)?o.factoryOptions.model.selected?o.needMouseUp=!0:(o.getSelectionService().selectedElements.add(o.factoryOptions.model),o.getAppService().viewableServiceLayer.editingStateManager.updateElementCropState(!1),o.reportOnSelect(o.factoryOptions.model)):o.factoryOptions.model.selected?o.factoryOptions.model.type===g.d.GROUP&&o.getSelectionService().selectedElements.selectedArrayForType(K.a.SLIDE).length>1&&(o.needMouseUp=!0):o.selectElement(o.factoryOptions.model),o.factoryOptions.model.type!==g.d.TABLE&&o.getAppService().viewableServiceLayer.userPriviledgeService.isEditable()&&(null===(t=o.getAppService().editableServiceLayer)||void 0===t||t.dragElementHandler.handleMouseDownOnElement(e,o.factoryOptions.model,o.factoryOptions.getPageScale(),o.needMouseUp,(function(){o.needMouseUp=!1}))))})))})),S()(m()(o),"handleMouseUp",(function(e){var t,i;if(o.checkIsDoMouseAction()){if(null===(t=o.getAppService().editableServiceLayer)||void 0===t||null===(i=t.selectedAnims)||void 0===i||i.clear(),1===e.nativeEvent.which&&o.handleActionEnd(e),!o.hasEditorRegisterDocumentMouseUp){var n=o.getAppService().editableServiceLayer||{},r=n.formatBrushManager,a=n.animBrushManager;null!=a&&a.animBrushState?a.onElementSelectionMouseUp():null!=r&&r.formatBrushState&&(null==r||r.onElementSelectionMouseUp())}o.mouseMove||dispatchEvent(new Event("changeIframeEvent")),o.mouseMove=!1,o.mouseDown=!1}})),S()(m()(o),"handleActionEnd",(function(e){o.factoryOptions.isGroupChildren?o.pcMobileCommonLogic.findRootGroupMouseUp(e,o.factoryOptions.model):o.needMouseUp&&(o.factoryOptions.model.selected?o.getSelectionService().selectedElements.remove(o.factoryOptions.model):o.getSelectionService().selectedElements.add(o.factoryOptions.model),o.needMouseUp=!1)})),S()(m()(o),"isSpecialKey",(function(e){return e.metaKey||e.shiftKey||e.ctrlKey})),S()(m()(o),"isSubGroup",(function(){return o.factoryOptions.model.type===g.d.GROUP&&o.factoryOptions.isGroupChildren})),S()(m()(o),"checkIsDoMouseAction",(function(){return Object(U.a)(o.factoryOptions.model)&&(!W.a.isMobile||W.a.isIpadAndTencentDocApp)&&!o.isSubGroup()})),S()(m()(o),"handleMouseMove",(function(){Object(U.a)(o.factoryOptions.model)&&(!W.a.isMobile||W.a.isIpadAndTencentDocApp)&&o.mouseDown&&(o.mouseMove=!0)})),S()(m()(o),"linkInReadOnlyJump",(function(){var e=o.factoryOptions.model||{},t=e.type,i=e.currentEditState,n=e.props,r=e.key;if([g.d.SHAPE,g.d.IMAGE].includes(t)&&(null==n||!n.addon)&&i!==X.b.EDITABLE){var a,l,s=null===(a=n.link)||void 0===a?void 0:a.href;if(s?o.getAppService().viewableServiceLayer.linkManager.getLinkUrlWithData(s):void 0)null===(l=o.getMenuManager())||void 0===l||l.event.emit(Z.a.LINK_CLICK,r)}})),S()(m()(o),"handleClick",(function(){o.linkInReadOnlyJump()})),S()(m()(o),"handleDoubleClick",(function(e){null==e||e.stopPropagation(),!Object(Y.k)()&&o.getUserPriviledgeService().pptEditorState>X.b.EDITABLE&&o.getAppService().viewableServiceLayer.tipsManager.showCannotEditTips()})),S()(m()(o),"handleMouseEnter",(function(){var e,t=o.factoryOptions.region,i=o.factoryOptions.model,n=i.type,r=i.selected,a=i.key;[g.d.SHAPE,g.d.IMAGE].includes(n)&&r&&t===_.s.CANVAS&&(null===(e=o.getMenuManager())||void 0===e||e.event.emit(Z.a.ENTER_ELEMENT,a))})),S()(m()(o),"handleMouseLeave",(function(){var e,t=o.factoryOptions.region,i=o.factoryOptions.model,n=i.type,r=i.selected,a=i.key;[g.d.SHAPE,g.d.IMAGE].includes(n)&&r&&t===_.s.CANVAS&&(null===(e=o.getMenuManager())||void 0===e||e.event.emit(Z.a.LEAVE_ELEMENT,a))})),S()(m()(o),"handleDrop",j()(F.a.mark((function e(){var t,i,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=o.factoryOptions.model).selectable&&(null===(i=o.getAppService().editableServiceLayer)||void 0===i||null===(n=i.copyPasteManager)||void 0===n||n.promise().then((function(e){e.savedDropModel=t})));case 2:case"end":return e.stop()}}),e)})))),S()(m()(o),"addStoreStateListener",(function(){o.reactionDisposers.push(Object(x.r)((function(){var e,t,i,n;return[o.getAppService().viewableServiceLayer.editingStateManager.insertState,null===(e=o.getAppService().editableServiceLayer)||void 0===e||null===(t=e.formatBrushManager)||void 0===t?void 0:t.formatBrushState,null===(i=o.getAppService().editableServiceLayer)||void 0===i||null===(n=i.animBrushManager)||void 0===n?void 0:n.animBrushState]}),(function(){o.component.wrapper.updateElementShowAndEventStatus()})))})),S()(m()(o),"addShapeLinkFlagListener",(function(){var e;null!==(e=o.component.inner)&&void 0!==e&&e.shapeLinkFlagComponent&&(o.flagEventsInstance=new V.a(o.component.inner.shapeLinkFlagComponent),o.component.inner.shapeLinkFlagComponent.flagGraphics&&o.flagEventsInstance.registerFlagAboutEvents())})),S()(m()(o),"reportOnSelect",(function(e){if(o.factoryOptions.model.currentEditState===X.b.EDITABLE){var t="";e.type===g.d.SHAPE&&(t=L.b.CLK_EDIT),e.type===g.d.IMAGE&&(t=L.b.CLK_IMG),e.type===g.d.GROUP&&(t=L.b.CLK_COMBIN),t&&Object(A.c)({opername:L.e.DOC_PPT,module:L.d.PC_OBJ,action:t})}})),o.pcMobileCommonLogic=new q.a(e),o.addStoreStateListener(),o.addShapeLinkFlagListener(),o.component.wrapper.onMouseDown(o.handleMouseDown),o.component.wrapper.onMouseUp(o.handleMouseUp),o.component.wrapper.onMouseMove(o.handleMouseMove),o.component.wrapper.onDoubleClick(o.handleDoubleClick),o.component.wrapper.onClick(o.handleClick),o.component.wrapper.onMouseEnter(o.handleMouseEnter),o.component.wrapper.onMouseLeave(o.handleMouseLeave),o.component.wrapper.onDrop(o.handleDrop),o}return a()(i,[{key:"dispose",value:function(){var e,t;s()(f()(i.prototype),"dispose",this).call(this),null===(e=this.flagEventsInstance)||void 0===e||null===(t=e.cancelAllEvents)||void 0===t||t.call(e)}},{key:"getAppService",value:function(){return Q.a.getInstance().getAppServices()}},{key:"getUserPriviledgeService",value:function(){return this.getAppService().viewableServiceLayer.userPriviledgeService}},{key:"getSelectionService",value:function(){return Q.a.getInstance().getAppServices().viewableServiceLayer.selectionService}},{key:"getMenuManager",value:function(){var e;return null===(e=Q.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.menuManager}},{key:"getAppServices",value:function(){return Q.a.getInstance().getAppServices()}},{key:"selectElement",value:function(e){this.getSelectionService().selectedElements.clear(),this.getSelectionService().selectedElements.add(e),this.getAppService().viewableServiceLayer.editingStateManager.updateElementCropState(!1),this.reportOnSelect(e)}}]),i}(z.a),ee=i("10a677037a"),te=i("83f23a2c67");function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var ne=function(e){d()(i,e);var t=ie(i);function i(e,n){var o;return r()(this,i),o=t.call(this,e,n),S()(m()(o),"editorInitialCursor",o.getComputedCursor()),S()(m()(o),"observeFormatBrushState",(function(){o.reactionDisposers.push(Object(x.r)((function(){var e,t,i,n;return[null===(e=o.getAppService().editableServiceLayer)||void 0===e||null===(t=e.formatBrushManager)||void 0===t?void 0:t.formatBrushState,null===(i=o.getAppService().editableServiceLayer)||void 0===i||null===(n=i.animBrushManager)||void 0===n?void 0:n.animBrushState]}),(function(){o.updateTextEditorCursor()})))})),S()(m()(o),"handleUnHighlightSearchResult",(function(){var e,t,i=null===(e=o.getAppService().editableServiceLayer)||void 0===e||null===(t=e.searchReplaceManager)||void 0===t?void 0:t.dangerousInstance,n=o.getCurrentComponentSearchResult();if(n&&i){var r,a,l=i.keyword,s=i.lastHighlightPosition,c=(null==s?void 0:s.component)===o.factoryOptions.model.sdkData;null===(r=(a=o).renderSearchHighlight)||void 0===r||r.call(a,{searchResult:n.result,keyword:l,highlightResult:c?n.result[s.offset]:void 0})}})),S()(m()(o),"getCurrentComponentSearchResult",(function(){var e,t,i=null===(e=o.getAppService().editableServiceLayer)||void 0===e||null===(t=e.searchReplaceManager)||void 0===t?void 0:t.dangerousInstance;if(i){var n=i.currentPageResult,r=i.isSearchingFlag;if(n&&r)return i.currentPageResult.find((function(e){return e.component===o.factoryOptions.model.sdkData}))}})),o.bindLogicHandlers(),o.observeFormatBrushState(),o.handleUnHighlightSearchResult(),o}return a()(i,[{key:"handleEditorMouseDown",value:function(e){this.hasEditorRegisterDocumentMouseUp=!0}},{key:"handleEditorMouseUp",value:function(){var e;this.hasEditorRegisterDocumentMouseUp=!1;var t=null===(e=this.getAppService().editableServiceLayer)||void 0===e?void 0:e.formatBrushManager;null==t||t.onElementSelectionMouseUp()}},{key:"getComputedCursor",value:function(){var e,t,i,n=null===(e=this.getAppService().editableServiceLayer)||void 0===e||null===(t=e.formatBrushManager)||void 0===t?void 0:t.formatBrushState,r=null===(i=this.getAppService().editableServiceLayer)||void 0===i?void 0:i.animBrushManager.animBrushState;return r?(this.factoryOptions.model||{}).uniqueID===r.originElId||r.allMediaEffect?"text":Object(te.a)(!1):null!=n&&n.data?Object(te.a)((null==n?void 0:n.data)===ee.a):"text"}},{key:"bindLogicHandlers",value:function(){this.handleEditorMouseDown=this.handleEditorMouseDown.bind(this),this.handleEditorMouseUp=this.handleEditorMouseUp.bind(this)}},{key:"updateTextEditorCursor",value:function(){var e,t,i=this.getComputedCursor();null===(e=(t=this.component.inner).updateTextEditorCursor)||void 0===e||e.call(t,i)}}]),i}($),re=i("df124d1fa9"),oe=i("5693a1ecb5"),ae=i("ee6bb53310"),le=i.n(ae),se=i("2d47c066fb"),ce=i("b684da8955"),de=i("c9c92622ff"),ue=i("580eefa367"),he=i("d1428876ce"),ve=i("477433b002"),fe=i("b34fb607c4");function pe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ge(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(i),!0).forEach((function(t){S()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):pe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var me,be=function(e){d()(i,e);var t=ye(i);function i(e,n){var o,a;r()(this,i),a=t.call(this,e,n),S()(m()(a),"selectedListener",void 0),S()(m()(a),"iframePosterListener",void 0),S()(m()(a),"mediaManager",void 0),S()(m()(a),"setResize",void 0),S()(m()(a),"selectedOff",void 0),S()(m()(a),"selectElementChangeReaction",void 0),S()(m()(a),"previewReaction",void 0),S()(m()(a),"resizingReaction",void 0),S()(m()(a),"controlPointReaction",void 0),S()(m()(a),"isEditorFocus",!1),S()(m()(a),"autoFocus",void 0),S()(m()(a),"debouncedInnerMouseMove",void 0),S()(m()(a),"size",void 0),S()(m()(a),"getEditorProps",(function(){return a.factoryOptions.isEditable?a.getEditableProps():{onMouseDown:a.handleEditorMouseDown}})),S()(m()(a),"handlePlaceHolderClick",(function(e,t){switch(e){case B.a.TXT:case B.a.BLANK:Object(fe.a)(t)||a.enterEditor(t,"placeholder")}})),S()(m()(a),"handleEditorMouseDown",(function(e){s()((o=m()(a),f()(i.prototype)),"handleEditorMouseDown",o).call(o,e),a.component.inner.is3DShape()&&a.component.inner.updateComponent();var t=a.factoryOptions.model,n=a.getSelectionService().selectedElements.selectedArray;null!=t&&t.selected&&1===(null==n?void 0:n.length)||a.makeElementSelected(e)})),S()(m()(a),"setResizeValue",(function(e){a.component.inner.setShouldRender3D(!e),a.setResize=e})),S()(m()(a),"updateResizevalue",(function(){var e,t=a.factoryOptions.model,i=t.props.style,n=i.width,r=i.height,o=i.controlValues;a.size.width===n&&a.size.height===r||(a.size.width=n,a.size.height=r,a.setResizeValue(!0),t.pathParser.update(ge(ge({},t.pathParser.model),{},{width:n,height:r})));var l=(null!==(e=null==o?void 0:o.length)&&void 0!==e?e:0)>0?o:t.pathParser.getDefaultControlValues();Object(ue.e)(l,t.pathParser.controlValues)||(t.pathParser.updateControlValues(l),a.setResizeValue(!1)),t.undoRedo&&a.setResizeValue(!0)})),S()(m()(a),"showNotEditTips",(function(e){a.getUserPriviledgeService().pptEditorState>X.b.EDITABLE&&(a.getAppService().viewableServiceLayer.tipsManager.showCannotEditTips(),null==e||e())})),S()(m()(a),"handleInnerMouseMove",(function(e){var t,i,n,r=a.factoryOptions.model;!Object(de.o)(r)||null!==(t=a.mediaManager)&&void 0!==t&&t.isShowIframe||(null===(i=a.mediaManager)||void 0===i||i.resetIframeSelectedState(),a.factoryOptions.model.selected&&(null===(n=a.mediaManager)||void 0===n||n.updateIframeSelectState(!0)))})),S()(m()(a),"handleInnerMouseUp",(function(e){var t,i=a.factoryOptions.model;e.nativeEvent.button!==re.a.RIGHT&&(Object(de.o)(i)&&(null===(t=a.mediaManager)||void 0===t||t.updateIframeSelectState(!0)))})),S()(m()(a),"handleInnerMouseLeave",(function(){var e=a.factoryOptions.model;Object(de.o)(e)&&a.debouncedInnerMouseMove.cancel()})),S()(m()(a),"handleInnerClick",(function(e){var t,i;null!==(t=e.target)&&void 0!==t&&t.id.includes(se.i)&&a.ifCanSetReadyEditing()&&(null===(i=a.textEditor)||void 0===i||i.setReadyEditing())})),S()(m()(a),"handleInnerDoubleClick",(function(e){var t;a.factoryOptions.isEditable&&(null==e||e.stopPropagation(),null!==(t=a.textEditor)&&void 0!==t&&t.isEditing||a.enterEditor(e));a.showNotEditTips((function(){null==e||e.stopPropagation()}))})),S()(m()(a),"handleInnerMousedown",(function(e){e.preventDefault()})),S()(m()(a),"getEditableProps",(function(){var e,t=a.factoryOptions,i=t.model,n=t.fromScale,r=t.modelParams,o=t.anim,l=!!n||(null==r||null===(e=r.updateState)||void 0===e?void 0:e.editorShouldUpdate);return{shouldUpdate:!(null==o||!o.needUpdateFont)||l,cursor:a.getComputedCursor(),selected:i.selected,editable:!0,levelChangeLock:a.getLevelChangeLock(),onChange:a.handleChange,onBeforeValueChange:a.beforeEditorValueChange,handleSelectionChange:a.handleSelectionChange,onTextChange:a.handleTextChange,onStyleChange:a.handleEditorStyleChange,onEnterEditing:a.handleEnterEditing,onExitEditing:a.handleExitEditing,resetShouldUpdate:function(){n||le()(r,"updateState.editorShouldUpdate",!1)},onMouseUp:a.handleEditorMouseUp,onMouseDown:a.handleEditorMouseDown}})),S()(m()(a),"handleChange",(function(e){Object(R.b)((function(){var t=e.paragraphList,i=e.textBodyStyle,n=a.factoryOptions.model,r=t;if(n.isPlaceholder&&(r=Object(oe.c)(n,r)),n.isPlFromMasterOrLayout){var o=Object(w.h)(n),l=!Object(w.o)(r)&&!Object(w.n)(r,o);n.updateMasterAndLayoutPlaceHolder(r,i,l)}else null==n||n.updateParagraphList(r,i)}))})),S()(m()(a),"beforeEditorValueChange",(function(){var e=a.factoryOptions,t=e.textSelectionUndoRedo,i=e.model;null==t||t.clearRedo(),null==t||t.stashSelectionBefore(a.textEditor.getSelection(),i.id)})),S()(m()(a),"handleSelectionChange",(function(){var e=a.factoryOptions,t=e.textSelectionUndoRedo,i=e.model;a.textEditor&&(null==t||t.stashSelectionAfter(a.textEditor.getSelection(),i.id))})),S()(m()(a),"handleTextChange",(function(e){var t,i,n,r,o=e.height,l=e.width;a.component.inner.is3DShape()&&a.component.inner.updateComponent();var s=a.factoryOptions.model;if(a.component.inner.isRenderPlaceholderComponent&&a.component.inner.renderEditor(),a.getAppService().viewableServiceLayer.textEditorStateService.editorContentChangeFlag+=1,a.overCanvasSize(),window.dispatchEvent(new Event(he.a)),(null===(t=s.textBodyStyle)||void 0===t?void 0:t.autoFitType)===D.a.SHAPE_AUTO_FIT){var c=null===(i=s.textBodyStyle)||void 0===i||null===(n=i.wrapperStyle)||void 0===n?void 0:n.textDirection,d=a.getDisplayStyle(o,l,c),u=d.displayInlineSize,h=d.displayBlockSize;T.a.getInstance().updateShapeStyleForUI(s,h,u),null===(r=a.getBorderSketchManager())||void 0===r||r.updatePathListUIWhenSizeChange(a.factoryOptions.model,{width:a.factoryOptions.model.props.style.width,height:a.factoryOptions.model.props.style.height})}})),S()(m()(a),"overCanvasSize",(function(){var e=a.component.wrapper,t=e.app,i=e.worldBounds,n=i.x,r=i.y,o=i.width,l=i.height;t&&(t.width<n+o||t.height<r+l)&&window.dispatchEvent(new Event("immediately-resize"))})),S()(m()(a),"handleEditorStyleChange",(function(e){var t=a.factoryOptions,i=t.model;!t.fromScale&&i&&(i.selectionStyles=e.style)})),S()(m()(a),"enterEditor",(function(e,t){var i;a.isEditorFocus=!0,a.makeElementSelected(e,"placeholder"===t),a.component.inner.renderEditor(),null===(i=a.textEditor)||void 0===i||i.setFocus(void 0,e)})),S()(m()(a),"handleExitEditing",(function(){if(a.component.inner.is3DShape()&&(a.component.inner.setShouldRender3D(!0),a.component.inner.updateComponent()),a.isEditorFocus){var e=a.component.inner;a.isEditorFocus=!1,e.renderEditor(),e.isRenderPlaceholderComponent&&e.isPlaceholderTextEditable&&!a.textEditor&&a.ifCanSetReadyEditing()&&(e.renderTempEditor(),a.textEditor&&a.textEditor.setReadyEditing())}window.dispatchEvent(new Event("exitEditing"))})),S()(m()(a),"handleEnterEditing",(function(){a.component.inner.is3DShape()&&(a.component.inner.setShouldRender3D(!1),a.component.inner.updateComponent()),a.component.inner.isRenderPlaceholderComponent&&a.component.inner.renderEditor(),window.dispatchEvent(new Event("enterEditing"))})),S()(m()(a),"updateElementFocus",(function(){a.autoFocus&&requestAnimationFrame(a.initFocus)})),S()(m()(a),"initFocus",(function(){var e=a.factoryOptions,t=e.model,i=e.fromScale;null!=t&&t.initFocus&&!i&&(a.triggerFocus(),null!=t&&t.initFocus&&(t.initFocus=!1))})),S()(m()(a),"triggerFocus",(function(){var e;a.factoryOptions.isEditable&&(null===(e=a.textEditor)||void 0===e||e.setFocus());a.showNotEditTips()})),S()(m()(a),"checkIfNeedDeleteText",(function(){var e,t,i,n=a.factoryOptions.model;(null==n?void 0:n.currentEditState)===X.b.EDITABLE&&(1!==n.props.subType||n.selected||Object(O.g)(n)&&(null===(e=a.getSelectionService())||void 0===e||null===(t=e.selectedWithCommit)||void 0===t||t.markSpecialOperate(ve.a.keep),null===(i=n.soruceRefForUI)||void 0===i||i.deleteElement([n])))})),S()(m()(a),"makeElementSelected",(function(e,t){var i,n=a.factoryOptions.model;null===(i=a.getAppService().editableServiceLayer)||void 0===i||i.selectedAnims.clear();var r=null;Object(ce.c)(n,(function(e){r=e}));var o=a.getSelectionService().selectedElements.selectedArrayForType(K.a.SLIDE);Object(x.w)((function(){Object(fe.a)(e)?null===r?a.addSelectElement():r.selected?a.addWithElementSelected(o,r):a.clearAndAddGroupSelected(r):a.setElementSelected(r,t)}))})),S()(m()(a),"addSelectElement",(function(){var e=a.factoryOptions.model;a.getSelectionService().selectedElements.clear(K.a.GROUP),e.selectable&&!e.selected&&a.getSelectionService().selectedElements.add(e),a.triggerEditorBlur()})),S()(m()(a),"addWithElementSelected",(function(e,t){var i=a.factoryOptions.model;1===e.length?(null==i||!i.selectable||null!=i&&i.selected||a.getSelectionService().selectedElements.add(i),a.triggerEditorBlur()):(a.getSelectionService().selectedElements.remove(t),a.triggerEditorBlur())})),S()(m()(a),"clearAndAddGroupSelected",(function(e){a.getSelectionService().selectedElements.clear(K.a.GROUP);var t=a.getSelectionService().selectedElements.selectedArrayForType(K.a.SLIDE);e&&-1===t.indexOf(e)&&a.getSelectionService().selectedElements.add(e),a.triggerEditorBlur()})),S()(m()(a),"triggerEditorBlur",(function(){var e;null===(e=a.textEditor)||void 0===e||e.triggerBlur()})),S()(m()(a),"setElementSelected",(function(e,t){var i=a.factoryOptions.model,n=null==i?void 0:i.selected;a.getSelectionService().selectedElements.clear(),a.getSelectionService().selectedElements.add(i);var r=a.getSelectionService().selectedElements.selectedArrayForType(K.a.SLIDE);if(e&&-1===r.indexOf(e)&&a.getSelectionService().selectedElements.add(e),null!=i&&i.selectable&&!n&&!t){var o=!1;Object(ce.c)(i,(function(){return o=!0,!0})),o||Object(A.c)({opername:L.e.DOC_PPT,module:L.d.PC_OBJ,action:L.b.CLK_EDIT})}})),S()(m()(a),"addSelectedListener",(function(){var e=a.factoryOptions.model;e.selected&&a.handleModelSelected(),a.selectedListener=Object(x.r)((function(){return e.selected}),(function(e){e?a.handleModelSelected():a.handleModelUnSelected()}))})),S()(m()(a),"handleModelSelected",(function(){var e,t,i;null===(e=a.mediaManager)||void 0===e||e.updateElementKey(a.factoryOptions.model.key),null===(t=a.mediaManager)||void 0===t||t.resetIframeSelectedState(),null===(i=a.mediaManager)||void 0===i||i.updateIframeSelectState(!0)})),S()(m()(a),"handleModelUnSelected",(function(){var e,t;null===(e=a.mediaManager)||void 0===e||e.resetIframeSelectedState(),null===(t=a.mediaManager)||void 0===t||t.updateElementKey("")})),S()(m()(a),"addIframePosterListener",(function(){var e=a.factoryOptions.model;a.iframePosterListener=Object(x.y)((function(){var t;return!k()(null===(t=a.mediaManager)||void 0===t?void 0:t.iframePosterCaches.get(e.key))}),(function(){a.component.updateComponent()}))})),S()(m()(a),"getLevelChangeLock",(function(){var e,t=a.factoryOptions.model;if(!t.isPlaceholder)return!1;var i=null===(e=t.placeHolder)||void 0===e?void 0:e.type;return i===B.a.TITLE||i===B.a.CTRTITLE})),a.mediaManager=e.mediaManager,a.debouncedInnerMouseMove=E()(a.handleInnerMouseMove,300),a.component.inner.onMouseDown(a.handleInnerMousedown),a.component.inner.onMouseMove(a.debouncedInnerMouseMove),a.component.inner.onMouseUp(a.handleInnerMouseUp),a.component.inner.onMouseLeave(a.handleInnerMouseLeave),a.component.inner.onDoubleClick(a.handleInnerDoubleClick),a.component.inner.onClick(a.handleInnerClick);var l=a.factoryOptions.model;a.addAllObservers(),a.autoFocus=!W.a.isMobile,Object(de.o)(l)&&(a.addSelectedListener(),a.addIframePosterListener());var c=l.props.style,d=c.width,u=c.height;return a.size={width:d,height:u},a}return a()(i,[{key:"init",value:function(){s()(f()(i.prototype),"init",this).call(this),this.component.inner.renderEditor(),this.updateElementFocus()}},{key:"dispose",value:function(){this.removeAllObservers()}},{key:"renderSearchHighlight",value:function(e){var t,i,n=e.searchResult,r=e.highlightResult,o=e.keyword;(null===(t=this.component.inner.textEditor)||void 0===t||t.addSearchMark(n,o),r)&&(null===(i=this.component.inner.textEditor)||void 0===i||i.addHighlight([r],o))}},{key:"ifCanSetReadyEditing",value:function(){var e=this.factoryOptions,t=e.model,i=e.fromScale,n=this.getSelectionService().selectedElements.selectedArray;return!i&&1===(null==n?void 0:n.length)&&t.selected}},{key:"addAllObservers",value:function(){var e=this;if(0===this.factoryOptions.fromScale){var t=this.factoryOptions.model;this.selectedOff=Object(x.r)((function(){var t;return{selected:null===(t=e.factoryOptions.model)||void 0===t?void 0:t.selected}}),(function(t){t.selected?e.handleElementSelected():(e.handleElementUnSelected(),e.checkIfNeedDeleteText())})),this.selectElementChangeReaction=Object(x.r)((function(){return{selectedArray:e.getSelectionService().selectedElements.selectedArray}}),(function(i){var n,r,o,a;(null===(n=i.selectedArray)||void 0===n?void 0:n.length)>1&&t.selected&&(null!==(r=e.textEditor)&&void 0!==r&&r.isEditing||null!==(o=e.textEditor)&&void 0!==o&&o.isReadyEditing)&&(null===(a=e.textEditor)||void 0===a||a.triggerBlur());e.handleSelectedArrayChange()})),this.resizingReaction=Object(x.r)((function(){return e.getAppService().viewableServiceLayer.editingStateManager.isResizing}),(function(t){e.component.inner.setShouldRender3D(!t),t||(e.setResize=!0)})),this.controlPointReaction=Object(x.r)((function(){return e.factoryOptions.model.operatingGraphicInfo}),(function(t){e.component.inner.setShouldRender3D(!t)}))}this.addPreviewObserver()}},{key:"handleSelectedArrayChange",value:function(){var e,t=this.ifCanSetReadyEditing(),i=this.component.inner;t&&i.isPlaceHolderShow&&i.isPlaceholderTextEditable?i.renderTempEditor():i.showTempTextEditor&&i.clearTempEditor(),!t||!this.textEditor||null!==(e=this.textEditor)&&void 0!==e&&e.isEditing||this.textEditor.setReadyEditing()}},{key:"removeAllObservers",value:function(){var e,t,i,n;null===(e=this.selectedOff)||void 0===e||e.call(this),null===(t=this.selectElementChangeReaction)||void 0===t||t.call(this),this.removePreviewObserver(),null===(i=this.resizingReaction)||void 0===i||i.call(this),null===(n=this.controlPointReaction)||void 0===n||n.call(this)}},{key:"addPreviewObserver",value:function(){var e=this;this.factoryOptions.fromScale||(this.previewReaction=Object(x.r)((function(){var t,i,n;return e.factoryOptions.model.selected&&((null===(t=e.getAppService().viewableServiceLayer)||void 0===t||null===(i=t.getEditorAnimPreviewManager())||void 0===i?void 0:i.isAnimPreviewing)||(null===(n=e.getAppService().editableServiceLayer)||void 0===n?void 0:n.previewService.isPreview))}),(function(t){t&&e.handleElementUnSelected()})))}},{key:"removePreviewObserver",value:function(){var e;null===(e=this.previewReaction)||void 0===e||e.call(this)}},{key:"handleElementSelected",value:function(){}},{key:"handleElementUnSelected",value:function(){var e;null===(e=this.textEditor)||void 0===e||e.triggerBlur()}},{key:"textEditor",get:function(){return this.component.inner.textEditor}},{key:"getDisplayStyle",value:function(e,t,i){var n,r,o=this.factoryOptions.model,a=Object(P.b)(i),l=Object(P.a)(i);a?(n=e,r=t):(n=t,r=e);var s=Object(I.b)(o,o.pathParser,o.props.style),c=r;return{displayInlineSize:n?T.a.getInstance().getDisplayInlineSize(o,n,s,null,i):o.props.style[l.inlineSize],displayBlockSize:c}}},{key:"getBorderSketchManager",value:function(){var e;return null===(e=Q.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.borderSketchManager}}]),i}(ne),Se=i("862b984676"),Me=i("d7a2286b24"),Ee=i("4e7af1026b");function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var ke=null===(me=Me.default.getInstance().getConfig(Ee.k.insertLatex))||void 0===me||me,we=function(e){d()(i,e);var t=Ce(i);function i(e,n){var o;r()(this,i),o=t.call(this,e,n),S()(m()(o),"selectedListener",void 0),S()(m()(o),"videoPosterListener",void 0),S()(m()(o),"renderGifPosterListener",void 0),S()(m()(o),"mediaManager",void 0),S()(m()(o),"rightSideBarManager",void 0),S()(m()(o),"isVideoSelected",!1),S()(m()(o),"isAudioSelected",!1),S()(m()(o),"handleInnerClick",(function(){var e=o.factoryOptions.model;if(Object(de.G)(e)){var t;if(o.isVideoSelected)null===(t=o.mediaManager)||void 0===t||t.playVideoByRegion(e.key,Se.a.EDITOR);o.isVideoSelected=!0}if(Object(de.f)(e)){var i;if(o.isAudioSelected)null===(i=o.mediaManager)||void 0===i||i.playAudioByRegion(e.key,Se.a.EDITOR);o.isAudioSelected=!0}})),S()(m()(o),"handleInnerDoubleClick",(function(e){if(!Object(de.w)(o.factoryOptions.model))if(o.getUserPriviledgeService().pptEditorState===X.b.EDITABLE){var t,i;null==e||e.stopPropagation();var n,r,a,l=o.factoryOptions.model.props.addon||{},s=l.type,c=l.aid,d=o.getAddonManager(),u=(null==d||null===(t=d.addonHandler)||void 0===t||null===(i=t.addonQuickItemsMap)||void 0===i?void 0:i.get(null!=c?c:""))||["editAddon"];if(ke&&"latex"===s&&u&&-1!==u.indexOf("editAddon"))null===(n=o.rightSideBarManager)||void 0===n||n.setIsPropertyEditorShown(!1),null===(r=o.getMenuManager())||void 0===r||r.actionReplaceLatex();else null===(a=o.rightSideBarManager)||void 0===a||a.setPropertyEditorShowAction(_.q.DOUBLE_CLICK_TOOGLE);o.getAppService().viewableServiceLayer.rightSideBarService.hide()}else o.getAppService().viewableServiceLayer.tipsManager.showCannotEditTips()})),S()(m()(o),"addSelectedListener",(function(){var e=o.factoryOptions.model;o.selectedListener=Object(x.r)((function(){return e.selected}),(function(e){e||o.handleModelUnSelected()}))})),S()(m()(o),"handleModelUnSelected",(function(){var e,t,i=o.factoryOptions.model;Object(de.G)(i)&&(null===(e=o.mediaManager)||void 0===e||e.pauseVideoByRegion(i.key,Se.a.EDITOR));Object(de.f)(i)&&(null===(t=o.mediaManager)||void 0===t||t.resetAudioByRegion(i.key,Se.a.EDITOR));o.isVideoSelected=!1,o.isAudioSelected=!1})),S()(m()(o),"addRenderGifPosterListener",(function(){var e=o.factoryOptions.model;o.renderGifPosterListener=Object(x.r)((function(){var t;return null===(t=o.mediaManager)||void 0===t?void 0:t.shouldRenderGifPoster(e.key)}),(function(){Object(de.l)(e)&&o.factoryOptions.region===_.s.CANVAS&&o.component.updateComponent()}))}));var a=o.factoryOptions.model;return o.mediaManager=e.mediaManager,o.rightSideBarManager=e.rightSideBarManager,o.component.inner.onClick(o.handleInnerClick),o.component.inner.onDoubleClick(o.handleInnerDoubleClick),Object(de.w)(a)&&o.addSelectedListener(),o.addRenderGifPosterListener(),o}return a()(i,[{key:"dispose",value:function(){var e;s()(f()(i.prototype),"dispose",this).call(this);var t=this.factoryOptions,n=t.model,r=t.mediaManager;Object(de.G)(n)&&(null==r||r.deleteVideoInstanceByRegion(n.key,Se.a.EDITOR)),Object(de.f)(n)&&(null==r||r.deleteAudioInstanceByRegion(n.key,Se.a.EDITOR)),null===(e=this.renderGifPosterListener)||void 0===e||e.call(this)}},{key:"getAddonManager",value:function(){return this.getAppService().viewableServiceLayer.addonManager}}]),i}($);function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var xe,Oe=function(e){d()(i,e);var t=Ie(i);function i(e,n){var o;return r()(this,i),o=t.call(this,e,n),S()(m()(o),"rightSideBarManager",void 0),S()(m()(o),"rightSideBarService",void 0),S()(m()(o),"handleInnerDoubleClick",(function(e){var t,i;o.factoryOptions.isEditable&&(null==e||e.stopPropagation(),null===(t=o.rightSideBarManager)||void 0===t||t.setPropertyEditorShowAction(_.q.DOUBLE_CLICK_TOOGLE),null===(i=o.rightSideBarService)||void 0===i||i.hide())})),o.rightSideBarManager=e.rightSideBarManager,o.component.inner.onDoubleClick(o.handleInnerDoubleClick),o}return i}($),Ae=i("e5cbb41a81"),Le=i("43dffc9bd2"),Re=(i("22569efd03"),i("7a3400cab1"),i("8e7cce0ada"),i("29f8c5f672"),i("85d48ef22b"),i("2a6f332b5e"),i("8aebbf296a"),i("4bbb5840d5"),i("405b4a5e2b"),i("63513d8b56"),i("3bf1976a4f"),i("af802ec74b"),i("516fa97df2")),De=i("529ab84664"),Te=i("81758a57a2"),Pe=i("0c9000b818");function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}!function(e){e.col="col",e.row="row"}(xe||(xe={}));var Ge=function(e){d()(i,e);var t=Be(i);function i(e){var n;return r()(this,i),n=t.call(this),S()(m()(n),"cachedResizeBorders",void 0),S()(m()(n),"resizeIndicator",void 0),S()(m()(n),"selectedItem",void 0),S()(m()(n),"beginX",0),S()(m()(n),"beginY",0),S()(m()(n),"offset",0),S()(m()(n),"clickType",void 0),S()(m()(n),"isMoving",!1),S()(m()(n),"componentAppendAfter",(function(e,t){var i=Object(Pe.a)(t),n=null==i?void 0:i.parent;if(n){var r=n.children.findIndex((function(e){return e===i}));n.addChildAt(e,r+1)}})),S()(m()(n),"makeResizeIndicator",(function(e){var t=n.factoryOptions.getPageScale(),i=n.factoryOptions.model.props.style,r=i.height,o=i.width,a=new Re.k;a=Object(Te.b)(a,n.factoryOptions);var l=new Re.N;return l.stroke=new Re.i(Re.h.fromHex("#cccccc")),l.strokeWidth=1/t,l.cursor=e===xe.row?De.b:De.a,l.path=e===xe.row?"M 0 0 L ".concat(o," 0"):"M 0 0 L 0 ".concat(r),e===xe.row?l.y=n.selectedItem.top:l.x=n.selectedItem.left,a.addChild(l),a})),S()(m()(n),"colResizeMouseDown",(function(e){n.factoryOptions.isEditable&&(n.factoryOptions.editingStateManager&&(n.factoryOptions.editingStateManager.needDisableIframeEvent=!0),window.addEventListener("mousemove",n.handleMouseMove),window.addEventListener("mouseup",n.handleMouseUp),n.handleSelectTable(e),n.beginX=e.nativeEvent.clientX,n.selectedItem=e.target.item,n.clickType=xe.col)})),S()(m()(n),"rowResizeMouseDown",(function(e){n.factoryOptions.isEditable&&(n.factoryOptions.editingStateManager&&(n.factoryOptions.editingStateManager.needDisableIframeEvent=!0),window.addEventListener("mousemove",n.handleMouseMove),window.addEventListener("mouseup",n.handleMouseUp),n.handleSelectTable(e),n.beginY=e.nativeEvent.clientY,n.selectedItem=e.target.item,n.clickType=xe.row)})),S()(m()(n),"colIndicatorMove",(function(e){var t,i,r=n.factoryOptions.getPageScale(),o=n.factoryOptions.model.props.colWidths,a=parseInt(n.selectedItem.key.substring(n.selectedItem.key.indexOf("col")+3),10),l=Math.max(0,a-1),s=o[l],c=o[l+1],d=e.clientX-n.beginX;if(0===a)d=Math.min(d,(s-40)*r),n.offset=-d;else if(a===o.length)d=Math.max(d,-(s-40)*r),n.offset=d;else{var u=-(s-40)*r,h=(c-40)*r;d=Math.min(h,Math.max(d,u)),n.offset=d}null!==(t=n.resizeIndicator)&&void 0!==t&&null!==(i=t.children)&&void 0!==i&&i[0]&&(n.resizeIndicator.children[0].x=n.selectedItem.left+d/r)})),S()(m()(n),"rowIndicatorMove",(function(e){var t,i,r=n.factoryOptions.getPageScale(),o=n.selectedItem.key.indexOf("row")+3,a=n.selectedItem.key.indexOf("col"),l=parseInt(n.selectedItem.key.substring(o,a),10)-1,s=n.factoryOptions.model.displayRowHeights[Math.max(0,l)],c=e.clientY-n.beginY;l<0?(c=Math.min(c,(s-20)*r),n.offset=-c):(c=Math.max(c,-(s-20)*r),n.offset=c),null!==(t=n.resizeIndicator)&&void 0!==t&&null!==(i=t.children)&&void 0!==i&&i[0]&&(n.resizeIndicator.children[0].y=n.selectedItem.top+c/r)})),S()(m()(n),"handleMouseMove",(function(e){n.isMoving||(n.isMoving=!0,n.showIndicator()),n.selectedItem&&n.resizeIndicator&&(n.clickType===xe.col?n.colIndicatorMove(e):n.clickType===xe.row&&n.rowIndicatorMove(e))})),S()(m()(n),"handleMouseUp",(function(){var e;n.factoryOptions.editingStateManager&&(n.factoryOptions.editingStateManager.needDisableIframeEvent=!1),null===(e=n.factoryOptions.editingStateManager)||void 0===e||e.updateTableRowColResizeState(!1),window.removeEventListener("mousemove",n.handleMouseMove),window.removeEventListener("mouseup",n.handleMouseUp);var t,i=n.factoryOptions.getPageScale();if(n.resizeIndicator&&(null===(t=n.resizeIndicator.parent)||void 0===t||t.removeChild(n.resizeIndicator),n.resizeIndicator.dispose(),n.resizeIndicator=null,Math.abs(n.offset)>=1))if(n.clickType===xe.col){var r=n.factoryOptions.model.props.colWidths,o=n.selectedItem.key.indexOf("col")+3,a=parseInt(n.selectedItem.key.substring(o),10),l=Math.max(0,a-1),s=r[l]+n.offset/i;n.factoryOptions.model.resizeCol(l,s,0===a)}else if(n.clickType===xe.row){var c=n.selectedItem.key.indexOf("row")+3,d=n.selectedItem.key.indexOf("col"),u=parseInt(n.selectedItem.key.substring(c,d),10)-1,h=n.factoryOptions.model.displayRowHeights[Math.max(0,u)]+n.offset/i;n.factoryOptions.model.resizeRow(Math.max(0,u),h,u<0)}n.selectedItem=null,n.beginX=0,n.beginY=0,n.offset=0,n.isMoving=!1,n.clickType=void 0})),S()(m()(n),"handleSelectTable",(function(e){(e.stopPropagation(),e.preventDefault(),Object(Ae.b)(e.nativeEvent))||n.factoryOptions.logicService.getLogic(n.factoryOptions).makeElementSelected(e.nativeEvent)})),n.factoryOptions=e,n.factoryOptions=e,n.cachedResizeBorders=new Map,n}return a()(i,[{key:"updateComponent",value:function(){var e=this,t=new Re.i(Re.h.Transparent),i=this.factoryOptions.getPageScale(),n=this.factoryOptions.model,r=Array.from(this.cachedResizeBorders.keys());for(var o in n.tableBorders)if(Object.prototype.hasOwnProperty.call(n.tableBorders,o)){var a=n.tableBorders[o];o.startsWith("h_border_")?this.addHorizontalBorder(a,t,i,r):o.startsWith("v_border_")&&this.addVerticalBrder(a,t,i,r)}r.forEach((function(t){var i=e.cachedResizeBorders.get(t);i&&(e.removeChild(i),e.cachedResizeBorders.delete(t))}))}},{key:"addHorizontalBorder",value:function(e,t,i,n){var r=this.cachedResizeBorders.get(e.key);r?n.splice(n.indexOf(e.key),1):((r=new Re.N).fill=t,r.onMouseDown(this.rowResizeMouseDown),this.addChild(r),this.cachedResizeBorders.set(e.key,r)),r.cursor=this.factoryOptions.isEditable?De.b:null,r.x=e.left,this.factoryOptions.model.selected?0===e.top?r.y=e.top+3/i:e.top===this.factoryOptions.model.props.style.height?r.y=e.top-9/i:r.y=e.top-3/i:r.y=e.top-3/i,r.path="M 0 0 L ".concat(e.width," 0 L ").concat(e.width," ").concat(6/i," L 0 ").concat(6/i," Z"),Object.assign(r,{item:e})}},{key:"addVerticalBrder",value:function(e,t,i,n){var r=this.cachedResizeBorders.get(e.key);r?n.splice(n.indexOf(e.key),1):((r=new Re.N).fill=t,r.onMouseDown(this.colResizeMouseDown),this.addChild(r),this.cachedResizeBorders.set(e.key,r)),r.cursor=this.factoryOptions.isEditable?De.a:null,this.factoryOptions.model.selected?0===e.left?r.x=e.left+3/i:e.left===this.factoryOptions.model.props.style.width?r.x=e.left-9/i:r.x=e.left-3/i:r.x=e.left-3/i,r.y=e.top,r.path="M 0 0 L ".concat(6/i," 0 L ").concat(6/i," ").concat(e.height," L 0 ").concat(e.height," Z"),Object.assign(r,{item:e})}},{key:"showIndicator",value:function(){var e;null===(e=this.factoryOptions.editingStateManager)||void 0===e||e.updateTableRowColResizeState(!0),this.resizeIndicator||(this.resizeIndicator=this.makeResizeIndicator(this.clickType),this.componentAppendAfter(this.resizeIndicator,this))}}]),i}(Re.k);function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var Ne=function(e){d()(i,e);var t=je(i);function i(e){var n;return r()(this,i),n=t.call(this),S()(m()(n),"cachedSelectors",void 0),S()(m()(n),"topColSelector",void 0),S()(m()(n),"bottomColSelector",void 0),S()(m()(n),"leftRowSelector",void 0),S()(m()(n),"rightRowSelector",void 0),S()(m()(n),"handleSelectCell",(function(e){if(e.stopPropagation(),e.preventDefault(),!Object(Ae.b)(e.nativeEvent)){n.factoryOptions.logicService.getLogic(n.factoryOptions).makeElementSelected(e.nativeEvent);var t=e.target,i=t.row,r=t.col;n.factoryOptions.model.showSelection=!0,n.factoryOptions.model.afterSelection(i,r,i,r)}})),S()(m()(n),"handleColSelectorMouseDown",(function(e){if(n.handleSelectTable(e),e.target===n.topColSelector||e.target===n.bottomColSelector){var t=n.factoryOptions.getPageScale(),i=n.factoryOptions,r=i.logicService,o=i.model,a=r.getLogic(n.factoryOptions).getIndex(o.props.colWidths,(e.worldX-n.worldBounds.x)/t);Object(Ae.b)(e)||(o.showSelection=!0,o.afterSelection(0,a,o.props.rowHeights.length-1,a))}})),S()(m()(n),"handleRowSelectorMouseDown",(function(e){if(n.handleSelectTable(e),e.target===n.leftRowSelector||e.target===n.rightRowSelector){var t=n.factoryOptions.getPageScale(),i=n.factoryOptions,r=i.logicService,o=i.model,a=r.getLogic(n.factoryOptions).getIndex(o.displayRowHeights,(e.worldY-n.worldBounds.y)/t);Object(Ae.b)(e)||(o.showSelection=!0,o.afterSelection(a,0,a,o.props.colWidths.length-1))}})),S()(m()(n),"handleSelectTable",(function(e){(e.stopPropagation(),e.preventDefault(),Object(Ae.b)(e.nativeEvent))||n.factoryOptions.logicService.getLogic(n.factoryOptions).makeElementSelected(e.nativeEvent)})),n.factoryOptions=e,n.cachedSelectors=new Map,n}return a()(i,[{key:"updateComponent",value:function(){var e=this;this.addRowColSelector();var t=this.factoryOptions.model,i=8/this.factoryOptions.getPageScale(),n=Array.from(this.cachedSelectors.keys());t.tableItems.forEach((function(t,r){t.forEach((function(t,o){if(!t.hMerge&&!t.vMerge){var a=t.props.style,l=a.left,s=a.top,c=a.height,d=e.cachedSelectors.get(t.key);d?n.splice(n.indexOf(t.key),1):((d=new Re.N).fill=new Re.i(Re.h.Transparent),d.cursor=De.c,e.addChild(d),d.onMouseDown(e.handleSelectCell),e.cachedSelectors.set(t.key,d)),d.x=l,d.y=s,d.path="M 0 0 L ".concat(i," 0 L ").concat(i," ").concat(c," L 0 ").concat(c," Z"),Object.assign(d,{row:r,col:o})}}))})),n.forEach((function(t){var i=e.cachedSelectors.get(t);i&&(e.removeChild(i),e.cachedSelectors.delete(t))}))}},{key:"addRowColSelector",value:function(){var e=this.factoryOptions.getPageScale(),t=this.factoryOptions.model.props.style,i=t.width,n=t.height,r="M 0 0 L ".concat(i," 0 L ").concat(i," ").concat(10/e," L 0 ").concat(10/e," Z"),o="M 0 0 L ".concat(10/e," 0 L ").concat(10/e," ").concat(n," L 0 ").concat(n," Z"),a=new Re.i(Re.h.Transparent);this.topColSelector||(this.topColSelector=new Re.N,this.topColSelector.fill=a,this.topColSelector.cursor=De.e,this.topColSelector.onMouseDown(this.handleColSelectorMouseDown),this.addChild(this.topColSelector)),this.topColSelector.path=r,this.topColSelector.x=0,this.topColSelector.y=-10/e,this.bottomColSelector||(this.bottomColSelector=new Re.N,this.bottomColSelector.fill=a,this.bottomColSelector.cursor=De.d,this.bottomColSelector.onMouseDown(this.handleColSelectorMouseDown),this.addChild(this.bottomColSelector)),this.bottomColSelector.path=r,this.bottomColSelector.x=0,this.bottomColSelector.y=n,this.leftRowSelector||(this.leftRowSelector=new Re.N,this.leftRowSelector.fill=a,this.leftRowSelector.cursor=De.f,this.leftRowSelector.onMouseDown(this.handleRowSelectorMouseDown),this.addChild(this.leftRowSelector)),this.leftRowSelector.path=o,this.leftRowSelector.x=-10/e,this.leftRowSelector.y=0,this.rightRowSelector||(this.rightRowSelector=new Re.N,this.rightRowSelector.fill=a,this.rightRowSelector.cursor=De.g,this.rightRowSelector.onMouseDown(this.handleRowSelectorMouseDown),this.addChild(this.rightRowSelector)),this.rightRowSelector.path=o,this.rightRowSelector.x=i,this.rightRowSelector.y=0}}]),i}(Re.k);function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var ze=function(e){d()(i,e);var t=Fe(i);function i(e){var n;return r()(this,i),n=t.call(this),S()(m()(n),"cachedSelections",void 0),n.factoryOptions=e,n.factoryOptions=e,n.cachedSelections=new Map,n}return a()(i,[{key:"updateComponent",value:function(){var e=this,t=Array.from(this.cachedSelections.keys()),i=this.factoryOptions.model;i.tableItems.forEach((function(n){n.forEach((function(n){if(!n.hMerge&&!n.vMerge&&i.selectedRange&&i.showSelection&&i.cellSelectedState(n.row,n.col,i.selectedRange)){var r=e.cachedSelections.get(n.key);r?t.splice(t.indexOf(n.key),1):((r=new Re.N).fill=new Re.i(Re.h.fromHex("#60a0f3",.7)),r.pointerEvents=Re.I.NONE,e.addChild(r),e.cachedSelections.set(n.key,r));var o=n.props.style,a=o.left,l=o.top,s=o.width,c=o.height;r.path="M 0 0 L ".concat(s," 0 L ").concat(s," ").concat(c," L 0 ").concat(c," Z"),r.x=a,r.y=l,r.id="".concat(se.u,"-").concat(n.row,"-").concat(n.col)}}))})),t.forEach((function(t){var i=e.cachedSelections.get(t);i&&(e.removeChild(i),e.cachedSelections.delete(t))}))}}]),i}(Re.j),He=i("d1f05b304b"),Ue=i("ec5cae33cb");function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var _e=function(e){d()(i,e);var t=We(i);function i(e,n){var o,a,l;r()(this,i),l=t.call(this,e,n),S()(m()(l),"beginCoord",null),S()(m()(l),"lastCoord",null),S()(m()(l),"shiftKeyBeginCoord",null),S()(m()(l),"config",void 0),S()(m()(l),"cellSelectComponent",null),S()(m()(l),"rowColResizeComponent",null),S()(m()(l),"tableSelectonComponent",void 0),S()(m()(l),"selectedReaction",void 0),S()(m()(l),"selectedRangeReaction",void 0),S()(m()(l),"selectElementChangeReaction",void 0),S()(m()(l),"enableShortCutKey",(function(){Object(Le.b)(l.config)})),S()(m()(l),"disableShortCutKey",(function(){Object(Le.d)(l.config)})),S()(m()(l),"makeElementSelected",(function(e){var t;if(null===(t=l.getAppService().editableServiceLayer)||void 0===t||t.selectedAnims.clear(),l.getSelectionService().lastMouseDownRegion=Ue.a.EDITOR,l.getSelectionService().selectedSlides.clear(),l.getComponent().selectable)if(e&&Object(Ae.b)(e)&&!Object(Ae.a)(e))if(l.getComponent().selected){if(l.getSelectionService().selectedElements.length>1){if(Object(Ae.c)(e))return;l.getSelectionService().selectedElements.remove(l.getComponent())}}else l.getSelectionService().selectedElements.add(l.getComponent());else(!l.getComponent().selected||l.getSelectionService().selectedElements.length>1)&&Object(x.w)((function(){l.getSelectionService().selectedElements.clear(),l.getSelectionService().selectedElements.add(l.getComponent())}))})),S()(m()(l),"handleChangesetObserver",(function(){var e,t,i;null===(e=l.cellSelectComponent)||void 0===e||e.updateComponent(),null===(t=l.rowColResizeComponent)||void 0===t||t.updateComponent(),null===(i=l.tableSelectonComponent)||void 0===i||i.updateComponent()})),S()(m()(l),"handleTableEnterKeyDown",(function(e){l.factoryOptions.model.showSelection&&l.factoryOptions.model.enterFirstSelectedCell()})),S()(m()(l),"handleTableTabKeyDown",(function(e){l.factoryOptions.model.selectNextCell()})),S()(m()(l),"handleTableMouseDown",(function(e){var t=l.factoryOptions.model;if(l.checkCurrentEditable()){var i,n;null===(i=l.getAppService().viewableServiceLayer)||void 0===i||null===(n=i.tipsManager)||void 0===n||n.showCannotEditTips()}else{l.makeElementSelected(e.nativeEvent),e.stopPropagation();var r=l.getCellCoordinate(e);if(!l.rightClickInSelectedArea(e,r.row,r.col)){var o,a,s,c,d=l.getCellCoordinate(e);if(Object(Ae.c)(e.nativeEvent))return l.factoryOptions.model.showSelection=!0,void l.tableSelectCellRange(null!==(o=null===(a=l.shiftKeyBeginCoord)||void 0===a?void 0:a.row)&&void 0!==o?o:0,null!==(s=null===(c=l.shiftKeyBeginCoord)||void 0===c?void 0:c.col)&&void 0!==s?s:0,d.row,d.col);l.shiftKeyBeginCoord=d,l.beginCoord=r,l.lastCoord=r;var u=t.selectedRange;!t.showSelection&&u&&l.beginCoord.row===u.rowStart&&l.beginCoord.row===u.rowEnd&&l.beginCoord.col===u.colStart&&l.beginCoord.col===u.colEnd||(t.showSelection=!1,l.tableSelectCellRange(l.beginCoord.row,l.beginCoord.col,l.lastCoord.row,l.lastCoord.col))}}})),S()(m()(l),"handleTableMouseMove",(function(e){var t,i;if(l.beginCoord){var n=l.getCellCoordinate(e);if(n.row!==(null===(t=l.lastCoord)||void 0===t?void 0:t.row)||n.col!==(null===(i=l.lastCoord)||void 0===i?void 0:i.col)){var r,o,a,s;l.lastCoord=n;var c=l.factoryOptions.model.getMergedCellRangeForCoords(l.beginCoord.row,l.beginCoord.col),d=l.factoryOptions.model.tableItems[c.rowStart][c.colStart];l.factoryOptions.model.showSelection=!(n.row>=d.row&&n.row<d.row+d.rowspan&&n.col>=d.col&&n.col<d.col+d.colspan),l.tableSelectCellRange(null===(r=l.beginCoord)||void 0===r?void 0:r.row,null===(o=l.beginCoord)||void 0===o?void 0:o.col,null===(a=l.lastCoord)||void 0===a?void 0:a.row,null===(s=l.lastCoord)||void 0===s?void 0:s.col)}}})),S()(m()(l),"handleTableMouseUp",(function(){l.beginCoord=null,l.lastCoord=null})),S()(m()(l),"getWorldPosition",(function(){var e,t,i,n,r,o=null===(e=l.factoryOptions)||void 0===e||null===(t=e.getApplication)||void 0===t||null===(i=t.call(e).view)||void 0===i?void 0:i.native;if(!o)return{x:0,y:0};var a=null!==(n=null==o||null===(r=o.getBoundingClientRect)||void 0===r?void 0:r.call(o))&&void 0!==n?n:{left:0,top:0};return{x:a.left,y:a.top}})),l.cellSelectComponent=new Ne(e),l.component.inner.addChild(l.cellSelectComponent),l.cellSelectComponent.updateComponent(),l.rowColResizeComponent=new Ge(e),l.component.inner.addChild(l.rowColResizeComponent),l.rowColResizeComponent.updateComponent(),l.tableSelectonComponent=new ze(e),l.component.inner.addChild(l.tableSelectonComponent),l.config={enter:l.handleTableEnterKeyDown,tab:l.handleTableTabKeyDown},null===(o=n.inner)||void 0===o||o.onMouseDown(l.handleTableMouseDown),null===(a=n.inner)||void 0===a||a.onMouseMove(l.handleTableMouseMove),window.addEventListener("mouseup",l.handleTableMouseUp);var s=l.factoryOptions.model;l.selectedReaction=Object(x.r)((function(){return{selected:s.selected}}),(function(e){var t;e.selected?l.enableShortCutKey():(l.disableShortCutKey(),l.shiftKeyBeginCoord=null),null===(t=l.rowColResizeComponent)||void 0===t||t.updateComponent()})),l.selectedRangeReaction=Object(x.r)((function(){return{selectedRange:s.selectedRange}}),(function(){var e;null===(e=l.tableSelectonComponent)||void 0===e||e.updateComponent()})),l.selectElementChangeReaction=Object(x.r)((function(){return{selectedArray:l.getSelectionService().selectedElements.selectedArray}}),(function(e){var t=e.selectedArray;l.handleSelectElementChange(t)}));var c=He.a.createObserver(s);return null==c||c.addChangesetObserver(l.handleChangesetObserver),l}return a()(i,[{key:"dispose",value:function(){var e,t,n,r;s()(f()(i.prototype),"dispose",this).call(this),this.selectedReaction(),this.selectedRangeReaction(),null===(e=this.selectElementChangeReaction)||void 0===e||e.call(this),this.disableShortCutKey(),He.a.createObserver(this.factoryOptions.model).removeChangesetObserver(this.handleChangesetObserver),null===(t=this.cellSelectComponent)||void 0===t||t.dispose(),null===(n=this.rowColResizeComponent)||void 0===n||n.dispose(),null===(r=this.tableSelectonComponent)||void 0===r||r.dispose(),this.cellSelectComponent=null,this.rowColResizeComponent=null,this.tableSelectonComponent=null,window.removeEventListener("mouseup",this.handleTableMouseUp)}},{key:"getIndex",value:function(e,t){for(var i=0,n=e.length,r=0;r<n;r++)if((i+=e[r])>=t)return r;return n-1}},{key:"renderSearchHighlight",value:function(e){var t,i,n=this,r=e.searchResult,o=e.highlightResult,a=e.keyword,l=null===(t=this.getAppService().editableServiceLayer)||void 0===t||null===(i=t.searchReplaceManager)||void 0===i?void 0:i.dangerousInstance,s=null==l?void 0:l.fixTableResult(r);if(null==s||s.forEach((function(e){var t,i=e.cell,r=e.textPositions,o=null===(t=n.factoryOptions.model.tableItems[i.row][i.col])||void 0===t?void 0:t.editorInstance;null==o||o.addSearchMark(r,a)})),null!=o&&o.cell){var c,d=o.cell,u=null===(c=this.factoryOptions.model.tableItems[d.row][d.col])||void 0===c?void 0:c.editorInstance;null==u||u.addHighlight([o],a)}}},{key:"handleSelectionChange",value:function(){}},{key:"getCellCoordinate",value:function(e){var t=e.nativeEvent,i=this.factoryOptions.getPageScale(),n=this.getWorldPosition(),r=this.component.inner.children[1].worldBounds,o=r.minX,a=r.minY,l=(t.clientX-n.x-o)/i,s=(t.clientY-n.y-a)/i,c=this.factoryOptions.model.props.colWidths,d=this.factoryOptions.model.displayRowHeights;return{row:this.getIndex(d,s),col:this.getIndex(c,l)}}},{key:"checkCurrentEditable",value:function(){return this.factoryOptions.model.currentEditState>X.b.EDITABLE}},{key:"rightClickInSelectedArea",value:function(e,t,i){var n=this.factoryOptions.model;return Object(Ae.a)(e.nativeEvent)&&n.showSelection&&n.cellSelectedState(t,i,n.selectedRange)}},{key:"getComponent",value:function(){return this.factoryOptions.model}},{key:"handleSelectElementChange",value:function(e){var t=this.factoryOptions.model;t&&((null==e?void 0:e.indexOf(t))>=0?(e.length>1&&t.uploadEditingCellData(!0),this.tableSelectCellRange(0,0,t.props.rowHeights.length-1,t.props.colWidths.length-1)):(t.uploadEditingCellData(!0),t.showSelection=!1,t.selectedCellRanges=[],t.selectedRange=null))}},{key:"tableSelectCellRange",value:function(e,t,i,n){var r=this.factoryOptions.model,o=this.getSelectionService().selectedElements.selectedArray||[];1===o.length&&o[0]===r?r.afterSelection(e,t,i,n):o.length>1&&o.filter((function(e){return e.type===g.d.TABLE})).forEach((function(e){e.showSelection=!1,e.afterSelection(0,0,e.props.rowHeights.length-1,e.props.colWidths.length-1)}))}}]),i}(ne);function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var Ve=function(e){d()(i,e);var t=Ye(i);function i(){return r()(this,i),t.apply(this,arguments)}return i}($),Ke=(i("6e20b6a7d8"),i("759492dad9"),i("826dc923b3"),i("4b0c0f4cca"));function Xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var Qe=function(e){d()(i,e);var t=Xe(i);function i(e,n){var o;return r()(this,i),o=t.call(this,e,n),S()(m()(o),"chartManager",void 0),S()(m()(o),"subChartChangeSetObservers",void 0),S()(m()(o),"selectDisposer",void 0),S()(m()(o),"editStateDisposer",void 0),S()(m()(o),"handleChartTitleMouseDown",(function(e){var t;o.checkCurrentEditable()&&((null===(t=e.target)||void 0===t?void 0:t.localBounds)&&(o.chartComponent.resetSelectState(),o.markElementSelected(o.titleElement),o.chartTitleComponent.updateTextEditor()))})),S()(m()(o),"handleInnerDoubleClick",(function(){var e;o.component.inner.isActualRenderChart&&o.checkCurrentEditable()&&(null===(e=o.getRightSideBarManager())||void 0===e||e.setPropertyEditorShowAction(_.q.DOUBLE_CLICK_TOOGLE),o.getRightSideBarServices().hide())})),o.chartManager=o.getAppServices().editableServiceLayer.chartManager,o.component.inner.onDoubleClick(o.handleInnerDoubleClick),o.addSelectObserver(),o}return a()(i,[{key:"dispose",value:function(){var e,t;s()(f()(i.prototype),"dispose",this).call(this),null===(e=this.selectDisposer)||void 0===e||e.call(this),null===(t=this.editStateDisposer)||void 0===t||t.call(this)}},{key:"handleTitleChange",value:function(e){if(this.checkCurrentEditable()){var t=e.paragraphList,i=this.chartModel.chartProperty.chartTitle;i&&(this.isTitleEmpty(t)?i.removeTitle():i.updateProps({text:{paragraphList:t}})),this.titleTextEditor&&this.updateSelectedElement(this.titleElement)}}},{key:"handleTitleTextChange",value:function(){this.titleTextEditor&&this.updateSelectedElement(this.titleElement)}},{key:"updateSelectedTitleElement",value:function(){this.updateSelectedElement(this.titleElement)}},{key:"handleElementSelected",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.checkCurrentEditable()){var i=this.chartComponent.chartElements;if(!this.chartModel.isElementSelected(e.id)){if(!!e.groupId&&!e.disableGroupSelect){var n,r=i.find((function(t){return t.id===e.groupId}));if(this.chartModel.isElementSelected(null==r?void 0:r.id)&&t&&!e.disableSingleSelect)this.markElementSelected(e);else(null===(n=this.chartModel.selectedElement)||void 0===n?void 0:n.groupId)===e.groupId?this.markElementSelected(e):this.markElementSelected(r||e)}else this.markElementSelected(e);this.triggerTitleBlur()}}}},{key:"handlePlotBlankMouseDown",value:function(){this.chartModel.removeAllSelectedElements(),this.triggerTitleBlur()}},{key:"updateSelectedElementStyle",value:function(){var e=this.chartModel.selectedElement;if(e&&e.type!==Ke.a.TITLE){var t,i=void 0;null===(t=this.chartComponent.chartElements)||void 0===t||t.map((function(t){if(t.id===e.id)i=t;else if(t.group){var n=t.group.find((function(t){return t.id===e.id}));n&&(i=n)}})),i?this.updateSelectedElement(i):this.chartModel.removeAllSelectedElements()}}},{key:"onTitleEditorUpdate",value:function(){this.updateSelectedTitleElement()}},{key:"onChartSourceUpdate",value:function(){this.updateSelectedElementStyle()}},{key:"getChartHitAreaProps",value:function(e){var t=this,i=[];return e.forEach((function(e){t.isChartElementGroup(e)?e.group.forEach((function(e){i.push(t.generateHitAreaProp(e))})):i.push(t.generateHitAreaProp(e))})),i}},{key:"triggerAllElementUnSelected",value:function(){this.triggerTitleBlur(),this.chartModel.removeAllSelectedElements(),this.chartComponent.resetSelectState()}},{key:"triggerTitleBlur",value:function(){var e,t;this.chartModel.removeIfSelected(Ke.a.TITLE),null===(e=this.titleTextEditor)||void 0===e||e.triggerBlur(),null===(t=this.chartTitleComponent)||void 0===t||t.updateTextEditor()}},{key:"handleChartInstanceMouseDown",value:function(){this.triggerTitleBlur()}},{key:"isChartElementGroup",value:function(e){return!!e.group}},{key:"generateHitAreaProp",value:function(e){var t;return{path:null===(t=e.path)||void 0===t?void 0:t.map((function(e){return e.map((function(e){return isNaN(Number(e))?e:Math.max(0,Number(e))})).join(" ")})).join(" "),factoryOptions:this.factoryOptions,element:e}}},{key:"addSelectObserver",value:function(){var e=this;0===this.factoryOptions.fromScale&&(this.selectDisposer=Object(x.r)((function(){var t;return{selected:null===(t=e.chartModel)||void 0===t?void 0:t.selected}}),(function(t){t.selected||e.triggerAllElementUnSelected()})),this.editStateDisposer=Object(x.r)((function(){return{isResizing:e.getEditingStateManager().isResizing,isDragging:e.getEditingStateManager().isDragging}}),(function(t){var i=t.isResizing,n=t.isDragging;(i||n)&&e.handleInEditingState()})))}},{key:"handleInEditingState",value:function(){this.chartModel.removeAllSelectedElements()}},{key:"markElementSelected",value:function(e){this.chartModel.isElementSelected(e.id)||this.chartModel.markSelected(e)}},{key:"updateSelectedElement",value:function(e){this.chartModel.isElementSelected(e.id)&&this.chartModel.markSelected(e)}},{key:"titleElement",get:function(){return{rect:this.titleTextRect,path:[[]],type:Ke.a.TITLE,id:Ke.a.TITLE}}},{key:"titleTextRect",get:function(){return this.chartTitleComponent.getRealTitleRect()}},{key:"titleTextEditor",get:function(){var e;return null===(e=this.chartTitleComponent)||void 0===e?void 0:e.textEditor}},{key:"chartTitleComponent",get:function(){return this.component.inner.chartTitleComponent}},{key:"chartComponent",get:function(){return this.component.inner.chartComponent}},{key:"chartModel",get:function(){return this.factoryOptions.model}},{key:"getRightSideBarManager",value:function(){var e;return null===(e=Q.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.rightSideBarManager}},{key:"getEditingStateManager",value:function(){return this.getAppServices().viewableServiceLayer.editingStateManager}},{key:"getRightSideBarServices",value:function(){return this.getAppServices().viewableServiceLayer.rightSideBarService}},{key:"checkCurrentEditable",value:function(){return this.factoryOptions.model.currentEditState===X.b.EDITABLE}},{key:"isTitleEmpty",value:function(e){var t;if(!e)return!0;if(e.length>1)return!1;var i=null===(t=e[0])||void 0===t?void 0:t.textRuns;return!i||0===i.length}}]),i}($);function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var qe=function(e){d()(i,e);var t=Ze(i);function i(){return r()(this,i),t.apply(this,arguments)}return i}($),Je=i("464ceed456"),$e=i("33e561419d"),et=i("bf70fbf8a7"),tt=i("c3df4c6e22"),it=i("845d8f9b40");function nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var rt=function(e){d()(i,e);var t=nt(i);function i(e,n){var o;return r()(this,i),o=t.call(this,e,n),S()(m()(o),"handleIconClick",function(){var e=j()(F.a.mark((function e(t){var i,n,r,a,l,s,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(i=o.componentOptions.selectionService)||void 0===i||i.selectedElements.clear(),null===(n=o.componentOptions.selectionService)||void 0===n||n.selectedElements.add(o.componentOptions.model),e.t0=t,e.next=e.t0===B.a.PIC?5:e.t0===B.a.TBL?14:17;break;case 5:return e.next=7,null===(r=o.componentOptions.copyPasteImageService)||void 0===r?void 0:r.promise();case 7:return a=e.sent,l=(null!=a?a:{}).ImageEditManager,s=null==l?void 0:l.getInstance(),c=document.getElementById("select_pic_input"),s&&(s.imageReplacing=!1),null==c||c.click(),e.abrupt("break",17);case 14:return new it.a({}).showDialog(),e.abrupt("break",17);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o.component.setEventHandlers({handleIconClick:o.handleIconClick}),o}return i}(tt.a),ot=i("87f81c55b9");function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var lt=function(e){d()(i,e);var t=at(i);function i(){return r()(this,i),t.apply(this,arguments)}return a()(i,[{key:"createLogic",value:function(e,t){switch(e.model.type){case g.d.SHAPE:return new be(e,t);case g.d.IMAGE:return new we(e,t);case g.d.CONNECTOR:return new Oe(e,t);case g.d.TABLE:return new _e(e,t);case g.d.GROUP:return new Ve(e,t);case g.d.CHART:return new Qe(e,t);case g.d.SMART_ART:return new qe(e,t);default:return null}}},{key:"getLogic",value:function(e){return this.logicMap.get(e.model.key)}},{key:"removeLogic",value:function(e){var t,n,r,o,a,l,c=this.getLogic(e);null==c||c.reactionDisposers.forEach((function(e){return e()})),null==c||null===(t=c.dragListener)||void 0===t||t.call(c),null==c||null===(n=c.selectedListener)||void 0===n||n.call(c),null==c||null===(r=c.videoPosterListener)||void 0===r||r.call(c),null==c||null===(o=c.iframePosterListener)||void 0===o||o.call(c),null==c||null===(a=c.flagEventsInstance)||void 0===a||null===(l=a.cancelAllEvents)||void 0===l||l.call(a),s()(f()(i.prototype),"removeLogic",this).call(this,e)}},{key:"createComponentLogic",value:function(e,t){switch(t.getComponentType()){case Je.a.PLACEHOLDER:return new $e.a(e,t);case Je.a.TABLECELL:return new et.a(e,t);case Je.a.PLACEHOLDERICON:return new rt(e,t);case Je.a.TEXTEDITOR:return new ot.a(e,t)}return null}}]),i}(p.a)},"26c5e66751":function(e,t,i){"use strict";i("a84962d637"),i("bcb5d93d36");var n=i("14502724a6"),r=i.n(n),o=i("7a5536c9bf"),a=i.n(o),l=i("1f925d7f50"),s=i.n(l),c=i("9132715560"),d=i.n(c),u=i("6a364eb35c"),h=i.n(u),v=i("85d0a7609b"),f=i.n(v),p=i("2dc700e1e6"),g=i.n(p),y=(i("f1054791f4"),i("8ee19818c4"),i("826dc923b3"),i("8a35b54c1d"),i("3dc760a4d9"),i("342844cefa"),i("6e20b6a7d8"),i("8e7cce0ada"),i("c6244f7705"),i("c9a7ecac4d"),i("85d48ef22b"),i("2a6f332b5e"),i("b1e2246d82"),i("3bf1976a4f"),i("cd5d3ee784"),i("75563bc376"),i("c554310b5c"),i("d5c3deb8c7")),m=i("f829316724"),b=i.n(m),S=i("435193bbe3"),M=i.n(S),E=i("a9e0ee82c1"),C=i.n(E),k=i("c7f5852961"),w=i.n(k),I=i("0e0be5791f"),x=i.n(I),O=i("52a36c5824"),A=i.n(O),L=i("217161e843"),R=i.n(L),D=i("ee6bb53310"),T=i.n(D),P=i("8f58e78419"),B=i.n(P),G=i("a7888a8b87"),j=i.n(G),N=i("467a6af51c"),F=(i("1bab7b5fb7"),i("34cd92f77a"),i("0aeae65bf4"),i("2c4d03fe19"),i("759492dad9"),i("7a3400cab1"),i("a2a09da1e3"),i("9d7978d445"),i("bd80bf2d0f"),i("7eaa8e90a5"),i("963f2eaace"),i("29f8c5f672"),i("4bbb5840d5"),i("0cf3719522")),z=i.n(F),H=function(){function e(t){d()(this,e),f()(this,"pools",void 0),f()(this,"maxPoolSize",1e4),this.ctor=t,this.pools=new Map}return h()(e,[{key:"createInstance",value:function(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null===(e=(t=this.ctor).preHandleOptions)||void 0===e?void 0:e.call(t,i))||i,r=this.ctor.generateKey(n),o=this.pools.get(r);return o||(o=new this.ctor(n,r),this.set(r,o)),o}},{key:"isTargetType",value:function(e){return e instanceof this.ctor}},{key:"releasePools",value:function(){this.pools.clear()}},{key:"set",value:function(e,t){this.pools.size>=this.maxPoolSize&&this.releasePools(),this.pools.set(e,t)}}]),e}(),U=H,W=i("7898ead03d");var _=function(){function e(t){d()(this,e),f()(this,"value",void 0),void 0!==(null==t?void 0:t.value)&&(this.value=t.value)}return h()(e,[{key:"clone",value:function(){var t={};return t.value=this.value,new e(t)}}],[{key:"createAttributeInstance",value:function(t){return new e(t)}},{key:"deserializeBuffer",value:function(t){var i={};return t&&"object"===z()(t)?(e.keyList.forEach((function(e){void 0!==t[e]&&(i[e]=t[e])})),i):t}},{key:"preSerialize",value:function(t){var i={};return e.keyList.forEach((function(e){void 0!==t[e]&&(i[e]=t[e])})),i}},{key:"decode",value:function(e,t){for(var i=e instanceof W.Reader?e:new W.Reader(e),n=void 0===t?i.len:i.pos+t,r={value:0};i.pos<n;){var o=i.uint32();if(o>>>3==1)r.value=i.int32();else i.skipType(7&o)}return r}},{key:"encode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.Writer.create();return void 0!==e.value&&t.uint32(8).int32(e.value),t}}]),e}();f()(_,"keyList",["value"]);var Y=function(){function e(t){d()(this,e),f()(this,"value",void 0),void 0!==(null==t?void 0:t.value)&&(this.value=t.value)}return h()(e,[{key:"clone",value:function(){var t={};return t.value=this.value,new e(t)}}],[{key:"createAttributeInstance",value:function(t){return new e(t)}},{key:"deserializeBuffer",value:function(t){var i={};return t&&"object"===z()(t)?(e.keyList.forEach((function(e){void 0!==t[e]&&(i[e]=t[e])})),i):t}},{key:"preSerialize",value:function(t){var i={};return e.keyList.forEach((function(e){void 0!==t[e]&&(i[e]=t[e])})),i}},{key:"decode",value:function(e,t){for(var i=e instanceof W.Reader?e:new W.Reader(e),n=void 0===t?i.len:i.pos+t,r={value:""};i.pos<n;){var o=i.uint32();if(o>>>3==1)r.value=i.string();else i.skipType(7&o)}return r}},{key:"encode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.Writer.create();return void 0!==e.value&&t.uint32(10).string(e.value),t}}]),e}();f()(Y,"keyList",["value"]);var V=function(){function e(t,i){d()(this,e),f()(this,"numFmtId",void 0),f()(this,"formatCode",void 0),this.key=i,void 0!==(null==t?void 0:t.numFmtId)&&(this.numFmtId=t.numFmtId),void 0!==(null==t?void 0:t.formatCode)&&(this.formatCode=t.formatCode)}return h()(e,[{key:"equal",value:function(e){return this.numFmtId===e.numFmtId&&this.formatCode===e.formatCode}},{key:"clone",value:function(){var t={};return t.numFmtId=this.numFmtId,t.formatCode=this.formatCode,e.factory.createInstance(t)}}],[{key:"generateKey",value:function(t){var i="{";return void 0!==(null==t?void 0:t.numFmtId)&&(i="".concat(i).concat(t.numFmtId).concat(e.keyList.indexOf("numFmtId"))),void 0!==(null==t?void 0:t.formatCode)&&(i="".concat(i).concat(t.formatCode).concat(e.keyList.indexOf("formatCode"))),"".concat(i,"}")}},{key:"createAttributeInstance",value:function(t){return new e(t)}},{key:"deserializeBuffer",value:function(t){var i={};return t&&"object"===z()(t)?(e.keyList.forEach((function(e){void 0!==t[e]&&(i[e]=t[e])})),i):t}},{key:"preSerialize",value:function(t){var i={};return e.keyList.forEach((function(e){void 0!==t[e]&&(i[e]=t[e])})),i}},{key:"decode",value:function(e,t){for(var i=e instanceof W.Reader?e:new W.Reader(e),n=void 0===t?i.len:i.pos+t,r={};i.pos<n;){var o=i.uint32();switch(o>>>3){case 1:r.numFmtId=_.decode(i,i.uint32()).value;break;case 2:r.numFmtIdI=i.bool();break;case 3:r.formatCode=Y.decode(i,i.uint32()).value;break;case 4:r.formatCodeI=i.bool();break;default:i.skipType(7&o)}}return r}},{key:"encode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.Writer.create();return void 0!==e.numFmtId&&_.encode({value:e.numFmtId},t.uint32(10).fork()).ldelim(),void 0!==e.numFmtIdI&&t.uint32(16).bool(e.numFmtIdI),void 0!==e.formatCode&&Y.encode({value:e.formatCode},t.uint32(26).fork()).ldelim(),void 0!==e.formatCodeI&&t.uint32(32).bool(e.formatCodeI),t}}]),e}();f()(V,"factory",new U(V)),f()(V,"keyList",["numFmtId","formatCode"]);i("0acdc5834b");var K,X=i("d42cf6eff2"),Q=Object(X.b)()||Object(X.a)()?{auto:"General",default:"General",text:"@",numeral:"#,##0.00_ ",percentage:"0.00%","percentage-int":"0%",exponential:"0.00E+00","currency-chs":'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)',"currency-hk":"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)","currency-en":"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)",time:"h:mm:ss;@","date-time":"yyyy/m/d h:mm:ss;@",date:"yyyy/m/d","date-chs":'yyyy"年"m"月"d"日";@',"date-chs-ym":'yyyy"年"m"月";@',"date-chs-md":'m"月"d"日";@',fraction:"# ?/?",m_d_yy:"m/d/yy;@","mmm-yy":"[$-409]mmm-yy;@",m_d:"m/d;@","yyyy-mm-dd":"yyyy-mm-dd;@",yyyy_mm_dd:"yyyy/mm/dd;@","yyyy_m_d-h-m":"yyyy/m/d h:mm;@","h-mm":"h:mm;@",yy_m_d:"yy/m/d;@","h-mm-ss-am_pm":"[$-409]h:mm:ss\\ AM/PM;@"}:{default:"General",auto:"General",text:"@",numeral:"#,##0.00_ ",percentage:"0.00%","percentage-int":"0%",exponential:"0.00E+00",currency:"#,##0.00","currency-chs":'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)',"currency-hk":"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)","currency-en":"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)",time:"h:mm:ss;@","date-time":"yyyy/m/d h:mm:ss",date:"yyyy/m/d",accounting:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_',"date-chs":'yyyy"年"m"月"d"日";@',"date-chs-ym":'yyyy"年"m"月";@',"date-chs-md":'m"月"d"日";@',fraction:"# ?/?"},Z=(Object.keys(Q).reduce((function(e,t){return e[Q[t]]=t,e}),{}),new V({numFmtId:0,formatCode:"General"}));function q(e){return{group:K.GENERAL,type:K.GENERAL}}!function(e){e.GENERAL="auto",e.TEXT="text",e.NUMBER="number",e.PERCENT="percent",e.CURRENCY="currency",e.DATE="date",e.TIME="time",e.DATE_TIME="date-time",e.FRACTION="fraction",e.SCIENTIFIC="scientific",e.ACCOUNTING="accounting",e.SPECIAL="special",e.CUSTOM="custom"}(K||(K={}));var J,$={name:"en",weekdays:"SUNDAY_MONDAY_TUESDAY_WEDNESDAY_THURSDAY_FRIDAY_SATURDAY".split("_"),weekdaysShort:"SUN_MON_TUE_WED_THU_FRI_SAT".split("_"),months:"JANUARY_FEBRUARY_MARCH_APRIL_MAY_JUNE_JULY_AUGUST_SEPTEMBER_OCTOBER_NOVEMBER_DECEMBER".split("_"),monthsShort:"JAN_FEB_MAR_APR_MAY_JUN_JUL_AUG_SEP_OCT_NOV_DEC".split("_")},ee={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_")};!function(e){e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.BOOL=2]="BOOL",e[e.FORMULA=3]="FORMULA"}(J||(J={}));var te=J,ie=i("f2b6d66c40"),ne=i("24d5b39d83"),re=i.n(ne),oe=i("98f776019f"),ae=i.n(oe),le={CURRENT_STYLE_FIRST:0,PARSE_STYLE_FIRST:1};function se(e,t){return function(e,t){if("string"!=typeof e)return;var i,n=function(e){var t;if(t=e.match(/^([0-9]{4})\s*-\s*([0-9]{1,2})\s*-\s*([0-9]{1,2})\s*$/)){var i=Number(t[1]);if(i>=1900&&i<=9999){var n=[{dateTime:"".concat(fe.instance().getFullYear(t[1]),"-").concat(t[2],"-").concat(t[3]),targetFormat:"yyyy/m/d"}];return fe.instance().parseMoment(n)}}if(t=e.match(/^([0-9]{1,2})\s*-\s*([0-9]{1,2})\s*-\s*([0-9]{1,4})\s*$/)){var r=Number(t[3]);if(r>=0&&r<=99||r>=1900&&r<=9999){var o=[{dateTime:"".concat(fe.instance().getFullYear(t[3]),"-").concat(t[1],"-").concat(t[2]),targetFormat:"m/d/yyyy"}];return fe.instance().parseMoment(o)}}if(t=e.match(/^([0-9]{0,4})\s*-\s*([0-9]{1,4})\s*$/)){var a=Number(t[1]);if(a>=0&&a<=99&&t[1].length<=2||a>=1900){var l=[{dateTime:"".concat(fe.instance().getFullYear(),"-").concat(t[1],"-").concat(t[2]),targetFormat:ie.default.t('m"月"d"日";@')},{dateTime:"".concat(fe.instance().getFullYear(),"-").concat(t[2],"-").concat(t[1]),targetFormat:ie.default.t('m"月"d"日";@')},{dateTime:"".concat(fe.instance().getFullYear(t[1]),"-").concat(t[2],"-1"),targetFormat:"mmm-yy"}];return fe.instance().parseMoment(l)}}return!1}(e=e.replace(/\//g,"-"))||function(e){var t;if(t=e.match(/^\s*([0-9]{1,4})年([0-9]{1,4})月([0-9]{1,4})日\s*$/)){var i=[{dateTime:"".concat(fe.instance().getFullYear(t[1]),"-").concat(t[2],"-").concat(t[3]),targetFormat:ie.default.t('yyyy"年"m"月"d"日";@')}];return fe.instance().parseMoment(i)}if(t=e.match(/^\s*([0-9]{1,4})年([0-9]{1,4})月\s*$/)){var n=[{dateTime:"".concat(fe.instance().getFullYear(t[1]),"-").concat(t[2],"-1"),targetFormat:ie.default.t('yyyy"年"m"月";@')}];return fe.instance().parseMoment(n)}if(t=e.match(/^\s*([0-9]{1,4})月([0-9]{1,4})日\s*$/)){var r=[{dateTime:"".concat(fe.instance().getFullYear(),"-").concat(t[1],"-").concat(t[2]),targetFormat:ie.default.t('m"月"d"日";@')}];return fe.instance().parseMoment(r)}return!1}(e)||function(e){var t;if(t=e.match(/^([0-9]{1,4})\s*-\s*((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*-\s*([0-9]{1,4})\s*$/i)){var i=fe.instance().getFullYear(t[4]),n=fe.instance().getMonthNum(t[2],"en"),r=[{dateTime:"".concat(i,"-").concat(n,"-").concat(t[1]),targetFormat:"[$-409]d-mmm-yy;@"}];return fe.instance().parseMoment(r)}if(t=e.match(/^((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*-\s*([0-9]{1,4})\s*$/i)){var o=fe.instance().getMonthNum(t[1],"en"),a=[{dateTime:"".concat(fe.instance().getFullYear(),"-").concat(o,"-").concat(t[3]),targetFormat:"d-mmm"},{dateTime:"".concat(fe.instance().getFullYear(t[3]),"-").concat(o,"-1"),targetFormat:"mmm-yy"}];return fe.instance().parseMoment(a)}if(t=e.match(/^\s*([0-9]{1,4})\s*-\s*((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*$/i)){var l=fe.instance().getMonthNum(t[2],"en"),s=[{dateTime:"".concat(fe.instance().getFullYear(),"-").concat(l,"-").concat(t[1]),targetFormat:"d-mmm"}];return fe.instance().parseMoment(s)}return!1}(e)||function(e){var t;if(t=e.match(/^([0-9]{2,4})\s*\.\s*([0-9]{1,2})\s*\.\s*([0-9]{1,2})\s*$/)){var i=[{dateTime:"".concat(fe.instance().getFullYear(t[1]),"-").concat(t[2],"-").concat(t[3]),targetFormat:'yyyy"."m"."d'}];return fe.instance().parseMoment(i)}if(t=e.match(/^\s*([0-9]{1,4})年([0-9]{1,4})月([0-9]{1,4})号\s*$/)){var n=[{dateTime:"".concat(fe.instance().getFullYear(t[1]),"-").concat(t[2],"-").concat(t[3]),targetFormat:ie.default.t('yyyy"年"m"月"d"号"')}];return fe.instance().parseMoment(n)}if(t=e.match(/^\s*([0-9]{1,4})月([0-9]{1,4})号\s*$/)){var r=[{dateTime:"".concat(fe.instance().getFullYear(),"-").concat(t[1],"-").concat(t[2]),targetFormat:ie.default.t('m"月"d"号"')}];return fe.instance().parseMoment(r)}return!1}(e);if(n&&n.moment){if(0===n.moment.year())return;var r=n.moment.format("YYYY-MM-DDTHH:mm:ss.SSS+08:00"),o=ve(r);o>0&&(i=he(o,t))}if(void 0!==i)return{type:K.DATE,formatCode:n&&n.formatCode,numericValue:i,valueType:te.NUMBER,moment:n&&n.moment}}(e,t)}function ce(e,t){var i=function(e,t){if("string"!=typeof e)return;var i,n=/^\s*[(（]\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*%\s*$/,r=/^\s*[(（]\s*%\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*$/,o=/^\s*%\s*[(（]\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*$/,a=/^\s*[(（]\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*[)）]\s*$/.exec(e)||n.exec(e)||r.exec(e)||o.exec(e);a&&a[1]&&(e="-".concat(a[1],"%"));var l=-1!==e.indexOf(".");if(i=function(e){if(/^\s*[+-]?\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*$/.test(e))return(e=e.replace(/\s/g,"")).substr(0,e.length-1);if(/^\s*%\s*[+-]?\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e)||/^\s*[+-]?\s*%\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e))return-1!==(e=e.replace(/\s/g,"")).indexOf("+")?e.substr(2,e.length):-1!==e.indexOf("-")?"-".concat(e.substr(2,e.length)):e.substr(1,e.length);return!1}(e),/^\s*[(（]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*)(%))\s*[)）]\s*$/.test(e)||/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)(%)$/.test(e)){var s=function(e,t){var i=/^\s*[(（]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*))\s*[)）]\s*$/.exec(e);i&&i[1]&&(e="-".concat(i[1]));var n=/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)$/,r=e&&"string"==typeof e&&e.match(n);if(r&&r[3]&&r[4]){var o=new re.a(r[3]),a=new re.a(r[4]),l=!(!r[1]||"-"!==r[1].trim());if(o.greaterThan(32767)||a.greaterThan(32767))return;var s=r[4].length,c=o.div(a);if(!!r[2]){var d=new re.a(r[2].trim());c=c.plus(d)}else if(0===a.toNumber()||0===o.toNumber())return;l&&(c=c.mul(-1));var u=new Array(s+1).join("?"),h="# ".concat(u,"/").concat(u);return{type:K.FRACTION,formatCode:h,numericValue:c.toNumber(),valueType:te.NUMBER}}}(e.replace(/%/g,""));null!=s&&(l="string"==typeof(i=s.numericValue)&&-1!==i.indexOf("."))}if("string"==typeof i){i=he(i=i.replace(/[,，]/g,""),t),i=new re.a(i).div(100).toString();var c=l?"0.00%":"0%";return{type:K.PERCENT,formatCode:c,numericValue:Number(i),valueType:te.NUMBER}}}(e.value,t)||function(e,t){var i=/^\s*[(（]\s*((\d+(\.\d+)?)|(\.\d+))\s*[)）]\s*$/.exec(e);i&&i[1]&&(e="-".concat(i[1]));if(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*$/.test(e))return e=he(e=e.replace(/\s/g,""),t),{type:K.NUMBER,pattern:"0.00_);[Red](0.00)",numericValue:e,valueType:te.NUMBER};return}(e.value,t)||se(e.value,t),n=void 0!==i?i.numericValue:e.value,r=void 0!==i?i.valueType:te.STRING,o=function(e,t){var i,n;if(t&&e.parseMode===le.PARSE_STYLE_FIRST){var r=q(t.formatCode);t.type===K.NUMBER?ue(e.numberFormatType.group)||e.numberFormatType.group===K.GENERAL?(i=K.GENERAL,n="General"):(i=e.numberFormatType.type,n=e.numberFormat.formatCode):ue(e.numberFormatType.group)&&e.numberFormatType.group===r.group?(i=e.numberFormatType.type,n=e.numberFormat.formatCode):(i=t.type,n=t.formatCode)}else e.parseMode===le.CURRENT_STYLE_FIRST&&e.numberFormatType.type===K.GENERAL&&t&&t.type!==K.NUMBER?(i=t.type,n=t.formatCode):(i=e.numberFormatType.type,n=e.numberFormat.formatCode);return{type:i,formatCode:n}}(e,i);return{value:n,type:o.type,formatCode:o.formatCode,numericValue:n,valueType:r}}function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,n=(null==i?void 0:i.parseMode)||le.CURRENT_STYLE_FIRST;try{t=t||Z,i&&(i.numberFormat=t);for(var r,o,a=q(),l=e,s={value:e,numberFormat:t,numberFormatType:a,parseMode:n},c=[ce];(o=c.shift())&&!(r=o.apply(this,[s,i])););var d,u=r||{value:e},h=u.value,v=u.formatCode;if(h===-1/0||h===1/0||!r)h=e,v=null===(d=t)||void 0===d?void 0:d.formatCode;return t=function(e){return e=Q[e||"General"]||e||"General",new V({formatCode:e})}(v),null==h&&(h=""),{originValue:l,value:h,numberFormat:t,valueType:r?r.valueType:te.STRING}}catch(t){console.warn(t);var f=e;return null==f&&(f=""),{originValue:e,value:f,numberFormat:Z,valueType:te.STRING}}}function ue(e){switch(e){case K.DATE:case K.TIME:case K.DATE_TIME:return!0}return!1}function he(e,t){var i=function(e,t,i){t=t||15;var n=parseFloat(e);if(isNaN(n))return e;e="".concat(e),e=e.trim();var r="",o=-1===e.indexOf("e")?e.indexOf("E"):e.indexOf("e");-1!==o&&(r=e.slice(o),e=e.slice(0,o));for(var a=e.split(""),l=0,s=0,c=!1,d=0;d<a.length;d++){var u=a[d];if("-"!==u||0!==d)if("."===u)c=!0,l>=t&&(a[d]="");else if(isNaN(parseInt(u,10)))a[d]="";else if(c){if(s+=1,(l>=t||l+s>t)&&(a[d]=""),!0===i&&l+s===t+1&&parseInt(u,10)>=5){var h=""===a[d-1]?d-2:d-1,v=parseInt(a[h],10);isNaN(v)||(a[h]="".concat(v+1))}}else(l+=1)>t&&(a[d]="0"),!0===i&&l===t+1&&parseInt(u,10)>=5&&(a[d-1]="".concat(parseInt(a[d-1],10)+1))}return a.join("")+r}(e,void 0,t&&t.toRound);return t&&t.toRound?i:function(e){if("number"==typeof e)return!1;if(!e)return!1;var t=e.indexOf(".");-1!==t&&(e=e.substr(0,t)+e.substr(t+1,e.length));var i=(e=(e=e.replace(/[+-]/,"")).toUpperCase()).indexOf("E");-1!==i&&(e=e.substr(0,i));var n=e.match(/^[0]*([1-9]([0-9]*[1-9])?)[0]*$/);if(n&&n[1].length>16)return!0;return!1}(e)?e:parseFloat(e)}ae.a.prototype.parseTwoDigitYear=function(e){var t=(new Date).getFullYear()+11,i=parseInt(e,10);return i+2e3<=t?i+2e3:i+1900};var ve=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).need_1900_2_29,i=void 0!==t&&t,n=e,r=!1;/1900-0?2-29/.test(e)&&(n=e.replace("1900-2-29","1900-3-1"),r=!0);var o=(Date.parse(n)-Date.parse("1970-01-01T00:00:00.000+08:00"))/864e5+25568;return i&&(o=o>=60&&!r?o+1:o),o},fe=function(){function e(){d()(this,e),f()(this,"supportLocales",new Map),this.supportLocales.set("en",$),this.supportLocales.set("zh-cn",ee)}return h()(e,[{key:"getFullYear",value:function(e){if(!e)return(new Date).getFullYear().toString();if(e.length>=4)return e;var t=(new Date).getFullYear()+11,i=parseInt(e,10);return i+2e3<=t?i+2e3:i+1900}},{key:"getMonthNum",value:function(e,t){var i=0;if(e.length<3)return i;var n=this.supportLocales.get(t);if(n){e=e.toUpperCase();for(var r=0;r<n.months.length;r++)if(n.months[r].startsWith(e)){i=r+1;break}}return i}},{key:"parseMoment",value:function(e){for(var t=0;t<e.length;t++){var i=e[t],n=i.dateTime,r=ae()(n);if(r.isValid())return{moment:r,formatCode:i.targetFormat}}}}],[{key:"instance",value:function(){return e._instance}}]),e}();f()(fe,"_instance",new fe);var pe,ge,ye,me,be,Se,Me,Ee,Ce,ke,we,Ie,xe,Oe,Ae,Le,Re=i("e49595a6eb"),De=i("61edc2034f"),Te=i("d3d31c86eb"),Pe=i("9da6335152"),Be=i("aa1f3e3a8e"),Ge=i("116dfe1d48"),je=i("44c7584d18");function Ne(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Fe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(i),!0).forEach((function(t){f()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ne(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ze=(pe=Reflect.metadata("design:type","undefined"==typeof Record?Object:Record),ge=Reflect.metadata("design:type",Function),ye=Reflect.metadata("design:paramtypes",[]),me=Reflect.metadata("design:type",Function),be=Reflect.metadata("design:paramtypes",[]),Se=Reflect.metadata("design:type",Function),Me=Reflect.metadata("design:paramtypes",[void 0]),Ee=Reflect.metadata("design:type",Function),Ce=Reflect.metadata("design:paramtypes",[Boolean]),ke=Reflect.metadata("design:type",Function),we=Reflect.metadata("design:paramtypes",[]),Ie=Reflect.metadata("design:type",Function),xe=Reflect.metadata("design:paramtypes",[]),Oe=function(){function e(){d()(this,e),s()(this,"editingChartModel",Ae,this),s()(this,"isShowChartEditModal",Le,this),f()(this,"chartTableData",{}),f()(this,"subChartSeriesLength",[]),f()(this,"isEdited",!1),f()(this,"seriesInfos",[]),f()(this,"spreadsheetInstance",null)}return h()(e,[{key:"chartData",get:function(){var e,t;return(null===(e=this.editingChartModel)||void 0===e||null===(t=e.plotArea)||void 0===t?void 0:t.charts)||[]}},{key:"AllChartSeries",get:function(){var e=[];return b()(this.editingChartModel)||this.editingChartModel.plotArea.charts.forEach((function(t){e.push.apply(e,a()(t.series))})),e}},{key:"updateSpreadsheetInstance",value:function(e){this.spreadsheetInstance=e}},{key:"updateIsEdited",value:function(e){this.isEdited=e}},{key:"unformatValue",value:function(e){var t=de(e),i=t.value,n=t.numberFormat;return Object(Re.fmtIsDate)(n.formatCode||"")&&Number(i)>60?String(Number(i)+1):i}},{key:"getRowEntries",value:function(e){return Object.entries(e).filter((function(e){var t=r()(e,1)[0];return/\d+/.test(t)}))}},{key:"fillInBlankCells",value:function(e){var t,i=0,n=this.getRowEntries(e);if(n.forEach((function(e){var t=r()(e,2)[1],n=A()(Object.keys(t.cells));Number(n)>i&&(i=Number(n))})),C()(A()(n)))return{totalRowLength:0,totalColumnLength:0};if(t=Number(A()(n)[0]),w()(t+1).forEach((function(t){C()(e[t])?(e[t]={cells:{}},w()(i+1).forEach((function(i){0===t&&0===i||(e[t].cells[i]={text:""})}))):w()(i+1).forEach((function(i){var n;0===t&&0===i||C()(null===(n=e[t].cells)||void 0===n?void 0:n[i])&&(e[t].cells[i]={text:""})}))})),0!==this.getRowEntries(e).length){this.seriesInfos=w()(i).map((function(){}));for(var o=0;o<t;++o){for(var a=1;a<i+1;++a){var l=e[o].cells[a].seriesInfo;!C()(l)&&C()(this.seriesInfos[a-1])&&(this.seriesInfos[a-1]=l)}if(this.seriesInfos.every((function(e){return!C()(e)})))break}}return{totalRowLength:t,totalColumnLength:i}}},{key:"handleSeriesIdAndName",value:function(e){var t=this,i=this.subChartSeriesLength.map((function(){return new Set}));this.AllChartSeries.forEach((function(n,r){n.originIdx=n.idx,n.idx=r,n.order=r;var o=t.getEditingSubChartIndexes(Number(r+1)).currentSubChartIndex,a=i[o];if(""===n.name&&(n.name="列".concat(String(r+1)),e[0].cells[r+1].text=n.name),a.has(n.name)){var l="列".concat(String(r+1));a.has(l)&&(l="".concat(l).concat(r+1)),n.name=l,e[0].cells[r+1].text=l}a.add(n.name)}))}},{key:"handleTableArea",value:function(e,t){var i=t.row,n=t.column;e.datas[0].rows.len=i+1<=20?20:i+1,e.datas[0].cols.len=n+1<=7?7:n+1}},{key:"convertAndSendTableDataToSdk",value:function(e,t){var i,n,o,a,l=this,s=e[0].rows,c=[],d=(null===(i=this.chartData)||void 0===i||null===(n=i[0])||void 0===n?void 0:n.type)===Ge.z.BubbleChart,u=this.fillInBlankCells(s),h=u.totalRowLength,v=u.totalColumnLength,f=this.getRowEntries(s);f.forEach((function(e){var t,i,n=r()(e,2),o=n[0],a=n[1];0!==Number(o)&&(c[Number(o)-1]=null!==(t=null===(i=a.cells[0])||void 0===i?void 0:i.text)&&void 0!==t?t:"")})),this.subChartSeriesLength=this.chartData.map((function(e){return e.series.length})),null===(o=this.chartData)||void 0===o||null===(a=o.forEach)||void 0===a||a.call(o,(function(e){e.series=[]}));var p=[];f.forEach((function(e){var t=r()(e,2),i=t[0],n=t[1];"0"===i?Object.entries(n.cells).forEach((function(e){var t=r()(e,2),i=t[0],n=t[1],o=Number(i),a=o-1;if(0!==o&&(!d||o%2!=0)){var u=l.getEditingSubChartIndexes(d?(o+1)/2:o),h=u.currentSubChartIndex,v=u.currentSubChartSeriesIndex,f=j()(l.seriesInfos[a]);if(C()(f)){var g,y,m,b,S,M,E,k,w,I,x=Object(Be.a)(null===(g=l.chartData[h])||void 0===g?void 0:g.type);if(C()(x))return;var O={idx:a,order:a,seriesText:{value:n.text||""},categories:c.map((function(e,t){var i,r;return{categoryPoint:{value:n.text},valuePoint:{value:null!==(i=null===(r=s[Number(t)+1].cells[o])||void 0===r?void 0:r.text)&&void 0!==i?i:""}}}))};l.chartData[h].type===Ge.z.BubbleChart&&(O=Fe(Fe({},O),{},{bubbleSize:De.a.getSdkBubbleSize(c.map((function(e,t){var i,n;return null!==(i=null===(n=s[Number(t)+1].cells[o+1])||void 0===n?void 0:n.text)&&void 0!==i?i:""})))}));var A=new x(O,{categoryPointList:c.map((function(e){return{value:C()(e)?"":e,formatCode:l.chartData[h].categoryFormatCode}})),count:c.length});l.chartData[h].series[v]=A,l.seriesInfos[o-1]=A,A.name=A.name.trimEnd();var L=l.seriesInfos.find((function(e){return!!e}));A.categoryFormatCode=null!==(y=A.categoryFormatCode)&&void 0!==y?y:null==L?void 0:L.categoryFormatCode,A.categoryType=null!==(m=A.categoryType)&&void 0!==m?m:null==L?void 0:L.categoryType,A.valueFormatCode=null!==(b=A.valueFormatCode)&&void 0!==b?b:null==L?void 0:L.valueFormatCode,A.valueType=null!==(S=A.valueType)&&void 0!==S?S:null==L?void 0:L.valueType,A.dataLabels=null!==(M=A.dataLabels)&&void 0!==M?M:null==L?void 0:L.dataLabels;var D=l.chartData[h].subChartProperty,T=null===(E=l.editingChartModel)||void 0===E||null===(k=E.chartSpace)||void 0===k||null===(w=k.colorStyle)||void 0===w?void 0:w.id,P=l.AllChartSeries.length+1;A.props={style:D.getDefaultThemeStyle(L,a,T,P)};var B=null!==(I=A.marker)&&void 0!==I?I:null==L?void 0:L.marker;B&&(A.marker=Fe(Fe({},B),{},{props:{style:D.getDefaultMarkerThemeStyle(a,T,P)}})),n.text=A.name,n.seriesInfo=A}else{var G;if(!(f instanceof N.a)&&Object.prototype.hasOwnProperty.call(f,"dataList")&&Object.prototype.hasOwnProperty.call(f,"name")){var F,z,H=Object(Be.a)(null===(F=l.chartData[h])||void 0===F?void 0:F.type);if(C()(H))return;var U={idx:R()(l.subChartSeriesLength),order:R()(l.subChartSeriesLength),seriesText:{value:f.name},categories:c.map((function(e,t){var i,n;return{categoryPoint:{value:e},valuePoint:{value:null!==(i=null===(n=s[Number(t)+1].cells[o])||void 0===n?void 0:n.text)&&void 0!==i?i:""}}}))};(null===(z=l.chartData[h])||void 0===z?void 0:z.type)===Ge.z.BubbleChart&&(U=Fe(Fe({},U),{},{bubbleSize:De.a.getSdkBubbleSize(c.map((function(e,t){var i,n;return null!==(i=null===(n=s[Number(t)+1].cells[o+1])||void 0===n?void 0:n.text)&&void 0!==i?i:""})))})),f=new H(U,{categoryPointList:c.map((function(e){return{value:C()(e)?"":e,formatCode:l.chartData[h].categoryFormatCode}})),count:c.length})}C()(n.seriesInfo)&&(n.seriesInfo=f),p.push(f.dataList),f.dataList=[],f.name=n.text||"",null!==(G=l.chartData[h])&&void 0!==G&&G.series&&(l.chartData[h].series[v]=f)}}})):Object.entries(n.cells).forEach((function(e){var t=r()(e,2),n=t[0],o=t[1];if(/\d+/.test(n)){var a=Number(n);if(0===a)l.chartData.forEach((function(e){e.series.forEach((function(e,t){var n,r,a=Number(i)-1,s=p[t],c=(null==s||null===(n=s[a])||void 0===n||null===(r=n.categoryPoint)||void 0===r?void 0:r.formatCode)||e.categoryFormatCode;e.dataList[a]={categoryPoint:{value:C()(c)?o.text:l.unformatValue(o.text)}}}))}));else{var s=l.getEditingSubChartIndexes(d?Math.floor((a+1)/2):a),c=s.currentSubChartIndex,u=s.currentSubChartSeriesIndex,h=B()(l.chartData,"[0].series[0].dataList.[".concat(Number(i)-1,"].categoryPoint.value")),v=l.seriesInfos[a-1];T()(o,"categoryPoint.value",null!=h?h:""),T()(o,"valuePoint.value",C()(null==v?void 0:v.valueFormatCode)?o.text:l.unformatValue(o.text)),C()(o.seriesInfo)&&(o.seriesInfo=l.seriesInfos[a-1]),d&&a%2==0?T()(l.chartData[c].series[u],"bubbleSize[".concat(Number(i)-1,"]"),o.text):(d&&a%2!=0&&a===l.seriesInfos.length&&T()(l.chartData[c].series[u],"bubbleSize",w()(l.AllChartSeries.length).map((function(){return"1"}))),l.chartData[c].series[u].dataList[Number(i)-1]=x()(o,["text","seriesInfo"]))}}}))})),this.handleSeriesIdAndName(s),this.handleTableArea(t,{row:h,column:v}),this.updateChartSDKData()}},{key:"addChartModel",value:function(e){this.editingChartModel=e,this.chartTableData=this.convertChartDataFromSDK(),this.subChartSeriesLength=this.chartData.map((function(e){return e.series.length}))}},{key:"switchShowChartEditModal",value:function(e){this.isShowChartEditModal=e}},{key:"clearChartModel",value:function(){var e,t;this.editingChartModel=null,this.isShowChartEditModal=!1,this.chartTableData={},this.subChartSeriesLength=[],this.isEdited=!1,this.seriesInfos=[],null===(e=this.spreadsheetInstance)||void 0===e||null===(t=e.unBindGlobalEvents)||void 0===t||t.call(e),this.spreadsheetInstance=null}},{key:"convertChartDataFromSDK",value:function(){var e=this;if(b()(this.editingChartModel))throw new Error("Accident manipulate chart data before double click chart");var t=this.editingChartModel.plotArea.charts,i=t[0].series[0],n=t[0].type===Ge.z.BubbleChart;if(C()(i))return{len:20,0:{cells:{}}};var r=i.categoryFormatCode,o=i.dataList.map((function(e){var t,i;return{value:null===(t=e.categoryPoint)||void 0===t?void 0:t.value,formatCode:(null===(i=e.categoryPoint)||void 0===i?void 0:i.formatCode)||r}})).map((function(e){var t=e.value,i=e.formatCode;return Object(je.b)(t,i)})),a=[],l=[];t.forEach((function(e){e.series.forEach((function(e,t){var i;(a.push(e.name),l.push(e.dataList),n)&&(a.push("大小".concat(0===t?"":t+1)),l.push(null===(i=e.bubbleSize)||void 0===i?void 0:i.map((function(t,i){var n;return{categoryPoint:{value:null===(n=e.dataList[i].categoryPoint)||void 0===n?void 0:n.value},valuePoint:{value:t}}}))))}))}));var s=M.a.apply(void 0,l),c={len:o.length+1>=20?o.length+1:20,0:{cells:{}}};return a.forEach((function(t,i){c[0].cells[i+1]={text:t||"",seriesInfo:n?e.AllChartSeries[Math.floor(i/2)]:e.AllChartSeries[i]}})),o.forEach((function(t,i){c[i+1]||(c[i+1]={cells:{0:{text:t||""}}}),s[i].forEach((function(t,r){var o,a=null==t||null===(o=t.valuePoint)||void 0===o?void 0:o.value;c[i+1].cells[r+1]=Fe({text:C()(a)||""===a?"":String(Object(je.b)(a)),seriesInfo:n?e.AllChartSeries[Math.floor(r/2)]:e.AllChartSeries[r]},t)}))})),c}},{key:"updateChartSDKData",value:function(){this.chartData.forEach((function(e){e.updateSeriesWithNewEditValue();var t=e.getSeriesSdkData();e.replaceSeries(t)})),Object(Te.c)({opername:Pe.e.DOC_PPT,module:Pe.d.CHART,action:Pe.b.CHART_EDITED})}},{key:"getEditingSubChartIndexes",value:function(e){for(var t=0,i=0,n=0,r=0;r<this.subChartSeriesLength.length;r++){var o=this.subChartSeriesLength[r];if(e<=n+o){i=e-n-1;break}if(r===this.subChartSeriesLength.length-1&&e>n)return{currentSubChartIndex:t,currentSubChartSeriesIndex:e-n-1,sumSeriesLength:n};n+=o,t+=1}return{currentSubChartIndex:t,currentSubChartSeriesIndex:i,sumSeriesLength:n}}},{key:"openChartDataEditor",value:function(e){var t;(this.addChartModel(e),this.isShowChartEditModal)?null===(t=this.spreadsheetInstance)||void 0===t||t.loadData([{rows:this.chartTableData}]):(this.switchShowChartEditModal(!0),Object(Te.c)({opername:Pe.e.DOC_PPT,module:Pe.d.CHART,action:Pe.b.OPEN_CHART_EDIT_PANEL}))}}]),e}(),Ae=g()(Oe.prototype,"editingChartModel",[y.q,pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=g()(Oe.prototype,"isShowChartEditModal",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g()(Oe.prototype,"chartData",[y.f,ge,ye],Object.getOwnPropertyDescriptor(Oe.prototype,"chartData"),Oe.prototype),g()(Oe.prototype,"AllChartSeries",[y.f,me,be],Object.getOwnPropertyDescriptor(Oe.prototype,"AllChartSeries"),Oe.prototype),g()(Oe.prototype,"addChartModel",[y.d,Se,Me],Object.getOwnPropertyDescriptor(Oe.prototype,"addChartModel"),Oe.prototype),g()(Oe.prototype,"switchShowChartEditModal",[y.d,Ee,Ce],Object.getOwnPropertyDescriptor(Oe.prototype,"switchShowChartEditModal"),Oe.prototype),g()(Oe.prototype,"clearChartModel",[y.d,ke,we],Object.getOwnPropertyDescriptor(Oe.prototype,"clearChartModel"),Oe.prototype),g()(Oe.prototype,"convertChartDataFromSDK",[y.d,Ie,xe],Object.getOwnPropertyDescriptor(Oe.prototype,"convertChartDataFromSDK"),Oe.prototype),Oe);t.a=ze},"29ba904551":function(e,t,i){(t=e.exports=i("9dddfe0040")(!1)).push([e.i,".author-tag-author-tag-3U2_b{padding:0 6px;display:block;position:absolute;font-size:10px;color:#fff;word-break:keep-all;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-radius:1px;border:0;height:19px;line-height:19px;max-width:160px;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;background:red}.author-tag-author-tag-3U2_b.author-tag-fade-in-3y4Th{-webkit-animation-name:author-tag-history-author-fade-in-3gXyt;animation-name:author-tag-history-author-fade-in-3gXyt}.author-tag-author-tag-3U2_b.author-tag-fade-out-2zLYS{-webkit-animation-name:author-tag-history-auth-fade-out-OJPhD;animation-name:author-tag-history-auth-fade-out-OJPhD}@-webkit-keyframes author-tag-history-author-fade-in-3gXyt{0%{opacity:0}to{opacity:1}}@keyframes author-tag-history-author-fade-in-3gXyt{0%{opacity:0}to{opacity:1}}@-webkit-keyframes author-tag-history-auth-fade-out-OJPhD{0%{opacity:1}to{opacity:0}}@keyframes author-tag-history-auth-fade-out-OJPhD{0%{opacity:1}to{opacity:0}}",""]),t.locals={"author-tag":"author-tag-author-tag-3U2_b","fade-in":"author-tag-fade-in-3y4Th","history-author-fade-in":"author-tag-history-author-fade-in-3gXyt","fade-out":"author-tag-fade-out-2zLYS","history-auth-fade-out":"author-tag-history-auth-fade-out-OJPhD"}},"2bf8beaf9d":function(e,t,i){"use strict";i.d(t,"a",(function(){return xe}));var n=i("14502724a6"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("85d0a7609b"),d=i.n(c),u=(i("8e7cce0ada"),i("29f8c5f672"),i("c6244f7705"),i("85d48ef22b"),i("2a6f332b5e"),i("8ee19818c4"),i("a2a09da1e3"),i("6e20b6a7d8"),i("75563bc376"),i("eb9e932508"),i("963f2eaace"),i("3bf1976a4f"),i("516fa97df2")),h=i("c195ed2318"),v=i("23171a4a19"),f=i("1068873c4f"),p=i("0a8ecd6412"),g=i("d5c3deb8c7"),y=i("2d47c066fb"),m=i("5b326a30b1"),b=i("e0e8dd9366"),S=i("60c7ba094c"),M=(i("73b854064b"),i("547611bd96")),E=i.n(M),C=i("8eec1e4a03"),k=i.n(C),w=i("bd29e2df90"),I=i.n(w),x=i("ab5eb40518"),O=i.n(x),A=i("1b4cdd6a36"),L=i.n(A),R=i("6d1a03b824"),D=i("f9193d718f");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=L()(e);if(t){var r=L()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return O()(this,i)}}var P=function(e){I()(i,e);var t=T(i);function i(e){var n,r;return a()(this,i),r=t.call(this),d()(E()(r),"masterGuideComponent",void 0),d()(E()(r),"layoutGuideComponent",void 0),d()(E()(r),"slideGuideComponent",void 0),d()(E()(r),"guidesManager",void 0),d()(E()(r),"scale",void 0),d()(E()(r),"renderEventComponent",(function(){var e;null!==(e=r.getAppService().editableServiceLayer)&&void 0!==e&&e.guidesManager&&r.renderGuideComponent()})),d()(E()(r),"renderGuideComponent",(function(){r.slideGuideComponent?r.slideGuideComponent.renderGuides():(r.slideGuideComponent=new R.b({type:R.a.slide,isUiComponent:!1}),r.addChild(r.slideGuideComponent)),r.masterGuideComponent?r.masterGuideComponent.renderGuides():(r.masterGuideComponent=new R.b({type:R.a.master,isUiComponent:!1}),r.addChild(r.masterGuideComponent)),r.layoutGuideComponent?r.layoutGuideComponent.renderGuides():(r.layoutGuideComponent=new R.b({type:R.a.layout,isUiComponent:!1}),r.addChild(r.layoutGuideComponent))})),d()(E()(r),"getAppService",(function(){return D.a.getInstance().getAppServices()})),r.guidesManager=null===(n=r.getAppService().editableServiceLayer)||void 0===n?void 0:n.guidesManager,r.renderEventComponent(),r}return s()(i,[{key:"dispose",value:function(){k()(L()(i.prototype),"dispose",this).call(this)}}]),i}(u.k),B=i("f59de93b62"),G=200,j=function(){function e(t){var i,n,r,o,l,s=this;a()(this,e),d()(this,"application",void 0),d()(this,"slide",void 0),d()(this,"canvasDom",void 0),d()(this,"slideComponent",void 0),d()(this,"eventComponent",void 0),d()(this,"asyncBuild",void 0),d()(this,"props",void 0),d()(this,"slideSizeType",void 0),d()(this,"left",void 0),d()(this,"top",void 0),d()(this,"hasWrapperBuild",void 0),d()(this,"needRender",void 0),d()(this,"isDisplay",void 0),d()(this,"canvasSize",void 0),d()(this,"lastScrollX",void 0),d()(this,"lastScrollY",void 0),d()(this,"currentTranslateX",0),d()(this,"currentTranslateY",0),d()(this,"needUpdatePosition",void 0),d()(this,"getBackgroundAppService",(function(){return s.props.stableLayer.backgroundManager.getBackgroundFromCache(s.slide)})),d()(this,"getMasterAppService",(function(){return s.props.stableLayer.masterManager.getMasterFromCache(s.slide.getRelationMasterModel())})),d()(this,"getLayoutAppService",(function(){return s.props.stableLayer.layoutManager.getLayoutFromCache(s.slide.getRelationLayoutModel())})),d()(this,"getStableLayerService",(function(){return s.props.stableLayer.getStableLayerService(s.slide)})),d()(this,"forceReloadWithoutSelfChange",(function(e){var t,i,n=e;S.a.hasChangeAtPath(n,"showMasterSp")&&(null===(t=s.props.stableLayer)||void 0===t||null===(i=t.reloadMasterComponent)||void 0===i||i.call(t,s.slide))})),d()(this,"getApplication",(function(){return s.application})),d()(this,"clearAllComponentCache",(function(e){s.application.stage.transform.scaleX!==s.props.scale&&(e||[]).forEach((function(e){var t;null!=e&&null!==(t=e.cache)&&void 0!==t&&t.isValid&&e.cache.clear(),e.children&&s.clearAllComponentCache(e.children)}))})),d()(this,"onWillRenderCallback",(function(e){var t,i;null===(t=(i=s.props).onSlideWillRender)||void 0===t||t.call(i,e.options.slideModel)})),d()(this,"onDidRenderCallback",(function(e){var t,i;null===(t=(i=s.props).onSlideDidRender)||void 0===t||t.call(i,e)})),this.props=t,this.slide=t.slide,this.hasWrapperBuild=!1,this.slideSizeType=null!==(i=null===(n=this.slide.presentationRef)||void 0===n?void 0:n.props.slideSizeType)&&void 0!==i?i:m.a.SLIDE_SIZE_16_9;var c=null===(r=this.props.services.editAreaCanvasSizeManager)||void 0===r?void 0:r.getCanvasSize();this.left=null!==(o=null==c?void 0:c.slideLeft)&&void 0!==o?o:0,this.top=null!==(l=null==c?void 0:c.slideTop)&&void 0!==l?l:0,this.canvasDom=document.createElement("canvas"),this.canvasDom.id="".concat(y.o,"-").concat(this.slide.key),this.canvasDom.style.position="absolute",this.canvasDom.style.left="0",this.canvasDom.style.top="0",this.canvasDom.style.display="none";var h=new f.c;this.application=new u.a(h,{interactive:!1,native:this.canvasDom,delayDrawHit:!1}),this.updateInfo(t.scale,t.contentSize,t.viewportSize),this.application.resolution=Math.ceil(window.devicePixelRatio),this.application.stage.forceRenderOutsideView=!0,this.slide.childrenConverted?this.doAfterConverted():this.addConvertObserver()}return s()(e,[{key:"addConvertObserver",value:function(){var e=this,t=Object(g.r)((function(){return e.slide.childrenConverted}),(function(i){i&&(e.doAfterConverted(),null==t||t())}))}},{key:"mountSlide",value:function(){var e,t;(this.hasWrapperBuild||(this.asyncBuild=!1,this.build()),this.needRender)?(this.clearAllComponentCache(this.application.stage.children),this.application.stage.transform.scaleX=this.props.scale,this.application.stage.transform.scaleY=this.props.scale,this.updateCanvasPosition(),this.slideComponent.display(),0===this.application.stage.children.length&&(this.application.stage.addChild(this.slideComponent),this.renderEventArea()),this.eventComponent.renderEventComponent(),null!==(e=(t=this.props).needSyncRender)&&void 0!==e&&e.call(t)?this.application.requestRender():this.application.render(),this.needRender=!1):this.props.canvasWrapper.style.transform="translate(".concat(this.currentTranslateX,"px, ").concat(this.currentTranslateY,"px)")}},{key:"renderEventArea",value:function(){this.eventComponent?this.eventComponent.renderEventComponent():(this.eventComponent=new P({}),this.eventComponent.x=0,this.eventComponent.y=0,this.application.stage.addChildAt(this.eventComponent,0))}},{key:"display",value:function(){var e=this;this.isDisplay=!0,this.mountSlide(),this.canvasDom.style.display="block",this.application.interactive||(this.application.interactive=!0,requestAnimationFrame((function(){e.application.hitView&&e.application.stage.renderHit(e.application.hitView)})))}},{key:"hidden",value:function(){this.isDisplay=!1,this.canvasDom.style.display="none",this.application.interactive=!1}},{key:"dispose",value:function(){var e,t,i,n,r,o;this.application.view.width=0,this.application.view.height=0,this.application.dispose(),null===(e=this.slideComponent)||void 0===e||null===(t=e.dispose)||void 0===t||t.call(e),null===(i=this.eventComponent)||void 0===i||null===(n=i.dispose)||void 0===n||n.call(i),null===(r=this.canvasDom.parentNode)||void 0===r||r.removeChild(this.canvasDom),null===(o=this.getSlideRenderStateManager())||void 0===o||o.resetEditSlideRenderCompletePromise(this.slide.key)}},{key:"updateInfo",value:function(e,t,i){var n,r,o,a,l;this.updateCanvasSize(t,i);var s=null!==(n=null===(r=this.slide.presentationRef)||void 0===r?void 0:r.props.slideSizeType)&&void 0!==n?n:m.a.SLIDE_SIZE_16_9,c=null===(o=this.props.services.editAreaCanvasSizeManager)||void 0===o?void 0:o.getCanvasSize(),d=null!==(a=null==c?void 0:c.slideLeft)&&void 0!==a?a:0,u=null!==(l=null==c?void 0:c.slideTop)&&void 0!==l?l:0;this.props.contentSize=t,this.props.viewportSize=i,this.application.notRenderOutsideView=!this.isSmallCanvas(),this.application.width===this.canvasSize.width&&this.application.height===this.canvasSize.height&&Math.abs(this.props.scale-e)<1e-6&&this.slideSizeType===s&&this.left===d&&this.top===u||(this.props.scale=e,this.slideSizeType=s,this.left=d,this.top=u,this.application.width=this.canvasSize.width,this.application.height=this.canvasSize.height,this.needRender=!0,this.needUpdatePosition=!0)}},{key:"updatePosition",value:function(){this.isSmallCanvas()||(this.needUpdatePosition||this.isVerticalScrollToEdge()||this.isHorizontalScrollToEdge())&&(this.updateCanvasPosition(),this.needUpdatePosition=!1)}},{key:"getScale",value:function(){return this.props.scale}},{key:"buildStableLayer",value:function(){var e;null===(e=this.props.stableLayer)||void 0===e||e.buildStableLayer({slideModel:this.slide,masterModel:this.slide.type===b.d.MASTER?void 0:this.slide.getRelationMasterModel(),layoutModel:this.slide.type===b.d.LAYOUT?void 0:this.slide.getRelationLayoutModel()})}},{key:"updateCanvasPosition",value:function(){var e,t,i,n=this.getPcScrollService(),r=n.currentScrollX,o=n.currentScrollY,a=this.isSmallCanvas()?0:Math.min(Math.max(-r+this.canvasSize.left,0),this.props.contentSize.width-this.canvasSize.width),l=this.isSmallCanvas()?0:Math.min(Math.max(-o+this.canvasSize.top,0),this.props.contentSize.height-this.canvasSize.height);this.props.canvasWrapper.style.transform="translate(".concat(a,"px, ").concat(l,"px)");var s=null===(e=this.props.services.editAreaCanvasSizeManager)||void 0===e?void 0:e.getCanvasSize(),c=null!==(t=null==s?void 0:s.slideLeft)&&void 0!==t?t:0,d=null!==(i=null==s?void 0:s.slideTop)&&void 0!==i?i:0;this.slideComponent.x=(c-a)/this.props.scale,this.slideComponent.y=(d-l)/this.props.scale,this.lastScrollX=r,this.lastScrollY=o,this.currentTranslateX=a,this.currentTranslateY=l,this.getPcScrollService().updateCurrentCanvasTranslate(a,l)}},{key:"isSmallCanvas",value:function(){return this.props.contentSize.width===this.canvasSize.width&&this.props.contentSize.height===this.canvasSize.height}},{key:"updateCanvasSize",value:function(e,t){var i=e.width,n=e.height,r=Math.round(Math.min(3*t.width,i)),o=Math.round(Math.min(3*t.height,n)),a=Math.min(-(r-t.width)/2,0),l=Math.min(-(o-t.height)/2,0);this.canvasSize={width:r,height:o,left:a,top:l}}},{key:"isVerticalScrollToEdge",value:function(){var e=this.getPcScrollService().currentScrollY,t=-this.lastScrollY-this.currentTranslateY,i=this.canvasSize.height-this.props.viewportSize.height-t,n=this.lastScrollY-e>0&&this.currentTranslateY<this.props.contentSize.height-this.canvasSize.height&&Math.abs(this.lastScrollY-e)>=i-G,r=this.lastScrollY-e<0&&this.currentTranslateY>0&&Math.abs(this.lastScrollY-e)>=t-G;return n||r}},{key:"isHorizontalScrollToEdge",value:function(){var e=this.getPcScrollService().currentScrollX,t=-this.lastScrollX-this.currentTranslateX,i=this.canvasSize.width-this.props.viewportSize.width-t,n=this.lastScrollX-e>0&&this.currentTranslateX<this.props.contentSize.width-this.canvasSize.width&&Math.abs(this.lastScrollX-e)>=i-G,r=this.lastScrollX-e<0&&this.currentTranslateX>0&&Math.abs(this.lastScrollX-e)>=t-G;return n||r}},{key:"build",value:function(){this.hasWrapperBuild||(this.buildSlideComponent(),this.hasWrapperBuild=!0)}},{key:"doAfterConverted",value:function(){var e=this.isCurrentSlide();this.asyncBuild=!e,this.build(),this.buildStableLayer(),this.isDisplay&&(this.needRender=!0,this.display())}},{key:"isCurrentSlide",value:function(){return this.slide===this.props.services.selectionService.currentSlide}},{key:"buildSlideComponent",value:function(){var e,t,i,n,r,o,a=this,l=new v.a,s=null===(e=this.props.services.editAreaCanvasSizeManager)||void 0===e?void 0:e.getCanvasSize(),c=null!==(t=null==s?void 0:s.slideLeft)&&void 0!==t?t:0,d=null!==(i=null==s?void 0:s.slideTop)&&void 0!==i?i:0;this.slideComponent=new h.a({isMasterEdit:null===(n=this.getMasterLayoutEditService())||void 0===n?void 0:n.isMasterEditType,slideModel:this.slide,getPageScale:function(){return a.props.scale},getApplication:this.getApplication,forceReloadWithoutSelfChange:this.forceReloadWithoutSelfChange,region:p.s.CANVAS,fromScale:0,logicService:l,editLogic:new B.a(this.props.services.editorInstanceService),asyncBuild:this.asyncBuild,onWillRenderCallback:this.onWillRenderCallback,onDidRenderCallback:this.onDidRenderCallback,infrastructureService:this.props.services.infrastructureService,uiDataService:this.props.services.uiDataService,selectionService:this.props.services.selectionService,mediaManager:this.props.services.mediaManager,animManager:this.props.services.animManager,exportImageManager:this.props.services.exportImageManager,rightSideBarManager:this.props.services.rightSideBarManager,attachmentManager:this.props.services.attachmentManager,editingStateManager:this.props.services.editingStateManager,animBrushManager:this.props.services.animBrushManager,formatBrushManager:this.props.services.formatBrushManager,addonManager:this.props.services.addonManager,editorAnimPreviewManager:null===(r=(o=this.props.services).getEditorAnimPreviewManager)||void 0===r?void 0:r.call(o),previewService:this.props.services.previewService,textEditorStateService:this.props.services.textEditorStateService,historyManager:this.props.services.historyManager,copyPasteImageService:this.props.services.copyPasteImageService,masterLayoutEditService:this.props.services.masterLayoutEditService,fontManager:this.props.services.fontManager,linkManager:this.props.services.linkManager,accessibilityManager:this.props.services.accessibilityManager,undoRedoService:this.props.services.undoRedoService,textSelectionUndoRedo:this.props.services.textSelectionUndoRedo,editAreaCanvasSizeManager:this.props.services.editAreaCanvasSizeManager,renderEditorBackground:function(){a.props.stableLayer.backgroundManager.renderBackgroundByCache(a.slide)}}),this.slideComponent.x=c/this.props.scale,this.slideComponent.y=d/this.props.scale}},{key:"getPcScrollService",value:function(){return this.props.services.pcScrollService}},{key:"getMasterLayoutEditService",value:function(){var e;return null===(e=this.props.services)||void 0===e?void 0:e.masterLayoutEditService}},{key:"getSlideRenderStateManager",value:function(){return this.props.services.slideListRenderState}}]),e}(),N=i("3471fb3b60"),F=i("0928dbbaf6"),z=i("509a56a298"),H=i("6f73df7f8d");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=L()(e);if(t){var r=L()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return O()(this,i)}}var W=function(e){I()(i,e);var t=U(i);function i(e){var n;a()(this,i),n=t.call(this,e);var r=e.slide;return n.canvasDom.id="master-".concat(y.o,"-").concat(r.key),n}return s()(i,[{key:"buildMasterLayoutByCache",value:function(){}},{key:"reloadMasterComponent",value:function(){}},{key:"reloadLayoutComponent",value:function(){}}]),i}(j);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=L()(e);if(t){var r=L()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return O()(this,i)}}var Y=function(e){I()(i,e);var t=_(i);function i(e){var n;a()(this,i),n=t.call(this,e);var r=e.slide;return n.canvasDom.id="layout-".concat(y.o,"-").concat(r.key),n}return s()(i,[{key:"buildMasterLayoutByCache",value:function(){this.props.stableLayer.masterManager.buildMasterByCache(this.slide.getRelationMasterModel())}},{key:"reloadLayoutComponent",value:function(){}}]),i}(j),V=(i("b1e2246d82"),i("8aebbf296a"),i("a84962d637"),i("f45588a8ad"),i("de37db1287"),i("8a35b54c1d"),i("176815363d")),K=i.n(V),X=i("3ef2352f0b"),Q=i.n(X),Z=(i("081c8cafea"),i("342844cefa"),i("c554310b5c"),i("bcb5d93d36"),i("405b4a5e2b"),i("f40fd417a1")),q=i("145eddafd2"),J=i("06e1dc2299"),$=i("33c34da0d5");function ee(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function te(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ee(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=L()(e);if(t){var r=L()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return O()(this,i)}}var ne=function(e){I()(i,e);var t=ie(i);function i(e,n,r){var o;return a()(this,i),o=t.call(this),d()(E()(o),"scale",void 0),d()(E()(o),"slideModel",void 0),d()(E()(o),"whiteBackground",void 0),d()(E()(o),"component",void 0),d()(E()(o),"handleStableLayerUpdate",void 0),d()(E()(o),"sizeType",void 0),d()(E()(o),"sizeWidth",void 0),d()(E()(o),"sizeHeight",void 0),d()(E()(o),"renderBackgroundComponent",(function(){o.renderWhiteBackground();var e=Object(Z.b)(o.getAppServices().getUiDataService().presentation.props.slideWidth,o.getAppServices().getUiDataService().presentation.props.slideHeight,.2/o.scale),t=e.newWidth,i=e.newHeight,n=te(te({},o.slideModel.props.style),{},{width:t,height:i,bgShape:q.b.rect,editable:!1,selected:!1,shadeTitleFrame:o.slideModel.getBackgroundFill().getShadeTitleFrame()}),r=Object(J.a)({style:n});o.component?o.component.updateModel(r):(o.component=new $.d(r),o.addChild(o.component))})),d()(E()(o),"onUpdate",(function(){var e,t;null===(e=(t=o).handleStableLayerUpdate)||void 0===e||e.call(t,{slideModel:o.slideModel})})),o.slideModel=n,o.handleStableLayerUpdate=r,o._addUpdateListener(o.onUpdate),o.scale=e,o.sizeType=o.getAppServices().getUiDataService().presentation.props.slideSizeType,o.sizeWidth=o.getAppServices().getUiDataService().presentation.props.slideWidth,o.sizeHeight=o.getAppServices().getUiDataService().presentation.props.slideHeight,o}return s()(i,[{key:"updateInfo",value:function(e){var t=this.getAppServices().getUiDataService().presentation.props,i=t.slideSizeType,n=t.slideHeight,r=t.slideWidth;e===this.scale&&i===this.sizeType&&r===this.sizeWidth&&n===this.sizeHeight||(this.scale=e,this.sizeType=i,this.sizeWidth=r,this.sizeHeight=n,this.renderBackgroundComponent())}},{key:"renderWhiteBackground",value:function(){var e=this.getAppServices().getUiDataService().presentation.props,t=e.slideWidth,i=e.slideHeight,n=Object(Z.b)(t,i,.2/this.scale),r=n.newWidth,o=n.newHeight,a="M 0 0 L ".concat(r," 0 L ").concat(r," ").concat(o," L 0 ").concat(o," Z");this.whiteBackground?this.whiteBackground.path=a:(this.whiteBackground=new u.N(a),this.whiteBackground.fill=new u.i(u.h.White),this.addChild(this.whiteBackground))}},{key:"getAppServices",value:function(){return D.a.getInstance().getAppServices()}}]),i}(u.k),re=i("a9d1a34b6a"),oe=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;a()(this,e),d()(this,"scale",void 0),d()(this,"renderArea",void 0),d()(this,"slideModel",void 0),d()(this,"getApplication",void 0),d()(this,"handleStableLayerUpdate",void 0),d()(this,"removeListener",(function(){t.slideModel.changeSetEngine.removeChangesetObserver(t.handleSlideModelChange)})),d()(this,"getComponent",(function(){return t.renderArea})),d()(this,"renderBackgroundComponent",(function(){t.renderArea.renderBackgroundComponent()})),d()(this,"handleSlideModelChange",(function(){t.renderBackgroundComponent()})),d()(this,"addListener",(function(){t.slideModel.changeSetEngine.addChangesetObserver(t.handleSlideModelChange)})),this.slideModel=n,this.scale=i,this.slideModel=n,this.handleStableLayerUpdate=r,this.getApplication=o,this.addListener(),this.renderArea=new ne(this.scale,this.slideModel,this.handleStableLayerUpdate)}var t;return s()(e,[{key:"updateWithData",value:function(e){this.scale=e,this.renderArea.updateInfo(e)}},{key:"ensureRenderComplete",value:(t=K()(Q.a.mark((function e(){var t,i,n,r=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.length>0&&void 0!==r[0]&&r[0],n=re.a.promiseModelTreeImgLoaded(this.slideModel,!1),e.next=4,n;case 4:i&&(null===(t=this.getApplication)||void 0===t||t.call(this).render());case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),ae=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;a()(this,e),d()(this,"scale",void 0),d()(this,"backGroundCacheMap",void 0),d()(this,"currentSlideModel",void 0),d()(this,"handleStableLayerUpdate",void 0),d()(this,"getApplication",void 0),d()(this,"renderBackgroundByCache",(function(e){var i=t.getBackgroundFromCache(e);i?i.renderBackgroundComponent():t.buildBackgroundService(e)})),d()(this,"cleanBackground",(function(e){if(e){var i=t.backGroundCacheMap.get(e);i&&i.removeListener(),t.backGroundCacheMap.delete(e)}})),d()(this,"getBackgroundFromCache",(function(e){return t.backGroundCacheMap.get(e)})),d()(this,"buildBackgroundService",(function(e){var i=new oe(t.scale,e,t.handleStableLayerUpdate,t.getApplication);t.cacheBackground(e,i),t.getAppServices().viewableServiceLayer.selectionService.currentSlide===e&&t.updateBackground(),i.renderBackgroundComponent()})),d()(this,"updateBackground",(function(){var e=t.getAppServices().viewableServiceLayer.selectionService.currentSlide;if(e!==t.currentSlideModel&&e){t.currentSlideModel=e;var i=t.backGroundCacheMap.get(e);i?i.updateWithData(t.scale):(t.renderBackgroundByCache(e),t.updateBackground())}})),d()(this,"updateWithData",(function(e){t.scale=e,t.updateServiceInfo(t.currentSlideModel)})),d()(this,"getRenderComponent",(function(e){var i=t.getBackgroundFromCache(e);return null==i?void 0:i.getComponent()})),d()(this,"updateServiceInfo",(function(e){var i,n;e&&(null===(i=t.backGroundCacheMap.get(e))||void 0===i||null===(n=i.updateWithData)||void 0===n||n.call(i,t.scale))})),this.scale=i,this.handleStableLayerUpdate=n,this.backGroundCacheMap=new Map,this.getApplication=r}return s()(e,[{key:"cacheBackground",value:function(e,t){this.backGroundCacheMap.set(e,t)}},{key:"getAppServices",value:function(){return D.a.getInstance().getAppServices()}}]),e}(),le=(i("b8217400dc"),i("e6f68cdf2e"),i("2a875dc68f")),se=function(){function e(){var t,i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;a()(this,e),d()(this,"model",void 0),d()(this,"component",void 0),d()(this,"scale",void 0),d()(this,"getApplication",void 0),d()(this,"handleStableLayerUpdate",void 0),this.model=i,this.getApplication=n,this.handleStableLayerUpdate=r,this.buildElement(),null===(t=this.addObserver)||void 0===t||t.call(this)}var t;return s()(e,[{key:"getComponent",value:function(){return this.component}},{key:"updateWithData",value:function(e){this.reloadComponent(this.model),this.scale=e}},{key:"reloadComponent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.model;null===(e=this.component)||void 0===e||e.updateSlideModel(t,this.elementType)}},{key:"ensureRenderComplete",value:(t=K()(Q.a.mark((function e(){var t,i,n,r=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.length>0&&void 0!==r[0]&&r[0],n=re.a.promiseModelTreeImgLoaded({children:this.component.getElements()}),e.next=4,n;case 4:i&&(null===(t=this.getApplication)||void 0===t||t.call(this).render());case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"buildElement",value:function(){var e,t,i,n=this;this.component=new le.a(this.elementType,this.model,(function(){return n.scale}),this.getApplication,p.s.CANVAS,0,{infrastructureService:this.getAppServices().getInfrastructureService(),uiDataService:this.getAppServices().getUiDataService(),mediaManager:this.getAppServices().viewableServiceLayer.mediaManager,linkManager:this.getAppServices().viewableServiceLayer.linkManager,editingStateManager:this.getAppServices().viewableServiceLayer.editingStateManager,animBrushManager:null===(e=this.getAppServices().editableServiceLayer)||void 0===e?void 0:e.animBrushManager,formatBrushManager:null===(t=this.getAppServices().editableServiceLayer)||void 0===t?void 0:t.formatBrushManager,fontManager:this.getAppServices().viewableServiceLayer.fontManager,masterLayoutEditService:null===(i=this.getAppServices().editableServiceLayer)||void 0===i?void 0:i.masterLayoutEditService},!0,!1,this.handleStableLayerUpdate)}},{key:"addObserver",value:function(){var e=this;this.getAppServices().getUiDataService().presentation.convertMasterAndLayoutPromise.then((function(){var t;null===(t=e.model)||void 0===t||t.changeSetEngine.addChangesetObserver((function(){return e.reloadComponent()}))}))}},{key:"getAppServices",value:function(){return D.a.getInstance().getAppServices()}}]),e}();function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=L()(e);if(t){var r=L()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return O()(this,i)}}var de=function(e){I()(i,e);var t=ce(i);function i(){return a()(this,i),t.apply(this,arguments)}return s()(i,[{key:"elementType",get:function(){return b.d.MASTER}}]),i}(se),ue=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;a()(this,e),d()(this,"scale",void 0),d()(this,"masterCacheMap",void 0),d()(this,"currentMasterId",void 0),d()(this,"getApplication",void 0),d()(this,"handleStableLayerUpdate",void 0),d()(this,"getRenderComponent",(function(e){var i,n=t.getMasterFromCache(e);return n||(n=t.buildMasterByCache(e)),null===(i=n)||void 0===i?void 0:i.getComponent()})),this.scale=i,this.masterCacheMap={},this.getApplication=n,this.handleStableLayerUpdate=r}return s()(e,[{key:"buildMasterByCache",value:function(e){var t=this.getMasterFromCache(e);return t||(t=this.buildMasterService(e)),t}},{key:"getMasterFromCache",value:function(e){var t=this.getMasterId(e);return this.masterCacheMap[t]}},{key:"buildMasterService",value:function(e){var t=this.getMasterId(e);if(t){var i=new de(this.scale,e,this.getApplication,this.handleStableLayerUpdate);return this.cacheMaster(t,i),this.shouldDisplay(e)&&(this.updateMaster(e),i.reloadComponent(e)),i}}},{key:"updateMaster",value:function(e){var t=e?this.getMasterId(e):"";if(this.currentMasterId=t,t&&this.shouldDisplay(e)){var i=this.masterCacheMap[t];i?i.updateWithData(this.scale):(this.buildMasterByCache(e),this.updateMaster(e))}}},{key:"updateWithData",value:function(e){var t,i;this.scale=e,null===(t=this.masterCacheMap[this.currentMasterId])||void 0===t||null===(i=t.updateWithData)||void 0===i||i.call(t,e)}},{key:"shouldDisplay",value:function(e){var t,i,n=this.getAppServices().viewableServiceLayer.selectionService.currentSlide;null!=n&&n.isSlide?t=n.showMasterSp&&(null===(i=n.getRelationLayoutModel())||void 0===i?void 0:i.showMasterSp):t=null==n?void 0:n.showMasterSp;return(null==n?void 0:n.getRelationMasterModel())===e&&this.isSlideOrLayoutModel(n)&&t}},{key:"getMasterId",value:function(e){var t=null==e?void 0:e.presentationRef;if(t&&null!=e&&e.sdkData)return t.getMasterChildrenMapKey(e.sdkData)}},{key:"cacheMaster",value:function(e,t){this.masterCacheMap[e]=t}},{key:"isSlideOrLayoutModel",value:function(e){return!!e&&[b.d.SLIDE,b.d.LAYOUT].includes(e.type)}},{key:"getAppServices",value:function(){return D.a.getInstance().getAppServices()}}]),e}();i("22569efd03");function he(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=L()(e);if(t){var r=L()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return O()(this,i)}}var ve=function(e){I()(i,e);var t=he(i);function i(){return a()(this,i),t.apply(this,arguments)}return s()(i,[{key:"elementType",get:function(){return b.d.LAYOUT}}]),i}(se),fe=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;a()(this,e),d()(this,"scale",void 0),d()(this,"layoutCacheMap",void 0),d()(this,"currentLayoutId",void 0),d()(this,"getApplication",void 0),d()(this,"handleStableLayerUpdate",void 0),d()(this,"getRenderComponent",(function(e){var i,n=t.getLayoutFromCache(e);return n||(n=t.buildLayoutByCache(e)),null===(i=n)||void 0===i?void 0:i.getComponent()})),this.scale=i,this.layoutCacheMap={},this.getApplication=n,this.handleStableLayerUpdate=r,Object(g.r)((function(){var e;return[null===(e=t.getAppServices().getUiDataService().presentation.masterList[0])||void 0===e?void 0:e.uniqueID,t.getAppServices().getUiDataService().presentation.masterList.length,t.getAppServices().getUiDataService().presentation.layoutList.length]}),(function(){var e=function(e){-1===t.getAppServices().getUiDataService().presentation.layoutList.findIndex((function(i){return t.getLayoutId(i)===e}))&&(t.layoutCacheMap[e]=void 0)};for(var i in t.layoutCacheMap)e(i)}))}return s()(e,[{key:"buildLayoutByCache",value:function(e){var t=this.getLayoutFromCache(e);return t||(t=this.buildLayoutService(e)),t}},{key:"getLayoutFromCache",value:function(e){var t=this.getLayoutId(e);return this.layoutCacheMap[t]}},{key:"buildLayoutService",value:function(e){var t=this.getLayoutId(e);if(t){var i=new ve(this.scale,e,this.getApplication,this.handleStableLayerUpdate);this.cacheLayout(t,i);var n=this.getAppServices().viewableServiceLayer.selectionService.currentSlide;return(null==n?void 0:n.getRelationLayoutModel())===e&&this.isSlideModel(n)&&(this.updateLayout(e),i.reloadComponent(e)),i}}},{key:"updateLayout",value:function(e){var t=e?this.getLayoutId(e):"";if(this.currentLayoutId=t,t&&this.isSlideModel(this.getAppServices().viewableServiceLayer.selectionService.currentSlide)){var i=this.layoutCacheMap[t];i?i.updateWithData(this.scale):(this.buildLayoutByCache(e),this.updateLayout(e))}}},{key:"updateWithData",value:function(e){var t,i;this.scale=e,null===(t=this.layoutCacheMap[this.currentLayoutId])||void 0===t||null===(i=t.updateWithData)||void 0===i||i.call(t,e)}},{key:"getLayoutId",value:function(e){var t=null==e?void 0:e.presentationRef;if(t&&null!=e&&e.sdkData)return t.getLayoutChildrenMapKey(e.sdkData)}},{key:"cacheLayout",value:function(e,t){this.layoutCacheMap[e]=t}},{key:"isSlideModel",value:function(e){return e.type===b.d.SLIDE}},{key:"getAppServices",value:function(){return D.a.getInstance().getAppServices()}}]),e}(),pe=(i("63513d8b56"),i("fccb99d836")),ge=function(){function e(t){var i=this;a()(this,e),d()(this,"container",void 0),d()(this,"isDirty",void 0),d()(this,"stableLayerWrapper",void 0),d()(this,"backgroundManager",void 0),d()(this,"masterManager",void 0),d()(this,"layoutManager",void 0),d()(this,"application",void 0),d()(this,"scale",void 0),d()(this,"slideRefs",void 0),d()(this,"removeStableLayer",void 0),d()(this,"stableLayerComponent",void 0),d()(this,"getApplication",(function(){return i.application})),this.stableLayerWrapper=t.stableLayerWrapper,this.backgroundManager=t.backgroundManager,this.masterManager=t.masterManager,this.layoutManager=t.layoutManager,this.scale=t.scale,this.removeStableLayer=t.removeStableLayer,this.container=new u.k,this.isDirty=!1,this.slideRefs=[],this.buildApplication()}return s()(e,[{key:"updateInfo",value:function(e){e!==this.scale&&(this.scale=e,this.isDirty=!0)}},{key:"show",value:function(){this.application.view.native.style&&(this.application.view.native.style.display="block")}},{key:"hide",value:function(){this.application.view.native.style&&(this.application.view.native.style.display="none")}},{key:"render",value:function(e){var t=this;this.isDirty=!1,this.stableLayerComponent=this.getStableLayerComponent(e),this.container.children.forEach((function(e){return t.container.removeChild(e)})),this.container.x=0,this.container.y=0,this.stableLayerComponent.backgroundComponent&&this.container.addChild(this.stableLayerComponent.backgroundComponent),this.stableLayerComponent.masterComponent&&this.container.addChild(this.stableLayerComponent.masterComponent),this.stableLayerComponent.layoutComponent&&this.container.addChild(this.stableLayerComponent.layoutComponent),this.application.stage.addChild(this.container),this.application.stage.transform.scaleX=this.scale,this.application.stage.transform.scaleY=this.scale;var i=this.container.filterWorldBounds,n=i.width,r=i.height,o=i.x,a=i.y;this.container.x=-o/this.scale,this.container.y=-a/this.scale,pe.a.isExportingToImage||(this.application.width=Math.round(n),this.application.height=Math.round(r),this.application.render())}},{key:"dispose",value:function(){var e,t;(this.application.view.width=0,this.application.view.height=0,this.stableLayerWrapper.removeChild(this.application.view.native),this.container.children.length>0)&&(null!==(e=this.stableLayerComponent)&&void 0!==e&&e.masterComponent&&this.container.removeChild(this.stableLayerComponent.masterComponent),null!==(t=this.stableLayerComponent)&&void 0!==t&&t.layoutComponent&&this.container.removeChild(this.stableLayerComponent.layoutComponent));this.stableLayerComponent=null,this.application.dispose()}},{key:"addSlideModel",value:function(e){-1===this.slideRefs.indexOf(e)&&this.slideRefs.push(e)}},{key:"removeSlideModel",value:function(e){var t=this.slideRefs.indexOf(e);-1!==t&&(this.slideRefs.splice(t,1),0===this.slideRefs.length&&this.removeStableLayer(this))}},{key:"getStableLayerComponent",value:function(e){var t,i,n,r,o,a,l,s=e.slideModel,c=e.masterModel,d=e.layoutModel,u=null===(t=(i=this.layoutManager).getRenderComponent)||void 0===t?void 0:t.call(i,d),h=null===(n=(r=this.masterManager).getRenderComponent)||void 0===n?void 0:n.call(r,c),v=null===(o=(a=this.backgroundManager).getRenderComponent)||void 0===o?void 0:o.call(a,s),f=null==s||null===(l=s.getRelationLayoutModel())||void 0===l?void 0:l.showMasterSp,p=null==s?void 0:s.showMasterSp;return{layoutComponent:p?u:void 0,masterComponent:f&&p?h:void 0,backgroundComponent:v}}},{key:"buildApplication",value:function(){var e=document.createElement("canvas");e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.display="none",e.id="stable-layer";var t=new f.c;this.application=new u.a(t,{native:e,interactive:!1,autoRender:!1}),this.application.resolution=Math.ceil(window.devicePixelRatio),this.stableLayerWrapper.append(e)}}]),e}(),ye=i("2ba7871556");function me(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return be(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return be(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(l)throw o}}}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var Se=["shadeToTitle","colorType","colorValue","alpha","lumMod","lumOff","shade","id","rotateWithShape","rotWithShape","syncLoad"],Me=function(){function e(t){var i=this;a()(this,e),d()(this,"backgroundManager",void 0),d()(this,"masterManager",void 0),d()(this,"layoutManager",void 0),d()(this,"stableLayerMap",new Map),d()(this,"slideStableLayerMap",new Map),d()(this,"container",void 0),d()(this,"currentLayer",void 0),d()(this,"props",void 0),d()(this,"handleStableLayerUpdate",(function(e){var t=i.getValueFromProps(e);if(i.updateStableLayerProps(t),t.slideModel){var n=i.generateKey(t),r=i.stableLayerMap.get(n),o=t.slideModel,a=i.slideStableLayerMap.get(o),l=i.props.services.selectionService.currentSlide;if(r){var s;if(t.slideModel===l&&a!==r)null===(s=i.currentLayer)||void 0===s||s.hide(),null==a||a.removeSlideModel(o),i.slideStableLayerMap.set(o,r),i.currentLayer=r,i.currentLayer.addSlideModel(o),i.currentLayer.show();r.render(t),!pe.a.isExportingToImage&&i.updateTranslate()}else t.slideModel===l&&i.updateStableLayer(t.slideModel)}})),d()(this,"removeStableLayer",(function(e){var t,n=me(i.stableLayerMap.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(i.stableLayerMap.get(r)===e)return e.dispose(),void i.stableLayerMap.delete(r)}}catch(e){n.e(e)}finally{n.f()}})),this.props=t,this.container=new u.k,this.initBackgroundManager(),this.initMasterManager(),this.initLayoutManager()}return s()(e,[{key:"updateWithData",value:function(e){var t,i,n,r;this.props.scale=e,null===(t=this.currentLayer)||void 0===t||t.updateInfo(e),null===(i=this.backgroundManager)||void 0===i||i.updateWithData(this.props.scale),null===(n=this.masterManager)||void 0===n||n.updateWithData(this.props.scale),null===(r=this.layoutManager)||void 0===r||r.updateWithData(this.props.scale)}},{key:"updateStableLayer",value:function(e){var t,i,n,r,o;if(e){null===(t=this.currentLayer)||void 0===t||t.hide();var a={slideModel:e,masterModel:e.type===b.d.MASTER?void 0:e.getRelationMasterModel(),layoutModel:e.type===b.d.LAYOUT?void 0:e.getRelationLayoutModel()},l=this.generateKey(a),s=this.stableLayerMap.get(l);s||((s=this.buildStableLayerService(l)).isDirty=!0);var c=this.slideStableLayerMap.get(e);c&&c!==s&&(c.removeSlideModel(e),this.slideStableLayerMap.set(e,s)),this.currentLayer=s,null===(i=this.currentLayer)||void 0===i||i.updateInfo(this.props.scale),this.currentLayer.addSlideModel(e),null===(n=this.masterManager)||void 0===n||n.updateMaster(null==e?void 0:e.getRelationMasterModel()),null===(r=this.layoutManager)||void 0===r||r.updateLayout(null==e?void 0:e.getRelationLayoutModel()),null===(o=this.backgroundManager)||void 0===o||o.updateBackground(),s.isDirty&&s.render(a),this.updateTranslate(),this.currentLayer.show()}}},{key:"buildStableLayer",value:function(e){var t=e.slideModel,i=e.masterModel,n=e.layoutModel;this.masterManager.buildMasterByCache(i),this.layoutManager.buildLayoutByCache(n),this.backgroundManager.renderBackgroundByCache(t);var r=this.generateKey(e);if(this.stableLayerMap.has(r)){var o=this.stableLayerMap.get(r);return this.slideStableLayerMap.set(t,o),void o.addSlideModel(t)}var a=this.buildStableLayerService(r);this.slideStableLayerMap.set(t,a),a.addSlideModel(t),a.render(e)}},{key:"cleanCache",value:function(e){if(e){this.backgroundManager.cleanBackground(e);var t=this.slideStableLayerMap.get(e);null==t||t.removeSlideModel(e),this.slideStableLayerMap.delete(e)}}},{key:"reloadMasterComponent",value:function(e){var t,i=e.getRelationMasterModel();null===(t=this.masterManager.getMasterFromCache(i))||void 0===t||t.reloadComponent(i);var n={slideModel:e,masterModel:i,layoutModel:e.type===b.d.LAYOUT?void 0:e.getRelationLayoutModel()},r=this.generateKey(n),o=this.stableLayerMap.get(r);o&&o.render(n)}},{key:"getStableLayerService",value:function(e){return this.slideStableLayerMap.get(e)}},{key:"updateTranslate",value:function(){var e,t,i,n,r,o,a,l=null===(e=this.props.services.editAreaCanvasSizeManager)||void 0===e?void 0:e.getCanvasSize(),s=null!==(t=null==l?void 0:l.slideLeft)&&void 0!==t?t:0,c=null!==(i=null==l?void 0:l.slideTop)&&void 0!==i?i:0,d=s-((null===(n=this.currentLayer)||void 0===n||null===(r=n.container)||void 0===r?void 0:r.x)||0)*this.props.scale,u=c-((null===(o=this.currentLayer)||void 0===o||null===(a=o.container)||void 0===a?void 0:a.y)||0)*this.props.scale;this.props.updateStableLayerTranslate(d,u)}},{key:"updateStableLayerProps",value:function(e){e.slideModel?(e.masterModel=e.slideModel.type===b.d.MASTER?void 0:e.slideModel.getRelationMasterModel(),e.layoutModel=e.slideModel.type===b.d.LAYOUT?void 0:e.slideModel.getRelationLayoutModel(),e.slideModel.type===b.d.MASTER?this.updateFlagWhenMasterChange(e.slideModel):e.slideModel.type===b.d.LAYOUT&&this.updateFlagWhenLayoutChange(e.slideModel)):(this.handleMasterChange(e),this.handleLayoutChange(e))}},{key:"handleMasterChange",value:function(e){if(e.masterModel){this.updateFlagWhenMasterChange(e.masterModel);var t=this.props.services.selectionService.currentSlide;(null==t?void 0:t.getRelationMasterModel())===e.masterModel&&(e.slideModel=t,e.layoutModel=t.getRelationLayoutModel())}}},{key:"handleLayoutChange",value:function(e){if(e.layoutModel){this.updateFlagWhenLayoutChange(e.layoutModel);var t=this.props.services.selectionService.currentSlide;(null==t?void 0:t.getRelationLayoutModel())===e.layoutModel&&(e.slideModel=t,e.masterModel=t.getRelationMasterModel())}}},{key:"updateFlagWhenMasterChange",value:function(e){var t=this;this.props.services.uiDataService.presentation.children.filter((function(t){return t.getRelationMasterModel()===e})).forEach((function(i){var n={slideModel:i,masterModel:e,layoutModel:i.getRelationLayoutModel()},r=t.generateKey(n),o=t.stableLayerMap.get(r);o&&(o.isDirty=!0)})),this.props.services.uiDataService.presentation.layoutList.filter((function(t){return t.getRelationMasterModel()===e})).forEach((function(i){var n={slideModel:i,masterModel:e,layoutModel:void 0},r=t.generateKey(n),o=t.stableLayerMap.get(r);o&&(o.isDirty=!0)}))}},{key:"updateFlagWhenLayoutChange",value:function(e){var t=this;this.props.services.uiDataService.presentation.children.filter((function(t){return t.getRelationLayoutModel()===e})).forEach((function(i){var n={slideModel:i,masterModel:i.getRelationMasterModel(),layoutModel:e},r=t.generateKey(n),o=t.stableLayerMap.get(r);o&&(o.isDirty=!0)}))}},{key:"buildStableLayerService",value:function(e){var t=new ge({stableLayerWrapper:this.props.elementWrapper,backgroundManager:this.backgroundManager,masterManager:this.masterManager,layoutManager:this.layoutManager,scale:this.props.scale,removeStableLayer:this.removeStableLayer});return this.stableLayerMap.set(e,t),t}},{key:"generateKey",value:function(e){var t=e.slideModel,i=e.masterModel,n=e.layoutModel,r=this.masterManager.getMasterId(i),o=this.layoutManager.getLayoutId(n),a=null==t?void 0:t.getBackgroundFill().getFillInfo(),l="";try{var s,c;l=JSON.stringify(a,(function(e,t){if(-1===Se.indexOf(e))return t}));var d=(null==a||null===(s=a.gradFill)||void 0===s||null===(c=s.pathGradient)||void 0===c?void 0:c.path)===ye.c.Shape?null==t?void 0:t.getBackgroundFill().getShadeTitleFrame():void 0;l+=JSON.stringify(d)}catch(e){l=null==t?void 0:t.key,window.log.error("[stable-layer]generate key error: ".concat(e))}return"".concat(r,"_").concat(o,"_").concat(l,"_").concat((null==t?void 0:t.showMasterSp)||0)}},{key:"initBackgroundManager",value:function(){this.backgroundManager=new ae(this.props.scale,this.handleStableLayerUpdate,this.props.getApplication)}},{key:"initMasterManager",value:function(){this.masterManager=new ue(this.props.scale,this.props.getApplication,this.handleStableLayerUpdate)}},{key:"initLayoutManager",value:function(){this.layoutManager=new fe(this.props.scale,this.props.getApplication,this.handleStableLayerUpdate)}},{key:"getValueFromProps",value:function(e){var t,i,n;if(!e.fromInheritLayer)return e;var r=null===(t=this.props.services.masterLayoutEditService)||void 0===t?void 0:t.isMasterEditType;return{slideModel:r?e.slideModel:void 0,masterModel:(null===(i=e.slideModel)||void 0===i?void 0:i.type)!==b.d.MASTER||r?void 0:e.slideModel,layoutModel:(null===(n=e.slideModel)||void 0===n?void 0:n.type)!==b.d.LAYOUT||r?void 0:e.slideModel}}}]),e}(),Ee=i("1288bffff3"),Ce=function(){function e(t,i,n){var r=this;a()(this,e),d()(this,"cache",void 0),d()(this,"capacity",void 0),d()(this,"handleEditorCacheDelete",void 0),d()(this,"getReserveSlideIndexRange",void 0),d()(this,"handleVisibilityChange",(function(){if(document.hidden){var e,t=null===(e=r.getReserveSlideIndexRange)||void 0===e?void 0:e.call(r);if(!t)return;r.cache.forEach((function(e,i){-1===t.indexOf(i.key)&&r.deleteCache(e)}))}})),this.cache=new Map,this.capacity=t,this.handleEditorCacheDelete=i,this.getReserveSlideIndexRange=n,document.addEventListener("visibilitychange",this.handleVisibilityChange)}return s()(e,[{key:"dispose",value:function(){var e=this;document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.cache.forEach((function(t){e.deleteCache(t)}))}},{key:"shouldCacheEditor",value:function(e){return e.slide.elementNumInfo.totel>100}},{key:"cacheEditor",value:function(e){var t=e.slide;this.cache.has(t)&&this.cache.delete(t),this.cache.size>=this.capacity&&this.deleteCache(this.cache.keys().next().value),this.cache.set(t,e)}},{key:"hasCache",value:function(e){var t=e.slide;if(this.cache.has(t)){var i=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,i),!0}return!1}},{key:"deleteCache",value:function(e){var t,i=e.slide;this.cache.has(i)&&(this.cache.delete(i),null===(t=this.handleEditorCacheDelete)||void 0===t||t.call(this,e))}}]),e}(),ke=i("281cbdced7"),we=i.n(ke),Ie=i("37091e4240"),xe=function(){function e(){var t=this;a()(this,e),d()(this,"currentSlideEditor",void 0),d()(this,"copyToImage",void 0),d()(this,"updatePosition",we()((function(){var e;null===(e=t.currentSlideEditor)||void 0===e||e.updatePosition()}),20)),d()(this,"props",void 0),d()(this,"scale",void 0),d()(this,"stableLayer",void 0),d()(this,"slideEditorMap",new Map),d()(this,"masterEditorMap",new Map),d()(this,"layoutEditorMap",new Map),d()(this,"emptyAreaInstance",void 0),d()(this,"changeListenerOff",void 0),d()(this,"disposeSlideTimer",void 0),d()(this,"buildSlideTimer",void 0),d()(this,"editorCache",void 0),d()(this,"handleEditorCacheDelete",(function(e){var i,n,r;null==e||null===(i=e.dispose)||void 0===i||i.call(e),null===(n=t.stableLayer)||void 0===n||n.cleanCache(null==e?void 0:e.slide),t.slideEditorMap.delete(null==e||null===(r=e.slide)||void 0===r?void 0:r.key)})),d()(this,"getReserveSlideIndexRange",(function(){var e=t.props.services.slideListRenderState,i=[];e&&(i=e.visibleSlideKeyList);var n=t.props.services.uiDataService.slideModelList,r=t.props.services.selectionService.currentSlideIndex,o=Math.ceil(i.length/2),a=[];if(r>-1&&n.forEach((function(e){var i,n=null!==(i=t.props.services.uiDataService.presentation.children.indexOf(e))&&void 0!==i?i:-1;n>-1&&n>=r-o-2&&n<=r+o+2&&a.push(e.key)})),i.length){var l,s,c=i.map((function(e){var t;return{index:(null===(t=n.find((function(t){return t.key===e})))||void 0===t?void 0:t.listIndex)||0,key:e}}));c=c.sort((function(e,t){return e.index-t.index}));var d=((null===(l=n.find((function(e){return e.key===c[0].key})))||void 0===l?void 0:l.listIndex)||0)-2,u=((null===(s=n.find((function(e){return e.key===c[c.length-1].key})))||void 0===s?void 0:s.listIndex)||0)+2;n.forEach((function(e){(e.listIndex||0===e.listIndex)&&e.listIndex>=d&&e.listIndex<=u&&-1===a.indexOf(e.key)&&a.push(e.key)}))}return a})),d()(this,"getApplication",(function(){var e;return null===(e=t.currentSlideEditor)||void 0===e?void 0:e.application}))}return s()(e,[{key:"initService",value:function(e){var t=e.scale,i=void 0===t?1:t;this.props=e,this.scale=i,this.editorCache=new Ce(20,this.handleEditorCacheDelete,this.getReserveSlideIndexRange),this.copyToImage=new H.a(i,this.forceBuildSlideSync.bind(this)),this.initStableLayer(),this.buildFirstSlideCache(),this.updateCurrentSlide(),this.addSlidesChangeListener()}},{key:"updateWithData",value:function(e,t,i){this.scale=e,this.props.scale=e,this.props.viewportSize=i,this.props.contentSize=t;var n=this.props.services.selectionService.currentSlide,r=this.getEditorMapFromModel(n);if(this.stableLayer.updateTranslate(),!n||r.get(n.key))this.updateManagersData();else{var o,a;if(n!==(null===(o=this.currentSlideEditor)||void 0===o?void 0:o.slide))null===(a=this.currentSlideEditor)||void 0===a||a.hidden();this.asyncUpdateData()}}},{key:"getCurrentSlideBounds",value:function(e,t){var i,n,r,o;if(null!==(i=this.getComponentByModel(null===(n=e.children)||void 0===n?void 0:n[0]))&&void 0!==i&&i.worldBounds){var a=null===(r=this.getSlideEditorByKey(e.key))||void 0===r||null===(o=r.slideComponent)||void 0===o?void 0:o.worldBounds;if(a){var l=new u.c;l.addBounds(a);var s=z.a.getInstance().getAllComponents();if(!(s.length>0))return l;if(t){var c=t.currentScrollX,d=t.currentScrollY,h=t.currentTranslateX,v=t.currentTranslateY,f=new u.F,p=new u.c;return s.forEach((function(e){p.clear(),p.addBounds(e.worldBounds),f.clear();var t=d-v,i=c+h;f.set(t,-i,-t,i),p.pad(f),l.addBounds(p)})),l}}}}},{key:"dispose",value:function(){var e,t=this;this.slideEditorMap.forEach((function(e,i){null==e||e.dispose(),t.stableLayer.cleanCache(e.slide),t.slideEditorMap.delete(i),t.editorCache.deleteCache(e)})),this.currentSlideEditor=null,this.props.services.animManager.editSlideComponent=void 0,null===(e=this.changeListenerOff)||void 0===e||e.forEach((function(e){return null==e?void 0:e()})),this.removeMasterLayoutCache(),this.editorCache.dispose(),this.disposeSlideTimer&&clearTimeout(this.disposeSlideTimer),this.buildSlideTimer&&clearTimeout(this.buildSlideTimer)}},{key:"getSlideEditorByKey",value:function(e){return this.slideEditorMap.get(e)}},{key:"getLayoutEditorByKey",value:function(e){return this.layoutEditorMap.get(e)}},{key:"getComponentByModel",value:function(e){var t,i,n,r=((null===(t=this.currentSlideEditor)||void 0===t||null===(i=t.slideComponent)||void 0===i||null===(n=i.elementsLayer)||void 0===n?void 0:n.children)||[]).find((function(t){var i;return(null==t||null===(i=t.factoryOptions)||void 0===i?void 0:i.model)===e}));return r||z.a.getInstance().getAllComponents().find((function(t){var i;return(null==t||null===(i=t.factoryOptions)||void 0===i?void 0:i.model)===e}))}},{key:"forceBuildSlideSync",value:function(e){var t=this.slideEditorMap.get(e.key);return t||(N.b.cancelTaskByKey("render-".concat(e.key)),t=this.buildSingleSlideCache(e)),t.mountSlide(),t}},{key:"updateModelInfo",value:function(e){var t=this.getEditorMapFromModel(e).get(null==e?void 0:e.key);t&&t.updateInfo(this.scale,this.props.contentSize,this.props.viewportSize)}},{key:"asyncUpdateData",value:function(){var e=this,t=this.props.services.selectionService,i=t.currentSlide,n=t.currentSlideIndex,r=t.slides;N.b.getTaskWithKey("updateCurrent-".concat(i.key))||N.b.addTaskWithBlock("updateCurrent-".concat(i.key),N.a.HIGH+2,(function(){e.updateManagersData()}));var o=r[n-1],a=r[n+1];N.b.getTaskWithKey("updateCurrent-".concat(null==o?void 0:o.key))&&N.b.cancelTaskByKey("updateCurrent-".concat(null==o?void 0:o.key)),N.b.getTaskWithKey("updateCurrent-".concat(null==a?void 0:a.key))&&N.b.cancelTaskByKey("updateCurrent-".concat(null==a?void 0:a.key))}},{key:"renderEmpty",value:function(){this.emptyAreaInstance||(this.emptyAreaInstance=new F.a(this.props.canvasWrapper)),this.emptyAreaInstance.update()}},{key:"buildFirstSlideCache",value:function(){var e=r()(this.props.services.uiDataService.slideModelList,1)[0];e&&this.buildSingleSlideCache(e)}},{key:"buildSingleSlideCache",value:function(e){var t=new(this.getEditorFromModel(e))({slide:e,scale:this.scale,stableLayer:this.stableLayer,viewportSize:this.props.viewportSize,contentSize:this.props.contentSize,canvasWrapper:this.props.canvasWrapper,services:this.props.services,onSlideWillRender:this.props.onSlideWillRender,onSlideDidRender:this.props.onSlideDidRender});return this.getEditorMapFromModel(e).set(e.key,t),this.props.canvasWrapper.appendChild(t.canvasDom),this.editorCache.shouldCacheEditor(t)&&this.editorCache.cacheEditor(t),t}},{key:"handleVisibleSlideChange",value:function(){var e=this;this.disposeSlideTimer&&clearTimeout(this.disposeSlideTimer),this.buildSlideTimer&&clearTimeout(this.buildSlideTimer),this.disposeSlideTimer=setTimeout((function(){e.handleSlideDispose()}),500),this.buildSlideTimer=setTimeout((function(){e.handleSlideBuild()}),200)}},{key:"handleSlideBuild",value:function(){var e=this,t=this.getReserveSlideIndexRange();this.props.services.uiDataService.slideModelList.forEach((function(i,n){if(t.indexOf(i.key)>-1&&!i.preload)if(e.slideEditorMap.get(i.key)){var r=N.b.getTaskWithKey("dispose-".concat(i.key));null==r||r.cancel(),null!=r&&r.isExecuting&&N.b.addTaskWithBlock("render-".concat(i.key),N.a.LOW,(function(){e.slideEditorMap.get(i.key)||e.buildSingleSlideCache(i)}))}else 0===n&&e.buildSingleSlideCache(i),N.b.getTaskWithKey("render-".concat(i.key))||N.b.addTaskWithBlock("render-".concat(i.key),N.a.NORMAL,(function(){e.slideEditorMap.get(i.key)||e.buildSingleSlideCache(i)}))}))}},{key:"updateManagersData",value:function(){var e;null===(e=this.stableLayer)||void 0===e||e.updateWithData(this.scale),this.updateCurrentSlide()}},{key:"handleSlideDispose",value:function(){var e=this,t=this.getReserveSlideIndexRange();this.props.services.uiDataService.slideModelList.forEach((function(i){if(-1===t.indexOf(i.key)){var n=e.slideEditorMap.get(i.key);if(n){var r,o;if(!e.editorCache.hasCache(n))null==n||null===(r=n.dispose)||void 0===r||r.call(n),null===(o=e.stableLayer)||void 0===o||o.cleanCache(null==n?void 0:n.slide),e.slideEditorMap.delete(i.key)}else{var a=N.b.getTaskWithKey("render-".concat(i.key));null==a||a.cancel()}}}))}},{key:"addSlidesChangeListener",value:function(){var e=this;this.changeListenerOff=[Object(g.r)((function(){return[e.props.services.uiDataService.presentation.props.slideSizeType,e.props.services.uiDataService.presentation.props.slideWidth,e.props.services.uiDataService.presentation.props.slideHeight]}),(function(){e.handleListChange(e.props.services.uiDataService.slideModelList,e.slideEditorMap)})),Object(g.r)((function(){var t;return[null===(t=e.props.services.slideListRenderState)||void 0===t?void 0:t.visibleSlideKeyList.slice(),e.props.services.selectionService.currentSlideIndex]}),(function(){e.handleVisibleSlideChange()})),Object(g.r)((function(){var t;return[null===(t=e.getMasterLayoutEditService())||void 0===t?void 0:t.editType]}),(function(t){r()(t,1)[0]!==Ee.a.MASTER_LAYOUT&&e.removeMasterLayoutCache()})),Object(g.r)((function(){return e.props.services.uiDataService.slideModelList}),(function(t){e.removeEditorByModelList(t,e.slideEditorMap)}))],Ie.b.on(Ie.a.ALL_SLIDE_DATA_CONVERT,(function(){e.changeListenerOff.push(Object(g.r)((function(){return e.props.services.uiDataService.masterModelList}),(function(t){return e.removeEditorByModelList(t,e.masterEditorMap)})),Object(g.r)((function(){return e.props.services.uiDataService.layoutModelList}),(function(t){return e.removeEditorByModelList(t,e.layoutEditorMap)})))}))}},{key:"removeMasterLayoutCache",value:function(){var e=this;this.masterEditorMap.forEach((function(t,i){var n,r;null==t||null===(n=t.dispose)||void 0===n||n.call(t),e.masterEditorMap.delete(i),null===(r=e.stableLayer)||void 0===r||r.cleanCache(null==t?void 0:t.slide),e.editorCache.deleteCache(t)})),this.layoutEditorMap.forEach((function(t,i){var n,r;null==t||null===(n=t.dispose)||void 0===n||n.call(t),e.layoutEditorMap.delete(i),null===(r=e.stableLayer)||void 0===r||r.cleanCache(null==t?void 0:t.slide),e.editorCache.deleteCache(t)}))}},{key:"removeEditorByModelList",value:function(e,t){var i=this,n=new Map;e.forEach((function(e){n.set(e.key,!0)})),t.forEach((function(e,r){if(!n.has(r)){var o,a,l=t.get(r);null==l||null===(o=l.dispose)||void 0===o||o.call(l),t.delete(r),null===(a=i.stableLayer)||void 0===a||a.cleanCache(null==l?void 0:l.slide),i.editorCache.deleteCache(l)}}))}},{key:"handleListChange",value:function(e,t){var i=this;this.removeEditorByModelList(e,t);for(var n=function(n){var r=e[n];t.get(r.key)||(0===n&&i.buildSingleSlideCache(r),N.b.addTaskWithBlock("render-".concat(r.key),N.a.LOW,(function(){t.get(r.key)||i.buildSingleSlideCache(r)})))},r=0;r<e.length;r++)n(r)}},{key:"updateCurrentSlide",value:function(){var e,t,i,n,r,o,a,l,s,c=this.props.services.selectionService.currentSlide,d=z.a.getInstance(),u=null,h=this.getEditorMapFromModel(c);if(c!==(null===(e=this.currentSlideEditor)||void 0===e?void 0:e.slide)){if(!c)return this.currentSlideEditor&&(this.currentSlideEditor.canvasDom.style.display="none",this.currentSlideEditor=null,this.props.services.animManager.editSlideComponent=void 0,d.currentCanvasElementLayer=void 0),void this.renderEmpty();var v;v=h.has(c.key)?h.get(c.key):this.buildSingleSlideCache(c),this.currentSlideEditor&&(u=this.currentSlideEditor),this.currentSlideEditor=v}this.updateModelInfo(c),null===(t=this.currentSlideEditor)||void 0===t||t.display(),null===(i=u)||void 0===i||i.hidden(),this.props.services.animManager.editSlideComponent=null===(n=this.currentSlideEditor)||void 0===n?void 0:n.slideComponent,d.currentCanvasElementLayer=null===(r=this.currentSlideEditor)||void 0===r||null===(o=r.slideComponent)||void 0===o?void 0:o.elementsLayer,this.copyToImage.updateElementLayer(null===(a=this.currentSlideEditor)||void 0===a||null===(l=a.slideComponent)||void 0===l?void 0:l.elementsLayer),null===(s=this.stableLayer)||void 0===s||s.updateStableLayer(c),this.renderEmpty()}},{key:"initStableLayer",value:function(){this.props.stableLayerWrapper&&(this.stableLayer=new Me({scale:this.scale,getApplication:this.getApplication,elementWrapper:this.props.stableLayerWrapper,updateStableLayerTranslate:this.props.updateStableLayerTranslate,services:this.props.services}))}},{key:"getEditorMapFromModel",value:function(e){return b.d.MASTER===(null==e?void 0:e.type)?this.masterEditorMap:b.d.LAYOUT===(null==e?void 0:e.type)?this.layoutEditorMap:this.slideEditorMap}},{key:"getEditorFromModel",value:function(e){return b.d.MASTER===(null==e?void 0:e.type)?W:b.d.LAYOUT===(null==e?void 0:e.type)?Y:j}},{key:"getMasterLayoutEditService",value:function(){return this.props.services.masterLayoutEditService}}]),e}()},"2ef74bdcae":function(e,t,i){"use strict";i.d(t,"a",(function(){return Ee}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36");var n,r=i("14502724a6"),o=i.n(r),a=i("730477bb20"),l=i.n(a),s=i("176815363d"),c=i.n(s),d=i("9132715560"),u=i.n(d),h=i("6a364eb35c"),v=i.n(h),f=i("547611bd96"),p=i.n(f),g=i("bd29e2df90"),y=i.n(g),m=i("ab5eb40518"),b=i.n(m),S=i("1b4cdd6a36"),M=i.n(S),E=i("85d0a7609b"),C=i.n(E),k=i("3ef2352f0b"),w=i.n(k),I=(i("963f2eaace"),i("c6244f7705"),i("081c8cafea"),i("63513d8b56"),i("6e20b6a7d8"),i("3bf1976a4f"),i("405b4a5e2b"),i("8ee19818c4"),i("a2a09da1e3"),i("b8217400dc"),i("e6f68cdf2e"),i("8e7cce0ada"),i("c9a7ecac4d"),i("85d48ef22b"),i("2a6f332b5e"),i("1bab7b5fb7"),i("9d7978d445"),i("759492dad9"),i("7a3400cab1"),i("69084d01d3")),x=i.n(I);!function(e){e.REVERT_BEGIN="revertBegin",e.REVERT_END="revertEnd",e.SHOW="show",e.HIDE="hide",e.FETCH_BEGIN="fetchBegin",e.FETCH_END="fetchEnd",e.FETCHED="fetched"}(n||(n={}));var O=i("668bd0ac65"),A=i("711a53c9fc"),L=i("fdddc95d9b"),R=i("2e2ccf062e"),D=i("5fac0349d3"),T=i("780d9b3b59"),P=i("7faf76450d"),B=i("84c7a07f3d"),G=i("020899bf26"),j=i("aba9dcef64");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M()(e);if(t){var r=M()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var F=function(e){y()(r,e);var t,i,n=N(r);function r(e){var t;return u()(this,r),(t=n.call(this)).historyManager=e,t}return v()(r,[{key:"name",get:function(){return B.b}},{key:"show",value:(i=c()(w.a.mark((function e(){var t,i,n=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,this.historyManager.recordType!==B.d.HISTORY_VERSION){e.next=5;break}t=!0,e.next=9;break;case 5:return e.next=7,this.showHistoryList();case 7:i=e.sent,t=!!i;case 9:t&&this.historyManager.showModule(this.DOMNode,(function(){n.showWrapper()}),(function(){n.hideWrapper()}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"showHistoryList",value:(t=c()(w.a.mark((function e(){var t,i,n,r,o,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null!==(t=G.a.DocInfoManager())&&void 0!==t?t:{},n=i.globalPadId,r=void 0===n?"":n,e.next=3,j.a.OnlineApiService.promise();case 3:return o=e.sent,e.next=6,o.getHistory(r,1).then((function(e){if(e.data.retcode===B.c){var t={message:D.a.t("在线人数较多，暂时无法查看修订记录"),commonTipsType:T.b.INFO,block:!1,closable:!0};return T.c.getInstance().show(t),!1}return!0}));case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"wrapperDidHide",value:function(){this.historyManager.hideModule(this.DOMNode)}}]),r}(P.a),z=(i("b1e2246d82"),i("3dc760a4d9"),i("34cd92f77a"),function(){function e(t){u()(this,e),C()(this,"drawer",void 0),this.historyManager=t,this.init()}var t;return v()(e,[{key:"name",get:function(){return B.b}},{key:"drawerNode",get:function(){return this.drawer}},{key:"show",value:(t=c()(w.a.mark((function e(){var t=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.historyManager.showModule(this.drawer,(function(){t.showWrapper()}),(function(){t.hideWrapper()}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"init",value:function(){this.drawer=document.createElement("div"),this.drawer.id=this.name,this.drawer.style.cssText=Object.entries({position:"fixed",top:"0",right:"0",width:"100vw",height:"100vh",backgroundolor:"#ffffff",zIndex:"9997",transform:"translateX(100%)",transition:"transform 0.3s ease-in-out"}).map((function(e){var t=o()(e,2),i=t[0],n=t[1];return"".concat(i.replace(/([A-Z])/g,"-$1").toLowerCase(),": ").concat(n,";")})).join(" "),document.body.appendChild(this.drawer)}},{key:"showWrapper",value:function(){this.drawer.style.transform="translateX(0)"}},{key:"hideWrapper",value:function(){this.drawer.style.transform="translateX(100%)",this.historyManager.hideModule(this.drawer)}}]),e}()),H=i("d5c3deb8c7"),U=i("3471fb3b60"),W=i("2e0796c118"),_=i.n(W),Y=i("0526e2ef61"),V=i("4a351e9268"),K=i("026cc7da1f"),X=i("570b26a0fa"),Q=i("8b13fcae36"),Z=i("e792a3169a"),q=i.n(Z),J=i("b4cc9f91ed"),$=i.n(J),ee={insert:"head",singleton:!1},te=(q()($.a,ee),$.a.locals||{});function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M()(e);if(t){var r=M()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var ne=function(e){y()(i,e);var t=ie(i);function i(e){var r;return u()(this,i),(r=t.call(this,e)).state={showHistoryMask:!1},r.props.historyManager.on(n.FETCH_BEGIN,(function(){r.setState({showHistoryMask:!0})})),r.props.historyManager.on(n.FETCH_END,(function(){r.setState({showHistoryMask:!1})})),r}return v()(i,[{key:"render",value:function(){return this.state.showHistoryMask?x.a.createElement("div",{className:te["history-mask"]},x.a.createElement("div",{className:te["history-mask-loading"]})):null}}]),i}(x.a.Component),re="revertBegin",oe="revertEnd",ae=function e(t){u()(this,e),t.on(re,(function(){T.c.getInstance().show({message:D.a.t("正在还原，请稍候...")})})),t.on(oe,(function(){T.c.getInstance().hide()}))},le=i("1748118723"),se=i.n(le),ce=i("29ba904551"),de=i.n(ce),ue={insert:"head",singleton:!1},he=(q()(de.a,ue),de.a.locals||{});function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M()(e);if(t){var r=M()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var fe=function(e){y()(i,e);var t=ve(i);function i(){var e;u()(this,i);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),C()(p()(e),"state",{animating:!1}),C()(p()(e),"prevVisible",!1),C()(p()(e),"handleAnimationEnd",(function(){e.setState({animating:!1})})),e}return v()(i,[{key:"displaying",get:function(){return this.state.animating||this.props.visible}},{key:"componentDidUpdate",value:function(e){this.props.visible!==e.visible&&this.setState({animating:!0})}},{key:"render",value:function(){var e;return this.prevVisible!==this.props.visible&&(this.prevVisible=!!this.props.visible),x.a.createElement(x.a.Fragment,null,this.displaying?x.a.createElement("div",{className:se()((e={},C()(e,he["author-tag"],!0),C()(e,he["fade-in"],this.props.visible),C()(e,he["fade-out"],!this.props.visible),e)),style:{backgroundColor:this.props.color||"black",zIndex:this.props.zIndex||"auto",transform:"translate(".concat(this.props.x||0,"px, ").concat(this.props.y||0,"px)")},onAnimationEnd:this.handleAnimationEnd},this.props.authorName):null)}}]),i}(x.a.Component),pe=i("96af49c4f4"),ge=i("8f58e78419"),ye=i.n(ge),me=i("1ce94b3b3e");function be(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?be(Object(i),!0).forEach((function(t){C()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):be(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M()(e);if(t){var r=M()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var Ee=function(e){y()(d,e);var t,i,r,a,s=Me(d);function d(e,t,i,n,r,o,a,l,c,h){var v,f,g,y,m;return u()(this,d),m=s.call(this),C()(p()(m),"canUpdateEditorState",!0),C()(p()(m),"isShowingHistory",!1),C()(p()(m),"isShowHistoryPanel",!1),C()(p()(m),"modification",void 0),C()(p()(m),"sectionModification",void 0),C()(p()(m),"changedComponents",void 0),C()(p()(m),"recordType",void 0),C()(p()(m),"colorCandidateList",void 0),C()(p()(m),"colorMap",void 0),C()(p()(m),"preHistorySelectedSlideIndex",void 0),C()(p()(m),"presentation",void 0),C()(p()(m),"activeId",void 0),C()(p()(m),"showTab",void 0),C()(p()(m),"authors",void 0),C()(p()(m),"rawPresentation",void 0),C()(p()(m),"presentationStoreService",void 0),C()(p()(m),"historyMobileModule",void 0),m.uiDataService=e,m.selectionService=t,m.exportManager=i,m.userPriviledgeService=n,m.lockService=r,m.accusationService=o,m.rightSideBarService=a,m.menuManager=l,m.injectable=c,m.selectedAnims=h,a.registerModule(new F(p()(m))),m.colorCandidateList=B.a.slice(0),m.colorMap={},m.changedComponents=[],m.init(),m.initHistoryRevertListeners(),null===(v=(f=m.injectable).listenStatusChange)||void 0===v||v.call(f),m.historyMobileModule=new z(p()(m)),null===(g=(y=m.injectable).versionPreviewInvoke)||void 0===g||g.call(y,m.show.bind(p()(m))),m}return v()(d,[{key:"init",value:function(){var e=this;this.on(n.FETCHED,(function(){if(e.isShowHistoryPanel){var t,i,n;!e.isShowingHistory&&e.selectionService&&(e.preHistorySelectedSlideIndex=e.selectionService.currentSlideIndex),e.selectionService.selectedSlides.clear(),e.selectionService.selectedElements.clear(),null===(t=e.selectedAnims)||void 0===t||t.clear(),e.isShowingHistory=!0;for(var r=-1,o=e.modification.length-1;o>=0;o--){if(e.modification[o].length>0){r=o;break}}-1===r&&(r=Math.max(e.modification.length-1,0)),Object(H.r)((function(){return e.selectionService.slides}),(function(t,i){var n;t&&(t.length-1===r?(e.selectionService.selectedSlides.add(null===(n=e.uiDataService.presentation)||void 0===n?void 0:n.slideOfIndex(r)),e.selectionService&&(e.selectionService.currentSlideIndex=r),i.dispose()):t.length===e.presentation.slideList.length&&i.dispose())})),e.selectionService&&(e.selectionService.currentSlideIndex=r),e.userPriviledgeService.updateHistoricalVersionStatus(!0,!0),U.b.cancelAllTasks(),null===(i=e.uiDataService.presentation)||void 0===i||i.unbindSDK(),null===(n=e.uiDataService.presentation)||void 0===n||n.bindSDK(e.presentation)}})),this.on(n.HIDE,(function(){var t,i,n,r;if(!1!==e.isShowingHistory){e.isShowingHistory=!1;var o=e.rawPresentation;o&&Object(H.r)((function(){return e.selectionService.slides}),(function(t,i){var n;t&&(t.length-1===e.preHistorySelectedSlideIndex?(e.selectionService.selectedSlides.add(null===(n=e.uiDataService.presentation)||void 0===n?void 0:n.slideOfIndex(e.preHistorySelectedSlideIndex)),e.selectionService&&(e.selectionService.currentSlideIndex=e.preHistorySelectedSlideIndex),i.dispose()):t.length===o.slideList.length&&i.dispose())})),e.selectionService.selectedSlides.clear(),e.selectionService.selectedElements.clear(),null===(t=e.selectedAnims)||void 0===t||t.clear(),e.userPriviledgeService.updateHistoricalVersionStatus(!1,e.canUpdateEditorState),e.canUpdateEditorState=!0,e.selectionService&&(e.selectionService.currentSlideIndex=e.preHistorySelectedSlideIndex),null===(i=e.lockService)||void 0===i||i.checkLock(),U.b.cancelAllTasks(),null===(n=e.uiDataService.presentation)||void 0===n||n.unbindSDK(),null===(r=e.uiDataService.presentation)||void 0===r||r.bindSDK(e.rawPresentation),e.rawPresentation=null}}))}},{key:"initHistoryRevertListeners",value:function(){new ae(this)}},{key:"showModule",value:function(e,t,i){_.a.render(x.a.createElement(Y.b,{onClose:function(){null==i||i()},accusationService:this.accusationService,getVersion:this.fetchVersion.bind(this),getHistorySlide:this.fetchHistorySlide.bind(this),getColor:this.getColorForId.bind(this),revert:this.revert.bind(this),getHistory:this.getHistory.bind(this),getAuthor:this.getAuthor.bind(this),activeId:this.activeId,type:this.recordType,isSupportArkVersionManager:this.injectable.isSupportArkVersionManager,exportManager:this.exportManager,enableHistoryVersion:this.injectable.enableHistoryVersion,showTab:this.showTab,injectable:this.injectable}),e),this.authors={},null==t||t(),this.isShowHistoryPanel=!0,this.emit(n.SHOW,void 0)}},{key:"hideModule",value:function(e){var t;_.a.unmountComponentAtNode(e),this.isShowHistoryPanel=!1,null===(t=this.presentationStoreService)||void 0===t||t.dispose(),this.presentationStoreService=null,this.presentation=null,this.modification=null,this.sectionModification=null,this.authors=null,this.emit("hide",void 0)}},{key:"show",value:function(e){var t=e||{},i=t.activeId,n=t.showTab,r=t.type;this.activeId=i||null,this.showTab=!1!==n&&null,this.recordType=r||B.d.DEFAULT,this.rightSideBarService.show(B.b,void 0)}},{key:"mobileShow",value:function(e){var t=e||{},i=t.activeId,n=t.showTab,r=t.type;this.activeId=i||null,this.showTab=!1!==n&&null,this.recordType=r||B.d.DEFAULT,this.historyMobileModule.show()}},{key:"isShown",value:function(){return this.rightSideBarService.isShown(B.b)}},{key:"handleFetchException",value:function(e,t){var i;null===(i=window.log)||void 0===i||i.error(e),null==t||t()}},{key:"revert",value:(a=c()(w.a.mark((function e(t,i,r,o){var a=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.emit(n.REVERT_BEGIN,void 0),e.next=3,j.a.OnlineApiService.promise();case 3:e.sent.revert(this.globalPadId,t,i,3e4).then(function(){var e=c()(w.a.mark((function e(t){var i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.data.retcode){e.next=9;break}return Object(X.tdw)({opername:"doc_core",module:"edit",action:"recover_his"}),null==r||r(),e.next=6,null===(i=j.a.CollaborationManager())||void 0===i?void 0:i.getPersistent().replaceAllData([]);case 6:setTimeout((function(){a.injectable.onBeforeRevertUrlReload()||Object(Q.tencentDocOpenUrlReload)()}),1e3),e.next=10;break;case 9:null==o||o();case 10:a.emit(n.REVERT_END,void 0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){null==o||o(e),a.emit(n.REVERT_END,void 0)}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,i,n){return a.apply(this,arguments)})},{key:"getHistory",value:(r=c()(w.a.mark((function e(t,i,n){var r=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.OnlineApiService.promise();case 2:e.sent.getHistory(this.globalPadId,t).then((function(e){var t=e.data;if(0===t.retcode){var o=t.authors,a=Se({},r.authors);for(var l in o)a[l]||(a[l]=o[l]);r.authors=a,null==i||i(t)}else{if(t.retcode===B.c){var s={message:D.a.t("在线人数较多，暂时无法查看修订记录"),commonTipsType:T.b.INFO,block:!1,closable:!0};T.c.getInstance().show(s)}null==n||n(t)}})).catch((function(e){null==n||n(e)}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return r.apply(this,arguments)})},{key:"getAuthor",value:function(e){return this.authors?this.authors[e]:null}},{key:"getColorForId",value:function(e){if(!this.colorMap[e]){this.colorCandidateList.length<=0&&(this.colorCandidateList=B.a.slice(0));var t=Math.floor(Math.random()*this.colorCandidateList.length);this.colorMap[e]=this.colorCandidateList[t],this.colorCandidateList.splice(t,1)}return this.colorMap[e]}},{key:"renderHistoryLoadingMask",value:function(e){return x.a.createElement(ne,l()({},e,{historyManager:this}))}},{key:"renderHistoryAuthorTag",value:function(e){return x.a.createElement(fe,e)}},{key:"renderSnapshotRecovery",value:function(){return x.a.createElement(pe.a,{exportManager:this.exportManager,menuManager:this.menuManager})}},{key:"globalPadId",get:function(){var e,t;return null!==(e=null===(t=G.a.DocInfoManager())||void 0===t?void 0:t.globalPadId)&&void 0!==e?e:""}},{key:"fetchVersion",value:(i=c()(w.a.mark((function e(t,i,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=20,e.next=3,j.a.OnlineApiService.promise();case 3:e.sent.getVersion(this.globalPadId,t,r).then((function(e){var t=e.data;0===t.retcode?null==i||i(t):null==n||n()})).catch((function(){null==n||n()}));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"convertActionList",value:function(e){return e.map((function(e){var t=e.author,i=e.action,n=V.a.fromBufferOrBase64(i).getValidMutationData(),r=n.map((function(e){var t=e.pageId;return e.shapeId||t||""}));return{author:t,commandData:new O.a({presentation:i}).getCommandData(),mutations:n,changedComponents:r}}))}},{key:"getNewPresentationStoreServiceFromText",value:function(e){var t=new O.a(e),i=G.a.SDKDataServices.PresentationStoreService();return Object(K.assert)(i,"presentationStoreService is not exist"),i.createFromCommandData(t.getCommandData())}},{key:"getHistorySlideV3",value:(t=c()(w.a.mark((function e(t,i,r,o){var a,l,s,c,d,u,h,v,f,p,g,y,m,b,S,M,E,C,k;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.emit(n.FETCH_BEGIN,void 0),e.prev=1,e.next=4,j.a.OnlineApiService.promise();case 4:return d=e.sent,window.log.info("select history from:".concat(i,", to:").concat(t)),e.next=8,d.getHistorySlide(this.globalPadId,t,i);case 8:if(0===(null==(u=e.sent)||null===(a=u.data)||void 0===a?void 0:a.retcode)&&null!=u&&null!==(l=u.data)&&void 0!==l&&null!==(s=l.data)&&void 0!==s&&null!==(c=s.initialAttributedText)&&void 0!==c&&c.text){e.next=11;break}throw new Error("拉取数据失败");case 11:if(h=u.data.data,v=h.initialAttributedText,f=h.actionlist,p=void 0===f?[]:f,!((g=JSON.parse(v.text)).dver>="3.0.0")){e.next=17;break}this.handleHistoryV3(g,p),e.next=29;break;case 17:if(E=this.makeKeyframeV2(v.text)){e.next=20;break}throw new Error("历史记录2.0[".concat(i,": ").concat(t,"]：初始化修改前数据失败"));case 20:return e.next=22,d.getHistorySlide(this.globalPadId,t,t);case 22:if(0===(null==(C=e.sent)||null===(y=C.data)||void 0===y?void 0:y.retcode)&&null!=C&&null!==(m=C.data)&&void 0!==m&&null!==(b=m.data)&&void 0!==b&&null!==(S=b.initialAttributedText)&&void 0!==S&&S.text){e.next=25;break}throw new Error("历史记录2.0[".concat(i,": ").concat(t,"]：拉取修改后数据失败"));case 25:if(k=this.makeKeyframeV2(null===(M=C.data.data.initialAttributedText)||void 0===M?void 0:M.text)){e.next=28;break}throw new Error("历史记录2.0[".concat(i,": ").concat(t,"]：初始化修改后数据失败"));case 28:this.handleHistroyV2(E,k,p);case 29:this.emit(n.FETCHED,void 0),null==r||r(),e.next=37;break;case 33:e.prev=33,e.t0=e.catch(1),null==o||o(),window.log.warn(e.t0);case 37:this.emit(n.FETCH_END,void 0);case 38:case"end":return e.stop()}}),e,this,[[1,33]])}))),function(e,i,n,r){return t.apply(this,arguments)})},{key:"getListChangedByAuthor",value:function(e,t,i){var n=this,r=new Array(e).fill(0).map((function(){return[]})),o=new Array(t).fill(0).map((function(){return[]}));return i.forEach((function(e){var t=e.mutations,i=e.author;t.forEach((function(e){if(e.pageType===A.Q.slide){if(e.type===A.c.AddPage)return void r.splice(e.index,0,[i]);if(e.type===A.c.RemovePage)return void r.splice(e.index,1);if(e.type===A.c.MoveAnimation)return void(r[e.index]=[i])}if(e.pageId){var t=n.presentation.getSlideById(e.pageId);if(t){var a=n.presentation.slideList.indexOf(t),l=r[a];l&&!l.includes(i)&&l.push(i)}}if(e.type!==A.c.AddSection)if(e.type!==A.c.RemoveSection)if(e.type!==A.c.SetSectionProperties);else{var s=o[e.index];s&&!s.includes(i)&&s.push(i)}else o.splice(e.index,1);else o.splice(e.index,0,[i])}))})),{changedSlideList:r,changedSectionList:o}}},{key:"beforeFetchHistorySlide",value:function(){var e,t;(this.rawPresentation||(this.rawPresentation=this.uiDataService.presentation.sdkData),this.presentationStoreService)&&(null===(e=(t=this.presentationStoreService).dispose)||void 0===e||e.call(t))}},{key:"fetchHistorySlide",value:function(e,t,i,n){return this.beforeFetchHistorySlide(),this.getHistorySlideV3(e,t,i,n)}},{key:"handleHistoryV3",value:function(e,t){var i=this.getNewPresentationStoreServiceFromText(e);this.presentationStoreService=i,this.presentation=i.getPresentation();var n=this.presentation.slideList.length,r=this.presentation.sectionList.length,o=this.convertActionList(t);i.getTransaction()((function(){return o.map((function(e){var t=e.commandData;return i.applyCommandData(t,L.a.Keyframe)}))}));var a=this.getListChangedByAuthor(n,r,o),l=a.changedSlideList,s=a.changedSectionList;this.changedComponents=o.map((function(e){return{components:new Set(e.changedComponents),author:e.author}})),this.modification=l,this.sectionModification=s}},{key:"handleHistroyV2",value:function(e,t,i){var n,r=this,o=e.slideList.length,a=(null===(n=e.sectionList)||void 0===n?void 0:n.length)||0,l=[];this.changedComponents=[],i.forEach((function(e){var t=JSON.parse(e.action);l.push({author:e.author,changeset:t});var i={author:e.author,components:r.findChangedComponentByChangesetV2(t)};r.changedComponents.push(i)})),this.modification=this.getModifiedPageOrSectionV2(o,l,/^\/slideList\/(\d+)/),this.sectionModification=this.getModifiedPageOrSectionV2(a,l,/^\/sectionList\/(\d+)/),this.migrateV2toV3(t)}},{key:"makeKeyframeV2",value:function(e){try{var t=unescape(e);return JSON.parse(t)}catch(t){return JSON.parse(e)}}},{key:"migrateV2toV3",value:function(e){var t=new me.a,i=t.migratePresentation(e,""),n=G.a.SDKDataServices.PresentationStoreService();Object(K.assert)(n,"presentationStoreService is not exist"),this.presentationStoreService=n.createFromData(i),this.presentation=this.presentationStoreService.getPresentation(),this.changedComponents.forEach((function(e){var i=new Set;e.components.forEach((function(e){var n=e.split("|");1===n.length?i.add(t.getPageId({id:n[0],type:"slide"})):n.length>1&&i.add(t.getId(["slide",n[0],n[n.length-1]].join(t.idSep),"shape"))})),e.components=i}))}},{key:"getModifiedPageOrSectionV2",value:function(e,t,i){for(var n=[],r=0;r<e;r++)n.push([]);return t.forEach((function(e){var t=e.author,r=e.changeset;r.length>0&&r.forEach((function(e){var r=""===o()(e,1)[0].target;e.forEach((function(e){var o="".concat(e.target).concat(e.path),a=i.exec(o),l=a&&a.length>1?parseInt(a[1],10):-1;if(-1!==l)if(r)"add"===e.op?n.splice(l,0,[t]):"remove"===e.op?n.splice(l,1):"move"===e.op&&(n[l]=[t]);else{var s=n[l];s&&-1===s.indexOf(t)&&s.push(t)}}))}))})),n}},{key:"findChangedComponentByChangesetV2",value:function(e){var t=this,i=new Set;return e?(e.forEach((function(e){t.parseIDOfComponentsByPatchV2(e).forEach((function(e){i.add(e)}))})),i):i}},{key:"parseIDOfComponentsByPatchV2",value:function(e){var t=[],i=ye()(e,"[0].tid"),n=function(e,t){return e?"".concat(e,"|").concat(t):t};if(null==i)return t;var r=i.split("|");return r&&r.length>1?(t.push(i),t):(e.forEach((function(e){if("add"===e.op){var r=ye()(e,"value.id");!r&&e.value&&e.value.valueId&&(r=e.value.valueId),r&&t.push(n(i,r))}else"move"===e.op?e.fid&&t.push(n(i,e.fid)):e.pid&&t.push(n(i,e.pid))})),t)}}]),d}(R.a)},"300a3a6804":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),s=i.n(l),c=i("c72a3f66bd"),d=i("85aa87d04f"),u=i("7181c053d9"),h=i("713338c47c"),v=function(){function e(t){r()(this,e),s()(this,"persistentListener",void 0),s()(this,"socketListener",void 0),this.injectable=t,this.socketListener=new c.a(this.injectable.shouldListenSocketChange,this.injectable.shouldListenSocketShutdown),this.persistentListener=new d.a(this.socketListener),new h.a(this.socketListener),new u.a}return a()(e,[{key:"dispose",value:function(){this.persistentListener.unregisterBeforeunload()}}]),e}()},"40721f7970":function(e,t,i){t=e.exports=i("9dddfe0040")(!1);var n=i("c92b994f13")(i("6c8d2c6e1c"));t.push([e.i,'@charset "utf-8";.index-history-wrapper-1QKbn{width:100%;height:100%;background-color:#fafafa;border-left:1px solid rgba(0,0,0,.04);font-family:PingFangSC-Regular,Microsoft YaHei,-apple-system-font,黑体,宋体,Helvetica Neue,Helvetica,STHeiTi,sans-serif}.index-history-wrapper-1QKbn .index-header-2GJno{width:100%;height:60px;-webkit-user-select:none;-ms-user-select:none;user-select:none}.index-history-wrapper-1QKbn .index-header-2GJno .index-title-1TauO{padding-left:20px;padding-right:34px;font-weight:500;color:rgba(0,0,0,.64);letter-spacing:.35px;line-height:16px;margin-top:26px;font-size:14px;float:left}.index-history-wrapper-1QKbn .index-header-2GJno .index-close-wrapper-3P0tW{width:16px;height:16px;top:26px;right:20px;position:absolute;cursor:pointer}.index-history-wrapper-1QKbn .index-header-2GJno .index-close-3ES13{width:16px;height:16px;background:url('+n+") no-repeat 50%}.index-history-wrapper-1QKbn .index-header-2GJno .index-close-3ES13:hover{background-color:rgba(51,51,51,.1)}.index-history-wrapper-1QKbn .index-header-2GJno .index-close-3ES13:active{background-color:rgba(65,70,80,.3)}.index-history-wrapper-1QKbn .index-border-6x1wK{border:1px solid #000;margin:0 20px;opacity:.08;-webkit-transform:scaleY(.4);transform:scaleY(.4)}.index-history-wrapper-1QKbn .index-tabs-1-qh-{background:none;height:62px}.index-history-wrapper-1QKbn .index-record-list-1Log-{width:100%;height:100%}.index-history-wrapper-1QKbn ::-webkit-scrollbar{width:8px;border-radius:4px;height:8px}.index-history-wrapper-1QKbn ::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,.12)}",""]),t.locals={"history-wrapper":"index-history-wrapper-1QKbn",header:"index-header-2GJno",title:"index-title-1TauO","close-wrapper":"index-close-wrapper-3P0tW",close:"index-close-3ES13",border:"index-border-6x1wK",tabs:"index-tabs-1-qh-","record-list":"index-record-list-1Log-"}},"427911adf8":function(e,t,i){t=e.exports=i("9dddfe0040")(!1);var n=i("c92b994f13")(i("630b3ae820"));t.push([e.i,".version-list-version-list-2QZFy{width:100%;height:calc(100% - 92px);overflow-y:scroll;overflow-x:hidden}.version-list-version-list-2QZFy .version-list-version-list-empty-gc0W5{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.version-list-version-list-2QZFy .version-list-version-list-empty-gc0W5 .version-list-version-list-empty-icon-3zBY3{background-image:url("+n+");background-position:0 -214px;width:96px;height:96px;margin-left:auto;margin-right:auto}.version-list-version-list-2QZFy .version-list-version-list-empty-gc0W5 .version-list-version-list-empty-text-NPxIV{color:rgba(0,0,0,.4);font-size:12px;text-align:center;margin-top:4px}.version-list-version-list-tab-show-25Nvr{height:calc(100% - 122px)}",""]),t.locals={"version-list":"version-list-version-list-2QZFy","version-list-empty":"version-list-version-list-empty-gc0W5","version-list-empty-icon":"version-list-version-list-empty-icon-3zBY3","version-list-empty-text":"version-list-version-list-empty-text-NPxIV","version-list-tab-show":"version-list-version-list-tab-show-25Nvr"}},"456e306c62":function(e,t,i){"use strict";var n=i("e0e8dd9366"),r=i("3344f1a2e7"),o={};o[n.d.SHAPE]={type:n.d.SHAPE,defaultWidth:Object(r.C)(52),defaultHeight:Object(r.C)(36),props:{style:{}}},o[n.d.TABLE]={type:n.d.TABLE,defaultWidth:Object(r.C)(800),defaultHeight:Object(r.C)(200)},o[n.d.IMAGE]={type:n.d.IMAGE,props:{style:{width:Object(r.C)(281),height:Object(r.C)(200)}}},t.a=o},"461b414520":function(e,t,i){"use strict";var n,r,o=i("1f925d7f50"),a=i.n(o),l=i("9132715560"),s=i.n(l),c=i("6a364eb35c"),d=i.n(c),u=(i("85d0a7609b"),i("2dc700e1e6")),h=i.n(u),v=(i("f1054791f4"),i("8ee19818c4"),i("a2a09da1e3"),i("63513d8b56"),i("d5c3deb8c7")),f=(n=function(){function e(){s()(this,e),a()(this,"_selectedArray",r,this)}return d()(e,[{key:"length",get:function(){return this.selectedArray.length}},{key:"selectedArray",get:function(){return this._selectedArray}},{key:"add",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(v.w)((function(){i.forEach((function(t){t&&!1===e.findItem(t)&&(t.selected=!0,e.selectedArray.push(t))}))}))}},{key:"remove",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(v.w)((function(){i.forEach((function(t){t.selected=!1;var i=e.selectedArray.indexOf(t);-1!==i&&e.selectedArray.splice(i,1)}))}))}},{key:"objectAtIndex",value:function(e){return this.selectedArray[e]}},{key:"indexOfObject",value:function(e){return e?this.selectedArray.indexOf(e):-1}},{key:"clear",value:function(){var e=this;Object(v.w)((function(){e.selectedArray.forEach((function(e){e.selected=!1})),e.selectedArray.splice(0,e.selectedArray.length)}))}},{key:"clearAndAdd",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(v.w)((function(){e.selectedArray.forEach((function(e){e.selected=!1})),e.selectedArray.splice(0,e.selectedArray.length),i.forEach((function(t){t.selected=!0,e.selectedArray.push(t)}))}))}},{key:"findItem",value:function(e){return-1!==this._selectedArray.indexOf(e)}}]),e}(),r=h()(n.prototype,"_selectedArray",[v.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),n);t.a=f},"4a1f5f72c2":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));i("85d48ef22b"),i("8e7cce0ada"),i("2a6f332b5e"),i("963f2eaace"),i("c6244f7705"),i("b1e2246d82"),i("8aebbf296a"),i("a84962d637"),i("f45588a8ad"),i("de37db1287");var n=i("9da6335152"),r=i("d3d31c86eb");function o(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){s=!0,o=e},f:function(){try{l||null==i.return||i.return()}finally{if(s)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function l(){if("IntersectionObserver"in window)try{var e=document.documentElement,t={root:null,threshold:s()};new IntersectionObserver((function(t){var i,a=o(t);try{for(a.s();!(i=a.n()).done;){var l=i.value;if(l.target===e){var s=l.boundingClientRect||e.getBoundingClientRect(),c=s.left,d=void 0===c?0:c,u=s.top;if(0!==d||0!==(void 0===u?0:u))try{Object(r.c)({opername:n.e.PPT_QUALITY,module:n.d.HTML_DOCUMENT,action:n.b.HTML_ABNORMAL_OFFSET,ver6:JSON.stringify({htmlBoundingClientRect:s})})}catch(e){window.log.error("[HTML abnormal offset observer callback error]: ".concat(e))}}}}catch(e){a.e(e)}finally{a.f()}}),t).observe(e)}catch(e){window.log.error("[createHTMLViewportOffsetObserve error]: ".concat(e))}}function s(){for(var e=[],t=0;t<=1;t+=.01)e.push(t);return e}},"4b24abada4":function(e,t,i){(t=e.exports=i("9dddfe0040")(!1)).push([e.i,".index-modelInner-tK_j3{width:100%;margin-top:8px}.index-modelContentLine-263Sg{width:100%;height:28px;display:flex;align-items:center;margin-bottom:24px}.index-optionStyle-2-wLC{width:124px}.index-gridSpaceLabel-2eDI0{width:42px;min-width:-webkit-max-content;min-width:max-content}.index-contentLineSpace-2yo5A{width:10px;margin-top:10px}.index-selectStyle-2nS42{height:28px;width:146px}.index-numberInput-2ZqKp{margin-left:14px}.index-subTitle-3DB19{opacity:.4;font-size:14px;font-weight:400;font-stretch:normal;font-style:normal;line-height:1.57;letter-spacing:normal;color:#000;margin-bottom:20px}.index-checkFontStyle-1f6eq{font-weight:500}",""]),t.locals={modelInner:"index-modelInner-tK_j3",modelContentLine:"index-modelContentLine-263Sg",optionStyle:"index-optionStyle-2-wLC",gridSpaceLabel:"index-gridSpaceLabel-2eDI0",contentLineSpace:"index-contentLineSpace-2yo5A",selectStyle:"index-selectStyle-2nS42",numberInput:"index-numberInput-2ZqKp",subTitle:"index-subTitle-3DB19",checkFontStyle:"index-checkFontStyle-1f6eq"}},"4bd2348dcf":function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36");var n=i("85d0a7609b"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("bd29e2df90"),d=i.n(c),u=i("ab5eb40518"),h=i.n(u),v=i("1b4cdd6a36"),f=i.n(v),p=(i("6e20b6a7d8"),i("8e7cce0ada"),i("74f903c034"),i("8ee19818c4"),i("a42b29265b")),g=i("9657b29818"),y=i("a7888a8b87"),m=i.n(y),b=i("5c59da31dd"),S=i("f83ba7d4f8"),M=i("8c101803a8"),E=i("9da6335152"),C=i("d3d31c86eb");function k(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function w(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?k(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):k(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var x=function(e){d()(i,e);var t=I(i);function i(e,n){return a()(this,i),t.call(this,e,n)}return s()(i,[{key:"paste",value:function(){var e,t,i,n;null===(e=this.textSelectivePasteState)||void 0===e||e.beforePaste(),null===(t=this.undoRedoService)||void 0===t||t.undo(),null===(n=(i={},r()(i,p.c.SHAPE,this.pasteShape),r()(i,p.c.SLIDE,this.pasteSlide),r()(i,p.c.TEXT,this.pasteText),i)[this.type])||void 0===n||n.call(this),this.report()}},{key:"pasteShape",value:function(){var e,t,i,n=this,r=m()(this.clipboardData.data).map((function(e){var t,i,r,o=e.ownSdkData;return o=b.a.updatePlaceHolderData(o,null===(t=n.selectionService)||void 0===t||null===(i=t.currentSlide)||void 0===i?void 0:i.sdkData),M.a.adjustElementPosition(o,null===(r=n.selectionService)||void 0===r?void 0:r.currentSlide,p.a.OWN),o})),o=null===(e=this.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t||null===(i=t.sdkData)||void 0===i?void 0:i.api;null==o||o.addShapes(r)}},{key:"pasteText",value:function(){var e,t=this,i=null===(e=this.textSelectionUndoRedo)||void 0===e?void 0:e.afterUndoRedo((function(){var e,n,r;null===(e=t.copyPasteManager)||void 0===e||null===(n=e.dangerousInstance)||void 0===n||n.runTextSelectivePaste(t.clipboardData.data[0].ownSdkData),null==i||i(),null===(r=t.textSelectivePasteState)||void 0===r||r.afterPaste()}))}},{key:"pasteSlide",value:function(){var e,t=this,i=null===(e=this.selectionService)||void 0===e?void 0:e.uiDataService,n=i.presentation.sdkData,r=this.insertSlideIndex,o={};Object(g.b)((function(){var e,a=b.a.reorganizeSlideSdkData({clipboardData:t.clipboardData,insertSlideIndex:r>0?r-1:r,sdkDataV3:n,slideSdkDataModify:t.slideSdkDataModify,uiDataService:i});if(!a)return{};var l=a.map((function(e){return e.ownSdkData}));null!=n&&null!==(e=n.sectionList)&&void 0!==e&&e.length?null==n||n.api.addSlidesWithSection(l,t.insertGapIndex):null==n||n.api.addSlides(l,t.insertGapIndex),o=Object.fromEntries(a.map((function(e,t){return[e.ownSdkData.id,n.slideList[r+t]]}))),t.clipboardData.noteList&&m()(t.clipboardData.noteList).forEach((function(e){var t,i=null===(t=o)||void 0===t?void 0:t[e.ownSdkData.slideId];null==i||i.api.addNoteSlide(w(w({},e.ownSdkData),{},{slideId:i.id}))}))}))}},{key:"report",value:function(){Object(C.c)({opername:E.e.DOC_PPT,module:E.d.PASTE_SPECIAL,action:E.b.DESTINATION_THEME})}}]),i}(S.a)},"4d0823ca93":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("d7a2286b24"),s=i("4e7af1026b"),c=function(){function e(){r()(this,e)}return a()(e,[{key:"enableQuickTool",value:function(){var e;return null===(e=l.default.getInstance().getConfig(s.k.quickTool))||void 0===e||e}}]),e}()},"56dae184c9":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e,t){if("requestIdleCallback"in window)return window.requestIdleCallback(e,t);var i=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-i))}})}),1)}},"5a075649c6":function(e,t,i){"use strict";t.a=function(){var e=document.createElement("div");return e.setAttribute("contenteditable","true"),e.setAttribute("tabindex","0"),e.style.cssText="position: absolute; left: -999px; top: 0; width: 0; height: 0",e}},"5c27b1329d":function(e,t,i){"use strict";i.d(t,"a",(function(){return me}));var n=i("730477bb20"),r=i.n(n),o=i("1f925d7f50"),a=i.n(o),l=i("9132715560"),s=i.n(l),c=i("6a364eb35c"),d=i.n(c),u=i("85d0a7609b"),h=i.n(u),v=i("2dc700e1e6"),f=i.n(v),p=(i("f1054791f4"),i("69084d01d3")),g=i.n(p),y=i("d5c3deb8c7"),m=i("3344f1a2e7"),b=i("d3d31c86eb"),S=i("9da6335152"),M=i("020899bf26"),E=(i("73b854064b"),i("547611bd96")),C=i.n(E),k=i("bd29e2df90"),w=i.n(k),I=i("ab5eb40518"),x=i.n(I),O=i("1b4cdd6a36"),A=i.n(O),L=(i("3bf1976a4f"),i("22569efd03"),i("ef51bf4fed"),i("826dc923b3"),i("e792a3169a")),R=i.n(L),D=i("d3f5530e59"),T=i.n(D),P={insert:"head",singleton:!1},B=(R()(T.a,P),T.a.locals||{}),G=i("14502724a6"),j=i.n(G),N=(i("6e20b6a7d8"),i("52d461bc51")),F=i.n(N),z=i("a6a688d71a"),H=i.n(z),U=i("d436b8c143"),W=i.n(U),_=i("5fac0349d3"),Y=i("4b24abada4"),V=i.n(Y),K={insert:"head",singleton:!1},X=(R()(V.a,K),V.a.locals||{}),Q=i("56373a2988"),Z=i.n(Q),q=i("b4a31815a1");function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=A()(e);if(t){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return x()(this,i)}}var $="custom_space",ee=.125,te=.166,ie=.2,ne=.25,re=.333,oe=[{title:_.a.t("每厘米8个网格"),value:ee},{title:_.a.t("每厘米6个网格"),value:te},{title:_.a.t("每厘米5个网格"),value:ie},{title:_.a.t("每厘米4个网格"),value:ne},{title:_.a.t("每厘米3个网格"),value:re},{title:_.a.t("每厘米2个网格"),value:.5},{title:"1".concat(_.a.t("厘米")),value:1},{title:"2".concat(_.a.t("厘米")),value:2},{title:"3".concat(_.a.t("厘米")),value:3},{title:"4".concat(_.a.t("厘米")),value:4},{title:"5".concat(_.a.t("厘米")),value:5},{title:_.a.t("自定义"),value:$}],ae=function(e){w()(i,e);var t=J(i);function i(e){var n;s()(this,i),n=t.call(this,e),h()(C()(n),"reaction",void 0),h()(C()(n),"gridLineManager",void 0),h()(C()(n),"guidesManager",void 0),h()(C()(n),"hideModal",(function(){n.gridLineManager.displayGridLineDialog=!1,n.resetState()})),h()(C()(n),"updateComponent",(function(){n.forceUpdate()})),h()(C()(n),"isCustomGridSpace",(function(e){return-1===oe.findIndex((function(t){return t.value===e}))})),h()(C()(n),"handleOk",(function(){var e=n.state.isCustom?n.state.customGridSpace:n.state.gridSpace;n.gridLineManager.setGridSpace(Number(e)),n.gridLineManager.displayGridLineDialog=!1,n.gridLineManager.setIsGridAlign(n.state.isGridAlign),n.gridLineManager.setDisplayGridLine(n.state.displayGridLine),n.guidesManager.setDisplayGuides(n.state.displayGuides)})),h()(C()(n),"handleCustomSpaceChange",(function(e){n.setState({customGridSpace:Number(e)})})),h()(C()(n),"resetState",(function(){var e=n.gridLineManager,t=e.gridSpace,i=e.displayGridLine,r=e.isGridAlign,o=n.guidesManager.displayGuides,a=n.isCustomGridSpace(t);n.setState({gridSpace:a?$:t,isCustom:a,displayGridLine:i,isGridAlign:r,displayGuides:o})}));var r=e.gridLineManager,o=e.guidesManager,a=r.gridSpace,l=r.displayGridLine,c=r.isGridAlign,d=o.displayGuides;n.gridLineManager=r,n.guidesManager=o;var u=n.isCustomGridSpace(a);return n.state={isCustom:u,gridSpace:u?$:a,customGridSpace:u?a:.5,displayGridLine:l,isGridAlign:c,displayGuides:d},n.reaction=Object(y.r)((function(){return[n.gridLineManager.displayGridLineDialog,n.gridLineManager.isGridAlign,n.gridLineManager.displayGridLine,n.guidesManager.displayGuides]}),(function(e){var t=j()(e,4),i=(t[0],t[1]),r=t[2],o=t[3];n.setState({isGridAlign:i,displayGridLine:r,displayGuides:o})})),n}return d()(i,[{key:"componentWillUnmount",value:function(){var e;null===(e=this.reaction)||void 0===e||e.call(this)}},{key:"render",value:function(){var e=this;return g.a.createElement("div",{onDoubleClick:function(e){e.stopPropagation()}},g.a.createElement(F.a,{draggable:!0,maskClosable:!1,title:_.a.t("网格和参考线"),visible:this.gridLineManager.displayGridLineDialog,okText:_.a.t("确定"),cancelText:_.a.t("取消"),onCancel:this.hideModal,onOk:this.handleOk,destroyOnClose:!0,onClickMask:function(e){e.stopPropagation()}},g.a.createElement("div",{className:X.modelInner},g.a.createElement("div",{className:X.subTitle},"".concat(_.a.t("对齐"))),g.a.createElement("div",{className:X.modelContentLine},g.a.createElement(H.a,{className:X.checkFontStyle,onChange:function(t){e.setState({isGridAlign:t})},checked:this.state.isGridAlign},_.a.t("对象与网格对齐"))),g.a.createElement("div",{className:X.subTitle},"".concat(_.a.t("网格设置"))),g.a.createElement("div",{className:X.contentLineSpace}),g.a.createElement("div",{className:X.modelContentLine},g.a.createElement("div",{className:X.gridSpaceLabel},"".concat(_.a.t("间距")).concat(_.a.t("："))),g.a.createElement("div",null,g.a.createElement(W.a,{className:X.selectStyle,onChange:function(t){var i=t===$,n=i?$:Number(t);e.setState({isCustom:i,gridSpace:n,customGridSpace:.5})},value:this.state.gridSpace},oe.map((function(e){return g.a.createElement(W.a.Option,{className:X.optionStyle,key:e.value,value:e.value},e.title)})))),this.state.isCustom&&g.a.createElement("div",{className:X.numberInput},g.a.createElement(q.g,{min:ee,max:5,step:.1,toFixed:2,allowDecimal:!0,defaultValue:.5,onChange:this.handleCustomSpaceChange,value:String(this.state.customGridSpace),style:{height:28,width:65}}))),g.a.createElement("div",{className:X.contentLineSpace}),g.a.createElement("div",{className:X.modelContentLine},g.a.createElement(H.a,{className:X.checkFontStyle,onChange:function(t){return e.setState({displayGridLine:t})},checked:this.state.displayGridLine},_.a.t("屏幕上显示网格"))),g.a.createElement(Z.a,{style:{marginBottom:"25px"}}),g.a.createElement("div",{className:X.subTitle},"".concat(_.a.t("参考线设置"))),g.a.createElement("div",{className:X.modelContentLine},g.a.createElement(H.a,{className:X.checkFontStyle,onChange:function(t){return e.setState({displayGuides:t})},checked:this.state.displayGuides},_.a.t("屏幕上显示绘图参考线"))))))}}]),i}(g.a.Component);function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=A()(e);if(t){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return x()(this,i)}}var se,ce,de,ue,he,ve,fe,pe,ge=function(e){w()(i,e);var t=le(i);function i(e){var n;s()(this,i),n=t.call(this,e),h()(C()(n),"gridLineManager",void 0),h()(C()(n),"reaction",void 0);var r=e.gridLineManager;return n.gridLineManager=r,n.reaction=Object(y.r)((function(){return[n.gridLineManager.displayGridLine,n.gridLineManager.gridSpace]}),(function(){n.forceUpdate()})),n}return d()(i,[{key:"componentWillUnmount",value:function(){this.reaction()}},{key:"render",value:function(){var e=this.props,t=e.slideWidth,i=e.slideHeight,n=e.scale,r=e.width,o=e.height,a=e.left,l=e.top;this.gridLineManager.setCanvasSize({slideWidth:t,slideHeight:i,width:r,height:o,left:a,top:l,scale:n});var s=this.gridLineManager.gridSpace;if(!s)return null;var c=this.isCustomGridSpace(s),d=s*m.e,u=0,h=1/n;if(c){var v=this.computeCellLengthWithCustomGridSpace(s);d=v*m.e,u=Math.round(v/s)}var f,p=d;s<=1&&(c?p=(d-h*u)/u:(d=2*m.e,this.isSmallerScaleGrid(s,2*n)?((f=s)===ie&&(f=ne),f*=2):f=this.isScaleGrid(s,2*n)?s:s/2,p=(d-h/f)*f));var y=this.getSvgContainerSize(t,d,i),b=y.svgHoriCellNumber,S=y.svgVertCellNumber;return g.a.createElement("div",{style:{width:Math.round(r/n),height:Math.round(o/n),transformOrigin:"left top",transform:"scale(".concat(n,")"),position:"absolute",pointerEvents:"none",mixBlendMode:"difference"}},g.a.createElement("div",{style:{position:"absolute",width:t,height:i,top:Math.round(l/n),left:Math.round(a/n)}},g.a.createElement("div",{className:B.gridLineContainer},this.gridLineManager.displayGridLine&&g.a.createElement("div",{className:B.gridLineSvgContainer,style:{width:b*d,height:S*d}},g.a.createElement("svg",{width:"100%",height:"100%"},g.a.createElement("defs",null,g.a.createElement("pattern",{id:"grid",width:d,height:d,patternUnits:"userSpaceOnUse"},g.a.createElement("path",{d:"M 0 0 L 0 ".concat(d," M 0 0 L ").concat(d," 0"),fill:"none",stroke:"rgb(167, 167, 167)",strokeWidth:2*h,strokeDasharray:"".concat(h,",").concat(p)}))),g.a.createElement("rect",{width:"100%",height:"100%",fill:"url(#grid)"}))),g.a.createElement(ae,{gridLineManager:this.gridLineManager,guidesManager:this.props.guidesManager}))))}},{key:"getSvgContainerSize",value:function(e,t,i){var n=Math.ceil(e/t)+1,r=Math.ceil(i/t)+1;return n%2==1&&(n+=1),r%2==1&&(r+=1),{svgHoriCellNumber:n,svgVertCellNumber:r}}},{key:"isScaleGrid",value:function(e,t){return e<=1&&e>.5&&t<=.2||(e<=.5&&e>re&&t<=.4||(e<=re&&e>ne&&t<=.6||(e<=ne&&e>ie&&t<=.8||(e<=ie&&e>te&&t<=1||(e<=te&&e>ee&&t<=1.2||e===ee&&t<=1.6)))))}},{key:"isSmallerScaleGrid",value:function(e,t){return e<=1&&e>re&&t<.3||(e<=re&&e>ne&&t<.31||(e<=ne&&e>ie&&t<.42||(e<=ie&&e>te&&t<.53||(e<=te&&e>ee&&t<.64||e===ee&&t<.85))))}},{key:"isCustomGridSpace",value:function(e){return-1===oe.findIndex((function(t){return t.value===e}))}},{key:"computeCellLengthWithCustomGridSpace",value:function(e){if(e>1)return e;for(var t=0,i=0,n=Number.MAX_SAFE_INTEGER;t<3;)t+=e,Math.abs(t-2)<n&&(n=Math.abs(t-2),i=t);return i}}]),i}(g.a.Component),ye=i("5ce71228c0");!function(e){e[e.show=0]="show",e[e.hide=1]="hide"}(pe||(pe={}));var me=(se=Reflect.metadata("design:type",Boolean),ce=Reflect.metadata("design:type",Boolean),de=function(){function e(t){var i=this;s()(this,e),a()(this,"displayGridLine",ue,this),a()(this,"isGridAlign",he,this),a()(this,"displayGridLineDialog",ve,this),a()(this,"gridSpace",fe,this),h()(this,"absorbPointX",[]),h()(this,"absorbPointY",[]),h()(this,"allGridInfo",void 0),h()(this,"slideWidth",void 0),h()(this,"slideHeight",void 0),h()(this,"slideLeft",void 0),h()(this,"slideTop",void 0),h()(this,"canvasWidth",void 0),h()(this,"canvasHeight",void 0),h()(this,"absorbManager",void 0),h()(this,"guidesManager",void 0),h()(this,"setCanvasSize",(function(e){var t=e.slideWidth,n=e.slideHeight,r=e.width,o=e.height,a=e.top,l=e.left,s=e.scale;i.slideWidth=t,i.slideHeight=n,i.canvasWidth=r/s,i.canvasHeight=o/s,i.slideTop=a/s,i.slideLeft=l/s,i.setAbsorbPoint()})),h()(this,"changeDisplayGridLine",(function(){i.setDisplayGridLine(!i.displayGridLine),Object(b.c)({opername:S.e.DOC_PPT,module:S.d.GRID_LINE,action:S.b.OPEN_GRID_LINE})})),h()(this,"changeIsGridAlign",(function(){i.setIsGridAlign(!i.isGridAlign)})),h()(this,"setGridSpace",(function(e){try{var t,n;i.gridSpace=e,i.allGridInfo[null!==(t=null===(n=M.a.DocInfoManager())||void 0===n?void 0:n.globalPadId)&&void 0!==t?t:""]=e,ye.b.setItem(ye.a.USE_GRID_INFO,i.allGridInfo),i.setAbsorbPoint()}catch(e){window.log.error("[grid-parse-error]".concat(e))}})),h()(this,"setDisplayGridLine",(function(e){i.displayGridLine=e,i.displayGridLine?(ye.b.setItem(ye.a.DISPLAY_GRID_LINE,pe.show),Object(b.c)({opername:S.e.DOC_PPT,module:S.d.GRID_LINE,action:S.b.EXPOSURE_GRID_LINE})):ye.b.setItem(ye.a.DISPLAY_GRID_LINE,pe.hide)})),h()(this,"getGridInfoByLocalStorage",(function(){var e,t;i.allGridInfo=ye.b.getItem(ye.a.USE_GRID_INFO,{}),i.gridSpace=i.allGridInfo[null!==(e=null===(t=M.a.DocInfoManager())||void 0===t?void 0:t.globalPadId)&&void 0!==e?e:""]||.25})),h()(this,"setAbsorbPoint",(function(){for(var e,t,n=[],r=[],o=m.e*i.gridSpace,a=i.slideWidth/2,l=i.slideHeight/2,s=a;s>3*-i.slideLeft;s-=o)n.push(s);for(var c=a+o;c<i.canvasWidth;c+=o)n.push(c);for(var d=l;d>3*-i.slideTop;d-=o)r.push(d);for(var u=l+o;u<i.canvasHeight;u+=o)r.push(u);null===(e=i.absorbManager.gridAbsorbLogic)||void 0===e||e.updateAbsorbPoint(n,r),null===(t=i.absorbManager.gridAbsorbLogic)||void 0===t||t.updateAbsorbStep(i.gridSpace*m.e),i.absorbPointX=n,i.absorbPointY=r}));var n=t.absorbManager;this.absorbManager=n,ye.b.getItem(ye.a.DISPLAY_GRID_LINE)===pe.show?this.displayGridLine=!0:this.displayGridLine=!1,ye.b.getItem(ye.a.USE_GRID_ALIGN)===pe.show?this.isGridAlign=!0:this.isGridAlign=!1,this.absorbManager.setIsGridAbsorb(this.isGridAlign),Object(M.b)((function(){i.getGridInfoByLocalStorage()})),this.displayGridLine&&Object(b.c)({opername:S.e.DOC_PPT,module:S.d.GRID_LINE,action:S.b.EXPOSURE_GRID_LINE})}return d()(e,[{key:"setGuidesManager",value:function(e){this.guidesManager=e}},{key:"setIsGridAlign",value:function(e){this.isGridAlign=e,this.isGridAlign?ye.b.setItem(ye.a.USE_GRID_ALIGN,pe.show):ye.b.setItem(ye.a.USE_GRID_ALIGN,pe.hide),this.absorbManager.setIsGridAbsorb(this.isGridAlign)}},{key:"getGridLineComponent",value:function(e){return this.guidesManager?g.a.createElement(ge,r()({gridLineManager:this,guidesManager:this.guidesManager},e)):null}}]),e}(),ue=f()(de.prototype,"displayGridLine",[y.q,se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=f()(de.prototype,"isGridAlign",[y.q,ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=f()(de.prototype,"displayGridLineDialog",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fe=f()(de.prototype,"gridSpace",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),de)},"5c59da31dd":function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("85d0a7609b"),r=i.n(n),o=i("14502724a6"),a=i.n(o),l=i("9132715560"),s=i.n(l),c=i("6a364eb35c"),d=i.n(c),u=(i("8ee19818c4"),i("342844cefa"),i("cd88b12bb6"),i("6e20b6a7d8"),i("0acdc5834b"),i("8a35b54c1d"),i("b8217400dc"),i("e6f68cdf2e"),i("b1e2246d82"),i("75563bc376"),i("a84962d637"),i("c554310b5c"),i("bcb5d93d36"),i("7c46f42788")),h=i("711a53c9fc"),v=i("a42b29265b"),f=i("a7888a8b87"),p=i.n(f),g=i("020899bf26"),y=i("98efcda99e"),m=i.n(y),b=i("ee6bb53310"),S=i.n(b),M=i("45004b03ed"),E=i("0cbec907c5");function C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function k(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?C(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var w=function(){function e(){s()(this,e)}return d()(e,null,[{key:"reorganizeSlideSdkData",value:function(e){var t,i=this,n=e.clipboardData,r=e.insertSlideIndex,o=e.sdkDataV3,a=e.slideSdkDataModify,l=(e.uiDataService,n.data),s=n.globalPadId!==(null===(t=g.a.DocInfoManager())||void 0===t?void 0:t.globalPadId),c=n,d=c.slideSize,u=c.layoutList;l.forEach((function(e){var t,n,r,o,a,l,s,c,d,u,h,v;i.modifyPrstGeomAdjName(null===(t=e.ownSdkData)||void 0===t||null===(n=t.cSld)||void 0===n||null===(r=n.spTree)||void 0===r?void 0:r.shapeList),i.modifyPrstGeomAdjName(null===(o=e.inheritedSdkData)||void 0===o||null===(a=o.cSld)||void 0===a||null===(l=a.spTree)||void 0===l?void 0:l.shapeList),i.addPrstGeomInPicture(null===(s=e.ownSdkData)||void 0===s||null===(c=s.cSld)||void 0===c||null===(d=c.spTree)||void 0===d?void 0:d.shapeList),i.addPrstGeomInPicture(null===(u=e.inheritedSdkData)||void 0===u||null===(h=u.cSld)||void 0===h||null===(v=h.spTree)||void 0===v?void 0:v.shapeList)}));var h=p()(l);return h.forEach((function(e){var t=u&&i.getDestinationLayoutId(r,o,e.ownSdkData,u);Object.keys(e).forEach((function(i){var r=e[i];if(s&&n.slideSize){var o=!!t;a.adjustPageData(r,d,o)}i===v.a.OWN&&t&&(r.layoutId=t),Reflect.deleteProperty(r,"noteSlideId")}))})),h}},{key:"updateResourceMap",value:function(e){var t,i=e.presentation,n=e.resourceMap,r=e.copiedDocId;(Object.keys(n.audios).length||Object.keys(n.videos).length)&&r!==(null===(t=g.a.DocInfoManager())||void 0===t?void 0:t.globalPadId)&&(n.audios={},n.videos={}),i.api.updateResourceMap(n)}},{key:"removeAttachment",value:function(e){var t,i=this;return e.globalPadId!==(null===(t=g.a.DocInfoManager())||void 0===t?void 0:t.globalPadId)&&[e.data.map((function(e){return e.ownSdkData})),e.data.map((function(e){return e.inheritedSdkData}))].reduce((function(e,t){return i.removeMediaProperty(t)||e}),!1)}},{key:"updatePlaceHolderData",value:function(e,t){var i,n;if(null==e||null===(i=e.nvPr)||void 0===i||!i.ph)return e;var r=null===(n=g.a.SDKDataServices.DataHelper())||void 0===n?void 0:n.getInheritedDataFromPlaceholder(e,t);return r?(m()(null==r?void 0:r.nvPr,"ph"),r):(m()(null==e?void 0:e.nvPr,"ph"),e)}},{key:"modifyPrstGeomAdjName",value:function(e){var t;(null!==(t=null==e?void 0:e.filter((function(e){var t,i,n;return((null==e?void 0:e.type)===u.a.Shape||(null==e?void 0:e.type)===u.a.Picture)&&(null===(t=e.spPr)||void 0===t||null===(i=t.prstGeom)||void 0===i||null===(n=i.avLst)||void 0===n?void 0:n.gd)})))&&void 0!==t?t:[]).forEach((function(e){var t,i,n,r,o,a=(null!==(t=null===(i=e.spPr)||void 0===i||null===(n=i.prstGeom)||void 0===n?void 0:n.avLst)&&void 0!==t?t:{}).gd,l=void 0===a?[]:a;if(null!==(r=e.spPr)&&void 0!==r&&null!==(o=r.prstGeom)&&void 0!==o&&o.prst){var s=h.gb[e.spPr.prstGeom.prst];l.forEach((function(e,t){if(Object.keys(M.b).includes(s)){var i=M.b[s];if(t<=i.length)return void(e.name=i[t])}1!==l.length||s.includes("Connector")?e.name="adj".concat(t+1):e.name="adj"}))}}))}},{key:"addPrstGeomInPicture",value:function(e){var t;(null!==(t=null==e?void 0:e.filter((function(e){var t;return(null==e?void 0:e.type)===u.a.Picture&&!(null!==(t=e.spPr)&&void 0!==t&&t.prstGeom)})))&&void 0!==t?t:[]).forEach((function(e){e.spPr&&(e.spPr.prstGeom={prst:h.gb.rect})}))}},{key:"getDestinationLayoutId",value:function(e,t,i,n){var r,o,l,s=this.getCopiedLayoutData(i,n);if(s){var c=null===(r=s.cSld)||void 0===r?void 0:r.name,d=null==t||null===(o=t.slideList)||void 0===o||null===(l=o[e])||void 0===l?void 0:l.getMaster();if(d){var u=d.layoutList,h=null==u?void 0:u.find((function(e){var t;return(null===(t=e.props.data.cSld)||void 0===t?void 0:t.name)===c}));if(h)return h.id;var v=t.api.addLayouts([k(k({},s),{},{masterId:d.id})],d.layoutList.length);return a()(v,1)[0].get(s.id)}}}},{key:"getCopiedLayoutData",value:function(e,t){var i=e.layoutId;if(i){var n=t.find((function(e){var t;return(null==e||null===(t=e.ownSdkData)||void 0===t?void 0:t.id)===i}));return null==n?void 0:n.ownSdkData}}},{key:"removeMediaProperty",value:function(e){var t=this;return!(null==e||!e.length)&&e.reduce((function(e,i){if(i.type===u.a.Picture){var n,r;if(null!==(n=i.nvPr)&&void 0!==n&&n.egMedia)return m()(i.nvPr,"egMedia"),m()(i.nvPr,"hlinkClick"),!0;if(null!==(r=i.nvPr)&&void 0!==r&&r.attachment)return m()(i.nvPr,"attachment"),S()(i,"blipFill.blip.embed",E.q),S()(i,"blipFill.srcRect",{b:0,l:0,t:0,r:0}),!0}var o;if(i.type===u.a.Shape)return null!==(o=i.nvPr)&&void 0!==o&&o.attachment?(m()(i.nvPr,"attachment"),!0):e;if(i.type===u.a.Slide){var a,l,s=null===(a=i.cSld)||void 0===a||null===(l=a.spTree)||void 0===l?void 0:l.shapeList;return t.removeMediaProperty(s)}if(i.type===u.a.GroupShape){var c=null==i?void 0:i.shapeList;return t.removeMediaProperty(c)}return e}),!1)}}]),e}()},"6307baa8a6":function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("547611bd96"),s=i.n(l),c=i("bd29e2df90"),d=i.n(c),u=i("ab5eb40518"),h=i.n(u),v=i("8eec1e4a03"),f=i.n(v),p=i("1b4cdd6a36"),g=i.n(p),y=i("85d0a7609b"),m=i.n(y),b=i("7faf76450d"),S=i("69084d01d3"),M=i.n(S),E=i("f1f2954cff"),C=i.n(E),k=i("2e0796c118"),w=i.n(k);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var x=function(e){d()(i,e);var t=I(i);function i(){return r()(this,i),t.apply(this,arguments)}return a()(i,[{key:"render",value:function(){return M.a.createElement("div",{id:"ocr-right-sidebar"})}}]),i}(M.a.Component);function O(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function A(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?O(Object(i),!0).forEach((function(t){m()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}m()(x,"propTypes",{options:C.a.object}),m()(x,"initDom",(function(e){w.a.render(M.a.createElement(x,null),e)}));var R="ocr-sidebar",D=function(e){d()(i,e);var t=L(i);function i(e){var n,o;return r()(this,i),o=t.call(this),m()(s()(o),"hideSidebarCallback",void 0),m()(s()(o),"show",(function(e){o.ocrSideBarManager.showModule({config:e,DOMNode:o.DOMNode,onShow:function(){o.showWrapper()},onClose:function(){o.hideWrapper()}}),o.hideSidebarCallback=null==e?void 0:e.hideSidebarCallback})),m()(s()(o),"hide",(function(){o.hideWrapper()})),m()(s()(o),"hideWrapper",(function(){var e,t;f()((n=s()(o),g()(i.prototype)),"hideWrapper",n).call(n);var r=o.DOMNode;r&&w.a.unmountComponentAtNode(r),null===(e=(t=o).hideSidebarCallback)||void 0===e||e.call(t)})),o.ocrSideBarManager=e,o}return a()(i,[{key:"name",get:function(){return R}}]),i}(b.a),T=function(){function e(){var t=this;r()(this,e),m()(this,"module",x),m()(this,"services",void 0),m()(this,"show",(function(e){t.services.rightSideBarService.show(R,e)})),m()(this,"hide",(function(){t.services.rightSideBarService.hide(),t.services.rightSideBarService.resetWidth()}))}return a()(e,[{key:"setServiceDelegates",value:function(e){this.services=A(A({},this.services),e)}},{key:"registerRightSideBar",value:function(){this.services.rightSideBarService.registerModule(new D(this))}},{key:"showModule",value:function(e){var t,i=e.DOMNode,n=e.config,r=e.onShow;e.onClose;null===(t=this.module)||void 0===t||t.initDom(i,n),null==r||r()}}]),e}()},"66d582d187":function(e,t,i){"use strict";i.d(t,"a",(function(){return $}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("547611bd96"),s=i.n(l),c=i("8eec1e4a03"),d=i.n(c),u=i("bd29e2df90"),h=i.n(u),v=i("ab5eb40518"),f=i.n(v),p=i("1b4cdd6a36"),g=i.n(p),y=i("85d0a7609b"),m=i.n(y),b=(i("8e7cce0ada"),i("c6244f7705"),i("081c8cafea"),i("85d48ef22b"),i("2a6f332b5e"),i("b1e2246d82"),i("e75093e758")),S=i("281cbdced7"),M=i.n(S),E=i("ee6bb53310"),C=i.n(E),k=i("8f58e78419"),w=i.n(k),I=i("d3d31c86eb"),x=i("9da6335152"),O=i("c528460648"),A=i("d6541e16f3"),L=i("d5c3deb8c7"),R=i("e0e8dd9366"),D=i("21f6c93a07");i("3bf1976a4f");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var P=function(e){h()(i,e);var t=T(i);function i(){var e;r()(this,i);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),m()(s()(e),"curCanvasWrapperStyle",void 0),m()(s()(e),"isMasterEditType",!1),e}return a()(i,[{key:"initModel",value:function(e,t){d()(g()(i.prototype),"initModel",this).call(this,e,t);var n=(t||{}).curCanvasWrapperStyle;this.curCanvasWrapperStyle=n}}]),i}(i("d4ed2d38ff").a),B=i("6a9e93341e"),G=i("c13f133f92"),j=i("51b2ea9953"),N=i("730207179f"),F=i("0a8ecd6412"),z=i("1288bffff3"),H=(i("826dc923b3"),i("7d52e7e74a")),U=i("7b0ebf3e1a"),W=i("3344f1a2e7"),_=i("c9c92622ff"),Y=i("4130eb9b7d");function V(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function K(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?V(Object(i),!0).forEach((function(t){m()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):V(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var X=20,Q=function(){function e(){var t=this;r()(this,e),m()(this,"services",void 0),m()(this,"getCurrentSlideBounds",(function(e){var i,n,r;return null===(i=t.services)||void 0===i||null===(n=i.pcEditorAreaService)||void 0===n?void 0:n.getCurrentSlideBounds(e,null===(r=t.services)||void 0===r?void 0:r.pcScrollService)})),m()(this,"getComponentByModel",(function(e){var i,n;return null===(i=t.services)||void 0===i||null===(n=i.pcEditorAreaService)||void 0===n?void 0:n.getComponentByModel(e)})),m()(this,"getCanvasSize",(function(e,i,n){var r,o,a,l,s,c,d,u=t.getCanvasOffsetHeightWidth(e,i,n),h=u.offsetHeight,v=u.offsetWidth,f=X,p=v-40,g=h-40,y=(null===(r=t.services)||void 0===r||null===(o=r.uiDataService)||void 0===o?void 0:o.presentation.props)||{},m=y.slideWidth,b=void 0===m?0:m,S=y.slideHeight,M=void 0===S?0:S;if(null===(a=t.services)||void 0===a||null===(l=a.editAreaCanvasSizeManager)||void 0===l?void 0:l.getCanvasIsAutoAdapter()){var E=p/b,C=g/M,k=p-b*(d=Math.min(E,C)),w=g-M*d;s=Math.floor(k/2)+f,c=Math.floor(w/2)+f}else{var I,x,O=p-b*(d=null===(I=t.services)||void 0===I||null===(x=I.editAreaCanvasSizeManager)||void 0===x?void 0:x.getCanvasScale()),A=g-M*d;O=O<0?0:O,A=A<0?0:A,s=Math.floor(O/2)+f,c=Math.floor(A/2)+f}var L={canvasW:v,canvasH:h,left:s,top:c},R=t.computeElementCanvasSize(d,L);return{width:R.canvasWidth,height:R.canvasHeight,left:s-R.canvasLeft,top:c-R.canvasTop,cLeft:R.canvasLeft,cTop:R.canvasTop,scale:d,isShown:!0}})),m()(this,"canvasSizeChange",(function(e,t,i){var n=!1;if(["width","height","left","top","scale"].forEach((function(i){Object(W.w)(t[i],e[i],1e-10)||(n=!0)})),n)return!0;if(i){if(!Object(W.w)(i.scrollLeft,-e.cLeft,1e-10))return!0;if(!Object(W.w)(i.scrollTop,-e.cTop,1e-10))return!0}return!1})),m()(this,"getWrapperHeightAndWidth",(function(){var e=document.documentElement.clientHeight,i=document.documentElement.clientWidth;return i-=B.n,i-=t.getDrawerWidth(),i=Math.max(0,i),e-=B.j+B.D+1,{offsetHeight:e=Math.max(0,e),offsetWidth:i}})),m()(this,"getCanvasOffsetHeightWidth",(function(e,i){var n,r,o,a,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=document.documentElement.clientHeight,c=document.documentElement.clientWidth,d=i.noteAreaHeight;c-=B.n,c-=t.getDrawerWidth(),c=Math.max(139,c);var u=(null===(n=t.services)||void 0===n||null===(r=n.toolbarStateManager)||void 0===r?void 0:r.getToolbarMode())===F.v.DOUBLE_TOOLBAR?B.k:B.j;return s-=u+(l?0:B.D)+1-(e?u:0),s-=null!==(o=t.getMasterLayoutEditService())&&void 0!==o&&o.isMasterEditType?F.o:0,s=Object(Y.a)(s,d),s=Math.max(167,s),null!==(a=t.getTextRulerManager())&&void 0!==a&&a.displayRuler&&(c-=B.z,s-=B.z),{offsetHeight:s,offsetWidth:c}})),m()(this,"computeElementCanvasSize",(function(e,i){var n,r,o,a,l=i.canvasW,s=i.canvasH,c=i.left,d=i.top,u=(null===(n=t.services)||void 0===n||null===(r=n.uiDataService)||void 0===r?void 0:r.presentation.props)||{},h=u.slideWidth,v=void 0===h?0:h,f=u.slideHeight,p=void 0===f?0:f,g=null===(o=t.services)||void 0===o||null===(a=o.selectionService)||void 0===a?void 0:a.currentSlide,y=l,m=s,b=0,S=0;if(null!=g&&g.children){var M=t.computeMaxRect(g),E=M.minLeft,C=M.maxRight,k=M.minTop,w=M.maxBottom;E=Math.round(E*e),C=Math.round(C*e),k=Math.round(k*e),w=Math.round(w*e),v=Math.round(v*e)+40,p=Math.round(p*e)+40;var I=Math.max(v,l),x=Math.max(p,s);if(y=I,m=x,E<0&&Math.abs(E)+X>c){var O=Math.abs(E)-c+X;y+=O,b=-O}if(C+X>I-c&&(y+=C-(I-c)+X),k<0&&Math.abs(k)+X>d){var A=Math.abs(k)-d+X;m+=A,S=-A}w+X>x-d&&(m+=w-(x-d)+X)}return{canvasLeft:b,canvasTop:S,canvasWidth:y,canvasHeight:m}}))}return a()(e,[{key:"setServices",value:function(e){this.services=K(K({},this.services),e)}},{key:"computeMaxRect",value:function(e){var t,i=this,n=Number.MAX_VALUE,r=0,o=Number.MAX_VALUE,a=0,l=null===(t=this.getCanvasElementRect)||void 0===t?void 0:t.call(this,e);return l?(n=Math.min(n,l.left),r=Math.max(r,l.left+l.width),o=Math.min(o,l.top),a=Math.max(a,l.top+l.height),e.children.forEach((function(e){var t;if(null!=e&&null!==(t=e.props)&&void 0!==t&&t.style&&Object(_.i)(e)){var l=i.getElementRect(e);n=Math.min(n,l.left),r=Math.max(r,l.left+l.width),o=Math.min(o,l.top),a=Math.max(a,l.top+l.height)}}))):e.children.forEach((function(e){var t;if(null!=e&&null!==(t=e.props)&&void 0!==t&&t.style){var l=i.getElementRect(e);n=Math.min(n,l.left),r=Math.max(r,l.left+l.width),o=Math.min(o,l.top),a=Math.max(a,l.top+l.height)}})),{minLeft:n,maxRight:r,minTop:o,maxBottom:a}}},{key:"getCanvasElementRect",value:function(e){var t,i,n,r,o,a,l=null===(t=this.getCurrentSlideBounds)||void 0===t?void 0:t.call(this,e);if(l&&0!==l.width&&0!==l.height){var s=l.x,c=l.y,d=l.width,u=l.height,h=((null===(i=this.services)||void 0===i||null===(n=i.editAreaCanvasSizeManager)||void 0===n?void 0:n.getCanvasSize())||{}).scale||1,v=null===(r=this.services)||void 0===r||null===(o=r.pcEditorAreaService)||void 0===o||null===(a=o.currentSlideEditor)||void 0===a?void 0:a.slideComponent;return{left:s/h-((null==v?void 0:v.x)||0),top:c/h-((null==v?void 0:v.y)||0),width:d/h,height:u/h}}}},{key:"getElementRect",value:function(e){var t=e.props.style,i=t.left,n=t.top,r=t.width,o=t.height;e.type===R.d.GROUP&&(n-=H.a,i-=H.a,r+=2*H.a,o+=2*H.a);var a=t.rotate,l={left:i,top:n,width:r,height:o},s=l;return a&&a>0&&(s=Object(U.j)(l,a)),s}},{key:"getDrawerWidth",value:function(){var e,t=0;if(null!==(e=this.getRightSideBarManager())&&void 0!==e&&e.isResizeDrawerShown()){var i,n,r,o=null===(i=this.services)||void 0===i||null===(n=i.drawerStateManager)||void 0===n?void 0:n.dangerousInstance;t=null!==(r=null==o?void 0:o.getDrawerWidth())&&void 0!==r?r:0}return t}},{key:"getMasterLayoutEditService",value:function(){var e,t,i;if(null!==(e=this.services)&&void 0!==e&&null!==(t=e.userPriviledgeService)&&void 0!==t&&t.isEditable())return null===(i=this.services)||void 0===i?void 0:i.masterLayoutEditService}},{key:"getRightSideBarManager",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.rightSideBarManager}},{key:"getTextRulerManager",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.textRulerManager}}]),e}();function Z(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(i),!0).forEach((function(t){m()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Z(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var $=function(e){h()(n,e);var t=J(n);function n(e){var o;return r()(this,n),o=t.call(this,e),m()(s()(o),"slideNameReaction",void 0),m()(s()(o),"editTypeReaction",void 0),m()(s()(o),"quickSettingTimer",void 0),m()(s()(o),"debounceSlideNameChange",M()((function(e,t,i){var n,r;if(i){var o=i.sdkData,a=t;!a.length||a.length>255?C()(e.target,"value",""):(null==o||null===(n=o.api)||void 0===n||null===(r=n.updateName)||void 0===r||r.call(n,a),Object(I.c)({opername:x.e.DOC_PPT,module:x.d.MASTER,action:x.b.MASTER_RENAME}))}}),600)),m()(s()(o),"handlerSlideNameChange",(function(e){e.persist();var t=o.getCurrentSlide(),i=w()(e.target,"value");o.debounceSlideNameChange(e,i,t)})),m()(s()(o),"handleScrollEvent",(function(){var e,t,n,r,a;null===(e=o.getPcScrollService())||void 0===e||e.updateCurrentScroll(-o.containerDom.scrollLeft,-o.containerDom.scrollTop),o.hideFloatBar(),null===(t=o.services)||void 0===t||null===(n=t.multiSelectedDashOuterManager)||void 0===n||n.promise().then((function(e){e.changeFloatState()})),Promise.all([i.e("commonAsync~9b1fde68"),i.e("commonAsync~27f19aac"),i.e("commonAsync~205ac551"),i.e("commonAsync~0c3a6025"),i.e("commonAsync~32e631b8"),i.e("commonAsync~08369118"),i.e("commonAsync~50db4bb8"),i.e("commonAsync~86c92fed"),i.e("commonAsync~a95f944a"),i.e("commonAsync~6e568190"),i.e("commonAsync~b174e5ca"),i.e("commonAsync~54a68610"),i.e("commonAsync~61b3c105"),i.e("commonAsync~f7b3ac00"),i.e("commonAsync~cece21d6"),i.e("commonAsync~ecbf7682"),i.e("commonAsync~6c5dfa7c"),i.e("commonAsync~90483627"),i.e("commonAsync~d2c096c2"),i.e("commonAsync~1285a477"),i.e("commonAsync~31ded9a0"),i.e("commonAsync~ecdbff9b"),i.e("commonAsync~c2cc425c"),i.e("commonAsync~4fb44df2"),i.e("commonAsync~d06fe423"),i.e("commonAsync~0519277e"),i.e("commonAsync~6df2b9ea"),i.e("commonAsync~b5c4f9e4"),i.e("commonAsync~ffdf5190"),i.e("commonAsync~127b6cf7"),i.e("commonAsync~b3c4a2ff"),i.e("commonAsync~19bb5a55"),i.e("async~493df0b3"),i.e("async~c5b24172"),i.e("async~0d51b00e"),i.e("async~beecf843"),i.e("async~2e2c6527"),i.e("async~da8db81f"),i.e("async~e10030d6"),i.e("async~098dcb65"),i.e("async~d0c14fe8"),i.e("async~7f8bedbf"),i.e("async~f40490b4"),i.e("async~2158e36e"),i.e("async~76acd586"),i.e("async~37d786cf"),i.e("async~30ccc425"),i.e("async~0c7d7381"),i.e("async~907e9098"),i.e("async~43172549"),i.e("async~f19eb79b"),i.e("async~95108331"),i.e("async~718865d2"),i.e("async~89b7a519"),i.e("vendors~service")]).then(i.bind(null,"7f21889145")).then((function(e){var t=e.default;t.getInstance().hide(),o.quickSettingTimer&&clearTimeout(o.quickSettingTimer),o.quickSettingTimer=setTimeout((function(){t.getInstance().show(),t.getInstance().updateAnchorRect(),window.dispatchEvent(new Event("Scroll-End-Show-LinkFloatBar"))}),500)})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})),null===(r=A.a.getInstance())||void 0===r||null===(a=r.hide)||void 0===a||a.call(r)})),m()(s()(o),"handleDoubleClick",(function(e){var t,i,n,r,a,l,c,d,u;if(null!==(t=o.services)&&void 0!==t&&null!==(i=t.userPriviledgeService)&&void 0!==i&&i.isEditable()){var h=s()(o).containerDom,v=h.getBoundingClientRect(),f=e.pageX+h.scrollLeft-v.left-window.pageXOffset,p=e.pageY+h.scrollTop-v.top-window.pageYOffset,g=(null===(n=o.services)||void 0===n||null===(r=n.editAreaCanvasSizeManager)||void 0===r?void 0:r.getCanvasSize())||{},y=g.slideLeft,m=void 0===y?0:y,b=g.slideTop,S=void 0===b?0:b,M=g.scale,E=void 0===M?1:M,C={style:{position:"absolute",left:f/E-m/E,top:p/E-S/E,bgShape:G.b.RECT,border:{width:1,style:"solid"}},subType:1},k={textBodyStyle:{autoFitType:j.a.SHAPE_AUTO_FIT,bodyStyle:{whiteSpace:"pre"}}};null===(a=o.services)||void 0===a||null===(l=a.editingStateManager)||void 0===l||l.updateElementCropState(!1);var w=((null===(c=o.services)||void 0===c?void 0:c.selectionService)||{}).currentSlideIndex,O=void 0===w?0:w,A=null===(d=o.services)||void 0===d||null===(u=d.selectionService)||void 0===u?void 0:u.slides[O];if(A){var L,D,T;A.addElement([R.d.SHAPE],[C],[k]);var P=null===(L=o.services)||void 0===L||null===(D=L.selectionService)||void 0===D||null===(T=D.currentSlide)||void 0===T?void 0:T.children,B=(null==P?void 0:P.length)&&P[P.length-1];B&&Object(N.b)(B,F.e,!0),Object(I.c)({opername:x.e.DOC_PPT,module:x.d.PC_EDIT_INSERT,action:x.b.CLK_TWO_TEXT})}}else{var z,H;null===(z=o.services)||void 0===z||null===(H=z.tipsManager)||void 0===H||H.showCannotEditTips()}})),m()(s()(o),"getChartManager",(function(){var e;return null===(e=o.services)||void 0===e?void 0:e.chartManager})),m()(s()(o),"handlerSlideNameFocus",(function(){var e,t;null===(e=o.services)||void 0===e||null===(t=e.selectionService)||void 0===t||t.selectedElements.clear()})),m()(s()(o),"onKeydownEnter",(function(e){13===e.keyCode&&o.handlerSlideNameChange(e)})),m()(s()(o),"exitMasterLayoutEdiType",(function(){var e,t;null===(e=o.services)||void 0===e||null===(t=e.masterLayoutEditService)||void 0===t||t.changeEditType(z.a.SLIDE)})),o}return a()(n,[{key:"componentDidMount",value:function(){var e,t,i,r,o;d()(g()(n.prototype),"componentDidMount",this).call(this),Object(O.a)((function(e){if(!e){var t=document.getElementById("placeholder-container");null==t||t.remove()}})),null===(e=A.a.getInstance())||void 0===e||null===(t=e.init)||void 0===t||t.call(e,{},null===(i=this.services)||void 0===i?void 0:i.uiDataService,null===(r=this.services)||void 0===r?void 0:r.selectionService,null===(o=this.services)||void 0===o?void 0:o.editAreaCanvasSizeManager),this.addObserve()}},{key:"componentWillUnmount",value:function(){d()(g()(n.prototype),"componentWillUnmount",this).call(this),this.removeObserve()}},{key:"shouldShowTemplateRecommendation",value:function(){var e,t;return null===(e=null===(t=this.inject)||void 0===t?void 0:t.shouldShowTemplateRecommendation())||void 0===e||e}},{key:"getCurrentSlide",value:function(){var e,t;return null===(e=this.services)||void 0===e||null===(t=e.selectionService)||void 0===t?void 0:t.currentSlide}},{key:"createCanvasSizeHandler",value:function(){return new Q}},{key:"getDefaultNoteAreaInfo",value:function(){var e,t,i=null===(e=this.inject)||void 0===e?void 0:e.isNoteFold(),n=null===(t=this.inject)||void 0===t?void 0:t.isStatusBarFold();return i&&n?{noteAreaHeight:0}:{noteAreaHeight:i?B.r:B.s}}},{key:"createViewModel",value:function(){return new P}},{key:"getInitModelValue",value:function(){var e,t;return q(q({},d()(g()(n.prototype),"getInitModelValue",this).call(this)),{},{canvasSize:this.canvasSizeHandler.getCanvasSize(null===(e=this.inject)||void 0===e?void 0:e.isHeaderFold(),this.getDefaultNoteAreaInfo(),null===(t=this.inject)||void 0===t?void 0:t.isStatusBarFold()),curCanvasWrapperStyle:this.getCurCanvasWrapperStyle()})}},{key:"deselect",value:function(){var e,t;null===(e=this.services)||void 0===e||null===(t=e.selectedAnims)||void 0===t||t.clear(),d()(g()(n.prototype),"deselect",this).call(this)}},{key:"getHeaderFold",value:function(){var e,t=null===(e=this.inject)||void 0===e?void 0:e.isHeaderFold();return void 0!==t?t:this.isHeaderFold}},{key:"noteAreaRef",get:function(){return d()(g()(n.prototype),"noteAreaRef",this)}},{key:"fixNoteHeightByResize",value:function(){var e;null===(e=this.noteAreaRef)||void 0===e||e.fixNoteHeightByResize()}},{key:"getCurCanvasWrapperStyle",value:function(){var e,t;return null===(e=this.services)||void 0===e||null===(t=e.masterLayoutStyleService)||void 0===t?void 0:t.getCurCanvasWrapperStyle()}},{key:"addObserve",value:function(){var e=this;this.editTypeReaction=Object(L.r)((function(){var t;return null===(t=e.getMasterLayoutEditService())||void 0===t?void 0:t.isMasterEditType}),(function(t){e.updateModel({isMasterEditType:t,curCanvasWrapperStyle:e.getCurCanvasWrapperStyle()},(function(){var i;(e.resize(null,null,{noteHeightChange:!1}),t)?e.slideNameReaction=Object(L.r)((function(){var t,i=((null===(t=e.services)||void 0===t?void 0:t.selectionService)||{}).currentSlide,n=null==i?void 0:i.name;return(null==i?void 0:i.type)===R.d.MASTER&&(n=i.themeName),{slideName:n,listIndex:null==i?void 0:i.listIndex}}),(function(t){var i,n=t.slideName,r=null===(i=e.viewDelegate)||void 0===i?void 0:i.getElementById(D.c.NAME_INPUT);r&&(r.value=n)}),{fireImmediately:!0}):null===(i=e.slideNameReaction)||void 0===i||i.call(e)}))}))}},{key:"removeObserve",value:function(){var e,t;null===(e=this.slideNameReaction)||void 0===e||e.call(this),null===(t=this.editTypeReaction)||void 0===t||t.call(this)}},{key:"getMasterLayoutEditService",value:function(){var e,t,i;if(null!==(e=this.services)&&void 0!==e&&null!==(t=e.userPriviledgeService)&&void 0!==t&&t.isEditable())return null===(i=this.services)||void 0===i?void 0:i.masterLayoutEditService}},{key:"getPcScrollService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.pcScrollService}}]),n}(b.a)},"692b88f5a6":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("14502724a6"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("85d0a7609b"),d=i.n(c),u=(i("8ee19818c4"),i("7c46f42788")),h=i("98efcda99e"),v=i.n(h),f=i("8f58e78419"),p=i.n(f),g=i("020899bf26"),y=function(){function e(){var t=this;a()(this,e),d()(this,"uiDataService",void 0),d()(this,"selectionService",void 0),d()(this,"adjustPageData",(function(e,i,n){if(!n){var r=t.getLayout();e.layoutId=r.id}if(i){var o,a,l,s,c,d=i.width,u=i.height,h=null===(o=g.a.SDKDataServices.PresentationStoreService())||void 0===o?void 0:o.getPresentation(),v=(null==h?void 0:h.props.sldSz.cx)||0,f=(null==h?void 0:h.props.sldSz.cy)||0,p=0,y=0,m=0,b=f/u;if(v/d<=f/u)y=(f-u*(p=v/d))/2;else m=(v-d*(p=f/u))/2;if(null!=e&&null!==(a=e.cSld)&&void 0!==a&&null!==(l=a.spTree)&&void 0!==l&&l.shapeList)null==e||null===(s=e.cSld)||void 0===s||null===(c=s.spTree)||void 0===c||c.shapeList.forEach((function(e){var i,n,r,o,a,l,s,c,d,u,h,v;null!==(i=e.spPr.xfrm)&&void 0!==i&&null!==(n=i.off)&&void 0!==n&&n.x&&(e.spPr.xfrm.off.x=(null===(d=e.spPr.xfrm)||void 0===d||null===(u=d.off)||void 0===u?void 0:u.x)*p+m);null!==(r=e.spPr.xfrm)&&void 0!==r&&null!==(o=r.off)&&void 0!==o&&o.y&&(e.spPr.xfrm.off.y=(null===(h=e.spPr.xfrm)||void 0===h||null===(v=h.off)||void 0===v?void 0:v.y)*b+y);null!==(a=e.spPr.xfrm)&&void 0!==a&&null!==(l=a.ext)&&void 0!==l&&l.cx&&(e.spPr.xfrm.ext.cx*=p),null!==(s=e.spPr.xfrm)&&void 0!==s&&null!==(c=s.ext)&&void 0!==c&&c.cy&&(e.spPr.xfrm.ext.cy*=p),t.adaptElement(e,p,b)}))}}))}return s()(e,[{key:"setServiceDelegates",value:function(e){var t,i;this.uiDataService=null!==(t=this.uiDataService)&&void 0!==t?t:e.uiDataService,this.selectionService=null!==(i=this.selectionService)&&void 0!==i?i:e.selectionService}},{key:"getLayout",value:function(){var e;if(this.checkStateForLayout())e=r()(this.uiDataService.presentation.masterList[0].layoutList,1)[0];else try{for(var t,i,n,o,a,l,s=null===(t=this.selectionService)||void 0===t?void 0:t.currentSlide,c=-1,d=(null!==(i=null===(n=this.uiDataService)||void 0===n?void 0:n.presentation)&&void 0!==i?i:{masterList:[]}).masterList,u=0;u<d.length;u++){var h,v;if((null==s||null===(h=s.sdkData)||void 0===h||null===(v=h.getMaster())||void 0===v?void 0:v.id)===d[u].id){c=u;break}}-1===c&&(c=0);for(var f=-1,p=(null!==(o=null===(a=this.uiDataService)||void 0===a?void 0:a.presentation.masterList[c])&&void 0!==o?o:{layoutList:[]}).layoutList,g=0;g<p.length;g++){var y,m;if((null==s||null===(y=s.sdkData)||void 0===y||null===(m=y.props)||void 0===m?void 0:m.layoutId)===p[g].id){f=g;break}}-1===f&&(f=0),e=null===(l=this.uiDataService)||void 0===l?void 0:l.presentation.masterList[c].layoutList[f]}catch(t){var b,S;if((null!==(b=null===(S=this.uiDataService)||void 0===S?void 0:S.presentation.masterList.length)&&void 0!==b?b:0)>0)e=r()(this.uiDataService.presentation.masterList[0].layoutList,1)[0];else e={id:0}}return e}},{key:"checkStateForLayout",value:function(){var e,t,i;return 0===(null===(e=this.selectionService)||void 0===e?void 0:e.slideClearanceIndex)||-1===(null===(t=this.selectionService)||void 0===t?void 0:t.slideClearanceIndex)&&-1===(null===(i=this.selectionService)||void 0===i?void 0:i.currentSlideIndex)}},{key:"checkPlaceHolder",value:function(e){var t=e.slideData;p()(t,"groupShape.children.length")>0&&t.groupShape.children.forEach((function(e){"shape"===e.type&&e.isPlaceholder&&v()(e.props,"placeholder")}))}},{key:"adaptElement",value:function(e,t,i){var n;e.type===u.a.GroupShape&&this.adaptInnerGroupShape(e,t),e.type===u.a.Shape&&null!==(n=e.txBody)&&void 0!==n&&n.p&&this.adaptTextBody(e.txBody,t),e.type===u.a.GraphicalObjectFrameTable&&this.adaptTable(e,t,i)}},{key:"adaptInnerGroupShape",value:function(e,t){var i,n=this;null!==(i=e.shapeList)&&void 0!==i&&i.length&&e.shapeList.forEach((function(e){var i;e.type===u.a.GroupShape&&n.adaptInnerGroupShape(e,t),e.type===u.a.Shape&&null!==(i=e.txBody)&&void 0!==i&&i.p&&n.adaptTextBody(e.txBody,t)}))}},{key:"adaptTable",value:function(e,t,i){var n,r,o,a,l,s,c,d,u,h=this;null!==(n=e.graphic)&&void 0!==n&&null!==(r=n.graphicData)&&void 0!==r&&r.tbl&&(null===(o=e.graphic)||void 0===o||null===(a=o.graphicData)||void 0===a||null===(l=a.tbl.tblGrid)||void 0===l||null===(s=l.gridCol)||void 0===s||s.forEach((function(e){e.w&&(e.w*=t)})),null===(c=e.graphic)||void 0===c||null===(d=c.graphicData)||void 0===d||null===(u=d.tbl.tr)||void 0===u||u.forEach((function(e){var i;e.h&&(e.h*=t),null===(i=e.tc)||void 0===i||i.forEach((function(e){e.txBody&&h.adaptTextBody(e.txBody,t)}))})))}},{key:"adaptTextBody",value:function(e,t){null!=e&&e.p&&e.p.forEach((function(e){var i,n,r,o,a,l,s,c;(null===(i=e.egTextRun)||void 0===i||i.forEach((function(e){var i,n=null===(i=e.fld||e.r)||void 0===i?void 0:i.rPr;null!=n&&n.sz&&(n.sz*=t)})),e.pPr)&&(e.pPr.indent&&(e.pPr.indent*=t),e.pPr.marL&&(e.pPr.marL*=t),null!==(r=e.pPr.lnSpc)&&void 0!==r&&null!==(o=r.spcPts)&&void 0!==o&&o.val&&(e.pPr.lnSpc.spcPts.val*=t),null!==(a=e.pPr.spcAft)&&void 0!==a&&null!==(l=a.spcPts)&&void 0!==l&&l.val&&(e.pPr.spcAft.spcPts.val*=t),null!==(s=e.pPr.spcBef)&&void 0!==s&&null!==(c=s.spcPts)&&void 0!==c&&c.val&&(e.pPr.spcBef.spcPts.val*=t));null!==(n=e.endParaRPr)&&void 0!==n&&n.sz&&(e.endParaRPr.sz*=t)})),this.lineIndent(e,t)}},{key:"lineIndent",value:function(e,t){e.bodyPr&&(1!==t&&e.bodyPr.normAutofit&&v()(e.bodyPr.normAutofit,"fontScale"),e.bodyPr.bIns&&(e.bodyPr.bIns*=t),e.bodyPr.lIns&&(e.bodyPr.lIns*=t),e.bodyPr.rIns&&(e.bodyPr.rIns*=t),e.bodyPr.tIns&&(e.bodyPr.tIns*=t))}}]),e}()},"6c8d2c6e1c":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtOC42MzE3NzQ3MSA4IDQuMzY4MjI1MjkgNC4zNjgyMjUzLS42MzE3NzQ3LjYzMTc3NDctNC4zNjgyMjUzLTQuMzY4MjI1MjktNC4zNjgyMjUyOSA0LjM2ODIyNTI5LS42MzE3NzQ3MS0uNjMxNzc0NyA0LjM2ODIyNTI5LTQuMzY4MjI1My0xLjAyOTU0NDM0LTEuMDI5NTQ0MzQtMy4zMzg2ODA5NS0zLjMzODY4MDk1LjYzMTc3NDcxLS42MzE3NzQ3MSA0LjM2ODIyNTI5IDQuMzY4MjI1MjkgNC4zNjgyMjUzLTQuMzY4MjI1MjkuNjMxNzc0Ny42MzE3NzQ3MS0zLjMzODY4MDk1IDMuMzM4NjgwOTV6IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9Ii42NCIvPjwvc3ZnPg=="},"6d54f692ac":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAfUlEQVR4AWOAAabOPwukZv7nYiAWMHb8/s/Y+fsaW8d/baI1QDT9+cbc9SeJSA0IzNTxZ7Ho1P88RGuAOvEG0Im6xGpAOLHjTyrxGjr+fAZqiCJWwyX2zv/qxHm6888cmb7/nMQE6xfmzj+xxEbcFbbO/5pERRww3OcTkzQAq0eLsUcY1xMAAAAASUVORK5CYII="},"6f6784ec25":function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36");var n=i("7a5536c9bf"),r=i.n(n),o=i("1f925d7f50"),a=i.n(o),l=i("9132715560"),s=i.n(l),c=i("6a364eb35c"),d=i.n(c),u=i("85d0a7609b"),h=i.n(u),v=i("2dc700e1e6"),f=i.n(v),p=(i("f1054791f4"),i("8ee19818c4"),i("63513d8b56"),i("963f2eaace"),i("d5c3deb8c7")),g=i("ee6bb53310"),y=i.n(g),m=i("c9c92622ff"),b=i("7b6d43f0a9"),S=i("db8665b60e"),M=i("e0e8dd9366"),E=i("63684fef46");var C,k,w,I,x={createUIModel:function(e){var t;return e===M.d.SECTION?new E.a:null!==(t=Object(b.a)(e))&&void 0!==t?t:Object(S.a)(e)}},O=i("f4e26884cf"),A=i("7c6c1491aa"),L=i("51e577d93e"),R=i("285f8ccc4f");function D(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function T(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?D(Object(i),!0).forEach((function(t){h()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var P=(C=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),k=function(){function e(){var t=this;s()(this,e),h()(this,"isCopyAndMoving",void 0),a()(this,"elements",w,this),a()(this,"lastOffset",I,this),h()(this,"selectionService",void 0),h()(this,"selectedAnims",void 0),h()(this,"addModelStore",(function(e){var i;null!==(i=e.children)&&void 0!==i&&i.length&&e.children.forEach((function(e){return t.addModelStore(e)}))})),this.isCopyAndMoving=!1}return d()(e,[{key:"isMoveWithCopy",value:function(e){return Object(O.a)(e)}},{key:"addSelectElements",value:function(){var e,t=null===(e=this.selectionService)||void 0===e?void 0:e.selectedElements.getSortedSelectedArray();if(t&&t.length>0){for(var i=[],n=0;n<t.length;n++){var r=t[n];if(!Object(m.o)(r)){var o=x.createUIModel(r.type),a=r.copyModelHandler().getCopiedUiModelWithSdkModel(o);a&&(this.addModelStore(a),i.push(a)),o.props.style=T(T({},o.props.style),r.getFrame().frameOnSlide())}}this._add.apply(this,i)}}},{key:"setSelectionServiceDelegate",value:function(e){this.selectionService||(this.selectionService=e)}},{key:"setSelectedAnimsDelegate",value:function(e){this.selectedAnims||(this.selectedAnims=e)}},{key:"clear",value:function(){var e=this;this.isCopyAndMoving=!1,this.elements.length>0&&(this.lastOffset={x:0,y:0},Object(p.w)((function(){e.elements.splice(0,e.elements.length)})))}},{key:"move",value:function(e,t){var i=this;e===this.lastOffset.x&&t===this.lastOffset.y||Object(p.w)((function(){for(var n=0;n<i.elements.length;n++){var r=i.elements[n];r.props.style.left+=e-i.lastOffset.x,r.props.style.top+=t-i.lastOffset.y;var o={width:r.props.style.width,height:r.props.style.height,left:r.props.style.left,top:r.props.style.top};y()(r,"operationFrame",o)}i.lastOffset={x:e,y:t}}))}},{key:"pasteElements",value:function(){for(var e=this,t=[],i=0;i<this.elements.length;i++){var n,o=this.elements[i],a=Object(R.a)(null===(n=o.sdkData)||void 0===n?void 0:n.getOwnedData());if(a.nvPr.ph=void 0,A.a.convertPartialDataFromUiToSdk(o,a,o),o.type===M.d.GROUP){var l=o.props;if(null!=l&&l.childFrame){var s;null!==(s=a.spPr)&&void 0!==s&&s.xfrm||(a.spPr={xfrm:{}});var c=a.spPr.xfrm;L.a.convertPartialDataFromUiToSdk(l.childFrame,c)}}a&&t.push(a)}Object(p.w)((function(){var i,n,o,a,l;if(null===(i=e.selectionService)||void 0===i||null===(n=i.currentSlide)||void 0===n||null===(o=n.sdkData)||void 0===o||o.api.addShapes(t),t.length>0&&null!==(a=e.selectionService)&&void 0!==a&&a.currentSlide&&(null===(l=e.selectionService.currentSlide.children)||void 0===l?void 0:l.length)>0){var s=e.selectionService.currentSlide.children;if(s.length-t.length>0){var c,d,u=s.slice(s.length-t.length,s.length);e.selectionService.selectedElements.clear(),null===(c=e.selectedAnims)||void 0===c||c.clear(),(d=e.selectionService.selectedElements).add.apply(d,r()(u))}}}))}},{key:"getTempElements",value:function(){return this.elements.slice()}},{key:"_add",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(p.w)((function(){i.length>0&&(e.isCopyAndMoving=!0,i.forEach((function(t){t&&!e._find(t)&&e.elements.push(t)})))}))}},{key:"_find",value:function(e){for(var t=0;t<this.elements.length;t++)if(e.key===this.elements[t].key)return!0;return!1}}]),e}(),w=f()(k.prototype,"elements",[p.q,C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=f()(k.prototype,"lastOffset",[p.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),k)},"774f8715c8":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkU0MDQ3RjI5Qjg2NDExRTY5MjE1RTZFNEM2NkFCOTgwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkU0MDQ3RjJBQjg2NDExRTY5MjE1RTZFNEM2NkFCOTgwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTQwNDdGMjdCODY0MTFFNjkyMTVFNkU0QzY2QUI5ODAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTQwNDdGMjhCODY0MTFFNjkyMTVFNkU0QzY2QUI5ODAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4l+CZfAAADyklEQVR42uxZS0hVURR9r7R4Rh8NhKRBQUQGiQ0KIdEyq0E/RcqKmhT1+g16lebMhtrHshI0qVEUNXmGRE1KrUQpgj5QEUWBZhjYy4GKltnesE7sbve++5ceuGDBPvees89623P22ecaHBsbCyQSJgUSDEnKWL6i4L8W+qT9gW8Rzid+BlcmwpKoJmaAVYkgOMXAHnfBC4nNxCZipgdzZ8JXM3zb23QWcIm4BnYWcSmx36HYmcQ7xPloTyWu9TrCv4TNEzW4iG6DEKv17ZngCuKwaJcS9zsQG8ZYhWH49lzwc+IxzbMa4hIbPrjvOc2z4/DtS5aoI0ZFO0S8RZxmYSz3uYkxClHsDV/T2m7iJ9FepInaUwO7RpNd2Mcex0ezDXwnbie2Eafg2U7iPtiHiS+IQWKjGLdL2D/gI+ZFHp6OjbEV6UcPncRy0X4o7CHiBWItcVA8bxV2GXzoYQbmDkOLaYR5Xa2GPUK8j2e3iV9FPxb0jDgX78xQQtxM7CY+1rxLx7tizK3+cluIhbJjUNXDolobMDhSR4ntEH9dI94JWOQOYhExlzhZp8+g2tDxqrUzRL2qnh3mYYO9RmSdgse+ga98A7Gs4bSVNVyJs/0E1pme+NkQ76YETTMQ2Ym5WcNJq1niPfEUmIG1VYyJkrAcWlwIboEPXhY/kXGiYI/btNaDA6MOkc3CyRRzIbgH+Tub+JLY51ce7nMZWYmYE192TzqO8CpiqgeCU+ErzeuTTq3hItzR1BrmP+cXh2LnYFmpNdyK9dtktoaNIrwAp1EHsQsFSqH4gemIjlMUwIcKWiH2SDfmLIcGS4I5lbxDhsgx6PNNcxzbRRt8aBHEnNXQUGlFcBkG6p10j4gR4mJEwym64SMCn6MG4sutCO4QNtcSd1GIZOCwOE/sxXs+UrdpalwjhNA3F+1e+MqD7zDmGjHQYrjpSuCYy8h7cS6aR0QdzBfKDSaCuXjfKMbWine8iS+DXCGuQxa58U/YdYofK8jBGk4WJWWKiORe2I14pwqZkKiH8+KUmJ5+qlK/PFk8uybsi4hereb6I/skw8es8fjyc4U4T7TfYvP8+a4o7GXCjqCvAvu46rfggzhE5O2iFDW0GQZwkxgSz9jXIb8EZ+MiKXEUxYtVvMIYibPw7bngKnxSUuDrfb2DJVWPjBEQn6mq/BAs+34Ut2QnCMOHbR12yssDSPQB3Aj6XQjmsetxBAeRlz0X/EEkfi/Ad7pN45HWzDBoYHsCPwRXoE7uCtj4KunnpyoztKKY8QXBiX8sTgj+G78FGADiAdm7EWkMHQAAAABJRU5ErkJggg=="},"7b360969bf":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("b8e6877859"),r=Object(n.a)()},"7d75750ac6":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAQAAAD8fJRsAAAATklEQVR42mNgAAEHBhYGrCCNIYxBCLtEGkMygwZ2CRB0YmDFLpHGEI5qZBoSTGbQxC6RxKCCTSKEQQCbUfbo/oEYoYbNuaEMgtg8iCVIAGjyEyuyq18UAAAAAElFTkSuQmCC"},"84c7a07f3d":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return a}));var n=["#B30000","#E6118F","#F1633A","#3646A0","#3184E9","#09A9B9","#822F1D","#C67600","#FFB400","#0D6C54","#918B3D","#7BB725"],r="history",o=13025,a={DEFAULT:"default",HISTORY_VERSION:"history-version"}},"8c101803a8":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),s=i.n(l),c=(i("8ee19818c4"),i("826dc923b3"),i("ee6bb53310")),d=i.n(c),u=i("e0e8dd9366"),h=i("a42b29265b"),v=function(){function e(){r()(this,e)}return a()(e,null,[{key:"adjustElementPosition",value:function(t,i,n){var r,o,a=0,l=0,s=!1;(i&&function i(r){var o;(null===(o=r.children)||void 0===o?void 0:o.length)&&r.children.forEach((function(r){var o,c,d;switch(r.type===u.d.GROUP&&i(r),n){case h.a.OWN:d=null===(o=r.sdkData.getOwnedData().spPr)||void 0===o?void 0:o.xfrm;break;case h.a.INHERIT:d=null===(c=r.sdkData.props.spPr)||void 0===c?void 0:c.xfrm;break;default:var v;d=null===(v=r.sdkData.props.spPr)||void 0===v?void 0:v.xfrm}if(e.checkFrame(d,t,a,l))return s=!0,a+=1e5,l+=1e5,!1}))}(i),s)&&(void 0!==(null===(r=t.spPr)||void 0===r||null===(o=r.xfrm)||void 0===o?void 0:o.off)?(t.spPr.xfrm.off.x+=a,t.spPr.xfrm.off.y+=l):(d()(t,"spPr.xfrm.off.x",0),d()(t,"spPr.xfrm.off.y",0)))}},{key:"checkFrame",value:function(e,t,i,n){var r,o,a,l,s,c,d,u,h,v;return(null==e?void 0:e.off)&&(null===(r=t.spPr)||void 0===r||null===(o=r.xfrm)||void 0===o?void 0:o.off)&&(null===(a=e.off)||void 0===a?void 0:a.x)===Number(null===(l=t.spPr.xfrm.off)||void 0===l?void 0:l.x)+i&&(null===(s=e.off)||void 0===s?void 0:s.y)===Number(null===(c=t.spPr.xfrm.off)||void 0===c?void 0:c.y)+n&&(null===(d=e.ext)||void 0===d?void 0:d.cx)===(null===(u=t.spPr.xfrm.ext)||void 0===u?void 0:u.cx)&&(null===(h=e.ext)||void 0===h?void 0:h.cy)===(null===(v=t.spPr.xfrm.ext)||void 0===v?void 0:v.cy)}}]),e}();s()(v,"checkAndAdjustElementPosition",(function(e){for(var t=0;t<e.length;t++)for(var i=e[t],n=0;n<t;n++){var r,o,a,l,s,c,u,h,v,f,p,g,y=e[n];if(null!==(r=y.spPr.xfrm)&&void 0!==r&&r.off&&null!==(o=i.spPr.xfrm)&&void 0!==o&&o.off&&(null===(a=y.spPr.xfrm.off)||void 0===a?void 0:a.x)===(null===(l=i.spPr.xfrm.off)||void 0===l?void 0:l.x)&&(null===(s=y.spPr.xfrm.off)||void 0===s?void 0:s.y)===(null===(c=i.spPr.xfrm.off)||void 0===c?void 0:c.y)&&(null===(u=y.spPr.xfrm.ext)||void 0===u?void 0:u.cx)===(null===(h=i.spPr.xfrm.ext)||void 0===h?void 0:h.cx)&&(null===(v=y.spPr.xfrm.ext)||void 0===v?void 0:v.cy)===(null===(f=i.spPr.xfrm.ext)||void 0===f?void 0:f.cy))d()(i,"spPr.xfrm.off.x",(null===(p=i.spPr.xfrm.off)||void 0===p?void 0:p.x)+1e5),d()(i,"spPr.xfrm.off.y",(null===(g=i.spPr.xfrm.off)||void 0===g?void 0:g.y)+1e5)}}))},"934d140931":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n,r,o,a=i("1f925d7f50"),l=i.n(a),s=i("9132715560"),c=i.n(s),d=i("6a364eb35c"),u=i.n(d),h=i("85d0a7609b"),v=i.n(h),f=i("2dc700e1e6"),p=i.n(f),g=(i("f1054791f4"),i("d5c3deb8c7")),y=(n=function(){function e(){c()(this,e),l()(this,"currentScrollX",r,this),l()(this,"currentScrollY",o,this),v()(this,"currentTranslateX",0),v()(this,"currentTranslateY",0)}return u()(e,[{key:"updateCurrentScroll",value:function(e,t){var i=this;Object(g.w)((function(){i.currentScrollX=e,i.currentScrollY=t}))}},{key:"updateCurrentCanvasTranslate",value:function(e,t){this.currentTranslateX=e,this.currentTranslateY=t}}]),e}(),r=p()(n.prototype,"currentScrollX",[g.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=p()(n.prototype,"currentScrollY",[g.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),n)},"93d59fd87c":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAQAAAD8fJRsAAAAS0lEQVR42mNgIB04MKRhgQ4MDCwMoRjCYQwsID2CDEkowskMQjDj1FAkNJBtsocLO6E6gYUhBCwczsCK7joBhiRk05GBCoMmAwUAAKYXEytyba83AAAAAElFTkSuQmCC"},"94c6ecb0c7":function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n,r,o,a,l=i("1f925d7f50"),s=i.n(l),c=i("9132715560"),d=i.n(c),u=i("6a364eb35c"),h=i.n(u),v=i("85d0a7609b"),f=i.n(v),p=i("2dc700e1e6"),g=i.n(p),y=(i("f1054791f4"),i("b8217400dc"),i("e6f68cdf2e"),i("fce3077cdf"),i("c554310b5c"),i("1288bffff3")),m=i("d5c3deb8c7"),b=i("82f2dc9440"),S=i.n(b),M=i("e0e8dd9366"),E=i("5fac0349d3"),C=i("37091e4240"),k=(n=Reflect.metadata("design:type",Function),r=Reflect.metadata("design:paramtypes",[]),o=function(){function e(t,i,n,r){var o=this;d()(this,e),s()(this,"editType",a,this),f()(this,"changeEditType",(function(e){e!==o.editType&&Object.values(y.a).includes(e)&&Object(m.w)((function(){if(o.isMasterEditType){var t;if(o.selectionService.lastMasterEditPageIndex=o.selectionService.currentSlideIndex,o.selectionService.currentSlideType!==M.d.SLIDE&&(o.selectionService.lastMasterEditSlideType=o.selectionService.currentSlideType),null===(t=o.selectionService)||void 0===t||t.updateCurrentSlideType(M.d.SLIDE),o.updateEditType(y.a.SLIDE),o.selectionService){var i,n=(null===(i=o.uiDataService)||void 0===i?void 0:i.slideModelList.length)?o.selectionService.lastSlideEditPageIndex:-1;o.selectionService.currentSlideIndex=n}}else{var r,a,l,s,c;if(null===(r=o.slideRenderStateManager)||void 0===r||!r.isAllSlideConvertComplete)return void S.a.show({message:E.a.t("母版正在加载中")});o.selectionService.lastSlideEditPageIndex=o.selectionService.currentSlideIndex,null===(a=o.selectionService)||void 0===a||a.selectedElements.clear(),null===(l=o.selectionService)||void 0===l||l.selectedSlides.clear(),null===(s=o.noteAreaManager)||void 0===s||s.setHide(),null===(c=o.selectionService)||void 0===c||c.updateCurrentSlideType(o.selectionService.lastMasterEditSlideType),o.updateEditType(y.a.MASTER_LAYOUT),o.selectionService&&(o.selectionService.currentSlideIndex=o.selectionService.lastMasterEditPageIndex)}C.b.emit(C.a.EDIT_TYPE_CHANGE,e)}))})),f()(this,"watchEditTypeChange",(function(e){C.b.on(C.a.EDIT_TYPE_CHANGE,e)})),this.uiDataService=t,this.selectionService=i,this.slideRenderStateManager=n,this.noteAreaManager=r}return h()(e,[{key:"isMasterEditType",get:function(){return this.editType===y.a.MASTER_LAYOUT}},{key:"updateEditType",value:function(e){this.editType=null!=e?e:y.a.SLIDE}}]),e}(),a=g()(o.prototype,"editType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return y.a.SLIDE}}),g()(o.prototype,"isMasterEditType",[m.f,n,r],Object.getOwnPropertyDescriptor(o.prototype,"isMasterEditType"),o.prototype),o)},"9c9147ef33":function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var n,r,o,a,l,s=i("14502724a6"),c=i.n(s),d=i("1f925d7f50"),u=i.n(d),h=i("9132715560"),v=i.n(h),f=i("85d0a7609b"),p=i.n(f),g=i("2dc700e1e6"),y=i.n(g),m=(i("f1054791f4"),i("d5c3deb8c7")),b=i("e0e8dd9366"),S=(n=function e(t){var i=this;v()(this,e),u()(this,"insertTopRowNumber",r,this),u()(this,"insertBottomRowNumber",o,this),u()(this,"insertLeftColNumber",a,this),u()(this,"insertRightColNumber",l,this),p()(this,"selectionService",void 0),p()(this,"menuManager",void 0);var n=t.selectionService,s=t.menuManager;this.selectionService=n,this.menuManager=s,Object(m.r)((function(){var e;return[i.selectionService.getSelectedModel(),i.menuManager.isMenuShown,null===(e=i.selectionService.getSelectedModel())||void 0===e?void 0:e.selectedRange]}),(function(e){var t=c()(e,1)[0];if((null==t?void 0:t.type)===b.d.TABLE&&!i.menuManager.isMenuShown){var n=t.selectedRange?t.selectedRange.rowEnd-t.selectedRange.rowStart+1:0;i.insertTopRowNumber=n,i.insertBottomRowNumber=n;var r=t.selectedRange?t.selectedRange.colEnd-t.selectedRange.colStart+1:0;i.insertLeftColNumber=r,i.insertRightColNumber=r}}))},r=y()(n.prototype,"insertTopRowNumber",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),o=y()(n.prototype,"insertBottomRowNumber",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),a=y()(n.prototype,"insertLeftColNumber",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),l=y()(n.prototype,"insertRightColNumber",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),n)},a6311675d9:function(e,t,i){(t=e.exports=i("9dddfe0040")(!1)).push([e.i,".history-list-history-list-1VOUO{width:100%;height:calc(100% - 92px);overflow-y:scroll;overflow-x:hidden}.history-list-history-list-tab-show-22v22{height:calc(100% - 122px)}",""]),t.locals={"history-list":"history-list-history-list-1VOUO","history-list-tab-show":"history-list-history-list-tab-show-22v22"}},a68c65b7e2:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("4f3b15d017");function r(){if(n.default.isIE)return function(){var e=window.screen;if(e.deviceXDPI&&e.logicalXDPI)return e.deviceXDPI/e.logicalXDPI*100;return 100}();if(n.default.isFirefox)return 100;if(n.default.isChrome||n.default.isChromiumEdge)return function(){var e=window.outerWidth/window.innerWidth;n.default.isWindows&&Math.round(100*e)>95&&Math.round(100*e)<105&&(e=1);return Math.round(100*e)}();if(n.default.isSafari)return Math.round(window.outerWidth/window.innerWidth*100);var e=1;if(void 0!==window.devicePixelRatio&&(e=window.devicePixelRatio),void 0!==window.outerWidth&&void 0!==window.innerWidth){var t=window.outerWidth/window.innerWidth;100===Math.round(100*t)&&(e=1)}return Math.round(100*e)}},b0c5271b53:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("176815363d"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("3ef2352f0b"),d=i.n(c),u=(i("c6244f7705"),i("081c8cafea"),i("8e7cce0ada"),i("85d48ef22b"),i("2a6f332b5e"),i("a8a4b19997")),h=function(){function e(t){a()(this,e),this.slideRenderStateManager=t,this.init()}var t;return s()(e,[{key:"init",value:function(){var e=this;this.slideRenderStateManager.getVisiblePageDisplayPromise().then((function(){e.openDocInElectron()}))}},{key:"openDocInElectron",value:(t=r()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.e(23).then(i.bind(null,"250d00b27e")).then((function(e){(new(0,e.default)).openDocInElectron({docUrl:location.href,uid:Object(u.getUid)()||""})}));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}()},b443987fe7:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n,r,o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("85d0a7609b"),d=i.n(c),u=i("5ce71228c0");!function(e){e.attachment="attachmentPreferenceKey",e.embedFont="embedFontPreferenceKey"}(r||(r={}));var h=(n={},d()(n,r.attachment,u.a.ATTACHMENT),d()(n,r.embedFont,u.a.EMBEDFONT),n),v=function(){function e(){a()(this,e)}return s()(e,[{key:"exportAttachmentPreference",get:function(){return this.getPreferenceByKey(r.attachment)},set:function(e){this.setPreferenceByKey(r.attachment,e)}},{key:"exportFontPreference",get:function(){return this.getPreferenceByKey(r.embedFont)},set:function(e){this.setPreferenceByKey(r.embedFont,e)}},{key:"getPreferenceByKey",value:function(e){var t=u.b.getItem(h[e]);return null!==t?t:(this.setPreferenceByKey(e,!0),!0)}},{key:"setPreferenceByKey",value:function(e,t){u.b.setItem(h[e],t)}}]),e}()},b4cc9f91ed:function(e,t,i){t=e.exports=i("9dddfe0040")(!1);var n=i("c92b994f13")(i("774f8715c8"));t.push([e.i,".index-history-mask-2wxdo{background:hsla(0,0%,100%,.1);z-index:110;position:absolute;width:100%;height:100%;top:0;left:0}.index-history-mask-loading-1ndYa{background:url("+n+") no-repeat 50%;background-size:22px 22px;width:22px;height:22px;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-animation:index-loadingAnimation-1kFnh 2s linear infinite;animation:index-loadingAnimation-1kFnh 2s linear infinite}@-webkit-keyframes index-loadingAnimation-1kFnh{0%{-webkit-transform:translate(-50%,-50%) rotate(0deg);transform:translate(-50%,-50%) rotate(0deg)}50%{-webkit-transform:translate(-50%,-50%) rotate(180deg);transform:translate(-50%,-50%) rotate(180deg)}to{-webkit-transform:translate(-50%,-50%) rotate(1turn);transform:translate(-50%,-50%) rotate(1turn)}}@keyframes index-loadingAnimation-1kFnh{0%{-webkit-transform:translate(-50%,-50%) rotate(0deg);transform:translate(-50%,-50%) rotate(0deg)}50%{-webkit-transform:translate(-50%,-50%) rotate(180deg);transform:translate(-50%,-50%) rotate(180deg)}to{-webkit-transform:translate(-50%,-50%) rotate(1turn);transform:translate(-50%,-50%) rotate(1turn)}}.index-history-toolbar-mask-3qGgK{position:absolute;background-color:#f8f8f8;opacity:.7;top:0;bottom:0;left:0;right:0}",""]),t.locals={"history-mask":"index-history-mask-2wxdo","history-mask-loading":"index-history-mask-loading-1ndYa",loadingAnimation:"index-loadingAnimation-1kFnh","history-toolbar-mask":"index-history-toolbar-mask-3qGgK"}},b53db0c2a2:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABDUlEQVR4AWOgDxgFo4C1+785c+efAJoYztL924mx489n5q4/SVQ3nLn7jy/Q8O+MHb//U90C5o4/UUDDf4MMh+A/+5k6f3cwdfwtY+39b0iR4UydfzOABv4FGYwTd/4+y9r534Jkw0EuRDYIvyV/fgHVp5NmQdffKpBmEiz5B4wrf1ItyQZpJMGST9xd/yVIi+TOP7FAjX9ghjB1/JkPjJsspo7fjUDxtcA4eodsCVPnn1kkxwcocwEN+4EtmYau+s8MFAsFRvYVWHzwdP8XIz2jdf52BWr+gisfqEz6zw703RSIL/4WkJebO/5bASMyEH/q+zMN6JBtDNQHiCADxstOGJ9W5ZYLw6ADowAA8afxdi4Z7lIAAAAASUVORK5CYII="},b6372f0df3:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),s=i.n(l),c=(i("826dc923b3"),i("8ee19818c4"),i("79fc58c7b0")),d=i("e0e8dd9366"),u=function(){function e(t){r()(this,e),s()(this,"absorbPointX",[]),s()(this,"absorbPointY",[]),s()(this,"absorbStep",void 0),s()(this,"isAbsorbEndPoint",!1);var i=t.isAbsorbEndPoint;this.isAbsorbEndPoint=i}return a()(e,[{key:"updateAbsorbPoint",value:function(e,t){this.absorbPointX=e,this.absorbPointY=t}},{key:"updateAbsorbStep",value:function(e){this.absorbStep=e}},{key:"handleAbsorbElement",value:function(e){var t,i=e.offsetFrame,n=e.originalSize,r=e.mode,o=e.model,a=e.multiRect,l=e.sizeMap,s=null!=a&&a.length?a:n,d=null!=l&&l.size?null===(t=l.get(o.key))||void 0===t?void 0:t.offsetFrame:i;if(r===c.b.MOVE)this.handleAbsorbDraggingElement({originalSize:s,offsetFrame:i});else this.handleAbsorbResizingElement({originalSize:n,offsetFrame:d,model:o})}},{key:"handleAbsorbDraggingElement",value:function(e){this.handleAbsorbDraggingXPosition(e),this.handleAbsorbDraggingYPosition(e)}},{key:"handleAbsorbDraggingXPosition",value:function(e){var t=e.originalSize,i=e.offsetFrame,n=t.left,r=t.width,o=i.left,a=this.computeAbsorbStartPoint({originStart:n,offsetStart:o,originalLength:r,absorbPoint:this.absorbPointX});i.left=a}},{key:"handleAbsorbDraggingYPosition",value:function(e){var t=e.originalSize,i=e.offsetFrame,n=t.top,r=t.height,o=i.top,a=this.computeAbsorbStartPoint({originStart:n,offsetStart:o,originalLength:r,absorbPoint:this.absorbPointY});i.top=a}},{key:"computeAbsorbStartPoint",value:function(e){var t=this,i=e.originStart,n=e.offsetStart,r=e.originalLength,o=e.absorbPoint,a=n,l=Number.MAX_VALUE;return o.forEach((function(e){var o=Math.abs(i+n-e);if(o<t.absorbStep&&o<=l&&(a=e-i,l=o),t.isAbsorbEndPoint){var s=Math.abs(i+n+r-e);s<t.absorbStep&&s<=l&&(a=e-(i+r),l=s)}})),a}},{key:"handleAbsorbResizingElement",value:function(e){this.handleAbsorbResizingXPosition(e),this.handleAbsorbResizingYPosition(e)}},{key:"handleAbsorbResizingXPosition",value:function(e){var t,i,n,r=e.offsetFrame,o=e.originalSize,a=e.model,l=0;a&&(null===(t=a.parent)||void 0===t?void 0:t.type)===d.d.GROUP&&(l=a.parent.props.style.left||0);var s=null==a||null===(i=a.props)||void 0===i||null===(n=i.style)||void 0===n?void 0:n.flipH,c=!!r.flipH!=!!s,u=o.left+l,h=r.left,v=r.width,f=o.width,p=this.computeAbsorbResizingPosition({isRevert:c,originStart:u,originalLength:f,offsetStart:h,offsetLength:v,absorbPoint:this.absorbPointX}),g=p.newOffsetStart,y=p.newOffsetLength;r.left=g,r.width=y}},{key:"handleAbsorbResizingYPosition",value:function(e){var t,i,n,r=e.offsetFrame,o=e.originalSize,a=e.model,l=0;a&&(null===(t=a.parent)||void 0===t?void 0:t.type)===d.d.GROUP&&(l=a.parent.props.style.top||0);var s=null==a||null===(i=a.props)||void 0===i||null===(n=i.style)||void 0===n?void 0:n.flipV,c=!!r.flipV!=!!s,u=o.top+l,h=r.top,v=r.height,f=o.height,p=this.computeAbsorbResizingPosition({isRevert:c,originStart:u,originalLength:f,offsetStart:h,offsetLength:v,absorbPoint:this.absorbPointY}),g=p.newOffsetStart,y=p.newOffsetLength;r.top=g,r.height=y}},{key:"computeAbsorbResizingPosition",value:function(e){var t=this,i=e.originStart,n=e.originalLength,r=e.isRevert,o=e.absorbPoint,a=e.offsetStart,l=e.offsetLength,s=Number.MAX_VALUE;return o.forEach((function(e){if(r){var o=Math.abs(i+n+a+l-e);if(a>0)o<t.absorbStep/2&&o<=s&&(l=e-i-n-n,s=o);else{var c=Math.abs(i+a-e);if(c<t.absorbStep/2&&c<=s){var d=e-(i+a);a=e-i,l-=d,s=c}}}else{var u=Math.abs(i+n+l-e);if(0===Math.floor(Math.abs(a)))u<t.absorbStep/2&&u<s&&(l=e-i-n,s=u);else{var h=Math.abs(i+a-e);h<t.absorbStep/2&&h<s&&(l=-(a=e-i),s=h)}}})),{newOffsetStart:a,newOffsetLength:l}}}]),e}(),h=function(){function e(){r()(this,e),s()(this,"gridAbsorbLogic",void 0),s()(this,"guidesAbsorbLogic",void 0),s()(this,"isGridAbsorb",!1),this.gridAbsorbLogic=new u({isAbsorbEndPoint:!1})}return a()(e,[{key:"setIsGridAbsorb",value:function(e){this.isGridAbsorb=e}},{key:"handleGridAbsorbElement",value:function(e){var t,i,n,r,o,a=e.model;null!=a&&null!==(t=a.props)&&void 0!==t&&null!==(i=t.style)&&void 0!==i&&i.rotate||!this.isGridAbsorb||1===(null==a||null===(n=a.props)||void 0===n||null===(r=n.locks)||void 0===r?void 0:r.noChangeAspect)||null===(o=this.gridAbsorbLogic)||void 0===o||o.handleAbsorbElement(e)}}]),e}()},ba9caa3326:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));i("73b854064b");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("547611bd96"),s=i.n(l),c=i("bd29e2df90"),d=i.n(c),u=i("ab5eb40518"),h=i.n(u),v=i("1b4cdd6a36"),f=i.n(v),p=i("85d0a7609b"),g=i.n(p),y=(i("3bf1976a4f"),i("8ec5e2d62d")),m=i("4e7af1026b"),b=i("e0a67dc3fe"),S=i("7e61746219"),M=i("05d181ac40");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var C=function(e){d()(i,e);var t=E(i);function i(){var e,n,o,a,l;r()(this,i);for(var c=arguments.length,d=new Array(c),u=0;u<c;u++)d[u]=arguments[u];return l=t.call.apply(t,[this].concat(d)),g()(s()(l),"showToolbar",null===(e=b.a.getConfig("toolbar"))||void 0===e||e),g()(s()(l),"showTitleBar",null===(n=b.a.getConfig("titlebar"))||void 0===n||n),g()(s()(l),"showStatusBar",null===(o=b.a.getConfig(m.h.statusBar))||void 0===o||o),g()(s()(l),"showNote",null===(a=b.a.getConfig(m.b.showNote))||void 0===a||a),l}return a()(i,[{key:"isHeaderFold",value:function(){return!!Object(S.f)()||(!this.showToolbar&&!this.showTitleBar||void 0)}},{key:"isStatusBarFold",value:function(){return!this.showStatusBar}},{key:"isNoteFold",value:function(){return!this.showNote}},{key:"shouldShowTemplateRecommendation",value:function(){return!M.a.IS_LOCAL_EDIT}}]),i}(y.a)},bc2716d4b3:function(e,t,i){"use strict";i.d(t,"a",(function(){return Q}));i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36");var n,r=i("14502724a6"),o=i.n(r),a=i("730477bb20"),l=i.n(a),s=i("1f925d7f50"),c=i.n(s),d=i("9132715560"),u=i.n(d),h=i("6a364eb35c"),v=i.n(h),f=i("85d0a7609b"),p=i.n(f),g=i("2dc700e1e6"),y=i.n(g),m=(i("f1054791f4"),i("826dc923b3"),i("8e7cce0ada"),i("c6244f7705"),i("081c8cafea"),i("85d48ef22b"),i("2a6f332b5e"),i("eb9e932508"),i("8ee19818c4"),i("7eaa8e90a5"),i("6e20b6a7d8"),i("af802ec74b"),i("69084d01d3")),b=i.n(m);!function(e){e.left="left",e.right="right",e.center="center",e.dec="decimal",e.bar="bar"}(n||(n={}));var S,M,E,C,k,w,I,x,O,A,L,R,D=i("d5c3deb8c7"),T=i("5cf98436e9"),P=i("382929c8da"),B=i("54a7b7d7a1"),G=i("d1428876ce"),j=i("3344f1a2e7"),N=i("d3d31c86eb"),F=i("9da6335152"),z=i("51b2ea9953"),H=i("7b0ebf3e1a"),U=i("c9c92622ff"),W=i("020899bf26"),_=i("b479a84af5"),Y=i("b55230b666"),V=i("5ce71228c0");function K(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function X(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?K(Object(i),!0).forEach((function(t){p()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(e){e.show="0",e.hide="1"}(R||(R={}));var Q=(S=Reflect.metadata("design:type",void 0===n?Object:n),M=Reflect.metadata("design:type",Boolean),E=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),C=Reflect.metadata("design:type",Number),k=function(){function e(t){var n=this;u()(this,e),c()(this,"defaultAlignment",w,this),c()(this,"displayRuler",I,this),c()(this,"indentLeft",x,this),c()(this,"marginLeft",O,this),c()(this,"tabList",A,this),c()(this,"tabSize",L,this),p()(this,"editAreaLeft",0),p()(this,"editAreaTop",0),p()(this,"editAreaWidth",0),p()(this,"editAreaHeight",0),p()(this,"isRevert",!1),p()(this,"isControlInHori",!0),p()(this,"defaultTabs",[]),p()(this,"rulerLeft",0),p()(this,"rulerTop",0),p()(this,"rulerWidth",0),p()(this,"rulerHeight",0),p()(this,"paragraphManager",void 0),p()(this,"menuManager",void 0),p()(this,"selectionService",void 0),p()(this,"editorInstanceService",void 0),p()(this,"currentModel",void 0),p()(this,"initReaction",void 0),p()(this,"LazyImportFileComponent",Object(m.lazy)((function(){return Object(W.d)((function(){return Promise.all([i.e("commonAsync~9b1fde68"),i.e("commonAsync~27f19aac"),i.e("commonAsync~205ac551"),i.e("commonAsync~0c3a6025"),i.e("commonAsync~32e631b8"),i.e("commonAsync~08369118"),i.e("commonAsync~50db4bb8"),i.e("commonAsync~86c92fed"),i.e("commonAsync~a95f944a"),i.e("commonAsync~6e568190"),i.e("commonAsync~b174e5ca"),i.e("commonAsync~54a68610"),i.e("commonAsync~61b3c105"),i.e("commonAsync~f7b3ac00"),i.e("commonAsync~cece21d6"),i.e("commonAsync~ecbf7682"),i.e("commonAsync~6c5dfa7c"),i.e("commonAsync~90483627"),i.e("commonAsync~d2c096c2"),i.e("commonAsync~1285a477"),i.e("commonAsync~31ded9a0"),i.e("commonAsync~ecdbff9b"),i.e("commonAsync~c2cc425c"),i.e("commonAsync~4fb44df2"),i.e("commonAsync~d06fe423"),i.e("commonAsync~0519277e"),i.e("commonAsync~6df2b9ea"),i.e("commonAsync~b5c4f9e4"),i.e("commonAsync~ffdf5190"),i.e("commonAsync~127b6cf7"),i.e("commonAsync~b3c4a2ff"),i.e("commonAsync~19bb5a55"),i.e("async~493df0b3"),i.e("async~c5b24172"),i.e("async~0d51b00e"),i.e("async~beecf843"),i.e("async~2e2c6527"),i.e("async~da8db81f"),i.e("async~e10030d6"),i.e("async~098dcb65"),i.e("async~d0c14fe8"),i.e("async~7f8bedbf"),i.e("async~f40490b4"),i.e("async~2158e36e"),i.e("async~76acd586"),i.e("async~37d786cf"),i.e("async~30ccc425"),i.e("async~0c7d7381"),i.e("async~907e9098"),i.e("async~43172549"),i.e("async~f19eb79b"),i.e("async~95108331"),i.e("async~718865d2"),i.e("async~89b7a519"),i.e("vendors~lazyComponents")]).then(i.bind(null,"4a5508af74"))}))}))),p()(this,"componentDidMount",(function(e){n.initReaction=Object(D.r)((function(){return[null==n?void 0:n.selectionService.getSelectedModel(),null==n?void 0:n.defaultAlignment,null==n?void 0:n.displayRuler,null==n?void 0:n.indentLeft,null==n?void 0:n.marginLeft,null==n?void 0:n.tabList,null==n?void 0:n.tabSize]}),(function(){var t=(e||{}).callback;null==t||t()}))})),p()(this,"componentWillUnmount",(function(){var e;null===(e=n.initReaction)||void 0===e||e.call(n)})),p()(this,"getLazyComponent",(function(e){var t=n.LazyImportFileComponent;return b.a.createElement(_.a,null,b.a.createElement(t,l()({ref:e.setRef},e)))})),p()(this,"updateDisplayRuler",(function(){n.displayRuler=!n.displayRuler,n.displayRuler?(V.b.setItem(V.a.DISPLAY_TEXT_RULER,R.show),Object(N.c)({opername:F.e.DOC_PPT,module:F.d.TEXT_RULER,action:F.b.EXPOSURE_TEXT_RULER})):V.b.setItem(V.a.DISPLAY_TEXT_RULER,R.hide),window.dispatchEvent(new Event("resize")),Object(N.c)({opername:F.e.DOC_PPT,module:F.d.TEXT_RULER,action:F.b.OPEN_TEXT_RULER})})),p()(this,"updateDefaultAlignment",(function(e){n.defaultAlignment=e})),p()(this,"updateTabList",(function(e){var t;if(n.currentModel){e.sort((function(e,t){return e.position-t.position}));var i={tabList:e};null===(t=n.paragraphManager)||void 0===t||t.updateUIWithModel(i,n.currentModel),n.setSelectedStyle()}})),p()(this,"computeEditingRulerSize",(function(e,t){var i=(null==e?void 0:e.textBodyStyle)||{},r=i.wrapperStyle,o=void 0===r?{}:r,a=i.bodyStyle,l=void 0===a?{}:a,s=o.textDirection,c=void 0===s?z.d.HORIZONTAL:s,d=l.whiteSpace,u=void 0===d?z.g.WRAP:d;n.getTextRulerSize();var h=n.getElementFrame(e),v=h.shapeWidth,f=h.shapeHeight,p=h.rotate,g=h.flipV,y=h.shapeLeft,m=h.shapeTop,b=Object(H.j)({left:y,top:m,width:v,height:f},p);n.setRevertAndControlAreaWithRotate(p),n.setRevertAndControlAreaWithTextDirection(c),n.setRevertAndControlAreaWithFlip(g),n.setEditingSizeWithYTextWorldBounds(e,t);var S=b.width,M=b.height,E=b.left,C=b.top;if(Object(U.D)(e)){n.fixTableTextDirectionSize(e);var k=n.computeTableTextOffset(e,b.left,b.top);S=k.shapeWidth,M=k.shapeHeight,E=k.shapeLeft,C=k.shapeTop}n.setEditingSizeWithWrapType(u,S,E,M,C),n.fixEditingRulerSize(),n.setDefaultTabs()})),p()(this,"updateIndentLeft",(function(e){var t;if(n.currentModel){var i={textIndent:e/j.b};null===(t=n.paragraphManager)||void 0===t||t.updateUIWithModel(i,n.currentModel),n.setSelectedStyle()}})),p()(this,"updateMarginLeft",(function(e){var t;if(n.currentModel){var i={marginLeft:e/j.b};null===(t=n.paragraphManager)||void 0===t||t.updateUIWithModel(i,n.currentModel),n.setSelectedStyle()}})),p()(this,"updateMarginLeftAndIndentLeft",(function(e){var t;if(n.currentModel){var i=e.changeIndent,r=e.changeMargin,o={textIndent:i/j.b,marginLeft:r/j.b};null===(t=n.paragraphManager)||void 0===t||t.updateUIWithModel(o,n.currentModel),n.setSelectedStyle()}})),p()(this,"getTextRect",(function(){var e,t=null===(e=n.editorInstanceService.getEditorInstance())||void 0===e?void 0:e.getTextAreaRectSync();return t||{width:0,height:0}})),p()(this,"initAndFormatRulerSizeWithRealScale",(function(e){var t=e.slideLeft,i=e.slideWidth,r=e.slideTop,o=e.scale,a=e.slideHeight;n.rulerLeft=t/2/o,n.rulerWidth=i/2,n.rulerTop=r/2/o,n.rulerHeight=a/2})),p()(this,"computeDefaultTabs",(function(e){var t,i=[];if(!n.currentModel)return i;var r=0;null===(t=n.tabList)||void 0===t||t.forEach((function(e){e.position>r&&(r=e.position)}));for(var o=n.tabSize;o<e;o+=n.tabSize)o>n.marginLeft&&o>r&&i.push(o);return i})),p()(this,"setSelectedStyle",(function(e){var t,i;if(n.editorInstanceService.checkEditorIsEditing()){var r=e||n.selectionService.selectedElements.getCurrentModel(),o=Object(T.a)(r);if(o){n.marginLeft=parseFloat(null!==(t=o[P.a.MARGIN_LEFT])&&void 0!==t?t:0)/B.g,n.indentLeft=parseFloat(null!==(i=o[P.a.TEXT_INDENT])&&void 0!==i?i:0)/B.g;try{n.tabList=o[P.a.TAB_LIST].map((function(e){return X(X({},e),{},{position:e.position/B.g})}))}catch(e){n.tabList=[]}n.tabSize=parseFloat(o[P.a.TAB_SIZE])/B.g}}})),p()(this,"getElementFrame",(function(e){var t,i,r,o,a,l=Object.assign({},(null==e||null===(t=e.props)||void 0===t?void 0:t.style)||{}),s=(null==e||null===(i=(r=e).getFrame)||void 0===i||null===(o=(a=i.call(r)).frameOnSlide)||void 0===o?void 0:o.call(a,l,!1))||{},c=s.left,d=s.width,u=s.top,h=s.height,v=s.flipV,f=void 0===v?0:v,p=s.rotate,g=void 0===p?0:p,y=n.getElementInnerPadding(e),m=y.paddingLeft,b=void 0===m?B.b:m,S=y.paddingRight,M=void 0===S?B.b:S,E=y.paddingTop,C=void 0===E?B.c:E,k=y.paddingBottom;return{shapeLeft:c=c/2+b,shapeWidth:d=d/2-(b+M),shapeTop:u=u/2+C,shapeHeight:h=h/2-(C+(void 0===k?B.c:k)),flipV:f,rotate:g}})),p()(this,"computeTableTextOffset",(function(e,t,i){var r=e,o=e.selectedCellRanges[0]||{},a=o.colStart,l=void 0===a?0:a,s=o.rowStart,c=void 0===s?0:s,d=o.colEnd,u=void 0===d?0:d,h=o.rowEnd,v=void 0===h?0:h,f=n.getElementInnerPadding(e),p=f.paddingLeft,g=void 0===p?B.b:p,y=f.paddingRight,m=void 0===y?B.b:y,b=f.paddingTop,S=void 0===b?B.c:b,M=f.paddingBottom,E=void 0===M?B.c:M,C=e.cellWidth(l,u-l+1)/2-(g+m),k=e.cellHeight(c,v-c+1)/2-(S+E);return{shapeLeft:r.cellWidth(0,l)/2+t,shapeTop:r.cellHeight(0,c)/2+i,shapeWidth:C,shapeHeight:k}})),p()(this,"fixTableTextDirectionSize",(function(e){var t,i=((null===(t=e.getEditingCellModel().textBodyStyle)||void 0===t?void 0:t.wrapperStyle)||{}).textDirection||z.d.HORIZONTAL;i!==z.d.HORIZONTAL&&(n.isControlInHori=!1),i===z.d.ROTATE_270&&(n.isRevert=!0)})),p()(this,"getElementInnerPadding",(function(e){var t,i=(null==e||null===(t=e.textBodyStyle)||void 0===t?void 0:t.bodyStyle)||{},n=i.paddingLeft,r=void 0===n?B.b:n,o=i.paddingRight,a=void 0===o?B.b:o,l=i.paddingTop,s=void 0===l?B.c:l,c=i.paddingBottom;return{paddingLeft:r,paddingRight:a,paddingTop:s,paddingBottom:void 0===c?B.c:c}}));var r=t.paragraphManager,a=t.selectionService,s=t.editorInstanceService,d=t.menuManager;this.paragraphManager=r,this.selectionService=a,this.editorInstanceService=s,this.menuManager=d,V.b.getItem(V.a.DISPLAY_TEXT_RULER)===R.show?this.displayRuler=!0:this.displayRuler=!1,Object(D.r)((function(){return[n.selectionService.getSelectedModel(),n.selectionService.getSelectedModel().selectionStyles]}),(function(e){var t=o()(e,1)[0];n.currentModel=t,n.setSelectedStyle()})),window.addEventListener("enterEditing",(function(){n.setSelectedStyle()})),window.addEventListener("exitEditing",(function(){n.setSelectedStyle()})),window.addEventListener(G.a,(function(){n.setSelectedStyle()})),this.menuManager.event.on(Y.a.REFRESH_MENU_VALUES_VALUES,(function(e){n.setSelectedStyle(e)})),this.displayRuler&&Object(N.c)({opername:F.e.DOC_PPT,module:F.d.TEXT_RULER,action:F.b.EXPOSURE_TEXT_RULER})}return v()(e,[{key:"resetRulerSize",value:function(){this.isControlInHori=!0,this.isRevert=!1,this.editAreaWidth=0,this.editAreaHeight=0,this.editAreaLeft=0,this.editAreaTop=0}},{key:"fixEditingRulerSize",value:function(){this.editAreaLeft+this.editAreaWidth>this.rulerWidth&&(this.rulerWidth+=this.editAreaLeft+this.editAreaWidth-this.rulerWidth),this.editAreaTop+this.editAreaHeight>this.rulerHeight&&(this.rulerHeight+=this.editAreaTop+this.editAreaHeight-this.rulerHeight),this.editAreaLeft<0&&(this.rulerWidth-=this.editAreaLeft,this.rulerLeft+=this.editAreaLeft,this.editAreaLeft=0),this.editAreaTop<0&&(this.rulerHeight-=this.editAreaTop,this.rulerTop+=this.editAreaTop,this.editAreaTop=0)}},{key:"setDefaultTabs",value:function(){var e=this.isControlInHori?this.editAreaWidth:this.editAreaHeight;this.defaultTabs=this.computeDefaultTabs(e)||[]}},{key:"getTextRulerSize",value:function(){this.tabList=(null==this?void 0:this.tabList)||[],this.indentLeft=(null==this?void 0:this.indentLeft)||0,this.marginLeft=(null==this?void 0:this.marginLeft)||0}},{key:"setEditingSizeWithWrapType",value:function(e,t,i,n,r){e===z.g.WRAP&&(this.isControlInHori?(this.editAreaWidth=t,this.editAreaLeft=i):(this.editAreaHeight=n,this.editAreaTop=r))}},{key:"setRevertAndControlAreaWithRotate",value:function(e){e>113&&e<293&&(this.isRevert=!this.isRevert),(e>67&&e<113||e>247&&e<293)&&(this.isControlInHori=!1)}},{key:"setRevertAndControlAreaWithTextDirection",value:function(e){e!==z.d.HORIZONTAL&&(this.isControlInHori=!this.isControlInHori,this.isControlInHori&&(this.isRevert=!this.isRevert),e===z.d.ROTATE_270&&(this.isRevert=!this.isRevert))}},{key:"setRevertAndControlAreaWithFlip",value:function(e){1===e&&(this.isRevert=!this.isRevert)}},{key:"setEditingSizeWithYTextWorldBounds",value:function(e,t){var i,n,r=null===(i=e.editorInstance)||void 0===i||null===(n=i.getRenderSize)||void 0===n?void 0:n.call(i);if(r){var o=r.minX,a=r.minY,l=r.width,s=r.height,c=2*t;this.editAreaLeft=o/c-this.rulerLeft,this.editAreaTop=a/c-this.rulerTop,this.editAreaWidth=l/c,this.editAreaHeight=s/c}}}]),e}(),w=y()(k.prototype,"defaultAlignment",[D.q,S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return n.left}}),I=y()(k.prototype,"displayRuler",[D.q,M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=y()(k.prototype,"indentLeft",[D.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),O=y()(k.prototype,"marginLeft",[D.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),A=y()(k.prototype,"tabList",[D.q,E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=y()(k.prototype,"tabSize",[D.q,C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k)},bec83f6c5d:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("176815363d"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("3ef2352f0b"),d=i.n(c),u=(i("c6244f7705"),i("081c8cafea"),function(){function e(){a()(this,e)}var t;return s()(e,[{key:"getUploadToolImpl",value:(t=r()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}())},c64626a5ce:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36");var n=i("176815363d"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("547611bd96"),d=i.n(c),u=i("bd29e2df90"),h=i.n(u),v=i("ab5eb40518"),f=i.n(v),p=i("1b4cdd6a36"),g=i.n(p),y=i("85d0a7609b"),m=i.n(y),b=i("3ef2352f0b"),S=i.n(b),M=(i("3bf1976a4f"),i("c6244f7705"),i("081c8cafea"),i("b40469cb12")),E=i("d6a9dd7ae4"),C=i("d3d31c86eb"),k=i("915616c11c"),w=i("82f2dc9440"),I=i.n(w);function x(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function O(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?x(Object(i),!0).forEach((function(t){m()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return f()(this,i)}}var L=function(e){h()(i,e);var t=A(i);function i(){var e;a()(this,i);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return e=t.call.apply(t,[this].concat(o)),m()(d()(e),"handleToPdf",(function(){var t;null===(t=e.services.menuManager)||void 0===t||t.exportPDF()})),m()(d()(e),"handleCollect",r()(S.a.mark((function e(){var t,i,n,r,o,a,l,s,c,d;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.clientVars,l=a.padId,s=a.domainId,e.next=3,null===(t=M.a.extensionService.dependentServiceCombinder)||void 0===t?void 0:t.fileDomain.getDocCollect({domainId:s,padId:l});case 3:if(null==(c=e.sent)||null===(i=c.resData)||void 0===i||null===(n=i.data)||void 0===n||!n.isCollected){e.next=6;break}return e.abrupt("return");case 6:if(d=document.querySelector("#workbench-titlebar #badge-container .editor-badge-icon-star")){e.next=9;break}return e.abrupt("return");case 9:null==d||null===(r=(o=d).click)||void 0===r||r.call(o);case 10:case"end":return e.stop()}}),e)})))),e}return s()(i,[{key:"showSnackbar",value:function(e,t,i,n,r,o){var a=this,l=I.a.show({message:e,duration:r,action:n,onClickAction:function(){t?a.handleBtnActionType(t):i&&Object(k.a)({url:i}),o&&Object(C.c)(O(O({},o),{},{ver5:e,ver6:t})),null==l||l.close()}})}}]),i}(E.a)},c7bde49cd5:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var n,r,o,a,l,s,c,d=i("1f925d7f50"),u=i.n(d),h=i("9132715560"),v=i.n(h),f=i("85d0a7609b"),p=i.n(f),g=i("2dc700e1e6"),y=i.n(g),m=(i("f1054791f4"),i("6a9e93341e")),b=i("d5c3deb8c7"),S=i("6884e1a126"),M=i("7e3c27b775"),E=(n=function e(){var t=this;v()(this,e),u()(this,"isPropertyEditorShown",r,this),u()(this,"propertyEditorShowAction",o,this),u()(this,"isAnimationEditorShown",a,this),u()(this,"isSelectWindowShown",l,this),u()(this,"isSlideRatingShown",s,this),u()(this,"isReplaceImageShown",c,this),p()(this,"selectWindowShowAction",0),p()(this,"selectWindowWidth",m.d),p()(this,"setIsPropertyEditorShown",(function(e){t.isPropertyEditorShown=e})),p()(this,"setPropertyEditorShowAction",(function(e){t.propertyEditorShowAction=e})),p()(this,"setIsAnimationEditorShown",(function(e){t.isAnimationEditorShown=e})),p()(this,"setIsSelectWindowShown",(function(e){t.isSelectWindowShown=e})),p()(this,"setSelectWindowShowAction",(function(e){t.selectWindowShowAction=e})),p()(this,"setSelectWindowWidth",(function(e){t.selectWindowWidth=e})),p()(this,"setReplaceImageShown",(function(e){t.isReplaceImageShown=e})),p()(this,"setIsSlideRatingShown",(function(e){t.isSlideRatingShown=e})),p()(this,"isResizeDrawerShown",(function(){return[t.isPropertyEditorShown,t.isAnimationEditorShown,t.isSelectWindowShown,t.isSlideRatingShown,t.isReplaceImageShown].some(Boolean)}));var i=S.e.get(M.a);Object(b.r)((function(){return t.isAnimationEditorShown}),(function(){i.$forceUpdate()}))},r=y()(n.prototype,"isPropertyEditorShown",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=y()(n.prototype,"propertyEditorShowAction",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a=y()(n.prototype,"isAnimationEditorShown",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=y()(n.prototype,"isSelectWindowShown",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=y()(n.prototype,"isSlideRatingShown",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=y()(n.prototype,"isReplaceImageShown",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},cc15f23d09:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),s=i.n(l),c=function(){function e(){r()(this,e),s()(this,"pasteSpecialStrategy",void 0)}return a()(e,[{key:"setStrategy",value:function(e){this.pasteSpecialStrategy=e}},{key:"executePaste",value:function(){this.pasteSpecialStrategy.paste()}}]),e}()},d08caa28b5:function(e,t,i){"use strict";i.d(t,"a",(function(){return ge}));var n,r,o,a,l,s,c,d,u,h,v,f,p,g=i("7a5536c9bf"),y=i.n(g),m=i("1f925d7f50"),b=i.n(m),S=i("9132715560"),M=i.n(S),E=i("6a364eb35c"),C=i.n(E),k=i("85d0a7609b"),w=i.n(k),I=i("2dc700e1e6"),x=i.n(I),O=(i("f1054791f4"),i("8e7cce0ada"),i("29f8c5f672"),i("c6244f7705"),i("85d48ef22b"),i("2a6f332b5e"),i("3bf1976a4f"),i("826dc923b3"),i("8ee19818c4"),i("6e20b6a7d8"),i("b8217400dc"),i("e6f68cdf2e"),i("75563bc376"),i("81ee04f965")),A=i("d5c3deb8c7"),L=(i("73b854064b"),i("547611bd96")),R=i.n(L),D=i("bd29e2df90"),T=i.n(D),P=i("ab5eb40518"),B=i.n(P),G=i("1b4cdd6a36"),j=i.n(G),N=(i("22569efd03"),i("63513d8b56"),i("176815363d"),i("3ef2352f0b"),i("081c8cafea"),i("24f382e0f4"),i("ee6bb53310"),i("e0e8dd9366")),F=(n=Reflect.metadata("design:type",void 0===O.a?Object:O.a),r=Reflect.metadata("design:type",String),o=Reflect.metadata("design:type",Number),a=function e(){M()(this,e),w()(this,"type",N.d.GUIDES),b()(this,"orient",l,this),b()(this,"color",s,this),b()(this,"pos",c,this)},l=x()(a.prototype,"orient",[A.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=x()(a.prototype,"color",[A.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=x()(a.prototype,"pos",[A.q,o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a),z=i("08062910eb"),H=(i("8a35b54c1d"),i("3344f1a2e7")),U=i("21f6c93a07");!function(e){e[e.slide=0]="slide",e[e.master=1]="master",e[e.layout=2]="layout"}(p||(p={}));var W=(d=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),u=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),h=function(){function e(t){var i=this;M()(this,e),b()(this,"vertGuides",v,this),b()(this,"horzGuides",f,this),w()(this,"vertUiComponentContainer",void 0),w()(this,"horzUiComponentContainer",void 0),w()(this,"slideWidth",0),w()(this,"slideHeight",0),w()(this,"scale",1),w()(this,"left",0),w()(this,"cLeft",0),w()(this,"top",0),w()(this,"cTop",0),w()(this,"selectionService",void 0),w()(this,"guideModel",void 0),w()(this,"setGuideModel",(function(e){i.guideModel=e})),w()(this,"setCanvasSize",(function(e){var t=e.slideWidth,n=e.slideHeight,r=e.scale,o=e.left,a=e.cLeft,l=e.top,s=e.cTop;i.slideWidth=t,i.slideHeight=n,i.scale=r,i.left=o,i.cLeft=a,i.top=l,i.cTop=s})),w()(this,"setGuideColor",(function(e,t){var n,r;t.color=e,null===(n=i.horzUiComponentContainer.componentMap.get(t))||void 0===n||n.renderGuideLine(t.pos,t.color),null===(r=i.vertUiComponentContainer.componentMap.get(t))||void 0===r||r.renderGuideLine(t.pos,t.color),i.updateGuidesProps()})),w()(this,"setGuidePos",(function(e,t){var n=t.orient;t.pos=Math.floor(e);var r=(n===O.a.ppVerticalGuide?i.vertGuides:i.horzGuides).filter((function(e){return e.pos===t.pos&&e!==t}))[0];i.deleteGuide(r),i.updateGuidesProps()})),w()(this,"initGuidesIfEmptyData",(function(e){var t;switch(e){case p.slide:t=z.a;break;case p.master:t=z.c;break;case p.layout:t=z.b;break;default:t=z.a}if(!i.vertGuides.length&&!i.horzGuides.length){var n=new F;n.pos=Math.floor(i.slideWidth/2),n.orient=O.a.ppVerticalGuide,n.color=t;var r=new F;return r.pos=Math.floor(i.slideHeight/2),r.orient=O.a.ppHorizontalGuide,r.color=t,i.vertGuides.push(n),i.horzGuides.push(r),i.updateGuidesProps(),!1}return!0})),w()(this,"findGuideModelByPos",(function(e,t){return t.find((function(t){return t.pos===e}))})),w()(this,"computeAddVertPosition",(function(e,t){var n,r=t.currentGuide,o=t.pageY,a=void 0===o?0:o,l=t.pageX,s=void 0===l?0:l,c=Math.floor(Object(H.n)(.5));if(r)if(r.orient===O.a.ppVerticalGuide)n=r.pos+c;else{var d,u,h=document.getElementById(U.a.CANVAS);if(h){var v=h.getBoundingClientRect();u={left:s+((null==h?void 0:h.scrollLeft)||0)-v.left-window.pageXOffset,top:a+((null==h?void 0:h.scrollTop)||0)-v.top-window.pageYOffset}}n=((null===(d=u)||void 0===d?void 0:d.left)-(i.cLeft+i.left))/i.scale||Math.floor(i.slideWidth/2)}else n=Math.floor(i.slideWidth/2);for(;i.findGuideModelByPos(Math.floor(n),e);)n+=c;return n})),w()(this,"computeAddHorzPosition",(function(e,t){var n,r=t.currentGuide,o=t.pageY,a=void 0===o?0:o,l=t.pageX,s=void 0===l?0:l,c=Math.floor(Object(H.n)(.5));if(r)if(r.orient===O.a.ppHorizontalGuide)n=r.pos+c;else{var d,u,h=document.getElementById(U.a.CANVAS);if(h){var v=h.getBoundingClientRect();u={left:s+((null==h?void 0:h.scrollLeft)||0)-v.left-window.pageXOffset,top:a+((null==h?void 0:h.scrollTop)||0)-v.top-window.pageYOffset}}n=((null===(d=u)||void 0===d?void 0:d.top)-(i.cTop+i.top))/i.scale||Math.floor(i.slideHeight/2)}else n=Math.floor(i.slideHeight/2);for(;i.findGuideModelByPos(Math.floor(n),e);)n+=c;return n}));var n=t.selectionService;this.selectionService=n}return C()(e,[{key:"fixVertPos",value:function(e){return e<0?0:e>this.slideWidth?this.slideWidth:e}},{key:"fixHorzPos",value:function(e){return e<0?0:e>this.slideHeight?this.slideHeight:e}}]),e}(),v=x()(h.prototype,"vertGuides",[A.q,d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=x()(h.prototype,"horzGuides",[A.q,u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=j()(e);if(t){var r=j()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return B()(this,i)}}var Y,V,K,X=function(e){T()(i,e);var t=_(i);function i(e){var n;return M()(this,i),n=t.call(this,e),w()(R()(n),"addVertGuides",(function(e){var t=e.currentGuide,i=n.computeAddVertPosition(n.vertGuides,e);if(!(i>n.slideWidth||i<0)){var r=new F;r.orient=O.a.ppVerticalGuide,r.color=t?t.color:z.a,r.pos=i,n.vertGuides.push(r),n.updateGuidesProps()}})),w()(R()(n),"addHorzGuides",(function(e){var t=e.currentGuide,i=n.computeAddHorzPosition(n.horzGuides,e);if(!(i>n.slideHeight||i<0)){var r=new F;r.orient=O.a.ppHorizontalGuide,r.color=t?t.color:z.a,r.pos=i,n.horzGuides.push(r),n.updateGuidesProps()}})),w()(R()(n),"deleteGuide",(function(e){if(e){if(e.orient===O.a.ppVerticalGuide){var t=n.vertGuides.findIndex((function(t){return t===e}));t>-1&&n.vertGuides.splice(t,1)}else{var i=n.horzGuides.findIndex((function(t){return t===e}));i>-1&&n.horzGuides.splice(i,1)}n.updateGuidesProps()}})),w()(R()(n),"initGuides",(function(e){Object(A.w)((function(){e.forEach((function(e){var t=e.orient,i=void 0===t?O.a.ppVerticalGuide:t,r=e.color,o=new F;if(o.pos=Math.floor(e.pos/4),o.orient=i,o.color=r,i===O.a.ppVerticalGuide){var a=n.vertGuides.findIndex((function(e){return e.pos===o.pos}));-1===a&&n.vertGuides.push(o)}else{var l=n.horzGuides.findIndex((function(e){return e.pos===o.pos}));-1===l&&n.horzGuides.push(o)}}))}))})),w()(R()(n),"updateGuidesProps",(function(){var e,t=n.getUpdateProps();null===(e=n.guideModel)||void 0===e||e.updateGuidesPropsNoUndo({slideGuides:t,masterGuides:n.guideModel.masterGuides,layoutGuides:n.guideModel.layoutGuides},O.b.slide)})),w()(R()(n),"updateGuidesPosWhenCanvasSizeChange",(function(e,t){(e||t)&&(n.vertGuides.forEach((function(t){t.pos=n.fixVertPos(t.pos*e)})),n.horzGuides.forEach((function(e){e.pos=n.fixHorzPos(e.pos*t)})))})),w()(R()(n),"getUpdateProps",(function(){return[].concat(y()(n.vertGuides),y()(n.horzGuides)).map((function(e){return{color:e.color,pos:4*e.pos,orient:e.orient}}))})),n}return i}(W);function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=j()(e);if(t){var r=j()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return B()(this,i)}}var Z=(Y=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),V=function(e){T()(i,e);var t=Q(i);function i(e){var n;return M()(this,i),n=t.call(this,e),b()(R()(n),"allGuides",K,R()(n)),w()(R()(n),"addVertGuides",(function(e){var t=e.currentGuide,i=n.computeAddVertPosition(n.vertGuides,e);if(!(i>n.slideWidth||i<0)){var r=new F;r.orient=O.a.ppVerticalGuide,r.color=t?t.color:n.isMaster()?z.c:z.b,r.pos=i,n.vertGuides.push(r);var o=n.getId();n.allGuides.forEach((function(e){o===e.id&&(e.vertGuides=n.vertGuides)})),n.updateGuidesProps()}})),Object(A.r)((function(){return n.selectionService.currentSlide}),(function(){var e=n.getId();Object(A.w)((function(){n.initVertAndHorz(e)}))})),n}return C()(i,[{key:"initGuides",value:function(e){var t=this;null!=e&&e.length&&e.forEach((function(e){var i=e.id,n=e.guides;if(i){var r=[],o=[];n.forEach((function(e){var t=e.orient,i=void 0===t?O.a.ppVerticalGuide:t,n=e.color,a=new F;if(a.pos=Math.floor(e.pos/4),a.orient=i,a.color=n,i===O.a.ppVerticalGuide){var l=r.findIndex((function(e){return e.pos===a.pos}));-1===l&&r.push(a)}else{var s=o.findIndex((function(e){return e.pos===a.pos}));-1===s&&o.push(a)}}));var a={id:i,vertGuides:r,horzGuides:o},l=t.allGuides.find((function(e){return e.id===i}));l?(l.vertGuides=a.vertGuides||[],l.horzGuides=a.horzGuides||[]):t.allGuides.push(a),i===t.getId()&&Object(A.w)((function(){t.vertGuides=r,t.horzGuides=o}))}}))}},{key:"addHorzGuides",value:function(e){var t=this,i=e.currentGuide,n=this.computeAddHorzPosition(this.horzGuides,e);if(!(n>this.slideHeight||n<0)){var r=new F;r.orient=O.a.ppHorizontalGuide,r.color=i?i.color:this.isMaster()?z.c:z.b,r.pos=n,this.horzGuides.push(r);var o=this.getId();this.allGuides.forEach((function(e){o===e.id&&(e.horzGuides=t.horzGuides)})),this.updateGuidesProps()}}},{key:"deleteGuide",value:function(e){if(e){var t,i,n,r=this.getId();if(e.orient===O.a.ppVerticalGuide)t=null===(i=this.allGuides.find((function(e){return e.id===r})))||void 0===i?void 0:i.vertGuides;else t=null===(n=this.allGuides.find((function(e){return e.id===r})))||void 0===n?void 0:n.horzGuides;var o=t.findIndex((function(t){return t===e}));o>-1&&t.splice(o,1),this.updateGuidesProps()}}},{key:"updateGuidesPosWhenCanvasSizeChange",value:function(e,t){var i=this;(e||t)&&this.allGuides.forEach((function(n){var r=n.vertGuides,o=n.horzGuides;r.forEach((function(t){t.pos=i.fixVertPos(t.pos*e)})),o.forEach((function(e){e.pos=i.fixHorzPos(e.pos*t)}))}))}},{key:"getUpdateProps",value:function(){var e=this;return this.allGuides.map((function(t){return{id:t.id,guides:e.getGuides(t.vertGuides,t.horzGuides)}})).filter((function(e){return void 0!==e.id}))}},{key:"getGuides",value:function(e,t){return[].concat(y()(e),y()(t)).map((function(e){return{color:e.color,pos:4*e.pos,orient:e.orient,type:N.d.GUIDES}}))}},{key:"initVertAndHorz",value:function(e){var t,i,n=this.allGuides.find((function(t){return t.id===e}));n||(n={id:e,vertGuides:[],horzGuides:[]},this.allGuides.push(n)),this.vertGuides=(null===(t=n)||void 0===t?void 0:t.vertGuides)||[],this.horzGuides=(null===(i=n)||void 0===i?void 0:i.horzGuides)||[]}}]),i}(W),K=x()(V.prototype,"allGuides",[A.q,Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V);function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=j()(e);if(t){var r=j()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return B()(this,i)}}var J=function(e){T()(i,e);var t=q(i);function i(){return M()(this,i),t.apply(this,arguments)}return C()(i,[{key:"updateGuidesProps",value:function(){var e,t=this.getUpdateProps();null===(e=this.guideModel)||void 0===e||e.updateGuidesPropsNoUndo({masterGuides:t,slideGuides:this.guideModel.slideGuides,layoutGuides:this.guideModel.layoutGuides},O.b.master)}},{key:"getId",value:function(){var e,t=null===(e=this.selectionService.currentSlide)||void 0===e?void 0:e.getRelationMasterModel(),i=null==t?void 0:t.presentationRef;if(i&&null!=t&&t.sdkData)return i.getMasterChildrenMapKey(t.sdkData)}},{key:"isMaster",value:function(){return!0}}]),i}(Z);function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=j()(e);if(t){var r=j()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return B()(this,i)}}var ee,te,ie,ne,re,oe,ae=function(e){T()(i,e);var t=$(i);function i(){return M()(this,i),t.apply(this,arguments)}return C()(i,[{key:"updateGuidesProps",value:function(){var e,t=this.getUpdateProps();null===(e=this.guideModel)||void 0===e||e.updateGuidesPropsNoUndo({layoutGuides:t,slideGuides:this.guideModel.slideGuides,masterGuides:this.guideModel.masterGuides},O.b.layout)}},{key:"getId",value:function(){var e,t=null===(e=this.selectionService.currentSlide)||void 0===e?void 0:e.getRelationLayoutModel(),i=null==t?void 0:t.presentationRef;if(i&&null!=t&&t.sdkData)return i.getLayoutChildrenMapKey(t.sdkData)}},{key:"isMaster",value:function(){return!1}}]),i}(Z),le=i("1288bffff3"),se=i("79fc58c7b0"),ce=i("d3d31c86eb"),de=i("9da6335152"),ue=i("9657b29818"),he=i("6ed1f9725a"),ve=i("37091e4240"),fe=i("5ce71228c0");!function(e){e[e.show=0]="show",e[e.hide=1]="hide"}(oe||(oe={}));var pe=15,ge=(ee=Reflect.metadata("design:type",Boolean),te=Reflect.metadata("design:type",Object),ie=function(){function e(t){var i=this;M()(this,e),b()(this,"displayGuides",ne,this),b()(this,"currentGuideModelMap",re,this),w()(this,"uiComponentMap",new Map),w()(this,"guideModel",void 0),w()(this,"slideGuidesService",void 0),w()(this,"masterGuidesService",void 0),w()(this,"layoutGuidesService",void 0),w()(this,"uiDataService",void 0),w()(this,"masterLayoutEditService",void 0),w()(this,"selectionService",void 0),w()(this,"slideWidth",void 0),w()(this,"slideHeight",void 0),w()(this,"initGuides",(function(){var e,t,n;i.slideGuidesService.setGuideModel(i.guideModel),i.masterGuidesService.setGuideModel(i.guideModel),i.layoutGuidesService.setGuideModel(i.guideModel);var r=null===(e=i.guideModel)||void 0===e?void 0:e.slideGuides,o=null===(t=i.guideModel)||void 0===t?void 0:t.masterGuides,a=null===(n=i.guideModel)||void 0===n?void 0:n.layoutGuides;i.slideGuidesService.initGuides(r),i.masterGuidesService.initGuides(o),i.layoutGuidesService.initGuides(a)})),w()(this,"setCanvasSize",(function(e){var t=e.slideWidth,n=e.slideHeight,r=i.slideWidth?t/i.slideWidth:1,o=i.slideHeight?n/i.slideHeight:1;i.slideWidth=t,i.slideHeight=n,i.slideGuidesService.setCanvasSize(e),i.masterGuidesService.setCanvasSize(e),i.layoutGuidesService.setCanvasSize(e),1===r&&1===o||i.updateGuidesPosWhenCanvasSizeChange(r,o)})),w()(this,"changeDisplayGuides",(function(){i.displayGuides=!i.displayGuides,i.displayGuides?(fe.b.setItem(fe.a.DISPLAY_GUIDES,oe.show),i.initGuidesIfEmptyDataByEditType()):fe.b.setItem(fe.a.DISPLAY_GUIDES,oe.hide)})),w()(this,"initGuidesIfEmptyDataByEditType",(function(){var e,t;(null===(e=i.masterLayoutEditService)||void 0===e?void 0:e.editType)!==le.a.SLIDE?(null===(t=i.selectionService.currentSlide)||void 0===t?void 0:t.getRelationMasterModel())!==i.selectionService.currentSlide?i.layoutGuidesService.initGuidesIfEmptyData(p.layout):i.masterGuidesService.initGuidesIfEmptyData(p.master):i.slideGuidesService.initGuidesIfEmptyData(p.slide)})),w()(this,"setCurrentGuide",(function(e){i.currentGuideModelMap.guide=e})),w()(this,"setDisplayGuides",(function(e){i.displayGuides=e,i.displayGuides?fe.b.setItem(fe.a.DISPLAY_GUIDES,oe.show):fe.b.setItem(fe.a.DISPLAY_GUIDES,oe.hide)})),w()(this,"setCurrentMouseEvent",(function(e){var t=e.e,n=e.pageX,r=e.pageY;i.currentGuideModelMap.e=t,i.currentGuideModelMap.pageX=n,i.currentGuideModelMap.pageY=r})),w()(this,"addVertGuide",(function(){var e;i.displayGuides?(null===(e=i.getOperationService())||void 0===e||e.addVertGuides({currentGuide:i.currentGuideModelMap.guide,e:i.currentGuideModelMap.e,pageX:i.currentGuideModelMap.pageX,pageY:i.currentGuideModelMap.pageY}),Object(ce.c)({opername:de.e.DOC_PPT,module:de.d.GUIDES,action:de.b.ADD_VERTICAL_GUIDE})):i.changeDisplayGuides()})),w()(this,"addHorzGuide",(function(){var e;i.displayGuides?(null===(e=i.getOperationService())||void 0===e||e.addHorzGuides({currentGuide:i.currentGuideModelMap.guide,e:i.currentGuideModelMap.e,pageX:i.currentGuideModelMap.pageX,pageY:i.currentGuideModelMap.pageY}),Object(ce.c)({opername:de.e.DOC_PPT,module:de.d.GUIDES,action:de.b.ADD_HORIZONTAL_GUIDE})):i.changeDisplayGuides()})),w()(this,"deleteGuide",(function(e){var t;null===(t=i.getOperationService())||void 0===t||t.deleteGuide(e),Object(ce.c)({opername:de.e.DOC_PPT,module:de.d.GUIDES,action:de.b.GUIDES_DELETE})})),w()(this,"setCurrentGuidePos",(function(e){var t,n=i.currentGuideModelMap.guide;n&&(null===(t=i.getOperationService())||void 0===t||t.setGuidePos(e,n))})),w()(this,"setCurrentGuideColor",(function(e){var t,n=i.currentGuideModelMap.guide;n&&(null===(t=i.getOperationService())||void 0===t||t.setGuideColor(e,n));Object(ce.c)({opername:de.e.DOC_PPT,module:de.d.GUIDES,action:de.b.GUIDES_COLOR})})),w()(this,"handleDragAdsorbGuides",(function(e){var t=e.offsetFrame,n=e.originalSize,r=e.mode,o=e.model,a=e.multiRect,l=e.sizeMap,s=i.slideGuidesService,c=s.vertGuides,d=s.horzGuides,u=i.masterGuidesService,h=u.vertGuides,v=u.horzGuides,f=i.layoutGuidesService,p=f.vertGuides,g=f.horzGuides,m=[].concat(y()(c),y()(h),y()(p)),b=[].concat(y()(d),y()(v),y()(g));return i.computeOperationFrame({allGuidesList:m,offsetFrame:t,originalSize:n,mode:r,model:o,multiRect:a,sizeMap:l}),i.computeOperationFrame({allGuidesList:b,offsetFrame:t,originalSize:n,mode:r,model:o,multiRect:a,sizeMap:l}),t}));var n=t.uiDataService,r=t.masterLayoutEditService,o=t.selectionService,a=fe.b.getItem(fe.a.DISPLAY_GUIDES);this.displayGuides=a===oe.show,this.uiDataService=n,this.selectionService=o,this.slideGuidesService=new X({selectionService:this.selectionService}),this.masterGuidesService=new J({selectionService:this.selectionService}),this.layoutGuidesService=new ae({selectionService:this.selectionService}),this.masterLayoutEditService=r,ve.b.on(ve.a.ALL_SLIDE_DATA_CONVERT,(function(){i.guideModel=i.makeV3GuideData(),i.initGuides()}))}return C()(e,[{key:"getOperationService",value:function(){var e,t;return this.masterLayoutEditService.editType===le.a.SLIDE?this.slideGuidesService:this.selectionService.currentSlide===(null===(e=this.selectionService.currentSlide)||void 0===e?void 0:e.getRelationMasterModel())?this.masterGuidesService:this.selectionService.currentSlide===(null===(t=this.selectionService.currentSlide)||void 0===t?void 0:t.getRelationLayoutModel())?this.layoutGuidesService:void 0}},{key:"computeOperationFrame",value:function(e){var t=e.allGuidesList,i=e.offsetFrame,n=e.originalSize,r=e.mode,o=e.model,a=e.multiRect,l=e.sizeMap;if(r===se.b.MOVE)this.computeDragOffset({allGuidesList:t,originalSize:n,offsetFrame:i}),null!=a&&a.length&&this.computeDragOffset({allGuidesList:t,originalSize:a,offsetFrame:i});else this.computeResizeOffset({allGuidesList:t,originalSize:n,offsetFrame:i,model:o,sizeMap:l})}},{key:"computeResizeOffset",value:function(e){var t,i,n,r,o,a=e.allGuidesList,l=e.originalSize,s=e.model,c=e.sizeMap,d=e.offsetFrame;if(null!=a&&a.length){var u;if(null!=c&&c.size)d=null===(u=c.get(s.key))||void 0===u?void 0:u.offsetFrame;var h=0,v=0;s&&(null===(t=s.parent)||void 0===t?void 0:t.type)===N.d.GROUP&&(h=s.parent.props.style.left||0,v=s.parent.props.style.top||0);var f,p,g,y,m,b,S=Number.MAX_VALUE,M=null==s||null===(i=s.props)||void 0===i||null===(n=i.style)||void 0===n?void 0:n.flipH,E=null==s||null===(r=s.props)||void 0===r||null===(o=r.style)||void 0===o?void 0:o.flipV,C=a[0].orient===O.a.ppVerticalGuide;C?(y="left",b="width",f=l.left+h,p=d.left,g=l.width,m=d.width):(y="top",b="height",f=l.top+v,p=d.top,g=l.height,m=d.height),a.forEach((function(e){if(!!d.flipH!=!!M&&C||!!E!=!!d.flipV&&!C){var t=Math.abs(f+g+p+m-e.pos);if(d[y]>0)t<pe&&t<=S&&(d[b]=e.pos-f-g-g,S=t);else{var i=Math.abs(f+p-e.pos);if(i<pe&&i<=S){var n=e.pos-(f+d[y]);d[y]=e.pos-f,d[b]=d[b]-n,S=i}}}else{var r=Math.abs(f+g+m-e.pos);if(0===Math.floor(Math.abs(d[y])))r<pe&&r<S&&(d[b]=e.pos-f-g,S=r);else{var o=Math.abs(f+p-e.pos);o<pe&&o<S&&(d[y]=e.pos-f,d[b]=-d[y],S=o)}}}))}}},{key:"computeDragOffset",value:function(e){var t=e.allGuidesList,i=e.originalSize,n=e.offsetFrame;if(null!=t&&t.length){var r,o,a,l,s=Number.MAX_VALUE;t[0].orient===O.a.ppVerticalGuide?(l="left",r=i.left,o=n.left,a=i.width):(l="top",r=i.top,o=n.top,a=i.height),t.forEach((function(e){var t=Math.abs(r+o-e.pos);t<pe&&t<=s&&(n[l]=e.pos-r+0,s=t);var i=Math.abs(r+o+a-e.pos);i<pe&&i<=s&&(n[l]=e.pos-(r+a)+0,s=i)}))}}},{key:"updateGuidesPosWhenCanvasSizeChange",value:function(e,t){var i;this.slideGuidesService.updateGuidesPosWhenCanvasSizeChange(e,t),this.masterGuidesService.updateGuidesPosWhenCanvasSizeChange(e,t),this.layoutGuidesService.updateGuidesPosWhenCanvasSizeChange(e,t);var n={slideGuides:this.slideGuidesService.getUpdateProps(),masterGuides:this.masterGuidesService.getUpdateProps(),layoutGuides:this.layoutGuidesService.getUpdateProps()};null===(i=this.guideModel)||void 0===i||i.updateGuidesPropsNoUndo(n,O.b.all)}},{key:"makeV3GuideData",value:function(){var e,t,i,n,r,o,a,l,s=this,c=null===(e=this.uiDataService)||void 0===e||null===(t=e.presentation)||void 0===t||null===(i=t.masterList)||void 0===i?void 0:i.map((function(e){var t;return{id:e.id||"",guides:null===(t=e.guideModel)||void 0===t?void 0:t.slideGuideList}})),d=null===(n=this.uiDataService)||void 0===n||null===(r=n.presentation)||void 0===r||null===(o=r.layoutList)||void 0===o?void 0:o.map((function(e){var t;return{id:e.id||"",guides:null===(t=e.guideModel)||void 0===t?void 0:t.slideGuideList}}));return{slideGuides:(null===(a=this.uiDataService)||void 0===a||null===(l=a.presentation)||void 0===l?void 0:l.guideModel).slideGuideList,masterGuides:c,layoutGuides:d,updateGuidesPropsNoUndo:function(e,t){Object(ue.b)((function(){var i,n,r=null===(i=s.uiDataService)||void 0===i||null===(n=i.presentation)||void 0===n?void 0:n.sdkData;if(r){if([O.b.all,O.b.slide].includes(t)){var o=he.a.convertDataUiToSdk(e.slideGuides);r.api.updateSlideGuideList(o)}[O.b.all,O.b.master].includes(t)&&e.masterGuides.forEach((function(e){var t,i=r.masterList.find((function(t){return t.id===e.id})),n=he.a.convertDataUiToSdk(e.guides);null==i||null===(t=i.api)||void 0===t||t.updateSlideGuideList(n)})),[O.b.all,O.b.layout].includes(t)&&e.layoutGuides.forEach((function(e){var t,i=r.layoutList.find((function(t){return t.id===e.id})),n=he.a.convertDataUiToSdk(e.guides);null==i||null===(t=i.api)||void 0===t||t.updateSlideGuideList(n)}))}}))}}}}]),e}(),ne=x()(ie.prototype,"displayGuides",[A.q,ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=x()(ie.prototype,"currentGuideModelMap",[A.q,te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{guide:void 0,e:void 0,pageX:0,pageY:0}}}),ie)},d10522841f:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("4f3b15d017"),r=n.default.isElectronTencentDocsClient||n.default.isWxWork||n.default.isTencentMeeting||n.default.isWxWorkTencentMeeting||n.default.isTencentMeetingRooms,o=n.default.isPC&&!r},d3f5530e59:function(e,t,i){(t=e.exports=i("9dddfe0040")(!1)).push([e.i,".index-gridLineContainer-2H4k5{width:100%;height:100%;pointer-events:none;position:relative;overflow:hidden}.index-gridLineSvgContainer-mDQ-H{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}",""]),t.locals={gridLineContainer:"index-gridLineContainer-2H4k5",gridLineSvgContainer:"index-gridLineSvgContainer-mDQ-H"}},d42cf6eff2:function(e,t,i){"use strict";(function(e){function n(){return/android|adr/i.test(e.navigator?e.navigator.userAgent:"")}function r(){return/(iphone)/i.test(e.navigator?e.navigator.userAgent:"")}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}))}).call(this,i("5ef37df1a0"))},d818a44ab4:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));var n="startPCPlay",r="mobileJoin"},d94c8b11f8:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n,r,o,a,l,s,c=i("14502724a6"),d=i.n(c),u=i("7a5536c9bf"),h=i.n(u),v=i("1f925d7f50"),f=i.n(v),p=i("9132715560"),g=i.n(p),y=i("6a364eb35c"),m=i.n(y),b=i("85d0a7609b"),S=i.n(b),M=i("2dc700e1e6"),E=i.n(M),C=(i("f1054791f4"),i("8aebbf296a"),i("85d48ef22b"),i("63513d8b56"),i("6e20b6a7d8"),i("9fbcf5162b")),k=i("d5c3deb8c7"),w=(n=Reflect.metadata("design:type",Array),r=function(){function e(){g()(this,e),f()(this,"sectionFoldedState",o,this),f()(this,"selectedSectionIndex",a,this),f()(this,"nameEditingIndex",l,this),f()(this,"onSectionsChangeAction",s,this),S()(this,"selectionService",void 0),S()(this,"uiDataService",void 0)}return m()(e,[{key:"setSelectionServiceDelegate",value:function(e){this.selectionService=e}},{key:"setUiDataServiceDelegate",value:function(e){this.uiDataService=e}},{key:"initSectionFoldedState",value:function(e){this.sectionFoldedState&&e===this.sectionFoldedState.length||(this.sectionFoldedState=Array.from({length:e},(function(){return!1})))}},{key:"addUnfoldedSectionStateAt",value:function(e,t){var i,n,r,o,a,l=C.a.calcSlideIndexFromClearanceIndex(e,null!==(i=null===(n=this.uiDataService)||void 0===n?void 0:n.presentation.sectionList)&&void 0!==i?i:[]);if(2===t)return this.sectionFoldedState=[!1,!1],this.nameEditingIndex=1,void this.selectSection(1,l);if(this.sectionFoldedState){var s=C.a.calcSectionIndexFromClearanceIndex(e,null!==(r=null===(o=this.uiDataService)||void 0===o?void 0:o.presentation.sectionList)&&void 0!==r?r:[])+1;0===e&&0!==(null===(a=this.uiDataService)||void 0===a?void 0:a.presentation.children.length)&&(s=0),-1!==s&&s<=this.sectionFoldedState.length&&(this.sectionFoldedState.splice(s,0,!1),this.nameEditingIndex=s,this.selectSection(s,l))}}},{key:"deleteSectionStateAt",value:function(e){var t;null===(t=this.sectionFoldedState)||void 0===t||t.splice(e,1),this.selectedSectionIndex=-1}},{key:"deleteAllSectionsState",value:function(){this.sectionFoldedState=null}},{key:"moveSectionFoldedState",value:function(e,t){if(this.sectionFoldedState&&!(e<0||e>=this.sectionFoldedState.length||t<0||t>=this.sectionFoldedState.length)){var i=h()(this.sectionFoldedState),n=i.splice(e,1),r=d()(n,1)[0];i.splice(t,0,r),this.sectionFoldedState=i}}},{key:"selectSection",value:function(e,t,i){var n,r,o,a;if(this.selectedSectionIndex=e,this.selectionService){var l=Math.min(this.uiDataService.presentation.children.length-1,t);this.selectionService.currentSlideIndex=l}i&&0!==i.length&&(null===(n=this.selectionService)||void 0===n||n.selectedElements.clear(),null===(r=this.selectionService)||void 0===r||r.selectedSlides.clear(),null===(o=this.selectionService)||void 0===o||(a=o.selectedSlides).add.apply(a,h()(i)))}},{key:"collapseAllSections",value:function(){this.sectionFoldedState&&(this.sectionFoldedState=this.sectionFoldedState.map((function(){return!0})))}},{key:"expandAllSections",value:function(){this.sectionFoldedState&&(this.sectionFoldedState=this.sectionFoldedState.map((function(){return!1})))}},{key:"expandSelectedSection",value:function(){if(this.sectionFoldedState&&!(this.selectedSectionIndex<0)){var e=this.sectionFoldedState,t=h()(e);t[this.selectedSectionIndex]=!1,this.sectionFoldedState=t}}},{key:"expandCurrentSection",value:function(e){var t,i,n=C.a.calcSectionIndexFromClearanceIndex(null!=e?e:this.selectionService.slideClearanceIndex,null!==(t=this.uiDataService.presentation.sectionList)&&void 0!==t?t:[]);-1===n&&(n=C.a.calcSectionIndexFromSlideIndex(this.selectionService.currentSlideIndex,null!==(i=this.uiDataService.presentation.sectionList)&&void 0!==i?i:[]));if(-1!==n&&this.sectionFoldedState){var r=h()(this.sectionFoldedState);r[n]=!1,this.sectionFoldedState=r}}}]),e}(),o=E()(r.prototype,"sectionFoldedState",[k.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=E()(r.prototype,"selectedSectionIndex",[k.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),l=E()(r.prototype,"nameEditingIndex",[k.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),s=E()(r.prototype,"onSectionsChangeAction",[k.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r)},d9704100c3:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("9132715560"),r=i.n(n),o=i("85d0a7609b"),a=i.n(o),l=i("7af4d80efc"),s=function e(){r()(this,e),a()(this,"attachMediaEventInPlayer",(function(e){return e===l.b.DESKTOP}))}},dacc4e7a0c:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("77c89fc0e0"),s=i("4e7af1026b"),c=i("e0a67dc3fe"),d=i("7e61746219"),u=i("7264fb5e8f"),h=function(){function e(){r()(this,e)}return a()(e,[{key:"shouldListenAuthGuide",get:function(){return!Object(d.f)()}},{key:"shouldListenLoginGuide",get:function(){return!l.e.IS_PC_LOCAL_EDIT&&!Object(d.f)()}},{key:"shouldShowNoAuthGuide",get:function(){return!Object(c.c)(u.appConfigInstance.getConfig(s.l.appGuide),void 0)}}]),e}()},e1ef3fc9ed:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));i("73b854064b");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("bd29e2df90"),s=i.n(l),c=i("ab5eb40518"),d=i.n(c),u=i("1b4cdd6a36"),h=i.n(u),v=i("99aec9988f"),f=i("1acc787c14"),p=i("b317f0ae77");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h()(e);if(t){var r=h()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return d()(this,i)}}var y=function(e){s()(i,e);var t=g(i);function i(){return r()(this,i),t.call(this)}return a()(i,[{key:"getEntryType",value:function(){return f.a.PC_EDIT}},{key:"initReport",value:function(){Object(p.a)(this.getEntryType())}}]),i}(v.a)},e2c777ac98:function(e,t,i){"use strict";var n,r,o,a,l,s=i("176815363d"),c=i.n(s),d=i("1f925d7f50"),u=i.n(d),h=i("9132715560"),v=i.n(h),f=i("6a364eb35c"),p=i.n(f),g=i("85d0a7609b"),y=i.n(g),m=i("2dc700e1e6"),b=i.n(m),S=(i("f1054791f4"),i("3ef2352f0b")),M=i.n(S),E=(i("c6244f7705"),i("081c8cafea"),i("af802ec74b"),i("d5c3deb8c7")),C=(n=Reflect.metadata("design:type",Boolean),r=Reflect.metadata("design:type","undefined"==typeof IPagingSelectionManagerData?Object:IPagingSelectionManagerData),o=function(){function e(){v()(this,e),u()(this,"visible",a,this),u()(this,"data",l,this),y()(this,"waitingToClose",Promise.resolve())}var t;return p()(e,[{key:"setVisible",value:function(e){return e?this.show():this.close()}},{key:"getVisible",value:function(){return this.visible}},{key:"updateData",value:function(e){var t=this;return this.chain((function(){return t.data=Object.assign({},t.data,e)}))}},{key:"chain",value:function(e){return e(),this}},{key:"show",value:(t=c()(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitingToClose;case 2:this.visible=!0;case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){var e=this;return this.waitingToClose=new Promise((function(t){setTimeout((function(){e.visible=!1,t()}),300)})),this.waitingToClose}}]),e}(),a=b()(o.prototype,"visible",[E.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=b()(o.prototype,"data",[E.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o);t.a=C},e672ea43eb:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));i("73b854064b");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("bd29e2df90"),s=i.n(l),c=i("ab5eb40518"),d=i.n(c),u=i("1b4cdd6a36"),h=i.n(u);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h()(e);if(t){var r=h()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return d()(this,i)}}var f=function(e){s()(i,e);var t=v(i);function i(){return r()(this,i),t.apply(this,arguments)}return a()(i,[{key:"showHistoryRightBar",value:function(e){var t;null===(t=this.services.historyManager)||void 0===t||t.show(e)}},{key:"watchEditTypeChange",value:function(e){var t;null===(t=this.services.masterLayoutEditService)||void 0===t||t.watchEditTypeChange((function(t){return null==e?void 0:e(t)}))}}]),i}(i("73301bd1eb").a)},e8bb8c4f7b:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("176815363d"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("3ef2352f0b"),d=i.n(c),u=(i("c6244f7705"),i("081c8cafea"),i("8e7cce0ada"),i("85d48ef22b"),i("2a6f332b5e"),function(){function e(){a()(this,e)}var t;return s()(e,[{key:"getWorkbenchLoader",value:(t=r()(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e("commonAsync~9b1fde68"),i.e("commonAsync~27f19aac"),i.e("commonAsync~205ac551"),i.e("commonAsync~0c3a6025"),i.e("commonAsync~32e631b8"),i.e("commonAsync~08369118"),i.e("commonAsync~50db4bb8"),i.e("commonAsync~86c92fed"),i.e("commonAsync~a95f944a"),i.e("commonAsync~6e568190"),i.e("commonAsync~b174e5ca"),i.e("commonAsync~54a68610"),i.e("commonAsync~61b3c105"),i.e("commonAsync~f7b3ac00"),i.e("commonAsync~cece21d6"),i.e("commonAsync~ecbf7682"),i.e("commonAsync~6c5dfa7c"),i.e("commonAsync~90483627"),i.e("commonAsync~d2c096c2"),i.e("commonAsync~1285a477"),i.e("commonAsync~31ded9a0"),i.e("commonAsync~ecdbff9b"),i.e("commonAsync~c2cc425c"),i.e("commonAsync~4fb44df2"),i.e("commonAsync~d06fe423"),i.e("commonAsync~0519277e"),i.e("commonAsync~6df2b9ea"),i.e("commonAsync~b5c4f9e4"),i.e("commonAsync~ffdf5190"),i.e("commonAsync~127b6cf7"),i.e("commonAsync~b3c4a2ff"),i.e("commonAsync~19bb5a55"),i.e("async~493df0b3"),i.e("async~c5b24172"),i.e("async~0d51b00e"),i.e("async~beecf843"),i.e("async~2e2c6527"),i.e("async~da8db81f"),i.e("async~e10030d6"),i.e("async~098dcb65"),i.e("async~d0c14fe8"),i.e("async~7f8bedbf"),i.e("async~f40490b4"),i.e("async~2158e36e"),i.e("async~76acd586"),i.e("async~37d786cf"),i.e("async~30ccc425"),i.e("async~0c7d7381"),i.e("async~907e9098"),i.e("async~43172549"),i.e("async~f19eb79b"),i.e("async~95108331"),i.e("async~718865d2"),i.e("async~89b7a519"),i.e(2)]).then(i.bind(null,"8cccc6889a"));case 2:return t=e.sent,e.abrupt("return",t.default);case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}())},e93668b936:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAgklEQVR4AWOgPWDq+DOfseP3f2IwU+efBQxSM/9zMXb+vkJIMVDNNZBasC1snf81GTv/fMGt+M83to7/2ihOY+78E4tLA3PXnyTs/un8MwddMdCPi3EGgEzff06goktI7r4hOvU/D95QY+/8r87Y8ecz1N26RAU1c8efKCBOZRgQAAA2hYuxREaehQAAAABJRU5ErkJggg=="},ea5dc78459:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));i("73b854064b");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("8eec1e4a03"),s=i.n(l),c=i("bd29e2df90"),d=i.n(c),u=i("ab5eb40518"),h=i.n(u),v=i("1b4cdd6a36"),f=i.n(v),p=i("d7b579ea9f"),g=i("7e61746219");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var m={type:"ai-ppt-finish"},b=function(e){d()(i,e);var t=y(i);function i(){return r()(this,i),t.apply(this,arguments)}return a()(i,[{key:"setServiceDelegates",value:function(e){var t,n=this;s()(f()(i.prototype),"setServiceDelegates",this).call(this,e),null===(t=this.services.aiAssistantService)||void 0===t||t.onSlideGenerateFinish((function(){var e,t,i;null===(e=window)||void 0===e||null===(t=e.parent)||void 0===t||null===(i=t.postMessage)||void 0===i||i.call(t,m,"*"),Object(g.f)()||n.services.aiService.promise().then((function(e){return e.showSideBar()}))}))}}]),i}(p.a)},ee138eb8dc:function(e,t,i){t=e.exports=i("9dddfe0040")(!1);var n=i("c92b994f13"),r=n(i("7d75750ac6")),o=n(i("6d54f692ac")),a=n(i("93d59fd87c")),l=n(i("e93668b936")),s=n(i("b53db0c2a2")),c=n(i("1c08b8fac5"));t.push([e.i,".index-history-item-wrapper-2B1W6{width:100%}.index-history-item-wrapper-2B1W6 .index-fold-wrapper-1r8q-{cursor:pointer;direction:ltr;width:20px;height:20px;float:left;top:12px;position:relative;left:20px}.index-history-item-wrapper-2B1W6 .index-fold-button-1oeo-{width:20px;height:20px}.index-history-item-wrapper-2B1W6 .index-fold-button-1oeo-.index-folding-12a8u{background:url("+r+") no-repeat 50%;background-size:10px 10px}.index-history-item-wrapper-2B1W6 .index-fold-button-1oeo-.index-folding-12a8u:hover{background-image:url("+o+")}.index-history-item-wrapper-2B1W6 .index-fold-button-1oeo-.index-unfolding-1PN8J{background:url("+a+") no-repeat 50%;background-size:10px 10px}.index-history-item-wrapper-2B1W6 .index-fold-button-1oeo-.index-unfolding-1PN8J:hover{background-image:url("+l+")}.index-history-item-wrapper-2B1W6 .index-main-content-1IK-S{width:100%}.index-history-item-wrapper-2B1W6 .index-main-content-1IK-S:hover{background-color:#f4f4f4}.index-history-item-wrapper-2B1W6 .index-main-content-1IK-S.index-selected-2kczM{background-color:#efefef}.index-history-item-wrapper-2B1W6 .index-version-21drc{padding-top:16px;font-weight:700;color:rgba(0,0,0,.64)}.index-history-item-wrapper-2B1W6 .index-time-3skSJ,.index-history-item-wrapper-2B1W6 .index-version-21drc{margin-left:44px;margin-right:55px;font-size:12px;line-height:12px;letter-spacing:0}.index-history-item-wrapper-2B1W6 .index-time-3skSJ{color:rgba(0,0,0,.48);padding-top:6px;padding-bottom:6px}.index-history-item-wrapper-2B1W6 .index-author-list-x4beA{margin-left:44px;margin-right:55px;padding-bottom:12px}.index-history-item-wrapper-2B1W6 .index-author-B5Zgs{font-size:12px;line-height:16px;color:rgba(0,0,0,.64);letter-spacing:0;max-width:200px;overflow:hidden;margin-top:8px;display:flex;align-items:center}.index-history-item-wrapper-2B1W6 .index-author-B5Zgs .index-author-dot-2O6G_{display:inline-block;width:6px;height:6px;margin-right:6px;border-radius:50%;background-color:red}.index-history-item-wrapper-2B1W6 .index-author-B5Zgs .index-author-text-2DmWW{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.index-history-item-wrapper-2B1W6 .index-author-count-1iTqH{font-size:12px;line-height:12px;color:rgba(0,0,0,.4);letter-spacing:0;margin-top:2px;padding-bottom:12px;margin-left:44px}.index-history-item-wrapper-2B1W6 .index-sub-item-list-Pcs0Z .index-sub-item-2kp2h{width:100%;height:44px}.index-history-item-wrapper-2B1W6 .index-sub-item-list-Pcs0Z .index-sub-item-2kp2h:hover{background-color:#f4f4f4}.index-history-item-wrapper-2B1W6 .index-sub-item-list-Pcs0Z .index-sub-item-2kp2h.index-selected-2kczM{background-color:#efefef}.index-history-item-wrapper-2B1W6 .index-sub-item-list-Pcs0Z .index-sub-item-time-2nuUb{margin-left:44px;margin-right:55px;letter-spacing:0;color:rgba(0,0,0,.4);font-size:12px;line-height:12px;padding-top:7px}.index-history-item-wrapper-2B1W6 .index-sub-item-list-Pcs0Z .index-sub-item-author-1-rBG{margin-left:44px;margin-right:55px;font-size:12px;line-height:16px;color:rgba(0,0,0,.64);letter-spacing:0;max-width:200px;overflow:hidden;margin-top:4px;display:flex;align-items:center}.index-history-item-wrapper-2B1W6 .index-sub-item-list-Pcs0Z .index-sub-item-author-1-rBG .index-sub-item-author-dot-3uHyk{display:inline-block;width:6px;height:6px;margin-right:6px;border-radius:50%;background-color:red}.index-history-item-wrapper-2B1W6 .index-sub-item-list-Pcs0Z .index-sub-item-author-1-rBG .index-sub-item-author-text-275if{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.index-history-item-wrapper-2B1W6 .index-revert-info-13FEI{color:rgba(0,0,0,.48);letter-spacing:0;font-size:12px;margin-left:44px;line-height:12px;padding-bottom:12px;margin-top:6px}.index-history-item-wrapper-2B1W6 .index-revert-3Y7dv{float:right;height:22px;right:20px;top:11px;position:relative;cursor:pointer;color:rgba(0,0,0,.4);display:flex;flex-direction:row;align-items:center}.index-history-item-wrapper-2B1W6 .index-revert-3Y7dv:hover{color:#00a4ff}.index-history-item-wrapper-2B1W6 .index-revert-3Y7dv:hover .index-revert-icon-qcAdB{background-image:url("+s+")}.index-history-item-wrapper-2B1W6 .index-revert-3Y7dv .index-revert-icon-qcAdB{width:16px;height:16px;background:url("+c+") 50% no-repeat;background-size:12px 12px;display:inline-block}.index-history-item-wrapper-2B1W6 .index-revert-3Y7dv .index-revert-text-3v_uY{display:inline-block;font-size:12px;position:relative}",""]),t.locals={"history-item-wrapper":"index-history-item-wrapper-2B1W6","fold-wrapper":"index-fold-wrapper-1r8q-","fold-button":"index-fold-button-1oeo-",folding:"index-folding-12a8u",unfolding:"index-unfolding-1PN8J","main-content":"index-main-content-1IK-S",selected:"index-selected-2kczM",version:"index-version-21drc",time:"index-time-3skSJ","author-list":"index-author-list-x4beA",author:"index-author-B5Zgs","author-dot":"index-author-dot-2O6G_","author-text":"index-author-text-2DmWW","author-count":"index-author-count-1iTqH","sub-item-list":"index-sub-item-list-Pcs0Z","sub-item":"index-sub-item-2kp2h","sub-item-time":"index-sub-item-time-2nuUb","sub-item-author":"index-sub-item-author-1-rBG","sub-item-author-dot":"index-sub-item-author-dot-3uHyk","sub-item-author-text":"index-sub-item-author-text-275if","revert-info":"index-revert-info-13FEI",revert:"index-revert-3Y7dv","revert-icon":"index-revert-icon-qcAdB","revert-text":"index-revert-text-3v_uY"}},f83ba7d4f8:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),s=i.n(l),c=i("692b88f5a6"),d=function(){function e(t,i){r()(this,e),s()(this,"clipboardData",void 0),s()(this,"type",void 0),s()(this,"slideSdkDataModify",void 0),s()(this,"selectionService",void 0),s()(this,"undoRedoService",void 0),s()(this,"copyPasteManager",void 0),s()(this,"textSelectionUndoRedo",void 0),s()(this,"textSelectivePasteState",void 0),s()(this,"insertSlideIndex",void 0),s()(this,"insertGapIndex",void 0),this.clipboardData=t.clipboardData,this.type=t.type,this.insertSlideIndex=t.insertSlideIndex,this.insertGapIndex=t.insertGapIndex,this.selectionService=i.selectionService,this.undoRedoService=i.undoRedoService,this.copyPasteManager=i.copyPasteManager,this.textSelectionUndoRedo=i.textSelectionUndoRedo,this.textSelectivePasteState=i.textSelectivePasteState,this.slideSdkDataModify=new c.a,this.slideSdkDataModify.setServiceDelegates({uiDataService:i.uiDataService,selectionService:this.selectionService})}return a()(e,[{key:"paste",value:function(){}}]),e}()},fba88abc7f:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));i("73b854064b"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36");var n=i("85d0a7609b"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),s=i.n(l),c=i("bd29e2df90"),d=i.n(c),u=i("ab5eb40518"),h=i.n(u),v=i("1b4cdd6a36"),f=i.n(v),p=(i("6e20b6a7d8"),i("f83ba7d4f8")),g=i("a42b29265b");function y(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?y(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f()(e);if(t){var r=f()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h()(this,i)}}var S=function(e){d()(i,e);var t=b(i);function i(e,n){return a()(this,i),t.call(this,e,n)}return s()(i,[{key:"paste",value:function(){var e,t;this.type===g.c.TEXT&&(null===(e=this.textSelectivePasteState)||void 0===e||e.beforePaste(),null===(t=this.undoRedoService)||void 0===t||t.undo(),this.pasteText())}},{key:"pasteText",value:function(){var e,t,i,n=this,r=this.clipboardData.data[0].ownSdkData,o=m(m({},r),{},{txBody:{p:null===(e=r.txBody)||void 0===e||null===(t=e.p)||void 0===t?void 0:t.map((function(e){var t;return{egTextRun:null===(t=e.egTextRun)||void 0===t?void 0:t.map(M)}}))}}),a=null===(i=this.textSelectionUndoRedo)||void 0===i?void 0:i.afterUndoRedo((function(){var e,t,i;null===(e=n.copyPasteManager)||void 0===e||null===(t=e.dangerousInstance)||void 0===t||t.runTextSelectivePaste(o,!1),null==a||a(),null===(i=n.textSelectivePasteState)||void 0===i||i.afterPaste()}))}}]),i}(p.a);function M(e){var t,i;return e.br?e:e.fld?{fld:{t:null===(i=e.fld)||void 0===i?void 0:i.t}}:{r:{t:null===(t=e.r)||void 0===t?void 0:t.t}}}},fbd06dd0f6:function(e,t,i){"use strict";i.d(t,"a",(function(){return K}));i("73b854064b");var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("bd29e2df90"),s=i.n(l),c=i("ab5eb40518"),d=i.n(c),u=i("1b4cdd6a36"),h=i.n(u),v=(i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36"),i("176815363d")),f=i.n(v),p=i("85d0a7609b"),g=i.n(p),y=i("7a5536c9bf"),m=i.n(y),b=i("8eec1e4a03"),S=i.n(b),M=i("3ef2352f0b"),E=i.n(M),C=(i("3bf1976a4f"),i("c6244f7705"),i("081c8cafea"),i("b1e2246d82"),i("dc6161bb20")),k=i("1d6e84dd0c"),w=i("f64f479582"),I=i("3825cc7c15"),x=i("22db601e95"),O=i("560bea0cc4"),A=i("ae00e26606"),L=i("82f2dc9440"),R=i.n(L),D=i("5fac0349d3");function T(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function P(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?T(Object(i),!0).forEach((function(t){g()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h()(e);if(t){var r=h()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return d()(this,i)}}var G=function(e){s()(n,e);var t,i=B(n);function n(){return r()(this,n),i.apply(this,arguments)}return a()(n,[{key:"getRegisterPlugins",value:function(){return[this.getSharePcPluginConfig()].concat(m()(this.getAuthPluginConfig()),m()(S()(h()(n.prototype),"getRegisterPlugins",this).call(this)))}},{key:"getAuthPluginConfig",value:function(){return[]}},{key:"getCallbackAdapter",value:function(){var e,t,i,r,o=this;return P(P({},S()(h()(n.prototype),"getCallbackAdapter",this).call(this)),{},{onAuthClick:(r=f()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.noEditService.getPlugin(O.b);case 2:null==(t=e.sent)||t.show({authUpdateCallback:function(){}});case 4:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)}),onBrowserReadRecord:(i=f()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.noEditService.getPlugin(k.a.name);case 2:null==(t=e.sent)||t.show();case 4:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),onDocSizeClick:(t=f()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.noEditService.getPlugin(w.a.name);case 2:null==(t=e.sent)||t.showDocSizePanel();case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),showShareModule:(e=f()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.noEditService.getPlugin(x.b);case 2:null==(t=e.sent)||t.show();case 4:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})})}},{key:"onInfrastructureDidReady",value:function(){S()(h()(n.prototype),"onInfrastructureDidReady",this).call(this),this.handleFileInfoAction(),this.handleQBConvertToOnlineTips(),this.initAuthPlugin()}},{key:"handleFileInfoAction",value:(t=f()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.noEditService.getPlugin(w.a.name);case 2:t=e.sent,"docSize"===Object(I.d)("showPanel")&&t&&setTimeout((function(){t.showDocSizePanel()}),1e3);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleQBConvertToOnlineTips",value:function(){if("qb"===Object(I.d)("from")&&"convertToOnlineDocTips"===Object(I.d)("feature")){var e=Object(I.d)("folderId");if(!e)return;R.a.show({type:"info",message:D.a.t("文档已保存在腾讯文档-来自QQ浏览器文件夹"),action:D.a.t("点击查看"),onClickAction:function(){var t,i="https://".concat(location.hostname,"/desktop/mydoc/folder/").concat(e);null===(t=window.log)||void 0===t||t.info("前往 QQ 浏览器文件夹：".concat(i)),location.href=i},duration:5e3})}}},{key:"initAuthPlugin",value:function(){var e=this,t=this.noEditService.getPluginSync(O.b);null==t||t.onAuthEvent(A.a.AUTH_EXP_TIME_CHANGE,(function(t){e.docInfoService&&(e.docInfoService.isAuthExpired=t)}))}}]),n}(C.a),j=i("547611bd96"),N=i.n(j),F=i("77c89fc0e0"),z=i("241849730e"),H=i("020899bf26");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h()(e);if(t){var r=h()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return d()(this,i)}}var W=function(e){s()(i,e);var t=U(i);function i(){var e;r()(this,i);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),g()(N()(e),"shareModule",void 0),e}return a()(i,[{key:"show",value:function(e){var t=this;this.shareModule?this.showShare(!1,e):F.h.load("Share",(function(i){t.shareModule=i,t.showShare(!0,e)}))}},{key:"hide",value:function(){var e=this;this.shareModule?this.shareModule.hide():F.h.load("Share",(function(t){e.shareModule=t,e.shareModule.hide()}))}},{key:"getAuthPluginName",value:function(){return O.b}},{key:"showShare",value:function(e,t){var i,n,r=this;"auth"===(null===(i=this.editExtensionService)||void 0===i?void 0:i.getDisplayRightSlideBarName())&&(null===(n=this.editExtensionService)||void 0===n||n.hideRightSideBar());if(this.showOrHideContainer(!0),e){var o,a=null!==(o=H.a.DocInfoManager())&&void 0!==o?o:{},l=a.domainId,s=a.padId,c=a.creatorDomain,d=a.isCreator,u=a.padType,h=d,v=this.getShareLink();this.shareModule.init(document.getElementById("doc-sharebox-container"),{invokeFrom:"detail",padId:s,shareLink:v,shareTitle:function(){var e;return null===(e=H.a.SlideTitleManager())||void 0===e?void 0:e.title},shareDocType:u,domainId:l,creatorDomain:c,havePermission:h,onAuthUpdated:function(e){null==t||t(e)},onClose:function(){r.showOrHideContainer(!1)}})}else this.shareModule.show({onAuthUpdated:function(e){null==t||t(e)},onClose:function(){r.showOrHideContainer(!1)}})}},{key:"showOrHideContainer",value:function(e){var t=document.getElementById("doc-sharebox-container");t&&(t.style.display=e?"block":"none")}}]),i}(z.a),_={name:x.b,plugin:W},Y=i("b168d1a453");function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h()(e);if(t){var r=h()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return d()(this,i)}}var K=function(e){s()(i,e);var t=V(i);function i(){return r()(this,i),t.apply(this,arguments)}return a()(i,[{key:"getAuthPluginConfig",value:function(){return[Y.a]}},{key:"getSharePcPluginConfig",value:function(){return _}}]),i}(G)},ff4ba1c4ac:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),s=i.n(l),c=(i("8e7cce0ada"),i("c6244f7705"),i("c9a7ecac4d"),i("85d48ef22b"),i("2a6f332b5e"),i("8ee19818c4"),function(){function e(){r()(this,e),s()(this,"isPasting",!1),s()(this,"pasteCallbacks",new Set)}return a()(e,[{key:"beforePaste",value:function(){this.isPasting=!0}},{key:"afterPaste",value:function(){this.isPasting=!1,this.executeCallbacks()}},{key:"checkIsPasting",value:function(){return this.isPasting}},{key:"executeAfterPaste",value:function(e){var t=this;return this.pasteCallbacks.add(e),function(){t.pasteCallbacks.delete(e)}}},{key:"executeCallbacks",value:function(){this.pasteCallbacks.forEach((function(e){return e()}))}}]),e}())},ff92deb735:function(e,t,i){"use strict";i.d(t,"a",(function(){return J}));i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36");var n,r,o,a,l,s,c,d,u,h,v,f,p,g,y,m,b,S,M,E=i("7a5536c9bf"),C=i.n(E),k=i("14502724a6"),w=i.n(k),I=i("1f925d7f50"),x=i.n(I),O=i("9132715560"),A=i.n(O),L=i("6a364eb35c"),R=i.n(L),D=i("85d0a7609b"),T=i.n(D),P=i("2dc700e1e6"),B=i.n(P),G=(i("f1054791f4"),i("826dc923b3"),i("7eaa8e90a5"),i("6e20b6a7d8"),i("3bf1976a4f"),i("8e7cce0ada"),i("c6244f7705"),i("081c8cafea"),i("85d48ef22b"),i("2a6f332b5e"),i("3dc760a4d9"),i("8ee19818c4"),i("75563bc376"),i("d5c3deb8c7")),j=i("9657b29818"),N=i("0e4dc96964"),F=i("382929c8da"),z=i("0e1cedb272"),H=i("3344f1a2e7"),U=i("54a7b7d7a1"),W=i("ea3a38d9d4"),_=i("daef0859e7"),Y=i("5cf98436e9"),V=i("016175442c"),K=i("c9c92622ff"),X=i("0442e400dc"),Q=i("23171a4a19");function Z(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(i),!0).forEach((function(t){T()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Z(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var J=(n=Reflect.metadata("design:type",String),r=Reflect.metadata("design:type",Number),o=Reflect.metadata("design:type",Number),a=Reflect.metadata("design:type",Number),l=Reflect.metadata("design:type",Number),s=Reflect.metadata("design:type",Number),c=Reflect.metadata("design:type",void 0===V.a?Object:V.a),d=Reflect.metadata("design:type",Array),u=Reflect.metadata("design:type",Number),h=function(){function e(t,n,r){var o=this;A()(this,e),x()(this,"alignmentType",v,this),x()(this,"marginLeft",f,this),x()(this,"textIndent",p,this),x()(this,"spaceBefore",g,this),x()(this,"spaceAfter",y,this),x()(this,"lineHeight",m,this),x()(this,"lineHeightType",b,this),x()(this,"tabList",S,this),x()(this,"tabSize",M,this),T()(this,"selectedArray",void 0),T()(this,"cachedTable",void 0),T()(this,"isEditing",void 0),T()(this,"ParagraphMoreDialog",void 0),T()(this,"selectionService",void 0),T()(this,"userPriviledgeService",void 0),T()(this,"editorInstanceService",void 0),T()(this,"tipsManager",void 0),T()(this,"getSelectedStyle",(function(){var e,t,i,n,r;if(o.isEditing){var a=w()(o.selectedArray,1)[0];r=Object(Y.a)(a)}else{var l,s,c;if(null===(l=o.selectionService)||void 0===l||!l.selectedElements.selectedArray)return;var d,u=null===(s=o.selectionService)||void 0===s?void 0:s.selectedElements.selectedArray,h=w()(u,1)[0];if(1!==(null===(c=o.selectionService)||void 0===c?void 0:c.selectedElements.selectedArray.length)||!Object(K.D)(h))h=new N.a({selectedModels:null===(d=o.selectionService)||void 0===d?void 0:d.selectedElements.selectedArray,selectionService:o.selectionService});r=Object(Y.a)(h)}if(r){o.setLineHeight(r),o.alignmentType=r[F.a.HORIZONTAL_ALIGN],o.marginLeft=Object(H.D)(parseFloat(null!==(e=r[F.a.MARGIN_LEFT])&&void 0!==e?e:0),2)/U.g,o.textIndent=Object(H.D)(parseFloat(null!==(t=r[F.a.TEXT_INDENT])&&void 0!==t?t:0),2)/U.g,o.spaceBefore=parseFloat(null!==(i=r[F.a.SPACE_BEFORE])&&void 0!==i?i:0)/U.g,o.spaceAfter=parseFloat(null!==(n=r[F.a.SPACE_AFTER])&&void 0!==n?n:0)/U.g;try{o.tabList=r[F.a.TAB_LIST].map((function(e){return q(q({},e),{},{position:e.position/U.g})}))}catch(e){o.tabList=[]}o.tabSize=parseFloat(r[F.a.TAB_SIZE])/U.g}})),T()(this,"clearSelection",(function(){var e;null===(e=o.selectionService)||void 0===e||e.selectedElements.clear()})),T()(this,"resetSelectedStyle",(function(){o.lineHeight=void 0,o.lineHeightType=void 0,o.alignmentType=void 0,o.marginLeft=void 0,o.textIndent=void 0,o.spaceBefore=void 0,o.spaceAfter=void 0})),T()(this,"cacheSelectedElements",(function(){var e,t,i=null===(e=o.selectionService)||void 0===e?void 0:e.selectedElements.selectedArray;o.selectedArray=null!==(t=null==i?void 0:i.concat())&&void 0!==t?t:[]})),T()(this,"cacheTable",(function(){var e,t,i,n=null===(e=o.selectionService)||void 0===e?void 0:e.selectedElements.selectedArray;if(!((null!==(t=null==n?void 0:n.length)&&void 0!==t?t:0)>1)){var r=n,a=w()(r,1)[0];Object(K.D)(a)&&(o.cachedTable=q(q({},null!==(i=a.selectedRange)&&void 0!==i?i:{}),{},{showSelection:a.showSelection}))}})),T()(this,"cacheSelection",(function(){var e;null!==(e=o.editorInstanceService)&&void 0!==e&&e.checkEditorIsEditing()?o.isEditing=!0:o.isEditing=!1})),T()(this,"resumeSelectedElements",(function(){var e,t,i;null!==(e=o.selectionService)&&void 0!==e&&e.selectedElements.selectedArray||(null===(t=o.selectionService)||void 0===t||(i=t.selectedElements).add.apply(i,C()(o.selectedArray)))})),T()(this,"resumeTable",(function(){var e,t,i;if(o.cachedTable&&null!==(e=o.selectionService)&&void 0!==e&&e.selectedElements.selectedArray&&null!==(t=o.selectionService)&&void 0!==t&&t.selectedElements.selectedArray.length){var n=null===(i=o.selectionService)||void 0===i?void 0:i.selectedElements.selectedArray,r=w()(n,1)[0];if(Object(K.D)(r)){if(o.isEditing){var a=o.cachedTable.rowStart,l=o.cachedTable.colStart,s=r.tableItems[a][l];s&&(s.isEditing=!0)}r.showSelection=o.cachedTable.showSelection,r.afterSelection(o.cachedTable.rowStart,o.cachedTable.colStart,o.cachedTable.rowEnd,o.cachedTable.colEnd)}}})),T()(this,"setLineHeight",(function(e){var t=e[F.a.LINE_HEIGHT_IS];if("absolute"===t){var i=parseFloat(e[F.a.ROW_SPACE_ABSOLUTE]);if(isNaN(i))return;o.lineHeight=i/2,o.lineHeightType=V.a.Fixed}else if("percent"===t){var n=parseFloat(e[F.a.ROW_SPACE]);if(isNaN(n))return;o.lineHeight=n,o.lineHeightType=V.a.Multi}})),this.uiDataService=t,this.linkManager=n,this.fontManager=r,Promise.all([i.e("commonAsync~9b1fde68"),i.e("commonAsync~27f19aac"),i.e("commonAsync~205ac551"),i.e("commonAsync~0c3a6025"),i.e("commonAsync~32e631b8"),i.e("commonAsync~08369118"),i.e("commonAsync~50db4bb8"),i.e("commonAsync~86c92fed"),i.e("commonAsync~a95f944a"),i.e("commonAsync~6e568190"),i.e("commonAsync~b174e5ca"),i.e("commonAsync~54a68610"),i.e("commonAsync~61b3c105"),i.e("commonAsync~f7b3ac00"),i.e("commonAsync~cece21d6"),i.e("commonAsync~ecbf7682"),i.e("commonAsync~6c5dfa7c"),i.e("commonAsync~90483627"),i.e("commonAsync~d2c096c2"),i.e("commonAsync~1285a477"),i.e("commonAsync~31ded9a0"),i.e("commonAsync~ecdbff9b"),i.e("commonAsync~c2cc425c"),i.e("commonAsync~4fb44df2"),i.e("commonAsync~d06fe423"),i.e("commonAsync~0519277e"),i.e("commonAsync~6df2b9ea"),i.e("commonAsync~b5c4f9e4"),i.e("commonAsync~ffdf5190"),i.e("commonAsync~127b6cf7"),i.e("commonAsync~b3c4a2ff"),i.e("commonAsync~19bb5a55"),i.e("async~493df0b3"),i.e("async~c5b24172"),i.e("async~0d51b00e"),i.e("async~beecf843"),i.e("async~2e2c6527"),i.e("async~da8db81f"),i.e("async~e10030d6"),i.e("async~098dcb65"),i.e("async~d0c14fe8"),i.e("async~7f8bedbf"),i.e("async~f40490b4"),i.e("async~2158e36e"),i.e("async~76acd586"),i.e("async~37d786cf"),i.e("async~30ccc425"),i.e("async~0c7d7381"),i.e("async~907e9098"),i.e("async~43172549"),i.e("async~f19eb79b"),i.e("async~95108331"),i.e("async~718865d2"),i.e("async~89b7a519"),i.e("vendors~lazyComponents")]).then(i.bind(null,"96873f9163")).then((function(e){o.ParagraphMoreDialog=e.default,o.ParagraphMoreDialog.setParagraphManager(o)})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))}return R()(e,[{key:"setTipsManagersDelegate",value:function(e){this.tipsManager||(this.tipsManager=e)}},{key:"setSelectionServiceDelegate",value:function(e){this.selectionService||(this.selectionService=e)}},{key:"setUserPriviledgeServiceDelegate",value:function(e){this.userPriviledgeService||(this.userPriviledgeService=e)}},{key:"setEditorInstanceServiceDelegate",value:function(e){this.editorInstanceService||(this.editorInstanceService=e)}},{key:"showParagraph",value:function(e){var t,i,n,r;this.cacheSelectedElements(),this.cacheTable(),this.cacheSelection(),this.getSelectedStyle(),null===(t=this.ParagraphMoreDialog)||void 0===t||t.show(q(q({userPriviledgeService:this.userPriviledgeService,tipsManager:this.tipsManager},e),{},{editorServices:{uiDataService:this.uiDataService,linkManager:this.linkManager,fontManager:this.fontManager,logicService:new Q.a}})),(null!==(i=null===(n=this.selectionService)||void 0===n||null===(r=n.selectedElements.selectedArray)||void 0===r?void 0:r.length)&&void 0!==i?i:0)>1&&this.clearSelection()}},{key:"hideParagraph",value:function(){var e;!this.elementNotExist()&&(this.resumeSelectedElements(),this.resumeTable(),this.resetSelectedStyle()),null===(e=this.ParagraphMoreDialog)||void 0===e||e.remove(),this.cachedTable=null,this.isEditing=!1}},{key:"updateUI",value:function(e){var t=this;if(0!==Object.entries(e).length&&!this.elementNotExist()){this.resumeSelectedElements(),this.resumeTable();var i=this.convertUpdatePropsToParagraphProps(e);if(this.isEditing){var n=w()(this.selectedArray,1)[0];if(Object(K.D)(n))return void this.handleMenuEvent(n,F.a.UPDATE_PARAGRAPH_PROPS,i);var r=Object(z.a)(n);if(!r)return;r.operations("paragraph-props",i)}else{var o,a=null===(o=this.selectionService)||void 0===o?void 0:o.selectedElements.selectedArray;if(!a)return;Object(j.b)((function(){a.forEach((function(n){t.updateElementParagraphProps(n,i,e)}))}))}}}},{key:"updateUIWithModel",value:function(e,t){var i,n=this;if(0!==Object.entries(e).length){var r=this.convertUpdatePropsToParagraphProps(e),o=null===(i=this.selectionService)||void 0===i?void 0:i.selectedElements.selectedArray;o&&Object(j.b)((function(){o.forEach((function(t){n.updateElementParagraphProps(t,r,e)}))}))}}},{key:"convertUpdatePropsToParagraphProps",value:function(e){var t=e.alignmentType,i=e.lineHeight,n=e.lineHeightType,r=e.marginLeft,o=e.textIndent,a=e.spaceBefore,l=e.spaceAfter,s=e.tabList,c=e.tabSize,d=n===V.a.Multi?"Multi":"Fixed",u={};return void 0!==i&&(u=q(q({},u),{},"Multi"===d?{lineHeight:i,PPTLineHeight:i,lineHeightIs:"percent"}:{lineHeight:i,lineHeightIs:"absolute",PPTLineHeight:void 0})),void 0!==r&&(u.marginLeft=Object(H.m)(r,2)),void 0!==o&&(u.textIndent=Object(H.m)(o,2)),void 0!==a&&(u.paddingTop=a,u.paddingTopIs="absolute"),void 0!==l&&(u.paddingBottom=l,u.paddingBottomIs="absolute"),void 0!==s&&(u.tabList=s),void 0!==c&&(u.tabSize=c),void 0!==t&&(u.textAlign=this.getTextAlign(t)),u}},{key:"handleMenuEvent",value:function(e,t,i){null!=i&&null!==t&&Object(_.b)(e,{menuType:W.a.TOOLBAR,actionType:t,values:i})}},{key:"elementNotExist",value:function(){var e=this;return!this.selectedArray.find((function(t){var i,n;return!(null===(i=e.selectionService)||void 0===i||null===(n=i.currentSlide)||void 0===n||!n.children.find((function(e){if(!e)return!1;return function e(i){return i===t||(Object(K.B)(i)?i===t:Object(K.n)(i)?i.children.some((function(t){return e(t)})):void 0)}(e)})))}))}},{key:"updateElementParagraphProps",value:function(e,t,i){var n=this;e&&(Object(K.n)(e)?e.children.forEach((function(e){return n.updateElementParagraphProps(e,t,i)})):this.handleMenuEvent(e,F.a.UPDATE_PARAGRAPH_PROPS,t))}},{key:"getTextAlign",value:function(e){var t;return(t={},T()(t,X.a.HORIZONTAL_LEFT,"left"),T()(t,X.a.HORIZONTAL_CENTER,"center"),T()(t,X.a.HORIZONTAL_RIGHT,"right"),T()(t,X.a.HORIZONTAL_JUSTIFY,"justify"),T()(t,X.a.HORIZONTAL_DISTRIBUTE,"distribute"),t)[e]}}]),e}(),v=B()(h.prototype,"alignmentType",[G.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=B()(h.prototype,"marginLeft",[G.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=B()(h.prototype,"textIndent",[G.q,o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=B()(h.prototype,"spaceBefore",[G.q,a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=B()(h.prototype,"spaceAfter",[G.q,l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=B()(h.prototype,"lineHeight",[G.q,s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=B()(h.prototype,"lineHeightType",[G.q,c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=B()(h.prototype,"tabList",[G.q,d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=B()(h.prototype,"tabSize",[G.q,u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h)}}]);
//# sourceMappingURL=slide-base~bc54f~30ccc425-a03c06.js.map
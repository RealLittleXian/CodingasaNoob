(this.webpackJsonp=this.webpackJsonp||[]).push([["base~37d786cf"],{"02ae07c580":function(e,n,t){"use strict";var a;t.d(n,"a",(function(){return a})),function(e){e.ADDON_HANDLER_IMPORT_READY="AddonHandlerImportReady",e.ADDON_INFO_LOAD_READY="AddonInfoLoadReady",e.ERROR_NETWORK="errorNetwork"}(a||(a={}))},"07d2fa51c2":function(e,n,t){"use strict";(function(e){var a=t("4f3b15d017");function i(e,n){var t="exportIframe-".concat(n),a=document.createElement("iframe");a.id=t,a.src="",a.style.display="none";var i=document.querySelector("#".concat(t));return i&&document.body.removeChild(i),document.body.appendChild(a),a.setAttribute("src",e),a}n.a=function(n){!a.default.isChrome||!a.default.isWindows||a.default.isWxWork||a.default.isWeChat?a.default.isWxWork?function(e){var n=document.createElement("a");n.id="linkDwnldLink",n.href=e;var t=document.getElementById("linkDwnldLink");t&&document.body.removeChild(t);document.body.appendChild(n),null==n||n.setAttribute("download",""),null==n||n.click()}(n):i(n):e.open(n,"_blank")||i(n)}}).call(this,t("5ef37df1a0"))},"0d31fb9b89":function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var a=t("9132715560"),i=t.n(a),c=t("85d0a7609b"),o=t.n(c),r=t("176815363d"),s=t.n(r),d=t("3ef2352f0b"),u=t.n(d),l=(t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),t("b1e2246d82"),t("d3d31c86eb")),f=function(){var e=s()(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55")]).then(t.bind(null,"39cb6f3a5e")));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function e(){i()(this,e)};o()(v,"reportAddonIframeClick",function(){var e=s()(u.a.mark((function e(n){var t,a,i,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return t=e.sent,a=t.DocAddonBridge,e.next=6,a.getAddon(n,{needInstalled:!1});case 6:i=e.sent,c=i.name,Object(l.c)({action:"clk",module:"iframe_container",opername:"doc_addon_use",ver6:n,ver7:c});case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())},"144183c5db":function(e,n,t){"use strict";t.d(n,"h",(function(){return a})),t.d(n,"i",(function(){return i})),t.d(n,"f",(function(){return c})),t.d(n,"e",(function(){return d})),t.d(n,"g",(function(){return u})),t.d(n,"a",(function(){return l})),t.d(n,"d",(function(){return f})),t.d(n,"c",(function(){return v})),t.d(n,"b",(function(){return m}));var a,i;!function(e){e.Null="Null",e.RoomStateChange="RoomStateChange",e.PlayerStateChange="PlayerStateChange"}(a||(a={})),function(e){e[e.RemoteChangePage=1]="RemoteChangePage",e[e.RemoteAllowFlipOn=2]="RemoteAllowFlipOn",e[e.RemoteAllowFlipOff=3]="RemoteAllowFlipOff",e[e.BeAudience=4]="BeAudience",e[e.LaserTrunOn=5]="LaserTrunOn",e[e.LaserTrunOff=6]="LaserTrunOff",e[e.PrevPage=7]="PrevPage",e[e.NextPage=8]="NextPage",e[e.ExitShow=9]="ExitShow",e[e.TurnLaser=10]="TurnLaser",e[e.SyncWithMaster=11]="SyncWithMaster",e[e.PopWindowShow=12]="PopWindowShow",e[e.PopWindowHide=13]="PopWindowHide",e[e.ShowPlayerContent=14]="ShowPlayerContent",e[e.LiveBegin=15]="LiveBegin",e[e.ZoomIn=16]="ZoomIn",e[e.ZoomOut=17]="ZoomOut",e[e.ToggleView=18]="ToggleView",e[e.RemoteLaserMove=19]="RemoteLaserMove",e[e.RemoteStopMainAnim=20]="RemoteStopMainAnim",e[e.MediaStateChanged=21]="MediaStateChanged",e[e.TurnAnnotation=22]="TurnAnnotation",e[e.AnnotationMessage=23]="AnnotationMessage"}(i||(i={}));var c,o,r,s,d,u,l,f,v,m;!function(e){e[e.PlayerState=1]="PlayerState",e[e.GotoPageFragment=2]="GotoPageFragment",e[e.PlayerReady=3]="PlayerReady",e[e.MobileOpenToolBar=4]="MobileOpenToolBar",e[e.EndPlay=5]="EndPlay",e[e.Loading=6]="Loading",e[e.Error=7]="Error",e[e.LinkClicked=8]="LinkClicked",e[e.DataLoading=9]="DataLoading",e[e.CancelDataLoading=10]="CancelDataLoading",e[e.PlayerMouseMove=11]="PlayerMouseMove",e[e.Media=12]="Media",e[e.TurnLaser=14]="TurnLaser",e[e.TurnAnnotation=15]="TurnAnnotation",e[e.AnnotationMessage=16]="AnnotationMessage"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Master=1]="Master",e[e.Audience=2]="Audience"}(o||(o={})),function(e){e[e.None=0]="None",e[e.OnAir=1]="OnAir",e[e.Pause=2]="Pause",e[e.Ended=3]="Ended"}(r||(r={})),function(e){e[e.None=0]="None",e[e.YES=2]="YES",e[e.NO=1]="NO"}(s||(s={})),function(e){e.None="None",e.Local="Local",e.MeetingRoom="MeetingRoom",e.InEditor="InEditor",e.TOBPlayer="tobplayer",e.RemoteControl="remoteControl"}(d||(d={})),function(e){e.NONE="0",e.MASTER="1",e.AUDIENCE="2"}(u||(u={})),function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.DOC=0]="DOC",e[e.SLIDE=4]="SLIDE",e[e.PDF=6]="PDF"}(l||(l={})),function(e){e[e.PLAY=1]="PLAY",e[e.AUDIENCE_WAIT=2]="AUDIENCE_WAIT",e[e.CLOSED=3]="CLOSED",e[e.INIT_LOADING=10]="INIT_LOADING",e[e.AUDIENCE_LOADING=20]="AUDIENCE_LOADING",e[e.ERROR_PAGE=99]="ERROR_PAGE",e[e.PLAYER_LOADING=150]="PLAYER_LOADING",e[e.ROOM_FULL=60010]="ROOM_FULL",e[e.ROOM_CLOSE=70010]="ROOM_CLOSE"}(f||(f={})),function(e){e[e.ROOM_READY=1]="ROOM_READY",e[e.PLAYER_LOADING=2]="PLAYER_LOADING",e[e.PLAYER_CANCEL_LOADING=3]="PLAYER_CANCEL_LOADING",e[e.MEETING_CLOSE=4]="MEETING_CLOSE",e[e.MEETING_ERROR=5]="MEETING_ERROR",e[e.AUDIENCE_WAIT=6]="AUDIENCE_WAIT"}(v||(v={})),function(e){e.SPEAKER="speaker",e.AUDIENCE="audience"}(m||(m={}))},"17b68c2613":function(e,n,t){"use strict";var a=t("176815363d"),i=t.n(a),c=t("9132715560"),o=t.n(c),r=t("6a364eb35c"),s=t.n(r),d=t("85d0a7609b"),u=t.n(d),l=t("3ef2352f0b"),f=t.n(l),v=(t("c6244f7705"),t("081c8cafea"),t("1bab7b5fb7"),t("9d7978d445"),t("a2a09da1e3"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),t("b1e2246d82"),t("9d0daf5c3f"),t("963f2eaace"),t("3bf1976a4f"),t("d9812f1c6f")),m=t("5fac0349d3"),h=t("f4e4ed5c17"),y=t("07d2fa51c2"),p=t("020899bf26"),b=function(){function e(){o()(this,e),u()(this,"timerId",void 0),u()(this,"loading",void 0)}var n;return s()(e,[{key:"downloadImg",value:function(e){var n,t;e?window.navigator.onLine?this.download(e):this.showNetWorkError():null===(n=window)||void 0===n||null===(t=n.log)||void 0===t||t.info("图片下载 src为空")}},{key:"downloadMutiImageToZip",value:(n=i()(f.a.mark((function e(n){var t,a,i,c,o,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null!==(t=p.a.DocInfoManager())&&void 0!==t?t:{},i=a.padId,c=a.domainId,e.prev=1,e.next=4,h.a.post("/v1/export/sheet/image/".concat(i),n,{params:{domainId:c}});case 4:o=e.sent,r=o.data,this.startQuery(r.operationId),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),this.stopQuery(),this.showNetWorkError();case 13:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return n.apply(this,arguments)})},{key:"getTypeToSuffix",value:function(e){var n=e.split("/")[1],t=-1===n.indexOf("+")?n:n.split("+")[0];return".".concat(t)}},{key:"showNetWorkError",value:function(){v.a.isMobile?Promise.resolve().then(t.t.bind(null,"b74ee0edd6",7)).then((function(e){e.default.show({message:m.a.t("下载失败请稍后再试。"),duration:3e3})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})):Promise.resolve().then(t.t.bind(null,"82f2dc9440",7)).then((function(e){e.default.show({message:m.a.t("下载失败请稍后再试。"),duration:3e3})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))}},{key:"showRequestTimeout",value:function(){v.a.isMobile?Promise.resolve().then(t.t.bind(null,"b74ee0edd6",7)).then((function(e){e.default.show({message:m.a.t("请求超时"),duration:3e3})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})):Promise.resolve().then(t.t.bind(null,"82f2dc9440",7)).then((function(e){e.default.show({message:m.a.t("请求超时"),duration:3e3})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))}},{key:"downloadVideo",value:function(e){var n=this;Object(h.a)("/v2/file/attachment/detail",{headers:{"Content-Type":"application/json; charset=UTF-8"},method:"POST",data:{access_type:0,obj_keys:[e]}}).then((function(e){n.downloadVideoResolve(e)})).catch((function(){n.showNetWorkError()}))}},{key:"downloadVideoResolve",value:function(e){var n=e.data;if("success"===(null==n?void 0:n.msg)){var t=n.result.detail;if(Array.isArray(t)&&t[0]){var a=t[0],i=a.downloadUrl,c=a.name,o=a.ext;this.download(i,c,o)}}else this.showNetWorkError()}},{key:"download",value:function(e,n,t){var a=this;if(e){var i=0,c=new XMLHttpRequest;c.responseType="blob",c.onload=function(){a.xhrOnloadAfterSendForDownload(c,n,t)},c.onerror=function(){i=a.xhrOnerrorAfterSendForDownload(c,e,i)},c.open("GET",e,!0),c.send()}}},{key:"xhrOnloadAfterSendForDownload",value:function(e,n,t){if(200!==e.status&&304!==e.status||!e.response)this.showNetWorkError();else{var a=(window.URL?window.URL:window.webkitURL).createObjectURL(e.response),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=a;var c=t?".".concat(t):this.getTypeToSuffix(e.response.type);this.getTypeToSuffix(e.response.type),this.checkBlobLocalPathForDownload(a,i,c,n),i.click(),setTimeout((function(){document.body.removeChild(i),(window.URL?window.URL:window.webkitURL).revokeObjectURL(a)}),1e3)}}},{key:"checkBlobLocalPathForDownload",value:function(e,n,t,a){if(e){var i=e.split("/");a?n.download=a+t:i.length>1?n.download=i.slice(-1)+t:n.download="".concat(m.a.t("未命名")).concat(t)}}},{key:"xhrOnerrorAfterSendForDownload",value:function(e,n,t,a){return e.open("GET",a||n,!0),0===t?(e.send(),t+=1):this.showNetWorkError(),t}},{key:"startQuery",value:function(e){var n=this;this.showLoading();var t=Date.now();this.timerId=setInterval(i()(f.a.mark((function a(){var i,c,o,r,s;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(Date.now()-t>6e4)){a.next=4;break}return n.stopQuery(),n.showRequestTimeout(),a.abrupt("return");case 4:return a.prev=4,c=null!==(i=p.a.DocInfoManager())&&void 0!==i?i:{},o=c.padId,a.next=8,h.a.get("/v1/export/sheet/image/progress/".concat(o),{params:{operationId:e}});case 8:if(r=a.sent,s=r.data,n.checkCgiResult(s)){a.next=12;break}return a.abrupt("return");case 12:s.url&&(n.stopQuery(),Object(y.a)(s.url)),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(4),n.stopQuery(),n.showNetWorkError();case 19:case"end":return a.stop()}}),a,null,[[4,15]])}))),1e3)}},{key:"stopQuery",value:function(){this.closeLoading(),this.timerId&&(clearInterval(this.timerId),this.timerId=null)}},{key:"checkCgiResult",value:function(e){return 0===e.ret||(this.stopQuery(),!1)}},{key:"showLoading",value:function(){var e=this;Promise.resolve().then(t.t.bind(null,"3404d6c52c",7)).then((function(n){e.loading=n.default.show({tip:m.a.t("正在下载，请稍候...")})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))}},{key:"closeLoading",value:function(){var e;null===(e=this.loading)||void 0===e||e.close()}}]),e}(),g=new b;n.a=g},"19f0bdbef9":function(e,n,t){"use strict";var a,i=t("176815363d"),c=t.n(i),o=t("3ef2352f0b"),r=t.n(o),s=(t("c6244f7705"),t("081c8cafea"),t("0d2ffd3bdb")),d=(t("b1e2246d82"),t("963f2eaace"),t("8fa580e5fd"),t("48cf2b24ba")),u=t("dd1b838932"),l=t("020899bf26"),f=t("3bd887f5ab");function v(){return m.apply(this,arguments)}function m(){return(m=c()(r.a.mark((function e(){var n,t,a,i,c,o,s,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.extensionService.getExtension(f.a.name);case 2:n=e.sent,t=l.a.DocInfoManager()||{},a=t.domainId,i=t.padId,c=t.localPadId,o=Object(u.getPathname)(),s=o.slice(o.lastIndexOf("/")+1),v={padType:d.a.Slide,domainId:a,docId:s,padId:i||c},n.show(v);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.TemplateMall="templatemall",e.Vip="vip",e.Desktop="desktop"}(a||(a={}));var h,y,p=t("37091e4240"),b=Object(s.createExtensionService)({metadataLoaderOptions:{specifiedVersion:1}}),g={initPromise:new Promise((function(e){return h=e})),extensionService:b,init:(y=c()(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.scanAndHandleExtensions(n);case 2:h(),p.b.onIncludingPast(p.a.VISIBLE_PAGE_DISPLAY,(function(){v()}));case 4:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},A=n.a=g},"1a11bac27f":function(e,n,t){"use strict";t.d(n,"a",(function(){return S}));var a=t("176815363d"),i=t.n(a),c=t("9132715560"),o=t.n(c),r=t("6a364eb35c"),s=t.n(r),d=t("85d0a7609b"),u=t.n(d),l=t("3ef2352f0b"),f=t.n(l),v=(t("c6244f7705"),t("081c8cafea"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36"),t("4f3b15d017")),m=t("0e41c725b0"),h=t("ac50752089"),y=t("3825cc7c15");function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function b(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){u()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var g={doc:0,sheet:1,form:2,slide:3,mind:4,flowchart:5},A=function(){function e(){var n=this;o()(this,e),u()(this,"positionX",0),u()(this,"positionY",0),u()(this,"handleTopMenuPosition",(function(e){e.stopPropagation(),e.preventDefault(),n.positionX=e.screenX-e.clientX+window.innerWidth-324-5,n.positionY=e.screenY-e.clientY+56}))}var n,t;return s()(e,[{key:"searchContacts",value:(t=i()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"showDiscussWindow",value:function(e){var n,t;null===(n=m.e.tdocs)||void 0===n||null===(t=n.showDiscussWindow)||void 0===t||t.call(n,b({positionType:"rightBottom"},e))}},{key:"hideOneDiscussWindow",value:function(){var e,n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null===(e=m.e.tdocs)||void 0===e||null===(n=e.hideOneDiscussWindow)||void 0===n||n.call(e,{docId:t})}},{key:"destroyDiscussWindow",value:function(e){var n,t;null===(n=m.e.tdocs)||void 0===n||null===(t=n.destroyDiscussWindow)||void 0===t||t.call(n,e)}},{key:"notifyPush",value:function(e){var n,t,a=e.docId,i=e.conversationList,c=e.isNeedPush,o=void 0===c||c;null===(n=m.e.tdocs)||void 0===n||null===(t=n.notifyPush)||void 0===t||t.call(n,{isNeedPush:o,docId:a,conversationList:i})}},{key:"getFocusWindowHandle",value:function(){return""}},{key:"wwappDocOnOpenMenu",value:function(e){var n=window.clientVars,t=n.padId,a=n.creatorId,i=n.title,c=n.padType,o=b({docId:t,title:i,creatorVid:a,docType:g[c]||0,platformType:3,shareCode:Object(y.d)("scode")||""},e);if(2===e.menuType)this.forwardToWwapp(o)}},{key:"urlChange",value:function(e){var n,t;null===(n=(t=window.qmailBridge).urlChange)||void 0===n||n.call(t,e)}},{key:"forwardToWwapp",value:(n=i()(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.default.isTencentMeeting){e.next=7;break}return e.next=3,Object(h.c)();case 3:return e.sent.remixApp.execRemixAppCmd({cmd:"wwapp.meetdoc.forwardDoc",data:b(b({},n),{},{positionX:this.positionX,positionY:this.positionY,positionType:"leftTop",hideDiscussWindow:1})}),e.abrupt("return");case 7:m.e.tdocs.quoteToDiscuss(n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),e}(),S=new A},"1cc9d00e0c":function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a={NotHandle:"0",NotPass:"1",Pass:"2"}},"1d6e84dd0c":function(e,n,t){"use strict";t.d(n,"a",(function(){return C}));t("73b854064b");var a=t("176815363d"),i=t.n(a),c=t("9132715560"),o=t.n(c),r=t("6a364eb35c"),s=t.n(r),d=t("547611bd96"),u=t.n(d),l=t("bd29e2df90"),f=t.n(l),v=t("ab5eb40518"),m=t.n(v),h=t("1b4cdd6a36"),y=t.n(h),p=t("85d0a7609b"),b=t.n(p),g=t("3ef2352f0b"),A=t.n(g),S=(t("3bf1976a4f"),t("c6244f7705"),t("081c8cafea"),t("1bab7b5fb7"),t("34cd92f77a"),t("b1e2246d82"),t("659f690fe6")),w=t("77c89fc0e0");function k(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=y()(e);if(n){var i=y()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return m()(this,t)}}var I="read-record",E=function(e){f()(t,e);var n=k(t);function t(e){var a;return o()(this,t),a=n.call(this),b()(u()(a),"readRecordPlugin",void 0),a.readRecordPlugin=e,a}return s()(t,[{key:"name",get:function(){return I}},{key:"show",value:function(){var e=this;this.readRecordPlugin.showModule(this.DOMNode,(function(){e.showWrapper()}),(function(){e.hideWrapper()})).then((function(){}))}},{key:"wrapperDidHide",value:function(){this.readRecordPlugin.removeModule()}}]),t}(w.g),M=t("19f0bdbef9"),P=t("e7c4e8f59c"),D=t("8b13fcae36"),O=t("020899bf26");function x(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=y()(e);if(n){var i=y()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return m()(this,t)}}var T=function(e){f()(a,e);var n,t=x(a);function a(){var e;o()(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),b()(u()(e),"extension",void 0),e}return s()(a,[{key:"initPlugin",value:function(){var e;null===(e=this.editExtensionService)||void 0===e||e.registerRightSideBarModule(new E(this))}},{key:"showModule",value:(n=i()(A.a.mark((function e(n,t,a){var i,c,o,r,s,d;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=O.a.DocInfoManager()||{},c=i.userId,o=i.domainId,r=i.padId,s=i.creatorDomain,d=null==c?void 0:c.replace(/^p\./,""),e.next=4,M.a.extensionService.getExtension(P.a.name);case 4:this.extension=e.sent,this.extension.show({container:n,creatorDomain:s,domainId:o,padId:r,userId:d,onClose:a}),null==t||t();case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return n.apply(this,arguments)})},{key:"removeModule",value:function(){var e;null===(e=this.extension)||void 0===e||e.hide(),this.extension=void 0}},{key:"show",value:function(){var e;null===(e=this.editExtensionService)||void 0===e||e.showRightSideBar(I)}},{key:"showOnMobile",value:function(){var e=O.a.DocInfoManager()||{},n=e.domainId,t=e.padId,a=e.creatorDomain,i="padId=".concat(t,"&domId=").concat(n,"&cd=").concat(a);if(w.i.isMiniProgram)window.wx&&window.wx.miniProgram.navigateTo({url:"/pages/readRecord/readRecord?".concat(i)});else if(window.mqq){var c,o,r;null===(c=window.mqq)||void 0===c||null===(o=c.ui)||void 0===o||null===(r=o.openUrl)||void 0===r||r.call(o,{url:"https://".concat(window.hostname,"/components/docs/ReadRecord.html?").concat(i,"&_wv=3&from=desktop_m"),target:1,style:1})}else{var s="https://".concat(window.hostname,"/components/docs/ReadRecord.html?").concat(i,"&_wv=3&from=desktop_m");Object(D.setNewWindowUrl)(window,s)}}}]),a}(S.a),C={name:"no-edit-read-record",plugin:T}},"22db601e95":function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));var a="no-edit-share-mobile",i="no-edit-share-pc"},"241849730e":function(e,n,t){"use strict";t.d(n,"a",(function(){return b}));t("73b854064b");var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("bd29e2df90"),s=t.n(r),d=t("ab5eb40518"),u=t.n(d),l=t("1b4cdd6a36"),f=t.n(l),v=(t("4bbb5840d5"),t("659f690fe6")),m=(t("1bab7b5fb7"),t("9d7978d445"),t("a2a09da1e3"),t("77c89fc0e0")),h=t("5de93315c1"),y=t("020899bf26");function p(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=f()(e);if(n){var i=f()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return u()(this,t)}}var b=function(e){s()(t,e);var n=p(t);function t(){return i()(this,t),n.apply(this,arguments)}return o()(t,[{key:"initPlugin",value:function(){}},{key:"getShareLink",value:function(e){return function(e){var n=window.clientVars.shortLink||window.location.href.split("#")[0];if(e)return n;if(-1===n.indexOf("?"))return n;var t=n.split("?")[1],a=n.split("?")[0];return t?a:n}(e)}},{key:"navigateToSharePanel",value:function(){if(m.i.isMiniProgram&&window.wx&&window.wx.miniProgram){var e=this.getMiniProgramSharePanelUrl();window.wx.miniProgram.navigateTo({url:e})}}},{key:"getMiniProgramSharePanelUrl",value:function(){var e,n,t,a,i,c=window.location.href;null!==(e=window.basicClientVars)&&void 0!==e&&null!==(n=e.docInfo)&&void 0!==n&&n.shareLink&&((c=window.basicClientVars.docInfo.shareLink).startsWith("https:")||(c="https:".concat(c)));var o=this.getUserInfo(),r=(null==o?void 0:o.avatar)||"",s=(null==o?void 0:o.nick)||"",d=null==o?void 0:o.uid,u=(null===(t=this.getAuthPlugin())||void 0===t?void 0:t.getAuth().isAuthExpired())||!1,l=null!==(a=y.a.DocInfoManager())&&void 0!==a?a:{},f=l.policy,v=l.padType,h=l.isCreator,p=l.padId,b=l.domainId,g=l.creatorDomain,A=(null!==(i=y.a.SlideTitleManager())&&void 0!==i?i:{}).title,S=void 0===A?"":A;return c=Object(m.n)(c,"__wxjs_environment"),c=Object(m.n)(c,"user_info"),c=Object(m.n)(c,"session"),c=Object(m.n)(c,"uid"),c=Object(m.n)(c,"uid_key"),c=Object(m.n)(c,"disableReturnList"),c=Object(m.n)(c,"TOK"),c=Object(m.n)(c,"receive"),c=Object(m.n)(c,"_r"),c=Object(m.n)(c,"_from"),c=Object(m.n)(c,"_localnum"),c=Object(m.n)(c,"fromTrash"),Object(m.p)("/pages/sharePanel/sharePanel",{padId:p,domainId:b,type:4,isCreator:h,padType:v,title:encodeURIComponent(S),url:encodeURIComponent(c),creatorDomain:g,owner_avatar:encodeURIComponent(r),owner_username:encodeURIComponent(s),owner_uid:d,isAuthExpExpire:u,hasWatermark:!1,guestPolicy:f,detailShare:"1"})}},{key:"getAuthPluginName",value:function(){return""}},{key:"getAuthPlugin",value:function(){var e;return null===(e=this.noEditService)||void 0===e?void 0:e.getPluginSync(this.getAuthPluginName())}},{key:"getUserInfo",value:function(){var e,n=null===(e=this.noEditService)||void 0===e?void 0:e.getPluginSync(h.a);return null==n?void 0:n.userInfo}}]),t}(v.a)},"320fc6c21b":function(e,n,t){"use strict";var a;function i(e){window.parent.postMessage({type:a.STATUS_REPORT,data:{isSuccess:e}},"*")}t.d(n,"a",(function(){return i})),function(e){e.STATUS_REPORT="DRIVE_MESSAGE_STATUS_REPORT"}(a||(a={}))},"33effab29b":function(e,n,t){"use strict";t.d(n,"a",(function(){return k}));var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("85d0a7609b"),s=t.n(r),d=(t("1bab7b5fb7"),t("9d7978d445"),t("b8217400dc"),t("e6f68cdf2e"),t("4f3b15d017")),u=t("70c6f3b867"),l=t("176815363d"),f=t.n(l),v=t("3ef2352f0b"),m=t.n(v),h=(t("3bf1976a4f"),t("c6244f7705"),t("081c8cafea"),t("f4e4ed5c17")),y=t("798a9cd6f2"),p=[].concat(["chooseImage","getLocalImgData"],["getClipboardData","setClipboardData"]),b=function(){function e(){var n=this;i()(this,e),s()(this,"jssdk",y.e.LIBRARY.WX_JS_SDK_1_6_0),s()(this,"appId","wx46dfe750eef96da7"),s()(this,"hasLoadedSDK",(function(){if(void 0!==window.wx&&window.WeixinJSBridge)return!0})),s()(this,"waitingForDomMounted",(function(){return new Promise((function(e){var n,t;if(null!==(n=window)&&void 0!==n&&null!==(t=n.document)&&void 0!==t&&t.readyState){var a=window.document.readyState;"complete"===a&&e(),"loading"!==a&&"interactive"!==a||window.document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&e()}))}else e()}))})),s()(this,"loadScript",(function(){return new Promise((function(e,t){var a=document.createElement("script");a.src=n.jssdk,document.head.appendChild(a),a.onload=e,a.onerror=t}))}))}var n,t,a,c;return o()(e,[{key:"init",value:(c=f()(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.default.isWeChat&&!d.default.isWxMiniProgram){e.next=3;break}return e.next=3,this.setWxJsApi();case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"loadJSSDK",value:(a=f()(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasLoadedSDK()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadScript();case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setWxJsApi",value:(t=f()(m.a.mark((function e(){var n,t,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.log.info("get in wx init setWxJsApi"),e.next=4,this.waitingForDomMounted();case 4:return e.next=6,this.loadJSSDK();case 6:return e.next=8,this.getSignature();case 8:n=e.sent,t=n.noncestr,a=n.signature,i=n.timestamp,window.wx.config({debug:!1,appId:this.appId,nonceStr:t,timestamp:i,signature:a,jsApiList:p}),window.wx.error((function(e){return window.log.info("wx set jsApiList fail, error msg: ".concat(JSON.stringify(e)))})),window.wx.ready((function(){return window.log.info("wx setWxJsApi success")})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),window.log.error("setWxJsApi init error",e.t0);case 18:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return t.apply(this,arguments)})},{key:"getSignature",value:(n=f()(m.a.mark((function e(){var n,t,a,i,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("/v2/util/wechat/signature",{withCredentials:!0,params:{url:this.getPageOriginHref()}});case 2:if(n=e.sent,t=n.data,a=t.cgicode,i=t.retcode,c=t.msg,0===a&&0===i){e.next=6;break}throw new Error("wx get signature error, retcode: ".concat(i,", error msg: ").concat(c));case 6:return e.abrupt("return",n.data);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getPageOriginHref",value:function(){return d.default.isWeChat&&window.__originUrl?window.__originUrl:window.location.href}}]),e}(),g=new b,A=t("7e61746219"),S=t("05d181ac40"),w=t("a42b29265b"),k=function(){function e(){i()(this,e),s()(this,"onClipboardManagerInit",(function(){g.init()}))}return o()(e,[{key:"registerCustomCopyPasteListeners",value:function(e){}},{key:"supportAsyncClipboardApi",get:function(){var e,n,t,a=d.default.isSafari&&+(null!==(e=null===(n=Object(u.d)("Version",d.default.userAgent))||void 0===n||null===(t=n.split("."))||void 0===t?void 0:t[0])&&void 0!==e?e:0)<14,i=d.default.isFirefox||d.default.isQQBrowser||a;return d.default.isMobile||!i||this.isCEFBrowser()}},{key:"useMemoryClipboard",get:function(){var e=d.default.isQQ||d.default.isQQMiniProgram,n=d.default.isWxMiniProgram&&Object(A.e)(),t=d.default.isWxWorkPrivate||d.default.isWxWork;return e||n||t}},{key:"shouldDownloadToLocal",get:function(){return S.a.IS_LOCAL_EDIT}},{key:"enableImageRecovery",get:function(){return!S.a.IS_LOCAL_EDIT}},{key:"disableCopy",value:function(e){return!1}},{key:"useSrcImg",value:function(e){return e===w.b.Version3&&S.a.IS_LOCAL_EDIT}},{key:"currentEnvIsInPrivate",get:function(){return!1}},{key:"showClipboardProtection",value:function(){}},{key:"isCEFBrowser",value:function(){return d.default.isChrome||d.default.isChromiumEdge||d.default.isElectronTencentDocsClient||d.default.userAgent.includes("WeComCEF")||d.default.userAgent.includes("MailPlugin_Electron")}}]),e}()},"37f5e38cda":function(e,n,t){"use strict";t.d(n,"a",(function(){return ce}));t("73b854064b");var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("547611bd96"),s=t.n(r),d=t("bd29e2df90"),u=t.n(d),l=t("ab5eb40518"),f=t.n(l),v=t("1b4cdd6a36"),m=t.n(v),h=t("85d0a7609b"),y=t.n(h),p=t("4875ff98b0"),b=t("9f15603575"),g=t("98c2de1441"),A=t("05d181ac40"),S=t("6168a1bafd"),w=t("2ef9a3e750"),k=t("cbac204f34"),I=t("176815363d"),E=t.n(I),M=t("3ef2352f0b"),P=t.n(M),D=(t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),{name:"export-manager",loadType:"on-demand",module:function(){return E()(P.a.mark((function e(){var n,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"108cf2806f"));case 2:return n=e.sent,a=n.ExportManager,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}}),O=t("8dab50a41c"),x=t("b7888730ab"),T={name:"url-param-manager",loadType:"on-demand",module:function(){return E()(P.a.mark((function e(){var n;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"f645f3a43b"));case 2:return n=e.sent.default,e.abrupt("return",new n);case 4:case"end":return e.stop()}}),e)})))()}},C=t("02598f7304"),R=t("7b50d7e0b8"),L=t("b66b5ce3da"),_=t("2d25e86360"),j=t("0a85af1b73"),N=t("a3fbf19e57"),U={name:"anonymous-view",loadType:"on-demand",module:function(){return E()(P.a.mark((function e(){var n,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e(21)]).then(t.bind(null,"2026a1094a"));case 2:return n=e.sent,a=n.AnonymousViewService,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}},F=(t("3bf1976a4f"),t("1cc9d00e0c")),B=t("db0c73f5df"),H=t("f4e4ed5c17"),G=t("798a9cd6f2"),W=t("020899bf26"),z=t("872ba9d13a"),V=t("8f58e78419"),q=t.n(V),K=t("a9e0ee82c1"),Y=t.n(K),Q=t("73e651ca0f"),X=(t("1bab7b5fb7"),t("9d7978d445"),t("d9812f1c6f")),J=t("915616c11c"),$=function(e,n,t){var a=window.location.href.split("#")[0];if(X.a.isMiniProgram){var i=function(e,n){var t=window.location.href.split("#")[0],a="/pages/followEditGuide/followEditGuide?";return a+="ownerNick=".concat(e,"&requestPermitType=").concat(n),a+"&url=".concat(encodeURIComponent(t))}(e,n);window.wx.miniProgram.redirectTo({url:i})}else Object(J.a)({replace:!0,url:"https://".concat(window.location.hostname,"/scenario/followGuide.html?nick=").concat(e,"&disableActionButtons=").concat(t,"&requestPermitType=").concat(n,"&url=").concat(encodeURIComponent(a))})},Z=t("cc17a96b7f"),ee=function(){function e(n){i()(this,e),y()(this,"mApplyInfo",void 0),this.inject=n}var n,t;return o()(e,[{key:"init",value:(t=E()(P.a.mark((function e(){var n,t,a,i,c,o;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null!==(n=W.a.DocInfoManager())&&void 0!==n?n:{},a=t.domainId,i=void 0===a?"":a,c=t.padId,o=void 0===c?"":c,e.next=3,this.checkIsApplyIn24H(i,o);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleApplyEdit",value:function(){var e=this;if(this.hasApplied){var n,t=null===(n=W.a.DocInfoManager())||void 0===n?void 0:n.docInfo;$((null==t?void 0:t.owner_nick)||"","edit",this.inject.shouldDisableGuideBtns())}else{Object(Q.a)({onSubmitted:function(){e.mApplyInfo={hasApplied:!0,applyResult:F.a.NotHandle}}})}}},{key:"canApplyEdit",value:function(){if(!Object(z.a)())return!1;var e=q()(window.clientVars,"privilegeAttribute.can_apply_edit");return!!Y()(e)||e}},{key:"checkIsApplyIn24H",value:(n=E()(P.a.mark((function e(n,t){var a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={hasApplied:!1,applyResult:""},Object(Z.a)()){e.next=5;break}return e.next=4,H.a.get("".concat(this.getApplyCGI(),"?domainId=").concat(n,"&localPadId=").concat(t,"&xsrf=").concat(Object(B.b)(),"&bkn=").concat(Object(B.a)())).then((function(e){var n,t,a=e.data,i=!1,c="";return null!==(n=a)&&void 0!==n&&null!==(t=n.result)&&void 0!==t&&t.retcode&&(a=a.result),a&&10004===a.retcode&&(i=!0,"0"===a.pass?c=F.a.NotPass:"1"===a.pass?c=F.a.Pass:a.pass||(c=F.a.NotHandle),"0"===a.rightFlag&&(c=F.a.NotPass)),{hasApplied:i,applyResult:c}})).catch((function(){return{hasApplied:!1,applyResult:""}}));case 4:a=e.sent;case 5:return this.mApplyInfo=a,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"hasApplied",get:function(){return this.applyInfo.hasApplied}},{key:"applyInfo",get:function(){return this.mApplyInfo}},{key:"getApplyCGI",value:function(){var e=G.e.API_ROOT;return"".concat(e).concat(this.inject.getApplyCGI())}}]),e}(),ne=function(){function e(){i()(this,e)}return o()(e,[{key:"getApplyCGI",value:function(){return"cgi-bin/online_docs/auth_apply/check"}},{key:"shouldDisableGuideBtns",value:function(){return!1}}]),e}(),te=t("7e61746219"),ae=t("929e788f0c");function ie(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=m()(e);if(n){var i=m()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return f()(this,t)}}var ce=function(e){u()(a,e);var n=ie(a);function a(e,c){var o;return i()(this,a),o=n.call(this,e,c),y()(s()(o),"switchPageMonitor",void 0),y()(s()(o),"openClientApiManager",void 0),y()(s()(o),"exportImageManager",void 0),y()(s()(o),"exportManager",void 0),y()(s()(o),"canvasService",void 0),y()(s()(o),"noteAreaService",void 0),y()(s()(o),"cursorManager",void 0),y()(s()(o),"updateNoticeManager",void 0),y()(s()(o),"urlParamManager",void 0),y()(s()(o),"psKeyManager",void 0),y()(s()(o),"applyAuthService",void 0),y()(s()(o),"workbenchService",void 0),y()(s()(o),"vipInfoService",void 0),y()(s()(o),"produceBackupManager",void 0),y()(s()(o),"printService",void 0),y()(s()(o),"anonymousViewService",void 0),y()(s()(o),"screenshotManager",void 0),y()(s()(o),"registerManager",void 0),o.initRegisterManager(),(Object(b.a)()||A.a.IS_TEST)&&g.a.getInstance().setServiceDelegate({rendererService:o.contentRendererService,selection:o.selectionService}),o.psKeyManager=new C.a(new R.a),new O.a(o.selectionService),e.setSlideRenderStateManagerDelegate(o.slideRenderStateManager),o.switchPageMonitor=new _.a,o.switchPageMonitor.setSelectionServiceDelegate(o.selectionService),o.exportImageManager=new w.a(o.slideRenderStateManager),o.exportImageManager.setSelectionService(o.selectionService),o.exportImageManager.setUiDataService(e),o.exportImageManager.setWatermarkManager(o.watermarkManager),o.shouldInitOpenClientApi()&&(o.openClientApiManager=new S.a(o.playManager,o.selectionService,o.editAreaCanvasSizeManager,o.exportImageManager)),o.applyAuthService=new ee(o.createApplyAuthInjectable()),o.exportManager=k.a.getInstance().registerDynamicService(D),o.cursorManager=k.a.getInstance().registerDynamicService(function(e,n){return{name:"cursor-manager",loadType:"on-demand",module:function(){return E()(P.a.mark((function a(){var i,c;return P.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"16045d1632"));case 2:return i=a.sent,c=i.CursorManager,a.abrupt("return",new c(e,n));case 5:case"end":return a.stop()}}),a)})))()}}}(e,o.selectionService)),o.selectionEventService.setCursorManagerDelegate(o.cursorManager),o.updateNoticeManager=new x.a,o.urlParamManager=k.a.getInstance().registerDynamicService(T),o.urlParamManager.onDidInit((function(e){e.setServiceDelegates({extensionService:o.extensionService})})),o.vipInfoService=new L.a,o.printService=new j.a(o.createPrintServiceInjectable()),o.printService.setServiceDelegates({uiDataService:e,linkManager:o.linkManager}),o.screenshotManager=new ae.a,o.screenshotManager.setUiDataService(e),o.anonymousViewService=k.a.getInstance().registerDynamicService(U),o.anonymousViewService.onDidInit((function(e){e.setServiceDelegates({userPrivilegeService:o.userPriviledgeService,rightSidebarService:o.rightSideBarService})})),o.tipsManager.setAnonymousViewServiceDelegate(o.anonymousViewService),o}return o()(a,[{key:"createApplyAuthInjectable",value:function(){return new ne}},{key:"createPrintServiceInjectable",value:function(){return new N.b}},{key:"shouldInitOpenClientApi",value:function(){return Object(te.f)()||A.a.IS_LOCAL_EDIT}},{key:"initRegisterManager",value:function(){}}]),a}(p.a)},"3bd887f5ab":function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a={name:"docs-component-common-loader",loadType:t("0d2ffd3bdb").LoadType.EAGER}},"4875ff98b0":function(e,n,t){"use strict";t.d(n,"a",(function(){return Sn}));t("73b854064b");var a,i=t("9132715560"),c=t.n(i),o=t("6a364eb35c"),r=t.n(o),s=t("547611bd96"),d=t.n(s),u=t("bd29e2df90"),l=t.n(u),f=t("ab5eb40518"),v=t.n(f),m=t("1b4cdd6a36"),h=t.n(m),y=t("85d0a7609b"),p=t.n(y),b=t("4f3b15d017"),g=t("9f15603575"),A=t("98c2de1441"),S=t("360ad9dd48"),w=t("4b44f97ab3"),k=t("fb0523358a"),I=t("a07d5d1c57"),E=(t("342844cefa"),t("a84962d637"),t("c554310b5c"),t("bcb5d93d36"),t("14502724a6")),M=t.n(E),P=t("176815363d"),D=t.n(P),O=t("3ef2352f0b"),x=t.n(O),T=(t("8ee19818c4"),t("75563bc376"),t("b1e2246d82"),t("8a35b54c1d"),t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),t("c9a7ecac4d"),t("29f8c5f672"),t("22569efd03"),t("433247001a"),t("1bab7b5fb7"),t("bd80bf2d0f"),t("34cd92f77a"),t("a2a09da1e3"),t("9d7978d445"),t("826dc923b3"),t("6c458f1652"),t("c7530f2183")),C=t("3344f1a2e7"),R=t("6a9e93341e"),L=t("e0e8dd9366"),_=t("c13f133f92"),j=t("310c0b6a04"),N=t("fb75408061"),U=function(){function e(n,t,a,i,o,r,s,d,u){c()(this,e),p()(this,"uiDataService",void 0),this.title=n,this.embedUrl=t,this.originUrl=a,this.aid=i,this.width=o,this.height=r,this.extraData=s,this.mode=d,this.docElement=u}return r()(e,[{key:"setUiDataService",value:function(e){this.uiDataService||(this.uiDataService=e)}},{key:"getAddonIframeProps",value:function(){var e,n=this.getIframePosition(),t=n.width,a=n.height,i=n.top,c=n.left,o=null===(e=this.docElement)||void 0===e?void 0:e.lockAspectRatio;return p()({addon:{displayMode:this.mode||N.b.IFRAME,embedUrl:this.embedUrl,iframeId:this.aid,extraData:this.extraData,title:this.title,originUrl:this.originUrl,docElement:this.docElement},style:{bgShape:_.b.RECT,position:"absolute",width:t,height:a,left:c,top:i},subType:1},j.b.LOCKS,{noChangeAspect:o?1:0})}},{key:"getIframePosition",value:function(){var e=this.uiDataService.presentation.props,n=e.slideWidth,t=e.slideHeight,a=this.height||t-400,i=this.width||a/.56;return{width:i,height:a,top:(t-a)/2,left:(n-i)/2}}}]),e}(),F=function e(n,t){var a=this;c()(this,e),p()(this,"getAddonProps",(function(){return{aid:a.docsImageObject.addonId,type:a.type,extraData:a.docsImageObject.extraData||"",docElement:a.docsImageObject}})),this.docsImageObject=n,this.type=t},B=t("9657b29818"),H=t("c73625d763"),G=t.n(H),W=t("8f58e78419"),z=t.n(W),V=t("82f2dc9440"),q=t.n(V),K=t("a6c7240c95"),Y=t("d3d31c86eb"),Q=t("9da6335152"),X=t("e6d98148ee"),J=t("780d9b3b59"),$=t("5fac0349d3"),Z=t("aaf7ed577b"),ee=t("3f87030d09"),ne=t("132ceeffea"),te=t("3404d6c52c"),ae=t.n(te),ie=t("0a8ecd6412"),ce=t("cd1934c1b5"),oe=t("1e07095161"),re=t("402eb050f3"),se=t("ba4ddefc1e"),de=t("9789b08c01"),ue=t("ec5cae33cb"),le=t("c9c92622ff"),fe=t("02ae07c580"),ve=t("f4e4ed5c17"),me=t("9d90e7d680"),he=t("d9812f1c6f"),ye=t("37091e4240");function pe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}!function(e){e.FULLSCREEN="fullscreen"}(a||(a={}));var be,ge,Ae=function(){function e(n,a){var i=this;c()(this,e),p()(this,"event",void 0),p()(this,"addonHandler",void 0),p()(this,"workbenchLoaded",!1),p()(this,"addonIframe",void 0),p()(this,"model",void 0),p()(this,"visibleSlides",void 0),p()(this,"updatedSlideSet",void 0),p()(this,"iframeInfo",void 0),p()(this,"activeElementCallbackMap",void 0),p()(this,"linkManager",void 0),p()(this,"copyPasteManager",void 0),p()(this,"copyPasteImageService",void 0),p()(this,"formulaOcrManager",void 0),p()(this,"uiDataService",void 0),p()(this,"nativeTitleBarManager",void 0),p()(this,"menuManager",void 0),p()(this,"resetSlideUpdateState",(function(){i.updatedSlideSet.clear()})),p()(this,"updateCachedElement",(function(e){var n=i.activeElementCallbackMap.get(e);null==n||n(),i.activeElementCallbackMap.delete(e)})),p()(this,"updateIframeCloneDomStyle",(function(e){var n=e.querySelector("iframe");n&&e.removeChild(n);var t=e.querySelector("#".concat(Object(ee.a)()));t.style.display="block";var a=e.querySelector("#".concat(Object(ee.a)(),"-banner"));a&&(a.style.display="none");var i=t.querySelectorAll("p");i.length>0&&i.forEach((function(e){e.style.display="none"})),e.querySelector("#addon-loading").style.display="none"})),p()(this,"updateToolbar",(function(e,n){i.menuManager&&(i.menuManager.asyncMenuItemReady=!1,n===ie.a.INSERT&&(K.i.updateAddonList(e),i.menuManager.asyncMenuItemReady=!0),n===ie.a.FORMULA&&(K.i.updateAddonFormula(e),i.menuManager.asyncMenuItemReady=!0),n===ie.a.UNOFFICIAL&&(K.i.updateAddonUnOfficial(e),i.menuManager.asyncMenuItemReady=!0))})),p()(this,"getAddonReportId",(function(e,n){var t,a,c,o="";return null===(t=i.addonHandler.addonMetaMap.get(e))||void 0===t||null===(a=t.config)||void 0===a||null===(c=a.menus)||void 0===c||c.forEach((function(e){e.id===n&&(o=e.report_id)})),o})),p()(this,"getAddonReportName",(function(e,n){var t,a,c,o=null===(t=i.addonHandler.addonMetaMap.get(e))||void 0===t||null===(a=t.config)||void 0===a||null===(c=a.menus)||void 0===c?void 0:c.find((function(e){return e.id===n}));return null==o?void 0:o.name})),p()(this,"getAddonFullScreenTitle",(function(e,n){var t,a,c,o=null===(t=i.addonHandler.addonMetaMap.get(e))||void 0===t||null===(a=t.config)||void 0===a?void 0:a.menus;if(null==o||!o.length)return"";if(!n)return(null===(c=o[0])||void 0===c?void 0:c.name)||"";try{var r,s=JSON.parse(n).type;return(null===(r=o.find((function(e){return Object(Z.a)(e.page,"type")===s})))||void 0===r?void 0:r.name)||""}catch(e){return console.error(e),""}})),p()(this,"getIframeInfo",(function(){var e,n,t;return{iframeId:null===(e=i.iframeInfo)||void 0===e?void 0:e.aid,embedUrl:null===(n=i.iframeInfo)||void 0===n?void 0:n.embedUrl,extraData:null===(t=i.iframeInfo)||void 0===t?void 0:t.extraData}})),p()(this,"insertIframeContainer",(function(e){var n,t;if(i.canAddIframeElement()){null===(n=i.selectionService)||void 0===n||n.selectedElements.clear();var a=e.title,c=e.embedUrl,o=e.originUrl,r=e.aid,s=e.extraData,d=e.mode,u=e.docElement,l=e.width,f=void 0===l?1:l,v=e.height,m=void 0===v?1:v,h=f/m,y=i.uiDataService.presentation.props.slideWidth;f>y&&(m=(f=y)/h),i.addonIframe=new U(null!=a?a:"",null!=c?c:"",null!=o?o:"",null!=r?r:"",f,m,s,d,u),i.addonIframe.setUiDataService(i.uiDataService);var b=null===(t=i.selectionService)||void 0===t?void 0:t.currentSlide;if(b){var g=e.title&&e.title.length>0?e.title:e.originUrl,A=[{textRuns:[{styles:p()({href:{url:e.originUrl}},"raw-href",!0),text:g}]}];b.addElementWithParagraphList(i.addonIframe.getAddonIframeProps(),A)}}})),p()(this,"canAddIframeElement",(function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=null===(e=i.selectionService)||void 0===e?void 0:e.currentSlide;if(t)return!(t.children.filter((function(e){return Object(le.o)(e)})).length+n>3)||(q.a.show({message:"插入第三方内容数量上限为3个",type:"info",autoClose:!0}),!1)})),p()(this,"refreshIframe",(function(e,n,t){var a,c=null===(a=i.selectionService)||void 0===a?void 0:a.getSelectedModel(),o=e||z()(c,"props.addon.originUrl"),r=n||z()(c,"props.addon.embedUrl"),s=t||z()(c,"props.addon.title"),d=s||o,u={addon:{docElement:{originURL:o,embedURL:r},originUrl:o,embedUrl:r,title:s}},l=[{textRuns:[{styles:p()({href:{url:o}},"raw-href",!0),text:d}]}];Object(B.b)((function(){var e,n,t,a;c&&(null===(e=(n=c).updateParagraphList)||void 0===e||e.call(n,l),null===(t=(a=c).updateAndRemoveProps)||void 0===t||t.call(a,u))}))})),p()(this,"insertAddonPicture",(function(e){var n=i.getImageData(e),t=n.selectedModel,a=n.imageSdkData;if((null==t?void 0:t.type)===L.d.SHAPE&&null!=t&&t.isTextMath){var c=i.selectionService;if(!c)return;var o=c.currentSlideIndex;if(-1===o)return;var r=c.slides[o];if(r){var s={width:Object(C.C)(a.width),height:Object(C.C)(a.height)},d=t.props.style,u=d.width,l=d.height,f={x:d.left+u/2,y:d.top+l/2},v={src:a.src,addon:a.addon,style:{alpha:1,srcRect:{l:0,r:0,t:0,b:0},width:s.width,height:s.height,left:f.x-s.width/2,top:f.y-s.height/2}};Object(B.b)((function(){r.deleteElement([t]),r.addElement(L.d.IMAGE,v),null==c||c.selectedElements.clear()}))}}else{var m,h;null===(m=document.activeElement)||void 0===m||null===(h=m.blur)||void 0===h||h.call(m),i.isGifUrl(a.src)?i.addFirstFrameForGif(a):i.addNewPicture(a)}})),p()(this,"updateAddonPicture",function(){var e=D()(x.a.mark((function e(n){var t,a,c,o,r,s,d,u,l,f,v;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.getImageData(n),a=t.selectedModel,c=t.imageSdkData,(null==a?void 0:a.type)!==L.d.IMAGE){e.next=23;break}return e.next=4,null===(r=i.copyPasteImageService)||void 0===r?void 0:r.promise();case 4:if(e.t1=o=e.sent,e.t0=null!==e.t1,!e.t0){e.next=8;break}e.t0=void 0!==o;case 8:if(!e.t0){e.next=12;break}e.t2=o,e.next=13;break;case 12:e.t2={};case 13:return d=e.t2,u=d.ImageEditManager,e.next=17,null===(s=i.copyPasteManager)||void 0===s?void 0:s.promise();case 17:l=e.sent,(f=null==u?void 0:u.getInstance())&&(f.imageReplaceAction=1,f.clipDataWaiting=!1),"latex"===(null==(v=c.addon)?void 0:v.type)&&1===(null==l?void 0:l.imageEditManager.imageReplaceAction)?a.updateLatex(c):l&&(l.imageEditManager.imageReplaceAction=0),Object(Y.c)({opername:Q.e.DOC_FORMULA,module:Q.d.FORMULA_RE_EDITED,action:Q.b.FORMULA_INSERT});case 23:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),p()(this,"uploadPictureFormulaOcr",(function(){return new Promise((function(e,n){var t=document.getElementById(R.I);null==t||t.addEventListener("change",function(){var t=D()(x.a.mark((function t(a){var c,o,r,s,d,u,l;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a.target,o=c,T.network.isOnline){t.next=6;break}return i.event.emit(fe.a.ERROR_NETWORK),o.value="",t.abrupt("return");case 6:if(i.formulaOcrManager){t.next=8;break}return t.abrupt("return");case 8:return r=ae.a.show({tip:$.a.t("正在识别公式..."),zIndex:11001}),t.next=11,Object(ne.a)(o.files[0]);case 11:return s=t.sent,o.value="",t.next=15,i.formulaOcrManager.promise();case 15:return d=t.sent,u=d.formulaOCR,t.next=19,u(s);case 19:if(l=t.sent,r.close(),"string"!=typeof l||!l){t.next=24;break}return e(l),t.abrupt("return",l);case 24:return J.c.getInstance().show({message:$.a.t("无法识别公式，请重试。"),autoClose:!0,block:!1}),n(null),t.abrupt("return",null);case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{once:!0}),null==t||t.click()}))})),p()(this,"isNeedDeleteText",(function(e,n){return!(1!==e.props.subType||!Object(oe.g)(e,n))})),p()(this,"getNativeTitlebarManager",(function(){return i.nativeTitleBarManager})),p()(this,"getImageSdkData",(function(e,n){var t,a,i=ce.a.getImageSizeFromUrl(e.src),c=null!==(t=e.width)&&void 0!==t?t:i.width,o=null!==(a=e.height)&&void 0!==a?a:i.height;return{src:e.src,imageName:"",width:c,height:o,addon:n}})),this.slideRenderStateManager=n,this.selectionService=a,this.event=new X.a,n.getVisiblePageDisplayPromise().then((function(){he.a.isMobile?Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"6083914f81")).then((function(e){var n={event:i.event,refreshIframe:i.refreshIframe,updateToolbar:i.updateToolbar,uploadPictureFormulaOcr:i.uploadPictureFormulaOcr},t=e.default;i.addonHandler=new t(n,i,a,i.getNativeTitlebarManager),i.event.emit(fe.a.ADDON_HANDLER_IMPORT_READY)})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})):Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"465ab2c0ab")).then((function(e){var n={event:i.event,refreshIframe:i.refreshIframe,updateToolbar:i.updateToolbar,uploadPictureFormulaOcr:i.uploadPictureFormulaOcr},t=e.default;i.addonHandler=new t(n,i,a,i.linkManager),i.event.emit(fe.a.ADDON_HANDLER_IMPORT_READY)})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))})),this.model=null,this.visibleSlides=[],this.updatedSlideSet=new Set,this.activeElementCallbackMap=new Map,this.event.on(fe.a.ERROR_NETWORK,(function(){J.c.getInstance().show({message:$.a.t("网络已断开，请稍后再试"),autoClose:!0,block:!1})})),ye.b.on(ye.a.WORKBENCH_IS_MOUNT,(function(){return i.workbenchLoaded=!0}))}var n,i,o;return r()(e,[{key:"setVisibleSlide",value:function(e){this.visibleSlides=e}},{key:"updateViewSlide",value:function(){var e=this;this.visibleSlides.forEach((function(n){e.updateSlideAddonScaleView(n)}))}},{key:"updateSlideAddonScaleView",value:function(e){var n,t=this,a=null===(n=this.selectionService)||void 0===n?void 0:n.slides.filter((function(n){return n.id===e}));this.updatedSlideSet.has(e)||(null==a||a[0].children.forEach((function(e){Object(le.o)(e)&&t.updateCachedElement(e)})),this.updatedSlideSet.add(e))}},{key:"savePrevShapeModel",value:function(e,n){this.model=e,n&&this.activeElementCallbackMap.set(this.model,n)}},{key:"updateShapeModel",value:function(e){this.model&&(this.updateCachedElement(this.model),this.model=null),e&&(this.updateCachedElement(e),this.model=e)}},{key:"checkLink",value:(o=D()(x.a.mark((function e(n){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.addonHandler&&he.a.isPc){e.next=2;break}return e.abrupt("return",!1);case 2:if(t=[],this.addonHandler.addonInfoMap.forEach((function(e){var a=e.config.domains,i=e.isOfficial;((null==a?void 0:a.findIndex((function(e){var t=e.domain;return new RegExp((void 0===t?"":t).replace(/\*/g,"[^ ]*")).test(n)})))>=0||!i)&&t.push(e.aid)})),!(t.length>0)){e.next=10;break}return e.next=7,this.addonHandler.parseLinkAsAddon(n);case 7:if(this.iframeInfo=e.sent,!this.iframeInfo){e.next=10;break}return e.abrupt("return",!0);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"shouldRenderFullScreenItem",value:(i=D()(x.a.mark((function e(n,t){var i,c,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(he.a.isPc){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,null===(i=this.addonHandler)||void 0===i||null===(c=i.emitMessageToAddon)||void 0===c?void 0:c.call(i,"$onLoadToolbarButtons",{extraData:t},n);case 4:if(o=e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:return e.abrupt("return",-1!==o.indexOf(a.FULLSCREEN));case 8:case"end":return e.stop()}}),e,this)}))),function(e,n){return i.apply(this,arguments)})},{key:"changeIframeMode",value:function(e,n,t,a,i){var c=G()(e,"props.addon.displayMode")?e.props.addon.displayMode:N.b.NORMAL;c!==n&&(c===N.b.IFRAME?this.changeIframeToLink(e,n):c===N.b.NORMAL&&n===N.b.IFRAME&&this.changeLinkToIframe(e,t,a,i))}},{key:"setMenuManagerDelegate",value:function(e){this.menuManager||(this.menuManager=e)}},{key:"setCopyPasteManager",value:function(e){this.copyPasteManager||(this.copyPasteManager=e)}},{key:"setCopyPasteImageService",value:function(e){this.copyPasteImageService||(this.copyPasteImageService=e)}},{key:"setNativeTitlebarManager",value:function(e){this.nativeTitleBarManager||(this.nativeTitleBarManager=e)}},{key:"setSelectionService",value:function(e){this.selectionService||(this.selectionService=e)}},{key:"setFormulaOcrManager",value:function(e){this.formulaOcrManager||(this.formulaOcrManager=e)}},{key:"setUiDataService",value:function(e){this.uiDataService||(this.uiDataService=e)}},{key:"setLinkManager",value:function(e){this.linkManager||(this.linkManager=e)}},{key:"addNewPicture",value:(n=D()(x.a.mark((function e(n){var t,a,i,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.copyPasteImageService)||void 0===t?void 0:t.promise();case 2:null==(i=e.sent)||i.addImagesInSlide([n],null===(a=this.selectionService)||void 0===a?void 0:a.slides[this.selectionService.currentSlideIndex]),(c=this.selectionService)&&(c.lastMouseDownRegion=ue.a.EDITOR),Object(Y.c)({opername:Q.e.DOC_FORMULA,module:Q.d.FORMULA_NEW,action:Q.b.FORMULA_INSERT});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"isGifUrl",value:function(e){return e.indexOf("gif")>-1}},{key:"addFirstFrameForGif",value:function(e){var n=this,t=e.src.split("?"),a=M()(t,1)[0],i="".concat(a,"?imageInfo");Object(ve.a)({method:"get",url:i,timeout:2e3}).then((function(t){if(200===t.status){var a=t.data;if(Number(a.width)*Number(a.height)*Number(a.frame_count)<25e7)e.backupSrc="".concat(e.src,"&imageMogr2/format/jpg/ignore-error/1");else{var i=e.width,c=e.height;e.backupSrc=Object(me.b)($.a.t("图片上传失败，请稍后再试。"),i,c)}}else{var o=e.width,r=e.height;e.backupSrc=Object(me.b)($.a.t("图片上传失败，请稍后再试。"),o,r)}n.addNewPicture(e)}))}},{key:"getImageData",value:function(e){var n,t=null===(n=this.selectionService)||void 0===n?void 0:n.getSelectedModel(),a=e.sourceType;re.b.supportEnterprise(re.a.ALL)&&e.addonId===se.a&&(a="latex");var i=new F(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?pe(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({addonId:e.addonId,extraData:e.extraData},e),a),c=i.getAddonProps();return{selectedModel:t,imageSdkData:this.getImageSdkData(e,c)}}},{key:"changeLinkToIframe",value:function(e,n,t,a){if(this.canAddIframeElement()&&t){var i={title:n.text,originUrl:n.url,embedUrl:this.iframeInfo.embedUrl,mode:N.b.IFRAME,aid:G()(e,"props.addon.iframeId")?e.props.addon.iframeId:this.iframeInfo.aid,extraData:G()(e,"props.addon.extraData")?e.props.addon.extraData:this.iframeInfo.extraData,width:this.iframeInfo.width,height:this.iframeInfo.height};this.changeWithExtraData(e,i,t,a)}}},{key:"changeWithExtraData",value:function(e,n,t,a){var i=this,c=[];if(e.type===L.d.TABLE){var o=e.selectedRange;c=Object(de.b)(e.props.items[o.rowStart][o.colStart].paragraphList)}else c=Object(de.b)(e.paragraphList);a&&(c=a(c)),e.type===L.d.SHAPE?Object(B.b)((function(){i.isNeedDeleteText(e,c)?e.soruceRefForUI.deleteElement([e]):e.updateParagraphList(c),i.insertIframeContainer(n)})):e.type===L.d.TABLE&&Object(B.b)((function(){e.uploadSelectedCellData({paragraphList:c}),i.insertIframeContainer(n)}))}},{key:"changeIframeToLink",value:function(e,n){var t;if(e.props.link&&(t={link:null}),"icon"!==n){var a={addon:{displayMode:n}};e.updateAndRemoveProps(a,t)}else{var i,c,o=null===(i=e.props.addon)||void 0===i?void 0:i.originUrl;o&&(null===(c=this.linkManager)||void 0===c||c.requestLinkData(o).then((function(n){var a=o,i=ie.b;n&&0===n.retcode&&(a=n.result.linkInfo.title,i=n.result.linkInfo.mimeType);var c={url:o,mimeType:i,iconMode:!0},r={addon:{displayMode:"normal"}},s=[{textRuns:[{styles:p()({href:c},"raw-href",!0),text:a}]}];Object(B.b)((function(){e.updateAndRemoveProps(r,t),e.updateParagraphList(s)}))})))}}}]),e}(),Se=t("a5efb5f024"),we=t("5589c66022"),ke=t("d1f05b304b"),Ie=t("cbac204f34"),Ee={name:"accessibility-manager",loadType:"on-demand",module:function(){return D()(x.a.mark((function e(){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"ff91d2d7a9"));case 2:return n=e.sent,a=n.AccessibilityManager,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}},Me=(t("3bf1976a4f"),t("2504ad7290"),t("020899bf26")),Pe=t("915616c11c"),De=function(){function e(){c()(this,e)}return r()(e,[{key:"showBlankPage",value:function(e){var n,t,a,i,c=null===(n=Me.a.ClientVarsService())||void 0===n||null===(t=n.getClientVars)||void 0===t?void 0:t.call(n),o={docId:e,sourcePadType:null!==(a=null==c?void 0:c.padType)&&void 0!==a?a:"slide"};localStorage.setItem("blankPageData",JSON.stringify(o));var r="".concat(location.origin,"/blankpage/").concat(e).concat(location.search);b.default.isTencentDocsApp&&window.dispatchEvent(new Event("unload")),Object(Pe.a)({url:r,replace:!0,noHistory:!0}),null===(i=window.log)||void 0===i||i.info("BlankPage - navigator")}}]),e}(),Oe={name:"accusation-service",loadType:"on-demand",module:function(){return D()(x.a.mark((function e(){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"5476253e4e"));case 2:return n=e.sent,a=n.AccusationService,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}},xe=t("aab91ebb18"),Te={name:"notify-manager",loadType:"idle",module:function(){return D()(x.a.mark((function e(){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"55ce2a5f80"));case 2:return n=e.sent,a=n.NotifyManager,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}},Ce=t("8ba4036387"),Re=t("8eacaf6766"),Le=t("10eb5d8814"),_e=t("7e2d428441"),je={name:"watermark-manager",loadType:"on-demand",module:function(){return D()(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"7e4bea7b44"));case 2:return n=e.sent.default,e.abrupt("return",new n);case 4:case"end":return e.stop()}}),e)})))()}},Ne=t("b86964b011"),Ue=t("b385c36a13"),Fe=t("92ec7966a6"),Be=t("90fcc536a9"),He=t("05d181ac40"),Ge=t("a5156e8218"),We=t("93da285f11"),ze=t("1f925d7f50"),Ve=t.n(ze),qe=t("2dc700e1e6"),Ke=t.n(qe),Ye=(t("f1054791f4"),t("ab67fd3ad5"),t("8a14e05f2c"),t("4bbb5840d5"),t("d5c3deb8c7")),Qe=t("51b2ea9953"),Xe=t("dca2cfac94"),Je=t("4149154b4b"),$e=t("c7bf247df7"),Ze=t("0cbec907c5"),en=t("647724681b"),nn=t("b00adb794a"),tn=t("3b24c833e2"),an=t("b0233a497a"),cn=t("14c02e2331"),on=t("7c46f42788"),rn=t("711a53c9fc"),sn=t("9559b6ab8e"),dn=t("e0b2192bab"),un=t("055c045d91"),ln=t("75f19a1449"),fn=t("db0c73f5df");function vn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function mn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?vn(Object(t),!0).forEach((function(n){p()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var hn=100,yn=(be=function(){function e(n){var t=this;c()(this,e),p()(this,"uploadingMap",void 0),Ve()(this,"attachmentSuccessHappen",ge,this),p()(this,"uploader",void 0),p()(this,"hasRegisterPresentation",void 0),p()(this,"registerSlideMap",new WeakMap),p()(this,"selectionService",void 0),p()(this,"uiDataService",void 0),p()(this,"slideRenderStateManager",void 0),p()(this,"elementDeleteCallback",(function(e,n){var a,i;e.type!==on.a.Slide?null===(a=t.uiDataService.presentation)||void 0===a||null===(i=a.children)||void 0===i||i.forEach((function(e){t.isSlideHasElementUploading(e)&&t.addElementDeleteObserver(e)})):t.uploadingMap.forEach((function(n){var a,i,c,o=n.attachment.id;n.shapeUniqueId&&(null!==(a=e.shapeList)&&void 0!==a&&a.some((function(e){return e.id===n.shapeUniqueId}))||(null===(i=window.log)||void 0===i||null===(c=i.info)||void 0===c||c.call(i,"abortAttachment=",o),t.uploader.abortUpload(o)))}))}));var a=n.selectionService,i=n.uiDataService,o=n.slideRenderStateManager;this.selectionService=a,this.uiDataService=i,this.slideRenderStateManager=o;var r=Xe.c.getInstance();r.addUploadListener(this),this.uploader=r,this.uploadingMap=new Map,Object(Me.b)(D()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.slideRenderStateManager.getVisiblePageDisplayPromise();case 2:r.initUploader();case 3:case"end":return e.stop()}}),e)}))))}var n,t,a,i,o,s;return r()(e,[{key:"onStatusChanges",value:function(e){if((null==e?void 0:e.statusName)===Je.a.SUCCESS){var n,t,a,i=null===(n=e.options)||void 0===n?void 0:n.id,c=this.uploadingMap.get(null===(t=e.options)||void 0===t?void 0:t.id),o=null===(a=e.options)||void 0===a?void 0:a.objKey;if(o&&c){var r;this.uploadingMap.delete(i);var s=this.uiDataService.presentation.findElementWithId(c.slideId,c.shapeId);if(null===(r=window.log)||void 0===r||r.info("onStatusChanges success : delete id=",i,!!s),s)c.attachment.objKey=o,this.handleAttachmentElement(s,c),this.attachmentSuccessHappen+=1}else{var d;null===(d=window.log)||void 0===d||d.warn("handle upload success error: objKy = ".concat(o,", attachment ="),c)}}else(null==e?void 0:e.statusName)===Je.a.FILEREAD&&Array.isArray(e.options)&&this.addAttachmentInSlide(e.options)}},{key:"insertAttachmentDirectly",value:function(e){var n=this,t=this.selectionService.currentSlide;if(t){var a=this.findAttachmentInitPos(),i=a.initLeft,c=a.initTop;e.forEach((function(e,a){var o;e.name="".concat(e.name||"").concat(e.name?".":"").concat(e.filetype||""),e.type=e.filetype,e.size=Number.isNaN(Number(e.size))?void 0:Number(e.size),n.addElementDeleteObserver(t);var r={attachment:e,slideId:t.id,shapeId:""},s=n.getAttachmentProps(e,a,i,c),d=n.getAttachmentExtraInfo(s.attachment);t.addElement([L.d.SHAPE],[s],[d]);var u=t.children[t.children.length-1];r.shapeId=u.id,r.shapeUniqueId=null===(o=u.sdkData)||void 0===o?void 0:o.id;var l=n.uiDataService.presentation.findElementWithId(r.slideId,r.shapeId);l&&n.handleAttachmentElement(l,r)}))}}},{key:"deleteAttachment",value:function(e){e.id&&this.uploader.removeAttachment(e.id)}},{key:"isUploadingAttachment",value:function(e){return!!e&&this.uploadingMap.has(e)}},{key:"generateUploadingAttachmentShowType",value:function(e){var n={showType:Ze.n.TEXT,width:0,height:0};switch(e){case Ze.b.VIDEO:n.showType=Ze.n.PREVIEW,n.width=Ze.m,n.height=Ze.l;break;case Ze.b.IMAGE:n.showType=Ze.n.PREVIEW,n.width=Ze.i,n.height=Ze.h;break;case Ze.b.DOC:n.showType=Ze.n.CARD,n.width=Ze.g,n.height=Ze.f;break;case Ze.b.AUDIO:n.showType=Ze.n.TEXT}return n}},{key:"getAttachmentExtraInfo",value:function(e){var n=Ze.u,t={fontSize:Ze.v,fontFamily:n,fonts:{ea:n,latin:n},color:Ze.t,tdColor:new ln.a({rgbaStr:Ze.t})},a=e.showType===Ze.n.TEXT||e.showType===Ze.n.SIMPLE_TEXT?{autoFitType:Qe.a.SHAPE_AUTO_FIT,bodyStyle:mn({whiteSpace:"pre"},this.getAttachmentShapePadding(e.showType))}:{},i=[{paragraphProps:{lineHeight:1.56,lineHeightIs:"percent"},textRuns:[{text:e.name,type:"run",styles:t}]}];return dn.a.addParagraphListRawSignProps(i,i),{textBodyStyle:a,paragraphList:i}}},{key:"getAttachmentShapePadding",value:function(e){return e===Ze.n.TEXT?{paddingLeft:32,paddingRight:cn.h,paddingTop:cn.i,paddingBottom:cn.i}:{}}},{key:"handleAttachmentElement",value:function(e,n){var t=n.attachment,a=t.classify;a===Ze.b.VIDEO||a===Ze.b.AUDIO?this.handleMediaSuccess(e,t):a===Ze.b.IMAGE?this.handleImageSuccess(e,t):a===Ze.b.DOC?this.handleDocSuccess(e,t):this.handleAttachmentSuccess(e,t)}},{key:"uploadAndGetMediaPosterUrl",value:(s=D()(x.a.mark((function e(n){var t,a,i,c,o,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Xe.c.getInstance(),a=t.dcAttachmentModule,e.prev=1,e.next=4,a.getMediaPoster({objKey:n.objKey,fileId:null!==(i=null===(c=Me.a.DocInfoManager())||void 0===c?void 0:c.padId)&&void 0!==i?i:""});case 4:return o=e.sent,e.next=7,Object(ne.e)(o);case 7:return r=e.sent,e.next=10,Object(tn.a)({blob:new Blob([r])});case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[1,13]])}))),function(e){return s.apply(this,arguments)})},{key:"getImageAttachmentPoster",value:(o=D()(x.a.mark((function e(n){var t,a,i,c,o,r,s,d,u,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Xe.c.getInstance(),a=t.dcAttachmentModule,e.prev=1,o=n.objKey,r=null!==(i=null===(c=Me.a.DocInfoManager())||void 0===c?void 0:c.padId)&&void 0!==i?i:"",e.next=6,a.getMediaPoster({objKey:o,fileId:r});case 6:return s=e.sent,e.prev=7,e.next=10,Object(an.a)(s);case 10:l=e.sent,d=l.width,u=l.height,e.next=19;break;case 15:e.prev=15,e.t0=e.catch(7),d=1,u=1;case 19:return e.abrupt("return",{width:d,height:u,url:"".concat(Ze.y,"?w=").concat(d,"&h=").concat(u,"&objKey=").concat(n.objKey,"&fileId=").concat(r)});case 22:return e.prev=22,e.t1=e.catch(1),e.abrupt("return",null);case 25:case"end":return e.stop()}}),e,null,[[1,22],[7,15]])}))),function(e){return o.apply(this,arguments)})},{key:"addAttachmentInSlide",value:function(e){var n=this,t=this.selectionService.currentSlide;if(t){var a=this.findAttachmentInitPos(),i=a.initLeft,c=a.initTop;e.forEach((function(e,a){var o,r;if(!e.id||!n.uploadingMap.has(e.id)){null===(o=window.log)||void 0===o||o.info("addAttachmentInSlide =",e.name),n.addElementDeleteObserver(t);var s={attachment:e,slideId:t.id,shapeId:""};n.uploadingMap.set(e.id,s);var d=n.getAttachmentProps(e,a,i,c),u=n.getAttachmentExtraInfo(d.attachment);t.addElement([L.d.SHAPE],[d],[u]);var l=t.children[t.children.length-1];s.shapeId=l.id,s.shapeUniqueId=null===(r=l.sdkData)||void 0===r?void 0:r.id}}))}}},{key:"addElementDeleteObserver",value:function(e){var n,t,a,i=this;e.sdkData&&!this.registerSlideMap.has(e.sdkData)&&(null===(n=e.sdkData)||void 0===n||n.subscribe((function(n){i.elementDeleteCallback(e.sdkData,n)})),this.registerSlideMap.set(e.sdkData,!0));this.hasRegisterPresentation||(this.hasRegisterPresentation=!0,null===(t=this.uiDataService.presentation)||void 0===t||null===(a=t.sdkData)||void 0===a||a.subscribe((function(e){var n;i.elementDeleteCallback(null===(n=i.uiDataService.presentation)||void 0===n?void 0:n.sdkData,e)})))}},{key:"isSlideHasElementUploading",value:function(e){var n=!1;return this.uploadingMap.forEach((function(t){t.slideId===e.id&&(n=!0)})),n}},{key:"getAttachmentProps",value:function(e,n,t,a){var i=this.getFramePosition(n,t,a),c=i.top,o=i.left,r=this.generateUploadingAttachmentShowType(e.classify),s=r.showType,d=r.width,u=r.height,l={bgShape:_.b.RECT,position:"absolute",left:o,top:c};return e.classify!==Ze.b.AUDIO&&(l=mn(mn({},l),{},{width:d,height:u})),p()({attachment:{id:e.id,name:e.name,classify:e.classify,size:e.size,type:e.type,showType:s},style:l,subType:nn.a.TEXT_ELEMENT},j.b.LOCKS,{noGrp:1})}},{key:"getFramePosition",value:function(e,n,t){return{top:t+(Ze.j+50)*e,left:n}}},{key:"findAttachmentInitPos",value:function(){var e=this,n=this.uiDataService.presentation.props,t=n.slideWidth,a=n.slideHeight,i=this.selectionService.currentSlide,c=[];null==i||i.children.forEach((function(n){var t,a,i;if(z()(n,"props.attachment")&&n.type===L.d.SHAPE){var o=n.props.attachment;if(!o.objKey&&!e.isUploadingAttachment(o.id))return}if((n.type===L.d.IMAGE&&null!==(t=(a=n).isMedia)&&void 0!==t&&t.call(a)||null!==(i=n.isAttachment)&&void 0!==i&&i.call(n))&&z()(n,"props.style")){var r=n.props.style;c.push({left:r.left,top:r.top,width:r.width,height:r.height})}}));var o=t/4,r=200,s=o,d=Math.ceil((t-s)/(Ze.k+50)),u=Math.ceil((a-r)/(Ze.j+50));e:for(var l=0;l<d;l++){s=o+(Ze.k+50)*l;for(var f=0;f<u;f++){r=200+(Ze.j+50)*f;for(var v=!1,m=0;m<c.length;m++)if(Object($e.b)(c[m],{left:s,top:r,width:Ze.k,height:Ze.j})){v=!0;break}if(!v)break e}}return{initLeft:s,initTop:r}}},{key:"getMediaDuration",value:(i=D()(x.a.mark((function e(n){var t,a,i,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve.a.post("https://docs.qq.com/api/drive/mediainfo?xsrf=".concat(Object(fn.b)()),{file_id:null!==(t=null===(a=Me.a.DocInfoManager())||void 0===a?void 0:a.padId)&&void 0!==t?t:"",obj_key:n.objKey});case 3:return i=e.sent,c=n.classify,e.abrupt("return",i.data.result.media[c].length);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(e){return i.apply(this,arguments)})},{key:"handleMediaSuccess",value:(a=D()(x.a.mark((function e(n,t){var a,i,c,o,r,s,d,u,l,f,v,m,h,y,b,g,A,S,w,k,I,E,M,P,D,O=this;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.classify,o=c===Ze.b.VIDEO,r=c===Ze.b.AUDIO,s=n.slideRef){e.next=6;break}return e.abrupt("return");case 6:if(d=null!==(a=t.objKey)&&void 0!==a?a:"",!o){e.next=25;break}if(!He.a.IS_PC_LOCAL_EDIT){e.next=13;break}u=null!==(f=en.a.VideoImageMap.get(d))&&void 0!==f?f:Ze.z,l=null!==(v=en.a.VideoSizeMap.get(d))&&void 0!==v?v:{width:Ze.m,height:Ze.l},e.next=25;break;case 13:return e.next=15,this.uploadAndGetMediaPosterUrl(t);case 15:if(e.t0=e.sent,e.t0){e.next=18;break}e.t0={};case 18:m=e.t0,h=m.url,y=m.width,b=m.height,y&&b&&(g=y/b),l=Object(an.d)(g),u=h||Ze.z;case 25:if(A=z()(n,"props.style"),S=A.left,w=A.top,k=c?(i={},p()(i,c,{link:t.objKey,format:t.type,size:t.size}),p()(i,"name",t.name),i):{},I=o?u:Ze.a,!(E=He.a.IS_LOCAL_EDIT&&(null==I?void 0:I.startsWith("http")))){e.next=35;break}return e.next=32,Object(un.c)(I);case 32:e.t1=e.sent.src,e.next=36;break;case 35:e.t1=I;case 36:return M=e.t1,P={src:M,style:{bgShape:_.b.RECT,left:S||hn,top:w||hn,width:o?l.width:Ze.e,height:o?l.height:Ze.d}},e.next=40,this.handleGetMediaDuration(t);case 40:D=e.sent,Object(B.b)((function(){if(s.deleteElement([n]),s.addElement([L.d.IMAGE],[P],[k]),t.objKey){var e,a,i={id:t.objKey,src:t.objKey,format:t.type,size:t.size};if(o?(null===(e=Me.a.SDKDataServices.PresentationStoreService())||void 0===e||e.getPresentation().api.updateVideoResourceMap(t.objKey,i),O.addAnimationToVideo(s,D)):null===(a=Me.a.SDKDataServices.PresentationStoreService())||void 0===a||a.getPresentation().api.updateAudioResourceMap(t.objKey,i),E){var c,d={id:M,src:M};null===(c=Me.a.SDKDataServices.PresentationStoreService())||void 0===c||c.getPresentation().api.updateImageResourceMap(M,d)}r&&O.addAnimationToAudio(s,D)}})),this.uploader.removeAttachment(t.id);case 43:case"end":return e.stop()}}),e,this)}))),function(e,n){return a.apply(this,arguments)})},{key:"handleGetMediaDuration",value:(t=D()(x.a.mark((function e(n){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.classify===Ze.b.VIDEO||n.classify===Ze.b.AUDIO){e.next=3;break}return e.abrupt("return","0");case 3:return e.next=5,this.getMediaDuration(n);case 5:return t=e.sent,e.abrupt("return",t?"".concat(t,"000"):"0");case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"addAnimationToVideo",value:function(e,n){this.handleAddAnimation(e,n,rn.e.Video)}},{key:"addAnimationToAudio",value:function(e,n){this.handleAddAnimation(e,n,rn.e.Audio)}},{key:"handleAddAnimation",value:function(e,n,t){var a,i,c,o=null===(a=e.sdkData)||void 0===a?void 0:a.shapeList;if(o){var r=o[o.length-1].id,s=e.timing.unitTimeNodeMap[sn.q]?e.timing.unitTimeNodeMap[sn.q].unitTimeNodeList.length:0,d={mediaDuration:n,shapeIds:[r],animType:sn.b.Play,triggerId:sn.q,index:s,mediaType:t};if(null===(i=e.sdkData)||void 0===i||null===(c=i.timing)||void 0===c||c.api.addAnimation(d),t===rn.e.Video&&r){var u,l,f=e.timing.unitTimeNodeMap[r]?e.timing.unitTimeNodeMap[r].unitTimeNodeList.length:0,v={mediaDuration:n,triggerId:r,shapeIds:[r],animType:sn.b.Pause,index:f,mediaType:t};null===(u=e.sdkData)||void 0===u||null===(l=u.timing)||void 0===l||l.api.addAnimation(v)}}}},{key:"handleAttachmentSuccess",value:function(e,n){var t=p()({attachment:{objKey:n.objKey,id:"",showType:Ze.n.TEXT}},j.b.LOCKS,null);e.updateProps(t),this.uploader.removeAttachment(n.id)}},{key:"handleImageSuccess",value:(n=D()(x.a.mark((function e(n,t){var a,i,c,o,r,s,d,u,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.slideRef){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.getImageAttachmentPoster(t);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:i=e.t0,c=i.url,o=i.width,r=i.height,o&&r&&(s=o/r),d=Object(an.c)(s),u=d.width,l=d.height,Object(B.b)((function(){var e=z()(n,"props.style"),i=e.left,o=e.top,r={src:c,attachment:{id:"",name:t.name,objKey:t.objKey,type:t.type,size:t.size,classify:t.classify,showType:Ze.n.PREVIEW},style:{bgShape:_.b.RECT,left:i||hn,top:o||hn,width:u,height:l}};a.deleteElement([n]),a.addElement([L.d.IMAGE],[r],[{}])})),this.uploader.removeAttachment(t.id);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"handleDocSuccess",value:function(e,n){var t,a=(t={attachment:{objKey:n.objKey,id:"",showType:Ze.n.CARD}},p()(t,j.b.LOCKS,null),p()(t,"subType",nn.a.SHAPE),t);e.updateProps(a),this.uploader.removeAttachment(n.id)}}]),e}(),ge=Ke()(be.prototype,"attachmentSuccessHappen",[Ye.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),be),pn=t("b1e0ea6d5e"),bn=t("ec44d5c298"),gn=t("9ac3b0b039");function An(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=h()(e);if(n){var i=h()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return v()(this,t)}}var Sn=function(e){l()(t,e);var n=An(t);function t(e,a){var i;return c()(this,t),i=n.call(this,e,a),p()(d()(i),"selectionEventService",void 0),p()(d()(i),"playManager",void 0),p()(d()(i),"userPriviledgeService",void 0),p()(d()(i),"tipsManager",void 0),p()(d()(i),"mediaManager",void 0),p()(d()(i),"editingStateManager",void 0),p()(d()(i),"addonManager",void 0),p()(d()(i),"editingPresentManager",void 0),p()(d()(i),"accessibilityManager",void 0),p()(d()(i),"blankPageService",void 0),p()(d()(i),"accusationService",void 0),p()(d()(i),"notifyManager",void 0),p()(d()(i),"linkManager",void 0),p()(d()(i),"toolbarStateManager",void 0),p()(d()(i),"liveManager",void 0),p()(d()(i),"watermarkManager",void 0),p()(d()(i),"imgLoaderManager",void 0),p()(d()(i),"rightSideBarService",void 0),p()(d()(i),"attachmentManager",void 0),p()(d()(i),"extensionService",void 0),p()(d()(i),"lifeCycleService",void 0),p()(d()(i),"tasks",void 0),i.lifeCycleService=new bn.a,i.attachmentManager=new yn({uiDataService:e,selectionService:i.selectionService,slideRenderStateManager:i.slideRenderStateManager}),xe.a.getInstance().startObserveLongtask(),e.setSelectionDelegate(i.selectionService),i.editingStateManager=new I.a,ke.a.setEditingStateManagerDelegate(i.editingStateManager),i.mediaManager=new We.a,ke.a.setMediaManagerDelegate(i.mediaManager),(Object(g.a)()||He.a.IS_TEST)&&A.a.getInstance().setServiceDelegate({rendererService:i.contentRendererService,selection:i.selectionService}),i.playManager=new S.a(i.selectionService,i.editorInstanceService),i.tipsManager=new k.a({selectionService:i.selectionService},i.createTipManagerInject()),i.userPriviledgeService=new w.a(i.selectionService,e),i.initUserPriviledgeService(),i.selectionEventService=new Se.a,i.selectionEventService.setSelectionServiceDelegate({selectionService:i.selectionService,privilegeService:i.userPriviledgeService}),i.addonManager=new Ae(i.slideRenderStateManager,i.selectionService),i.addonManager.setSelectionService(i.selectionService),i.addonManager.setUiDataService(e),i.blankPageService=new De,b.default.isTencentMeeting&&(i.editingPresentManager=new we.a(i.selectionService)),i.accessibilityManager=Ie.a.getInstance().registerDynamicService(Ee),i.accessibilityManager.onDidInit((function(n){n.setServiceDelegates({selectionService:i.selectionService,uiDataService:e,addonManager:i.addonManager})})),i.accusationService=Ie.a.getInstance().registerDynamicService(Oe),i.accusationService.onDidInit((function(e){e.setServiceDelegates({extensionService:i.extensionService})})),i.notifyManager=Ie.a.getInstance().registerDynamicService(Te),i.notifyManager.onDidInit((function(e){e.setServiceDelegates({rightSideBarService:i.rightSideBarService}),e.registerRightSideBar(),e.setInject(i.createNotifyManagerInjectable())})),i.linkManager=new Ce.a(e,i.selectionService,i.addonManager,i.playManager,i.editingStateManager,i.editorInstanceService,i.userPriviledgeService,new Re.a),i.addonManager.setLinkManager(i.linkManager),i.toolbarStateManager=new Le.a,i.liveManager=Ie.a.getInstance().registerDynamicService(_e.a),i.watermarkManager=Ie.a.getInstance().registerDynamicService(je),i.watermarkManager.onDidInit((function(e){!Object(Ne.p)()&&Object(Ne.o)()||(window.watermarkManager=e)})),i.imgLoaderManager=new Ue.a,i.rightSideBarService=new Fe.a,i.extensionService=i.createExtensionService(),i.extensionService.setServiceDelegates({lifeCycleService:i.lifeCycleService}),i}return r()(t,[{key:"createExtensionService",value:function(){return new pn.a}},{key:"createTipManagerInject",value:function(){return new Be.a}},{key:"createNotifyManagerInjectable",value:function(){return new gn.a}},{key:"initUserPriviledgeService",value:function(){this.tipsManager.setUserPriviledgeServiceDelegate(this.userPriviledgeService)}}]),t}(Ge.a)},"55f3b69889":function(e,n,t){"use strict";var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("85d0a7609b"),s=t.n(r),d=t("f9193d718f"),u=t("020899bf26"),l=t("aba9dcef64"),f=t("668bd0ac65"),v=t("1af4b2dbf4"),m=t("4a351e9268"),h=t("c94abe4d15"),y=t("780d9b3b59"),p=t("e516279ea9");window.pray=function(){return b.myGod()};var b=function(){function e(){i()(this,e),s()(this,"_getManagerState",void 0),s()(this,"_getPlayRoomManagerState",void 0),s()(this,"_playerStore",void 0)}return o()(e,[{key:"blessManager",value:function(e){this._getManagerState=e}},{key:"blessPlayRoomManager",value:function(e){this._getPlayRoomManagerState=e}},{key:"isPlaying",get:function(){return d.a.getInstance().getAppServices().viewableServiceLayer.playManager.isPlaying}},{key:"openClientApiManager",get:function(){return d.a.getInstance().getAppServices().viewableServiceLayer.openClientApiManager}},{key:"SlideAppV3",get:function(){return{SlideDataServices:u.a,OnlineEditServices:l.a}}},{key:"_",get:function(){var e;return{SlideDataServices:u.a,OnlineEditServices:l.a,Collaboration:l.a.CollaborationManager(),CommandManager:u.a.SDKDataServices.CommandManager(),PresentationStore:u.a.SDKDataServices.PresentationStoreService(),Presentation:null===(e=u.a.SDKDataServices.PresentationStoreService())||void 0===e?void 0:e.getPresentation(),SlideFile:f.a,CommandData:v.a,RevisionData:m.a,TransformRequestData:h.a,TransformResponseData:h.b,CommonTips:y.c.getInstance(),OfflineEditServices:p.a}}},{key:"pptTitle",get:function(){var e,n=(null===(e=u.a.ClientVarsService())||void 0===e?void 0:e.getClientVars())||{};return n.title||n.padTitle||""}},{key:"revision",get:function(){var e,n;return(null===(n=((null===(e=u.a.ClientVarsService())||void 0===e?void 0:e.getClientVars())||{}).collab_client_vars)||void 0===n?void 0:n.rev)||0}},{key:"editorCurrentSlideIndex",get:function(){var e=this.getSelectionService();return e?e.currentSlideIndex:-1}},{key:"editorlastInsertButtonClickType",get:function(){var e,n=d.a.getInstance().getAppServices();return null==n||null===(e=n.viewableServiceLayer)||void 0===e?void 0:e.toolbarStateManager.lastInsertButtonClick}},{key:"getSelectionService",value:function(){var e,n=d.a.getInstance().getAppServices();if(null!=n&&null!==(e=n.viewableServiceLayer)&&void 0!==e&&e.selectionService)return n.viewableServiceLayer.selectionService}}],[{key:"myGod",value:function(){return e.__singletonRef||(e.__singletonRef=new e),e.__singletonRef}}]),e}();s()(b,"__singletonRef",void 0)},"560bea0cc4":function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));var a="no-edit-auth-mobile",i="no-edit-auth-pc"},"580eefa367":function(e,n,t){"use strict";t.d(n,"b",(function(){return v})),t.d(n,"a",(function(){return m})),t.d(n,"d",(function(){return h})),t.d(n,"c",(function(){return y})),t.d(n,"e",(function(){return p}));t("963f2eaace"),t("c6244f7705"),t("8aebbf296a"),t("a84962d637"),t("f45588a8ad"),t("de37db1287");var a=t("0cf3719522"),i=t.n(a),c=(t("85d0a7609b"),t("1bab7b5fb7"),t("34cd92f77a"),t("b1e2246d82"),t("8ee19818c4"),t("3bf1976a4f"),t("0acdc5834b"),t("2c4d03fe19"),t("342844cefa"),t("85d48ef22b"),t("8e7cce0ada"),t("2a6f332b5e"),t("b8217400dc"),t("e6f68cdf2e"),t("e0e8dd9366"),t("9657b29818"));t.d(n,"f",(function(){return c.b}));var o=t("d9812f1c6f"),r=(t("8f58e78419"),t("3b9e86cc44")),s=t.n(r),d=(t("5fac0349d3"),t("d41847a0d3")),u=t("711a53c9fc");function l(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,r=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){r=!0,c=e},f:function(){try{o||null==t.return||t.return()}finally{if(r)throw c}}}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function v(e){return e&&(e=o.a.isMac?e.replace(/Cmd/i,"⌘"):e.replace(/Cmd|⌘/i,"Ctrl")),e}function m(e,n){var t,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return document.createEvent?(t=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(t=document.createEventObject()).eventType=e,t=s()(t,{eventName:e},a),document.createEvent?n.dispatchEvent(t):n.fireEvent("on".concat(t.eventType),t)}var h=function(e){if(!e.paragraphList)return"";var n="";return e.paragraphList.forEach((function(e){e.textRuns&&e.textRuns.length>0&&(n="".concat(n," ").concat(e.textRuns.reduce((function(e,n){return e+n.text}),"")))})),n.trim()},y=function(e){for(var n=0;n<d.a.length;n++)for(var t=0;t<d.a[n].groupvalue.length;t++)if(d.a[n].groupvalue[t].type===u.gb[e])return d.a[n].groupvalue[t].title;return u.gb[e]};function p(e,n){var t=Object.keys(e||{}),a=Object.keys(n||{});if(t.length!==a.length)return!1;if(e&&n){var c,o=l(t);try{for(o.s();!(c=o.n()).done;){var r=c.value;if(!a.includes(r))return!1;if(e[r]!==n[r])return!("object"!==i()(e[r])||!e[r]||!n[r])&&p(e[r],n[r])}}catch(e){o.e(e)}finally{o.f()}}return!0}},"5cb28860e6":function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var a=t("176815363d"),i=t.n(a),c=t("3ef2352f0b"),o=t.n(c),r=(t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),t("49560ba51f")),s={name:"media-sync-manager",loadType:"on-demand",module:function(){return i()(o.a.mark((function e(){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"16635419e4"));case 2:return n=e.sent,a=n.NoteViewMediaSyncManager,e.abrupt("return",new a(new r.a));case 5:case"end":return e.stop()}}),e)})))()}}},"5de93315c1":function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a="no-edit-login"},"6138271d53":function(e,n,t){"use strict";t.d(n,"a",(function(){return s})),t.d(n,"c",(function(){return d})),t.d(n,"b",(function(){return u}));t("8e7cce0ada"),t("c6244f7705"),t("081c8cafea"),t("85d48ef22b"),t("2a6f332b5e");var a=t("c7530f2183"),i=t("8b13fcae36"),c=t("d9812f1c6f"),o=t("5fac0349d3"),r=t("020899bf26");function s(){var e=setInterval((function(){if((window.clientVars||window.clientVarsException)&&(clearInterval(e),window.clientVarsException&&a.network.isOnline)){var n={message:o.a.t("请求数据超时，请重试"),commonTipsType:"info",autoClose:!1,action:[{text:o.a.t("刷新"),onClick:i.tencentDocOpenUrlReload}]};if(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return/mobile|android/i.test(e)}())return void Promise.resolve().then(t.t.bind(null,"b74ee0edd6",7)).then((function(e){var t,a,i;null==e||null===(t=e.default)||void 0===t||null===(a=t.call(e))||void 0===a||null===(i=a.Snackbar)||void 0===i||i.show(n)})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}));Promise.resolve().then(t.t.bind(null,"82f2dc9440",7)).then((function(e){var t,a,i;null==e||null===(t=e.default)||void 0===t||null===(a=t.call(e))||void 0===a||null===(i=a.Snackbar)||void 0===i||i.show(n)})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))}}),1e3)}function d(){var e,n,t,a=!(null!==(e=r.a.PrivilegeManager())&&void 0!==e&&e.readable);return(c.a.isTencentDocApp||c.a.isTencentDocDesktopApp)&&(a=!1),a=(null===(n=r.a.DocInfoManager())||void 0===n?void 0:n.isDeleted)&&!(null!==(t=r.a.DocInfoManager())&&void 0!==t&&t.isOwner)||a}var u=function(){var e,n,t=null===(e=r.a.PrivilegeManager())||void 0===e?void 0:e.readable,a=null===(n=r.a.PrivilegeManager())||void 0===n?void 0:n.editable;return t&&!a}},"659f690fe6":function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("85d0a7609b"),s=t.n(r),d=function(){function e(n){i()(this,e),s()(this,"props",void 0),s()(this,"noEditService",void 0),s()(this,"editExtensionService",void 0),this.props=n,this.noEditService=n.noEditService,this.editExtensionService=n.extensionService}return o()(e,[{key:"hide",value:function(e){}},{key:"show",value:function(e){}},{key:"dispose",value:function(){}}]),e}();s()(d,"pluginTag",0)},"678857d99e":function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t("9132715560"),i=t.n(a),c=t("85d0a7609b"),o=t.n(c),r=function e(){i()(this,e),o()(this,"editSlideComponent",void 0),o()(this,"playSlideComponent",void 0),this.editSlideComponent=void 0,this.playSlideComponent=void 0}},"6dfa2ef4e4":function(e,n,t){"use strict";t.d(n,"d",(function(){return l})),t.d(n,"b",(function(){return f})),t.d(n,"c",(function(){return v})),t.d(n,"a",(function(){return m}));var a=t("176815363d"),i=t.n(a),c=t("3ef2352f0b"),o=t.n(c),r=(t("8e7cce0ada"),t("c6244f7705"),t("081c8cafea"),t("85d48ef22b"),t("2a6f332b5e"),t("b40469cb12")),s=t("d3d31c86eb"),d=t("37091e4240"),u=Promise.race([new Promise((function(e){d.b.on(d.a.LOGIN_USER_INFO_READY_EVENT,e)})),new Promise((function(e){setTimeout(e,1e4)}))]),l=function(){var e=i()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u;case 4:Object(s.c)({opername:"doc_ai",module:"file_page",action:"show",ver5:h(),ver7:"ai",ver9:"slide"});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=i()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u;case 4:Object(s.c)({opername:"doc_ai",module:"file_page",action:"click",ver5:h(),ver7:"ai",ver9:"slide"});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=i()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u;case 4:Object(s.c)({opername:"doc_ai",module:"file_page",action:"output",ver5:h(),ver7:"ai",ver9:"slide"});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=i()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u;case 2:Object(s.c)({opername:"doc_ai",module:"entrance_btn",action:"click",ver5:h(),ver7:"mobile_topbutton",ver9:"slide"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function h(){var e,n,t=null===(e=r.a.extensionService.dependentServiceCombinder)||void 0===e||null===(n=e.accountApplication)||void 0===n?void 0:n.vipInfo;return null==t?void 0:t.type}function y(){var e,n;return 10102===(null===(e=window.basicClientVars)||void 0===e||null===(n=e.docInfo)||void 0===n?void 0:n.createSource)}},"779bf6072d":function(e,n,t){"use strict";(function(e){t.d(n,"a",(function(){return E}));t("73b854064b");var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("547611bd96"),s=t.n(r),d=t("8eec1e4a03"),u=t.n(d),l=t("bd29e2df90"),f=t.n(l),v=t("ab5eb40518"),m=t.n(v),h=t("1b4cdd6a36"),y=t.n(h),p=t("85d0a7609b"),b=t.n(p),g=t("78465da318"),A=t("743ef67b0e"),S=t("98c2de1441"),w=t("af643560ab"),k=t("05d181ac40");function I(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=y()(e);if(n){var i=y()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return m()(this,t)}}var E=function(n){f()(a,n);var t=I(a);function a(){var n;return i()(this,a),n=t.call(this),b()(s()(n),"viewableServiceLayer",void 0),b()(s()(n),"uiDataService",void 0),n.uiDataService=new A.a,k.a.IS_TEST&&(e.appServices=s()(n),w.a.getInstance(),S.a.getInstance().init()),n.viewableServiceLayer=n.createViewableServiceLayer(),n}return o()(a,[{key:"getUiDataService",value:function(){return this.uiDataService}},{key:"init",value:function(){u()(y()(a.prototype),"init",this).call(this),this.uiDataService.init()}}]),a}(g.a)}).call(this,t("5ef37df1a0"))},"78465da318":function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("85d0a7609b"),s=t.n(r),d=function(){function e(){i()(this,e),s()(this,"infrastructureService",void 0),this.infrastructureService=this.newInfrastructureService(),this.infrastructureService.init()}return o()(e,[{key:"getInfrastructureService",value:function(){return this.infrastructureService}},{key:"init",value:function(){}},{key:"getEntryType",value:function(){return this.infrastructureService.getEntryType()}}]),e}()},"7e2d428441":function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var a,i=t("176815363d"),c=t.n(i),o=t("3ef2352f0b"),r=t.n(o),s=(t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),{name:"live-manager",loadType:"on-demand",module:(a=c()(r.a.mark((function e(){var n,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e("vendors~service")]).then(t.bind(null,"4c94f9c8ed"));case 2:return n=e.sent.default,e.next=5,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e("vendors~service")]).then(t.bind(null,"4399df1885"));case 5:return a=e.sent,i=a.LiveManagerInjectable,e.abrupt("return",new n(new i));case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})})},"82b9f13b01":function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("85d0a7609b"),s=t.n(r),d=t("05d181ac40"),u=t("b86964b011"),l=t("020899bf26"),f=t("7e61746219"),v=function(){function e(){i()(this,e),s()(this,"isPreviewOnly",(function(){var e,n,t=null===(e=l.a.PrivilegeManager())||void 0===e?void 0:e.readable,a=null===(n=l.a.PrivilegeManager())||void 0===n?void 0:n.editable;return t&&!a}))}return o()(e,[{key:"checkIsSupportAI",value:function(){return!d.a.IS_LOCAL_EDIT&&(!Object(f.d)()&&!(!Object(u.k)()||Object(u.q)()||this.isPreviewOnly()))}}]),e}()},"8897cfe637":function(e,n,t){"use strict";t.d(n,"c",(function(){return a})),t.d(n,"i",(function(){return i})),t.d(n,"e",(function(){return c})),t.d(n,"a",(function(){return o})),t.d(n,"f",(function(){return r})),t.d(n,"d",(function(){return s})),t.d(n,"j",(function(){return d})),t.d(n,"g",(function(){return u})),t.d(n,"b",(function(){return l})),t.d(n,"h",(function(){return f}));var a=1,i=1,c=16,o=1,r=2,s=0,d=0,u=40.64,l=.1,f=7},"8ec5e2d62d":function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=function(){function e(){i()(this,e)}return o()(e,[{key:"isHeaderFold",value:function(){return!1}},{key:"isStatusBarFold",value:function(){return!1}}]),e}()},"92b34d2ba5":function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var a=t("9132715560"),i=t.n(a),c=function e(){i()(this,e),this.initAppServices(),this.initAppUI()}},"952a9e001a":function(e,n,t){"use strict";t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return s})),t.d(n,"a",(function(){return d}));var a=t("176815363d"),i=t.n(a),c=t("3ef2352f0b"),o=t.n(c),r=(t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),{name:"copy-paste-manager-pc",loadType:"on-demand",module:function(){return i()(o.a.mark((function e(){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"899628eb65"));case 2:return n=e.sent,a=n.PcCopyPaste,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}}),s={name:"copy-paste-manager-mobile",loadType:"eager",module:function(){return i()(o.a.mark((function e(){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"58f952d683"));case 2:return n=e.sent,a=n.MobileCopyPaste,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}},d={name:"copy-paste-image",loadType:"on-demand",module:function(){return i()(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"f1242c9f64"));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))()}}},"9ca0dd6665":function(e,n,t){"use strict";t.d(n,"a",(function(){return D}));t("73b854064b");var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("bd29e2df90"),s=t.n(r),d=t("ab5eb40518"),u=t.n(d),l=t("1b4cdd6a36"),f=t.n(l),v=(t("4bbb5840d5"),t("1bab7b5fb7"),t("9d7978d445"),t("2504ad7290"),t("3bf1976a4f"),t("8a35b54c1d"),t("241849730e")),m=t("560bea0cc4"),h=t("77c89fc0e0"),y=t("3d79fbe88f"),p=t.n(y),b=t("4f3b15d017"),g=t("93c0e9f7e2"),A=t("020899bf26"),S=t("76f3a50d5c"),w=t("ae00e26606"),k=t("e0a67dc3fe"),I=t("7e61746219"),E=t("915616c11c");function M(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=f()(e);if(n){var i=f()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return u()(this,t)}}var P=function(e){s()(t,e);var n=M(t);function t(){return i()(this,t),n.apply(this,arguments)}return o()(t,[{key:"initPlugin",value:function(){var e,n=this;null===(e=this.editExtensionService)||void 0===e||e.onReady((function(){n.init()}))}},{key:"setRightButton",value:function(){var e=function(e){for(var n={},t=(e.startsWith("?")?e.substr(1):e).split("&"),a=0;a<t.length;a++)n[t[a].split("=")[0]]=unescape(t[a].split("=")[1]);return n}(window.location.search),n=Object(h.k)("group_code"),t=Object(h.k)("is_create_doc"),a=Object(k.b)("titlebar.share",!0);if("1"===e.preview||n&&t||!a){if(!a)try{var i;null===(i=window.mqq)||void 0===i||i.ui.setTitleButtons({right:{hidden:!0}})}catch(e){}}else try{var c;null===(c=window.mqq)||void 0===c||c.ui.setTitleButtons({right:{iconID:4,callback:function(){A.a.DocInfoManager.promise().then((function(e){e.setDocVisible()})),void 0!==window.isCooperationMobileOpen&&window.isCooperationMobileOpen&&void 0!==window.cooperationMobile&&window.cooperationMobile.remove(),window.mqq.ui.showShareMenu()}}})}catch(e){}}},{key:"handleShare",value:function(e){if(h.i.isMiniProgram)this.navigateToSharePanel();else if(this.hasNativeShare()){var n=null==e?void 0:e.isAutoShare;this.navigateToNativeShare(n?{fromConverted4Share:!0}:{})}else(b.default.isMobileQQBrowser||Object(k.b)("custom.mobile.shareMethods.navigateToH5",!1))&&this.navigateToH5Share()}},{key:"hasNativeShare",value:function(){return this.allowSetNativeShareButton()||h.i.isPad&&Object(h.m)("2.1.8")}},{key:"allowSetNativeShareButton",value:function(){return b.default.isTencentDocsAppVersionAboveOrEqual("2.4.0")}},{key:"showShare",value:function(){var e,n,t;null===(e=window.mqq)||void 0===e||null===(n=e.ui)||void 0===n||null===(t=n.showShareMenu)||void 0===t||t.call(n)}},{key:"navigateToNativeShare",value:function(e){if(window.mqq){var n,t,a;A.a.DocInfoManager.promise().then((function(e){e.setDocVisible()}));var i=e||{},c=null!==(n=A.a.DocInfoManager())&&void 0!==n?n:{},o=c.isOwner,r=c.isCreator,s=c.domainId,d=c.policy,u=c.localPadId,l=c.rightFlag;i.share_url=this.getShareLink(),i.title=null===(t=A.a.SlideTitleManager())||void 0===t?void 0:t.title,i.source_name=h.l.t("腾讯文档"),i.desc=h.l.t("腾讯文档-在线幻灯片"),i.image_url=p.a["file_slide_transparent_150@2x"],h.i.isAndroid&&(i.image_url=p.a["file_slide_150@2x"]),i.type="slide",i.miniprogram_image_url=p.a["file_slide_500@2x"],i.rightFlag=l,i.policy=o?this.getPolicy():d,i.editable=null===(a=A.a.PrivilegeManager())||void 0===a?void 0:a.editable,i.contentEdited=!0,i.isCreator=r||!1;var f=Object(h.k)("group_code");f&&(i.groupCode=f),i.domainId=s,i.localPadId=u,window.mqq.invoke("docx","showSharePage",i,(function(){}))}}},{key:"navigateToH5Share",value:function(){var e,n=null!==(e=A.a.DocInfoManager())&&void 0!==e?e:{},t=n.padId,a=void 0===t?"":t,i=n.domainId,c=void 0===i?"":i,o="https://".concat(window.hostname,"/scenario/share.html?id=").concat(c,"$").concat(a,"&from=detail");Object(E.a)({url:o})}},{key:"getAuthPluginName",value:function(){return m.a}},{key:"shouldShareForClient",value:function(){return h.i.isTencentDocApp||h.i.isTimQQ||h.i.isQQ}},{key:"init",value:function(){var e,n,t,a=this;if(this.setRightButton(),this.setShareInfo(),this.updateShareObjectToClient(),null===(e=this.getAuthPlugin())||void 0===e||e.onAuthEvent(w.a.AUTH_CHANGE,(function(){a.setShareInfo(),a.updateShareObjectToClient()})),null===(n=this.getAuthPlugin())||void 0===n||n.onAuthEvent(w.a.AUTH_EXPIRED,(function(){a.updateShareObjectToClient()})),null===(t=this.getAuthPlugin())||void 0===t||t.onAuthEvent(w.a.AUTH_EXP_TIME_CHANGE,(function(){a.updateShareObjectToClient()})),window.openCooperationMobile=function(){var e=a.getAuthPlugin();null==e||e.show({isCalledBySharePanel:!0,isAdvPremissions:!1})},window.openAdvPermissionsMobile=function(){var e=a.getAuthPlugin();null==e||e.show({isCalledBySharePanel:!0,isAdvPremissions:!0})},window.mqq&&h.i.isTencentDocApp&&"wx"!==Object(g.loginType)()){var i,c,o=null!==(i=A.a.DocInfoManager())&&void 0!==i?i:{},r=o.creatorDomain,s=o.padId,d=o.padType,u=o.policy,l=o.domainId,f=(null!==(c=A.a.SlideTitleManager())&&void 0!==c?c:{}).title,v=document.getElementById("authContainer");window.shareToQQInApp=function(){h.h.load("CooperationMobileV2",(function(e){var n;null===(n=window.log)||void 0===n||n.info("[app] Share module load CooperationMobileV2 success"),e.showQQShare(v,{padInfo:{creatorDomain:r,padId:s,title:f,padType:d,policy:u,domainId:l}})}),(function(e){var n;null===(n=window.log)||void 0===n||n.error("[app] Share module load CooperationMobileV2 fail: ".concat(e))}))},window.mqq.invoke("ui","setOnShareQQFriendHandler",{callback:"shareToQQInApp"})}}},{key:"setShareInfo",value:function(){var e,n,t,a,i,c=this;if(!(Object(I.f)()||null!==(e=this.editExtensionService)&&void 0!==e&&e.isEditableDriveDocs()||h.e.IS_MOBILE_LOCAL_EDIT)){var o={},r=null!==(n=A.a.DocInfoManager())&&void 0!==n?n:{},s=r.isOwner,d=r.isCreator,u=r.domainId,l=r.policy,f=r.localPadId,v=r.rightFlag;o.share_url=this.getShareLink(null===(t=this.editExtensionService)||void 0===t?void 0:t.isSpecialActivity()),o.title=null===(a=A.a.SlideTitleManager())||void 0===a?void 0:a.title,o.source_name=h.l.t("腾讯文档"),o.desc=h.l.t("腾讯文档-在线幻灯片"),o.image_url=p.a["file_slide_transparent_150@2x"],h.i.isAndroid&&(o.image_url=p.a["file_slide_150@2x"]),o.type="slide",o.miniprogram_image_url=p.a["file_slide_500@2x"],o.rightFlag=v,o.policy=s?this.getPolicy():l,o.editable=null===(i=A.a.PrivilegeManager())||void 0===i?void 0:i.editable,o.contentEdited=!0,o.isCreator=d||!1;var m=Object(h.k)("group_code");m&&(o.groupCode=m),o.domainId=u,o.localPadId=f,S.a.getInstance().onLoadFinish((function(){setTimeout((function(){c.setWxShareInfo(o)}),500)})),this.allowSetNativeShareButton()&&(o.showShareBtn=!1),window.mqq&&window.mqq.invoke("data","setShareInfo",o,(function(){}))}}},{key:"setWxShareInfo",value:function(e){var n=e.title,t=e.desc,a=e.share_url,i=e.image_url;window.wx.onMenuShareAppMessage({title:n,desc:t,link:a,imgUrl:i,type:"",dataUrl:"",success:function(){},cancel:function(){},trigger:function(){}}),window.wx.onMenuShareTimeline({title:n,link:a,imgUrl:i,success:function(){},cancel:function(){},trigger:function(){}}),window.wx.onMenuShareQQ({title:n,desc:t,link:a,imgUrl:i,success:function(){},cancel:function(){}})}},{key:"updateShareObjectToClient",value:function(){var e,n=this.initShareObject(),t=null===(e=this.getAuthPlugin())||void 0===e?void 0:e.getAuth();this.setAuthInfoToShareObject(null==t?void 0:t.info,null==t?void 0:t.isAuthExpired(),n),window.mqq&&this.shouldShareForClient()&&window.mqq.invoke("docx","setAuthForSharePad",n,(function(){}))}},{key:"initShareObject",value:function(){var e,n,t=null!==(e=A.a.DocInfoManager())&&void 0!==e?e:{},a=t.domainId,i=t.localPadId,c=t.policy,o=t.isCreator,r=t.padId,s=(null!==(n=A.a.SlideTitleManager())&&void 0!==n?n:{}).title,d={authFirstLineInfo:"",authSecondLineInfo:""};return d.docName=s,d.docType=4,d.taskType=1,d.share_url=this.getShareLink(),d.domainId=a,d.localPadId=i,d.memLength=0,d.memListPrefix="",d.descriptionSuffix="",d.policy=c||2,d.isCreator=o||!1,d.padId=r,d}},{key:"setAuthInfoToShareObject",value:function(e,n,t){if(e&&t){var a;if(!!h.o.MQQLargerOrEqual("7.7.0")&&((null===(a=A.a.DocInfoManager())||void 0===a?void 0:a.isOwner)&&n))t.taskType=2,t.authFirstLineInfo=h.l.t("文档访问链接已失效"),t.authSecondLineInfo=h.l.t("他人将无法访问该文档。"),t.memLength=0,t.memListPrefix="",t.descriptionSuffix="";else if(t.taskType=1,t.policy=e.policy,t.authFirstLineInfo=this.getAuthTips(e.policy),e.memlist&&e.memlist.length>0&&0!==e.policy&&3!==e.policy){var i=e.memlist.filter((function(e){return 2===e.info}));t.memLength=i.length,0!==i.length?(t.memListPrefix=this.getMemberTips(i),t.descriptionSuffix=h.l.t("其中{0}位成员可编辑:",{0:i.length})):(t.memListPrefix="",t.descriptionSuffix="")}else t.memLength=0,t.memListPrefix="",t.descriptionSuffix=""}}},{key:"getAuthTips",value:function(e){var n=h.l.t("获得链接的任何人可查看文档");switch(e){case 0:n=h.l.t("仅自己可查看/编辑文档");break;case 1:n=h.l.t("仅指定的人可查看/编辑文档");break;case 2:n=h.l.t("获得链接的任何人可查看文档");break;case 3:n=h.l.t("获得链接的任何人可编辑文档")}return n}},{key:"getMemberTips",value:function(e){var n="";if(e.length>0)for(var t=0;t<Math.min(e.length,10);t++)""!==n||0!==t?n+="、".concat(e[t].nick):n=e[t].nick;return n}},{key:"getPolicy",value:function(){var e,n;return(null===(e=this.getAuthPlugin())||void 0===e?void 0:e.getAuth().policy)||(null===(n=A.a.DocInfoManager())||void 0===n?void 0:n.policy)||0}}]),t}(v.a),D={name:t("22db601e95").a,plugin:P}},"9eab16bf4b":function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a={name:"docs-component-file-info-panel",loadType:t("0d2ffd3bdb").LoadType.ON_DEMAND}},"9f30d1ac4c":function(e,n,t){"use strict";t.d(n,"a",(function(){return I}));var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("85d0a7609b"),s=t.n(r),d=t("37d9b74ca9"),u=t("cbac204f34"),l=t("952a9e001a"),f=t("d0b83a822c"),v=t("176815363d"),m=t.n(v),h=t("3ef2352f0b"),y=t.n(h),p=(t("c6244f7705"),t("081c8cafea"),t("b1e2246d82"),t("d3d31c86eb")),b=t("9da6335152"),g=t("b40469cb12"),A=t("101e2283b4"),S=function(){function e(n){i()(this,e),s()(this,"injectable",void 0),this.injectable=n}var n;return o()(e,[{key:"showDialog",value:function(){Object(p.c)({opername:b.e.DOC_EDITOR_TOPBAR_PC,module:b.d.MORE_MENU,action:b.b.PERMISSION});var e=this.getDialogContainer();this.injectable.showAdvancedPermissionDialog(e)||this.showDCDialog(e)}},{key:"getDialogContainer",value:function(){var e="avd-container",n=document.getElementById(e);return n||((n=document.createElement("div")).id=e,document.body.appendChild(n)),n}},{key:"showDCDialog",value:(n=m()(y.a.mark((function e(n){var t,a,i,c,o,r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.extensionService.getExtension(A.a.name);case 2:t=e.sent,a=window.clientVars,i=a.creatorDomain,c=a.domainId,o=a.padId,r=a.padType,s=a.userId,t.show({container:n,domainId:c,padId:o,creatorDomain:i,padType:r,userId:s,invokeFrom:"TitleBar"});case 5:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),e}(),w=function(){function e(){i()(this,e)}return o()(e,[{key:"showAdvancedPermissionDialog",value:function(e){return!1}}]),e}(),k=t("e10f45eba9"),I=function(){function e(n,t){var a=this;i()(this,e),s()(this,"undoRedoService",void 0),s()(this,"menuManager",void 0),s()(this,"advancedPermissionManager",void 0),s()(this,"syncFileManager",void 0),s()(this,"copyPasteImageService",void 0),this.uiDataService=n,this.viewableServiceLayer=t,this.undoRedoService=new d.a,this.menuManager=new f.a({}),this.menuManager.setUiDataServiceDelegate(n),this.menuManager.setSelectionServiceDelegate(this.viewableServiceLayer.selectionService),this.menuManager.fontManager=this.viewableServiceLayer.fontManager,this.menuManager.setUserPriviledgeServiceDelegate(this.viewableServiceLayer.userPriviledgeService),this.menuManager.accessibilityManager=this.viewableServiceLayer.accessibilityManager,this.menuManager.setToolbarStateManagerDelegate(this.viewableServiceLayer.toolbarStateManager),this.advancedPermissionManager=new S(this.createAdvancedPermissionInject()),this.syncFileManager=new k.a,t.linkManager.setMenuManagerDelegate(this.menuManager),this.copyPasteImageService=u.a.getInstance().registerDynamicService(l.a),t.addonManager.setCopyPasteImageService(this.copyPasteImageService),t.addonManager.setMenuManagerDelegate(this.menuManager),this.copyPasteImageService.onDidInit((function(e){e.setMenuManagerDelegate(a.menuManager)}))}return o()(e,[{key:"createAdvancedPermissionInject",value:function(){return new w}}]),e}()},a336bd4d91:function(e,n,t){"use strict";t.d(n,"a",(function(){return y}));t("73b854064b");var a=t("9132715560"),i=t.n(a),c=t("547611bd96"),o=t.n(c),r=t("bd29e2df90"),s=t.n(r),d=t("ab5eb40518"),u=t.n(d),l=t("1b4cdd6a36"),f=t.n(l),v=t("85d0a7609b"),m=t.n(v);t("3bf1976a4f");function h(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=f()(e);if(n){var i=f()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return u()(this,t)}}var y=function(e){s()(t,e);var n=h(t);function t(){var e;i()(this,t);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return e=n.call.apply(n,[this].concat(c)),m()(o()(e),"editableServiceLayer",void 0),e}return t}(t("779bf6072d").a)},aaf7ed577b:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return o}));var a=t("14502724a6"),i=t.n(a);t("a2a09da1e3"),t("8ee19818c4"),t("1bab7b5fb7"),t("9d7978d445");function c(e,n){var t=e.substring(e.indexOf("?")+1),a=null;return t&&t.split("&").forEach((function(e){var t=e.split("="),c=i()(t,2),o=c[0],r=c[1];o===n&&(a=r)})),a}function o(e){var n,t;return!(null===(n=e.props)||void 0===n||!n.addon||"latex"!==(null===(t=e.props.addon)||void 0===t?void 0:t.type))}},ae00e26606:function(e,n,t){"use strict";var a;t.d(n,"a",(function(){return a})),function(e){e.AUTH_MANAGER_READY="AuthManagerReady",e.AUTH_CHANGE="onAuthChanged",e.AUTH_EXP_TIME_CHANGE="onAuthExpTimeChanged",e.AUTH_EXPIRED="onAuthExpired",e.AUTH_PRIVILEGE_CHANGE="onAuthPrivilegeChange",e.AUTH_MODIFIED="onAuthModified"}(a||(a={}))},b1323c0a9f:function(e,n,t){"use strict";t.d(n,"a",(function(){return on}));t("73b854064b");var a,i=t("9132715560"),c=t.n(i),o=t("547611bd96"),r=t.n(o),s=t("bd29e2df90"),d=t.n(s),u=t("ab5eb40518"),l=t.n(u),f=t("1b4cdd6a36"),v=t.n(f),m=t("85d0a7609b"),h=t.n(m),y=t("6a364eb35c"),p=t.n(y),b=t("7a5536c9bf"),g=t.n(b),A=(t("3bf1976a4f"),t("8a35b54c1d"),t("8ee19818c4"),t("6e20b6a7d8"),t("563386153f"),t("a7888a8b87")),S=t.n(A),w=t("9657b29818"),k=t("eabf3daf43"),I=t("814e87bed8"),E=t("e0e8dd9366"),M=t("14c02e2331"),P=t("ffc220634f"),D=t("123ec094e2");!function(e){e.TABLE="table",e.SHAPE="shape"}(a||(a={}));var O=["del","backgroundColor","color","tdColor","fontSize","fontWeight","fontStyle","textDecoration","gradFill","fonts","fontFamily","letterSpacing",M.y].concat(g()(M.z),[M.A,M.x]),x=function(){function e(){c()(this,e),h()(this,"selectedElementsManager",void 0),h()(this,"selectionService",void 0)}return p()(e,[{key:"setSelectionServiceDelegate",value:function(e){this.selectionService||(this.selectionService=e,this.selectedElementsManager=e.selectedElements)}},{key:"executeClear",value:function(){var e,n,t,i=this,c=null===(e=this.selectedElementsManager)||void 0===e||null===(n=e.selectedArray)||void 0===n||null===(t=n.filter)||void 0===t?void 0:t.call(n,(function(e){return!!e})),o=[];null==c||c.forEach((function(e){switch(null==e?void 0:e.type){case E.d.GROUP:o=[].concat(g()(o),g()(i.dealGroup(e)));break;case E.d.TABLE:o.push(i.dealTable(e));break;case E.d.SHAPE:o.push(i.dealShape(e));break;case E.d.CHART:var n=i.dealChart(e);n&&o.push(n)}})),Object(w.b)((function(){o.forEach((function(e){if(e.type===a.TABLE){var n=e.tableItem,t=e.props;n.updateTableAllParagraphList(t)}else{var c=e.shapeItem,o=e.paragraphList;i.updateShapeProps(c,o)}}))}))}},{key:"updateShapeProps",value:function(e,n){if(e.isPlaceholder&&e.isFromLayout){var t=Object(P.h)(e),a=!Object(P.o)(n)&&!Object(P.n)(n,t);e.updateMasterAndLayoutPlaceHolder(n,null,a)}else e.updateParagraphList(n)}},{key:"dealGroup",value:function(e){var n=this,t=[];return((null==e?void 0:e.children)||[]).forEach((function(e){switch(null==e?void 0:e.type){case E.d.GROUP:t=[].concat(g()(t),g()(n.dealGroup(e)));break;case E.d.TABLE:t.push(n.dealTable(e));break;case E.d.SHAPE:t.push(n.dealShape(e));break;case E.d.CHART:var a=n.dealChart(e);a&&t.push(a)}})),t}},{key:"dealTable",value:function(e){var n,t=this,i=((null==e||null===(n=e.props)||void 0===n?void 0:n.items)||[]).map((function(n,a){return n.map((function(n,i){var c=n.hMerge||n.vMerge,o=!e.selectedRange||!e.cellSelectedState(a,i,e.selectedRange);if(!c&&!o)return{paragraphList:t.dealShape(n).paragraphList,textBodyStyle:n.textBodyStyle}}))}));return{type:a.TABLE,tableItem:e,props:{items:i}}}},{key:"dealShape",value:function(e){var n,t,i,c=null==e||null===(n=e.editorInstance)||void 0===n?void 0:n.getSelection();return i=(null==e||null===(t=e.editorInstance)||void 0===t?void 0:t.isEditing)&&!!c?this.dealEditingShape(e):this.dealNormalShape(e),{type:a.SHAPE,shapeItem:e,paragraphList:i}}},{key:"dealChart",value:function(e){var n,t,i=null==e||null===(n=e.editorInstance)||void 0===n?void 0:n.getSelection();if((null==e||null===(t=e.editorInstance)||void 0===t?void 0:t.isEditing)&&!!i){var c=this.dealEditingShape(e);return{type:a.SHAPE,shapeItem:e,paragraphList:c}}}},{key:"dealEditingShape",value:function(e){for(var n,t,a,i=null==e||null===(n=e.editorInstance)||void 0===n?void 0:n.getSelection(),c=null==e||null===(t=e.editorInstance)||void 0===t||null===(a=t.getData)||void 0===a?void 0:a.call(t),o=S()((null==c?void 0:c.paragraphList)||[]),r=Object(D.a)(null==i?void 0:i.anchor,null==i?void 0:i.focus),s=r.sIndex,d=void 0===s?0:s,u=r.eIndex,l=void 0===u?o.length-1:u,f=r.sOffset,v=void 0===f?0:f,m=r.eOffset,h=void 0===m?0:m,y=d;y<=l;y++){var p=i&&d===y?v:0,b=i&&l===y?h:Object(k.g)(o[y]),g=o[y].textRuns;if(0!==Object(k.g)({textRuns:g})&&p!==b){var A=Object(I.c)(g,p,b),w=A.textRuns,E=A.startIndex,M=A.endIndex;if(null!==E&&null!==M)for(var P=E;P<=M;P++)w[P]=this.resetTextRunStyles(w[P]);o[y].textRuns=w}}return o}},{key:"dealNormalShape",value:function(e){var n=this,t=S()((null==e?void 0:e.paragraphList)||[]);return t.forEach((function(e,a){var i;t[a].endParaRPr=n.resetEndParaRPr(e.endParaRPr),t[a].textRuns=null===(i=e.textRuns)||void 0===i?void 0:i.map((function(e){return n.resetTextRunStyles(e)}))})),t}},{key:"resetEndParaRPr",value:function(e){var n=S()(e);return null!=n&&n.useEndParaStyle&&O.forEach((function(e){e in(n||{})&&(n[e]=null,n["raw-".concat(e)]=!0)})),n}},{key:"resetTextRunStyles",value:function(e){var n=S()(e);return O.forEach((function(e){e in((null==n?void 0:n.styles)||{})&&(n.styles[e]=null,n.styles["raw-".concat(e)]=!0)})),n}}]),e}(),T=t("f2bfa864ad"),C=t("b572eb71ea"),R=t("e6043b1d9c"),L=t("60329c397a"),_=t("11a20d9676"),j=t("62f93f77a8"),N=t("997508b724"),U=t("33c34da0d5"),F=t("ee6bb53310"),B=t.n(F),H=t("82826243ac"),G=t("7a4a9cf3b8"),W=t("ed9b19c8a4"),z=function(){function e(){c()(this,e),h()(this,"model",void 0)}return p()(e,[{key:"updatePathListWhenSizeChange",value:function(e,n){var t,a,i,c,o;if(this.model=e,Object(H.a)(null===(t=this.borderInfo)||void 0===t||null===(a=t.sketchStyle)||void 0===a?void 0:a.type)){var r,s,d,u,l,f,v=null!==(i=e.operatingGraphicInfo)&&void 0!==i&&i.pathList?e.operatingGraphicInfo.pathList:G.a.generateSketchPathList({model:this.model,type:null===(c=this.borderInfo)||void 0===c||null===(o=c.sketchStyle)||void 0===o?void 0:o.type,style:n}),m={style:{bgShape:U.e.CUSTOM,customGeom:W.a.getCustomGeom(this.model,v)}};if(null!=n&&n.controlValues)B()(m,"style.border.sketchStyle.bgShape",null===(r=this.borderInfo)||void 0===r||null===(s=r.sketchStyle)||void 0===s?void 0:s.bgShape),B()(m,"style.border.sketchStyle.controlValues",n.controlValues),B()(m,"style.border.sketchStyle.type",null===(d=this.borderInfo)||void 0===d||null===(u=d.sketchStyle)||void 0===u?void 0:u.type);if(null!=n&&n.bgShape)B()(m,"style.border.sketchStyle.bgShape",n.bgShape),B()(m,"style.border.sketchStyle.controlValues",[]),B()(m,"style.border.sketchStyle.type",null===(l=this.borderInfo)||void 0===l||null===(f=l.sketchStyle)||void 0===f?void 0:f.type);B()(this.model,"operatingGraphicInfo",null),this.model.updateProps(m)}}},{key:"updatePathListUIWhenSizeChange",value:function(e,n){var t,a,i,c,o,r,s,d,u,l;if((this.model=e,Object(H.a)(null===(t=this.borderInfo)||void 0===t||null===(a=t.sketchStyle)||void 0===a?void 0:a.type))&&!((null===(i=e.operatingGraphicInfo)||void 0===i||null===(c=i.pathList)||void 0===c||null===(o=c[0])||void 0===o?void 0:o.width)===(null==n?void 0:n.width)&&(null===(r=e.operatingGraphicInfo)||void 0===r||null===(s=r.pathList)||void 0===s||null===(d=s[0])||void 0===d?void 0:d.height)===(null==n?void 0:n.height))){var f=G.a.generateSketchPathList({model:this.model,type:null===(u=this.borderInfo)||void 0===u||null===(l=u.sketchStyle)||void 0===l?void 0:l.type,style:n});B()(this.model,"operatingGraphicInfo.pathList",f)}}},{key:"updatePathWithFormatBrush",value:function(e,n){var t,a,i,c,o,r,s,d;if((e.type===E.d.SHAPE||e.type===E.d.IMAGE)&&(this.model=e,(Object(H.a)(null===(t=this.borderInfo)||void 0===t||null===(a=t.sketchStyle)||void 0===a?void 0:a.type)||Object(H.a)(null==n||null===(i=n.border)||void 0===i||null===(c=i.sketchStyle)||void 0===c?void 0:c.type))&&(null===(o=this.borderInfo)||void 0===o||null===(r=o.sketchStyle)||void 0===r?void 0:r.type)!==(null==n||null===(s=n.border)||void 0===s||null===(d=s.sketchStyle)||void 0===d?void 0:d.type))){var u={},l={};W.a.updateSketchUpdateAndRemoveProps(e,{style:n},{update:u,remove:l}),this.model.updateAndRemoveProps(u,l)}}},{key:"getSketchPathList",value:function(e,n){var t,a;return this.model=e,G.a.generateSketchPathList({model:this.model,type:null===(t=this.borderInfo)||void 0===t||null===(a=t.sketchStyle)||void 0===a?void 0:a.type,style:n})}},{key:"borderInfo",get:function(){var e,n;return null===(e=(n=this.model).getBorder)||void 0===e?void 0:e.call(n).getBorderInfo()}}]),e}(),V=t("6fc2b77709"),q=(t("826dc923b3"),t("1bab7b5fb7"),t("9d7978d445"),t("ea3a38d9d4")),K=t("4f3b15d017"),Y=t("9da6335152"),Q=t("d3d31c86eb"),X=function(){function e(n){var t=this;c()(this,e),h()(this,"useNewEyeDropper",!0),h()(this,"colorPickerService",void 0),h()(this,"themePreset",1),h()(this,"menuManager",void 0),h()(this,"isShowColorPicker",!1),h()(this,"panelContainer",void 0),h()(this,"setRecentColor",(function(e){var n,a;null===(n=t.colorPickerService)||void 0===n||null===(a=n.setRecentColors)||void 0===a||a.call(n,{color:e})})),h()(this,"handleFontColorChange",(function(e){var n=e.id,a=e.color,i=e.option;t.menuManager.toolbarMenu().callback(q.a.TOOLBAR,n,a,i)})),h()(this,"closeGlobalColorPanel",(function(){t.panelContainer&&document.body.removeChild(t.panelContainer),t.isShowColorPicker=!1,document.removeEventListener("mouseup",t.closeGlobalColorPanel)})),h()(this,"browserCheck",(function(){var e=K.default.isChrome,n=K.default.isElectronTencentDocsClient,t=K.default.getElectronTencentDocsClientVersion,a=K.default.getChromeVersion;if(e){var i=a();if(i)return Number(i.split(".")[0])>=95}else if(n){var c=t();try{var o=(null==c?void 0:c.split(".").map((function(e){return Number(e)})))||[];if(o[0]||0===o[0]){var r=o[0];if(r<3)return!1;if(r>=4)return!0}if(o[1]||0===o[1]){var s=o[1];if(s<1)return!1;if(s>=2)return!0}if(o[2]||0===o[2])return o[2]>=9}catch(e){return window.log.error("[version parse error]",e),!1}return!0}return!1}));var a=n.menuManager;this.menuManager=a,this.useNewEyeDropper=this.browserCheck()}return p()(e,[{key:"setColorPickerExtension",value:function(e){this.colorPickerService=e}},{key:"colorPickerTdwReport",value:function(e){var n=e.color,t=e.colorPickerFrom,a=e.colorGroupFrom,i=e.actionType,c=t,o=a,r=n;Object(Q.c)({opername:Y.e.DOC_PPT,module:Y.d.COLOR_MODULE,action:Y.b.COLOR_PICKER_ACTION,eventcode:Y.a.COLOR_PICKER_EVENT_CODE,ver5:i,ver6:c,ver7:o,ver8:this.themePreset,ver9:r})}},{key:"getContainerTopByIsRevert",value:function(e){var n=e;return e>335&&document.body.offsetHeight-e<335&&(n=e-335),n}},{key:"handleGlobalPanelColorChange",value:function(e,n,t){null==e||e(n,t),this.closeGlobalColorPanel()}}]),e}(),J=t("0ef902d941"),$=t("9f30d1ac4c"),Z=t("176815363d"),ee=t.n(Z),ne=t("3ef2352f0b"),te=t.n(ne),ae=(t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),t("402eb050f3")),ie=t("8b13fcae36"),ce=t("3825cc7c15"),oe=t("798a9cd6f2"),re=t("020899bf26"),se=t("9049777d9b"),de=t("aba9dcef64"),ue=t("5ce71228c0");function le(e,n){n.createdDate=+new Date;var t=ue.b.getItem(ue.a.DOCS_ACTIONS,[]),a={};t.forEach((function(e,n){a["".concat(e.localPadId,"$").concat(e.domainId)]={index:n,value:e}}));var i=a["".concat(n.localPadId,"$").concat(n.domainId)];i?t[i.index]={type:fe(i,e),data:i.value}:t.push({type:"ADD",data:n}),ue.b.setItem(ue.a.DOCS_ACTIONS,t)}function fe(e,n){return"ADD"===e.value&&"MODIFY"===n?"ADD":n}var ve,me,he,ye=function(){function e(){var n=this;c()(this,e),h()(this,"isFromTrash",!1),h()(this,"hasClickRecover",!1),h()(this,"showDialogCallback",void 0),h()(this,"onSlideAppReady",(function(){var e;n.isOwner()&&n.isDeleted()&&(null===(e=n.showDialogCallback)||void 0===e||e.call(n))}))}var n;return p()(e,[{key:"initialize",value:function(){var e=this;if(null!==Object(ce.d)("fromTrash")){this.isFromTrash=!0;var n=Object(ie.getMultUrl)(Object(ce.e)(document.location.href,"fromTrash"));history.replaceState(null,"",n)}var t=function(){var n;e.hasClickRecover||(e.isOwner()&&!ae.b.supportEnterprise(ae.a.ALL)?null===(n=e.showDialogCallback)||void 0===n||n.call(e):Object(ie.tencentDocOpenUrlReload)())};Object(re.b)(this.onSlideAppReady),re.a.SlideAppService.promise().then((function(){re.a.SDKDataServices.EventManager.promise().then((function(e){return e.socketEvents.onDeleteDoc(t)}))}))}},{key:"setShowDialogCallback",value:function(e){this.showDialogCallback=e}},{key:"recover",value:(n=ee()(te.a.mark((function e(n,a){var i,c,o,r,s,d,u,l,f,v,m,h,y,p,b,g,A,S=this;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(t.t.bind(null,"94806c1a0f",7));case 2:return o=e.sent,r=o.setGlobalAid,s=o.POSITIONS,e.next=7,Object(se.e)();case 7:return d=e.sent,u=d?"restore90":"restore",r({position:s.DETAIL,feature:"trash",apprec1:u,apprec2:"slide"}),this.hasClickRecover=!0,l=null!==(i=re.a.DocInfoManager())&&void 0!==i?i:{},f=l.domainId,v=void 0===f?"":f,m=l.padId,h=void 0===m?"":m,y=l.padType,p=void 0===y?"":y,b=null!==(c=re.a.SlideTitleManager())&&void 0!==c?c:{},g=b.title,A=void 0===g?"":g,e.next=15,de.a.OnlineApiService.promise();case 15:e.sent.recoverDoc(v,h).then((function(e){var t=e.data;0===t.retcode&&t.folder_info&&t.folder_info.folder_id?(null==n||n(),S.isFromTrash&&le("RECOVER",{domainId:v,localPadId:h,padType:p,title:A,url:window.location.href.split("#")[0],list_item_type:1,parent_folder_id:t.folder_info.folder_id}),setTimeout((function(){Object(ie.tencentDocOpenUrlReload)()}),2e3)):null==a||a(t.retcode)})).catch((function(e){null==a||a(e.retcode)}));case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"gotoTrash",value:function(){var e,n,t,a;K.default.isTencentDocsApp&&K.default.isTencentDocsAppVersionAboveOrEqual("2.2.0")?null===(n=window.mqq)||void 0===n||n.invoke("QQApi","jumpNativeList",{target:"Trash"}):K.default.isMiniProgram?null===(t=window.wx)||void 0===t||t.miniProgram.navigateBack():this.isFromTrash&&"function"==typeof(null===(e=window.tdocs)||void 0===e?void 0:e.popBack)?null===(a=window.tdocs)||void 0===a||a.popBack():Object(ie.setNewWindowUrl)(window,oe.a.LINK.RECYCLE)}},{key:"isOwner",value:function(){var e;return null===(e=re.a.DocInfoManager())||void 0===e?void 0:e.isOwner}},{key:"isDeleted",value:function(){var e;return null===(e=re.a.DocInfoManager())||void 0===e?void 0:e.isDeleted}}]),e}(),pe=t("31068517f9"),be=t("2c754d5254"),ge=t("cbac204f34"),Ae={name:"transfer-auth-manager",loadType:"on-demand",module:function(){return ee()(te.a.mark((function e(){var n;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"fb1b2fc56a"));case 2:return n=e.sent.default,e.abrupt("return",new n);case 4:case"end":return e.stop()}}),e)})))()}},Se=t("cd540f53a5"),we={name:"formula-ocr-manager",loadType:"on-demand",module:function(){return ee()(te.a.mark((function e(){var n,a;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"02eaf84550"));case 2:return n=e.sent,a=n.FormulaOcrManager,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}},ke=t("05d181ac40"),Ie=t("730477bb20"),Ee=t.n(Ie),Me=t("14502724a6"),Pe=t.n(Me),De=t("5fac0349d3"),Oe=t("37091e4240"),xe=t("82f2dc9440"),Te=t.n(xe),Ce=t("f8fc8e0087"),Re=t("77c89fc0e0"),Le=t("d5c3deb8c7"),_e=t("fbd47ef0af"),je=function(){function e(n,t,a,i){var o=this;c()(this,e),h()(this,"aiGenerator",void 0),h()(this,"isLayoutTemplate",!1),h()(this,"isCommitByAi",!1),h()(this,"snackbarLoading",void 0),h()(this,"userPriviledgeService",void 0),h()(this,"slideGenerateFinishCallback",void 0),h()(this,"isImageFirstGeneration",void 0),this.uiDataService=n,this.contentLayoutAnalyzer=t,this.viewableServiceLayer=a,this.changeTemplateDynamicService=i,this.userPriviledgeService=this.viewableServiceLayer.userPriviledgeService,"1"!==Object(Ce.getQuery)("openAiAssistant")&&"1"!==Object(Ce.getQuery)("AIGenerate")||Oe.b.on(Oe.a.FIRST_PAGE_DISPLAY,(function(){o.tryContinueWriting()}))}var n,a,i,o,r,s,d,u,l,f,v;return p()(e,[{key:"applyTemplate",value:(v=ee()(te.a.mark((function e(n){var t;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadAIGenerator();case 2:return e.next=4,this.aiGenerator.getTemplateDataById(n);case 4:return t=e.sent,this.markAiOperate(),e.next=8,this.applyTemplateByData(t,n);case 8:this.clearAiOperate();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"extractSlideContent",value:(f=ee()(te.a.mark((function e(){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadAIGenerator();case 2:return e.abrupt("return",this.aiGenerator.extractSlideContentAsMarkdownText());case 3:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"insertSlides",value:(l=ee()(te.a.mark((function e(n){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadAIGenerator();case 2:return this.markAiOperate(),e.next=5,this._insertSlides(n);case 5:this.clearAiOperate();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"insertSlideNotes",value:(u=ee()(te.a.mark((function e(n){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadAIGenerator();case 2:this.markAiOperate(),this.aiGenerator.insertSpeechTextIntoNotes(n),this.clearAiOperate();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"withLockAsync",value:(d=ee()(te.a.mark((function e(n){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.markAiOperate(),e.next=4,n();case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,this.clearAiOperate(),e.finish(5);case 8:case"end":return e.stop()}}),e,this,[[0,,5,8]])}))),function(e){return d.apply(this,arguments)})},{key:"withLock",value:function(e){try{return this.markAiOperate(),e()}finally{this.clearAiOperate()}}},{key:"onSlideGenerateFinish",value:function(e){this.slideGenerateFinishCallback=e}},{key:"enableImageGeneration",get:function(){return this.isImageFirstGeneration}},{key:"applyTemplateByData",value:(s=ee()(te.a.mark((function e(n,t){var a,i,c;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isLayoutTemplate){e.next=7;break}return e.next=3,this.aiGenerator.applyTemplate(n,t);case 3:(a=e.sent)&&this.aiGenerator.replacePresentation(a),e.next=11;break;case 7:return e.next=9,null===(i=this.changeTemplateDynamicService)||void 0===i?void 0:i.promise();case 9:null==(c=e.sent)||c.changeTemplate(n);case 11:case"end":return e.stop()}}),e,this)}))),function(e,n){return s.apply(this,arguments)})},{key:"_insertSlides",value:(r=ee()(te.a.mark((function e(n){var t,a=arguments;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>1&&void 0!==a[1]&&a[1],e.next=3,this.loadAIGenerator();case 3:if(this.snackbarLoading=Te.a.show({message:De.a.t("智能助手创作中，请不要关闭页面"),type:"loading",autoClose:!1}),!K.default.isMobile){e.next=6;break}return e.abrupt("return",this.insertSlidesMobile(n,t));case 6:return e.abrupt("return",this.insertSlidesPC(n,t));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"insertSlidesPC",value:(o=ee()(te.a.mark((function e(n){var t,a,i,c,o,r=this,s=arguments;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>1&&void 0!==s[1]&&s[1],this.userPriviledgeService.setPPTEditorState({state:Re.f.SELECTABLE}),a=this.userPriviledgeService.addStateWillChangeCallbacks((function(){return!1})),i=this.addUnloadListener(),c=this.addCurrentSlideChangeListener(),o=function(e){var n;a(),r.userPriviledgeService.setPPTEditorState({state:r.userPriviledgeService.fileAuth}),i(),c(),r.snackbarLoading.close(),null===(n=r.slideGenerateFinishCallback)||void 0===n||n.call(r,e)},e.prev=6,e.next=9,this.aiGenerator.insertSlides(n,t,(function(e){var n=e.total,t=e.left;r.snackbarLoading.update({message:"".concat(De.a.t("正在全力为您生成配图")," (").concat(n-t,"/").concat(n,")")})}));case 9:o("normal"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),o("error");case 15:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return o.apply(this,arguments)})},{key:"insertSlidesMobile",value:(i=ee()(te.a.mark((function e(n){var t,a,i,c,o=this,r=arguments;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>1&&void 0!==r[1]&&r[1],a=this.viewableServiceLayer,(i=a.mobilePreviewThumbnailListService).toggleToolbarDisabled(!0),c=Object(Le.r)((function(){return i.isListAtBottom}),(function(e){o.aiGenerator.shouldFocusOnAddPage=e})),e.prev=4,e.next=7,this.aiGenerator.insertSlides(n,t);case 7:return e.prev=7,i.toggleToolbarDisabled(!1),c(),this.snackbarLoading.close(),e.finish(7);case 12:case"end":return e.stop()}}),e,this,[[4,,7,12]])}))),function(e){return i.apply(this,arguments)})},{key:"tryContinueWriting",value:(a=ee()(te.a.mark((function e(){var n,a,i,c,o,r,s,d,u,l,f,v,m,h=this;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null!==(n=re.a.DocInfoManager())&&void 0!==n?n:{}).isOwner){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,re.a.SDKDataServices.PresentationStoreService.promise();case 5:if(1===(a=e.sent.getPresentation()).slideList.length){e.next=8;break}return e.abrupt("return");case 8:if(i=Pe()(a.slideList,1),c=i[0],null==(o=Object(_e.b)(c.getWritableOwnedData()))||!o.continueWritingContext){e.next=34;break}if(r=Ee()({},o.continueWritingContext),s=!1,!o.isTemplate){e.next=19;break}s=!0,delete o.continueWritingContext,null===(d=c.shapeTree)||void 0===d||d.api.updateProps({nvPr:{descr:JSON.stringify(o)}}),e.next=32;break;case 19:return e.next=21,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e(3)]).then(t.bind(null,"ce413fb4c3"));case 21:return u=e.sent,l=u.showTemplateModal,e.next=25,l();case 25:if(f=e.sent){e.next=28;break}return e.abrupt("return");case 28:v=f.templateId,m=f.enableImageGeneration,r.templateId=v,r.enableImageGeneration=m,a.api.removeSlides([c]);case 32:this.isImageFirstGeneration=!!r.enableImageGeneration,this._insertSlides(r,s).then((function(){h.isLayoutTemplate=!0,h.addCommitChangeListener()}));case 34:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"loadAIGenerator",value:(n=ee()(te.a.mark((function e(){var n,a;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e(18)]).then(t.bind(null,"0ec6428f27"));case 2:if(n=e.sent,a=n.AIGenerator,!this.aiGenerator){e.next=6;break}return e.abrupt("return",this.aiGenerator);case 6:return this.aiGenerator=new a(this.uiDataService,this.contentLayoutAnalyzer,this.viewableServiceLayer.selectionService),e.abrupt("return",this.aiGenerator);case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"addCommitChangeListener",value:function(){var e=this,n=re.a.SDKDataServices.EventManager();if(n)var t=n.commandEvents.onUndoRedoChange(ee()(te.a.mark((function n(){return te.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.isCommitByAi||(e.isLayoutTemplate=!1,t());case 1:case"end":return n.stop()}}),n)}))))}},{key:"markAiOperate",value:function(){this.isCommitByAi=!0}},{key:"clearAiOperate",value:function(){this.isCommitByAi=!1}},{key:"addUnloadListener",value:function(){function e(e){var n=De.a.t("你确定要离开此页面吗？未保存的更改将会丢失。");return e.returnValue=n,Te.a.show({type:"warning",message:De.a.t("退出后图片无法继续生成"),autoClose:!0,duration:2e3}),n}return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}}},{key:"addCurrentSlideChangeListener",value:function(){var e=this,n=function(){var n=e.uiDataService.slideModelList.length-1===e.viewableServiceLayer.selectionService.currentSlideIndex;e.aiGenerator.shouldFocusOnAddPage=n};return window.addEventListener("onCurrentSlideIndexChangeByUserAction",n),function(){return window.removeEventListener("onCurrentSlideIndexChangeByUserAction",n)}}}]),e}(),Ne=t("be2e9cb2a5"),Ue=t("e56f7da8d5"),Fe=t("9555d27b64"),Be={name:"quick-tool-dialog-manager",loadType:"on-demand",module:function(){return ee()(te.a.mark((function e(){var n,a;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(t.bind(null,"56a3a65e0c"));case 2:return n=e.sent,a=n.QuickToolDialogManager,e.abrupt("return",new a(new Fe.a));case 5:case"end":return e.stop()}}),e)})))()}},He=t("5e1c74b5fd"),Ge={name:"change-template-service-pc",loadType:"on-demand",module:function(){return ee()(te.a.mark((function e(){var n;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"650f4f6a32"));case 2:return n=e.sent.default,e.abrupt("return",new n);case 4:case"end":return e.stop()}}),e)})))()}},We={name:"template-content-analyzer-service",loadType:"on-demand",module:function(){return ee()(te.a.mark((function e(){var n,a;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"e826e38305"));case 2:return n=e.sent,a=n.TemplateContentAnalyzerService,e.abrupt("return",new a);case 5:case"end":return e.stop()}}),e)})))()}},ze=t("0ab82edd20"),Ve={name:"template-mall-content-manager",loadType:"on-demand",module:function(){return ee()(te.a.mark((function e(){var n;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519")]).then(t.bind(null,"094f7a70d5"));case 2:return n=e.sent.default,e.abrupt("return",new n);case 4:case"end":return e.stop()}}),e)})))()}},qe=t("1f925d7f50"),Ke=t.n(qe),Ye=t("2dc700e1e6"),Qe=t.n(Ye),Xe=(t("f1054791f4"),t("b8217400dc"),t("e6f68cdf2e"),t("e5a826a0ff")),Je=t("5cdbac46e8"),$e=t("382929c8da"),Ze=t("9559b6ab8e"),en=t("59e0553604"),nn=t("c77811d8de"),tn=(ve=Reflect.metadata("design:type",Object),me=function(){function e(n){var t=this;c()(this,e),h()(this,"id",$e.a.ANIM_BRUSH),Ke()(this,"animBrushState",he,this),h()(this,"isContinuous",!1),h()(this,"sourcePageId",void 0),h()(this,"services",void 0),h()(this,"clearAnimBrushState",(function(){t.animBrushState&&(t.animBrushState=void 0,t.sourcePageId="")})),this.services=n}return p()(e,[{key:"onDoubleClickButton",value:function(){this.isContinuous=!0,this.beginBrush(),Object(Q.c)({opername:"doc_ppt",module:"anim_brush",action:"double"})}},{key:"onClickButton",value:function(){this.animBrushState?this.onCancelBrush():(this.beginBrush(),Object(Q.c)({opername:"doc_ppt",module:"anim_brush",action:"thin"}))}},{key:"onCancelBrush",value:function(){this.isContinuous=!1,this.clearAnimBrushState()}},{key:"processMenuItemData",value:function(e,n){if(n===q.a.TOOLBAR){var t=De.a.t("复制所选对象的动画，应用到其他对象上。双击可将对象复制到多个对象上。"),a=!0;this.animBrushState&&(t=De.a.t("退出动画刷(Esc)"),a=!1),e.tipMsg=t,e.canDoubleClick=a}var i=!!this.animBrushState,c=!!this.animList.length;e.enable=i||c&&this.services.userPriviledgeService.pptEditorState<Je.b.COPYABLE}},{key:"processMenuItemValues",value:function(e){var n=this.animBrushState;return e[$e.a.ANIM_BRUSH]=n,e}},{key:"onElementSelectionMouseUp",value:function(){this.services.userPriviledgeService.pptEditorState>Je.b.EDITABLE?this.services.tipsManager.showCannotEditTips():this.applyAnimEffects(),this.isContinuous||this.onCancelBrush()}},{key:"beginBrush",value:function(){this.hasPathAnim()&&this.services.tipsManager.showMsg(De.a.t("动画刷暂不支持路径动画"));var e=this.getElementState();e&&(this.animBrushState=e)}},{key:"getElementState",value:function(){var e=this.services.selectionService,n=e.selectedElements,t=e.currentSlide;if(1===n.length){var a,i=null===(a=n.selectedArray)||void 0===a?void 0:a[0],c=this.animList.filter((function(e){var n;return(null==e||null===(n=e.props)||void 0===n?void 0:n.presetClass)!==nn.e.PATH})),o=this.isAllMediaEffect(c);return this.sourcePageId=null==t?void 0:t.id,{originElId:(null==i?void 0:i.uniqueID)||"",effects:c,allMediaEffect:o}}}},{key:"hasPathAnim",value:function(){return!!this.animList.filter((function(e){var n;return(null==e||null===(n=e.props)||void 0===n?void 0:n.presetClass)===nn.e.PATH})).length}},{key:"isAllMediaEffect",value:function(e){return e.filter((function(e){var n;return![Ze.b.Play,Ze.b.Pause,Ze.b.Stop].includes(null==e||null===(n=e.props)||void 0===n?void 0:n.animType)})).length<=0}},{key:"applyAnimEffects",value:function(){var e,n=this.services.selectionService,t=n.selectedElements,a=n.currentSlide;if((t.length||t.selectedArrayForType)&&t.selectedArrayForType(Xe.a.SLIDE).length){var i=this.animBrushState,c=Object(Le.v)(i);if(c){var o=null===(e=t.selectedArray)||void 0===e?void 0:e[0];if(o.uniqueID!==c.originElId){var r=c.effects;null!=o&&o.audio||null!=o&&o.video||(r=c.effects.filter((function(e){var n;return![Ze.b.Play,Ze.b.Pause,Ze.b.Stop].includes(null==e||null===(n=e.props)||void 0===n?void 0:n.animType)}))),r=r.filter((function(e){var n;return(null==e||null===(n=e.props)||void 0===n?void 0:n.presetClass)!==nn.e.PATH})),(null==a?void 0:a.id)!==this.sourcePageId&&(r=r.filter((function(e){return[Ze.j,null==i?void 0:i.originElId].includes(e.clickSpid)}))),r.length&&(Object(w.b)((function(){null==a||a.bindAnimation({uiModel:o,animEffects:r,originId:c.originElId,rebind:!0})})),this.playSelectAnimation())}}}}},{key:"playSelectAnimation",value:function(){var e=this.services.selectionService.selectedElements;if(1===(null==e?void 0:e.length)){var n,t=((null===(n=e.selectedArray)||void 0===n?void 0:n[0])||{}).animList,a=void 0===t?[]:t,i=en.default.getInstance();i&&a.length&&i.previewOneToOneAnims(a,!0)}}},{key:"animList",get:function(){var e=this.services.selectionService.selectedElements;if(1===e.length){var n,t=null===(n=e.selectedArray)||void 0===n?void 0:n[0];return(null==t?void 0:t.animList.filter((function(e){return!!e})))||[]}return[]}}]),e}(),he=Qe()(me.prototype,"animBrushState",[Le.q,ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me),an=t("cc17a96b7f");function cn(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=v()(e);if(n){var i=v()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return l()(this,t)}}var on=function(e){d()(t,e);var n=cn(t);function t(e,a){var i;return c()(this,t),i=n.call(this,a,e),h()(r()(i),"formulaOcrManager",void 0),h()(r()(i),"clearFormatManager",void 0),h()(r()(i),"importNewFileManager",void 0),h()(r()(i),"previewService",void 0),h()(r()(i),"lockService",void 0),h()(r()(i),"dragElementHandler",void 0),h()(r()(i),"templateFormatService",void 0),h()(r()(i),"moveElementManager",void 0),h()(r()(i),"rotateElementHandler",void 0),h()(r()(i),"resizeElementHandler",void 0),h()(r()(i),"snapLineService",void 0),h()(r()(i),"borderSketchManager",void 0),h()(r()(i),"colorPickerManager",void 0),h()(r()(i),"themeColorManager",void 0),h()(r()(i),"elementAutoLayoutService",void 0),h()(r()(i),"docRecoverService",void 0),h()(r()(i),"formatBrushManager",void 0),h()(r()(i),"menuDataWorkerManager",void 0),h()(r()(i),"transferAuthManager",void 0),h()(r()(i),"animBrushManager",void 0),h()(r()(i),"ocrService",void 0),h()(r()(i),"aiService",void 0),h()(r()(i),"aiController",void 0),h()(r()(i),"templateMallContentManager",void 0),h()(r()(i),"contentLayoutAnalyzer",void 0),h()(r()(i),"templateContentAnalyzerService",void 0),h()(r()(i),"slideContentEnumeratorService",void 0),h()(r()(i),"aiAssistantService",void 0),h()(r()(i),"quickToolDialogManager",void 0),h()(r()(i),"changeTemplateService",void 0),i.menuManager.setExportImageManagerDelegate(e.exportImageManager),i.formulaOcrManager=ge.a.getInstance().registerDynamicService(we),i.clearFormatManager=new x,i.clearFormatManager.setSelectionServiceDelegate(e.selectionService),i.importNewFileManager=new T.a(new Se.a),i.importNewFileManager.setUiDataServiceDelegate(a),i.importNewFileManager.setSelectionServiceDelegate(e.selectionService),i.elementAutoLayoutService=new V.b({selectionService:e.selectionService}),i.previewService=new C.a,i.lockService=new R.a,i.lockService.setSelectionServiceDelegate(e.selectionService),i.lockService.setUserPriviledgeServiceDelegate(e.userPriviledgeService),i.lockService.setMenuManagerDelegate(i.menuManager),i.lockService.setEditingStateManagerDelegate(e.editingStateManager),i.lockService.setTextEditorStateService(e.textEditorStateService),i.lockService.setEditorInstanceService(e.editorInstanceService),i.lockService.initEvents(),e.selectionEventService.setLockServiceDelegate(i.lockService),i.borderSketchManager=new z,i.moveElementManager=new _.a(i.menuManager,e.editingStateManager,e.selectionService,e.userPriviledgeService),i.dragElementHandler=new L.a(e.selectionService,e.editorInstanceService,e.editingStateManager,e.linkManager),i.rotateElementHandler=new j.a(e.editingStateManager,i.moveElementManager,e.selectionService,e.linkManager),i.resizeElementHandler=new N.a(e.editingStateManager,i.moveElementManager,e.selectionService,i.borderSketchManager,e.linkManager),i.snapLineService=new He.a(i.dragElementHandler,i.resizeElementHandler,e.selectionService,e.editAreaCanvasSizeManager,i.menuManager,a),e.addonManager.setFormulaOcrManager(i.formulaOcrManager),i.colorPickerManager=new X({menuManager:i.menuManager}),i.themeColorManager=new J.a({uiDataService:a,selectionService:e.selectionService,slideRenderStateManager:e.slideRenderStateManager}),i.menuManager.setThemeColorManager(i.themeColorManager),i.docRecoverService=new ye,i.animBrushManager=new tn({userPriviledgeService:e.userPriviledgeService,tipsManager:e.tipsManager,selectionService:e.selectionService}),i.formatBrushManager=new pe.a({animBrushManager:i.animBrushManager,userPriviledgeService:e.userPriviledgeService,tipsManager:e.tipsManager,borderSketchManager:i.borderSketchManager,selectionService:e.selectionService}),ke.a.IS_TEST&&(window.formatBrushManager=i.formatBrushManager),i.menuDataWorkerManager=new be.a,i.menuDataWorkerManager.addItemValueWorker(i.animBrushManager),i.menuDataWorkerManager.addItemDataWorker(i.animBrushManager),i.menuDataWorkerManager.addItemValueWorker(i.formatBrushManager),i.menuDataWorkerManager.addItemDataWorker(i.formatBrushManager),i.transferAuthManager=ge.a.getInstance().registerDynamicService(Ae),i.slideContentEnumeratorService=new Ne.a(a),i.contentLayoutAnalyzer=new Ue.a(i.slideContentEnumeratorService),i.templateFormatService=new ze.a,i.changeTemplateService=ge.a.getInstance().registerDynamicService(Ge),i.changeTemplateService.onDidInit((function(n){n.setDelegate({uiDataService:a,themeColorManager:i.themeColorManager,selectionService:e.selectionService,slideRenderStateManager:e.slideRenderStateManager,contentLayoutAnalyzer:i.contentLayoutAnalyzer,templateContentAnalyzerService:i.templateContentAnalyzerService,slideContentEnumeratorService:i.slideContentEnumeratorService,templateFormatService:i.templateFormatService})})),Object(an.a)()||(i.aiAssistantService=new je(a,i.contentLayoutAnalyzer,i.viewableServiceLayer,i.changeTemplateService)),i.quickToolDialogManager=ge.a.getInstance().registerDynamicService(Be),i.templateContentAnalyzerService=ge.a.getInstance().registerDynamicService(We),i.templateMallContentManager=ge.a.getInstance().registerDynamicService(Ve),i.templateContentAnalyzerService.onDidInit((function(n){n.setDelegateService({contentLayoutAnalyzer:i.contentLayoutAnalyzer,slideRenderStateManager:e.slideRenderStateManager})})),i.templateMallContentManager.onDidInit((function(e){e.setDelegate({templateContentAnalyzer:i.templateContentAnalyzerService,templateFormatService:i.templateFormatService})})),i}return t}($.a)},b168d1a453:function(e,n,t){"use strict";t.d(n,"a",(function(){return F}));t("73b854064b"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("547611bd96"),s=t.n(r),d=t("8eec1e4a03"),u=t.n(d),l=t("bd29e2df90"),f=t.n(l),v=t("ab5eb40518"),m=t.n(v),h=t("1b4cdd6a36"),y=t.n(h),p=t("85d0a7609b"),b=t.n(p),g=(t("3bf1976a4f"),t("a2a09da1e3"),t("963f2eaace"),t("b1e2246d82"),t("8e7cce0ada"),t("c6244f7705"),t("081c8cafea"),t("85d48ef22b"),t("2a6f332b5e"),t("b5a258feb5")),A=t("77c89fc0e0"),S=t("78ff1b2e5b"),w=t.n(S),k=t("020899bf26"),I=t("ae00e26606"),E=t("d3d31c86eb");function M(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=y()(e);if(n){var i=y()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return m()(this,t)}}var P=function(e){f()(a,e);var n=M(a);function a(){return i()(this,a),n.apply(this,arguments)}return o()(a,[{key:"initPlugin",value:function(){var e=this;u()(y()(a.prototype),"initPlugin",this).call(this),this.auth.event.on(I.a.AUTH_EXPIRED,(function(){e.showAuthExpTimeInvalid()})),this.auth.event.on(I.a.AUTH_MODIFIED,(function(){Promise.resolve().then(t.t.bind(null,"82f2dc9440",7)).then((function(e){e.default.show({message:A.l.t("权限修改成功"),type:"success",autoClose:!0})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))})),w.a.setCallback((function(n){n&&(1e4!==n.code&&10001!==n.code||(Object(E.c)({opername:"doc_account_web",module:"account_info",action:"log_expired",ver6:n.code}),e.showRefreshByChangeAccount()))}))}},{key:"handleChangeValidTimeAction",value:function(){this.show()}},{key:"showAuthExpTimeInvalid",value:function(){var e;null!==(e=k.a.DocInfoManager())&&void 0!==e&&e.isOwner?this.showExptimeTipsForOwner():this.showWillExptimeTips()}},{key:"showWillExptimeTips",value:function(){var e={message:A.l.t("文档已到期，你将无法继续访问。"),commonTipsType:A.c.INFO,actionType:A.b.REFRESH};A.a.getInstance().show(e)}},{key:"showExptimeTipsForOwner",value:function(){var e=this;return Promise.resolve().then(t.t.bind(null,"82f2dc9440",7)).then((function(n){n.default.show({message:A.l.t("访问链接已过期，对方无法访问。"),type:"info",duration:1e4,closable:!0,autoClose:!0,action:A.l.t("更改有效期"),onClickAction:function(){e.handleChangeValidTimeAction();try{window.tdwReport&&window.tdwReport({opername:"doc_access",module:"page",action:"change"})}catch(e){}}})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))}},{key:"showRefreshByChangeAccount",value:function(){var e={message:A.l.t("帐号信息变化"),commonTipsType:A.c.INFO,actionType:A.b.REFRESH,closable:!0};A.a.getInstance().show(e)}}]),a}(g.a);function D(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=y()(e);if(n){var i=y()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return m()(this,t)}}var O="auth",x=function(e){f()(t,e);var n=D(t);function t(e){var a;return i()(this,t),a=n.call(this),b()(s()(a),"authPlugin",void 0),a.authPlugin=e,a}return o()(t,[{key:"name",get:function(){return O}},{key:"show",value:function(e){var n=this,t=e||{},a=t.invokeFrom,i=void 0===a?"Root":a,c=t.showAdvPermissionsCmp,o=t.authUpdateCallback,r=t.authExpTimeUpdated,s=t.onClose;this.authPlugin.showModule({invokeFrom:i,showAdvPermissionsCmp:c,DOMNode:this.DOMNode,authUpdateCallback:o,authExpTimeUpdated:r,onShow:function(){n.showWrapper()},onClose:function(){n.hideWrapper(),null==s||s()}})}}]),t}(A.g),T=t("19f0bdbef9"),C=t("0d2ffd3bdb"),R="docs-component-cooperation-permission",L=(C.LoadType.ON_DEMAND,t("22db601e95"));function _(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?_(Object(t),!0).forEach((function(n){b()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function N(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=y()(e);if(n){var i=y()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return m()(this,t)}}var U=function(e){f()(t,e);var n=N(t);function t(){var e;i()(this,t);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return e=n.call.apply(n,[this].concat(c)),b()(s()(e),"moduleInited",void 0),b()(s()(e),"module",void 0),e}return o()(t,[{key:"initPlugin",value:function(){var e;u()(y()(t.prototype),"initPlugin",this).call(this),null===(e=this.editExtensionService)||void 0===e||e.registerRightSideBarModule(new x(this))}},{key:"show",value:function(e){var n;null===(n=this.editExtensionService)||void 0===n||n.showRightSideBar(O,e)}},{key:"showModule",value:function(e){var n=this,t=e.onShow;this.loadModule((function(){n.module&&n.moduleInited?n.showAuth(j({},e)):(n.initAuth(j({},e)),n.moduleInited=!0),null==t||t()}))}},{key:"handleChangeValidTimeAction",value:function(){this.show({invokeFrom:"Root",showAdvPermissionsCmp:!0})}},{key:"getDomainId",value:function(){var e,n=null===(e=k.a.DocInfoManager())||void 0===e?void 0:e.globalPadId,t=null==n?void 0:n.indexOf("$");return null==n?void 0:n.slice(0,t)}},{key:"getSharePlugin",value:function(){var e;return null===(e=this.noEditService)||void 0===e?void 0:e.getPluginSync(L.b)}},{key:"loadModule",value:function(e){var n=this;this.module?null==e||e():T.a.extensionService.getExtension(R).then((function(t){n.module=t,null==e||e()})).catch((function(e){window.log.warn("权限面板加载失败:",e)}))}},{key:"initAuth",value:function(e){var n,t,a=this,i=e.invokeFrom,c=e.showAdvPermissionsCmp,o=e.DOMNode,r=e.authUpdateCallback,s=e.authExpTimeUpdated,d=e.onClose,u=null!==(n=k.a.DocInfoManager())&&void 0!==n?n:{},l=u.creatorDomain,f=u.padId,v=u.padType,m=this.getDomainId(),h=this.getUserInfo(),y={invokeFrom:i,showAdvPermissionsCmp:c,padId:f,owner:{name:null==h?void 0:h.nick,avatar:null==h?void 0:h.avatar,type:"owner",uin:null==h?void 0:h.uin},domainId:m,creatorDomain:l,shareLink:null===(t=this.getSharePlugin())||void 0===t?void 0:t.getShareLink(),shareTitle:function(){var e;return null===(e=k.a.SlideTitleManager())||void 0===e?void 0:e.title},shareDocType:v,onAuthUpdated:function(e){a.auth.setAuthInfo(e),null==r||r(e)},onClose:function(e){null==r||r(e),null==d||d()},onShare:function(){a.showShare()},onAuthExpTimeUpdated:function(e){null==s||s(e)}};this.module.show(j({container:o},y))}},{key:"showAuth",value:function(e){var n=this,t=e.invokeFrom,a=e.showAdvPermissionsCmp,i=e.DOMNode,c=e.authUpdateCallback,o=e.authExpTimeUpdated,r=e.onClose;this.module.show({container:i,showAdvPermissionsCmp:a,onAuthUpdated:function(e){null==c||c(e)},onShare:function(){n.showShare()},invokeFrom:t,onClose:function(e){null==c||c(e),null==r||r()},onAuthExpTimeUpdated:function(e){null==o||o(e)}})}},{key:"showShare",value:function(){var e,n;A.i.isMiniProgram?null===(e=this.getSharePlugin())||void 0===e||e.navigateToSharePanel():null===(n=this.getSharePlugin())||void 0===n||n.show()}}]),t}(P),F={name:t("560bea0cc4").b,plugin:U}},b20baa634b:function(e,n,t){"use strict";function a(e,n,t,a,i){a.addonManager.setCopyPasteManager(e),e.onDidInit((function(e){e.setInject(i),e.setServiceDelegates({uiDataService:n,selectionService:a.selectionService,menuManager:t,playManager:a.playManager,userPriviledgeService:a.userPriviledgeService,editingStateManager:a.editingStateManager,addonManager:a.addonManager,editorInstanceService:a.editorInstanceService,tipsManager:a.tipsManager,contentRendererService:a.contentRendererService})}))}t.d(n,"a",(function(){return a}))},b5a258feb5:function(e,n,t){"use strict";t.d(n,"a",(function(){return N}));t("73b854064b");var a,i=t("9132715560"),c=t.n(i),o=t("6a364eb35c"),r=t.n(o),s=t("547611bd96"),d=t.n(s),u=t("bd29e2df90"),l=t.n(u),f=t("ab5eb40518"),v=t.n(f),m=t("1b4cdd6a36"),h=t.n(m),y=t("85d0a7609b"),p=t.n(y),b=(t("3bf1976a4f"),t("659f690fe6")),g=t("77c89fc0e0"),A=t("5de93315c1"),S=t("ae00e26606"),w=t("176815363d"),k=t.n(w),I=t("3ef2352f0b"),E=t.n(I);t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),t("a2a09da1e3"),t("1bab7b5fb7"),t("9d7978d445");!function(e){e[e.Self=0]="Self",e[e.Cooperation=1]="Cooperation",e[e.Viewable=2]="Viewable",e[e.Editable=3]="Editable"}(a||(a={}));var M=t("020899bf26"),P=t("aba9dcef64"),D=t("54bdd803dc"),O=t.n(D),x=t("7485b1517d"),T=t.n(x),C=t("e6d98148ee"),R=t("5ce71228c0"),L=function(){function e(n){var t,i=this;c()(this,e),p()(this,"expireTimeId",void 0),p()(this,"_event",void 0),p()(this,"_policy",a.Self),p()(this,"_memberList",[]),p()(this,"advpolicy",{}),p()(this,"showWxTips",void 0),p()(this,"_exptime",void 0),p()(this,"_remaintime",void 0),p()(this,"_settime",void 0),p()(this,"_starttime",void 0),p()(this,"noEditService",void 0),p()(this,"editExtensionService",void 0),this.noEditService=n.noEditService,this.editExtensionService=n.editExtensionService,this._event=new C.a,null===(t=this.editExtensionService)||void 0===t||t.onReady((function(){M.a.DocInfoManager.promise().then((function(e){e.waitForReady((function(){return i.init(e)}))}))})),M.a.SDKDataServices.EventManager.promise().then((function(e){e.socketEvents.onRightMessage((function(e){i.handleRightMessage(e),i.checkPrivilege()}))})),window.addEventListener("online",(function(){return i.handleOnline()}))}var n,t;return r()(e,[{key:"policy",get:function(){return this._policy}},{key:"memberList",get:function(){return this._memberList}},{key:"info",get:function(){return{policy:this._policy,memlist:this._memberList}}},{key:"exptime",get:function(){return this._exptime}},{key:"remaintime",get:function(){return this._remaintime}},{key:"settime",get:function(){return this._settime}},{key:"starttime",get:function(){return this._starttime}},{key:"event",get:function(){return this._event}},{key:"privilegeAttribute",get:function(){var e;return null===(e=M.a.PrivilegeManager())||void 0===e?void 0:e.getPrivilegeAttribute()}},{key:"init",value:function(e){var n,t=this;if(e.isOwner){var a=new Promise((function(e){t._event.on(S.a.AUTH_CHANGE,(function(){e(null)}))})),i=new Promise((function(e){t._event.on(S.a.AUTH_EXP_TIME_CHANGE,(function(){e(null)}))}));Promise.all([a,i]).then((function(){t._event.emit(S.a.AUTH_MANAGER_READY)}))}else{var c=new Promise((function(e){t._event.on(S.a.AUTH_EXP_TIME_CHANGE,(function(){e(null)}))}));Promise.all([c]).then((function(){t._event.emit(S.a.AUTH_MANAGER_READY)}))}this._policy=null!==(n=e.policy)&&void 0!==n?n:-1,this.getAuthInfo(),this.shouldFetchAuthExpTime()&&this.getAuthExpTime()}},{key:"isAuthExpired",value:function(){return!(void 0===this.settime||0===this.settime||0!==this.remaintime)}},{key:"isAuthExpTimeForverValid",value:function(){return!(void 0===this.settime||0!==this.settime)}},{key:"notifyAuthUpdate4RightMsg",value:function(e,n){var t=!1;return!e||""!==e.payload&&null!==e.payload||(n&&(null===g.h||void 0===g.h||g.h.dispatch("TX-AUTH-UPDATED"),this.getAuthInfo()),t=!0),t}},{key:"notifyPriChanged4RightMsg",value:function(e,n){e||1!==n||this._event.emit(S.a.AUTH_PRIVILEGE_CHANGE)}},{key:"setAuthExpInfo4RightMsg",value:function(e,n,t){if(void 0!==e&&void 0!==n&&void 0!==t){var a=e-t;a>0&&this.setAuthExpInfo(e,a,a,t)}}},{key:"notifyAuthModified4RightMsg",value:function(e,n,t){if(e){var a=e;void 0===a[n]?t&&(this._event.emit(S.a.AUTH_MODIFIED),null===g.h||void 0===g.h||g.h.dispatch("TX-AUTH-UPDATED"),this.getAuthInfo()):delete a[n]}}},{key:"handleRightMessage",value:function(e){try{var n,t=!(null===(n=M.a.DocInfoManager())||void 0===n||!n.isOwner);if(this.notifyAuthUpdate4RightMsg(e,t))return;var a=JSON.parse(decodeURIComponent(e.payload));if(null===a)return;var i=a.seq;if(1===a.action){var c,o;this.notifyAuthModified4RightMsg(null===(c=M.a.ClientVarsService())||void 0===c?void 0:c.getClientVars().msgFilterData,i,t);var r=!(null===(o=M.a.PrivilegeManager())||void 0===o||!o.editable);this.notifyPriChanged4RightMsg(r,a.advpolicy)}else 2===a.action||(null===g.h||void 0===g.h||g.h.dispatch("ADVPER_AUTH_EXPIRED"),this.setAuthExpInfo4RightMsg(a.exptime,a.settime,a.starttime))}catch(e){console.error("handleRightMessage:".concat(e))}}},{key:"checkPrivilege",value:function(){var e=this;this.isCheckPrivilege()&&this.comparePrivilege((function(n){var t,a=e.privilegeAttribute||{};if(null!=n&&null!==(t=n.response)&&void 0!==t&&t.onpost){var i,c=(null===(i=n.response.onpost.privilege_attribute)||void 0===i?void 0:i.docx_attribute)||{};e.isPrivilegeChange(a,c)&&e._event.emit(S.a.AUTH_PRIVILEGE_CHANGE,{canEdit:c.can_edit})}}))}},{key:"isCheckPrivilege",value:function(){var e;return null===(e=M.a.DocInfoManager())||void 0===e||!e.isOwner}},{key:"isPrivilegeChange",value:function(e,n){var t=["can_read","can_edit","can_copy","can_print","can_copy_doc","can_export","can_apply_edit","can_save_template","can_copy_out"];return!O()(T()(e,t),T()(n,t))}},{key:"setAuthExpTimer",value:function(){this.isAuthExpTimeForverValid()?console.log("adv: is vaild forever"):this.isAuthExpired()?this.handleAuthExpTimeInvalid():this.handleAuthExpTimeValid()}},{key:"handleAuthExpTimeInvalid",value:function(){console.log("adv: is invaild"),this._event.emit(S.a.AUTH_EXPIRED)}},{key:"handleAuthExpTimeValid",value:function(){var e,n=this,t=this.remaintime;(null===(e=M.a.DocInfoManager())||void 0===e||!e.isOwner)&&t>5&&(t-=3),t*=1e3,this.expireTimeId&&(console.log("adv: clear expireTimeId"),clearTimeout(this.expireTimeId),this.expireTimeId=null),this.expireTimeId=setTimeout((function(){n.expireTimeId=null,console.log("adv: expire from timer, creator"),n.getAuthExpTime()}),t),console.log("adv: settimeout, timeoutInterval:".concat(t))}},{key:"isAndSetAuthExpReaded",value:function(e){if(!e||!localStorage)return!1;var n=R.b.getItem(R.a.EXPTIME_READED_SET),t=";";if(!n)return n=e,R.b.setItem(R.a.EXPTIME_READED_SET,n+t),!1;if(-1==n.indexOf(e+t)){if(n.split(t).length-1>20){var a=n.indexOf(t);n=n.substring(a+1,n.length)}return n=n+e+t,R.b.setItem(R.a.EXPTIME_READED_SET,n),!1}return!0}},{key:"setAuthInfo",value:function(e){this._policy=e.policy,this._memberList=e.memlist,this._event.emit(S.a.AUTH_CHANGE)}},{key:"setAuthExpInfo",value:function(e,n,t,a){this._exptime=e,this._remaintime=n,this._settime=t,this._starttime=a,this._event.emit(S.a.AUTH_EXP_TIME_CHANGE,this.isAuthExpired()),this.setAuthExpTimer()}},{key:"getAuthInfo",value:(t=k()(E.a.mark((function e(){var n,t,a,i,c,o,r,s,d=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.DocInfoManager.promise();case 2:return n=e.sent,t=n.isOwner,a=n.padId,i=void 0===a?"":a,c=n.creatorDomain,o=void 0===c?"":c,e.next=10,P.a.OnlineApiService.promise();case 10:r=e.sent,s=r.getAuthInfo,t&&s(i,o).then((function(e){if(0===e.data.cgicode&&0===e.data.retcode){var n=e.data;d.setAuthInfo(n)}else console.error("getAuthInfo res.cgicode !== 0 || res.cgicode !== 0".concat(e))})).catch((function(e){console.error("getAuthInfo err: ".concat(JSON.stringify(e)))}));case 13:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"getAuthExpTime",value:(n=k()(E.a.mark((function e(){var n,t,a,i,c,o=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.DocInfoManager.promise();case 2:return n=e.sent,t=n.domainId,a=void 0===t?"":t,i=n.padId,c=void 0===i?"":i,e.next=9,P.a.OnlineApiService.promise();case 9:(0,e.sent.getAuthExpTime)(a,c).then((function(e){if(0===e.data.cgicode&&0===e.data.retcode){var n=e.data,t=n.exptime,a=n.remaintime,i=n.settime,c=n.starttime;o.setAuthExpInfo(t,a,i,c),console.log("getAuthExpTime exptime:".concat(o._exptime," remaintime:").concat(o._remaintime," settime:").concat(o._settime," starttime:").concat(o._starttime))}else console.error("handleAuthExpTime res.cgicode !== 0 || res.cgicode !== 0".concat(e))})).catch((function(e){console.error("getAuthExpTime error: ".concat(JSON.stringify(e)))}));case 12:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"shouldFetchAuthExpTime",value:function(){return!0}},{key:"handleOnline",value:function(){var e,n=this;null===(e=this.editExtensionService)||void 0===e||e.onReady((function(){n.getAuthInfo(),n.shouldFetchAuthExpTime()&&n.getAuthExpTime(),n.checkPrivilege()}))}},{key:"comparePrivilege",value:function(e){var n,t=null===(n=P.a.CollaborationManager())||void 0===n?void 0:n.getSocket();null==t||t.sendMessage({cmd:"GET_PRIVILEGE",taskId:0,data:JSON.stringify({}),customParam:void 0,onError:function(n,t,a,i){null==e||e(null)},onsend:function(n,t,a,i){0===i.errCode&&i.response&&i.response.onpost&&0===i.response.onpost.result?null==e||e(i):null==e||e(null)}})}}]),e}(),_=t("05d181ac40");function j(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=h()(e);if(n){var i=h()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return v()(this,t)}}var N=function(e){l()(t,e);var n=j(t);function t(){var e;c()(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=n.call.apply(n,[this].concat(i)),p()(d()(e),"auth",void 0),e}return r()(t,[{key:"initPlugin",value:function(){var e=this;this.auth=this.createAuth(),this.auth.event.on(S.a.AUTH_PRIVILEGE_CHANGE,(function(n){var t;(e.showRefreshByPrivilegeChange(),null!=n&&n.canEdit)||(null===(t=e.editExtensionService)||void 0===t||t.setEditState(g.f.SELECTABLE))}))}},{key:"onAuthEvent",value:function(e,n){this.auth.event.on(e,n)}},{key:"getAuth",value:function(){return this.auth}},{key:"getUserInfo",value:function(){var e,n=null===(e=this.noEditService)||void 0===e?void 0:e.getPluginSync(A.a);return null==n?void 0:n.userInfo}},{key:"getPrivilegeChangeTip",value:function(){return g.l.t("你的权限已发生变化。")}},{key:"createAuth",value:function(){return new L({noEditService:this.noEditService,editExtensionService:this.editExtensionService})}},{key:"showRefreshByPrivilegeChange",value:function(){if(!_.a.DRIVE_ENV.IS_PREVIEW_DRIVE_FILE){var e={message:this.getPrivilegeChangeTip(),commonTipsType:g.c.INFO,actionType:g.b.REFRESH};g.a.getInstance().show(e)}}}]),t}(b.a)},ba4ddefc1e:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return o}));var a=t("402eb050f3"),i=a.b.supportEnterprise(a.a.ALL)?"8856ef52bd434c2d938fbf0c16d82a96":"42da4f2d95c146abb5896087ca5f03dd",c="0b69e1b9517e44a4aee35d33ee021b55",o=["e0b026441751437d8b0c45ff29b508c3","20c67635951045dda4e0fcd3ac7e24d3","c0f0506f24df4e4a8e99717c2bf18b50","9c468c59da0e4e21a4063970ab9036d4","0b69e1b9517e44a4aee35d33ee021b55","9e2c26161b684629a9bf29e52efa6c60"]},cd255d4473:function(e,n,t){"use strict";t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return i}));n.b={START_PLAY:"startPLay",END_PLAY:"endPlay",PLAY_INDEX_CHANGE:"playIndexChange",MOVE_SELECTED_ELEMENTS_WITH_ARROW:"moveSelectedElementsWithArrow"};var a={PASTE:"paste"},i="extra-div-for-accessibility"},d291ba4ae9:function(e,n,t){"use strict";var a;t.d(n,"a",(function(){return a})),function(e){e.USER_INFO_READY_EVENT="UserInfoReadyEvent"}(a||(a={}))},d4ed2d38ff:function(e,n,t){"use strict";t.d(n,"a",(function(){return b}));t("73b854064b");var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("547611bd96"),s=t.n(r),d=t("bd29e2df90"),u=t.n(d),l=t("ab5eb40518"),f=t.n(l),v=t("1b4cdd6a36"),m=t.n(v),h=t("85d0a7609b"),y=t.n(h);t("3bf1976a4f");function p(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=m()(e);if(n){var i=m()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return f()(this,t)}}var b=function(e){u()(t,e);var n=p(t);function t(){var e;i()(this,t);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return e=n.call.apply(n,[this].concat(c)),y()(s()(e),"disableScrollX",void 0),y()(s()(e),"disableScrollY",void 0),y()(s()(e),"canvasSize",void 0),e}return o()(t,[{key:"initModel",value:function(e,n){this.disableScrollX=!0,this.disableScrollY=!0;var t=(n||{}).canvasSize;this.canvasSize=t}}]),t}(t("375d29afab").a)},d7b579ea9f:function(e,n,t){"use strict";t.d(n,"a",(function(){return g}));t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var a=t("176815363d"),i=t.n(a),c=t("9132715560"),o=t.n(c),r=t("6a364eb35c"),s=t.n(r),d=t("85d0a7609b"),u=t.n(d),l=t("3ef2352f0b"),f=t.n(l),v=(t("c6244f7705"),t("081c8cafea"),t("020899bf26")),m=t("37091e4240"),h=t("24920ada93"),y=t("6dfa2ef4e4");function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function b(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){u()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var g=function(){function e(n){o()(this,e),u()(this,"services",void 0),this.inject=n,y.d(),v.a.SDKDataServices.EventManager.promise().then((function(e){var n=e.mutationEvents.onSubmitMutations((function(){y.b(),n()}))})),m.b.on(m.a.START_EXPORT,(function(){y.c()}))}var n;return s()(e,[{key:"setServiceDelegates",value:function(e){this.services=b(b({},this.services),e)}},{key:"checkIsSupportAI",value:function(){return this.inject.checkIsSupportAI()&&h.a.isSupportAI()}},{key:"loadAIModule",value:(n=i()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.aiService.promise());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"showAIGuide",value:function(e){}}]),e}()},dc6161bb20:function(e,n,t){"use strict";t.d(n,"a",(function(){return N}));t("73b854064b"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var a=t("176815363d"),i=t.n(a),c=t("85d0a7609b"),o=t.n(c),r=t("7a5536c9bf"),s=t.n(r),d=t("9132715560"),u=t.n(d),l=t("6a364eb35c"),f=t.n(l),v=t("8eec1e4a03"),m=t.n(v),h=t("bd29e2df90"),y=t.n(h),p=t("ab5eb40518"),b=t.n(p),g=t("1b4cdd6a36"),A=t.n(g),S=t("3ef2352f0b"),w=t.n(S),k=(t("3bf1976a4f"),t("c6244f7705"),t("081c8cafea"),t("b1e2246d82"),t("e2ad9b4b73")),I=t("19f0bdbef9"),E=t("e7c4e8f59c"),M=t("9eab16bf4b"),P=t("ec3bbd441e"),D=t("3bd887f5ab"),O=t("1d6e84dd0c"),x=t("f64f479582");t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e");function T(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=A()(e);if(n){var i=A()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return b()(this,t)}}var C=function(e){y()(c,e);var n,a=T(c);function c(){return u()(this,c),a.apply(this,arguments)}return f()(c,[{key:"initPlugin",value:function(){}},{key:"exitCurrentDocument",value:(n=i()(w.a.mark((function e(){var n,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e(22)]).then(t.bind(null,"d6726ac74c"));case 3:e.sent.DocsComponentFacade.exitCurrentDocument(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),null===(n=window.log)||void 0===n||null===(a=n.error)||void 0===a||a.call(n,"exit current document error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(){return n.apply(this,arguments)})}]),c}(t("659f690fe6").a),R={name:"no-edit-exit-doc",plugin:C};function L(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?L(Object(t),!0).forEach((function(n){o()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function j(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=A()(e);if(n){var i=A()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return b()(this,t)}}var N=function(e){y()(t,e);var n=j(t);function t(){return u()(this,t),n.apply(this,arguments)}return f()(t,[{key:"getRegisterPlugins",value:function(){return[O.a,x.a,R].concat(s()(m()(A()(t.prototype),"getRegisterPlugins",this).call(this)))}},{key:"getCallbackAdapter",value:function(){var e,n,a=this;return _(_({},m()(A()(t.prototype),"getCallbackAdapter",this).call(this)),{},{onFileInfoClick:(n=i()(w.a.mark((function e(){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.noEditService.getPlugin(x.a.name);case 2:null==(n=e.sent)||n.show();case 4:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)}),exitCurrentDocument:(e=i()(w.a.mark((function e(){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.noEditService.getPlugin(R.name);case 2:null==(n=e.sent)||n.exitCurrentDocument();case 4:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})})}},{key:"getArkDCConfigs",value:function(){return[E.a,M.a,P.a,D.a]}},{key:"onReady",value:function(){m()(A()(t.prototype),"onReady",this).call(this),I.a.init(this.getArkDCConfigs())}}]),t}(k.a)},e2ad9b4b73:function(e,n,t){"use strict";t.d(n,"a",(function(){return _}));var a=t("176815363d"),i=t.n(a),c=t("9132715560"),o=t.n(c),r=t("6a364eb35c"),s=t.n(r),d=t("85d0a7609b"),u=t.n(d),l=t("3ef2352f0b"),f=t.n(l),v=(t("c6244f7705"),t("081c8cafea"),t("e6d98148ee")),m=t("020899bf26"),h=function(){function e(){o()(this,e),u()(this,"event",void 0),u()(this,"mIsAuthExpired",void 0),u()(this,"mUserInfo",void 0),this.event=new v.a}return s()(e,[{key:"info",get:function(){var e,n;return null!==(e=null===(n=m.a.ClientVarsService())||void 0===n?void 0:n.getClientVars())&&void 0!==e?e:{}}},{key:"title",get:function(){var e,n;return null!==(e=null===(n=m.a.SlideTitleManager())||void 0===n?void 0:n.title)&&void 0!==e?e:""}},{key:"padId",get:function(){var e;return null!==(e=this.docStore.padId)&&void 0!==e?e:""}},{key:"globalPadId",get:function(){var e;return null!==(e=this.docStore.globalPadId)&&void 0!==e?e:""}},{key:"domainId",get:function(){var e;return null!==(e=this.docStore.globalPadId)&&void 0!==e?e:""}},{key:"creatorDomain",get:function(){var e;return null!==(e=this.docStore.creatorDomain)&&void 0!==e?e:""}},{key:"userId",get:function(){var e;return null!==(e=this.docStore.userId)&&void 0!==e?e:""}},{key:"isOwner",get:function(){return!!this.docStore.isOwner}},{key:"isCreator",get:function(){return!!this.docStore.isCreator}},{key:"padType",get:function(){var e;return null!==(e=this.docStore.padType)&&void 0!==e?e:""}},{key:"isDeleted",get:function(){return!!this.docStore.isDeleted}},{key:"tinyid",get:function(){var e,n;return null!==(e=null===(n=this.docStore)||void 0===n?void 0:n.tinyid)&&void 0!==e?e:""}},{key:"userName",get:function(){var e,n,t;return null!==(e=null===(n=this.docStore)||void 0===n||null===(t=n.userInfo)||void 0===t?void 0:t.userName)&&void 0!==e?e:""}},{key:"userPic",get:function(){var e,n;return null!==(e=null===(n=this.docStore.userInfo)||void 0===n?void 0:n.userPic)&&void 0!==e?e:""}},{key:"privilegeAttribute",get:function(){var e,n;return null!==(e=null===(n=m.a.PrivilegeManager())||void 0===n?void 0:n.getPrivilegeAttribute())&&void 0!==e?e:{}}},{key:"isAuthExpired",get:function(){return this.mIsAuthExpired},set:function(e){this.mIsAuthExpired=e}},{key:"policy",get:function(){var e,n;return null!==(e=null===(n=this.docStore)||void 0===n?void 0:n.policy)&&void 0!==e?e:0}},{key:"userInfo",get:function(){return this.mUserInfo},set:function(e){this.mUserInfo=e}},{key:"addEventListener",value:function(e,n){return this.event.on(e,n)}},{key:"docStore",get:function(){return m.a.DocInfoManager()}}]),e}(),y=(t("8e7cce0ada"),t("29f8c5f672"),t("85d48ef22b"),t("2a6f332b5e"),t("8ee19818c4"),t("b1e2246d82"),function(){function e(n){o()(this,e),u()(this,"pluginConfigMap",void 0),u()(this,"pluginMap",void 0),u()(this,"props",void 0),this.pluginConfigMap=new Map,this.pluginMap=new Map,this.props=n}var n,t,a;return s()(e,[{key:"batchRegisterPlugins",value:function(e){var n=this;e.forEach((function(e){n.registerPlugin(e)}))}},{key:"registerPlugin",value:function(e){if(this.pluginConfigMap.has(e.name))throw new Error("plugin ".concat(e.name," has been registered"));this.pluginConfigMap.set(e.name,e)}},{key:"unRegisterPlugin",value:function(e){if(this.pluginConfigMap.has(e)){this.pluginConfigMap.delete(e);var n=this.pluginMap.get(e);n&&(this.pluginMap.delete(e),n.dispose())}}},{key:"getPlugin",value:(a=i()(f.a.mark((function e(n){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.pluginConfigMap.get(n))){e.next=12;break}if(a=this.pluginMap.get(n)){e.next=11;break}return e.next=6,this.createPlugin(t);case 6:if(a=e.sent,!this.pluginMap.get(n)){e.next=9;break}return e.abrupt("return",this.pluginMap.get(n));case 9:a.initPlugin(),this.pluginMap.set(n,a);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getPluginSync",value:function(e){var n=this.pluginConfigMap.get(e);if(n){var t=this.pluginMap.get(e);if(!t)this.isPluginClass(n.plugin)&&((t=new(0,n.plugin)({noEditService:this,extensionService:this.props.extensionService})).initPlugin(),this.pluginMap.set(e,t));return t}}},{key:"initPlugin",value:(t=i()(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlugin(n);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"initPluginSync",value:function(e){this.getPluginSync(e)}},{key:"createPlugin",value:(n=i()(f.a.mark((function e(n){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPluginClass(n.plugin)){e.next=4;break}t=n.plugin,e.next=8;break;case 4:return a=n.plugin,e.next=7,a();case 7:t=e.sent;case 8:return e.abrupt("return",new t({noEditService:this,extensionService:this.props.extensionService}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"isPluginClass",value:function(e){return void 0!==e.pluginTag}}]),e}()),p=t("5de93315c1"),b=t("d291ba4ae9"),g=(t("73b854064b"),t("547611bd96")),A=t.n(g),S=t("bd29e2df90"),w=t.n(S),k=t("ab5eb40518"),I=t.n(k),E=t("1b4cdd6a36"),M=t.n(E),P=(t("3bf1976a4f"),t("659f690fe6")),D=t("a8a4b19997"),O=function(e,n){e.userInfo=n||{},e.userName=null==n?void 0:n.nick,e.userPic=null==n?void 0:n.avatar,e.userLoginCorpId=null==n?void 0:n.corpId,e.userLoginCorpName=null==n?void 0:n.corpName,e.vipInfo=null==n?void 0:n.vipInfo},x=t("37091e4240"),T=t("cc17a96b7f");function C(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=M()(e);if(n){var i=M()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return I()(this,t)}}var R=function(e){w()(a,e);var n,t=C(a);function a(){var e;o()(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),u()(A()(e),"userInfo",void 0),u()(A()(e),"authenticateRequest",void 0),e}return s()(a,[{key:"initPlugin",value:function(){var e,n=this;Object(T.a)()?this.authenticateRequest=Promise.resolve(void 0):(this.authenticateRequest=Object(D.authenticate)({fetchUserInfo:!0,autoLogin:!(null!==(e=this.editExtensionService)&&void 0!==e&&e.isPreviewDriveDocs())}),this.authenticateRequest.then((function(e){n.userInfo=e,window.clientVars=window.clientVars||{},window.clientVars.isLogin=!0,window.clientVars.userType=null==e?void 0:e.loginType,window.clientVars.uidKey=n.getUidKey(),O(window.clientVars,e),x.b.emit(x.a.LOGIN_USER_INFO_READY_EVENT,n.userInfo)})))}},{key:"getUserInfo",value:function(){return this.authenticateRequest}},{key:"isLogin",value:function(){return Object(D.isLogin)()}},{key:"login",value:(n=i()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(D.loginOnce)();case 2:return e.abrupt("return",Promise.resolve());case 3:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"logout",value:function(){return Object(D.logout)()}},{key:"getUid",value:function(){return Object(D.getUid)()||""}},{key:"getUidKey",value:function(){return Object(D.getUidKey)()||""}},{key:"onUserReady",value:function(e){x.b.on(x.a.LOGIN_USER_INFO_READY_EVENT,e)}}]),a}(P.a),L={name:p.a,plugin:R},_=function(){function e(){o()(this,e),u()(this,"extensionService",void 0),u()(this,"docInfoService",void 0),u()(this,"noEditService",void 0)}return s()(e,[{key:"init",value:function(e){this.extensionService=e,this.docInfoService=new h,e.setDocInfo(this.docInfoService),this.initNoEditService(),this.setSetLifecycleAdapter(),this.setNoEditCallbackAdapter()}},{key:"getRegisterPlugins",value:function(){return[L]}},{key:"onReady",value:function(){}},{key:"onInfrastructureDidReady",value:function(){this.initLoginPlugin()}},{key:"onFirstSlideRender",value:function(){}},{key:"getCallbackAdapter",value:function(){var e,n=this;return{isLogin:function(){var e=n.getLoginPlugin();return(null==e?void 0:e.isLogin())||!1},logout:function(){var e=n.getLoginPlugin();null==e||e.logout()},login:(e=i()(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.getLoginPlugin(),e.next=3,null==t?void 0:t.login();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)}),getUid:function(){var e=n.getLoginPlugin();return(null==e?void 0:e.getUid())||""},getUidKey:function(){var e=n.getLoginPlugin();return(null==e?void 0:e.getUidKey())||""}}}},{key:"getLoginPlugin",value:function(){return this.noEditService.getPluginSync(p.a)}},{key:"initNoEditService",value:function(){this.noEditService=new y({extensionService:this.extensionService}),this.noEditService.batchRegisterPlugins(this.getRegisterPlugins())}},{key:"setSetLifecycleAdapter",value:function(){var e=this;this.extensionService.setLifecycleAdapter({onReady:function(){e.onReady()},onInfrastructureDidReady:function(){e.onInfrastructureDidReady()},onFirstSlideRender:function(){e.onFirstSlideRender()}})}},{key:"setNoEditCallbackAdapter",value:function(){this.extensionService.setCallBackAdapter(this.getCallbackAdapter())}},{key:"initLoginPlugin",value:function(){var e=this,n=this.getLoginPlugin();null==n||n.onUserReady((function(n){e.docInfoService&&(e.docInfoService.userInfo=n,e.docInfoService.event.emit(b.a.USER_INFO_READY_EVENT,n))}))}}]),e}()},e75093e758:function(e,n,t){"use strict";t.d(n,"a",(function(){return D}));t("73b854064b"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("547611bd96"),s=t.n(r),d=t("bd29e2df90"),u=t.n(d),l=t("ab5eb40518"),f=t.n(l),v=t("1b4cdd6a36"),m=t.n(v),h=t("85d0a7609b"),y=t.n(h),p=(t("3bf1976a4f"),t("8e7cce0ada"),t("c6244f7705"),t("081c8cafea"),t("85d48ef22b"),t("2a6f332b5e"),t("9e6e95de85")),b=t("d4ed2d38ff"),g=t("21f6c93a07"),A=t("65634518db"),S=t("69ffac57e7"),w=t("d5c3deb8c7"),k=t("8930941e65"),I=t("e68a50bae6");function E(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function M(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?E(Object(t),!0).forEach((function(n){y()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function P(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=m()(e);if(n){var i=m()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return f()(this,t)}}var D=function(e){u()(a,e);var n=P(a);function a(e){var c;return i()(this,a),c=n.call(this),y()(s()(c),"canvasSizeHandler",void 0),y()(s()(c),"isHeaderFold",void 0),y()(s()(c),"pageScale",void 0),y()(s()(c),"services",void 0),y()(s()(c),"inject",void 0),y()(s()(c),"slideWidth",void 0),y()(s()(c),"slideHeight",void 0),y()(s()(c),"timer",void 0),y()(s()(c),"toolbarMode",void 0),y()(s()(c),"curSlide",void 0),y()(s()(c),"slideChildrenLen",void 0),y()(s()(c),"handleMouseDown",(function(){I.a.isShown()||c.deselect()})),y()(s()(c),"getPageScale",(function(){return c.pageScale})),y()(s()(c),"isDraggingElement",(function(){var e,n;return!(null===(e=c.services)||void 0===e||null===(n=e.editingStateManager)||void 0===n||!n.isDraggingElement)})),y()(s()(c),"resize",(function(e,n){var t,a,i,o,r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).noteHeightChange,s=void 0===r||r;if(window.pray().isPlaying){var d="".concat(document.documentElement.clientWidth,"_").concat(document.documentElement.clientHeight);if(d==="".concat(window.screen.width,"_").concat(window.screen.height)||d===window.lastWH||window.intoPlayForResize)return void(window.intoPlayForResize=!1)}if(null===(t=c.services)||void 0===t||null===(a=t.editingStateManager)||void 0===a||!a.isDragging){c.quickSettingUpdateRect(e);var u=c.updateCanvasSize();s&&c.fixNoteHeightByResize();var l=null===(i=c.services)||void 0===i||null===(o=i.editAreaCanvasSizeManager)||void 0===o?void 0:o.getCanvasSize();c.canvasSizeHandler.canvasSizeChange(u,l,c.containerDom)&&c.updateModelAndScroll(u,n).then((function(){var t,a;if(null!=e&&null!==(t=e.detail)&&void 0!==t&&t.countSizeAgain){var i=c.updateCanvasSize();i.width===u.width&&i.height===u.height||c.updateModelAndScroll(i,n)}null!=e&&null!==(a=e.detail)&&void 0!==a&&a.cb&&e.detail.cb()}))}})),y()(s()(c),"updateDisableScroll",(function(e){var n,t=c.canvasSizeHandler.getCanvasOffsetHeightWidth(c.getHeaderFold(),c.getNoteAreaInfo(),null===(n=c.inject)||void 0===n?void 0:n.isStatusBarFold()),a=t.offsetHeight,i=t.offsetWidth;c.model.disableScrollX=e.width<=i,c.model.disableScrollY=e.height<=a})),y()(s()(c),"resizeDelay",(function(e,n){if(c.shouldResize()){c.timer&&clearTimeout(c.timer);var t=c.getResizeDelayTime();c.timer=setTimeout((function(){var t,a=Object(k.a)(n).isUndefined()?null==e||null===(t=e.detail)||void 0===t?void 0:t.scrollCenter:n;c.resize(e,a),c.timer=null}),t)}})),y()(s()(c),"updateFontScale",(function(){window.fontScaleFactor=Object(A.a)()})),y()(s()(c),"quickSettingUpdateRect",(function(e){"resize"!==(null==e?void 0:e.type)&&"PPT-resize"!==(null==e?void 0:e.type)||Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e("vendors~service")]).then(t.bind(null,"7f21889145")).then((function(e){e.default.getInstance().updateAnchorRect()})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))})),y()(s()(c),"updateModelAndScroll",(function(e,n){return new Promise((function(t){var a,i;null===(a=c.services)||void 0===a||null===(i=a.editAreaCanvasSizeManager)||void 0===i||i.setCanvasSize({canvasWidth:e.width,canvasHeight:e.height,slideLeft:e.left,slideTop:e.top,scale:e.scale}),c.pageScale=e.scale,c.updateModel({canvasSize:e},(function(){var a,i;n?c.slideScrollCenter(e):null!==(a=c.services)&&void 0!==a&&null!==(i=a.editorInstanceService)&&void 0!==i&&i.checkEditorIsEditing()&&c.scrollToEndEditing(),t()}))}))})),y()(s()(c),"slideScrollCenter",(function(e){var n=c.containerDom;n&&(n.scrollLeft=0,n.scrollTop=0,n.style.overflow=null,c.model.disableScrollX||(n.scrollLeft=-e.cLeft),c.model.disableScrollY||(n.scrollTop=-e.cTop))})),y()(s()(c),"handleSizeChange",(function(e){var n=e.slideWidth,t=e.slideHeight,a=e.curSlide,i=e.headerFold,o=e.toolbarMode,r=((null==a?void 0:a.children)||[]).length;if(c.hideFloatBar(),c.isSlideSizeChange(n,t,i,o)){if(c.isHeaderFold=i,c.toolbarMode=o,a){var s=a!==c.curSlide;c.resize(void 0,s)}}else a&&(a!==c.curSlide?(c.curSlide=a,c.slideChildrenLen=r,c.resize({detail:{countSizeAgain:!0}},!0)):r!==c.slideChildrenLen&&(c.slideChildrenLen=r,c.resize()))})),y()(s()(c),"onMaskTouchMove",(function(e){var n,t;(c.isDraggingElement()||null!==(n=c.services)&&void 0!==n&&null!==(t=n.editingStateManager)&&void 0!==t&&t.isConnecting)&&e.preventDefault()})),c.inject=e,c.canvasSizeHandler=c.createCanvasSizeHandler(),c}return o()(a,[{key:"setViewerServiceDelegates",value:function(e){this.services=M(M({},this.services),e),this.canvasSizeHandler.setServices(e)}},{key:"setEditServiceDelegates",value:function(e){this.services=M(M({},this.services),e),this.canvasSizeHandler.setServices(e)}},{key:"setAsyncServiceDelegates",value:function(e){this.services=M(M({},this.services),e),this.canvasSizeHandler.setServices(e)}},{key:"getServices",value:function(){return this.services}},{key:"getPresentationSize",value:function(){var e,n,t=(null===(e=this.services)||void 0===e||null===(n=e.uiDataService)||void 0===n?void 0:n.presentation.props)||{},a=t.slideWidth,i=void 0===a?0:a,c=t.slideHeight;return{slideWidth:i,slideHeight:void 0===c?0:c}}},{key:"componentDidMount",value:function(){var e,n,t,a=this;window.addEventListener("resize",this.resizeDelay),window.addEventListener(S.b,this.resizeDelay),window.addEventListener(S.a,this.resize),window.addEventListener(S.c,(function(){a.slideScrollCenter(a.model.canvasSize)})),document.body.addEventListener("touchmove",this.onMaskTouchMove,{passive:!1}),this.slideScrollCenter(this.model.canvasSize),null===(e=this.viewDelegate)||void 0===e||e.disposeOnUnmount(Object(w.r)((function(){var e,n,t,i,c,o,r=a.getPresentationSize();return{slideWidth:r.slideWidth,slideHeight:r.slideHeight,curSlide:null===(e=a.services)||void 0===e||null===(n=e.selectionService)||void 0===n?void 0:n.currentSlide,headerFold:null===(t=a.services)||void 0===t||null===(i=t.toolbarStateManager)||void 0===i?void 0:i.isHeaderFold,toolbarMode:null===(c=a.services)||void 0===c||null===(o=c.toolbarStateManager)||void 0===o?void 0:o.getToolbarMode()}}),(function(e){a.handleSizeChange(e)}))),null===(n=this.props)||void 0===n||null===(t=n.canvasDidMountCallback)||void 0===t||t.call(n)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeDelay),window.removeEventListener("PPT-resize",this.resizeDelay),window.removeEventListener("immediately-resize",this.resize),document.body.removeEventListener("touchmove",this.onMaskTouchMove)}},{key:"getCanvasSizeHandler",value:function(){return this.canvasSizeHandler}},{key:"getNoteAreaInfo",value:function(){var e,n;return null!==(e=null===(n=this.noteAreaRef)||void 0===n?void 0:n.getNoteAreaInfo())&&void 0!==e?e:this.getDefaultNoteAreaInfo()}},{key:"initWithProps",value:function(e){var n,t,a,i,c=this.model.canvasSize;this.updateSlideSize(),this.updateDisableScroll(c),null===(n=this.services)||void 0===n||null===(t=n.editAreaCanvasSizeManager)||void 0===t||t.setCanvasSize({canvasWidth:null==c?void 0:c.width,canvasHeight:null==c?void 0:c.height,slideLeft:null==c?void 0:c.left,slideTop:null==c?void 0:c.top,scale:null==c?void 0:c.scale}),this.pageScale=null!==(a=null==c?void 0:c.scale)&&void 0!==a?a:1,this.isHeaderFold=!(null===(i=this.inject)||void 0===i||!i.isHeaderFold()),this.updateFontScale()}},{key:"createViewModel",value:function(){return new b.a}},{key:"getInitModelValue",value:function(){var e,n,t;return{canvasSize:this.canvasSizeHandler.getCanvasSize(null!==(e=this.isHeaderFold)&&void 0!==e?e:null===(n=this.inject)||void 0===n?void 0:n.isHeaderFold(),this.getDefaultNoteAreaInfo(),null===(t=this.inject)||void 0===t?void 0:t.isStatusBarFold())}}},{key:"updateSlideSize",value:function(){var e=this.getPresentationSize(),n=e.slideWidth,t=e.slideHeight;this.slideWidth=n,this.slideHeight=t}},{key:"updateCanvasSize",value:function(){var e,n=this.canvasSizeHandler.getCanvasSize(this.getHeaderFold(),this.getNoteAreaInfo(),null===(e=this.inject)||void 0===e?void 0:e.isStatusBarFold());return this.updateSlideSize(),this.updateDisableScroll(n),n}},{key:"getHeaderFold",value:function(){return this.isHeaderFold}},{key:"shouldResize",value:function(){return!0}},{key:"getResizeDelayTime",value:function(){return 0}},{key:"scrollToEndEditing",value:function(){}},{key:"containerDom",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById(g.c.CONTAINER)}},{key:"noteAreaRef",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById(g.c.NOTE_AREA)}},{key:"deselect",value:function(){var e,n,t,a,i,c,o,r,s,d;null===(e=this.services)||void 0===e||null===(n=e.selectionService)||void 0===n||n.selectedElements.clear(),null===(t=this.services)||void 0===t||null===(a=t.editingStateManager)||void 0===a||a.updateElementCropState(!1),null===(i=this.services)||void 0===i||null===(c=i.editingStateManager)||void 0===c||c.updateElementResizeState(!1),null===(o=this.services)||void 0===o||null===(r=o.editingStateManager)||void 0===r||r.updateElementDraggingState(!1),null===(s=this.services)||void 0===s||null===(d=s.editingStateManager)||void 0===d||d.updateElementRotateState(!1)}},{key:"hideFloatBar",value:function(){var e,n;null===(e=this.services)||void 0===e||null===(n=e.linkManager)||void 0===n||n.linkFloatBarService.hide()}},{key:"isSlideSizeChange",value:function(e,n,t,a){var i;return this.slideWidth!==e||this.slideHeight!==n||this.isHeaderFold!==t||(null!==(i=this.toolbarMode)&&void 0!==i?i:"none")!==(null!=a?a:"none")}}]),a}(p.a)},e7c4e8f59c:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a={name:"docs-component-read-record",loadType:t("0d2ffd3bdb").LoadType.ON_DEMAND}},ec3bbd441e:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a={name:"docs-component-doc-size",loadType:t("0d2ffd3bdb").LoadType.EAGER}},f64f479582:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var a,i=t("176815363d"),c=t.n(i),o=t("3ef2352f0b"),r=t.n(o),s=(t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),{name:"no-edit-file-info",plugin:(a=c()(r.a.mark((function e(){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e("vendors~service")]).then(t.bind(null,"a268811c9c"));case 2:return n=e.sent,e.abrupt("return",n.default);case 4:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})})},f9193d718f:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t("9132715560"),i=t.n(a),c=t("6a364eb35c"),o=t.n(c),r=t("85d0a7609b"),s=t.n(r),d=t("020899bf26"),u=t("2f1cded8d8"),l=function(){function e(){i()(this,e),s()(this,"editServicesHasLoad",!1),s()(this,"appServices",void 0)}return o()(e,[{key:"waitForReady",value:function(e){var n;this.editServicesHasLoad?e(this.appServices):null===(n=d.a.EventManager())||void 0===n||n.on(u.a.AppServiceProviderLoaded,e)}},{key:"getAppServices",value:function(){return this.appServices}},{key:"initWithAppServices",value:function(e){var n;this.appServices?window.log.error("app services instance has bind!"):(this.appServices=e,this.appServices.init()),this.editServicesHasLoad=!0,null===(n=d.a.EventManager())||void 0===n||n.emit(u.a.AppServiceProviderLoaded,this.appServices)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();s()(l,"instance",void 0)}}]);
//# sourceMappingURL=slide-base~37d786cf-84408d.js.map
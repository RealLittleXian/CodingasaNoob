(this.webpackJsonp=this.webpackJsonp||[]).push([["common~e81cc08e"],{"0130811e8a":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("711a53c9fc"),n=a("6f5f1758fe"),r=a("b41b5d48f6"),i=a("2ba82388a5");class o extends n.a{apply(e){const{themeId:t,themeName:a,themeElements:s}=this.data;e.store.addTheme({id:t,name:a,themeElements:Object(i.c)({},s)})}invert(){return[{type:s.c.RemoveTheme,themeId:this.data.themeId}]}check(e){const{themeId:t}=this.data;return r.a.every((()=>r.a.model.should.notExist(e,t)),(()=>r.a.theme.can.insertIntoThemeList(e,t)))}constructor(...e){super(...e),this.type=s.c.AddTheme}}},"025e3e9b74":function(e,t,a){"use strict";var s,n,r,i,o,d,c;a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"g",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return c})),function(e){e.EnqueueMutations="enqueue-mutations",e.CommitCommand="commit-command",e.SubmitMutations="submit-mutations",e.MutationsApplied="mutations-applied",e.MutationSource="mutation-source",e.MutationError="mutation-error",e.RequestBeginTransaction="request-begin-transaction",e.RequestEndTransaction="request-end-transaction",e.BeginTransaction="begin-transaction",e.EndTransaction="end-transaction",e.CommitTransaction="commit-transaction",e.Edit="edit",e.AttachDataModel="attach-data-model",e.DetachDataModel="detach-data-model",e.EnqueueChange="enqueue-change",e.OperationBegin="operation-begin",e.OperationEnd="operation-end",e.OperationError="operation-error",e.ModelObserveResourceMap="model-observe-resource-map",e.ResourceMapChange="resource-map-change",e.PageLoadingStateChange="page-loading-state-change"}(s||(s={})),function(e){e.CommitSucceed="commit-succeed",e.CommitFail="commit-fail",e.UpdateBaseRevision="update-revision-base-revision",e.ChangeToOffline="change-to-offline",e.ChangeToOnline="change-to-online",e.Enqueue="enqueue",e.FetchMissingDataError="fetch-missing-data-error",e.BaseVersionToLow="base-version-to-low",e.NoPrivilegeToSubmit="no-privilege-to-submit"}(n||(n={})),function(e){e.UndoRedoChange="undo-redo-change",e.Undo="undo",e.Redo="redo",e.ClearCommand="clear-command",e.Error="command-error"}(r||(r={})),function(e){e.ReceiveMessage="receive-message",e.NewChanges="new-changes",e.ShutDown="shut-down",e.UserEnter="user-enter",e.UserLeave="user-leave",e.CursorMessage="cursor-message",e.RightMessage="right-message",e.TitleMessage="title-message",e.DeleteDoc="delete-doc",e.LatestVersion="latest-version",e.RevertMessage="revert-message",e.AllLockInfo="all-lock-info",e.UnLockInfo="un-lock-info",e.WaterMarkChange="water-mark-change",e.ChangeToOnline="change-to-online",e.ChangeToOffline="change-to-offline",e.PresentInfo="present-info",e.AnonymousChange="anonymous-change",e.WebOfficeRevert="web-office-revert"}(i||(i={})),function(e){e.RecoveryStatusChange="recovery-status-change",e.GetAllMutationsPacks="persistent-changeset-getall",e.AddOrUpdateData="add-or-update-data",e.RemoveData="remove-data",e.ReplaceAllData="replace-all-data",e.OpenDataBaseError="open-data-base-error",e.DataBaseFatalError="data-base-fatal-error"}(o||(o={})),function(e){e.TransformError="transform-error",e.TransformTimeout="transform-timeout"}(d||(d={})),function(e){e.FatalError="fatal-error",e.StatusChange="collaboration-status-change"}(c||(c={}))},"02918f4580":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("7d682333dc"),n=a("a2f8b76737"),r=a("6486bacc70"),i=a("e5b1d85b0e");class o extends i.a{get tableChanges(){return this.tableChangeList}addTableChange(e){this.tableChangeList.push(e)}clearTableChanges(){this.tableChangeList=[]}get rowLength(){var e,t,a,s,n;return null!==(n=null===(s=this.props.graphic)||void 0===s||null===(a=s.graphicData)||void 0===a||null===(t=a.tbl)||void 0===t||null===(e=t.tr)||void 0===e?void 0:e.length)&&void 0!==n?n:0}get colLength(){var e,t,a,s,n,r;return null!==(r=null===(n=this.props.graphic)||void 0===n||null===(s=n.graphicData)||void 0===s||null===(a=s.tbl)||void 0===a||null===(t=a.tblGrid)||void 0===t||null===(e=t.gridCol)||void 0===e?void 0:e.length)&&void 0!==r?r:0}getRelatedPlaceholder(){var e;return this.context.getPlaceholder(null===(e=this.props.nvPr)||void 0===e?void 0:e.ph)}constructor(e,t,a,i){super(e,t,a,i),this.parent=i,this.tableChangeList=[],this.store=new n.a(e,t,this),this.props=new s.a(this.store.data,this.context),this.api=new r.a(this,t)}}},"03420c1dd4":function(e,t,a){"use strict";a.d(t,"b",(function(){return v})),a.d(t,"a",(function(){return b})),a.d(t,"f",(function(){return y})),a.d(t,"e",(function(){return S})),a.d(t,"d",(function(){return T})),a.d(t,"c",(function(){return x}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("2f766f71b0"),i=a.n(r),o=a("711a53c9fc"),d=a("262843d1f7"),c=a("ea786cec83"),l=a("36e02f5174"),u=a("026cc7da1f"),h=a("a9e0ee82c1"),p=a.n(h),f=a("9559b6ab8e"),g=a("78db0f5ada");function m(e,t){const a=t.idFactory(t.page.id),s=[],n={};return Object.entries(e.unitTimeNodeMap).forEach((([r,i])=>{if(r.startsWith(f.t)){var d;const e=null==i||null===(d=i.unitTimeNodeList)||void 0===d?void 0:d[0];if(e){var c,l,h;const a=null===(c=e.video||e.audio)||void 0===c?void 0:c.cMediaNode;(null==a||null===(l=a.cTn)||void 0===l?void 0:l.id)&&(a.cTn.id=t.idFactory(a.cTn.id));const s=null==a||null===(h=a.tgtEl)||void 0===h?void 0:h.spTgt;(null==s?void 0:s.spid)&&(s.spid=t.idFactory(s.spid)),n[t.idFactory(r.slice(f.t.length))]=e}return}Object(u.assert)(i);const m=r===f.q?f.q:t.idFactory(r),{unitTimeNodeList:v,type:b}=i;let y=0;null==v||v.forEach(((n,r)=>{var i;const d=new g.a(n);var c;d.id&&(null===(i=e.unitTimeNodeKeepMap)||void 0===i?void 0:i.has(d.id))&&(n=null===(c=e.unitTimeNodeKeepMap)||void 0===c?void 0:c.get(d.id),d.setData(n));const{shapeId:l,animType:u,presetSubtype:h,id:f}=d;if(!l||p()(u)||p()(h))return void(y+=1);const v=t.idFactory(l),I={type:o.c.AddAnimation,pageId:a,shapeId:v,triggerId:m,seqType:b,index:r-y},S=new g.a(n);f&&S.setId(t.idFactory(f)),v&&S.setShapeId(v);const T={type:o.c.SetAnimationProperties,shapeId:v,pageId:a,triggerId:m,seqType:b,index:r-y,timeNode:S.getData()};s.push(I,T)}))})),Object.entries(n).forEach((([e,t])=>{s.forEach((a=>{a.shapeId===e&&a.type===o.c.SetAnimationProperties&&(t.video?a.timeNode.video=t.video:t.audio&&(a.timeNode.audio=t.audio))}))})),s}function v(e,t,a){const n=a.idFactory(e.id),r=a.idFactory(P(e)),d={type:o.c.AddPage,pageId:n,slideMasterOptions:{themeId:e.themeId},shapeTreeId:r,index:t,pageType:o.Q.slideMaster},l=Object(s.a)({type:o.c.SetPageProperties,pageId:n,pageType:o.Q.slideMaster},c.a.fromMasterData(e)),u=e.layoutIdList.map(((e,t)=>{var s;return(null===(s=a.presentation)||void 0===s?void 0:s.layoutMap[e])?b(a.presentation.layoutMap[e],t,a):[]}));return i()([d,l,C(e,a,r),i()(u)])}function b(e,t,a){const n=a.idFactory(e.id),r=e.cSld.spTree?a.idFactory(e.cSld.spTree.id):d.d.next(),l={type:o.c.AddPage,pageId:n,slideLayoutOptions:{masterId:e.masterId},shapeTreeId:r,index:t,pageType:o.Q.slideLayout},u=Object(s.a)({type:o.c.SetPageProperties,pageId:n,pageType:o.Q.slideLayout},c.a.fromLayoutData(e));return i()([l,u,C(e,a,r)])}function y(e,t,a){var r,l,u;const h=a.idFactory(e.id),p=e.cSld.spTree?a.idFactory(e.cSld.spTree.id):d.d.next(),f={type:o.c.AddPage,pageId:h,slideOptions:{layoutId:e.layoutId},shapeTreeId:p,index:t,pageType:o.Q.slide},g=Object(s.a)({type:o.c.SetPageProperties,pageId:h,pageType:o.Q.slide},c.a.fromSlideData(e));var v;const b=null===(r=a.presentation)||void 0===r?void 0:r.noteSlideMap[null!==(v=e.noteSlideId)&&void 0!==v?v:""];return i()([f,g,i()(C(e,a,p)),(null===(u=e.cSld.spTree)||void 0===u||null===(l=u.nvPr)||void 0===l?void 0:l.descr)?I(h,p,e.cSld.spTree.nvPr.descr):[],e.timing?m(e.timing,Object(n.a)(Object(s.a)({},a),{page:e})):[],b?T(b,Object(n.a)(Object(s.a)({},a),{page:e})):[]])}function I(e,t,a){return{type:o.c.SetShapeProperties,pageId:e,shapeId:t,shapeDelta:{nvPr:{descr:a}}}}function S(e,t){var a;const n=t.idFactory(e.id);var r;const d=t.idFactory(null!==(r=null===(a=e.cSld.spTree)||void 0===a?void 0:a.id)&&void 0!==r?r:`${e.id}_spTree`);return[{type:o.c.AddPage,pageType:o.Q.notesMaster,index:0,shapeTreeId:d,pageId:n,notesMasterOptions:{themeId:e.themeId}},Object(s.a)({type:o.c.SetPageProperties,pageId:n,pageType:o.Q.notesMaster},c.a.fromNotesMasterData(e)),...i()(C(e,t,d))]}function T(e,t){var a;const n=t.idFactory(e.id),r=t.idFactory(t.page.id);var d;const l=t.idFactory(null!==(d=null===(a=e.cSld.spTree)||void 0===a?void 0:a.id)&&void 0!==d?d:`${e.id}_spTree`);return[{type:o.c.AddPage,pageType:o.Q.notes,index:0,shapeTreeId:l,pageId:n,notesOptions:{slideId:r}},Object(s.a)({type:o.c.SetPageProperties,pageId:n,pageType:o.Q.notes},c.a.fromNoteSlideData(e)),...i()(C(e,t,l))]}function x(e,t){const a=t.idFactory(e.id),n=t.idFactory(P(e)),r={type:o.c.AddPage,pageId:a,notesMasterOptions:{themeId:e.themeId},shapeTreeId:n,pageType:o.Q.notesMaster,index:0},d=Object(s.a)({type:o.c.SetPageProperties,pageId:a,pageType:o.Q.notesMaster},c.a.fromNotesMasterData(e));return i()([r,d,C(e,t,n)])}function C(e,t,a){var r;const o=e.cSld.spTree;var d;return o?i()(null!==(d=null===(r=o.shapeList)||void 0===r?void 0:r.map(((r,i)=>Object(l.a)(r,Object(n.a)(Object(s.a)({},t),{page:e}),a,i))))&&void 0!==d?d:[]):[]}function P(e){var t,a;return null!==(a=null===(t=e.cSld.spTree)||void 0===t?void 0:t.id)&&void 0!==a?a:d.d.next()}},"068937d534":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("e3f0495fe7"),n=a("d3d09f49d1"),r=a("7a7d98074c"),i=a("27ba227690"),o=a("f1643ac6d4"),d=a("e5b1d85b0e");class c extends d.a{getInheritedData(){return o.a.getInheritedData(this.getBaseProps())}getSubChart(e){return this.store.subChartList[e]}getRelatedPlaceholder(){var e;return this.context.getPlaceholder(null===(e=this.props.nvPr)||void 0===e?void 0:e.ph)}constructor(e,t,a,o){super(e,t,a,o),this.parent=o,this.context=new i.a(a),this.context.setChart(this),this.store=new n.a(e,t,this),this.props=new s.a(this.store.data,this.context),this.api=new r.a(this,t)}}},"07944bec9d":function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("711a53c9fc"),i=a("026cc7da1f"),o=a("7c46f42788"),d=a("b41b5d48f6"),c=a("2ba82388a5"),l=a("6f5f1758fe"),u=a("6ae44f9c25");class h extends l.a{apply(e){const{shapeId:t,shapeDelta:a}=this.data,r=e.store.models.get(t,...o.d);Object(i.assert)(r,"shape should exist");const d={nvPr:{addon:!0,attachment:!0},style:!0};r.type===o.a.Shape&&r.store.patchData(u.a.toShapeDataDelta(a),d),r.type===o.a.GroupShape&&r.store.patchData(u.a.toGroupShapeDataDelta(a),d),r.type===o.a.Connector&&r.store.patchData(u.a.toConnectorDataDelta(a),d),r.type===o.a.Picture&&r.store.patchData(u.a.toPictureDataDelta(a),d),r.type===o.a.GraphicalObjectFrameTable&&r.store.patchData(u.a.toTableDataDelta(a),Object(n.a)(Object(s.a)({},d),{graphic:{graphicData:{tbl:{tblPr:!0}}}})),r.type===o.a.GraphicalObjectFrameChart&&r.store.patchData(u.a.toGraphicObjectFrameDataDelta(a),d),r.type===o.a.GraphicalObjectFrameSmartArt&&r.store.patchData(u.a.toGraphicObjectFrameDataDelta(a))}invert(e){const{pageId:t,shapeId:a}=this.data,d=e.store.models.get(a,...o.d);Object(i.assert)(d,"shape should exist");const l={type:r.c.SetShapeProperties,pageId:t,shapeId:a};return d.type===o.a.Shape?[Object(n.a)(Object(s.a)({},l),{shapeDelta:Object(c.b)(u.a.fromShapeData(d.store.data),u.a.fromMutationData(this.data))})]:d.type===o.a.GroupShape?[Object(n.a)(Object(s.a)({},l),{shapeDelta:Object(c.b)(u.a.fromGroupShapeData(d.store.data),u.a.fromMutationData(this.data))})]:d.type===o.a.Connector?[Object(n.a)(Object(s.a)({},l),{shapeDelta:Object(c.b)(u.a.fromConnectorData(d.store.data),u.a.fromMutationData(this.data))})]:d.type===o.a.Picture?[Object(n.a)(Object(s.a)({},l),{shapeDelta:Object(c.b)(u.a.fromPictureData(d.store.data),u.a.fromMutationData(this.data))})]:d.type===o.a.GraphicalObjectFrameTable?[Object(n.a)(Object(s.a)({},l),{shapeDelta:Object(c.b)(u.a.fromTableData(d.store.data),u.a.fromMutationData(this.data))})]:d.type===o.a.GraphicalObjectFrameChart||d.type===o.a.GraphicalObjectFrameSmartArt?[Object(n.a)(Object(s.a)({},l),{shapeDelta:Object(c.b)(u.a.fromGraphicObjectFrameData(d.store.data),u.a.fromMutationData(this.data))})]:[]}check(e){return d.a.shape.should.existInPage(e,this.data.shapeId,this.data.pageId)}constructor(...e){super(...e),this.type=r.c.SetShapeProperties}}},"0815464a4d":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("40a3b0b347"),n=a("460aef6a6f"),r=a("22fa691790"),i=a("ff9b6dacaf");class o extends i.a{getRelatedPlaceholder(){var e;return this.context.getPlaceholder(null===(e=this.props.nvPr)||void 0===e?void 0:e.ph)}getText(){const e=this.props.txBody;if(!e)return"";let t="";var a;for(const i of null!==(a=e.p)&&void 0!==a?a:[]){var s;for(const e of null!==(s=i.egTextRun)&&void 0!==s?s:[]){var n,r;if(e.r)t+=null!==(n=e.r.t)&&void 0!==n?n:"";if(e.br&&(t+="\n"),e.fld)t+=null!==(r=e.fld.t)&&void 0!==r?r:""}t+="\n"}return t.slice(0,-1)}constructor(e,t,a,i){super(t,a),this.parent=i,this.store=new r.a(e,t,this),this.props=new n.c(this.store.data,this.context),this.api=new s.a(this,t)}}},"09ca8a17b7":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("711a53c9fc"),n=a("6f5f1758fe"),r=a("b41b5d48f6");class i extends n.a{apply(e){const{sectionId:t,name:a}=this.data;e.store.addSection({id:t,name:a,numSlides:0})}invert(){return[{type:s.c.RemoveSection,sectionId:this.data.sectionId}]}check(e){const{sectionId:t}=this.data;return r.a.model.should.notExist(e,t)}constructor(...e){super(...e),this.type=s.c.AddSection}}},"0d856a1e47":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788"),d=a("b56763d092");class c extends r.a{apply(e){if(!this.data.shapeId||0===this.data.count)return;const{shapeId:t,index:a,count:s}=this.data,r=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(r,"shape should exist"),r&&r.store.insertTableRow(a,s)}invert(){const{pageId:e,shapeId:t,index:a,count:n}=this.data;return[{type:s.c.DeleteTableRow,pageId:e,shapeId:t,index:a,count:n}]}check(e){const{pageId:t,shapeId:a,index:s,count:n}=this.data,r=e.store.models.get(a,o.a.GraphicalObjectFrameTable);var c;const l=Object(d.h)(null!==(c=null==r?void 0:r.store.tableData)&&void 0!==c?c:{});return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.table.can.addRowOrCol(e,a,s,n,!0,l))}constructor(...e){super(...e),this.type=s.c.InsertTableRow}}},"128d9bfc05":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788");class d extends r.a{apply(e){if(!this.data.shapeId||!this.data.heights)return;const{shapeId:t,heights:a}=this.data,s=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(s,"table should exist"),s&&s.store.setTableRowHeights(a)}invert(e){const{pageId:t,shapeId:a}=this.data,r=e.store.models.get(a,o.a.GraphicalObjectFrameTable);Object(n.assert)(r,"shape should exist");const i=null==r?void 0:r.store.rowList.map(((e,t)=>{var a;return{index:t,height:null!==(a=e.h)&&void 0!==a?a:0}}));return[{type:s.c.SetTableRowHeights,pageId:t,shapeId:a,heights:i}]}check(e){const{pageId:t,shapeId:a}=this.data;return i.a.shape.should.existInPage(e,a,t)}constructor(...e){super(...e),this.type=s.c.SetTableRowHeights}}},"12d9a4c052":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s,n=a("711a53c9fc"),r=a("29b58f6049");!function(e){e.Normal="normal",e.Followed="followed"}(s||(s={}));class i{resolveColor(e,t){var a,s;const n=null===(a=(s=t.getPageContext()).getThemeContext)||void 0===a?void 0:a.call(s).getSchemeColorMap();return{srgbClr:Object(r.a)(e,n).srgbClr}}getHLinkColor(e,t="normal"){const a={schemeClr:{val:{normal:n.eb.hlink,followed:n.eb.folHlink}[t]}};return this.resolveColor(a,e)}}},"16c79d63a4":function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return d}));var s,n,r,i=a("311f2fc38c"),o=a("182341de5a");!function(e){e.LoadingHead="LoadingHead",e.LoadingChunk="LoadingChunk",e.Modified="Modified",e.Sync="Sync",e.Syncing="Syncing",e.Corrupted="Corrupted"}(s||(s={})),function(e){e.Sync="Sync",e.Syncing="Syncing"}(n||(n={})),function(e){e[e.LoadHeadSuccess=0]="LoadHeadSuccess",e[e.LoadAllChunksSuccess=1]="LoadAllChunksSuccess",e[e.LoadError=2]="LoadError",e[e.EditorUndo=3]="EditorUndo",e[e.EditorRedo=4]="EditorRedo",e[e.EditorOperation=5]="EditorOperation",e[e.ResourceSyncBegin=6]="ResourceSyncBegin",e[e.ResourceSyncEnd=7]="ResourceSyncEnd"}(r||(r={}));class d{getDocumentStatus(){return this.documentStatus}getResourceStatus(){return this.resourceStatus}getCorruptedError(){return this.corruptedError}waitForDocumentReady(){return new Promise((e=>{this.onDocumentReady((()=>{e()}))}))}isDocumentReady(){return!["LoadingHead","LoadingChunk","Corrupted"].includes(this.documentStatus)}onDocumentReady(e){if(this.isDocumentReady())return void e();const t=this.onDocumentStatusChange((()=>{this.isDocumentReady()&&(e(),t())}))}addDocumentSyncingTask(e){var t=this;return Object(i.a)((function*(){for(t.isDocumentReady()||(yield t.waitForDocumentReady());"Syncing"===t.documentStatus&&t.currentDocumentSyncingTask;)yield t.currentDocumentSyncingTask;if(t.isSyncInCurrentMicroTaskQueue)return;const a=(s=Object(i.a)((function*(){t.setDocumentStatus("Syncing"),"Syncing"===t.resourceStatus&&(yield t.waitForResourceSync());const a=t.getSyncKey();try{yield e(),t.lastSyncKey=a}catch(e){throw e}finally{t.currentDocumentSyncingTask=null,t.switchSyncStatus(),"Sync"===t.documentStatus&&(t.isSyncInCurrentMicroTaskQueue=!0,setTimeout((()=>{t.isSyncInCurrentMicroTaskQueue=!1})))}})),function(){return s.apply(this,arguments)});var s;t.currentDocumentSyncingTask=a(),yield t.currentDocumentSyncingTask}))()}addResourceSyncingTask(e){var t=this;return Object(i.a)((function*(){t.deltaResourceSyncingCount(1),e().finally((()=>{t.deltaResourceSyncingCount(-1)}))}))()}onDocumentStatusChange(e){return this.emitter.on("document-status-change",e)}onResourceStatusChange(e){return this.emitter.on("resource-status-change",e)}init(){return this.emitter.on(0,(()=>this.finishHeadLoading())),this.emitter.on(1,(()=>this.finishDocumentLoading())),this.emitter.on(2,(e=>this.intoCorrupted(e))),this.emitter.on(3,this.handleUndo),this.emitter.on(4,this.handleRedo),this.emitter.on(5,this.handleInput),this.emitter.on(6,(()=>this.deltaResourceSyncingCount(1))),this.emitter.on(7,(()=>this.deltaResourceSyncingCount(-1))),this}waitForResourceSync(){var e=this;return Object(i.a)((function*(){yield new Promise((t=>{const a=e.onResourceStatusChange((e=>{"Sync"===e&&(a(),t())}))}))}))()}intoCorrupted(e){return this.assertStatus("LoadingHead","LoadingChunk"),this.corruptedError=e,this.setDocumentStatus("Corrupted"),this}setDocumentStatus(e){this.documentStatus!==e&&(this.documentStatus=e,this.emitter.emit("document-status-change",e))}setResourceStatus(e){this.resourceStatus!==e&&(this.resourceStatus=e,this.emitter.emit("resource-status-change",e))}assertStatus(...e){if(!e.includes(this.documentStatus))throw new Error(`Document status is ${this.documentStatus}, but expected ${e.join(" or ")}`)}switchSyncStatus(){this.isModified()?this.setDocumentStatus("Modified"):this.setDocumentStatus("Sync")}getSyncKey(){return this.syncStack[this.syncTop]}pushSyncKey(){this.syncStack.push(this.key),this.key+=1,this.syncTop+=1}isModified(){return this.getSyncKey()!==this.lastSyncKey}deltaResourceSyncingCount(e){this.syncingResourceCount+=e,this.setResourceStatus(this.syncingResourceCount>0?"Syncing":"Sync")}finishHeadLoading(){this.assertStatus("LoadingHead"),this.setDocumentStatus("LoadingChunk")}finishDocumentLoading(){this.assertStatus("LoadingChunk","LoadingHead","Modified"),this.switchSyncStatus()}constructor(e=Object(o.a)()){this.emitter=e,this.key=0,this.documentStatus="LoadingHead",this.resourceStatus="Sync",this.currentDocumentSyncingTask=null,this.syncingResourceCount=0,this.syncStack=[],this.syncTop=-1,this.lastSyncKey=NaN,this.isSyncInCurrentMicroTaskQueue=!1,this.handleUndo=()=>{-1!==this.syncTop&&(this.syncTop-=1,"Syncing"!==this.documentStatus&&this.switchSyncStatus())},this.handleRedo=()=>{this.syncTop+=1,"Syncing"!==this.documentStatus&&this.switchSyncStatus()},this.handleInput=()=>{this.syncStack.splice(this.syncTop+1),this.pushSyncKey(),"Syncing"!==this.documentStatus&&this.switchSyncStatus()},this.pushSyncKey(),this.lastSyncKey=this.getSyncKey(),this.init()}}},"16d54e1923":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("ebdb1e97f1"),n=a("285f8ccc4f"),r=a("fdddc95d9b"),i=a("025e3e9b74"),o=a("384878758a");class d{get id(){return this.store.data.id}get type(){return this.store.data.type}getOwnedData(){return this.store.data}getWritableOwnedData(){return this.store.data}getInheritedData(){return s.a.getInheritedData(this.getBaseProps())}getCloneData(){return Object(n.a)(this.store.data)}subscribe(e,t={}){var a;return this.subscribers.set(e,{priority:null!==(a=t.priority)&&void 0!==a?a:0}),t.initialChange&&this.notify({type:o.a.Init,source:r.a.None,diffs:{data:this.store.data,props:this.props}}),()=>{this.unsubscribe(e)}}unsubscribe(e){this.subscribers.delete(e)}notify(...e){Array.from(this.subscribers.entries()).sort((([,{priority:e}],[,{priority:t}])=>t-e)).forEach((([t])=>{e.forEach((e=>{t(e)}))}))}attach(){return this.events.emit(i.e.AttachDataModel,this),this}detach(){return this.events.emit(i.e.DetachDataModel,this),this}dispose(){this.subscribers.clear(),this.getBaseProps().dispose(),this.store.dispose()}resourceSubscribe(e){this.events.emit(i.e.ModelObserveResourceMap,this,e)}forEachDescendant(e=(()=>{})){}getDescendants(){const e=[];return this.forEachDescendant((t=>e.push(t))),e}getBaseProps(){return this.props}constructor(e){this.events=e,this.subscribers=new Map}}},"225da3354c":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("025e3e9b74");class n{get dataModelEvents(){return{onPageLoadingStateChange:e=>this.on(s.e.PageLoadingStateChange,e)}}get socketEvents(){return{onReceiveMessage:e=>this.on(s.g.ReceiveMessage,e),onRevertMessage:e=>this.on(s.g.RevertMessage,e),onChangeToOnline:e=>this.on(s.g.ChangeToOnline,e),onChangeToOffline:e=>this.on(s.g.ChangeToOffline,e),onShutDown:e=>this.on(s.g.ShutDown,e),onDeleteDoc:e=>this.on(s.g.DeleteDoc,e),onTitleChange:e=>this.on(s.g.TitleMessage,e),onUserEnter:e=>this.on(s.g.UserEnter,e),onUserLeave:e=>this.on(s.g.UserLeave,e),onAllLockInfo:e=>this.on(s.g.AllLockInfo,e),onUnlockInfo:e=>this.on(s.g.UnLockInfo,e),onCursorMessage:e=>this.on(s.g.CursorMessage,e),onWaterMarkChange:e=>this.on(s.g.WaterMarkChange,e),onRightMessage:e=>this.on(s.g.RightMessage,e),onPresentInfo:e=>this.on(s.g.PresentInfo,e),onAnonymousChange:e=>this.on(s.g.AnonymousChange,e),onWebOfficeRevert:e=>this.on(s.g.WebOfficeRevert,e)}}get mutationEvents(){return{onCommitCommand:e=>this.on(s.e.CommitCommand,((t,a,s)=>e(s))),onCommitTransaction:e=>this.on(s.e.CommitTransaction,e),onSubmitMutations:e=>this.on(s.e.SubmitMutations,e),onMutationApplied:e=>this.on(s.e.MutationsApplied,e)}}get persistentEvents(){return{onRecoveryStatusChange:e=>this.on(s.d.RecoveryStatusChange,e),onDataBaseFatalError:e=>this.on(s.d.DataBaseFatalError,e),onAddOrUpdateData:e=>this.on(s.d.AddOrUpdateData,e),onRemoveData:e=>this.on(s.d.RemoveData,e),onOpenDataBaseError:e=>this.on(s.d.OpenDataBaseError,e),onReplaceAllData:e=>this.on(s.d.ReplaceAllData,e)}}get revisionEvents(){return{onCommitSucceed:e=>this.on(s.f.CommitSucceed,e),onCommitFail:e=>this.on(s.f.CommitFail,e),onChangeToOnline:e=>this.on(s.f.ChangeToOnline,e),onChangeToOffline:e=>this.on(s.f.ChangeToOffline,e),onEnqueue:e=>this.on(s.f.Enqueue,e),onFetchMissingDataError:e=>this.on(s.f.FetchMissingDataError,e),onUpdateBaseRevision:e=>this.on(s.f.UpdateBaseRevision,e),onBaseVersionToLow:e=>this.on(s.f.BaseVersionToLow,e)}}get commandEvents(){return{onUndoRedoChange:e=>this.on(s.b.UndoRedoChange,e),onRedo:e=>this.on(s.b.Redo,e),onUndo:e=>this.on(s.b.Undo,e),onClearCommand:e=>this.on(s.b.ClearCommand,e)}}get otTransformEvents(){return{onTransformError:e=>this.on(s.c.TransformError,e),onTransformTimeout:e=>this.on(s.c.TransformTimeout,e)}}get collaboratorEvents(){return{onFatalError:e=>this.on(s.a.FatalError,e),onStatusChange:e=>this.on(s.a.StatusChange,e)}}on(e,t){var a;return this.handler[e]||(this.handler[e]=[]),null===(a=this.handler[e])||void 0===a||a.push(t),()=>this.off(e,t)}once(e,t){const a=this.on(e,((...e)=>{t(...e),a()}))}emit(e,...t){const a=this.handler[e];if(null==a?void 0:a.length)for(const e of Array.from(a))e(...t)}off(e,t){const a=this.handler[e];if(a)if(t){const e=a.findIndex((e=>e===t));e>-1&&a.splice(e,1)}else a.splice(0,a.length)}dispose(){this.handler={}}constructor(){this.handler={}}}},"22adaceb28":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("711a53c9fc"),i=a("215eaa3247");const o={[r.c.SetPresentationProperties]:function({presentationPr:e,defaultTextStyle:t,tableStyleList:a,embeddedFontList:s,viewPr:n,showSpecialPlsOnTitleSld:i,firstSlideNum:o,slideGuideList:d}){return{type:r.c.SetPresentationProperties,presentationPr:e,defaultTextStyle:t,tableStyleList:a,embeddedFontList:s,viewPr:n,showSpecialPlsOnTitleSld:i,firstSlideNum:o,slideGuideList:d}},[r.c.SetSlideSize]:function({size:e}){if(e)return{type:r.c.SetSlideSize,size:e}},[r.c.AddPage]:function({pageId:e,shapeTreeId:t,index:a,pageType:s,slideOptions:n,slideMasterOptions:i,slideLayoutOptions:o,notesOptions:d,notesMasterOptions:c}){if(e&&s&&t)return{type:r.c.AddPage,pageType:s,index:null!=a?a:0,shapeTreeId:t,pageId:e,slideOptions:n,slideMasterOptions:i,slideLayoutOptions:o,notesOptions:d,notesMasterOptions:c}},[r.c.RemovePage]:function({pageId:e,pageType:t,parentId:a,index:s}){if(e&&t)return{type:r.c.RemovePage,pageId:e,pageType:t,parentId:null!=a?a:"",index:null!=s?s:0}},[r.c.MovePage]:function({pageId:e,pageType:t,srcParentPageId:a,srcIndex:s,destParentPageId:n,destIndex:i}){if(e&&t)return{type:r.c.MovePage,pageId:e,pageType:t,srcParentPageId:null!=a?a:"",srcIndex:null!=s?s:0,destParentPageId:null!=n?n:"",destIndex:null!=i?i:0}},[r.c.SetPageProperties]:function({pageId:e,pageType:t,pageProperties:a,slideProperties:s,layoutProperties:n,masterProperties:i,notesProperties:o,notesMasterProperties:d}){if(t===r.Q.slide&&!s&&!a)return;if(t===r.Q.slideLayout&&!n&&!a)return;if(t===r.Q.slideMaster&&!i&&!a)return;if(t===r.Q.notes&&!o&&!a)return;if(t===r.Q.notesMaster&&!d&&!a)return;if(e&&t)return{type:r.c.SetPageProperties,pageId:e,pageType:t,pageProperties:a,slideProperties:s,layoutProperties:n,masterProperties:i,notesProperties:o,notesMasterProperties:d}},[r.c.AddShape]:function({pageId:e,shapeId:t,shapeType:a,tableOptions:s,parentId:n,index:i}){if(e&&t&&a)return{type:r.c.AddShape,pageId:e,shapeId:t,shapeType:a,tableOptions:s,parentId:null!=n?n:"",index:null!=i?i:0}},[r.c.RemoveShape]:function({pageId:e,shapeId:t,parentId:a,index:s}){if(e&&t&&a)return{type:r.c.RemoveShape,pageId:e,shapeId:t,parentId:a,index:null!=s?s:0}},[r.c.TransformShape]:function({pageId:e,shapeId:t,parentId:a,shapeType:s,xfrmDelta:n,chXfrmDelta:i,clearXfrm:o}){if(o===!(!n&&!i))return;if(s!==r.ac.GroupShape&&i)return;if(e&&t&&s)return{type:r.c.TransformShape,pageId:e,shapeId:t,parentId:null!=a?a:"",shapeType:s,xfrmDelta:n,chXfrmDelta:i,clearXfrm:o}},[r.c.MoveShape]:function({pageId:e,shapeId:t,opType:a,destShapeId:s,srcParentId:n,destParentId:i,srcIndex:o,destIndex:d}){if(e&&t&&n&&i)return{type:r.c.MoveShape,pageId:e,shapeId:t,destShapeId:null!=s?s:"",opType:null!=a?a:0,srcParentId:n,destParentId:i,srcIndex:null!=o?o:0,destIndex:null!=d?d:0}},[r.c.Group]:function({pageId:e,groupShapeId:t,shapeIds:a,isSmartArt:s,parentId:n,index:i}){if(e&&t)return{type:r.c.Group,pageId:e,groupShapeId:t,shapeIds:null!=a?a:[],isSmartArt:!!s,parentId:null!=n?n:"",index:null!=i?i:0}},[r.c.Ungroup]:function({pageId:e,groupShapeId:t,shapeIds:a,parentId:s,index:n}){if(e&&t&&s)return{type:r.c.Ungroup,pageId:e,groupShapeId:t,shapeIds:null!=a?a:[],parentId:s,index:null!=n?n:0}},[r.c.SetShapeProperties]:function({pageId:e,shapeId:t,shapeDelta:a}){if(e&&t&&a)return{type:r.c.SetShapeProperties,pageId:e,shapeId:t,shapeDelta:Object(n.a)(Object(s.a)({},a),{spPr:a.spPr&&Object(i.b)(a.spPr,"xfrm")})}},[r.c.AddSection]:function({sectionId:e,name:t}){if(e)return{type:r.c.AddSection,sectionId:e,name:null!=t?t:""}},[r.c.RemoveSection]:function({sectionId:e}){if(e)return{type:r.c.RemoveSection,sectionId:e}},[r.c.SetSectionProperties]:function({sectionId:e,name:t}){if(e)return{type:r.c.SetSectionProperties,sectionId:e,name:null!=t?t:""}},[r.c.BindSectionToSlide]:function({sectionId:e,firstSlideIndex:t}){if(e)return{type:r.c.BindSectionToSlide,sectionId:e,firstSlideIndex:null!=t?t:0}},[r.c.InsertTableRow]:function({pageId:e,shapeId:t,index:a,count:s}){if(e&&t)return{type:r.c.InsertTableRow,pageId:e,shapeId:t,index:null!=a?a:0,count:null!=s?s:0}},[r.c.InsertTableCol]:function({pageId:e,shapeId:t,index:a,count:s}){if(e&&t)return{type:r.c.InsertTableCol,pageId:e,shapeId:t,index:null!=a?a:0,count:null!=s?s:0}},[r.c.DeleteTableRow]:function({pageId:e,shapeId:t,index:a,count:s}){if(e&&t)return{type:r.c.DeleteTableRow,pageId:e,shapeId:t,index:null!=a?a:0,count:null!=s?s:0}},[r.c.DeleteTableCol]:function({pageId:e,shapeId:t,index:a,count:s}){if(e&&t)return{type:r.c.DeleteTableCol,pageId:e,shapeId:t,index:null!=a?a:0,count:null!=s?s:0}},[r.c.MergeTableCells]:function({pageId:e,shapeId:t,range:a}){const s=c(a);if(e&&t&&s)return{type:r.c.MergeTableCells,pageId:e,shapeId:t,range:s}},[r.c.UnmergeTableCells]:function({pageId:e,shapeId:t,range:a}){const s=c(a);if(e&&t&&s)return{type:r.c.UnmergeTableCells,pageId:e,shapeId:t,range:s}},[r.c.SetTableColWidths]:function({pageId:e,shapeId:t,widths:a}){if(e&&t&&a)return{type:r.c.SetTableColWidths,pageId:e,shapeId:t,widths:a.map((({index:e,width:t})=>({index:null!=e?e:0,width:null!=t?t:0})))}},[r.c.SetTableRowHeights]:function({pageId:e,shapeId:t,heights:a}){if(e&&t&&a)return{type:r.c.SetTableRowHeights,pageId:e,shapeId:t,heights:a.map((({index:e,height:t})=>({index:null!=e?e:0,height:null!=t?t:0})))}},[r.c.SetTableCellProperties]:function({pageId:e,shapeId:t,range:a,tableCellProperties:s}){const n=c(a);if(e&&t&&n&&void 0!==s)return{type:r.c.SetTableCellProperties,pageId:e,shapeId:t,range:n,tableCellProperties:s}},[r.c.AddAnimation]:function({pageId:e,shapeId:t,triggerId:a,seqType:s,index:n}){if(e&&t&&a&&s)return{type:r.c.AddAnimation,pageId:e,shapeId:t,triggerId:a,seqType:s,index:null!=n?n:0}},[r.c.RemoveAnimation]:function({pageId:e,shapeId:t,triggerId:a,seqType:s,index:n}){if(s&&a&&t&&e)return{type:r.c.RemoveAnimation,index:null!=n?n:0,seqType:s,triggerId:a,shapeId:t,pageId:e}},[r.c.SetAnimationProperties]:function({pageId:e,shapeId:t,triggerId:a,seqType:s,index:n,timeNode:i}){if(e&&t&&a&&s&&i)return{type:r.c.SetAnimationProperties,pageId:e,shapeId:t,triggerId:a,seqType:s,index:null!=n?n:0,timeNode:i}},[r.c.MoveAnimation]:function({pageId:e,shapeId:t,fromTriggerId:a,triggerId:s,fromSeqType:n,seqType:i,fromIndex:o,index:d}){if(i&&n&&s&&a&&t&&e)return{type:r.c.MoveAnimation,index:null!=d?d:0,fromIndex:null!=o?o:0,seqType:i,fromSeqType:n,triggerId:s,fromTriggerId:a,shapeId:t,pageId:e}},[r.c.AddTheme]:function({themeId:e,themeName:t,themeElements:a}){if(e&&a)return{type:r.c.AddTheme,themeId:e,themeName:null!=t?t:"",themeElements:a}},[r.c.RemoveTheme]:function({themeId:e}){if(e)return{type:r.c.RemoveTheme,themeId:e}},[r.c.SetTheme]:function({themeId:e,themeName:t,themeElements:a}){if(e&&a)return{type:r.c.SetTheme,themeId:e,themeName:null!=t?t:"",themeElements:a}},[r.c.SetTextData]:function({pageId:e,shapeId:t,text:a,row:s,col:n,textProperties:i}){if(e&&t)return{type:r.c.SetTextData,pageId:e,shapeId:t,text:null!=a?a:"",row:null!=s?s:0,col:null!=n?n:0,textProperties:null!=i?i:[]}},[r.c.SetTextBodyProperties]:function({pageId:e,shapeId:t,row:a,col:s,textBodyProperties:n,textListStyle:i}){if(e&&t)return{type:r.c.SetTextBodyProperties,pageId:e,shapeId:t,row:null!=a?a:0,col:null!=s?s:0,textBodyProperties:n,textListStyle:i}},[r.c.SetChartSpaceProperties]:function({shapeId:e,pageId:t,chartSpacePr:a}){if(a&&e&&t)return{type:r.c.SetChartSpaceProperties,shapeId:e,pageId:t,chartSpacePr:a}},[r.c.AddSubChart]:function({shapeId:e,pageId:t,index:a,subChartType:s}){if(e&&t&&s)return{type:r.c.AddSubChart,shapeId:e,pageId:t,index:null!=a?a:0,subChartType:s}},[r.c.SetSubChartProperties]:function({shapeId:e,pageId:t,index:a,plot:s,axesPr:n}){if(e&&t)return{type:r.c.SetSubChartProperties,shapeId:e,pageId:t,index:null!=a?a:0,plot:s||{},axesPr:null!=n?n:null}},[r.c.RemoveSubChart]:function({shapeId:e,pageId:t,index:a}){if(e&&t)return{type:r.c.RemoveSubChart,shapeId:e,pageId:t,index:null!=a?a:0}},[r.c.ComputeGroupTransform]:function({pageId:e,groupId:t,parentId:a,shapeIds:s}){if(e&&t)return{type:r.c.ComputeGroupTransform,pageId:e,groupId:t,shapeIds:null!=s?s:[],parentId:null!=a?a:""}},[r.c.SetDiagramData]:function({pageId:e,shapeId:t,dataModel:a}){if(e&&t&&a)return{type:r.c.SetDiagramData,pageId:e,shapeId:t,dataModel:a}},[r.c.SetDiagramDrawing]:function({pageId:e,shapeId:t,drawing:a}){if(e&&t&&a)return{type:r.c.SetDiagramDrawing,pageId:e,shapeId:t,drawing:a}},[r.c.SetDiagrams]:function({pageId:e,shapeId:t,layoutDef:a,styleDef:s,colorDef:n}){if(e&&t&&a&&s&&n)return{type:r.c.SetDiagrams,pageId:e,shapeId:t,layoutDef:a,styleDef:s,colorDef:n}},[r.c.MoveSubChart]:function({shapeId:e,pageId:t,destIndex:a,srcIndex:s}){if(e&&t)return{type:r.c.MoveSubChart,shapeId:e,pageId:t,srcIndex:null!=s?s:0,destIndex:null!=a?a:0}},[r.c.UpdateResourceMap]:function({id:e="",resourceType:t,imageDescriptor:a,videoDescriptor:s,audioDescriptor:n,fontDescriptor:i}){if(t===r.e.Image&&a)return{type:r.c.UpdateResourceMap,id:e,resourceType:t,imageDescriptor:a};if(t===r.e.Video&&s)return{type:r.c.UpdateResourceMap,id:e,resourceType:t,videoDescriptor:s};if(t===r.e.Audio&&n)return{type:r.c.UpdateResourceMap,id:e,resourceType:t,audioDescriptor:n};if(t===r.e.Font&&i)return{type:r.c.UpdateResourceMap,id:e,resourceType:t,fontDescriptor:i};return},[r.c.InsertText]:e=>e,[r.c.DeleteText]:e=>e,[r.c.SetTextProperties]:e=>e,[r.c.GroupAsSmartArt]:e=>e,[r.c.SetNotesSize]:e=>e};function d(e){var t;if(e.type)return null===(t=o[e.type])||void 0===t?void 0:t.call(o,e)}function c(e){if(!e)return;const{startRowIndex:t=0,startColIndex:a=0,rowSpan:s=0,colSpan:n=0}=e;return t<0||a<0||s<=0||n<=0?void 0:{startRowIndex:t,startColIndex:a,rowSpan:s,colSpan:n}}},"22cd640443":function(e,t,a){"use strict";var s;a.d(t,"a",(function(){return s})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.TIMEOUT=2]="TIMEOUT"}(s||(s={}))},"23b30ccff5":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("8c0defe94d"),i=a("7c46f42788");class o{static convertSmartArtToIGroupShapeData(e){var t,a,o;const{diagram:c}=e;return Object(n.a)(Object(s.a)({},(e=>{var{diagram:t}=e;return Object(r.a)(e,["diagram"])})(e)),{type:i.a.GroupShape,shapeList:(null==c||null===(o=c.drawing)||void 0===o||null===(a=o.spTree)||void 0===a||null===(t=a.egGroupShapeMsDsp)||void 0===t?void 0:t.map((e=>{if(null==e?void 0:e.sp)return d.toShape(null==e?void 0:e.sp);throw new Error("Invalid item: 'sp' property is missing.")})))||[]})}}class d{static fromShape(e){const{nvPr:t,spPr:a,style:s,txBody:n,txXfrm:r,modelId:i}=e;return{nvSpPr:{cNvPr:{hlinkClick:t.hlinkClick,hlinkHover:t.hlinkHover,name:t.name,descr:t.descr,hidden:t.hidden,title:t.title},cNvSpPr:{spLocks:t.locking,txBox:t.txBox}},spPr:a,style:s,txBody:n,txXfrm:r,modelId:i}}static toShape(e){var t,a,s,n,r,o,d,c;const{nvSpPr:l,spPr:u,style:h,txBody:p,txXfrm:f,modelId:g}=e,m={hlinkClick:null==l||null===(t=l.cNvPr)||void 0===t?void 0:t.hlinkClick,hlinkHover:null==l||null===(a=l.cNvPr)||void 0===a?void 0:a.hlinkHover,name:null==l||null===(s=l.cNvPr)||void 0===s?void 0:s.name,descr:null==l||null===(n=l.cNvPr)||void 0===n?void 0:n.descr,hidden:null==l||null===(r=l.cNvPr)||void 0===r?void 0:r.hidden,title:null==l||null===(o=l.cNvPr)||void 0===o?void 0:o.title,locking:null==l||null===(d=l.cNvSpPr)||void 0===d?void 0:d.spLocks,txBox:null==l||null===(c=l.cNvSpPr)||void 0===c?void 0:c.txBox};return{type:i.a.Shape,id:g||"",nvPr:m,spPr:u||{},style:h,txBody:p,txXfrm:f,modelId:g}}}},"25242563a6":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("026cc7da1f"),i=a("6f5f1758fe"),o=a("fdddc95d9b"),d=a("b41b5d48f6");class c extends i.a{apply(e){const{resourceType:t,id:a,imageDescriptor:i}=this.data;t===n.e.Image&&(Object(r.assert)(i,"imageDescriptor should not be null"),e.store.updateImageResourceMap(a,Object(s.a)({id:a},i)));const{videoDescriptor:o}=this.data;t===n.e.Video&&(Object(r.assert)(o,"videoDescriptor should not be null"),e.store.updateVideoResourceMap(a,Object(s.a)({id:a},o)));const{audioDescriptor:d}=this.data;t===n.e.Audio&&(Object(r.assert)(d,"audioDescriptor should not be null"),e.store.updateAudioResourceMap(a,Object(s.a)({id:a},d)));const{fontDescriptor:c}=this.data;t===n.e.Font&&(Object(r.assert)(c,"fontDescriptor should not be null"),e.store.updateFontResourceMap(a,Object(s.a)({id:a},c)))}invert(){return[]}check(e,t){if(t!==o.a.Keyframe)return d.a.resourceMap.id.is.valid(this.data.id)}constructor(...e){super(...e),this.type=n.c.UpdateResourceMap}}},"2d8cd79090":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("71a705e3db"),n=a("fdfb69b53e"),r=a("3e6c51064c"),i=a("16d54e1923");class o extends i.a{constructor(e,t,a){super(t),this.parent=a,this.context={getPresentation:()=>this.parent,getTarget:()=>this},this.store=new n.a(e,t,this),this.props=new s.a(this.store.data),this.api=new r.a(this,t)}}},"36e02f5174":function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return m}));var s=a("711a53c9fc"),n=a("7c46f42788"),r=a("c586ed7dd7"),i=a("7ecd30c99e"),o=a("9303123b33"),d=a("215eaa3247"),c=a("2ba82388a5"),l=a("6ae44f9c25"),u=a("b56763d092");var h=a("727c0c7dd8"),p=a("285f8ccc4f");const f=[{egTextRun:[],endParaRPr:{},pPr:{}}];function g(e,t,a,s){const n=[];return Object(r.b)({shapeList:[e],id:a},((e,s,r,i)=>{m(e,t,a,i+s).forEach((e=>n.push(e)))}),s),n}function m(e,t,a,r=0){const g=t.idFactory(t.page.id),m=t.idFactory(e.id),v=e.type===n.a.Shape&&e.nvPr.isEquationShape,b=e.spPr.xfrm?[{type:s.c.TransformShape,pageId:g,shapeId:m,parentId:a,shapeType:v?s.ac.Equation:n.b.toShapeType(e.type),xfrmDelta:Object(d.b)(e.spPr.xfrm,"chOff","chExt")}]:[];if(e.type===n.a.GroupShape){b[0]&&(b[0].chXfrmDelta=e.spPr.xfrm&&{chOff:e.spPr.xfrm.chOff,chExt:e.spPr.xfrm.chExt});return[{type:s.c.Group,pageId:g,groupShapeId:m,shapeIds:e.shapeList.map((e=>t.idFactory(e.id))),parentId:a,index:r,isSmartArt:!1},{type:s.c.SetShapeProperties,pageId:g,shapeId:m,shapeDelta:Object(c.a)(l.a.fromGroupShapeData(e))},...b]}if(e.type===n.a.Connector){var y,I;const{nvPr:a}=e;(null===(y=a.stCxn)||void 0===y?void 0:y.id)&&(a.stCxn.id=t.idFactory(a.stCxn.id)),(null===(I=a.endCxn)||void 0===I?void 0:I.id)&&(a.endCxn.id=t.idFactory(a.endCxn.id))}const S={type:s.c.AddShape,pageId:g,shapeId:m,shapeType:v?s.ac.Equation:n.b.toShapeType(e.type),tableOptions:{},parentId:a,index:r};let T=[];var x,C,P,O,D,j,M,L,w;e.type===n.a.GraphicalObjectFrameTable&&(S.tableOptions={rowCount:(null===(O=e.graphic)||void 0===O||null===(P=O.graphicData)||void 0===P||null===(C=P.tbl)||void 0===C||null===(x=C.tr)||void 0===x?void 0:x.length)||1,colCount:(null===(w=e.graphic)||void 0===w||null===(L=w.graphicData)||void 0===L||null===(M=L.tbl)||void 0===M||null===(j=M.tblGrid)||void 0===j||null===(D=j.gridCol)||void 0===D?void 0:D.length)||1},T=function(e,t){var a,n,r,i,o,d;const c=[],l=null===(n=e.graphic)||void 0===n||null===(a=n.graphicData)||void 0===a?void 0:a.tbl;if(!l)return[];const h=t.idFactory(e.id),p=t.idFactory(t.page.id);null==l||null===(r=l.tr)||void 0===r||r.forEach(((e,t)=>{var a;const n=[];null==e||null===(a=e.tc)||void 0===a||a.forEach(((e,a)=>{(null==e?void 0:e.tcPr)&&n.push({type:s.c.SetTableCellProperties,pageId:p,shapeId:h,range:{startRowIndex:t,startColIndex:a,rowSpan:1,colSpan:1},tableCellProperties:e.tcPr})})),c.push(...n)}));const f={type:s.c.SetTableRowHeights,pageId:p,shapeId:h,heights:(null==l||null===(i=l.tr)||void 0===i?void 0:i.map(((e,t)=>({index:t,height:(null==e?void 0:e.h)||0}))))||[]},g={type:s.c.SetTableColWidths,pageId:p,shapeId:h,widths:(null===(d=l.tblGrid)||void 0===d||null===(o=d.gridCol)||void 0===o?void 0:o.map(((e,t)=>({index:t,width:(null==e?void 0:e.w)||0}))))||[]};c.push(f,g);const m=Object(u.h)(l);return c.push(...m.map((e=>({type:s.c.MergeTableCells,pageId:p,shapeId:h,range:e})))),c}(e,t));let E=[];e.type===n.a.GraphicalObjectFrameChart&&(E=function(e,t){const a=[],n=t.idFactory(t.page.id),r=t.idFactory(e.id),i=Object(p.a)(e.chartSpace);if(i){var o,d;const e=null===(d=i.chart)||void 0===d||null===(o=d.plotArea)||void 0===o?void 0:o.charts;var c,l;void 0!==e&&(null==i||null===(l=i.chart)||void 0===l||null===(c=l.plotArea)||void 0===c||delete c.charts);const t={type:s.c.SetChartSpaceProperties,shapeId:r,pageId:n,chartSpacePr:i};a.push(t),null==e||e.forEach(((e,t)=>{const i={type:s.c.AddSubChart,shapeId:r,pageId:n,index:t,subChartType:e.type};a.push(i);const o={type:s.c.SetSubChartProperties,shapeId:r,pageId:n,index:t,plot:(new h.a).createEgPlotBySubChart(e),axesPr:{axes:e.axes,index:e.axesAddIndex}};a.push(o)}))}return a}(e,t));let R=[];e.type===n.a.GraphicalObjectFrameSmartArt&&(R=function(e,t){const a=[],n=t.idFactory(t.page.id),r=t.idFactory(e.id),i=Object(p.a)(e.diagram);if(i.drawing){const e={type:s.c.SetDiagramDrawing,shapeId:r,pageId:n,drawing:i.drawing};a.push(e)}if(i.dataModel){const e={type:s.c.SetDiagramData,shapeId:r,pageId:n,dataModel:i.dataModel};a.push(e)}if(i.layoutDef||i.colorDefs||i.styleDef){const e={type:s.c.SetDiagrams,shapeId:r,pageId:n,layoutDef:i.layoutDef,colorDef:i.colorDef,styleDef:i.styleDef};a.push(e)}return a}(e,t));const A=function(e,t,a){const s=[],r=[];if(e.type===n.a.Shape&&e.txBody){const{bodyPr:n,lstStyle:d,p:c}=e.txBody;(n||d)&&r.push(o.b.fromTextBodyProperties(e.txBody,t,a)),(null==c?void 0:c.length)?s.push(i.b.fromParagraphListData(c,t,a)):s.push(i.b.fromParagraphListData(f,t,a))}else if(e.type===n.a.GraphicalObjectFrameTable){var d,c,l,u;null===(u=e.graphic)||void 0===u||null===(l=u.graphicData)||void 0===l||null===(c=l.tbl)||void 0===c||null===(d=c.tr)||void 0===d||d.forEach(((e,n)=>{var d;return null==e||null===(d=e.tc)||void 0===d?void 0:d.forEach(((e,d)=>{if(!e.txBody)return;const{bodyPr:c,lstStyle:l,p:u}=e.txBody;(c||l)&&r.push(o.b.fromTextBodyProperties(e.txBody,t,a,d,n)),(null==u?void 0:u.length)&&s.push(i.b.fromParagraphListData(u,t,a,d,n))}))}))}return[...s,...r]}(e,g,m);return[S,{type:s.c.SetShapeProperties,pageId:g,shapeId:m,shapeDelta:Object(c.a)(l.a.fromDrawingShapeData(e))},...b,...T,...A,...E,...R]}},"38432b74aa":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("711a53c9fc"),n=a("6f5f1758fe"),r=a("b41b5d48f6");class i extends n.a{apply(e){const{pageType:t,srcParentPageId:a,destParentPageId:n,srcIndex:r,destIndex:i}=this.data;t!==s.Q.slide?t!==s.Q.slideLayout?t===s.Q.slideMaster&&e.store.moveMaster(r,i):e.store.moveLayout(a,n,r,i):e.store.moveSlide(r,i)}invert(){const{pageId:e,pageType:t,srcParentPageId:a,destParentPageId:n,srcIndex:r,destIndex:i}=this.data;return[{type:s.c.MovePage,pageId:e,pageType:t,srcParentPageId:n,destParentPageId:a,srcIndex:i,destIndex:r}]}check(e){const{pageId:t,pageType:a,srcParentPageId:n,destParentPageId:i,srcIndex:o,destIndex:d}=this.data;return a===s.Q.slide?r.a.every(r.a.pageList.should.containSlideInPosition(e,o,t),r.a.page.can.insertIntoSlideList(e,t,d)):a===s.Q.slideLayout?r.a.every(r.a.pageList.should.containLayoutInPosition(e,n,o,t),r.a.page.can.insertIntoLayoutIdList(e,t,i,d)):a===s.Q.slideMaster?r.a.every(r.a.pageList.should.containMasterInPosition(e,o,t),r.a.page.can.insertIntoMasterList(e,t,d)):void 0}constructor(...e){super(...e),this.type=s.c.MovePage}}},"384878758a":function(e,t,a){"use strict";var s;a.d(t,"a",(function(){return s})),function(e){e[e.Init=0]="Init",e[e.DataPatch=1]="DataPatch",e[e.PropsInheritance=2]="PropsInheritance",e[e.ChildList=3]="ChildList",e[e.ChildMap=4]="ChildMap"}(s||(s={}))},"3852df4c58":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("9e5a1b9cc4"),n=a("2f85b2f86f"),r=a("ebec73b55e"),i=a("ff9b6dacaf");class o extends i.a{getRelatedPlaceholder(){var e;return this.context.getPlaceholder(null===(e=this.props.nvPr)||void 0===e?void 0:e.ph)}constructor(e,t,a,i){super(t,a),this.parent=i,this.store=new n.a(e,t,this),this.props=new s.a(this.store.data,this.context),this.api=new r.a(this,t)}}},"3e2e3e7bce":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("7c46f42788"),o=a("b41b5d48f6"),d=a("2ba82388a5");class c extends r.a{apply(e){const{shapeId:t,chartSpacePr:a}=this.data,s=e.store.models.get(t,i.a.GraphicalObjectFrameChart);Object(n.assert)(s,"chart should exist"),s.store.patchChartSpace(a),s.store.createSubChartList()}check(e){return o.a.shape.should.existInPage(e,this.data.shapeId,this.data.pageId)}invert(e){const{pageId:t,shapeId:a}=this.data,r=e.store.models.get(a,i.a.GraphicalObjectFrameChart);return Object(n.assert)(r,"chart should exist"),[{type:s.c.SetChartSpaceProperties,pageId:t,shapeId:a,chartSpacePr:Object(d.b)(r.store.data.chartSpace,this.data.chartSpacePr)}]}constructor(...e){super(...e),this.type=s.c.SetChartSpaceProperties}}},"3e3b82a8aa":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788");class d extends r.a{apply(e){if(!this.data.shapeId)return;const{shapeId:t,range:a}=this.data,s=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(s,"table should exist"),s&&s.store.unMergeTableCells(a)}invert(){const{pageId:e,shapeId:t,range:a}=this.data;return[{type:s.c.MergeTableCells,pageId:e,shapeId:t,range:a}]}check(e){const{pageId:t,shapeId:a,range:s}=this.data;return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.table.can.mergeTableCells(e,a,s),i.a.table.range.is.singleMergedRange(e,a,s))}constructor(...e){super(...e),this.type=s.c.UnmergeTableCells}}},"3e57ea86bc":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("026cc7da1f"),i=a("6f5f1758fe"),o=a("b41b5d48f6"),d=a("7c46f42788"),c=a("4289c697da"),l=a("285f8ccc4f");class u extends i.a{apply(e){const{groupId:t}=this.data,a=e.store.models.get(t,d.a.GroupShape);if(Object(r.assert)(a),a.shapeList.length<=0)return;const s=Object(c.f)(a.shapeList.map((e=>e.getFrame())),a.store.data.spPr.xfrm&&a.getFrame()),{off:n,ext:i,chOff:o,chExt:l}=s;a.store.patchData({spPr:{xfrm:{off:n,ext:i,chOff:o,chExt:l}}})}invert(e){var t;const{pageId:a,groupId:i,parentId:o}=this.data,c=e.store.models.get(i,...d.d);Object(r.assert)(c);const u=Object(l.a)(null===(t=c.store.data.spPr)||void 0===t?void 0:t.xfrm),{off:h,ext:p,chOff:f,chExt:g}=null!=u?u:{},m=u?{xfrmDelta:{off:h,ext:p},chXfrmDelta:{chOff:f,chExt:g}}:{clearXfrm:!0};return[Object(s.a)({type:n.c.TransformShape,pageId:a,shapeId:i,parentId:o,shapeType:n.ac.GroupShape},m)]}check(e){const{pageId:t,groupId:a}=this.data;return o.a.shape.should.existInPage(e,a,t)}constructor(...e){super(...e),this.type=n.c.ComputeGroupTransform}}},"4157227dc7":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788"),d=a("285f8ccc4f"),c=a("daff531963"),l=a("b56763d092");class u extends r.a{apply(e){if(!this.data.shapeId||0===this.data.count)return;const{shapeId:t,index:a,count:s}=this.data,r=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(r,"shape should exist"),r&&r.store.deleteTableRows(a,s)}invert(e){const{pageId:t,shapeId:a,index:r,count:i}=this.data,c=e.store.models.get(a,o.a.GraphicalObjectFrameTable);Object(n.assert)(c,"shape should exist");const l=Object(d.a)(null==c?void 0:c.store.rowList).slice(r,r+i).map(((e,t)=>{var a;return{index:r+t,height:null!==(a=e.h)&&void 0!==a?a:0}}));return[{type:s.c.InsertTableRow,pageId:t,shapeId:a,index:r,count:i},{type:s.c.SetTableRowHeights,pageId:t,shapeId:a,heights:l}]}check(e){const{pageId:t,shapeId:a,index:s,count:n}=this.data,r=e.store.models.get(a,o.a.GraphicalObjectFrameTable);var d;const u=Object(l.h)(null!==(d=null==r?void 0:r.store.tableData)&&void 0!==d?d:{});return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.table.can.deleteRowOrCol(e,a,s,n,c.a.ROW,u))}constructor(...e){super(...e),this.type=s.c.DeleteTableRow}}},"420d598ff9":function(e,t,a){"use strict";a.d(t,"a",(function(){return oe}));var s=a("711a53c9fc"),n=a("09ca8a17b7"),r=a("efb57b1462"),i=a("c685265b1c"),o=a("f8a9d85cf9"),d=a("026cc7da1f"),c=a("7c46f42788"),l=a("b41b5d48f6"),u=a("6f5f1758fe");class h extends u.a{apply(e){var t;const{shapeId:a,pageId:n,shapeType:r,tableOptions:i}=this.data;let{parentId:o,index:l}=this.data;const u=null===(t=e.store.models.get(n,...c.c))||void 0===t?void 0:t.store.getShapeTree();!o&&u&&(o=u.id,l=u.shapeList.length);const h=e.store.models.get(o,c.a.GroupShape);if(Object(d.assert)(h,"group shape should not exist"),r!==s.ac.GraphicalObjectFrameTable)if(r!==s.ac.Shape)if(r!==s.ac.Equation)h.store.addShape({id:a,type:c.b.fromShapeType(r),nvPr:{},spPr:{}},l);else{const e={id:a,type:c.a.Shape,nvPr:{isEquationShape:!0},spPr:{},txBody:{bodyPr:{},p:[]}};h.store.addShape(e,l)}else{const e={id:a,type:c.a.Shape,nvPr:{},spPr:{},txBody:{bodyPr:{},p:[]}};h.store.addShape(e,l)}else{const{rowCount:e=1,colCount:t=1}=null!=i?i:{},s={id:a,type:c.a.GraphicalObjectFrameTable,nvPr:{},spPr:{},graphic:{graphicData:{tbl:{tblGrid:{gridCol:Array.from({length:t},(()=>({w:0})))},tr:Array.from({length:e},(()=>({h:0,tc:Array.from({length:t},(()=>({txBody:{bodyPr:{},p:[]}})))})))}}}};h.store.addShape(s,l)}}invert(){return[{type:s.c.RemoveShape,pageId:this.data.pageId,shapeId:this.data.shapeId,parentId:this.data.parentId,index:this.data.index}]}check(e){var t;const{pageId:a,shapeId:s}=this.data;let{parentId:n,index:r}=this.data;const i=null===(t=e.store.models.get(a,...c.c))||void 0===t?void 0:t.store.getShapeTree();return!n&&i&&(n=i.id,r=i.shapeList.length),l.a.every((()=>l.a.model.should.notExist(e,s)),(()=>l.a.shape.should.existInPage(e,n,a)),(()=>l.a.shape.is.typeOf(e,n,c.a.GroupShape)),(()=>l.a.groupShape.can.insertShapeToPosition(e,n,r,s)))}constructor(...e){super(...e),this.type=s.c.AddShape}}var p=a("6f50907d63"),f=a("5d6df242e3"),g=a("07944bec9d"),m=a("5150a29f68"),v=a("5a8749f72e"),b=a("468f65f56d"),y=a("61211f3c6b"),I=a("76f2cf9a19"),S=a("fd3bb9fd64"),T=a("5a0111def3"),x=a("0130811e8a"),C=a("844d924118"),P=a("777acf2e7d"),O=a("7ecd30c99e"),D=a("3e2e3e7bce"),j=a("cc8734d850"),M=a("51e3210cf9");class L extends u.a{apply(e){const{shapeId:t,srcIndex:a,destIndex:s}=this.data,n=e.store.models.get(t,c.a.GraphicalObjectFrameChart);Object(d.assert)(n,"chart should exist"),n.store.moveSubChart(a,s)}check(e){const{pageId:t,shapeId:a,srcIndex:s,destIndex:n}=this.data;return l.a.every(l.a.shape.should.existInPage(e,this.data.shapeId,this.data.pageId),l.a.chart.is.inSideSubChartRange(e,t,a,s),l.a.chart.is.inSideSubChartRange(e,t,a,n))}invert(){return[{type:s.c.MoveSubChart,pageId:this.data.pageId,shapeId:this.data.shapeId,srcIndex:this.data.destIndex,destIndex:this.data.srcIndex}]}constructor(...e){super(...e),this.type=s.c.MoveSubChart}}var w=a("7064f45d39"),E=a("1f69014a3c"),R=a("2ba82388a5");class A extends u.a{apply(e){if(!this.data.shapeId)return;const{shapeId:t,dataModel:a}=this.data,s=e.store.models.get(t,c.a.GraphicalObjectFrameSmartArt);Object(d.assert)(s,"shape should exist"),s&&s.store.setDiagramData(a)}invert(e){var t;const{pageId:a,shapeId:n}=this.data,r=e.store.models.get(n,c.a.GraphicalObjectFrameSmartArt);return Object(d.assert)(r,"shape should exist"),[Object(E.a)({type:s.c.SetDiagramData,pageId:a,shapeId:n},Object(R.b)({dataModel:null===(t=r.store.data.diagram)||void 0===t?void 0:t.dataModel},{dataModel:this.data.dataModel},{dataModel:!0}))]}check(e){const{pageId:t,shapeId:a}=this.data;return l.a.every(l.a.shape.should.existInPage(e,a,t))}constructor(...e){super(...e),this.type=s.c.SetDiagramData}}var k=a("a74785d12e");class F extends u.a{apply(e){if(!this.data.shapeId)return;const{shapeId:t,layoutDef:a,styleDef:s,colorDef:n}=this.data,r=e.store.models.get(t,c.a.GraphicalObjectFrameSmartArt);Object(d.assert)(r,"shape should exist"),r&&r.store.setDiagrams(a,s,n)}invert(e){var t,a,n;const{pageId:r,shapeId:i}=this.data,o=e.store.models.get(i,c.a.GraphicalObjectFrameSmartArt);return Object(d.assert)(o,"shape should exist"),[Object(E.a)({type:s.c.SetDiagrams,pageId:r,shapeId:i},Object(R.b)({layoutDef:null===(t=o.store.data.diagram)||void 0===t?void 0:t.layoutDef},{layoutDef:this.data.layoutDef},{layoutDef:!0}),Object(R.b)({styleDef:null===(a=o.store.data.diagram)||void 0===a?void 0:a.styleDef},{styleDef:this.data.styleDef},{styleDef:!0}),Object(R.b)({colorDef:null===(n=o.store.data.diagram)||void 0===n?void 0:n.colorDef},{colorDef:this.data.colorDef},{colorDef:!0}))]}check(e){const{pageId:t,shapeId:a}=this.data;return l.a.every(l.a.shape.should.existInPage(e,a,t))}constructor(...e){super(...e),this.type=s.c.SetDiagrams}}var B=a("22adaceb28"),N=a("9303123b33"),V=a("51767cbdc7"),U=a("fdddc95d9b");class $ extends u.a{apply(e){const{pageType:t,pageId:a,shapeTreeId:n,index:r}=this.data,i=this.getParentIdFromData(),o={id:a,cSld:{}};if(t!==s.Q.slide)if(t!==s.Q.slideLayout)if(t!==s.Q.slideMaster)if(t!==s.Q.notes)if(t!==s.Q.notesMaster);else{e.store.addNotesMaster(Object(V.a)(Object(E.a)({},o),{themeId:i})).store.createShapeTree(n)}else{const t=e.store.getSlideById(i);Object(d.assert)(t,"slide not found"),t.store.updateNoteSlideId(a);e.store.addNoteSlide(Object(V.a)(Object(E.a)({},o),{slideId:i})).store.createShapeTree(n)}else{e.store.addMaster(Object(V.a)(Object(E.a)({},o),{themeId:i,layoutIdList:[],slideGuideList:[]}),r).store.createShapeTree(n)}else{e.store.addLayout(Object(V.a)(Object(E.a)({},o),{masterId:i,slideGuideList:[]}),r).store.createShapeTree(n)}else{e.store.addSlide(Object(V.a)(Object(E.a)({},o),{layoutId:i}),r).store.createShapeTree(n)}}invert(){const{pageType:e,pageId:t,index:a}=this.data,n=this.getParentIdFromData();return[{type:s.c.RemovePage,pageType:e,pageId:t,parentId:n,index:a}]}check(e,t){if(this.data.pageType===s.Q.notesMaster)return;const{pageType:a,pageId:n,index:r}=this.data,i=this.getParentIdFromData(),o=l.a.model.should.notExist(e,n);return o||(a===s.Q.slide?(t===U.a.Keyframe&&(null===(d=this.data.slideOptions)||void 0===d?void 0:d.layoutId)&&(this.data.slideOptions.layoutId=""),l.a.every(t===U.a.Keyframe?()=>{}:()=>l.a.page.should.exist(e,i,s.Q.slideLayout),(()=>l.a.page.can.insertIntoSlideList(e,n,r)))):a===s.Q.slideLayout?l.a.page.can.insertIntoLayoutIdList(e,n,i,r):a===s.Q.slideMaster?l.a.every((()=>l.a.theme.should.existInPresentation(e,i)),(()=>l.a.page.can.insertIntoMasterList(e,n,r))):a===s.Q.notes?l.a.every((()=>l.a.page.should.exist(e,i,s.Q.slide))):void 0);var d}getParentIdFromData(){var e,t,a,n,r,i;return null!==(i={[s.Q.slide]:null===(e=this.data.slideOptions)||void 0===e?void 0:e.layoutId,[s.Q.slideLayout]:null===(t=this.data.slideLayoutOptions)||void 0===t?void 0:t.masterId,[s.Q.slideMaster]:null===(a=this.data.slideMasterOptions)||void 0===a?void 0:a.themeId,[s.Q.notes]:null===(n=this.data.notesOptions)||void 0===n?void 0:n.slideId,[s.Q.notesMaster]:null===(r=this.data.notesMasterOptions)||void 0===r?void 0:r.themeId,[s.Q.PBDEFAULT]:null}[this.data.pageType])&&void 0!==i?i:""}constructor(...e){super(...e),this.type=s.c.AddPage}}var G=a("38432b74aa");class Q extends u.a{apply(e){const{pageType:t,pageId:a,index:n}=this.data;if(t!==s.Q.slide)if(t!==s.Q.slideLayout)if(t!==s.Q.slideMaster){if(t===s.Q.notes){var r;const t=null===(r=e.store.getNoteSlideById(a))||void 0===r?void 0:r.getSlide();return null==t||t.store.updateNoteSlideId(null),void e.store.removeNoteSlide(a)}t!==s.Q.notesMaster||e.store.removeNotesMaster(a)}else e.store.removeMasterByIndex(n);else e.store.removeLayoutByIndex(a,n);else e.store.removeSlideByIndex(n)}invert(e){const{pageType:t,pageId:a,index:n,parentId:r}=this.data,i=e.store.getPageByIdAndType(a,t);Object(d.assert)(i,"page should exist");const o={type:s.c.AddPage,pageType:t,pageId:a,shapeTreeId:i.store.getShapeTree().id,index:n};return t===s.Q.slide&&(o.slideOptions={layoutId:r}),t===s.Q.slideLayout&&(o.slideLayoutOptions={masterId:r}),t===s.Q.slideMaster&&(o.slideMasterOptions={themeId:r}),t===s.Q.notes&&(o.notesOptions={slideId:r}),t===s.Q.notesMaster&&(o.notesMasterOptions={themeId:r}),[o]}check(e){const{pageType:t,pageId:a,parentId:n,index:r}=this.data;return t===s.Q.slide?l.a.every((()=>l.a.pageList.should.containSlideInPosition(e,r,a)),(()=>l.a.page.should.haveNoStaleReference(e,a))):t===s.Q.slideLayout?l.a.every((()=>l.a.pageList.should.containLayoutInPosition(e,n,r,a)),(()=>l.a.page.should.haveNoStaleReference(e,a))):t===s.Q.slideMaster?l.a.every((()=>l.a.pageList.should.containMasterInPosition(e,r,a)),(()=>l.a.page.should.haveNoStaleReference(e,a))):t===s.Q.notes?l.a.every((()=>l.a.page.should.exist(e,n,s.Q.slide))):void 0}constructor(...e){super(...e),this.type=s.c.RemovePage}}var q=a("ea786cec83"),W=a("c305455190"),z=a("59e51a6447"),H=a("6821617d4e"),K=a("4157227dc7"),_=a("90a993b6f1"),X=a("0d856a1e47"),Y=a("8d1a1b3ebd"),Z=a("b8a3288ad7"),J=a("128d9bfc05"),ee=a("3e3b82a8aa"),te=a("decfd055a5");class ae extends u.a{apply(){}invert(){return[]}check(){}constructor(...e){super(...e),this.type=s.c.Empty}}var se=a("d3f3e93e04"),ne=a("25242563a6"),re=a("3e57ea86bc");const ie=new Map([[s.c.Empty,e=>new ae(e)],[s.c.SetPresentationProperties,e=>new W.a(e)],[s.c.SetSlideSize,e=>new z.a(e)],[s.c.AddPage,e=>new $(e)],[s.c.RemovePage,e=>new Q(e)],[s.c.MovePage,e=>new G.a(e)],[s.c.SetPageProperties,e=>new q.b(e)],[s.c.AddShape,e=>new h(e)],[s.c.RemoveShape,e=>new p.a(e)],[s.c.TransformShape,e=>new v.a(e)],[s.c.MoveShape,e=>new m.a(e)],[s.c.Group,e=>new f.a(e)],[s.c.Ungroup,e=>new b.a(e)],[s.c.SetShapeProperties,e=>new g.a(e)],[s.c.AddSection,e=>new n.a(e)],[s.c.RemoveSection,e=>new i.a(e)],[s.c.SetSectionProperties,e=>new o.a(e)],[s.c.BindSectionToSlide,e=>new r.a(e)],[s.c.InsertTableRow,e=>new X.a(e)],[s.c.InsertTableCol,e=>new _.a(e)],[s.c.DeleteTableRow,e=>new K.a(e)],[s.c.DeleteTableCol,e=>new H.a(e)],[s.c.MergeTableCells,e=>new Y.a(e)],[s.c.UnmergeTableCells,e=>new ee.a(e)],[s.c.SetTableColWidths,e=>new Z.a(e)],[s.c.SetTableRowHeights,e=>new J.a(e)],[s.c.SetTableCellProperties,e=>new te.a(e)],[s.c.AddAnimation,e=>new y.a(e)],[s.c.RemoveAnimation,e=>new I.a(e)],[s.c.SetAnimationProperties,e=>new S.a(e)],[s.c.MoveAnimation,e=>new T.a(e)],[s.c.SetTextData,e=>new O.a(e)],[s.c.AddTheme,e=>new x.a(e)],[s.c.RemoveTheme,e=>new C.a(e)],[s.c.SetTheme,e=>new P.a(e)],[s.c.SetTextBodyProperties,e=>new N.a(e)],[s.c.SetChartSpaceProperties,e=>new D.a(e)],[s.c.AddSubChart,e=>new j.a(e)],[s.c.RemoveSubChart,e=>new M.a(e)],[s.c.MoveSubChart,e=>new L(e)],[s.c.SetSubChartProperties,e=>new w.a(e)],[s.c.SetNotesSize,e=>new se.a(e)],[s.c.UpdateResourceMap,e=>new ne.a(e)],[s.c.ComputeGroupTransform,e=>new re.a(e)],[s.c.SetDiagramData,e=>new A(e)],[s.c.SetDiagramDrawing,e=>new k.a(e)],[s.c.SetDiagrams,e=>new F(e)]]);function oe(e){return e.map(((e,t)=>{const a=Object(B.a)(e);var n;if(!(null==a?void 0:a.type))throw new Error(`Invalid mutation data @${t} [${s.c[null!==(n=e.type)&&void 0!==n?n:s.c.Empty]}]: ${JSON.stringify(e)}`);const r=ie.get(a.type);if(!r)throw new Error(`mutation factory is not registered: ${s.c[a.type]}`);return r(a)}))}},"468f65f56d":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("a7888a8b87"),i=a.n(r),o=a("b41b5d48f6"),d=a("6f5f1758fe"),c=a("7c46f42788"),l=a("36e02f5174");class u extends d.a{apply(e){const{groupShapeId:t}=this.data,a=e.store.models.get(t,c.a.GroupShape),s=null==a?void 0:a.parent;Object(n.assert)((null==s?void 0:s.type)===c.a.GroupShape,"groupShape parent is not a group shape"),s.store.ungroupChildGroupById(t)}invert(e){const{pageId:t,groupShapeId:a,parentId:s,index:r}=this.data,o=e.store.models.get(t,...c.e);Object(n.assert)(o,"page should exist");const d=e.store.models.get(a,...c.d);Object(n.assert)(d,"shape should exist");const u={presentation:e.store.data,page:o.store.data,idFactory:e=>e};return[].push(),Object(l.b)(i()(d.store.data),u,s,r)}check(e){const{pageId:t,groupShapeId:a,parentId:s,index:n,shapeIds:r}=this.data;return o.a.every(o.a.shape.should.existInPage(e,a,t),o.a.shape.should.existInPage(e,s,t),o.a.shape.is.typeOf(e,a,c.a.GroupShape),o.a.shape.should.matchShapeListInPosition(e,s,n,[a]),o.a.shape.should.matchShapeListInPosition(e,a,0,r))}constructor(...e){super(...e),this.type=s.c.Ungroup}}},"4d9587dc90":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("bca9c17275"),n=a("1a60256e28"),r=a("8309a7c071"),i=a("e5b1d85b0e");class o extends i.a{get shapeList(){return this.store.shapeList}constructor(e,t,a,i){super(e,t,a,i),this.parent=i,this.store=new s.a(e,this,t,a),this.props=new r.a(this.store.data,a),this.api=new n.a(this,t)}}},"5150a29f68":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788");class d extends r.a{apply(e){const{srcParentId:t,destParentId:a,srcIndex:s,destIndex:r}=this.data,i=e.store.models.get(t,o.a.GroupShape);if(Object(n.assert)(i,"group shape should not exist"),t===a)i.store.shapeList.move(s,r);else{const t=e.store.models.get(a,o.a.GroupShape);Object(n.assert)(t,"dest group shape should not exist");const d=i.store.shapeList.at(s);i.store.shapeList.transferTo(t.store.shapeList,s,r,1),d.parent=t}}invert(){const{pageId:e,shapeId:t,srcParentId:a,destParentId:n,srcIndex:r,destIndex:i}=this.data;return[{type:s.c.MoveShape,pageId:e,shapeId:t,srcParentId:n,destParentId:a,srcIndex:i,destIndex:r,opType:0,destShapeId:""}]}check(e){const{pageId:t,shapeId:a,srcParentId:s,destParentId:n,srcIndex:r,destIndex:o}=this.data;return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.shape.should.existInPage(e,s,t),i.a.shape.should.existInPage(e,n,t),i.a.shape.should.matchShapeListInPosition(e,s,r,[a]),i.a.groupShape.can.insertShapeToPosition(e,n,o,a))}constructor(...e){super(...e),this.type=s.c.MoveShape}}},"51e3210cf9":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("a7888a8b87"),i=a.n(r),o=a("7c46f42788"),d=a("6f5f1758fe"),c=a("b41b5d48f6"),l=a("727c0c7dd8");class u extends d.a{apply(e){const{shapeId:t,index:a}=this.data,s=e.store.models.get(t,o.a.GraphicalObjectFrameChart);Object(n.assert)(s,"chart should exist"),s.store.removeSubChartByIndex(a)}check(e){const{pageId:t,shapeId:a,index:s}=this.data;return c.a.every(c.a.shape.should.existInPage(e,this.data.shapeId,this.data.pageId),c.a.chart.is.inSideSubChartRange(e,t,a,s))}invert(e){const{pageId:t,shapeId:a,index:r}=this.data,d=e.store.models.get(a,o.a.GraphicalObjectFrameChart);Object(n.assert)(d,"chart should exist");const c=d.store.subChartList[r];Object(n.assert)(c,"subChart should exist");const{axes:u,axesAddIndex:h,type:p}=i()(c);return[{type:s.c.AddSubChart,pageId:t,shapeId:a,index:r,subChartType:p},{type:s.c.SetSubChartProperties,pageId:t,shapeId:a,index:r,axesPr:{axes:u,index:h},plot:(new l.a).createEgPlotBySubChart(c)}]}constructor(...e){super(...e),this.type=s.c.RemoveSubChart}}},"5224738a3a":function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var s=a("2f766f71b0"),n=a.n(s),r=a("8f58e78419"),i=a.n(r),o=a("0815464a4d"),d=a("02918f4580"),c=a("98d30755dc"),l=a("e5b2319967"),u=a("bb096e3c53"),h=a("7ecd30c99e"),p=a("fce1cf19ce"),f=a("711a53c9fc"),g=a("025e3e9b74");class m{searchText(e,t){if(!e.length)return[];const a=e.toLocaleLowerCase(),s=(null==t?void 0:t.length)?n()([...new Set(t)].map((e=>this.recurseAllComponents(e)))):[...this.recurseAllComponents(this.presentation)],r=[];return s.forEach((e=>{if(e instanceof o.a){var t;const n=e;var s;const i=h.b.fromParagraphListData(null!==(s=null===(t=n.store.data.txBody)||void 0===t?void 0:t.p)&&void 0!==s?s:[],"",""),o=this.findTextInTextArray(i.text,a);o.length&&r.push({component:e,pageId:e.getPage().id,uniqueID:e.id,result:o})}else if(e instanceof d.a){var n,i,c,l;const t=[];null===(l=e.store.data.graphic)||void 0===l||null===(c=l.graphicData)||void 0===c||null===(i=c.tbl)||void 0===i||null===(n=i.tr)||void 0===n||n.forEach(((e,s)=>{var n;return null===(n=e.tc)||void 0===n?void 0:n.forEach(((e,n)=>{var r,i;const o=h.b.fromParagraphListData(null!==(i=null===(r=e.txBody)||void 0===r?void 0:r.p)&&void 0!==i?i:[],"","",n,s),d=this.findTextInTextArray(o.text,a,s,n);t.push(...d)}))})),r.push({component:e,uniqueID:e.id,result:t,pageId:e.getPage().id})}})),r}replaceSearchResultFromMutation(e,t){let a=!1;const{addSlides:s,removeSlides:n,moveSlides:r,shapesChange:i}=this.getSlideChangeMutation();return n.length&&(a||(a=this.removeSearchResultWithSlide(t,n))),i.length&&i.forEach((s=>{a||(a=this.replaceSearchResultWithShape(t,e,s))})),s&&s.forEach((s=>{a||(a=this.replaceSearchResultWithAddSlide(t,e,s))})),r&&r.forEach((s=>{a||(a=this.replaceSearchResultWithMoveSlide(t,e,s))})),a}init(){return this.events.on(g.e.CommitCommand,this.handleCommitTransaction),this}replaceSearchResultWithMoveSlide(e,t,a){const s=i()(a,"pageId"),n=s&&this.presentation.getSlideById(s);if(!n)return!1;const r=this.searchText(t,[n]);let o=!1;return r.forEach((t=>{for(;e.findIndex((({pageId:e})=>e===t.pageId))>-1;)e.splice(e.findIndex((({pageId:e})=>e===t.pageId)),1),o=!0})),e.splice(0,0,...r),o}replaceSearchResultWithAddSlide(e,t,a){const s=i()(a,"pageId"),n=s&&this.presentation.getSlideById(s);if(!n)return!1;const r=this.searchText(t,[n]);return e.splice(0,0,...r),!0}replaceSearchResultWithShape(e,t,a){const s=i()(a,"pageId"),n=s&&this.presentation.getSlideById(s);if(!n)return!1;const r=this.searchText(t,[n]);let o=!1;return r.forEach((t=>{for(;e.findIndex((({pageId:e})=>e===t.pageId))>-1;)e.splice(e.findIndex((({pageId:e})=>e===t.pageId)),1),o=!0})),e.splice(0,0,...r),o}getSlideChangeMutation(){const e=this.curUserChange.filter((e=>{const t=i()(e,"pageType");return(!t||t===f.Q.slide)&&!!i()(e,"pageId","")})),t=[],a=[],s=[],n=[];return e.forEach((e=>{e.type!==f.c.AddPage?e.type!==f.c.RemovePage?e.type!==f.c.MovePage?n.push(e):s.push(e):a.push(e):t.push(e)})),{addSlides:t,removeSlides:a,moveSlides:s,shapesChange:n}}findTextInTextArray(e,t,a,s){const n=e.split(p.a.kParagraphReturn),r=[];return n.forEach(((e,n)=>{let i=-1;const o=e.toLocaleLowerCase();for(;-1!==(i=o.indexOf(t,i));){const e={offset:i,paragraph:n};void 0!==a&&void 0!==s&&(e.cell={row:a,col:s}),r.push(e),i+=t.length}})),r}removeSearchResultWithSlide(e,t){const a=t.map((e=>e.pageId||""));let s=!1;return a.forEach((t=>{for(;e.findIndex((({pageId:e})=>e===t))>-1;)e.splice(e.findIndex((({pageId:e})=>e===t)),1),s=!0})),s}constructor(e,t){this.presentation=e,this.events=t,this.curUserChange=[],this.recurseAllComponents=e=>{const t=[];return e instanceof u.a?t.push(...n()(e.slideList.map(this.recurseAllComponents)),...n()([...e.noteSlideMap.values()].map(this.recurseAllComponents))):e instanceof o.a||e instanceof d.a?t.push(e):(e instanceof c.a||e instanceof l.a)&&t.push(...n()(e.shapeList.map(this.recurseAllComponents))),t},this.handleCommitTransaction=e=>{this.curUserChange=e.map((e=>e.toData()))},this.init()}}},"5241763da2":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("464fcc5941"),n=a("b902b7a6c0"),r=a("9f56a12fef"),i=a("ff9b6dacaf");class o extends i.a{constructor(e,t,a,i){super(t,a),this.parent=i,this.store=new n.a(e,t,this),this.props=new s.a(this.store.data,this.context),this.api=new r.a(this,t)}}},"59e51a6447":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("6f5f1758fe");class i extends r.a{apply(e){e.store.patchData({sldSz:this.data.size})}invert(e){return[{type:n.c.SetSlideSize,size:Object(s.a)({},e.getOwnedData().sldSz)}]}check(){}constructor(...e){super(...e),this.type=n.c.SetSlideSize}}},"5a0111def3":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("711a53c9fc"),n=a("6f5f1758fe"),r=a("7c46f42788"),i=a("64a9e88aee");class o extends n.a{apply(e){var t;if(!this.data.pageId)return;const{pageId:a,fromTriggerId:s,triggerId:n,fromSeqType:i,seqType:o,fromIndex:d,index:c}=this.data,l=e.store.models.get(a,...r.e);null==l||null===(t=l.store.timing)||void 0===t||t.store.moveAnimation(s,n,i,o,d,c)}invert(){return[{type:s.c.MoveAnimation,pageId:this.data.pageId,shapeId:this.data.shapeId,fromTriggerId:this.data.triggerId,triggerId:this.data.fromTriggerId,fromSeqType:this.data.seqType,seqType:this.data.fromSeqType,fromIndex:this.data.index,index:this.data.fromIndex}]}check(e){const{pageId:t,shapeId:a,fromTriggerId:s,triggerId:n,fromIndex:r,index:o,fromSeqType:d,seqType:c}=this.data,l=Object(i.b)(e,d,c,s,n,a,t,r,o);if(l)return l}constructor(...e){super(...e),this.type=s.c.MoveAnimation}}},"5a8749f72e":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("711a53c9fc"),i=a("026cc7da1f"),o=a("6f5f1758fe"),d=a("b41b5d48f6"),c=a("7c46f42788"),l=a("2ba82388a5");class u extends o.a{apply(e){const{shapeId:t,clearXfrm:a,xfrmDelta:n,chXfrmDelta:r}=this.data,o=e.store.models.get(t,...c.d);Object(i.assert)(o),o.store.patchData({spPr:{xfrm:a?null:Object(s.a)({},n,r)}})}invert(e){var t;const{pageId:a,shapeId:o,parentId:d,shapeType:u,clearXfrm:h,xfrmDelta:p,chXfrmDelta:f}=this.data,g=e.store.models.get(o,...c.d);Object(i.assert)(g);const m=null===(t=g.store.data.spPr)||void 0===t?void 0:t.xfrm,v={type:r.c.TransformShape,pageId:a,shapeId:o,parentId:d,shapeType:u};return h?[Object(n.a)(Object(s.a)({},v),{xfrmDelta:m})]:[Object(n.a)(Object(s.a)({},v),{clearXfrm:!m,xfrmDelta:m&&p?Object(l.b)(m,p):void 0,chXfrmDelta:m&&f?Object(l.b)(m,f):void 0})]}check(e){const{pageId:t,shapeId:a}=this.data;return d.a.shape.should.existInPage(e,a,t)}constructor(...e){super(...e),this.type=r.c.TransformShape}}},"5d6df242e3":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("b41b5d48f6"),i=a("6f5f1758fe"),o=a("7c46f42788");class d extends i.a{apply(e){var t;const{groupShapeId:a,shapeIds:s,pageId:r}=this.data;let{parentId:i,index:d}=this.data;const c=null===(t=e.store.models.get(r,...o.c))||void 0===t?void 0:t.store.getShapeTree();!i&&c&&(i=c.id,d=s.length?c.store.shapeList.findIndexById(s[0]):c.shapeList.length);const l=e.store.models.get(i,o.a.GroupShape);Object(n.assert)(l,"group shape should not exist"),l.store.groupShapesOfRange(a,d,s.length)}invert(){const{pageId:e,groupShapeId:t,shapeIds:a,parentId:n,index:r}=this.data;return[{type:s.c.Ungroup,pageId:e,groupShapeId:t,shapeIds:a,parentId:n,index:r}]}check(e){var t;const{pageId:a,shapeIds:s}=this.data;let{parentId:n,index:i}=this.data;const d=null===(t=e.store.models.get(a,...o.c))||void 0===t?void 0:t.store.getShapeTree();return!n&&d&&(n=d.id,i=s.length?d.store.shapeList.findIndexById(s[0]):d.shapeList.length),r.a.every(r.a.shape.should.existInPage(e,n,a),r.a.shape.should.matchShapeListInPosition(e,n,i,s))}constructor(...e){super(...e),this.type=s.c.Group}}},"61211f3c6b":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("7c46f42788"),o=a("64a9e88aee");class d extends r.a{apply(e){if(!this.data.pageId)return;const{pageId:t,triggerId:a,index:s,seqType:r}=this.data,o=e.store.models.get(t,...i.e);Object(n.assert)(null==o?void 0:o.store.timing,"page should have timing"),o.store.timing.store.addAnimation(a,r,s)}invert(){const{pageId:e,shapeId:t,triggerId:a,index:n,seqType:r}=this.data;return[{type:s.c.RemoveAnimation,pageId:e,shapeId:t,triggerId:a,seqType:r,index:n}]}check(e){const{pageId:t,shapeId:a,triggerId:s,index:n,seqType:r}=this.data,i=Object(o.a)(e,r,s,a,t,n);if(i)return i}constructor(...e){super(...e),this.type=s.c.AddAnimation}}},"618a7d794a":function(e,t,a){"use strict";a.d(t,"q",(function(){return n})),a.d(t,"r",(function(){return r})),a.d(t,"p",(function(){return i})),a.d(t,"v",(function(){return o})),a.d(t,"l",(function(){return d})),a.d(t,"s",(function(){return c})),a.d(t,"o",(function(){return l})),a.d(t,"t",(function(){return u})),a.d(t,"m",(function(){return h})),a.d(t,"n",(function(){return p})),a.d(t,"u",(function(){return f})),a.d(t,"G",(function(){return g})),a.d(t,"z",(function(){return m})),a.d(t,"A",(function(){return v})),a.d(t,"E",(function(){return b})),a.d(t,"F",(function(){return y})),a.d(t,"L",(function(){return I})),a.d(t,"M",(function(){return S})),a.d(t,"N",(function(){return T})),a.d(t,"J",(function(){return x})),a.d(t,"O",(function(){return C})),a.d(t,"I",(function(){return P})),a.d(t,"H",(function(){return O})),a.d(t,"D",(function(){return D})),a.d(t,"C",(function(){return j})),a.d(t,"B",(function(){return M})),a.d(t,"K",(function(){return L})),a.d(t,"c",(function(){return w})),a.d(t,"e",(function(){return E})),a.d(t,"b",(function(){return R})),a.d(t,"d",(function(){return A})),a.d(t,"f",(function(){return k})),a.d(t,"g",(function(){return F})),a.d(t,"k",(function(){return B})),a.d(t,"i",(function(){return N})),a.d(t,"j",(function(){return V})),a.d(t,"S",(function(){return U})),a.d(t,"U",(function(){return $})),a.d(t,"T",(function(){return G})),a.d(t,"R",(function(){return Q})),a.d(t,"Q",(function(){return q})),a.d(t,"P",(function(){return W})),a.d(t,"x",(function(){return z})),a.d(t,"w",(function(){return H})),a.d(t,"y",(function(){return K})),a.d(t,"a",(function(){return _})),a.d(t,"h",(function(){return X}));const s=(e,t)=>a=>new Error(`[${e}] ${t}: ${JSON.stringify(a)}`),n=s(1e3,"shape is not found"),r=s(1001,"shape is not in page"),i=s(1002,"shape is not a child of shape tree root"),o=s(1003,"shape type not match"),d=s(1004,"shape insert index out of range"),c=(s(1005,"shape note already exist"),s(1006,"shape is not in position")),l=s(1007,"shape is not a child of group shape"),u=s(1008,"shape placeholder not exist"),h=s(1009,"shape type invalid"),p=s(1011,"shape list length too short"),f=s(1012,"group shape can not insert to itself");var g;!function(e){e[e.TableAddRowOrColCountError=1020]="TableAddRowOrColCountError",e[e.TableAddRowOrColIndexOutOfRangeError=1021]="TableAddRowOrColIndexOutOfRangeError",e[e.TableDeleteRowOrColCountOutOfLengthError=1022]="TableDeleteRowOrColCountOutOfLengthError",e[e.TableDeleteRowOrColIndexOutOfRangeError=1023]="TableDeleteRowOrColIndexOutOfRangeError",e[e.TableRangeExistNullError=1024]="TableRangeExistNullError",e[e.TableRangeLessZeroError=1025]="TableRangeLessZeroError",e[e.TableRangeOutOfLengthError=1026]="TableRangeOutOfLengthError",e[e.TableMergeAlreadyMergedCellError=1027]="TableMergeAlreadyMergedCellError",e[e.TableUnMergeMultipleCellError=1028]="TableUnMergeMultipleCellError",e[e.TableInsertRowInMergedCellError=1029]="TableInsertRowInMergedCellError",e[e.TableInsertColInMergedCellError=1030]="TableInsertColInMergedCellError",e[e.TableDeleteRowInMergedCellError=1031]="TableDeleteRowInMergedCellError",e[e.TableDeleteColInMergedCellError=1031]="TableDeleteColInMergedCellError",e[e.TableDeleteAllColOrRowError=1032]="TableDeleteAllColOrRowError",e[e.TableMergeSingleCellError=1033]="TableMergeSingleCellError"}(g||(g={}));const m=s(1020,"table add row or col count error"),v=s(1021,"table add row or col index out of range"),b=s(1022,"table delete row or col out of length error"),y=s(1023,"table delete row or col index out of range"),I=s(1024,"table range exist null value"),S=s(1025,"table range less zero"),T=s(1026,"table range out of length"),x=s(1027,"table merge already merged cells"),C=s(1028,"table unMerge multiple cells"),P=s(1029,"table insert row in merged cell"),O=s(1030,"table insert col in merged cell"),D=s(1031,"table delete row in merged cell"),j=s(1031,"table delete col in merged cell"),M=s(1032,"table delete all col or row"),L=s(1033,"table merge single cell"),w=s(1100,"page is not found"),E=(s(1101,"layout is not belong to master"),s(1102,"page index out of range")),R=s(1103,"page insert index out of range"),A=s(1104,"page is not in position"),k=s(1105,"page shape tree not exist"),F=s(1106,"page stale reference"),B=(s(1200,"timing sequence is not found"),s(1201,"timing unit time node out of range"),s(1202,"timing unit time node insert index out of range"),s(1300,"section is not found")),N=s(1301,"section binding slide index out of range"),V=s(1302,"section insert index out of range"),U=s(1400,"theme has exist in presentation"),$=s(1401,"theme is used by master"),G=s(1403,"theme not exist in presentation"),Q=s(1404,"theme has wrong format"),q=s(1500,"text property type error"),W=s(1501,"text content field error"),z=(s(1901,"chart is not found"),s(1902,"sub chart index out of range")),H=s(1903,"sub chart is not found"),K=s(1904,"sub chart type not match"),_=s(2e3,"model already exist"),X=s(3e3,"resource map id is empty")},"64a9e88aee":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return l}));var s=a("b41b5d48f6"),n=a("7c46f42788");function r(e,t,a,s,r=!1){var i;const o=e.store.models.get(t,...n.e),d=null==o||null===(i=o.timing)||void 0===i?void 0:i.getSeqByTriggerId(a);if(r){if((null==d?void 0:d.unitTimeNodeList)&&d.unitTimeNodeList.length<s)return new Error(`[animation]: add/set index:${s} out of range, current unitTimeNodeList length: ${d.unitTimeNodeList.length}`)}else{if(!(null==d?void 0:d.unitTimeNodeList))return new Error(`[animation]: pageId:${t}, triggerId:${a} index:${s}, unitTimeNodeList not found`);if(d.unitTimeNodeList.length<=s)return new Error(`[animation]: move/remove index:${s} out of range, current unitTimeNodeList length: ${d.unitTimeNodeList.length}`)}}function i(e,t,a,n){return s.a.shape.should.existInPage(e,a,n)}function o(e,t,a,s,n,o){const d=i(e,0,s,n);return d||r(e,n,a,o,!0)}function d(e,t,a,s,n,o){const d=i(e,0,s,n);return d||r(e,n,a,o,!1)}function c(e,t,a,s,i,o){const d=function(e,t,a,s){var r;const i=e.store.models.get(t,...n.e),o=null==i||null===(r=i.timing)||void 0===r?void 0:r.getSeqByTriggerId(a);if((null==o?void 0:o.type)&&o.type!==s)return new Error(`[animation]: pageId:${t}, triggerId:${a}, memory seq type:${o.type} not match type:${s}`)}(e,i,a,t);return d||r(e,i,a,o,!1)}function l(e,t,a,s,n,r,i,d,l){const u=c(e,t,s,0,i,d);return u||o(e,0,n,r,i,l)}},"6821617d4e":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788"),d=a("daff531963"),c=a("b56763d092");class l extends r.a{apply(e){if(!this.data.shapeId||0===this.data.count)return;const{shapeId:t,index:a,count:s}=this.data,r=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(r,"shape should exist"),r&&r.store.deleteTableCol(a,s)}invert(e){const{pageId:t,shapeId:a,index:r,count:i}=this.data,d=e.store.models.get(a,o.a.GraphicalObjectFrameTable);Object(n.assert)(d,"shape should exist");const c=d.store.colList.map(((e,t)=>{var a;return{index:t,width:null!==(a=e.w)&&void 0!==a?a:0}}));return[{type:s.c.InsertTableCol,pageId:t,shapeId:a,index:r,count:i},{type:s.c.SetTableColWidths,pageId:t,shapeId:a,widths:c}]}check(e){const{pageId:t,shapeId:a,index:s,count:n}=this.data,r=e.store.models.get(a,o.a.GraphicalObjectFrameTable);var l;const u=Object(c.h)(null!==(l=null==r?void 0:r.store.tableData)&&void 0!==l?l:{});return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.table.can.deleteRowOrCol(e,a,s,n,d.a.COLUMN,u))}constructor(...e){super(...e),this.type=s.c.DeleteTableCol}}},"6ae44f9c25":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("7c46f42788"),i=a("215eaa3247");class o{static fromMutationData(e){return Object(s.a)({},e.shapeDelta)}static fromShapeData(e){return{spPr:this.getSpPrWithoutEgPath2D(e.spPr),nvPr:e.nvPr&&Object(n.a)(Object(s.a)({},Object(i.b)(e.nvPr,"txBox")),{shape:{txBox:e.nvPr.txBox}}),style:e.style,shape:{useBgFill:e.useBgFill}}}static getSpPrWithoutEgPath2D(e){const{custGeom:t}=e,{pathLst:a}=null!=t?t:{},{path:r}=null!=a?a:{};return Object(n.a)(Object(s.a)({},Object(i.b)(e,"xfrm")),{custGeom:t&&Object(n.a)(Object(s.a)({},t),{pathLst:a&&Object(n.a)(Object(s.a)({},a),{path:null==r?void 0:r.map((e=>Object(n.a)(Object(s.a)({},e),{egPath2D:e.pathString?void 0:e.egPath2D})))})})})}static fromGroupShapeData(e){return{spPr:Object(i.b)(e.spPr,"xfrm"),nvPr:e.nvPr}}static fromConnectorData(e){return{spPr:Object(i.b)(e.spPr,"xfrm"),nvPr:e.nvPr&&Object(n.a)(Object(s.a)({},Object(i.b)(e.nvPr,"stCxn","endCxn")),{connector:{stCxn:e.nvPr.stCxn,endCxn:e.nvPr.endCxn}}),style:e.style}}static fromPictureData(e){return{spPr:Object(i.b)(e.spPr,"xfrm"),nvPr:e.nvPr&&Object(n.a)(Object(s.a)({},Object(i.b)(e.nvPr,"preferRelativeResize")),{picture:{preferRelativeResize:e.nvPr.preferRelativeResize}}),style:e.style,picture:{blipFill:e.blipFill}}}static fromGraphicObjectFrameData(e){return{spPr:Object(i.b)(e.spPr,"xfrm"),nvPr:e.nvPr,graphicalObjectFrame:{bwMode:e.bwMode}}}static fromTableData(e){var t,a,s;return{spPr:Object(i.b)(e.spPr,"xfrm"),nvPr:e.nvPr,graphicalObjectFrame:{bwMode:e.bwMode},table:null===(s=e.graphic)||void 0===s||null===(a=s.graphicData)||void 0===a||null===(t=a.tbl)||void 0===t?void 0:t.tblPr}}static fromDrawingShapeData(e){switch(e.type){case r.a.Shape:return o.fromShapeData(e);case r.a.GroupShape:return o.fromGroupShapeData(e);case r.a.Connector:return o.fromConnectorData(e);case r.a.Picture:return o.fromPictureData(e);case r.a.GraphicalObjectFrameTable:return o.fromTableData(e);case r.a.GraphicalObjectFrameChart:case r.a.GraphicalObjectFrameSmartArt:return o.fromGraphicObjectFrameData(e);default:throw new Error(`unsupported shape data: ${e}`)}}static toShapeDataDelta(e){var t;return{spPr:e.spPr,nvPr:e.nvPr&&Object(s.a)({},Object(i.b)(e.nvPr,"shape"),e.nvPr.shape),style:e.style,useBgFill:null===(t=e.shape)||void 0===t?void 0:t.useBgFill}}static toGroupShapeDataDelta(e){return{spPr:e.spPr,nvPr:e.nvPr}}static toConnectorDataDelta(e){return{spPr:e.spPr,nvPr:e.nvPr&&Object(s.a)({},Object(i.b)(e.nvPr,"connector"),e.nvPr.connector),style:e.style}}static toPictureDataDelta(e){var t;return{spPr:e.spPr,nvPr:e.nvPr&&Object(s.a)({},Object(i.b)(e.nvPr,"picture"),e.nvPr.picture),style:e.style,blipFill:null===(t=e.picture)||void 0===t?void 0:t.blipFill}}static toTableDataDelta(e){var t;return{spPr:e.spPr,nvPr:e.nvPr,graphic:{graphicData:{tbl:{tblPr:e.table}}},bwMode:null===(t=e.graphicalObjectFrame)||void 0===t?void 0:t.bwMode}}static toGraphicObjectFrameDataDelta(e){var t,a;return{spPr:e.spPr,nvPr:e.nvPr,graphic:null===(t=e.graphicalObjectFrame)||void 0===t?void 0:t.graphic,bwMode:null===(a=e.graphicalObjectFrame)||void 0===a?void 0:a.bwMode}}static toDrawingShapeDataDelta(e,t){switch(e){case r.a.Shape:return o.toShapeDataDelta(t);case r.a.GroupShape:return o.toGroupShapeDataDelta(t);case r.a.Connector:return o.toConnectorDataDelta(t);case r.a.Picture:return o.toPictureDataDelta(t);case r.a.GraphicalObjectFrameTable:return o.toTableDataDelta(t);case r.a.GraphicalObjectFrameChart:case r.a.GraphicalObjectFrameSmartArt:case r.a.GraphicalObjectFrameUnknown:return o.toGraphicObjectFrameDataDelta(t);default:throw new Error(`unsupported shape type: ${e}`)}}}},"6ef42ff901":function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var s=a("d7c625d1f2"),n=a("711a53c9fc"),r=a("fdddc95d9b"),i=a("420d598ff9"),o=a("cf3340a08c"),d=a("ed0457c1f8"),c=a("025e3e9b74"),l=a("22cd640443"),u=a("a5bb88f217");class h{registerPresentation(e){return this.presentation=e,this}enqueue(e,t){for(const t of e)this.mutations.push(t);const a=this.segments[this.segments.length-1];return a&&a.source===t?a.endIndex+=e.length:this.segments.push({source:t,startIndex:this.mutations.length-e.length,endIndex:this.mutations.length}),this}onCommit(e){return this.events.on(c.e.CommitTransaction,e)}getInvertedMutation(e){var t;return null!==(t=this.invertedMutations.get(e))&&void 0!==t?t:[]}init(){return this.events.on(c.e.EnqueueMutations,((e,t)=>!this.fatalError&&this.enqueue(e,t))),this.events.on(c.e.EndTransaction,(()=>!this.fatalError&&this.apply())),this.events.on(c.e.CommitTransaction,(()=>!this.fatalError&&this.commit())),this}emitError(e,t,a,s,r){var i,o,d,u,h,p,f,g,m,v,b;e.message=`${a}@${t}-${r} ${n.c[s]}: ${e.message}`,null===(o=this.logger)||void 0===o||null===(i=o.error)||void 0===i||i.call(o,"[MM]",e.message),this.fatalError=e,this.reset();const y=null!==(b=null===(h=this.logger)||void 0===h||null===(u=h.getPrototype)||void 0===u||null===(d=u.call(h).report("CHANGESET_REPORT",{query:{startTs:Date.now()-864e5,endTs:Date.now()}}))||void 0===d?void 0:d.value)&&void 0!==b?b:"";var I;null===(v=this.logger)||void 0===v||null===(m=v.monitor)||void 0===m||null===(g=m.reportStatus)||void 0===g||g.call(m,`sdk_client_${t}_changeset`,l.a.ERROR,e.toString(),[t,a,String(r),n.c[s],y,null!==(I=null===(f=this.getDocInfoProvider)||void 0===f||null===(p=f.call(this))||void 0===p?void 0:p.globalPadId)&&void 0!==I?I:""]),this.events.emit(c.e.MutationError,e,t,a,s,r)}reset(){this.segments=[],this.mutations=[],this.invertedMutations=new WeakMap,this.applied=0}canCommitCommand(e){return[r.a.Editor,r.a.Collaborator,r.a.CollaboratorConflict].includes(e)}canSubmitCommand(e){return[r.a.Editor,r.a.UndoRedo].includes(e)}canInvertCommand(e){return[r.a.UndoRedo].includes(e)}invert(e){return e.invertible?Object(i.a)(e.invert(this.presentation)):[]}constructor(e,t,a){this.events=e,this.logger=t,this.getDocInfoProvider=a,this.isSubmitSuspended=!1,this.mutations=[],this.invertedMutations=new WeakMap,this.segments=[],this.applied=0,this.submitSuspendedMutations=[],this.apply=e=>{if(this.presentation||(this.fatalError=new Error("Presentation is not registered")),this.fatalError)throw new Error(`unable to apply new mutations after fatal error: ${this.fatalError.message}`);const t=[];this.presentation.populate();return((null==e?void 0:e.transaction)?this.transaction:e=>e())((()=>{for(const{source:a,endIndex:s}of this.segments)if(!(this.applied>=s))for(this.events.emit(c.e.MutationSource,a);this.applied<s;){const s=this.mutations[this.applied],n=s.check(this.presentation,a);if(n)throw this.emitError(n,"check",a,s.type,this.applied),n;if(this.canCommitCommand(a)||this.canInvertCommand(a)||(null==e?void 0:e.inversion)){const e=this.invert(s);this.invertedMutations.set(s,e),t.push(e)}try{s.apply(this.presentation)}catch(e){throw this.emitError(e,"apply",a,s.type,this.applied),e}this.applied+=1}})),t.reverse().flat()},this.commit=()=>{for(const{source:e,startIndex:t,endIndex:a}of this.segments){const s=this.mutations.slice(t,a);this.canCommitCommand(e)&&(this.events.emit(c.e.CommitCommand,s,s.map((e=>{var t;return null!==(t=this.invertedMutations.get(e))&&void 0!==t?t:[]})),e),e===r.a.Editor&&this.events.emit(c.e.Edit)),this.canSubmitCommand(e)&&(this.isSubmitSuspended?this.submitSuspendedMutations.push([s,e]):this.events.emit(c.e.SubmitMutations,{mutations:s,source:e})),this.events.emit(c.e.MutationsApplied,e)}return this.reset(),this},this.suspendSubmit=()=>(this.isSubmitSuspended=!0,this),this.resumeSubmit=()=>{this.isSubmitSuspended=!1;for(const[e,t]of this.submitSuspendedMutations)this.events.emit(c.e.SubmitMutations,{mutations:e,source:t});return this.submitSuspendedMutations=[],this},this.transaction=Object(u.a)(this.events),this.init()}}Object(s.__decorate)([Object(o.a)(d.a.EnqueueMutations)],h.prototype,"enqueue",null)},"6f50907d63":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788"),d=a("36e02f5174"),c=a("285f8ccc4f");class l extends r.a{apply(e){const{models:t}=e.store,{shapeId:a,parentId:s}=this.data,r=t.get(s,o.a.GroupShape);Object(n.assert)(r,"parent should exist"),r.store.shapeList.removeById(a)}invert(e){const{pageId:t,shapeId:a,parentId:s,index:r}=this.data,i=e.store.models.get(t,...o.e);Object(n.assert)(i,"page should exist");const l=e.store.models.get(a,...o.d);Object(n.assert)(l,"shape should exist");const u={presentation:e.store.data,page:i.store.data,idFactory:e=>e};return[].push(),Object(d.b)(Object(c.a)(l.store.data),u,s,r)}check(e){const{pageId:t,shapeId:a,parentId:s,index:n}=this.data;return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.shape.is.notTypeOf(e,a,o.a.GroupShape),i.a.shape.should.matchShapeListInPosition(e,s,n,[a]))}constructor(...e){super(...e),this.type=s.c.RemoveShape}}},"6f5f1758fe":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("285f8ccc4f");class n{toData(){return Object.assign(Object(s.a)(this.data),{type:this.type})}clone(e=this.toData()){return new this.constructor(e)}constructor(e){this.data=e,this.invertible=!0}}},"7064f45d39":function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("7c46f42788"),o=a("b41b5d48f6"),d=a("727c0c7dd8");const c={areaChart:s.bc.AreaChart,area3DChart:s.bc.Area3DChart,lineChart:s.bc.LineChart,line3DChart:s.bc.Line3DChart,stockChart:s.bc.StockChart,radarChart:s.bc.RadarChart,scatterChart:s.bc.ScatterChart,pieChart:s.bc.PieChart,pie3DChart:s.bc.Pie3DChart,doughnutChart:s.bc.DoughnutChart,barChart:s.bc.BarChart,bar3DChart:s.bc.Bar3DChart,ofPieChart:s.bc.OfPieChart,surfaceChart:s.bc.SurfaceChart,surface3DChart:s.bc.Surface3DChart,bubbleChart:s.bc.BubbleChart};class l extends r.a{apply(e){const{shapeId:t,index:a}=this.data,s=e.store.models.get(t,i.a.GraphicalObjectFrameChart);Object(n.assert)(s,"chart should exist"),s.store.setSubChart(this.normalizeSubChartData(),a)}check(e){const{pageId:t,shapeId:a,index:s,plot:r}=this.data,d=e.store.models.get(a,i.a.GraphicalObjectFrameChart);Object(n.assert)(d,"chart should exist");const c=this.getSubChartInEgPlot(r);return o.a.every(o.a.shape.should.existInPage(e,this.data.shapeId,this.data.pageId),o.a.chart.should.subChartExist(e,t,a,s),o.a.chart.is.matchedSubChartType(e,t,a,s,null==c?void 0:c.type))}invert(e){const{pageId:t,shapeId:a,index:r}=this.data,o=e.store.models.get(a,i.a.GraphicalObjectFrameChart);Object(n.assert)(o,"chart should exist");const c=o.store.subChartList[r];return Object(n.assert)(c,"subChart should exist"),[{type:s.c.SetSubChartProperties,pageId:t,shapeId:a,index:r,plot:(new d.a).createEgPlotBySubChart(o.store.subChartList[r]),axesPr:{axes:c.axes,index:c.axesAddIndex}}]}normalizeSubChartData(){const{plot:e,axesPr:t}=this.data,{type:a,props:s}=this.getSubChartInEgPlot(e)||{};Object(n.assert)(s);const{axes:r,index:i}=t||{};return(new d.a).toSdkSubChart(a,s,i,r)}getSubChartInEgPlot(e){let t;return Object.keys(e).some((a=>{const s=c[a];return!!s&&(t={props:e[a],type:s},!0)})),t}constructor(...e){super(...e),this.type=s.c.SetSubChartProperties}}},7105657202:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("065498d94a"),n=a("57c4666aff"),r=a("e7714aad84"),i=a("16d54e1923");class o extends i.a{constructor(e,t,a){super(t),this.parent=a,this.context={getPresentation:()=>this.parent,getTarget:()=>this},this.store=new n.a(e,t,this),this.props=new s.a(this.store.data),this.api=new r.a(this,t)}}},"727c0c7dd8":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("026cc7da1f"),i=a("711a53c9fc"),o=a("a7888a8b87"),d=a.n(o),c=a("d695fbd618"),l=a.n(c),u=a("215eaa3247"),h=a("e302115f02"),p=a("7064f45d39");class f{toSdkSubChart(e,t,a,i){return Object(r.assert)(t),Object(n.a)(Object(s.a)({},t),{type:e,axesAddIndex:a,axes:i,ser:this.normalizeSeries(e,t.ser)})}toMutationPlotChart(e){var t;const a=d()(e);return Object(n.a)(Object(s.a)({},Object(u.b)(a,"type","axes")),{ser:null===(t=a.ser)||void 0===t?void 0:t.map((e=>{const t=[],r=[],i=[],o=[];let d,c,l,p;if(e.categories.forEach(((e,a)=>{void 0!==e.categoryPoint&&t.push(Object(s.a)({idx:a},e.categoryPoint)),void 0!==e.valuePoint&&r.push(Object(s.a)({idx:a},e.valuePoint)),void 0!==e.dataPoint&&i.push(Object(n.a)(Object(s.a)({},e.dataPoint),{idx:{val:a}})),void 0!==e.dataLabel&&o.push(Object(s.a)({idx:{val:a}},e.dataLabel))})),void 0!==e.otherDPt&&i.push(Object(n.a)(Object(s.a)({},e.otherDPt),{idx:{val:e.categories.length}})),void 0!==e.otherDLbl&&o.push(Object(n.a)(Object(s.a)({},e.otherDLbl),{idx:{val:e.categories.length}})),t.length>0){var f,g;const a={val:e.categories.length},s=t,n=null===(f=e.categoryAxisData)||void 0===f?void 0:f.formatCode;switch(null===(g=e.categoryAxisData)||void 0===g?void 0:g.type){case h.a.stringLiteral:d={strLit:{ptCount:a,pt:s}};break;case h.a.numberRef:d={numRef:{numCache:{ptCount:a,pt:s,formatCode:n}}};break;case h.a.numberLiteral:d={numLit:{ptCount:a,pt:s,formatCode:n}};break;default:d={strRef:{strCache:{ptCount:a,pt:s}}}}}if(r.length>0){var m,v,b;const t={val:null!==(b=e.valueCount)&&void 0!==b?b:r.length},a=r,s=null===(m=e.values)||void 0===m?void 0:m.formatCode;if((null===(v=e.values)||void 0===v?void 0:v.type)===h.a.numberLiteral)c={numLit:{ptCount:t,pt:a,formatCode:s}};else c={numRef:{numCache:{ptCount:t,pt:a,formatCode:s}}}}else if(e.disable){var y;(null===(y=e.values)||void 0===y?void 0:y.type)===h.a.numberRef&&(c={numRef:{}})}i.length>0&&(l=i),e.dLbls&&(p=Object(n.a)(Object(s.a)({},e.dLbls),{dLbl:o.length>0?o:void 0}));const I=this.isMultiValAxis(a.type);return Object(n.a)(Object(s.a)({},Object(u.b)(e,"categories","disable","valueCount","categoryAxisData","values","otherDPt","otherDLbl"),I?{xVal:d}:{cat:d},I?{yVal:c}:{val:c}),{dPt:l,dLbls:p})}))})}createEgPlotBySubChart(e){const{type:t}=e,a=Object.keys(p.b).find((e=>p.b[e]===t));return a?{[a]:this.toMutationPlotChart(e)}:{}}normalizeSeries(e,t){return null==t?void 0:t.map((t=>{const a=this.mergeMultipleDataListToCategories(t,e),r=this.getSerCat(t,e),i=this.getSerVal(t,e);return Object(n.a)(Object(s.a)({},Object(u.b)(t,"cat","val","dPt","xVal","yVal")),{categories:a,disable:this.getSerDisabledStatus(t,e),valueCount:this.getSerValueCount(t,e),dLbls:t.dLbls?Object(u.b)(t.dLbls,"dLbl"):t.dLbls,categoryAxisData:r?this.getDataResourceDefaultSetting(r):void 0,values:i?this.getDataResourceDefaultSetting(i):void 0,otherDPt:this.getOtherDPt(t,a),otherDLbl:this.getOtherDLbl(t,a)})}))}getSerVal(e,t){return this.isMultiValAxis(t)?e.yVal:e.val}getSerCat(e,t){return this.isMultiValAxis(t)?e.xVal:e.cat}getSerDPt(e){return e.dPt}getSerDLbls(e){return e.dLbls}getSerDisabledStatus(e,t){const a=this.getSerVal(e,t),s=this.getValuesFromNumberDataSource(a);return!(!a||s)}getSerValueCount(e,t){const a=this.getValuesFromNumberDataSource(this.getSerVal(e,t));return this.getCountWithValuesData(a)}isMultiValAxis(e){return e===i.bc.ScatterChart||e===i.bc.BubbleChart}mergeMultipleDataListToCategories(e,t){const a=this.getSerVal(e,t),s=this.getSerCat(e,t),n=this.getSerDPt(e),r=this.getSerDLbls(e),{count:i,catData:o,valData:d}=this.getCategoryCount(s,a),c=[];for(let e=0;e<i;e++){var l;const t=null==r||null===(l=r.dLbl)||void 0===l?void 0:l.find((t=>{var a;return(null===(a=t.idx)||void 0===a?void 0:a.val)===e})),a=null==n?void 0:n.find((t=>{var a;return(null===(a=t.idx)||void 0===a?void 0:a.val)===e}));c.push({idx:e,categoryPoint:this.getValuePoint(o,e),valuePoint:this.getValuePoint(d,e),dataLabel:t?Object(u.b)(t,"idx"):t,dataPoint:a?Object(u.b)(a,"idx"):a})}return c}getValuePoint(e,t){var a;const s=null==e||null===(a=e.pt)||void 0===a?void 0:a.find((e=>e.idx===t));return s?Object(u.b)(s,"idx"):s}getCategoryCount(e,t){const a=this.getValuesFromAxisDataSource(e),s=this.getValuesFromNumberDataSource(t);return{count:Math.max(this.getCountWithValuesData(a),this.getCountWithValuesData(s)),catData:a,valData:s}}getCountWithValuesData(e){if(!e)return 0;const{ptCount:t,pt:a}=e,s=(null==a?void 0:a.map((e=>e.idx||0)))||[];var n;const r=null!==(n=l()(s))&&void 0!==n?n:-1/0;return Math.max((null==t?void 0:t.val)||0,r)}getValuesFromAxisDataSource(e){var t,a;if(e)return(null===(t=e.numRef)||void 0===t?void 0:t.numCache)||(null===(a=e.strRef)||void 0===a?void 0:a.strCache)||e.numLit||e.strLit}getValuesFromNumberDataSource(e){var t;if(e)return(null===(t=e.numRef)||void 0===t?void 0:t.numCache)||e.numLit}getDataResourceDefaultSetting(e){var t;return e.numRef?{type:h.a.numberRef,formatCode:null===(t=e.numRef.numCache)||void 0===t?void 0:t.formatCode}:e.numLit?{type:h.a.numberLiteral,formatCode:e.numLit.formatCode}:e.strRef?{type:h.a.stringRef}:e.strLit?{type:h.a.stringLiteral}:{type:h.a.stringRef}}getOtherDPt(e,t){var a;const s=t.length,n=null===(a=this.getSerDPt(e))||void 0===a?void 0:a.find((e=>{var t;return(null===(t=e.idx)||void 0===t?void 0:t.val)===s}));return n?Object(u.b)(n,"idx"):n}getOtherDLbl(e,t){var a,s;const n=t.length,r=null===(s=this.getSerDLbls(e))||void 0===s||null===(a=s.dLbl)||void 0===a?void 0:a.find((e=>{var t;return(null===(t=e.idx)||void 0===t?void 0:t.val)===n}));return r?Object(u.b)(r,"idx"):r}}},"76f2cf9a19":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("711a53c9fc"),n=a("6f5f1758fe"),r=a("7c46f42788"),i=a("64a9e88aee");class o extends n.a{apply(e){var t;if(!this.data.pageId)return;const{pageId:a,triggerId:s,index:n}=this.data,i=e.store.models.get(a,...r.e);null==i||null===(t=i.store.timing)||void 0===t||t.store.removeAnimation(s,n)}invert(){const{pageId:e,shapeId:t,triggerId:a,index:n,seqType:r}=this.data;return[{type:s.c.AddAnimation,pageId:e,shapeId:t,triggerId:a,seqType:r,index:n}]}check(e){const{pageId:t,shapeId:a,triggerId:s,index:n,seqType:r}=this.data,o=Object(i.c)(e,r,s,a,t,n);if(o)return o}constructor(...e){super(...e),this.type=s.c.RemoveAnimation}}},"777acf2e7d":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("026cc7da1f"),i=a("6f5f1758fe"),o=a("b41b5d48f6"),d=a("2ba82388a5");class c extends i.a{apply(e){const{themeId:t,themeName:a,themeElements:s}=this.data;e.store.setThemeById(t,a,s)}invert(e){const{themeId:t,themeName:a,themeElements:i}=this.data,o=e.store.getThemeById(t);Object(r.assert)(o,"theme should exist");return[Object(s.a)({type:n.c.SetTheme,themeId:t},Object(d.b)({themeName:(null==o?void 0:o.store.data.name)||"",themeElements:(null==o?void 0:o.store.data.themeElements)||{}},{themeName:a,themeElements:i},{themeElements:!0}))]}check(e){const{themeId:t}=this.data;return o.a.theme.should.existInPresentation(e,t)}constructor(...e){super(...e),this.type=n.c.SetTheme}}},"78db0f5ada":function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var s=a("a7888a8b87"),n=a.n(s),r=a("8f58e78419"),i=a.n(r),o=a("c73625d763"),d=a.n(o),c=a("ee6bb53310"),l=a.n(c),u=a("a9e0ee82c1"),h=a.n(u),p=a("67d3be6cf9"),f=a.n(p),g=a("711a53c9fc"),m=a("9559b6ab8e"),v=a("262843d1f7"),b=a("0404eeaf3a"),y=a("daa7f31376");class I{static getShapeId(e){var t,a,s,n;let r;var o,c,l,u;if(e.audio&&(r=null===(u=e.audio)||void 0===u||null===(l=u.cMediaNode)||void 0===l||null===(c=l.tgtEl)||void 0===c||null===(o=c.spTgt)||void 0===o?void 0:o.spid,r))return r;return null===(n=e.par)||void 0===n||null===(s=n.cTn)||void 0===s||null===(a=s.childTnLst)||void 0===a||null===(t=a.egTimeNodeChoice)||void 0===t||t.find((e=>{const t=Object.keys(m.f).find((t=>d()(e,t))),a=i()(e,`${t}.${m.B}`);return!!a&&(r=a,!0)})),r}static getId(e){var t,a,s,n,r,i,o,d,c,l;return null!==(l=null!==(c=null===(a=e.par)||void 0===a||null===(t=a.cTn)||void 0===t?void 0:t.id)&&void 0!==c?c:null===(r=e.audio)||void 0===r||null===(n=r.cMediaNode)||void 0===n||null===(s=n.cTn)||void 0===s?void 0:s.id)&&void 0!==l?l:null===(d=e.video)||void 0===d||null===(o=d.cMediaNode)||void 0===o||null===(i=o.cTn)||void 0===i?void 0:i.id}getData(){return this.data}setData(e){this.data=e}get id(){return I.getId(this.data)}get shapeId(){return I.getShapeId(this.data)}get animType(){var e,t;const{presetId:a,presetClass:s}=(null===(t=this.data)||void 0===t||null===(e=t.par)||void 0===e?void 0:e.cTn)||{};if(!a||!s)return m.b.None;const n={[g.Ab.entr]:m.o,[g.Ab.exit]:m.p,[g.Ab.emph]:m.n,[g.Ab.path]:m.w,[g.Ab.verb]:m.w,[g.Ab.mediacall]:m.w,[g.Ab.PBDEFAULT]:m.w}[s];return i()(n,a)?i()(n,a):s===g.Ab.path?m.b.Custom:m.b.None}get presetClass(){var e,t;return null===(t=this.data.par)||void 0===t||null===(e=t.cTn)||void 0===e?void 0:e.presetClass}get presetId(){var e,t;return null===(t=this.data.par)||void 0===t||null===(e=t.cTn)||void 0===e?void 0:e.presetId}get presetSubtype(){var e,t;return null===(t=this.data.par)||void 0===t||null===(e=t.cTn)||void 0===e?void 0:e.presetSubtype}get opacity(){var e,t,a,s;if(!(null===(t=this.data)||void 0===t||null===(e=t.par)||void 0===e?void 0:e.cTn))return;const{presetId:n,presetClass:r}=this.data.par.cTn;null===(s=this.data.par.cTn.childTnLst)||void 0===s||null===(a=s.egTimeNodeChoice)||void 0===a||a.forEach((e=>{const t=this.getBehaviorKeyFromTnBase(e);if(n===m.z.EmphTransparency&&r===g.Ab.emph&&t===m.f.set)return i()(e,`${t}.to.strVal.val`)}))}get delay(){return i()(this.data,"par.cTn.stCondLst.cond[0].delay","0")}get nodeType(){var e,t;return(null===(t=this.data.par)||void 0===t||null===(e=t.cTn)||void 0===e?void 0:e.nodeType)||g.Db.PBDEFAULT}get by(){var e,t,a;let s;return((null===(a=this.data.par)||void 0===a||null===(t=a.cTn)||void 0===t||null===(e=t.childTnLst)||void 0===e?void 0:e.egTimeNodeChoice)||[]).find((e=>{const t=this.getBehaviorKeyFromTnBase(e);var a;return(t===m.f.animRot||t===m.f.animScale||t===m.f.anim)&&(s=null===(a=e[t])||void 0===a?void 0:a.by,!!s)})),s}get dur(){var e,t,a;const s=(null===(a=this.data.par)||void 0===a||null===(t=a.cTn)||void 0===t||null===(e=t.childTnLst)||void 0===e?void 0:e.egTimeNodeChoice)||[];let n=1;var r,o,d,c,l;(s.forEach((e=>{const t=[m.f.animEffect,m.f.animScale,m.f.animRot,m.f.anim,m.f.animMotion,m.f.cmd,m.f.animClr],a=this.getBehaviorKeyFromTnBase(e);if(t.includes(a)){var s,r,o;let t=i()(e,`${a}.${m.m}`,0);const d=i()(e,`${a}.${m.k}`,0);"indefinite"===t&&(t=500),t=(null===(o=e[a])||void 0===o||null===(r=o.cBhvr)||void 0===r||null===(s=r.cTn)||void 0===s?void 0:s.autoRev)?2*Number(t):Number(t);const c=+t+ +d;n<c&&(n=c)}})),this.presetId===m.z.BrushColor&&this.presetClass===g.Ab.emph)&&(n=Number(null!==(l=null===(c=s[0])||void 0===c||null===(d=c.set)||void 0===d||null===(o=d.cBhvr)||void 0===o||null===(r=o.cTn)||void 0===r?void 0:r.dur)&&void 0!==l?l:1));return Math.round(n)}get behaviorList(){var e,t,a;return null===(a=this.data.par)||void 0===a||null===(t=a.cTn)||void 0===t||null===(e=t.childTnLst)||void 0===e?void 0:e.egTimeNodeChoice}get color(){const e=this.behaviorList;if(!e)return;let t;for(const n of e){var a,s;const[e]=Object.keys(n);if(e===m.f.animClr){const t=n[e],a=null==t?void 0:t.to;if(!a)return;return this.getColorFromToObject(a)}!t&&e===m.f.set&&(null===(s=n.set)||void 0===s||null===(a=s.to)||void 0===a?void 0:a.clrVal)&&(t=n.set.to.clrVal)}return t?this.getColorFromToObject(t):void 0}get isScale(){return[m.b.EnterScale,m.b.ExitScale].includes(this.animType)}setShapeId(e){var t,a,s,n;null===(n=this.data.par)||void 0===n||null===(s=n.cTn)||void 0===s||null===(a=s.childTnLst)||void 0===a||null===(t=a.egTimeNodeChoice)||void 0===t||t.forEach((t=>{const a=Object.keys(m.f).find((e=>d()(t,e)));a&&l()(t,`${a}.${m.B}`,e)}))}setDur(e){var t,a,s;if(m.g.includes(this.animType))return void this.setColorAnimDur(e);const n=(null===(s=this.data.par)||void 0===s||null===(a=s.cTn)||void 0===a||null===(t=a.childTnLst)||void 0===t?void 0:t.egTimeNodeChoice)||[],r={[m.b.EntrRiseUp]:()=>this.riseAndSinkDurHandler(m.b.EntrRiseUp,n,e),[m.b.ExitSinkDown]:()=>this.riseAndSinkDurHandler(m.b.ExitSinkDown,n,e),[m.b.EntrBoomerang]:()=>this.entryBoomerangDurHandler(n,e),[m.b.ExitBoomerang]:()=>this.exitBoomerangDurHandler(n,e),[m.b.EntrCenterRevolve]:()=>this.centerRevolveHandler(m.b.EntrCenterRevolve,n,e),[m.b.ExitCenterRevolve]:()=>this.centerRevolveHandler(m.b.ExitCenterRevolve,n,e),[m.b.EntrFloat]:()=>this.bounceAndFloatHandler(m.b.EntrFloat,n,e),[m.b.ExitFloat]:()=>this.bounceAndFloatHandler(m.b.ExitFloat,n,e),[m.b.EntrBounce]:()=>this.bounceAndFloatHandler(m.b.EntrBounce,n,e),[m.b.ExitBounce]:()=>this.bounceAndFloatHandler(m.b.ExitBounce,n,e)},o=i()(r,this.animType);o?o():n.forEach((t=>{const a=this.getBehaviorKeyFromTnBase(t);this.isAnimDur(a)&&l()(t,`${a}.${m.m}`,String(e)),this.isVisibilityDur(this.animType,a,e)&&l()(t,`${a}.${m.k}`,String(e-1))}))}setPresetSubType(e){var t,a,s;if(!(null===(s=this.data.par)||void 0===s||null===(a=s.cTn)||void 0===a||null===(t=a.childTnLst)||void 0===t?void 0:t.egTimeNodeChoice))return;if(this.data.par.cTn.presetSubtype=e,this.presetId===m.z.Cut||this.presetId===m.z.Fly)return void this.setTavLstWithSubType(e);const n=this.data.par.cTn.childTnLst,r=this.data.par.cTn.childTnLst.egTimeNodeChoice;if(this.presetId!==m.z.EntrStretch||this.presetClass!==g.Ab.entr)this.animType!==m.b.EntrBlinds&&this.animType!==m.b.ExitBlinds&&this.animType!==m.b.ExitCollapse&&this.animType!==m.b.EntrBasicSwivel&&this.animType!==m.b.ExitBasicSwivel&&this.animType!==m.b.EntrBasicZoom&&this.animType!==m.b.ExitBasicZoom&&this.animType!==m.b.EnterScale&&this.animType!==m.b.ExitScale||{[m.b.EntrBlinds]:()=>this.handleBlinds(r,e),[m.b.ExitBlinds]:()=>this.handleBlinds(r,e),[m.b.ExitCollapse]:()=>this.handleStretch(r,e),[m.b.EntrBasicSwivel]:()=>this.handleEntrSwivel(r,e),[m.b.ExitBasicSwivel]:()=>this.handleExitSwivel(r,e),[m.b.EntrBasicZoom]:()=>this.handleEntrZoom(r,e),[m.b.ExitBasicZoom]:()=>this.handleExitZoom(r,e),[m.b.EnterScale]:()=>this.handleEntrScale(r,e),[m.b.ExitScale]:()=>this.handleExitScale(r,e)}[this.animType]();else{if(e===m.A.Across){if(r.length<=3)return;return void(n.egTimeNodeChoice=this.handleAcrossAnimTag(r))}n.egTimeNodeChoice=this.handleNotAcrossAnimTag(r,e)}}setDelay(e){var t,a,s,n;null===(n=this.data.par)||void 0===n||null===(s=n.cTn)||void 0===s||null===(a=s.stCondLst)||void 0===a||null===(t=a.cond)||void 0===t||t.forEach((t=>t.delay=e))}setOpacity(e){var t,a,s,n;if(!(null===(a=this.data)||void 0===a||null===(t=a.par)||void 0===t?void 0:t.cTn))return;const{presetId:r,presetClass:i}=this.data.par.cTn;null===(n=this.data.par.cTn.childTnLst)||void 0===n||null===(s=n.egTimeNodeChoice)||void 0===s||s.forEach((t=>{const a=this.getBehaviorKeyFromTnBase(t);r===m.z.EmphTransparency&&i===g.Ab.emph&&a===m.f.set&&l()(t,`${a}.to.strVal.val`,e)}))}setColor(e){var t,a,s,n;const r=null===(n=this.data)||void 0===n||null===(s=n.par)||void 0===s||null===(a=s.cTn)||void 0===a||null===(t=a.childTnLst)||void 0===t?void 0:t.egTimeNodeChoice;if(!r)return;const i={animClr:(e,t)=>this.handleAnimClr(e,t),set:(e,t)=>this.handleSetBehaviorClr(e,t)};for(const t of r)Object.entries(t).forEach((([t,a])=>{var s;null===(s=i[t])||void 0===s||s.call(i,a,e)}))}setBy(e){var t,a,s,n;null===(n=this.data.par)||void 0===n||null===(s=n.cTn)||void 0===s||null===(a=s.childTnLst)||void 0===a||null===(t=a.egTimeNodeChoice)||void 0===t||t.forEach((t=>{const a=this.getBehaviorKeyFromTnBase(t);("number"==typeof e&&a===m.f.animRot||"string"==typeof e&&a===m.f.anim||"object"==typeof e&&a===m.f.animScale)&&l()(t,`${a}.by`,e)}))}setNodeType(e){l()(this.data,"par.cTn.nodeType",e)}setId(e){var t,a,s,n,r,i,o,d;if(null===(a=this.data)||void 0===a||null===(t=a.par)||void 0===t?void 0:t.cTn)Object.defineProperty(this.data.par.cTn,"id",{value:e});else if(null===(r=this.data)||void 0===r||null===(n=r.audio)||void 0===n||null===(s=n.cMediaNode)||void 0===s?void 0:s.cTn){var c,l;Object.defineProperty(null===(l=this.data.audio)||void 0===l||null===(c=l.cMediaNode)||void 0===c?void 0:c.cTn,"id",{value:e})}else if(null===(d=this.data)||void 0===d||null===(o=d.video)||void 0===o||null===(i=o.cMediaNode)||void 0===i?void 0:i.cTn){var u,h;Object.defineProperty(null===(h=this.data.video)||void 0===h||null===(u=h.cMediaNode)||void 0===u?void 0:u.cTn,"id",{value:e})}}setAudioRepeatCount(e){var t,a,s;(null===(s=this.data)||void 0===s||null===(a=s.audio)||void 0===a||null===(t=a.cMediaNode)||void 0===t?void 0:t.cTn)&&(e?this.data.audio.cMediaNode.cTn.repeatCount=e:delete this.data.audio.cMediaNode.cTn.repeatCount)}setAudioNumSld(e){var t,a;(null===(a=this.data)||void 0===a||null===(t=a.audio)||void 0===t?void 0:t.cMediaNode)&&(f()(e)?delete this.data.audio.cMediaNode.numSld:this.data.audio.cMediaNode.numSld=e)}updateTimeNodeByAnimType(e){const{animType:t,shapeId:a,duration:s,mediaType:r}=e,o=i()(m.a,t);if(!o||!d()(b,o))return{};if(this.data=n()(i()(b,o,{})),this.setShapeId(a),[m.b.Disappear].includes(t)&&l()(this.data,"par.cTn.presetClass",g.Ab.exit),[m.b.FlyOut,m.b.FloatUpOut,m.b.FloatDownOut,m.b.CutOut].includes(t)&&(l()(this.data,"par.cTn.presetClass",g.Ab.exit),this.setTavLstWithSubType(m.A.Bottom)),[m.b.Play,m.b.Pause,m.b.Stop].includes(t)){const e="par.cTn.childTnLst.egTimeNodeChoice[0].cmd.cBhvr",n=r===g.e.Video?"video.cMediaNode":"audio.cMediaNode",i=r===g.e.Video?m.u:m.r,o=t===m.b.Pause&&r===g.e.Video?m.y:s;l()(this.data,`${e}.cTn.id`,(new v.b).next()),l()(this.data,`${e}.tgtEl.spTgt.spid`,a),l()(this.data,`${e}.cTn.dur`,o),l()(this.data,r===g.e.Video?"video":"audio",i),l()(this.data,`${n}.cTn.id`,(new v.b).next()),l()(this.data,`${n}.tgtEl.spTgt.spid`,a)}}getBehaviorKeyFromTnBase(e){return Object.keys(m.f).find((t=>d()(e,t)))}setAttrNameInTnBase(e,t){const a=this.getBehaviorKeyFromTnBase(e);l()(e,`${a}.cBhvr.attrNameLst.attrName.0`,t)}getAttrNameFromTnBase(e){var t,a,s,n;return null===(n=e[this.getBehaviorKeyFromTnBase(e)])||void 0===n||null===(s=n.cBhvr)||void 0===s||null===(a=s.attrNameLst)||void 0===a||null===(t=a.attrName)||void 0===t?void 0:t[0]}getTavLstFromTnBase(e){var t;const a=this.getBehaviorKeyFromTnBase(e);if(a!==m.f.anim)return;const s=e[a];return null==s||null===(t=s.tavLst)||void 0===t?void 0:t.tav}isAnimDur(e){return[m.f.anim,m.f.animEffect,m.f.animMotion,m.f.animRot,m.f.animScale].includes(e)}isVisibilityDur(e,t,a){if("number"!=typeof a)return!1;if(t!==m.f.set)return!1;return[m.b.FadeOut,m.b.ExitScale,m.b.ExitCollapse,m.b.ExitSpinner,m.b.ExitSpread,m.b.ExitShrinkTurn].includes(e)}getTypeTimeMap(e,t,a){const s=.4;return e===m.b.ExitCenterRevolve?{[m.f.set]:{durTime:1,delayTime:t-1},[m.f.animEffect]:{durTime:.1*t,delayTime:.9*t},[m.f.anim]:{durTime:Number(a)?s*t:.6*t,delayTime:Number(a)?.6*t:0}}:{[m.f.set]:{durTime:1},[m.f.animEffect]:{durTime:.1*t},[m.f.anim]:{durTime:h()(a)?s*t:.6*t,delayTime:h()(a)?a:s*t}}}updateData(e){const{animType:t,nodeType:a,presetSubtype:s,delay:n,dur:r,by:i,opacity:o,shapeId:d,id:c,duration:l,mediaType:u,audio:h,color:p}=e;t&&d&&(this.updateTimeNodeByAnimType({animType:t,shapeId:d,duration:l,mediaType:u}),this.updateDataExpectAnimType({nodeType:a,presetSubtype:s,delay:n,dur:r,by:i,opacity:o,shapeId:d,id:c,audio:h,color:p}))}updateDataExpectAnimType(e){var t,a;const{nodeType:s,presetSubtype:n,delay:r,dur:i,by:o,opacity:c,id:l,audio:u,color:p}=e;u&&(d()(u,"repeatCount")&&this.setAudioRepeatCount(null==u?void 0:u.repeatCount),d()(u,"numSld")&&this.setAudioNumSld(null==u?void 0:u.numSld)),(null===(a=this.data)||void 0===a||null===(t=a.par)||void 0===t?void 0:t.cTn)&&(h()(s)||(this.data.par.cTn.nodeType=s),h()(n)||this.setPresetSubType(n),h()(r)||this.setDelay(r),h()(i)||this.setDur(+i),h()(o)||this.setBy(o),h()(c)||this.setOpacity(c),h()(l)||this.setId(l),h()(p)||this.setColor(p))}setColorAnimDur(e){var t,a,s,n;null===(n=this.data.par)||void 0===n||null===(s=n.cTn)||void 0===s||null===(a=s.childTnLst)||void 0===a||null===(t=a.egTimeNodeChoice)||void 0===t||t.forEach((t=>{var a,s,n;const r=this.getBehaviorKeyFromTnBase(t),i=(null===(n=t[r])||void 0===n||null===(s=n.cBhvr)||void 0===s||null===(a=s.cTn)||void 0===a?void 0:a.autoRev)?e/2:e;l()(t,`${r}.${m.m}`,String(i))}))}handleAnimClr(e,t){var a,s,n;const r=null===(n=e.cBhvr)||void 0===n||null===(s=n.attrNameLst)||void 0===s||null===(a=s.attrName)||void 0===a?void 0:a[0];if(!r)return;[m.e.FILL_COLOR,m.e.FONT_COLOR,m.e.LINE_COLOR].includes(r)&&(null==e?void 0:e.to)&&this.updateColor(e.to,t)}handleSetBehaviorClr(e,t){var a;(null===(a=e.to)||void 0===a?void 0:a.clrVal)&&this.updateColor(e.to.clrVal,t)}updateColor(e,t){if(!e)return;const[[a,s]]=Object.entries(t);Object.keys(e).forEach((t=>{e[a]={val:s},t!==a&&delete e[t]}))}getColorFromToObject(e){var t;if(!e)return;const[a]=Object.keys(e);if(!a)return;return{[a]:null===(t=e[a])||void 0===t?void 0:t.val}}setTime({tnBase:e,durPath:t,durTime:a,delayPath:s,delayTime:n}){const r=[];h()(t)||h()(a)||r.push({path:t,time:String(a)}),h()(s)||h()(n)||r.push({path:s,time:String(n)}),r.forEach((({path:t,time:a})=>l()(e,t,a)))}centerRevolveHandler(e,t,a){t.forEach((t=>{if(!t)return;const s=this.getBehaviorKeyFromTnBase(t);if(!s)return;const n=i()(t,`${s}.${m.k}`),r=this.getTypeTimeMap(e,a,n);this.setTime({tnBase:t,durPath:`${s}.${m.m}`,durTime:i()(r,`${s}.durTime`),delayPath:`${s}.${m.k}`,delayTime:i()(r,`${s}.delayTime`)})}))}bounceAndFloatHandler(e,t,a){t.forEach((e=>{const t=this.getBehaviorKeyFromTnBase(e);if(!t)return;const s=i()(e,`${t}.${m.k}`),n=i()(e,`${t}.${m.m}`);if(!s||!n||t===m.f.set)return;const r=+s/(+s+ +n),o=+n/(+s+ +n);l()(e,`${t}.${m.m}`,`${Math.round(o*a)}`),l()(e,`${t}.${m.k}`,`${Math.round(r*a)}`)}))}entryBoomerangDurHandler(e,t){e.forEach((e=>{const a=this.getBehaviorKeyFromTnBase(e);if(!a)return;const s=this.getAttrNameFromTnBase(e),n=i()(e,`${a}.${m.k}`);a!==m.f.set&&(this.checkOnlySetDurWithoutRate(a,s)?l()(e,`${a}.${m.m}`,String(t)):this.checkBoomerangDur(a,s,n)?l()(e,`${a}.${m.m}`,String(.5*t)):(l()(e,`${a}.${m.m}`,String(.5*t)),l()(e,`${a}.${m.k}`,String(.5*t))))}))}checkOnlySetDurByRate(e,t,a){return e===m.f.anim&&!(!t||![m.d.pptW,m.d.pptY].includes(t)||Number(a))}exitBoomerangDurHandler(e,t){e.forEach((e=>{const a=this.getBehaviorKeyFromTnBase(e);if(!a)return;const s=this.getAttrNameFromTnBase(e),n=i()(e,`${a}.${m.k}`);a!==m.f.set?this.checkOnlySetDurWithoutRate(a,s)?l()(e,`${a}.${m.m}`,String(t)):this.checkOnlySetDurByRate(a,s,n)?l()(e,`${a}.${m.m}`,String(.5*t)):(l()(e,`${a}.${m.m}`,String(.5*t)),l()(e,`${a}.${m.k}`,String(.5*t))):l()(e,`${a}.${m.k}`,String(Number(t)-1))}))}riseAndSinkDurHandler(e,t,a){const s=m.l[e];t.forEach((t=>{var n,r,i,o;const d=this.getBehaviorKeyFromTnBase(t);if(!d)return;const c=this.getAttrNameFromTnBase(t),u=null===(o=t[d])||void 0===o||null===(i=o.cBhvr)||void 0===i||null===(r=i.cTn)||void 0===r||null===(n=r.stCondLst)||void 0===n?void 0:n.cond;if(this.checkDirectDur(d,c)&&l()(t,`${d}.${m.m}`,String(a)),this.checkYNoStCondLst(d,c,u)&&l()(t,`${d}.${m.m}`,String(s*a)),this.checkYWithStCondLst(d,c,u)&&(l()(t,`${d}.${m.m}`,String(Math.round((1-s)*a))),l()(t,`${d}.${m.k}`,String(Math.round(s*a)))),d!==m.f.set);else{const s={[m.b.EntrRiseUp]:"0",[m.b.ExitSinkDown]:String(a-1)};l()(t,`${d}.${m.k}`,s[e])}}))}checkOnlySetDurWithoutRate(e,t){return e===m.f.animEffect||e===m.f.anim&&t===m.d.pptH}checkBoomerangDur(e,t,a){return e===m.f.anim&&(!!t&&(!![m.d.rotation,m.d.pptX].includes(t)||!(![m.d.pptW,m.d.pptY].includes(t)||Number(a))))}checkDirectDur(e,t){return e===m.f.animEffect||e===m.f.anim&&t===m.d.pptX}checkYNoStCondLst(e,t,a){return e===m.f.anim&&(t===m.d.pptY&&!a)}checkYWithStCondLst(e,t,a){return e===m.f.anim&&(t===m.d.pptY&&!!a)}setAnimNodeTavLstWithStrings(e,t,a){var s,n;null===(n=e.tavLst)||void 0===n||null===(s=n.tav)||void 0===s||s.forEach(((e,s)=>{0===s?l()(e,"val.strVal.val",t):l()(e,"val.strVal.val",a)}))}processX(e,t,a,s,n){const{tavFlagXDict:r}=y;if([g.Ab.entr,g.Ab.exit].includes(t)&&(a===m.z.Fly||a===m.z.Cut)){const n=i()(r,`${t}.${a}.${s}`);n&&this.setAnimNodeTavLstWithStrings(e,n.first,n.second)}}processY(e,t,a,s,n){const{tavFlagYDict:r}=y;if([g.Ab.entr,g.Ab.exit].includes(t)&&a===m.z.Fly){const n=i()(r,`${t}.${a}.${s}`);n&&this.setAnimNodeTavLstWithStrings(e,n.first,n.second)}}handleAcrossAnimTag(e){const t=e.filter((e=>{var t;return!m.J.includes(null!==(t=this.getAttrNameFromTnBase(e))&&void 0!==t?t:m.d.none)}));return this.updateAttrTavLst(t,m.I,m.A.Across),t}updateAttrTavLst(e,t,a){e.forEach((e=>{if(this.getBehaviorKeyFromTnBase(e)!==m.f.anim)return;const s=this.getAttrNameFromTnBase(e);if(!s||!t.includes(s))return;const n=this.getTavLstFromTnBase(e);null==n||n.forEach((e=>{const t=null==e?void 0:e.tm,n=i()(m.C,`${a}.${s}.${t}`);if(h()(n))return;const r=isNaN(Number(n))?"strVal":"fltVal";l()(e,"val",{[r]:n})}))}))}handleNotAcrossAnimTag(e,t){if(e.length>3)return this.updateAttrTavLst(e,[...m.I,...m.J],t),e;const a=e.find((e=>this.getBehaviorKeyFromTnBase(e)===m.f.anim));if(!a)return e;this.updateAttrTavLst(e,m.I,t);const s=m.J.map((e=>{const s=n()(a);this.setAttrNameInTnBase(s,e);const r=this.getTavLstFromTnBase(s);return null==r||r.forEach((a=>{const s=null==a?void 0:a.tm,n=i()(m.C,`${t}.${e}.${s}`);h()(n)||l()(a,"val",{strVal:n})})),s}));return e.unshift(...s),e}handleBlinds(e,t){if([m.b.EntrBlinds,m.b.ExitBlinds].includes(this.animType)){const a=e.find((e=>!!e.animEffect));if(!(null==a?void 0:a.animEffect)||m.A.Across!==t&&m.A.Vertical!==t)return;a.animEffect.filter={[m.A.Across]:"blinds(horizontal)",[m.A.Vertical]:"blinds(vertical)"}[t]}}handleEntrSwivel(e,t){const a=e.find((e=>!!e.anim));if(!(null==a?void 0:a.anim)||m.A.Across!==t&&m.A.Vertical!==t)return;const s=this.getAttrNameFromTnBase(a);if(s!==m.d.pptW&&s!==m.d.pptH)return;const n={[m.A.Across]:{[m.d.pptW]:{tav:[{tm:"0",fmla:"#ppt_w*sin(2.5*pi*$)",val:{fltVal:{val:0}}},{tm:"100000",val:{fltVal:{val:1}}}]},[m.d.pptH]:{tav:[{tm:"0",val:{strVal:{val:"#ppt_h"}}},{tm:"100000",val:{strVal:{val:"#ppt_h"}}}]}},[m.A.Vertical]:{[m.d.pptW]:{tav:[{tm:"0",val:{strVal:{val:"#ppt_w"}}},{tm:"100000",val:{strVal:{val:"#ppt_w"}}}]},[m.d.pptH]:{tav:[{tm:"0",fmla:"#ppt_h*sin(2.5*pi*$)",val:{fltVal:{val:0}}},{tm:"100000",val:{fltVal:{val:1}}}]}}};a.anim.tavLst=n[t][s]}handleStretch(e,t){const a=[m.A.Across],s=[m.A.Top,m.A.Bottom,m.A.Left,m.A.Right],n=this.getStretchSubTypeConfig();this.adjustPresetSubType(e,t,a,[],s,n)}getStretchSubTypeConfig(){const e=m.d.pptW,t=m.d.pptH,a=m.d.pptX,s=m.d.pptY,n=this.getAnimVariantStrVal(e),r=this.getAnimVariantStrVal(t),i=this.getAnimVariantStrVal(a),o=this.getAnimVariantStrVal(s),d={[e]:{0:n,1e5:this.getAnimVariantFltVal(0)},[t]:{0:r,1e5:r}};return{[m.A.UnSupport]:d,[m.A.Across]:d,[m.A.Top]:{[e]:{0:n,1e5:n},[t]:{0:r,1e5:this.getAnimVariantFltVal(0)},[a]:{0:i,1e5:i},[s]:{0:o,1e5:this.getAnimVariantStrVal(`${s}-${t}/2`)}},[m.A.Bottom]:{[e]:{0:n,1e5:n},[t]:{0:r,1e5:this.getAnimVariantFltVal(0)},[a]:{0:i,1e5:i},[s]:{0:o,1e5:this.getAnimVariantStrVal(`${s}+${t}/2`)}},[m.A.Left]:{[e]:{0:n,1e5:this.getAnimVariantFltVal(0)},[t]:{0:r,1e5:r},[a]:{0:i,1e5:this.getAnimVariantStrVal(`${a}-${e}/2`)},[s]:{0:o,1e5:o}},[m.A.Right]:{[e]:{0:n,1e5:this.getAnimVariantFltVal(0)},[t]:{0:r,1e5:r},[a]:{0:i,1e5:this.getAnimVariantStrVal(`${a}+${e}/2`)},[s]:{0:o,1e5:o}}}}adjustPresetSubType(e,t,a,s,n,r){const i=this.adjustAttrVal(this.adjustChildTnLst(e,t,a,s,n),r,t);e.splice(0,e.length,...i)}adjustChildTnLst(e,t,a,s,r){let i=[...e];if(a.includes(t))return i=e.filter((e=>{if(e.animEffect&&this.isScale)return!0;const t=this.getAttrNameFromTnBase(e);return t&&[m.d.pptW,m.d.pptH].includes(t)||e.set})),i;if(s.includes(t))return i=e.filter((e=>{if(e.animEffect&&this.isScale)return!0;const t=this.getAttrNameFromTnBase(e);return t&&[m.d.pptW,m.d.pptH,m.d.pptY].includes(t)||e.set})),i;if(r.includes(t)){const t=e.find((e=>{const t=this.getAttrNameFromTnBase(e);return!!t&&t===m.d.pptW}));return t?[m.d.pptX,m.d.pptY].map((e=>{const a=n()(t);return this.setAttrNameInTnBase(a,e),a})):[]}return i}adjustAttrVal(e,t,a){return e.map((e=>{var s,r,i;if(!e.anim)return e;const o=this.getAttrNameFromTnBase(e),d=n()(e);if(!o)return e;var c;const l=(null!==(c=t[a])&&void 0!==c?c:t[m.A.UnSupport])[o];return null===(i=d.anim)||void 0===i||null===(r=i.tavLst)||void 0===r||null===(s=r.tav)||void 0===s||s.forEach((e=>{e.tm&&Reflect.set(e,"val",l[e.tm])})),d}))}setTavLstWithSubType(e){var t,a,s,n;if(!(null===(a=this.data)||void 0===a||null===(t=a.par)||void 0===t?void 0:t.cTn))return;const{presetClass:r=g.Ab.PBDEFAULT,presetId:i,presetSubtype:o}=null===(s=this.data.par)||void 0===s?void 0:s.cTn,d=(null===(n=this.data.par.cTn.childTnLst)||void 0===n?void 0:n.egTimeNodeChoice)||[];let c=!1,l=!1;d.forEach((t=>{var a,s;const{anim:n}=t;if(this.getBehaviorKeyFromTnBase(t)===m.f.anim&&(null==n||null===(s=n.tavLst)||void 0===s||null===(a=s.tav)||void 0===a?void 0:a.length))return c?void(l||(this.processY(n,r,i,o,e),l=!0)):(this.processX(n,r,i,o,e),void(c=!0))}))}handleExitSwivel(e,t){if(t!==m.A.Across&&t!==m.A.Vertical)return;const a=m.d.pptW,s=m.d.pptH,n={[m.A.Across]:{[a]:{name:s,matchLen:21},[s]:{name:a,matchLen:2}},[m.A.Vertical]:{[a]:{name:s,matchLen:2},[s]:{name:a,matchLen:21}}};e.find((e=>{var r,i;if(!e.anim)return!1;const o=this.getAttrNameFromTnBase(e);if(o!==a&&o!==s)return!1;const d=n[t][o];if(!d)return!1;const{name:c,matchLen:l}=d,u=this.getTavLstFromTnBase(e);return(null==u?void 0:u.length)===l||(this.setAttrNameInTnBase(e,c),null===(i=e.anim.tavLst)||void 0===i||null===(r=i.tav)||void 0===r||r.forEach((e=>{var t,a,s;(null===(a=e.val)||void 0===a||null===(t=a.strVal)||void 0===t?void 0:t.val)&&Reflect.set(e.val.strVal,"val",null===(s=e.val)||void 0===s?void 0:s.strVal.val.replace(o,c))})),!1)}))}handleEntrZoom(e,t){const a=[m.A.EleCenter,m.A.InSlightly,m.A.ToEleCenter,m.A.OutSlightly],s=[m.A.SlideCenter,m.A.OutBottom],n=this.getEntrZoomSubTypeConfig();this.adjustPresetSubType(e,t,a,[],s,n)}getEntrZoomSubTypeConfig(){const e=m.d.pptW,t=m.d.pptH,a=m.d.pptX,s=m.d.pptY,[n,r,i,o]=[e,t,a,s].map((e=>this.getAnimVariantStrVal(`#${e}`))),[d,c]=[0,.5].map((e=>this.getAnimVariantFltVal(e))),l={[e]:{0:d,1e5:n},[t]:{0:d,1e5:r}};return{[m.A.UnSupport]:l,[m.A.EleCenter]:l,[m.A.SlideCenter]:{[e]:{0:d,1e5:n},[t]:{0:d,1e5:r},[a]:{0:c,1e5:i},[s]:{0:c,1e5:o}},[m.A.InSlightly]:{[e]:{0:this.getAnimVariantStrVal(`2/3*#${e}`),1e5:n},[t]:{0:this.getAnimVariantStrVal(`2/3*#${t}`),1e5:r}},[m.A.ToEleCenter]:{[e]:{0:this.getAnimVariantStrVal(`4*#${e}`),1e5:n},[t]:{0:this.getAnimVariantStrVal(`4*#${t}`),1e5:r}},[m.A.OutBottom]:{[e]:{0:this.getAnimVariantStrVal(`(6*min(max(#${e}*#${t},.3),1)-7.4)/-.7*#${e}`),1e5:n},[t]:{0:this.getAnimVariantStrVal(`(6*min(max(#${e}*#${t},.3),1)-7.4)/-.7*#${t}`),1e5:r},[a]:{0:c,1e5:i},[s]:{0:this.getAnimVariantStrVal(`1+(6*min(max(#${e}*#${t},.3),1)-7.4)/-.7*#${t}/2`),1e5:o}},[m.A.OutSlightly]:{[e]:{0:this.getAnimVariantStrVal(`4/3*#${e}`),1e5:n},[t]:{0:this.getAnimVariantStrVal(`4/3*#${t}`),1e5:r}}}}handleExitZoom(e,t){const a=[m.A.EleCenter,m.A.InSlightly,m.A.ToEleCenter,m.A.OutSlightly],s=[m.A.ToSlideBottom],n=[m.A.ToSlideCenter],r=this.getExitZoomSubTypeConfig();this.adjustPresetSubType(e,t,a,s,n,r)}getExitZoomSubTypeConfig(){const e=m.d.pptW,t=m.d.pptH,a=m.d.pptX,s=m.d.pptY,[n,r,i,o]=[e,t,a,s].map((e=>this.getAnimVariantStrVal(e))),[d,c]=[0,.5].map((e=>this.getAnimVariantFltVal(e))),l={[e]:{0:n,1e5:this.getAnimVariantStrVal(`4*${e}`)},[t]:{0:r,1e5:this.getAnimVariantStrVal(`4*${t}`)}};return{[m.A.UnSupport]:l,[m.A.EleCenter]:l,[m.A.ToSlideCenter]:{[e]:{0:n,1e5:d},[t]:{0:r,1e5:d},[a]:{0:i,1e5:c},[s]:{0:o,1e5:c}},[m.A.InSlightly]:{[e]:{0:n,1e5:this.getAnimVariantStrVal(`4/3*${e}`)},[t]:{0:r,1e5:this.getAnimVariantStrVal(`4/3*${t}`)}},[m.A.ToEleCenter]:{[e]:{0:n,1e5:d},[t]:{0:r,1e5:d}},[m.A.ToSlideBottom]:{[e]:{0:n,1e5:this.getAnimVariantStrVal(`(6*min(max(${e}*${t},.3),1)-7.4)/-.7*${e}`)},[t]:{0:r,1e5:this.getAnimVariantStrVal(`(6*min(max(${e}*${t},.3),1)-7.4)/-.7*${t}`)},[s]:{0:o,1e5:this.getAnimVariantStrVal(`1+(6*min(max(${e}*${t},.3),1)-7.4)/-.7*${t}/2`)}},[m.A.OutSlightly]:{[e]:{0:n,1e5:this.getAnimVariantStrVal(`2/3*${e}`)},[t]:{0:r,1e5:this.getAnimVariantStrVal(`2/3*${t}`)}}}}handleEntrScale(e,t){const a=[m.A.EleCenter],s=[m.A.SlideCenter],n=this.getEntrScaleSubTypeConfig();this.adjustPresetSubType(e,t,a,[],s,n)}getEntrScaleSubTypeConfig(){const e=m.d.pptW,t=m.d.pptH,a=m.d.pptX,s=m.d.pptY,[n,r,i,o]=[e,t,a,s].map((e=>this.getAnimVariantStrVal(`#${e}`))),[d,c]=[0,.5].map((e=>this.getAnimVariantFltVal(e))),l={[e]:{0:d,1e5:n},[t]:{0:d,1e5:r}};return{[m.A.UnSupport]:l,[m.A.EleCenter]:l,[m.A.SlideCenter]:{[e]:{0:d,1e5:n},[t]:{0:d,1e5:r},[a]:{0:c,1e5:i},[s]:{0:c,1e5:o}}}}handleExitScale(e,t){const a=[m.A.ToEleCenter],s=[m.A.ToSlideCenter],n=this.getExitScaleSubTypeConfig();this.adjustPresetSubType(e,t,a,[],s,n)}getExitScaleSubTypeConfig(){const e=m.d.pptW,t=m.d.pptH,a=m.d.pptX,s=m.d.pptY,[n,r,i,o]=[e,t,a,s].map((e=>this.getAnimVariantStrVal(e))),[d,c]=[0,.5].map((e=>this.getAnimVariantFltVal(e))),l={[e]:{0:n,1e5:d},[t]:{0:r,1e5:d}};return{[m.A.UnSupport]:l,[m.A.ToEleCenter]:l,[m.A.ToSlideCenter]:{[e]:{0:n,1e5:d},[t]:{0:r,1e5:d},[a]:{0:i,1e5:c},[s]:{0:o,1e5:c}}}}getAnimVariantVal(e,t){return{[e]:{val:t}}}getAnimVariantStrVal(e){return this.getAnimVariantVal("strVal",e)}getAnimVariantFltVal(e){return this.getAnimVariantVal("fltVal",e)}constructor(e){this.data=e}}},"7b62e570e0":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("711a53c9fc");function n(e,t){var a,n,r;const i=null!==(r=null===(a=t.presentation)||void 0===a?void 0:a.slideList.findIndex((t=>t.id===e.firstSlideId)))&&void 0!==r?r:0;var o;return[{type:s.c.AddSection,sectionId:e.id,name:e.name},{type:s.c.BindSectionToSlide,sectionId:e.id,firstSlideIndex:i>=0?i:null!==(o=null===(n=t.presentation)||void 0===n?void 0:n.slideList.length)&&void 0!==o?o:0}]}},"7ecd30c99e":function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return I}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("711a53c9fc"),i=a("026cc7da1f"),o=a("63945b6fba"),d=a.n(o),c=a("9541c1076d"),l=a.n(c),u=a("c73625d763"),h=a.n(u),p=a("6f5f1758fe"),f=a("7c46f42788"),g=a("2ba82388a5"),m=a("b41b5d48f6"),v=a("fce1cf19ce"),b=a("215eaa3247");class y{static convertParagraphEnd(e,t,a,s){if(t===v.a.kParagraphBreak||t===v.a.kParagraphReturn)return Reflect.set(e,"endParaRPr",a),Reflect.set(e,"pPr",s),e}static convertTextRunProperties(e,t){return e===v.a.kLineBreak?{rPr:t}:{rPr:t,t:e}}static convertFieldProperties(e,t){const a=e.replace(new RegExp(`${v.a.kFieldBegin}|${v.a.kFieldEnd}`,"g"),"");return Object(n.a)(Object(s.a)({rPr:{},pPr:{}},t),{t:a})}static removeUnnecessaryData(e,t){e&&Reflect.deleteProperty(e,"isPlaceholder"),(null==t?void 0:t.rPr)&&Reflect.deleteProperty(t.rPr,"isPlaceholder")}static fromMutationData(e){const{text:t,textProperties:a}=Object(g.a)(e),s=new Map,n=new Map,o=[];return a.forEach((e=>{const{index:a=0,count:d=0,textPropertyType:c,paragraphProperties:u,runProperties:p,fieldProperties:f}=e;switch(c){case r.cc.Paragraph:s.set(a,{egTextRun:[],endParaRPr:{},pPr:u});break;case r.cc.Run:{if(y.isStartFieldPlaceholder(n,a))return;if(y.isEndFieldPlaceholder(n,a)){const e=y.isEndFieldPlaceholder(n,a);return void(2===(null==e?void 0:e.count)&&o.push(l()({fld:null==e?void 0:e.fld},{fld:y.convertTextRunProperties("",{})})))}const e=t.slice(a,a+d),r=y.isInField(n,a);var g;if(r)o.push(l()({fld:Object(b.b)(null!==(g=null==r?void 0:r.fld)&&void 0!==g?g:{},"fldType")},{fld:y.convertTextRunProperties(e,p)}));else if(null==p?void 0:p.isPlaceholder){var m;const t=s.get(a);var v;Object(i.assert)(t,"currentParagraph should exist"),null===(m=t.egTextRun)||void 0===m||m.push(...o.splice(0,o.length)),y.convertParagraphEnd(t,e,null!=p?p:{},null!==(v=t.pPr)&&void 0!==v?v:{})}else{const t=y.convertTextRunProperties(e,p),a=h()(t,"t")?"r":"br";o.push({[a]:t})}break}case r.cc.Field:n.set(a,{fld:y.convertFieldProperties(t.slice(a,a+d),f),index:a,count:d})}y.removeUnnecessaryData(p,f)})),Array.from(s).sort((([e],[t])=>e-t)).map((([,e])=>e))}static fromParagraphListData(e,t,a,i=0,o=0){const c=Object(g.a)(e,{deleteNull:!0}),l=[],u={type:r.c.SetTextData,pageId:t,shapeId:a,text:"",textProperties:l,col:i,row:o};return c.forEach((e=>{var t;const a=[];null===(t=e.egTextRun)||void 0===t||t.forEach((e=>{d()(e)||a.push(...y.fromTextRun(e,u))}));const i={index:u.text.length,count:v.a.kParagraphReturn.length};var o,c;a.push(Object(n.a)(Object(s.a)({},i),{textPropertyType:r.cc.Run,runProperties:Object(n.a)(Object(s.a)({},null!==(o=e.endParaRPr)&&void 0!==o?o:{}),{isPlaceholder:!0})})),a.unshift(Object(n.a)(Object(s.a)({},i),{textPropertyType:r.cc.Paragraph,paragraphProperties:null!==(c=e.pPr)&&void 0!==c?c:{}})),u.text+=v.a.kParagraphReturn,l.push(...a)})),u}static fromTextRun(e,t){return e.r?y.fromRegularTextRun(e.r,t):e.br?y.fromTextLineBreak(e.br,t):e.fld?y.fromTextField(e.fld,t):[]}static fromRegularTextRun(e,t){var a,s,n,i;if(!(null===(a=e.t)||void 0===a?void 0:a.length))return[];const o={index:t.text.length,count:null!==(n=null===(s=e.t)||void 0===s?void 0:s.length)&&void 0!==n?n:0,textPropertyType:r.cc.Run,paragraphProperties:{},runProperties:null!==(i=e.rPr)&&void 0!==i?i:{}};var d,c;return Reflect.set(t,"text",(null!==(d=t.text)&&void 0!==d?d:"")+(null!==(c=e.t)&&void 0!==c?c:"")),[o]}static fromTextLineBreak(e,t){var a;const s={index:t.text.length,count:v.a.kLineBreak.length,textPropertyType:r.cc.Run,paragraphProperties:{},runProperties:null!==(a=e.rPr)&&void 0!==a?a:{}};var n;return Reflect.set(t,"text",(null!==(n=t.text)&&void 0!==n?n:"")+v.a.kLineBreak),[s]}static getParagraphListData(e,t,a,s,n){var r,o,d,c,l,u,h;const p=e.store.models.get(a,f.a.Shape,f.a.GraphicalObjectFrameTable);var g,m;if(Object(i.assert)(p,"shape should exist"),p.type===f.a.Shape)return y.fromParagraphListData(null!==(m=null===(g=p.getOwnedData().txBody)||void 0===g?void 0:g.p)&&void 0!==m?m:[],t,p.id);const v=null===(u=p.getOwnedData().graphic)||void 0===u||null===(l=u.graphicData)||void 0===l||null===(c=l.tbl)||void 0===c||null===(d=c.tr)||void 0===d||null===(o=d[n])||void 0===o||null===(r=o.tc)||void 0===r?void 0:r[s];var b;return Object(i.assert)(v,"cell should exist"),y.fromParagraphListData(null!==(b=null==v||null===(h=v.txBody)||void 0===h?void 0:h.p)&&void 0!==b?b:[],t,a,s,n)}static fromTextField(e,t){var a;const s=Reflect.get(v.a,"kFieldBegin")+(null!==(a=e.t)&&void 0!==a?a:"")+Reflect.get(v.a,"kFieldEnd"),n=()=>({index:t.text.length,count:0,textPropertyType:r.cc.Run,paragraphProperties:{},runProperties:{},fieldProperties:{}}),i=n();i.textPropertyType=r.cc.Field,i.count=s.length,i.fieldProperties.type=e.type,i.fieldProperties.id=e.id;const o=n();var d;o.count=1,o.runProperties.isPlaceholder=!0,Reflect.set(t,"text",(null!==(d=t.text)&&void 0!==d?d:"")+v.a.kFieldBegin);const c=(()=>{var a,s,r;if(0===(null!==(r=null===(a=e.t)||void 0===a?void 0:a.length)&&void 0!==r?r:0))return;const i=n();var o,d,c,l;return i.count=null!==(o=null===(s=e.t)||void 0===s?void 0:s.length)&&void 0!==o?o:0,i.runProperties=null!==(d=e.rPr)&&void 0!==d?d:{},Reflect.set(t,"text",(null!==(c=t.text)&&void 0!==c?c:"")+(null!==(l=e.t)&&void 0!==l?l:"")),i})(),l=n();var u;return l.count=1,l.runProperties.isPlaceholder=!0,Reflect.set(t,"text",(null!==(u=t.text)&&void 0!==u?u:"")+v.a.kFieldEnd),[i,o,c,l].filter(Boolean)}static isFieldPlaceholder(e,t){return[...e.values()].find((e=>e&&(e.index===t||e.index+e.count-1===t)))}static isStartFieldPlaceholder(e,t){return[...e.values()].find((e=>e&&e.index===t))}static isEndFieldPlaceholder(e,t){return[...e.values()].find((e=>e&&e.index+e.count-1===t))}static isInField(e,t){return[...e.values()].find((e=>e&&e.index<t&&e.index+e.count-1>t))}}class I extends p.a{apply(e){const{shapeId:t,col:a,row:s}=this.data,n=e.store.models.get(t,f.a.Shape,f.a.GraphicalObjectFrameTable);if(Object(i.assert)(n,"shape should exist"),n.type!==f.a.Shape)if(n.type!==f.a.GraphicalObjectFrameTable);else{n.store.setText(y.fromMutationData(this.data),a,s)}else n.store.setText(y.fromMutationData(this.data))}invert(e){const{row:t,col:a,shapeId:s,pageId:n}=this.data;return[y.getParagraphListData(e,n,s,a,t)]}check(e){const{pageId:t,shapeId:a,textProperties:s,col:n,row:r,text:i}=this.data;return m.a.every(m.a.shape.should.existInPage(e,a,t),m.a.shape.should.hasTextBody(e,a,n,r),m.a.text.textContent.is.valid(i),m.a.text.textProperties.should.valid(s,i))}constructor(...e){super(...e),this.type=r.c.SetTextData}}},"844d924118":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("711a53c9fc"),n=a("6f5f1758fe"),r=a("b41b5d48f6");class i extends n.a{apply(e){const{themeId:t}=this.data;e.store.removeTheme(t)}invert(e){const{themeId:t}=this.data,a=e.store.getThemeById(t);return[{type:s.c.AddTheme,themeId:t,themeName:(null==a?void 0:a.store.data.name)||"",themeElements:(null==a?void 0:a.store.data.themeElements)||{}}]}check(e){const{themeId:t}=this.data;return r.a.every(r.a.theme.should.existInPresentation(e,t),r.a.theme.should.notUsedInMaster(e,t))}constructor(...e){super(...e),this.type=s.c.RemoveTheme}}},"8abf38df5a":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("5188b6140f"),n=a("93085721b7"),r=a("ddb736108e"),i=a("15cde7076e"),o=a("025e3e9b74"),d=a("e5b2319967");class c extends d.a{getNoteSlide(){var e;return this.parent.store.getNoteSlideById(null!==(e=this.store.data.noteSlideId)&&void 0!==e?e:"")}getLayout(){return this.parent.store.getLayoutById(this.store.data.layoutId)}getMaster(){const e=this.getLayout();return null==e?void 0:e.getMaster()}getDisplayPlaceholderChildren(){return this.store.getDisplayPlaceholderChildren()}forEachDescendant(e=(()=>{})){const t=this.getNoteSlide();t&&(e(t),t.forEachDescendant(e)),this.timing&&e(this.timing),super.forEachDescendant(e)}changeLoadingState(e){this.loading=e,this.events.emit(o.e.PageLoadingStateChange,e,this.id)}waitForLoading(e){if(!this.loading)return void e();const t=this.events.on(o.e.PageLoadingStateChange,((a,s)=>{a||s!==this.id||(e(),t())}))}initRelation(e,t){const a=e.store.getLayoutById(t),s=null==a?void 0:a.getMaster(),n=null==s?void 0:s.getTheme();a&&this.context.setLayout(a),s&&this.context.setMaster(s),n&&this.context.setTheme(n)}constructor(e,t,a){super(t,a),this.loading=!1,this.context=new n.a(e.type),this.initRelation(a,e.layoutId),this.context.setPresentation(this.parent),this.context.setPage(this),this.context.setSlide(this),this.context.setTarget(this),this.store=new i.a(e,this.events,this.context,this),this.props=new r.a(this.store.data,this.context),this.api=new s.a(this,t)}}},"8d1a1b3ebd":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("711a53c9fc"),n=a("6f5f1758fe"),r=a("b41b5d48f6"),i=a("7c46f42788"),o=a("b56763d092"),d=a("fdddc95d9b");class c extends n.a{apply(e){if(!this.data.shapeId)return;const{shapeId:t,range:a}=this.data;e.store.models.get(t,i.a.GraphicalObjectFrameTable).store.mergeTableCells(a)}invert(e){const{pageId:t,shapeId:a,range:n}=this.data,r=e.store.models.get(a,i.a.GraphicalObjectFrameTable),d=Object(o.h)((null==r?void 0:r.store.tableData)||{},n).map((e=>({type:s.c.MergeTableCells,pageId:t,shapeId:a,range:e})));return[{type:s.c.UnmergeTableCells,pageId:t,shapeId:a,range:n},...d]}check(e,t){const{pageId:a,shapeId:s,range:n}=this.data;return t===d.a.Keyframe?r.a.every(r.a.shape.should.existInPage(e,s,a)):r.a.every(r.a.shape.should.existInPage(e,s,a),r.a.table.can.mergeTableCells(e,s,n),r.a.table.range.is.noMergedRange(e,s,n))}constructor(...e){super(...e),this.type=s.c.MergeTableCells}}},"8d9554480f":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("2ba82388a5"),i=a("fdddc95d9b"),o=a("384878758a"),d=a("7c46f42788"),c=a("025e3e9b74");class l{init(){return this.events.on(c.e.MutationSource,(e=>{this.source=e})),this.events.on(c.e.EnqueueChange,((e,t)=>{this.enqueueChange({key:this.getChangeKey(e,t,this.source),model:e,source:this.source,change:t,ignore:!1})})),this.events.on(c.e.AttachDataModel,(e=>{this.isInTransaction&&(this.detachedModelIdsSet.has(e.id)?this.detachedModelIdsSet.delete(e.id):this.freshModelIdsSet.add(e.id))})),this.events.on(c.e.DetachDataModel,(e=>{this.isInTransaction&&(this.freshModelIdsSet.has(e.id)?this.freshModelIdsSet.delete(e.id):this.detachedModelIdsSet.add(e.id))})),this.events.on(c.e.BeginTransaction,(e=>{0===e&&(this.reset(),this.isInTransaction=!0)})),this.events.on(c.e.CommitTransaction,(()=>{this.isInTransaction=!1,this.notify()})),this}notify(){this.compactChanges();for(const{model:e,change:t,ignore:a,source:r}of this.changeItems)a||(t.type!==o.a.DataPatch&&t.type!==o.a.PropsInheritance||e.type!==d.a.GraphicalObjectFrameTable||(t.diffs.tableChanges=e.tableChanges,e.clearTableChanges()),e.notify(Object(n.a)(Object(s.a)({},t),{source:r})));this.reset()}compactChanges(){const e=new Set,t=new Map;for(const a of this.changeItems){const{model:s,key:n,change:i}=a,{type:d}=i,c=this.detachedModelIdsSet.has(s.id);if(c&&s.dispose(),this.freshModelIdsSet.has(s.id)||c||e.has(n))a.ignore=!0;else if(t.has(n))a.ignore=!0,this.mergeChangeData(a,t);else if(d!==o.a.ChildList&&d!==o.a.ChildMap)if(d!==o.a.DataPatch)d===o.a.PropsInheritance&&t.set(n,a);else{const e={};i.diffs.data=r.d(e,i.diffs.data),t.set(n,a)}else e.add(n)}}mergeChangeData(e,t){const{key:a}=e,s=t.get(a);(null==s?void 0:s.change.type)===o.a.DataPatch&&(e.change.type===o.a.DataPatch&&(s.change.diffs.data=r.d(s.change.diffs.data,e.change.diffs.data)),e.change.type===o.a.PropsInheritance&&(s.change=e.change))}enqueueChange(e){this.changeItems.push(e)}reset(){this.freshModelIdsSet.clear(),this.detachedModelIdsSet.clear(),this.changeItems=[]}getChangeKey(e,t,a){const s=`${a}:${e.id}`;return t.type===o.a.ChildList?`${s}:${t.diffs.childList.key}`:t.type===o.a.ChildMap?`${s}:${t.diffs.childMap.key}`:s}constructor(e){this.events=e,this.freshModelIdsSet=new Set,this.detachedModelIdsSet=new Set,this.changeItems=[],this.source=i.a.None,this.isInTransaction=!1,this.init()}}},"8f2bd6dcbf":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a("5b7ded0d86"),n=a("025e3e9b74");class r{addObserver(e,t){const a=this.observers.get(e);a?a.add(t):this.observers.set(e,new Set([t]))}notifyResourceChange(e,t){if(!t.src)return;const a=this.observers.get(e);if(a){for(const e of a)this.detachedModels.has(e)||e.store.onPropsChange([s.c.Resources]);this.observers.delete(e)}}constructor(e){this.events=e,this.observers=new Map,this.detachedModels=new WeakSet,this.events.on(n.e.ModelObserveResourceMap,((e,t)=>this.addObserver(t,e))),this.events.on(n.e.ResourceMapChange,((e,t)=>this.notifyResourceChange(e,t))),this.events.on(n.e.DetachDataModel,(e=>this.detachedModels.add(e))),this.events.on(n.e.AttachDataModel,(e=>this.detachedModels.delete(e)))}}},"90a5b18656":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("a880efe597"),n=a("93085721b7"),r=a("353f927e4a"),i=a("bff483e0fc"),o=a("e5b2319967");class d extends o.a{get isTitleLayout(){return"/ppt/slideLayouts/slideLayout1.xml"===this.id}getLayout(){return this}getMaster(){return this.parent.store.getMasterById(this.store.data.masterId)}getInheritedPlaceholders(){return this.placeholders.map((e=>this.store.getModifyPlaceholderData(e,this))).filter((e=>!!e))}getPlaceholderShape(e){return this.store.findPlaceholderShape(e)}forEachDescendant(e=(()=>{})){this.timing&&e(this.timing),super.forEachDescendant(e)}constructor(e,t,a){super(t,a),this.context=new n.a(e.type);const o=a.store.getMasterById(e.masterId),d=null==o?void 0:o.getTheme();if(!o)throw new Error(`missing master: ${e.masterId}`);if(!d)throw new Error("missing theme");this.context.setPresentation(this.parent),this.context.setMaster(o),this.context.setTheme(d),this.context.setPage(this),this.context.setTarget(this),this.store=new i.a(e,this.events,this.context,this),this.props=new r.a(this.store.data,this.context),this.api=new s.a(this,t)}}},"90a993b6f1":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788"),d=a("b56763d092");class c extends r.a{apply(e){if(!this.data.shapeId||0===this.data.count)return;const{shapeId:t,index:a,count:s}=this.data,r=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(r,"shape should exist"),r&&r.store.insertTableColumn(a,s)}invert(){const{pageId:e,shapeId:t,index:a,count:n}=this.data;return[{type:s.c.DeleteTableCol,pageId:e,shapeId:t,index:a,count:n}]}check(e){const{pageId:t,shapeId:a,index:s,count:n}=this.data,r=e.store.models.get(a,o.a.GraphicalObjectFrameTable);var c;const l=Object(d.h)(null!==(c=null==r?void 0:r.store.tableData)&&void 0!==c?c:{});return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.table.can.addRowOrCol(e,a,s,n,!1,l))}constructor(...e){super(...e),this.type=s.c.InsertTableCol}}},"9303123b33":function(e,t,a){"use strict";a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return g}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("026cc7da1f"),i=a("f84a91093c"),o=a.n(i),d=a("6f5f1758fe"),c=a("7c46f42788"),l=a("2ba82388a5"),u=a("b41b5d48f6"),h=a("215eaa3247"),p=a("285f8ccc4f");class f{static fromMutationData(e){return Object(h.b)(e,"type","pageId","shapeId")}static toTextBodyDelta(e){const{textBodyProperties:t,textListStyle:a}=e;return{bodyPr:t,lstStyle:a}}static getTextBodyProperties(e,t,a,s){var n,i,d,l,u,h;const p=e.store.models.get(t,c.a.Shape,c.a.GraphicalObjectFrameTable);if(Object(r.assert)(p,"shape should exist"),p.type===c.a.Shape){const{bodyPr:e,lstStyle:t}=p.store.data.txBody||{};return{bodyPr:e,lstStyle:t}}if(!o()(a)||!o()(s))return{};const f=null===(h=p.getOwnedData().graphic)||void 0===h||null===(u=h.graphicData)||void 0===u||null===(l=u.tbl)||void 0===l||null===(d=l.tr)||void 0===d||null===(i=d[s])||void 0===i||null===(n=i.tc)||void 0===n?void 0:n[a];Object(r.assert)(f,"cell should exist");const{bodyPr:g,lstStyle:m}=f.txBody||{};return{bodyPr:g,lstStyle:m}}static fromTextBodyProperties(e,t,a,s=0,r=0){const i={type:n.c.SetTextBodyProperties,pageId:t,shapeId:a,col:s,row:r};return null===e.bodyPr?i.textBodyProperties=null:void 0!==e.bodyPr&&(i.textBodyProperties=Object(p.a)(e.bodyPr)),null===e.lstStyle?i.textListStyle=null:void 0!==e.lstStyle&&(i.textListStyle=Object(p.a)(e.lstStyle)),i}}class g extends d.a{apply(e){const{shapeId:t,col:a,row:s}=this.data,n=e.store.models.get(t,c.a.Shape,c.a.GraphicalObjectFrameTable);if(Object(r.assert)(n,"shape should exist"),n.type!==c.a.Shape)if(n.type===c.a.GraphicalObjectFrameTable&&o()(a)&&o()(s)){const e=f.toTextBodyDelta(this.data);n.store.setTextBodyProperties(e,a,s)}else;else{const e=f.toTextBodyDelta(this.data);n.store.setTextBodyProperties(e)}}invert(e){const{row:t,col:a,shapeId:r,pageId:i}=this.data,o=f.fromTextBodyProperties(f.getTextBodyProperties(e,r,a,t),i,r,t,a),d={textBodyProperties:o.textBodyProperties,textListStyle:o.textListStyle,col:a,row:t};return[Object(s.a)({type:n.c.SetTextBodyProperties,pageId:i,shapeId:r},Object(l.b)(d,f.fromMutationData(this.data)))]}check(e){const{pageId:t,shapeId:a,col:s,row:n}=this.data;return u.a.every(u.a.shape.should.existInPage(e,a,t),u.a.shape.should.hasTextBody(e,a,s,n))}constructor(...e){super(...e),this.type=n.c.SetTextBodyProperties}}},"98d30755dc":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("ad41a09b8f"),n=a("eb2ca81a32"),r=a("f5b046c378"),i=a("4289c697da"),o=a("ff9b6dacaf");class d extends o.a{get shapeList(){return this.store.shapeList.toArray()}forEachDescendantShapes(e,t=0){for(const[a,s]of this.shapeList.entries())s instanceof d?s.forEachDescendantShapes(e,a):e(s,a,this,t)}forEachDescendant(e=(()=>{})){this.forEachDescendantShapes(e)}getFrame(){var e,t;return i.b.fromTransform(null!==(t=null===(e=this.props.spPr)||void 0===e?void 0:e.xfrm)&&void 0!==t?t:{})}detach(){super.detach();for(const e of this.store.shapeList.toArray())e.detach();return this}constructor(e,t,a,i){super(t,a),this.parent=i,this.store=new n.a(e,this,t,a),this.props=new s.a(this.store.data,this.context),this.api=new r.a(this,t)}}},"9a7f061d14":function(e,t,a){"use strict";a.d(t,"b",(function(){return P})),a.d(t,"a",(function(){return j}));var s=a("311f2fc38c"),n=a("4f3b15d017"),r=a("a537f7f1aa"),i=a("7f1cfe4422"),o=a("925868c7f2"),d=a("5b34b47c3b"),c=a("5c5dc9725b"),l=a("8da3ae381a"),u=a("fdddc95d9b"),h=a("025e3e9b74"),p=a("668bd0ac65"),f=a("fe82ecf3fc"),g=a("262843d1f7"),m=a("026cc7da1f"),v=a("96459a5fec"),b=a("2f71c2f9fa"),y=a.n(b),I=a("1af4b2dbf4");const S="[SDK][CM][TTM]";var T;!function(e){e.Local="local",e.Collaboration="collaboration"}(T||(T={}));class x{get isTransforming(){return null!==this.transformPromise}addTask(e,t){this.logger.info("[SDK][Task]","add Task:",e,"type:",t),this.taskQueue.push({commands:e,taskType:t})}startTransform(){return this.transformPromise||(this.transformPromise=this.transform()),this.transformPromise}transform(){var e=this;return Object(s.a)((function*(){const t={followCollaborationCommands:[],followLocalCommands:[]};for(;e.taskQueue.length;){let a=[],s=[];const{commands:n,taskType:r}=e.taskQueue.shift(),i="collaboration"===r?n:t.followCollaborationCommands,o="local"===r?n:t.followLocalCommands;try{if(!i.filter((e=>{var t;return!!(null===(t=e.mutations)||void 0===t?void 0:t.length)})).length||!o.filter((e=>{var t;return!!(null===(t=e.mutations)||void 0===t?void 0:t.length)})).length)[a,s]=yield[i,o];else{e.logger.info(S,"continue transform:",i,o);const t=yield e.transformManager.transform(i,o,!1,f.c.Offline);a=t.transformedA,s=t.transformedB,e.logger.info(S,"transform success:",a,s)}"local"===r?(t.followCollaborationCommands=a,t.followLocalCommands.push(...s)):(t.followCollaborationCommands.push(...a),t.followLocalCommands=s)}catch(t){throw e.logger.error(S,"transform error:",t.toString()),e.taskQueue.splice(0,e.taskQueue.length),t}}return e.transformPromise=yield null,t}))()}constructor(e,t){this.transformManager=e,this.logger=t,this.transformPromise=null,this.taskQueue=[]}}class C{getRevision(){return this.userChanges[0].revision}getSize(){return this.currentSize}add(e){const t=e.findIndex((e=>!e.canCombine)),a=t>0?e.slice(0,t):e;this.userChanges.push(a[0]),a.slice(1).find((e=>{const t=this.getUserChangeSize(JSON.stringify(e));return this.currentSize+t>C.maxSize||(this.userChanges.push(e),this.currentSize+=t,!1)}))}setTaskId(e){this.id=e,this.userChanges.forEach((t=>t.combineTaskId=e))}getTaskId(){return this.id}getRawTaskId(){return this.userChanges.map((e=>e.taskId))}getRawUserChanges(){return this.userChanges}getUserChangeSize(e){let t=0,a=0;for(;t<e.length;){const s=e.slice(t,t+1024);a+=(new TextEncoder).encode(s).length,t+=1024}return a}constructor(){this.userChanges=[],this.id=-1,this.currentSize=0}}C.maxSize=1048576;var P,O=a("22cd640443");!function(e){e.Init="init",e.Ready="ready",e.Suspend="suspend"}(P||(P={}));const D="[SDK][CM]";class j{getSocket(){return this.socket}getRevision(){return this.revision}getPersistent(){return this.persistent}getSnapshot(){return this.snapshotManager}stopPollingTimer(){null!==this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null)}startPeriodicPolling(){this.pollingTimer||(this.pollingTimer=setInterval((()=>{this.pollingTimer&&this.checkAndApplyCommands()}),16))}submitBenchMarkCommand(){var e,t;const[a]=this.followLocalUserChanges,s=null===(e=this.revision.getSubmittingUserChange())||void 0===e?void 0:e.taskId;if(!this.socket.opened||s&&(s===a.taskId||s===a.combineTaskId))return;if(!(null===(t=a.command.mutations)||void 0===t?void 0:t.length)){const e=this.followLocalUserChanges.shift();return void this.persistent.deletionSingle(e.taskId)}if(!a.canCombine||1===this.followLocalUserChanges.length)return void this.revision.submitCommand([a.command],a.taskId);const n=this.createCombineUserChange();this.logger.info(D,"submit local userChange, combineTaskId:",n.getTaskId(),"taskId:",n.getRawTaskId(),"revision",n.getRevision(),n.getRawUserChanges(),"size",n.getSize()/1024,"KB"),this.persistent.replaceAllData(this.followLocalUserChanges.map((({taskId:e,command:t,source:a,canCombine:s,revision:r})=>{var i;return this.createMutationsPack(I.a.fromMutationData(null!==(i=t.mutations)&&void 0!==i?i:[]).getValidMutationData(),r,e,a,s,n.getTaskId())}))),this.revision.submitCommand(n.getRawUserChanges().map((({command:e})=>e)),n.getTaskId())}createCombineUserChange(){const e=new C;return e.add(this.followLocalUserChanges.slice()),e.setTaskId(this.getNextCombineTaskId()),e}checkAndApplyCommands(){if(this.transformTaskManager.isTransforming||!this.collaborationUserChanges.length&&!this.followLocalUserChanges.length)return;if(!this.collaborationUserChanges.length&&this.followLocalUserChanges.length)return this.handleAbnormalSubmittingUserChange(),void this.submitBenchMarkCommand();Object(m.assert)(this.collaborationUserChanges.length,"collaborationUserChanges.length should not be 0");const[e]=this.collaborationUserChanges,t=this.transformRev+1;if((null==e?void 0:e.revision)!==t){if(this.hasRetried)return;if(this.hasRetried=!0,(null==e?void 0:e.revision)<t){const e=this.collaborationUserChanges.shift();this.logger.info(D,"collaborationUserChange.revision",null==e?void 0:e.revision,"<",t,", drop it")}return this.logger.warn(D,"need ",t," try to fetch it"),void this.revision.getMissingChanges(t,t,v.a.Transform).then((e=>{this.hasRetried=!1,this.handleNewUserChanges(e)}))}if(!this.followLocalUserChanges.length){var a;const{command:t,taskId:s,revision:n}=e;if(this.logger.info(D,"no conflict, apply collaboration",s,"revision:",n,t.mutations),null===(a=t.mutations)||void 0===a?void 0:a.length){if(!this.applyCommandData(t,u.a.Collaborator))return}return this.collaborationUserChanges.shift(),void this.revision.updateRevisionNumber(n)}const s=(()=>{var e,t;return(null===(e=this.revision.getSubmittingUserChange())||void 0===e?void 0:e.taskId)||this.submitBenchMarkCommand(),null===(t=this.revision.getSubmittingUserChange())||void 0===t?void 0:t.taskId})();this.logger.info(D,"benchMarkTaskId is:",s,"cur collaboration taskId is",e.taskId);if(s&&(e.taskId===s||e.combineTaskId===s))return this.collaborationUserChanges.shift(),void this.handleBenchmarkCommand(s,e.revision);this.handleMergeConflict(e)}handleBenchmarkCommand(e,t){const a=y()(this.followLocalUserChanges,(t=>t.taskId===e||t.combineTaskId===e));a<0||(this.followLocalUserChanges.splice(0,a+1),this.acceptCommit(e,t))}acceptCommit(e,t){this.persistent.replaceAllData(this.followLocalUserChanges.map((({taskId:e,command:a,source:s,canCombine:n,combineTaskId:r})=>{var i;return this.createMutationsPack(I.a.fromMutationData(null!==(i=a.mutations)&&void 0!==i?i:[]).getValidMutationData(),t,e,s,n,r)}))),this.followLocalUserChanges.forEach((e=>{e.revision=t})),this.revision.updateRevisionNumber(t),this.logger.info(D,"acceptCommit, taskId:",e,"benchmarkRev",t,",wait to send count",this.followLocalUserChanges.length),this.revision.resetSubmittingUserChange()}handleMergeConflict(e){var t=this;return Object(s.a)((function*(){const a=t.followLocalUserChanges.map((({command:e,taskId:a})=>t.commandToTransformCommand(e,a))),s=[t.commandToTransformCommand(e.command,e.taskId)];t.transformTaskManager.addTask(s,T.Collaboration),t.transformTaskManager.addTask(a,T.Local),t.logger.info(D,"start transform");let n=[],r=[];try{const e=yield t.transformTaskManager.startTransform();n=e.followCollaborationCommands.map(t.transformCommandToCommand),r=e.followLocalCommands.map(t.transformCommandToCommand)}catch(e){return void t.handleAndDispatchFatalError()}t.logger.info(D,"end transform"),t.logger.info(D,"updated followLocalUserChanges:",t.followLocalUserChanges,r),r.forEach(((e,a)=>{t.followLocalUserChanges[a].command=e}));for(const e of n){var i;if(!(null===(i=e.mutations)||void 0===i?void 0:i.length))continue;if(!t.applyCommandData(e,u.a.CollaboratorConflict))return}t.collaborationUserChanges.shift(),t.setTransformRev(t.transformRev+1),t.handleAbnormalSubmittingUserChange()}))()}init(){this.changeCollaborationStatus("init");const{globalPadId:e,userId:t}=this.clientVarsProvider.getClientVars();this.logger.info(D,"[init]",`globalPadId:${e}, userId:${t}`),this.initSocket(),this.initRevision(),this.initPersistent(),this.setTransformRev(this.revision.getRevisionNumber()),this.onCollaborationReady((()=>{this.startPeriodicPolling(),this.readyToOpenSocket()}))}addPresentationEventListeners(){this.event.on(h.e.SubmitMutations,this.submitMutations);const e=this.event.on(h.e.CommitCommand,((t,a,s)=>{[u.a.Collaborator,u.a.CollaboratorConflict].includes(s)&&(this.transformManager.initSyncTransformer(),e())}))}addRevisionEventListeners(){this.event.on(h.f.CommitFail,this.handleRevisionCommitFailed),this.event.on(h.f.CommitSucceed,this.handleRevisionCommitSucceed),this.event.on(h.f.UpdateBaseRevision,this.setTransformRev),this.event.on(h.f.FetchMissingDataError,(()=>this.handleFatalError(i.d.None)))}addPersistentEventListeners(){this.event.on(h.d.GetAllMutationsPacks,this.handlePersistentGetAllMutationsPacks)}addSocketEventListeners(){this.event.on(h.g.RevertMessage,(()=>{this.logger.error(D,"shutdown by revert doc"),this.handleFatalError(i.d.None)}))}addOTTransformEventListeners(){this.event.on(h.c.TransformError,((e,t)=>{this.logger.error(D,"shutdown by otTransform error:",t),this.handleFatalError(i.d.None)}))}addCommandEventListeners(){this.event.on(h.b.Error,(()=>this.handleAndDispatchFatalError()))}registerEvent(){this.addPresentationEventListeners(),this.addRevisionEventListeners(),this.addPersistentEventListeners(),this.addSocketEventListeners(),this.addOTTransformEventListeners(),this.addCommandEventListeners()}initSocket(){if(!this.socket){var e;const t=this.clientVarsProvider.getClientVars();this.socket=new l.a(t,{},this.event,this.logger);const{collab_client_vars:a,userId:s}=t;this.socket.init({serverVars:a,userId:s,uid:this.getUid(),nowUserIndex:null===(e=this.clientVarsProvider.getClientVars().userInfo)||void 0===e?void 0:e.nowUserIndex,headerGeneralPacket:{right_tag:Number(!!this.privilegeProvider.editable),platform:this.getPlatformType()}})}}initRevision(){if(!this.revision){var e;this.revision=new o.a(this,this.socket,this.event,this.logger);const{userId:a,subId:s,collab_client_vars:n}=null!==(e=this.clientVarsProvider.getClientVars())&&void 0!==e?e:{};var t;this.revision.init({uuId:a,subId:s,oSubId:!0,baseRev:null==n?void 0:n.rev,globalPadId:null==n?void 0:n.globalPadId,xsrf:null!==(t=this.getCookie("TOK"))&&void 0!==t?t:""})}}initPersistent(){if(!this.persistent){this.persistent=new r.a(this.event,this.logger,this.offlineEditServiceProvider);const{globalPadId:e,localPadId:t,userId:a}=this.clientVarsProvider.getClientVars(),s={globalPadId:e,localPadId:t,userId:a,editable:this.privilegeProvider.editable,revision:this.revision.getRevisionNumber()},n=this.persistent.init(s).catch((e=>{this.logger.error(D,"uncaught persistent init error",e.toString())})).then((e=>!!(null==e?void 0:e.length)));this.contentStatusManager.onDocumentReady((()=>{n.then((e=>{e&&this.persistent.startToRecovery()})).finally((()=>{this.changeCollaborationStatus("ready")}))}))}}applyMutationPacks(e){this.logger.info(`${D} no need transform offline mutationsPacks, length ${e.length}`);for(const{mutations:t}of e){const e=I.a.fromValidMutationData(t).getCommandData();if(!this.applyCommandData(e,u.a.Offline))return}return this.submitOfflineMutations(e)}transformAndApplyMutationPacks(e,t){var a=this;return Object(s.a)((function*(){const s=e.map((({taskId:e,source:t,revision:a,mutations:s,canCombine:n})=>({taskId:e,source:t,revision:a,command:I.a.fromValidMutationData(s).getCommandData(),canCombine:n})));a.logger.info(D,s[0].revision,"transform to",t[t.length-1].revision,s.map((({command:e})=>e)),t);for(let e=0;e<t.length;e++){const n=t[e];if(!s.length)break;if(n.taskId!==s[0].taskId)try{const e={mutations:new p.a({presentation:n.keyframe}).getCommandData().mutations};let t=s.map((({command:e})=>e));a.logger.info(D,"transform offlineData",t,e);const r=yield a.transformManager.transform(t,[e],!0,f.c.Offline);t=r.transformedA,s.forEach(((e,a)=>e.command=t[a]))}catch(e){throw a.logger.error(D,"transform offlineData error:",e.toString()),a.handleAndDispatchFatalError(!0),e}else s.shift(),a.persistent.replaceAllData(s.map((({taskId:e,source:t,command:a,canCombine:s})=>{var r;return{taskId:e,source:t,mutations:I.a.fromMutationData(null!==(r=a.mutations)&&void 0!==r?r:[]).getValidMutationData(),revision:n.revision,canCombine:s}}))),a.reportCommitStatus(O.a.SUCCESS,u.a.Editor)}a.logger.info(D,"transform offlineData success",s.map((({command:e})=>e)));const n=[];for(const e of s){const t=e.command.mutations;if(!(null==t?void 0:t.length)){n.push(e.taskId);continue}if(!a.applyCommandData({mutations:t},u.a.Offline))return}return a.persistent.deletionMultiple(n),a.submitOfflineMutations(s.filter((e=>!n.includes(e.taskId))).map((({taskId:e,revision:t,command:a,canCombine:s})=>{var n;return{taskId:e,revision:t,mutations:I.a.fromMutationData(null!==(n=a.mutations)&&void 0!==n?n:[]).getValidMutationData(),source:u.a.Offline,canCombine:s}})))}))()}submitOfflineMutations(e){var t=this;return Object(s.a)((function*(){if(!e.length)return;e.forEach((e=>{e.revision=t.revision.getRevisionNumber(),e.source=u.a.Offline}));(yield t.persistent.replaceAllData(e))&&e.forEach((e=>{if(t.logger.info(D,"new localChange, taskId",e.taskId,"revision",e.revision,"source",e.source,e.mutations),t.addMutationPacksToFollowLocalUserChanges([e]),t.transformTaskManager.isTransforming){const a=I.a.fromValidMutationData(e.mutations).getCommandData();t.transformTaskManager.addTask([t.commandToTransformCommand(a,e.taskId)],T.Local)}}))}))()}createMutationsPack(e,t,a,s,n=false,r){return{mutations:e,revision:t,taskId:a,source:s,canCombine:n,combineTaskId:r}}addMutationPacksToFollowLocalUserChanges(e){const t=e.map((({mutations:e,taskId:t,revision:a,source:s,canCombine:n})=>({command:I.a.fromValidMutationData(e).getCommandData(),taskId:t,revision:a,source:s,canCombine:n})));this.followLocalUserChanges.push(...t)}getPlatformType(){return n.default.isWindows?1:n.default.isAndroid?2:n.default.isIOS?3:n.default.isMac?5:4}getCookie(e){const t=new RegExp(`(?:^|;+|\\s+)${e}=([^;]*)`),a=document.cookie.match(t);return(a?a[1]:"")||null}reportCommitStatus(e,t,a,s){var n,r,i,o;var d,c;null===(r=this.logger.monitor)||void 0===r||null===(n=r.reportStatus)||void 0===n||n.call(r,"关键请求失败",e,a,[t,null!==(d=null==s?void 0:s.toString())&&void 0!==d?d:"","ignore",null!==(c=this.clientVarsProvider.getClientVars().globalPadId)&&void 0!==c?c:""]),null===(o=this.logger)||void 0===o||null===(i=o.getPrototype)||void 0===i||i.call(o).report("SEND_REPORT",{query:{startTs:Date.now()-864e5,endTs:Date.now()}})}getUid(){const e=window;return(null===(s=e.basicClientVars)||void 0===s||null===(a=s.userInfo)||void 0===a?void 0:a.uid)||(()=>{var t,a,s;return(null===(s=e.AppConfig)||void 0===s||null===(a=s.normal)||void 0===a||null===(t=a.npm["@tencent/docs-login"])||void 0===t?void 0:t.USE_TDOCS_UID)?this.getCookie("TDOCS_UID"):this.getCookie("uid")})()||(null===(t=e.global_multi_user)||void 0===t?void 0:t.uid)||(()=>{var e;const{tinyId:t,uid:a}=(null===(e=this.clientVarsProvider.getClientVars())||void 0===e?void 0:e.userInfo)||{};return t||a})();var t,a,s}commandToTransformCommand(e,t){return{seq:t.toString(),mutations:e.mutations}}transformCommandToCommand(e){return{mutations:e.mutations}}getNextCombineTaskId(){return this.combineTaskId+=1,this.combineTaskId}handleAbnormalSubmittingUserChange(){const e=this.revision.getSubmittingUserChange(),t=null==e?void 0:e.getStatus();var a;const s=null!==(a=null==e?void 0:e.getExpectedRev())&&void 0!==a?a:-1;!e||t!==d.b.BaseRevTooLow||this.transformRev<s||(this.logger.info(D,"taskId",e.taskId,"has solved the problem of too low version","from",e.revision,"upgrade to",this.transformRev),this.persistent.replaceAllData(this.followLocalUserChanges.map((({taskId:e,command:t,source:a,canCombine:s,combineTaskId:n})=>{var r;return this.createMutationsPack(I.a.fromMutationData(null!==(r=t.mutations)&&void 0!==r?r:[]).getValidMutationData(),this.transformRev,e,a,s,n)}))),this.followLocalUserChanges.forEach((e=>{e.revision=this.transformRev})),this.revision.updateRevisionNumber(this.transformRev),this.revision.resetSubmittingUserChange())}readyToOpenSocket(){this.clientVarsProvider.isLocalDoc()||this.socket.open()}constructor(e,t,a,n,r,o,d,l){this.presentationProvider=e,this.clientVarsProvider=t,this.contentStatusManager=a,this.transformManager=n,this.event=r,this.logger=o,this.privilegeProvider=d,this.offlineEditServiceProvider=l,this.taskId=Object(g.h)(),this.combineTaskId=Object(g.h)(),this.collaborationUserChanges=[],this.followLocalUserChanges=[],this.hasRetried=!1,this.setTransformRev=e=>{this.transformRev=e},this.getUserChangeFromLocalCache=e=>this.followLocalUserChanges.find((({taskId:t})=>t===e)),this.getUserChangeFromRemoteCache=e=>this.collaborationUserChanges.find((({taskId:t})=>t===e)),this.handleNewUserChanges=e=>{for(const t of e){const e=this.transformRev+1;if(t.revision<e)continue;this.collaborationUserChanges.find((({taskId:e})=>e===t.taskId))||(this.logger.info(D,"add userChange, taskId:",t.taskId,"revision",t.revision),this.collaborationUserChanges.push({taskId:t.taskId,revision:t.revision,command:new p.a({presentation:t.keyframe}).getCommandData(),source:u.a.Collaborator}),this.collaborationUserChanges.sort(((e,t)=>e.revision-t.revision)))}},this.addNativeOfflineDataToQueue=e=>{const t=e.map((({mutations:e,revision:t,taskId:a,canCombine:s})=>({mutations:e,revision:t,taskId:a,source:u.a.Offline,canCombine:s})));this.logger.info(D,"addNativeOfflineDataToQueue",t.length),this.addMutationPacksToFollowLocalUserChanges(t)},this.suspendAllChanges=()=>{this.stopPollingTimer(),this.changeCollaborationStatus("suspend")},this.resumeAllChanges=()=>{this.startPeriodicPolling(),this.changeCollaborationStatus("ready")},this.onCollaborationReady=e=>{if("ready"===this.status)return void e();const t=this.event.on(h.a.StatusChange,(a=>{if("ready"===a)return t(),void e()}))},this.changeCollaborationStatus=e=>{this.status=e,this.event.emit(h.a.StatusChange,e)},this.applyCommandData=(e,t)=>{try{return this.presentationProvider.applyCommandData(e,t),!0}catch(e){return this.handleAndDispatchFatalError(t===u.a.Offline),!1}},this.handleFatalError=(e=60003)=>{this.stopPollingTimer(),this.socket.close("handleFatalError",e)},this.handleAndDispatchFatalError=(e=!1)=>{this.handleFatalError(i.d.None),this.event.emit(h.a.FatalError,e)};var f,m=this;this.handleRevisionCommitSucceed=(f=Object(s.a)((function*(e){const{taskId:t,baseRev:a,newRev:s}=null!=e?e:{};if(!t||void 0===s||void 0===a)return;const n=m.followLocalUserChanges.find((({taskId:t})=>t===(null==e?void 0:e.taskId)));if(n&&m.reportCommitStatus(O.a.SUCCESS,n.source),m.logger.info(D,"submit success, taskId:",t,"newRev:",s),m.transformRev>=s)return void m.logger.info(D,`response ${null==e?void 0:e.taskId} too slow, already accept it, ignore`);if(a+1===s)return void m.handleBenchmarkCommand(t,s);const r=yield m.revision.getMissingChanges(m.transformRev+1,s,v.a.CommitSuccess);m.handleNewUserChanges(r)})),function(e){return f.apply(this,arguments)}),this.handleRevisionCommitFailed=({taskId:e,code:t,message:a,source:s,error:n})=>{if(s===c.a.Room||n===i.d.None)return;if(!!this.followLocalUserChanges.find((({combineTaskId:t,canCombine:a})=>a&&t===e)))return this.logger.warn(D,"combineTaskId:",e,"commit error, split it and reSend"),this.followLocalUserChanges.forEach((t=>{t.combineTaskId===e&&(t.canCombine=!1,t.combineTaskId=void 0)})),this.persistent.replaceAllData(this.followLocalUserChanges.map((({taskId:e,command:t,source:a,canCombine:s,revision:n})=>{var r;return this.createMutationsPack(I.a.fromMutationData(null!==(r=t.mutations)&&void 0!==r?r:[]).getValidMutationData(),n,e,a,s)}))),void this.revision.resetSubmittingUserChange();this.persistent.modifyErrorInfo(e,t);const r=this.followLocalUserChanges.find((({taskId:e})=>e==e));r&&this.reportCommitStatus(O.a.ERROR,r.source,a,t),this.logger.warn(D,`Send failed, taskId:${e}, code:${t}`)};var b=this;this.handlePersistentGetAllMutationsPacks=function(){var e=Object(s.a)((function*({mutationsPacks:e},t){const a=[...e];if(a[0].sendedCount>3)return b.logger.warn(D,"offline data retried exceed max limit, need drop it"),void b.handleAndDispatchFatalError(!0);const s=a[0].revision,n=s<b.revision.getRevisionNumber();b.logger.info(D,"offline version is",s,"latest version is",b.revision.getRevisionNumber());const r=n?yield b.revision.getMissingChanges(s+1,b.revision.getRevisionNumber(),v.a.Offline):[];if(null==a?void 0:a.length){const e=r.filter((({revision:e})=>e>=s));e.length?yield b.transformAndApplyMutationPacks(a,e):yield b.applyMutationPacks(a)}t()}));return function(t,a){return e.apply(this,arguments)}}(),this.submitMutations=({mutations:e,source:t})=>{if(!e.length)return;this.taskId+=1;const a=this.createMutationsPack(e.map((e=>e.toData())),this.revision.getRevisionNumber(),this.taskId,t);if(this.persistent.additionOrUpdate(a),this.logger.info(D,"new localChange, taskId",a.taskId,"revision",a.revision,"source",`"${a.source}"`,a.mutations),this.addMutationPacksToFollowLocalUserChanges([a]),this.transformTaskManager.isTransforming){const e=I.a.fromValidMutationData(a.mutations).getCommandData();this.transformTaskManager.addTask([this.commandToTransformCommand(e,a.taskId)],T.Local)}},this.transformTaskManager=new x(this.transformManager,this.logger),this.registerEvent(),this.init()}}},a08260f523:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("711a53c9fc");function n(e){return!function(e){return[s.c.AddPage,s.c.RemovePage,s.c.SetPageProperties].includes(e.type)}(e)&&!!Reflect.get(e,"pageId")}},a5bb88f217:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("025e3e9b74");function n(e){return t=>{e.emit(s.e.RequestBeginTransaction);try{t()}catch(e){throw e}finally{e.emit(s.e.RequestEndTransaction)}}}},a5f49151bb:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("2f766f71b0"),i=a.n(r),o=a("711a53c9fc"),d=a("30fae44285");var c=a("03420c1dd4"),l=a("7b62e570e0"),u=a("a6cf5e8204");const h="{58542034-FE4F-4ADA-92B8-4CA66D0F0DF3}";function p(e,t={}){const a={presentation:e,options:t,idFactory:e=>e},s=e.themeList.map((e=>function(e){var t,a;return[{type:o.c.AddTheme,themeId:e.id,themeName:null!==(t=e.name)&&void 0!==t?t:"",themeElements:null!==(a=e.themeElements)&&void 0!==a?a:{}}]}(e))),n=e.masterList.map(((e,t)=>Object(c.b)(e,t,a))),r=e.slideList.map(((e,t)=>Object(c.f)(e,t,a))),d=Object.values(e.sectionMap).map((e=>Object(l.a)(e,a))),h=Object.values(e.notesMasterMap).map((e=>Object(c.c)(e,a))),p=Object(u.a)(e.resourceMap,a);return i()([f(e,a),i()(p),i()(s),i()(n),i()(h),i()(r),i()(d)])}function f(e,t){var a;const{tblStyle:r}=null!==(a=e.tblStyleList)&&void 0!==a?a:{},i=null==r?void 0:r.some((e=>e.styleId===h));return[{type:o.c.SetSlideSize,size:e.sldSz},{type:o.c.SetPresentationProperties,defaultTextStyle:e.defaultTextStyle,tableStyleList:Object(n.a)(Object(s.a)({},e.tblStyleList),{tblStyle:i?r:(null!=r?r:[]).concat(d.tblStyleList.tblStyle.slice(0,1))}),embeddedFontList:e.embeddedFontList,showSpecialPlsOnTitleSld:e.showSpecialPlsOnTitleSld,firstSlideNum:e.firstSlideNum,slideGuideList:e.slideGuideList&&{guide:e.slideGuideList}},{type:o.c.SetNotesSize,size:e.notesSz}]}},a6cf5e8204:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("711a53c9fc"),n=a("215eaa3247");const r={idFactory:e=>e};function i(e,t=r){const a=[];for(const[r,i]of Object.entries(e.images))a.push({type:s.c.UpdateResourceMap,id:t.idFactory(r),resourceType:s.e.Image,imageDescriptor:Object(n.b)(i,"id")});for(const[r,i]of Object.entries(e.videos))a.push({type:s.c.UpdateResourceMap,id:t.idFactory(r),resourceType:s.e.Video,videoDescriptor:Object(n.b)(i,"id")});for(const[r,i]of Object.entries(e.audios))a.push({type:s.c.UpdateResourceMap,id:t.idFactory(r),resourceType:s.e.Audio,audioDescriptor:Object(n.b)(i,"id")});for(const[r,i]of Object.entries(e.fonts))a.push({type:s.c.UpdateResourceMap,id:t.idFactory(r),resourceType:s.e.Font,fontDescriptor:Object(n.b)(i,"id")});return a}},a74785d12e:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("026cc7da1f"),i=a("6f5f1758fe"),o=a("b41b5d48f6"),d=a("7c46f42788"),c=a("2ba82388a5");class l extends i.a{apply(e){if(!this.data.shapeId)return;const{shapeId:t,drawing:a}=this.data,s=e.store.models.get(t,d.a.GraphicalObjectFrameSmartArt);Object(r.assert)(s,"shape should exist"),s&&s.store.setDiagramDrawing(a)}invert(e){var t;const{pageId:a,shapeId:i}=this.data,o=e.store.models.get(i,d.a.GraphicalObjectFrameSmartArt);return Object(r.assert)(o,"shape should exist"),[Object(s.a)({type:n.c.SetDiagramDrawing,pageId:a,shapeId:i},Object(c.b)({drawing:null===(t=o.store.data.diagram)||void 0===t?void 0:t.drawing},{drawing:this.data.drawing},{drawing:!0}))]}check(e){const{pageId:t,shapeId:a}=this.data;return o.a.every(o.a.shape.should.existInPage(e,a,t))}constructor(...e){super(...e),this.type=n.c.SetDiagramDrawing}}},b1e48913f8:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("93085721b7"),n=a("7b6d479165"),r=a("aa91328c62"),i=a("969172f78b"),o=a("e5b2319967");class d extends o.a{get note(){return this.store.note}getSlide(){return this.context.getSlide()}constructor(e,t,a){super(t,a),this.parent=a,this.context=new s.a(e.type),this.store=new n.a(e,t,this.context,this),this.props=new r.a(this.store.data,this.context),this.api=new i.a(this,t),this.context.setPresentation(this.parent),this.context.setPage(this),this.context.setTarget(this);const o=a.store.slideList.findById(e.slideId);this.context.setSlide(o)}}},b41b5d48f6:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("67d3be6cf9"),i=a.n(r),o=a("f84a91093c"),d=a.n(o),c=a("7c46f42788"),l=a("fce1cf19ce"),u=a("daff531963"),h=a("b56763d092"),p=a("618a7d794a");const f={every:(...e)=>{for(const t of e){const e="function"==typeof t?t():t;if(e)return e}},forEach:(e,t)=>{for(const a of e){const e=t(a);if(e)return e}},model:{should:{notExist:(e,t)=>{const a=e.getModel(t);if(a)return Object(p.a)({id:t,type:c.a[a.type]})}}},page:{should:{exist:(e,t,a)=>{const n=e.getModel(t,...a?[c.b.fromSTPageType(a)]:c.c);return n?n.store.spTree?void 0:Object(p.f)({pageId:t,pageType:s.Q[null!=a?a:0]}):Object(p.c)({pageId:t,pageType:a&&s.Q[a]})},haveNoStaleReference:(e,t)=>{const a=e.getModel(t,...c.c);if(!a)return Object(p.c)({pageId:t});if(a.type===c.a.SlideLayout){const s=e.slideList.find((e=>{var a;return(null===(a=e.getLayout())||void 0===a?void 0:a.id)===t}));if(s)return Object(p.g)({layout:a.id,refs:{slide:s.id}})}if(a.type===c.a.SlideMaster){const s=e.layoutList.find((e=>{var a;return(null===(a=e.getMaster())||void 0===a?void 0:a.id)===t}));if(s)return Object(p.g)({master:a.id,refs:{layout:s.id}})}if(a.type===c.a.NotesMaster){const t=e.noteSlideMap.size;if(t)return Object(p.g)({noteMaster:a.id,refs:{nodeSlideSize:t}})}}},can:{insertIntoMasterList:(e,t,a)=>{const{length:s}=e.masterList;if(a>s)return Object(p.b)({insertMasterId:t,position:a,length:s})},insertIntoLayoutIdList:(e,t,a,r)=>{const i=f.page.should.exist(e,a,s.Q.slideMaster);if(i)return i;const o=e.getModel(a,c.a.SlideMaster);Object(n.assert)(o,"master should exist");const{length:d}=o.layoutList;return r>d?Object(p.b)({layoutIdToInsert:t,masterId:a,position:r,length:d}):void 0},insertIntoSlideList:(e,t,a)=>{const{length:s}=e.slideList;if(a>s)return Object(p.b)({insertSlideId:t,position:a,length:s})}}},pageList:{should:{containMasterInPosition(e,t,a){if(t<0||t>=e.masterList.length)return Object(p.e)({masterId:a,position:t});if(!a)return;const n=f.page.should.exist(e,a,s.Q.slideMaster);return n||(e.masterList[t].id!==a?Object(p.d)({masterId:a,position:t}):void 0)},containLayoutInPosition(e,t,a,r){let i=f.page.should.exist(e,t,s.Q.slideMaster);if(i)return i;const o=e.getModel(t,c.a.SlideMaster);return Object(n.assert)(o,"master should exist"),a<0||a>=o.layoutList.length?Object(p.e)({layoutId:r,masterId:t,position:a}):r?(i=f.page.should.exist(e,r,s.Q.slideLayout),i||(o.layoutList[a].id!==r?Object(p.d)({layoutId:r,masterId:t,position:a}):void 0)):void 0},containSlideInPosition(e,t,a){if(t<0||t>=e.slideList.length)return Object(p.e)({slideId:a,position:t});if(!a)return;const n=f.page.should.exist(e,a,s.Q.slide);return n||(e.slideList[t].id!==a?Object(p.d)({slideId:a,position:t}):void 0)}}},groupShape:{can:{insertShapeToPosition(e,t,a,s){const n=e.getModel(t,c.a.GroupShape);return n?a<0||a>n.shapeList.length?Object(p.l)({groupShapeId:t,position:a,shapeIdToInsert:s}):s===t?Object(p.u)({groupShapeId:t,position:a,shapeIdToInsert:s}):void 0:Object(p.q)({groupShapeId:t})}}},shape:{should:{existInPage:(e,t,a)=>{const s=f.page.should.exist(e,a);if(s)return s;const n=e.getModel(t,...c.d);return n?n.getPage().id!==a?Object(p.r)({shapeId:t,pageId:a}):void 0:Object(p.q)({shapeId:t})},hasPlaceholder:(e,t)=>{const a=e.getModel(t,c.a.Shape);if(!a)return Object(p.q)({shapeId:t,shapeType:c.a[c.a.Shape]});return a.getRelatedPlaceholder()?void 0:Object(p.t)({shapeId:t})},hasTextBody:(e,t,a,s)=>{var n,r,i,o,l,u,h;const f=e.getModel(t,c.a.Shape,c.a.GraphicalObjectFrameTable);if(!f)return Object(p.q)({shapeId:t});const g=f.props.type;g===c.a.Shape&&f.props.txBody||g===c.a.GraphicalObjectFrameTable&&d()(a)&&d()(s)&&a>0&&s>0&&(null===(h=f.props.graphic)||void 0===h||null===(u=h.graphicData)||void 0===u||null===(l=u.tbl)||void 0===l||null===(o=l.tr)||void 0===o||null===(i=o[s])||void 0===i||null===(r=i.tc)||void 0===r||null===(n=r[a])||void 0===n||n.txBody)},matchShapeListInPosition(e,t,a,s){const n=e.getModel(t,c.a.GroupShape);if(!n)return Object(p.q)({groupShapeId:t});const r=n.store.shapeList.toArray().map((e=>e.id));if(a+s.length>r.length)return Object(p.n)({groupShapeId:t,index:a,childShapeIds:s});for(let e=0;e<s.length;e++)if(s[e]!==r[a+e])return Object(p.s)({childShapeIds:s,shapeIds:r,groupShapeId:t,startIndex:a})}},is:{childOfShapeTreeRoot:(e,t,a,s)=>{const n=f.shape.should.existInPage(e,t,a);if(n)return n;const r=e.getModel(t,...c.d),i=e.getModel(a,...c.e);return(null==r?void 0:r.parent)!==(null==i?void 0:i.store.getShapeTree())?Object(p.p)({shapeId:t,pageId:a}):void 0!==s&&(null==i?void 0:i.store.getShapeTree().store.shapeList.findIndexById(t))!==s?Object(p.s)({shapeId:t,pageId:a,index:s}):void 0},childOfGroupShape:(e,t,a)=>{const s=e.getModel(t,...c.d);if(!s)return Object(p.q)({shapeId:t});if(void 0!==a){const s=e.getModel(a,c.a.GroupShape);if(!s)return Object(p.q)({groupShapeId:a});if(!s.store.shapeList.findById(t))return Object(p.o)({shapeId:t,groupShapeId:a})}else if(s.parent.type!==c.a.GroupShape)return Object(p.o)({shapeId:t,parentType:s.parent.type})},typeOf:(e,t,a)=>{const s=e.getModel(t,...c.d);if((null==s?void 0:s.type)!==a)return Object(p.v)({shapeId:t,shapeType:a})},notTypeOf:(e,t,...a)=>{const s=e.getModel(t,...c.d);for(const e of a)if((null==s?void 0:s.type)===e)return Object(p.m)({shapeId:t,shapeType:e})}}},table:{range:{is:{noMergedRange:(e,t,a)=>{const s=e.getModel(t,c.a.GraphicalObjectFrameTable);if(!s)return Object(p.q)({shapeId:t});const{startRowIndex:n,startColIndex:r,rowSpan:i,colSpan:o}=a;if(1===i&&1===o)return Object(p.K)({startRowIndex:n,startColIndex:r});for(let e=n;e<n+i;e+=1)for(let n=r;n<r+o;n+=1){var d,l,u,h,f,g;const r=null===(g=s.store.data.graphic)||void 0===g||null===(f=g.graphicData)||void 0===f||null===(h=f.tbl)||void 0===h||null===(u=h.tr)||void 0===u||null===(l=u[e])||void 0===l||null===(d=l.tc)||void 0===d?void 0:d[n];if((null==r?void 0:r.hMerge)||(null==r?void 0:r.vMerge)||(null==r?void 0:r.rowSpan)||(null==r?void 0:r.gridSpan))return Object(p.J)({shapeId:t,range:a})}},singleMergedRange:(e,t,a)=>{var s,n,r,i,o,d;const l=e.getModel(t,c.a.GraphicalObjectFrameTable);if(!l)return Object(p.q)({shapeId:t});const{startRowIndex:u,startColIndex:h,rowSpan:f,colSpan:g}=a,m=null===(d=l.store.data.graphic)||void 0===d||null===(o=d.graphicData)||void 0===o||null===(i=o.tbl)||void 0===i||null===(r=i.tr)||void 0===r||null===(n=r[u])||void 0===n||null===(s=n.tc)||void 0===s?void 0:s[h];var v,b;return(null!==(v=null==m?void 0:m.rowSpan)&&void 0!==v?v:1)!==f||(null!==(b=null==m?void 0:m.gridSpan)&&void 0!==b?b:1)!==g?Object(p.O)({shapeId:t,range:a}):void 0}}},can:{addRowOrCol:(e,t,a,s,n,r)=>{const i=e.getModel(t,c.a.GraphicalObjectFrameTable);if(!i)return Object(p.q)({shapeId:t});if(s<=0)return Object(p.z)({shapeId:t});const o=n?i.rowLength:i.colLength;if(a<0||a>o)return Object(p.A)({index:a,length:o});for(const e of r){const r=n?e.startRowIndex:e.startColIndex,i=n?e.rowSpan:e.colSpan;if(a>r&&a<r+i)return n?Object(p.I)({shapeId:t,index:a,count:s}):Object(p.H)({shapeId:t,index:a,count:s})}},deleteRowOrCol:(e,t,a,s,n,r)=>{const i=e.getModel(t,c.a.GraphicalObjectFrameTable);if(!i)return Object(p.q)({shapeId:t});const o=n?i.colLength:i.rowLength,d=n?"col":"row";if(s>=o)return Object(p.B)({index:a,length:o});if(s<=0||a+s>o)return Object(p.E)({shapeId:t,delete:{[d]:{index:a,count:s}},length:o});if(a<0||a>o)return Object(p.F)({shapeId:t,delete:{[d]:{index:a,count:s}},length:o});for(const e of r){const r=n===u.a.ROW,i=r?e.startRowIndex:e.startColIndex,o=r?e.rowSpan:e.colSpan;if(a+s>i&&a<i+o)return r?Object(p.D)({shapeId:t,index:a,count:s}):Object(p.C)({shapeId:t,index:a,count:s})}},mergeTableCells:(e,t,a)=>{const s=e.getModel(t,c.a.GraphicalObjectFrameTable);if(!s)return Object(p.q)({shapeId:t});const n=Object(h.d)(s.rowLength,s.colLength,a);return n===p.G.TableRangeExistNullError?Object(p.L)({shapeId:t}):n===p.G.TableRangeLessZeroError?Object(p.M)({shapeId:t}):n===p.G.TableRangeOutOfLengthError?Object(p.N)({shapeId:t}):void 0},setTableCells:(e,t,a)=>{const s=e.getModel(t,c.a.GraphicalObjectFrameTable);if(!s)return Object(p.q)({shapeId:t});const{startRowIndex:n,startColIndex:r,rowSpan:o,colSpan:d}=a;return i()(n)||i()(r)||!o||!d?Object(p.L)({shapeId:t}):Math.min(d,o)<=0?Object(p.M)({shapeId:t}):n+o>s.rowLength||r+d>s.colLength?Object(p.N)({shapeId:t}):void 0}}},section:{can:{insertIntoGapPosition:(e,t,a)=>{if(void 0===a)return;const s=e.slideList.length+e.sectionList.length;return a<0||a>s?Object(p.j)({position:a,sectionName:t,totalLength:s}):void 0},bindSlide:(e,t)=>{const{length:a}=e.slideList;if(t<0||t>a)return Object(p.i)({slideIndex:t,length:a})}},should:{exist:(e,t)=>{if(!e.getModel(t,c.a.Section))return Object(p.k)({sectionId:t})}}},chart:{should:{subChartExist:(e,t,a,s)=>{const r=f.page.should.exist(e,t);if(r)return r;const i=e.getModel(a,c.a.GraphicalObjectFrameChart);Object(n.assert)(i,"chart should exist");return i.getSubChart(s)?void 0:Object(p.w)({shapeId:a,pageId:t,position:s})}},can:{},is:{inSideSubChartRange:(e,t,a,s)=>{const r=f.page.should.exist(e,t);if(r)return r;const i=e.getModel(a,c.a.GraphicalObjectFrameChart);return Object(n.assert)(i,"chart should exist"),s<0||s>i.store.subChartList.length?Object(p.x)({shapeId:a,pageId:t,position:s}):void 0},matchedSubChartType:(e,t,a,s,n)=>{const r=f.chart.should.subChartExist(e,t,a,s);if(r)return r;const i=e.getModel(a,c.a.GraphicalObjectFrameChart),o=null==i?void 0:i.getSubChart(s).type;return(null==i?void 0:i.getSubChart(s).type)===n&&n?void 0:Object(p.y)({shapeId:a,pageId:t,position:s,modelSubChartType:o,mutationSubChartType:n})}}},theme:{should:{existInPresentation:(e,t)=>{if(!e.getThemeById(t))return Object(p.T)({themeId:t,pageType:c.a.Theme})},notUsedInMaster:(e,t)=>{if(e.masterList.some((e=>{var a;return(null===(a=e.getTheme())||void 0===a?void 0:a.id)===t})))return Object(p.U)({themeId:t,pageType:c.a.Theme})},hasCorrectFormat:e=>{const t=e.id;var a;const{fontScheme:s,fmtScheme:n}=null!==(a=e.themeElements)&&void 0!==a?a:{};if(s){const{majorFont:e,minorFont:a}=s;if(!e||!a)return Object(p.R)({themeId:t,pageType:c.a.Theme,fontScheme:s});if(!(e.cs&&e.ea&&e.latin&&a.cs&&a.ea&&a.latin))return Object(p.R)({themeId:t,pageType:c.a.Theme,fontScheme:s})}if(n){const{bgFillStyleLst:e,fillStyleLst:a,lnStyleLst:s,effectStyleLst:r}=n;if(!(e&&a&&s&&r))return Object(p.R)({themeId:t,pageType:c.a.Theme,fmtScheme:n})}}},can:{insertIntoThemeList:(e,t)=>{if(e.getThemeById(t))return Object(p.S)({themeId:t,pageType:c.a.Theme})}}},text:{textContent:{is:{valid:e=>{const t=[];for(const a of e)if(a===l.a.kFieldBegin||a===l.a.kFieldEnd){const e=f.text.textContent.isValidField(t,a);if(e)return e}}},isValidField:(e,t)=>{switch(t){case l.a.kFieldBegin:return e.length?Object(p.P)({msg:"fieldStack should be empty before kFieldBegin",fieldStack:e}):void e.push(l.a.kFieldBegin);case l.a.kFieldEnd:return e.length&&e[0]===l.a.kFieldBegin?void e.pop():Object(p.P)({msg:"1.fieldStack should not be empty after kFieldEnd 2.should have kFieldStart before kFieldEnd"});default:return Object(p.P)({msg:"field character is not matched",character:t})}}},textProperties:{should:{valid:(e,t)=>{for(const a of e)switch(a.textPropertyType){case s.cc.Run:{const e=f.text.textProperties.run.is.valid(a,t);if(e)return e;break}case s.cc.Paragraph:{const e=f.text.textProperties.paragraph.is.valid(a,t);if(e)return e;break}case s.cc.Field:{const e=f.text.textProperties.field.is.valid(a,t);if(e)return e;break}default:return Object(p.Q)({msg:"textPropertyType is not matched",textPropertyType:a.textPropertyType})}}},run:{is:{valid:({runProperties:e,count:t=0,index:a=0},s)=>{const n=s[a+t-1];if(null==e?void 0:e.isPlaceholder){if(1===t&&(n===l.a.kParagraphReturn||n===l.a.kFieldBegin||n===l.a.kFieldEnd))return;return Object(p.Q)({count:t,index:a,curText:n,msg:"endParaRPr character should be kParagraphReturn"})}}}},paragraph:{is:{valid:({count:e=0,index:t=0},a)=>{if(a[t+e-1]!==l.a.kParagraphReturn)return Object(p.Q)({index:t,count:e,curText:a[t+e-1],msg:"curText should be kParagraphReturn"})}}},field:{is:{valid:({count:e=0,index:t=0},a)=>{if(a[t]!==l.a.kFieldBegin&&a[t+e-1]!==l.a.kFieldEnd)return Object(p.Q)({fieldStart:a[t],fieldEnd:a[t+e-1]})}}}}},resourceMap:{id:{is:{valid:e=>""===e?Object(p.h)({}):void 0}}}}},b8a3288ad7:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788");class d extends r.a{apply(e){if(!this.data.shapeId||!this.data.widths)return;const{shapeId:t,widths:a}=this.data,s=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(s,"table should exist"),s&&s.store.setTableColWidths(a)}invert(e){const{pageId:t,shapeId:a}=this.data,r=e.store.models.get(a,o.a.GraphicalObjectFrameTable);Object(n.assert)(r,"shape should exist");const i=null==r?void 0:r.store.colList.map(((e,t)=>{var a;return{index:t,width:null!==(a=e.w)&&void 0!==a?a:0}}));return[{type:s.c.SetTableColWidths,pageId:t,shapeId:a,widths:i}]}check(e){const{pageId:t,shapeId:a}=this.data;return i.a.shape.should.existInPage(e,a,t)}constructor(...e){super(...e),this.type=s.c.SetTableColWidths}}},ba4f7cca81:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("e3f37efdd5"),n=a("9559b6ab8e"),r=a("57da2e7cfd"),i=a("cff38d966a"),o=a("93085721b7"),d=a("16d54e1923");class c extends d.a{getSeqByTriggerId(e){var t;return null===(t=this.store.data.unitTimeNodeMap)||void 0===t?void 0:t[e]}getTimeNode(e,t){var a,s,n;return null===(n=this.store.data.unitTimeNodeMap)||void 0===n||null===(s=n[e])||void 0===s||null===(a=s.unitTimeNodeList)||void 0===a?void 0:a[t]}getMainSequence(){}getAllKindsOfSequence(){}getMediaFileInfo(e){var t,a;const s=null===(t=this.store.data.unitTimeNodeMap)||void 0===t?void 0:t[`${n.t}${e}`];if(s)return null===(a=s.unitTimeNodeList)||void 0===a?void 0:a[0]}constructor(e,t,a,n){super(t),this.context=a,this.parent=n;const d=o.a.fromPageContext(a);d.setTarget(this),this.store=new i.a(e,t,this),this.props=new r.a(this.store.data,d),this.api=new s.a(this,t,a)}}},bb096e3c53:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var s=a("1f69014a3c"),n=a("2f766f71b0"),r=a.n(n),i=a("01ad966fa3"),o=a("dc3f729172"),d=a("9e73d822bf"),c=a("262843d1f7"),l=a("a8241196a7"),u=a("215eaa3247"),h=a("2f1c06b782"),p=a("16d54e1923");const f=["embed","link"],g=["b","l","r","t"],m=["grayscl","biLevel"],v=["buSzPct"];class b extends p.a{getIDGenerator(){return this.idGenerator}get slideList(){return this.store.slideList.toArray()}get layoutList(){return r()(this.masterList.map((e=>e.layoutList)))}get layoutMap(){return this.store.layoutMap.toMap()}get masterList(){return this.store.masterList.toArray()}get themeList(){return this.store.themeList.toArray()}get sectionList(){return this.store.sectionList}get notesMasterMap(){return this.store.notesMasterMap.toMap()}get noteSlideMap(){return this.store.noteSlideMap.toMap()}get tableStyleList(){return this.store.data.tblStyleList}getEvents(){return this.events}getModel(e,...t){return this.store.models.get(e,...t)}getPageIndexById(e){const t=this.getSlideById(e)||this.getLayoutById(e)||this.getMasterById(e),a=this.slideList.indexOf(t),s=this.layoutList.indexOf(t),n=this.masterList.indexOf(t);return a>-1?a:s>-1?s:n>-1?n:-1}getSlideById(e){return this.store.getSlideById(e)}getLayoutById(e){return this.store.getLayoutById(e)}getMasterById(e){return this.store.getMasterById(e)}getThemeById(e){return this.store.getThemeById(e)}getImageResourceById(e){return this.props.resourceMap.images[e]}getVideoResourceById(e){return this.props.resourceMap.videos[e]}getAudioResourceById(e){return this.props.resourceMap.audios[e]}getFontResourceById(e){return this.props.resourceMap.fonts[e]}hasResource(e){const{images:t,videos:a,audios:s,fonts:n}=this.props.resourceMap;return!!(t[e]||a[e]||s[e]||n[e])}modifyData(e){let t=!1;return Object(u.a)(e,((e,a,s)=>{if(g.includes(a)&&"number"==typeof e&&e.toString().includes("."))s[a]=Number(Number(e).toFixed(0)),t=!0;else if(m.includes(a)){const n="grayscl"===a&&1===(null==e?void 0:e.length)&&!1===(null==e?void 0:e[0]),r="biLevel"===a&&1===(null==e?void 0:e.length)&&(0===(null==e?void 0:e[0].thresh)||!1===(null==e?void 0:e[0].thresh));(n||r)&&(Reflect.deleteProperty(s,a),t=!0)}else if(v.includes(a)){const e=s[a];if(null==e?void 0:e.val){const a=Number(Number(e.val).toFixed(0));a<25e3||a>4e5?(e.val="100000",t=!0):e.val!==a.toString()&&(e.val=a.toString(),t=!0)}}})),t}findWildResourceMap(e,t=!1){const a={images:{},videos:{},audios:{},fonts:{},count:0};return Object(u.a)(e,((e,n,r)=>{if(f.includes(n)&&"string"==typeof e&&(e.startsWith("https://")||e.startsWith("tdocs://")||e.startsWith("file://"))&&!this.hasResource(e)){const o=Object(h.a)(e),d=t?`rel:${Object(c.f)(e)}`:e,u=l.a.get(o),p=l.c.get(o);if(u)a.audios[d]={id:d,src:e,type:u};else if(p)a.videos[d]={id:d,src:e,type:p};else{var i;const t=null!==(i=l.b.get(o))&&void 0!==i?i:"image/jpeg",n=Object(h.b)(e);a.images[d]=Object(s.a)({id:d,src:e,type:t},n)}a.count+=1,r[n]=d}})),a}findUsedResourceMap(e){const t={images:{},videos:{},audios:{},fonts:{}};return Object(u.a)(e,((e,a)=>{if(f.includes(a)&&"string"==typeof e){const a=this.getImageResourceById(e);a&&(t.images[e]=a);const s=this.getVideoResourceById(e);s&&(t.videos[e]=s);const n=this.getAudioResourceById(e);n&&(t.audios[e]=n)}})),t}getEmbeddedFontFamilies(){var e,t,a;return null!==(a=null===(t=this.props.embeddedFontList)||void 0===t||null===(e=t.embeddedFont)||void 0===e?void 0:e.map((({font:e,regular:t,bold:a,italic:s,boldItalic:n})=>{var r;return{typeface:null!==(r=null==e?void 0:e.typeface)&&void 0!==r?r:"",subfamilies:{regular:this.getFontById(null==t?void 0:t.id),bold:this.getFontById(null==a?void 0:a.id),italic:this.getFontById(null==s?void 0:s.id),boldItalic:this.getFontById(null==n?void 0:n.id)}}})))&&void 0!==a?a:[]}forEachDescendant(e=(()=>{})){this.slideList.forEach((t=>{e(t),t.forEachDescendant(e)})),this.masterList.forEach((t=>{e(t),t.forEachDescendant(e)})),this.layoutList.forEach((t=>{e(t),t.forEachDescendant(e)})),this.themeList.forEach((t=>{e(t)})),this.sectionList.forEach((t=>{e(t)})),this.notesMasterMap.forEach((t=>{e(t),t.forEachDescendant(e)}))}populate(){this.populated||(this.populated=!0,this.forEachDescendant())}getFontById(e=""){var t,a;const s=null!==(a=null===(t=this.getFontResourceById(e))||void 0===t?void 0:t.src)&&void 0!==a?a:e;if(s)return{src:s}}constructor(e,t){super(t),this.context={getPresentation:()=>this,getTarget:()=>this},this.parent=this,this.populated=!1,this.store=new d.a(e,t,this),this.api=new i.a(this,t),this.props=new o.a(this.store.data,this.context),this.idGenerator=new c.c,this.idGenerator.isIdLegal=e=>!this.store.models.get(e)}}},c2f71a88dd:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("93085721b7"),n=a("ab27b18a63"),r=a("e032dfae83"),i=a("e5b2319967");class o extends i.a{constructor(e,t,a){super(t,a),this.parent=a,this.context=new s.a(e.type),this.store=new r.a(e,t,this.context,this),this.props=new n.a(this.store.data,this.context),this.context.setPresentation(this.parent),this.context.setPage(this),this.context.setTarget(this)}}},c305455190:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("6f5f1758fe"),i=a("2ba82388a5");class o extends r.a{apply(e){const{defaultTextStyle:t,tableStyleList:a,embeddedFontList:s,showSpecialPlsOnTitleSld:n,firstSlideNum:r,slideGuideList:i}=this.data;e.store.patchData({defaultTextStyle:t,tblStyleList:a,embeddedFontList:s,showSpecialPlsOnTitleSld:n,firstSlideNum:r,slideGuideList:null==i?void 0:i.guide},{slideGuideList:!0,defaultTextStyle:!0})}invert(e){const{defaultTextStyle:t,tableStyleList:a,embeddedFontList:r,showSpecialPlsOnTitleSld:o,firstSlideNum:d,slideGuideList:c}=this.data,l=e.store.data;return[Object(s.a)({type:n.c.SetPresentationProperties},Object(i.b)({defaultTextStyle:l.defaultTextStyle,tableStyleList:l.tblStyleList,embeddedFontList:l.embeddedFontList,showSpecialPlsOnTitleSld:l.showSpecialPlsOnTitleSld,firstSlideNum:l.firstSlideNum,slideGuideList:l.slideGuideList&&{guide:l.slideGuideList}},{defaultTextStyle:t,tableStyleList:a,embeddedFontList:r,showSpecialPlsOnTitleSld:o,firstSlideNum:d,slideGuideList:c},{slideGuideList:!0,defaultTextStyle:!0}))]}check(){}constructor(...e){super(...e),this.type=n.c.SetPresentationProperties}}},c586ed7dd7:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var s=a("7c46f42788");function n(e,t,a=0){for(const[r,i]of e.shapeList.entries())i.type===s.a.GroupShape&&n(i,t,a+r),t(i,r,e,a)}function r(e){const t=[];return n({shapeList:e,id:""},(e=>t.push(e))),t}},c685265b1c:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6");class o extends r.a{apply(e){const{sectionId:t}=this.data;e.store.removeSection(t)}invert(e){const{sectionId:t}=this.data,a=e.store.getSectionById(t);var r;Object(n.assert)(a,"section should exist");const i=e.store.slideList.findIndexById(null!==(r=a.store.data.firstSlideId)&&void 0!==r?r:"");return[{type:s.c.AddSection,sectionId:this.data.sectionId,name:a.store.data.name},{type:s.c.BindSectionToSlide,sectionId:this.data.sectionId,firstSlideIndex:i<0?e.store.slideList.length:i}]}check(e){const{sectionId:t}=this.data;return i.a.section.should.exist(e,t)}constructor(...e){super(...e),this.type=s.c.RemoveSection}}},cc8734d850:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("7c46f42788"),o=a("b41b5d48f6"),d=a("727c0c7dd8");class c extends r.a{apply(e){const{shapeId:t,index:a,subChartType:s}=this.data,r=e.store.models.get(t,i.a.GraphicalObjectFrameChart);Object(n.assert)(r,"chart should exist");const o=(new d.a).toSdkSubChart(s,{});r.store.addSubChart(o,a)}check(e){const{pageId:t,shapeId:a,index:s}=this.data;return o.a.every(o.a.shape.should.existInPage(e,this.data.shapeId,this.data.pageId),o.a.chart.is.inSideSubChartRange(e,t,a,s))}invert(e){const{pageId:t,shapeId:a,index:r}=this.data,o=e.store.models.get(a,i.a.GraphicalObjectFrameChart);return Object(n.assert)(o,"chart should exist"),[{type:s.c.RemoveSubChart,pageId:t,shapeId:a,index:r}]}constructor(...e){super(...e),this.type=s.c.AddSubChart}}},d3f3e93e04:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("1f69014a3c"),n=a("711a53c9fc"),r=a("6f5f1758fe");class i extends r.a{apply(e){e.store.patchData({notesSz:this.data.size})}invert(e){return[{type:n.c.SetNotesSize,size:Object(s.a)({},e.getOwnedData().notesSz)}]}check(){}constructor(...e){super(...e),this.type=n.c.SetNotesSize}}},decfd055a5:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6"),o=a("7c46f42788"),d=a("b56763d092");class c extends r.a{apply(e){if(!this.data.shapeId)return;const{shapeId:t,range:a,tableCellProperties:s}=this.data,r=e.store.models.get(t,o.a.GraphicalObjectFrameTable);Object(n.assert)(r,"table should exist"),r&&r.store.setTableCellProperties(a,s)}invert(e){var t,a;const{pageId:r,shapeId:i,range:c}=this.data,l=e.store.models.get(i,o.a.GraphicalObjectFrameTable);Object(n.assert)(l,"table is null"),Object(n.assert)(Object(d.g)(c),"range is invalid");const{startRowIndex:u,rowSpan:h,startColIndex:p,colSpan:f}=c,g=null===(a=l.store.tableData)||void 0===a||null===(t=a.tr)||void 0===t?void 0:t.slice(u,u+h).map((e=>({h:e.h,tc:(null==e?void 0:e.tc)&&e.tc.slice(p,p+f)||[]}))),m=[];return null==g||g.forEach(((e,t)=>{var a;null==e||null===(a=e.tc)||void 0===a||a.forEach(((e,a)=>{m.push({type:s.c.SetTableCellProperties,pageId:r,shapeId:i,range:{startRowIndex:u+t,startColIndex:p+a,rowSpan:1,colSpan:1},tableCellProperties:(null==e?void 0:e.tcPr)?e.tcPr:null})}))})),m}check(e){const{pageId:t,shapeId:a,range:s}=this.data;return i.a.every(i.a.shape.should.existInPage(e,a,t),i.a.table.can.setTableCells(e,a,s))}constructor(...e){super(...e),this.type=s.c.SetTableCellProperties}}},dfb80f368e:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var s=a("ebdb1e97f1"),n=a("460aef6a6f"),r=a("285f8ccc4f"),i=a("7c46f42788"),o=a("f1643ac6d4"),d=a("e3f0495fe7"),c=a("27ba227690"),l=a("7d682333dc"),u=a("9e5a1b9cc4"),h=a("8309a7c071");class p{getInheritedDataFromPlaceholder(e,t,a){const p=Object(r.a)(e);switch(a&&(p.nvPr.ph=a),p.type){case i.a.Shape:{const e=new n.c(p,t.getPageContext());return s.a.getInheritedData(e)}case i.a.GraphicalObjectFrameChart:{const e=new d.a(p,new c.a(t.getPageContext()));return o.a.getInheritedData(e)}case i.a.GraphicalObjectFrameTable:{const e=new l.a(p,t.getPageContext());return s.a.getInheritedData(e)}case i.a.Picture:{const e=new u.a(p,t.getPageContext());return s.a.getInheritedData(e)}case i.a.GraphicalObjectFrameSmartArt:{const e=new h.a(p,t.getPageContext());return s.a.getInheritedData(e)}}}}},e5b1d85b0e:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("ff9b6dacaf");class n extends s.a{constructor(e,t,a,s){super(t,a),this.parent=s}}},e5b2319967:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a("7c46f42788"),n=a("16d54e1923");class r extends n.a{getPageContext(){return this.context}get shapeTree(){return this.store.spTree}get shapeList(){var e,t;return null!==(t=null===(e=this.shapeTree)||void 0===e?void 0:e.shapeList)&&void 0!==t?t:[]}get timing(){return this.store.timing}get placeholders(){return this.shapeList.filter((e=>e.isPlaceholder))}getShapeById(e){const t=this.parent.store.models.get(e,...s.d);if((null==t?void 0:t.getPage().id)===this.id)return t}forEachDescendant(e=(()=>{})){this.shapeTree&&this.shapeTree.forEachDescendant((t=>e(t)))}detach(){var e;return super.detach(),null===(e=this.store.spTree)||void 0===e||e.detach(),this}constructor(e,t){super(e),this.parent=t}}},ea786cec83:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return h}));var s=a("1f69014a3c"),n=a("51767cbdc7"),r=a("711a53c9fc"),i=a("026cc7da1f"),o=a("215eaa3247"),d=a("6f5f1758fe"),c=a("b41b5d48f6"),l=a("2ba82388a5");class u extends d.a{apply(e){const{pageId:t,pageType:a}=this.data;if(a===r.Q.slide){const a=e.store.getSlideById(t);return Object(i.assert)(a,"slide should exist"),void a.store.updateProps(h.toSlideDataDelta(this.data))}if(a===r.Q.slideLayout){const a=e.store.getLayoutById(t);return Object(i.assert)(a,"layout should exist"),void a.store.patchData(h.toLayoutDataDelta(this.data),{slideGuideList:!0})}if(a===r.Q.slideMaster){const a=e.store.getMasterById(t);return Object(i.assert)(a,"master should exist"),void a.store.patchData(h.toMasterDataDelta(this.data),{slideGuideList:!0})}if(a===r.Q.notes){const a=e.store.getNoteSlideById(t);return Object(i.assert)(a,"noteSlide should exist"),void a.store.patchData(h.toNoteSlideDataDelta(this.data))}if(a===r.Q.notesMaster){const a=e.store.getNotesMasterById(t);return Object(i.assert)(a,"notesMaster should exist"),void a.store.patchData(h.toNotesMasterDataDelta(this.data))}}invert(e){const{pageId:t,pageType:a}=this.data,n={type:r.c.SetPageProperties,pageId:t,pageType:a};if(a===r.Q.slide){const a=e.store.getSlideById(t);return Object(i.assert)(a,"slide should exist"),[Object(s.a)({},n,Object(l.b)(h.fromSlideData(a.store.data),h.fromMutationData(this.data)))]}if(a===r.Q.slideLayout){const a=e.store.getLayoutById(t);return Object(i.assert)(a,"layout should exist"),[Object(s.a)({},n,Object(l.b)(h.fromLayoutData(a.store.data),h.fromMutationData(this.data),{layoutProperties:{slideGuideList:!0}}))]}if(a===r.Q.slideMaster){const a=e.store.getMasterById(t);return Object(i.assert)(a,"master should exist"),[Object(s.a)({},n,Object(l.b)(h.fromMasterData(a.store.data),h.fromMutationData(this.data),{masterProperties:{slideGuideList:!0}}))]}if(a===r.Q.notes){const a=e.store.getNoteSlideById(t);return Object(i.assert)(a,"noteSlide should exist"),[Object(s.a)({},n,Object(l.b)(h.fromNoteSlideData(a.store.data),h.fromMutationData(this.data)))]}if(a===r.Q.notesMaster){const a=e.store.getNotesMasterById(t);return Object(i.assert)(a,"notesMaster should exist"),[Object(s.a)({},n,Object(l.b)(h.fromNotesMasterData(a.store.data),h.fromMutationData(this.data)))]}return[]}check(e){const{pageId:t,pageType:a}=this.data;return c.a.page.should.exist(e,t,a)}constructor(...e){super(...e),this.type=r.c.SetPageProperties}}class h{static fromMutationData(e){return Object(o.b)(e,"type","pageId","pageType")}static fromSlideData(e){return{pageProperties:Object(n.a)(Object(s.a)({},Object(o.b)(e.cSld,"spTree")),{transition:e.transition}),slideProperties:{layoutId:e.layoutId,show:e.show,clrMapOvr:e.clrMapOvr,showMasterSp:e.showMasterSp}}}static fromLayoutData(e){return{pageProperties:Object(n.a)(Object(s.a)({},Object(o.b)(e.cSld,"spTree")),{transition:e.transition}),layoutProperties:{slideMasterId:e.masterId,hf:e.hf,layoutType:e.layoutType,clrMapOvr:e.clrMapOvr,showMasterSp:e.showMasterSp,slideGuideList:e.slideGuideList&&{guide:e.slideGuideList}}}}static fromMasterData(e){return{pageProperties:Object(n.a)(Object(s.a)({},Object(o.b)(e.cSld,"spTree")),{transition:e.transition}),masterProperties:{hf:e.hf,themeId:e.themeId,clrMap:e.clrMap,txStyles:e.txStyles,slideGuideList:e.slideGuideList&&{guide:e.slideGuideList}}}}static fromNoteSlideData(e){return{pageProperties:Object(n.a)(Object(s.a)({},Object(o.b)(e.cSld,"spTree")),{transition:e.transition}),notesProperties:{}}}static fromNotesMasterData(e){return{pageProperties:Object(n.a)(Object(s.a)({},Object(o.b)(e.cSld,"spTree")),{transition:e.transition}),notesMasterProperties:{notesStyle:e.notesStyle,hf:e.hf,clrMap:e.clrMap}}}static toSlideDataDelta(e){const{pageProperties:t,slideProperties:a={}}=e,{layoutId:s,show:n,clrMapOvr:r,showMasterSp:i}=a,{cSld:o,transition:d}=this.separatePageProperties(t);return{layoutId:s,show:n,clrMapOvr:r,showMasterSp:i,cSld:o,transition:d}}static toLayoutDataDelta(e){const{pageProperties:t,layoutProperties:a={}}=e,{slideMasterId:s,hf:n,layoutType:r,clrMapOvr:i,showMasterSp:o,slideGuideList:d}=a,{cSld:c,transition:l}=this.separatePageProperties(t);return{cSld:c,masterId:s,hf:n,layoutType:r,clrMapOvr:i,showMasterSp:o,slideGuideList:null==d?void 0:d.guide,transition:l}}static toMasterDataDelta(e){const{pageProperties:t,masterProperties:a={}}=e,{hf:s,themeId:n,clrMap:r,txStyles:i,slideGuideList:o}=a,{cSld:d,transition:c}=this.separatePageProperties(t);return{cSld:d,hf:s,themeId:n,clrMap:r,txStyles:i,slideGuideList:null==o?void 0:o.guide,transition:c}}static toNoteSlideDataDelta(e){const{pageProperties:t}=e,{cSld:a,transition:s}=this.separatePageProperties(t);return{cSld:a,transition:s}}static toNotesMasterDataDelta(e){const{pageProperties:t,notesMasterProperties:a={}}=e,{notesStyle:s,hf:n,clrMap:r}=a,{cSld:i,transition:o}=this.separatePageProperties(t);return{cSld:i,notesStyle:s,hf:n,clrMap:r,transition:o}}static fromSlideDataDelta(e){const{cSld:t,transition:a,showMasterSp:r,show:i,clrMapOvr:o,layoutId:d}=e;return{pageProperties:Object(n.a)(Object(s.a)({},t),{transition:a}),slideProperties:{layoutId:d,showMasterSp:r,show:i,clrMapOvr:o}}}static fromLayoutDataDelta(e){const{cSld:t,transition:a,showMasterSp:r,clrMapOvr:i,hf:o}=e;return{pageProperties:Object(n.a)(Object(s.a)({},t),{transition:a}),layoutProperties:{showMasterSp:r,clrMapOvr:i,hf:o}}}static fromMasterDataDelta(e){const{cSld:t,transition:a,clrMap:r,hf:i,txStyles:o,themeId:d}=e;return{pageProperties:Object(n.a)(Object(s.a)({},t),{transition:a}),masterProperties:{clrMap:r,hf:i,txStyles:o,themeId:d}}}static separatePageProperties(e){return{cSld:e?Object(o.b)(e,"transition"):e,transition:null==e?void 0:e.transition}}static generatePagePropertiesFromData(e,t){return Object(n.a)(Object(s.a)({},e),{transition:t})}}},ea9a0f51b9:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("025e3e9b74");class n{constructor(e){this.events=e,this.runningTxCount=0,this.init=()=>(this.events.on(s.e.RequestBeginTransaction,this.onTransactionBegin),this.events.on(s.e.RequestEndTransaction,this.onTransactionEnd),this.events.on(s.e.EnqueueMutations,this.onEnqueueMutations),this),this.onTransactionBegin=()=>{this.events.emit(s.e.BeginTransaction,this.runningTxCount),this.runningTxCount+=1},this.onTransactionEnd=()=>{this.runningTxCount-=1,this.events.emit(s.e.EndTransaction,this.runningTxCount),this.commitTransactionIfNeeded()},this.onEnqueueMutations=()=>{this.commitTransactionIfNeeded()},this.commitTransactionIfNeeded=()=>{if(this.runningTxCount<=0)try{this.events.emit(s.e.CommitTransaction)}catch(e){throw e}finally{this.runningTxCount=0}},this.init()}}},efb57b1462:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6");class o extends r.a{apply(e){const{sectionId:t,firstSlideIndex:a}=this.data;e.store.bindSectionToSlide(t,a)}invert(e){const{sectionId:t}=this.data,a=e.store.getSectionById(t);return Object(n.assert)(a,"section should exist"),[{type:s.c.BindSectionToSlide,sectionId:this.data.sectionId,firstSlideIndex:e.store.getSectionBindingSlideIndex(a)}]}check(e){const{sectionId:t,firstSlideIndex:a}=this.data;return i.a.every(i.a.section.should.exist(e,t),i.a.section.can.bindSlide(e,a))}constructor(...e){super(...e),this.type=s.c.BindSectionToSlide}}},f536bdad4e:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a("7d347d6549"),n=a("93085721b7"),r=a("a4a5eab22b"),i=a("951a3cebcc"),o=a("e5b2319967");class d extends o.a{get layoutList(){return this.store.layoutList.toArray()}getMaster(){return this}getTheme(){var e;return null===(e=this.parent)||void 0===e?void 0:e.store.getThemeById(this.props.themeId)}getLayout(){}getPlaceholderShape(e){return this.store.findPlaceholderShape(e)}getPlaceholderTxStyle(e){return this.store.findPlaceholderTxStyle(e)}forEachDescendant(e=(()=>{})){this.timing&&e(this.timing),super.forEachDescendant(e)}constructor(e,t,a){super(t,a);const o=a.store.getThemeById(e.themeId);if(!o)throw new Error(`missing theme: ${e.themeId}`);this.context=new n.a(e.type),this.context.setPresentation(a),this.context.setMaster(this),this.context.setTheme(o),this.context.setPage(this),this.context.setTarget(this),this.store=new i.a(e,t,this.context,this),this.props=new r.a(this.store.data,this.context),this.api=new s.a(this,t)}}},f8a9d85cf9:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a("711a53c9fc"),n=a("026cc7da1f"),r=a("6f5f1758fe"),i=a("b41b5d48f6");class o extends r.a{apply(e){const{sectionId:t,name:a}=this.data,s=e.store.getSectionById(t);Object(n.assert)(s,"section should exist"),s.store.patchData({name:a})}invert(e){const{sectionId:t}=this.data,a=e.store.getSectionById(t);return Object(n.assert)(a,"section should exist"),[{type:s.c.SetSectionProperties,sectionId:this.data.sectionId,name:a.store.data.name}]}check(e){const{sectionId:t}=this.data;return i.a.section.should.exist(e,t)}constructor(...e){super(...e),this.type=s.c.SetSectionProperties}}},fd3bb9fd64:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return h}));var s=a("1f69014a3c"),n=a("026cc7da1f"),r=a("711a53c9fc"),i=a("6f5f1758fe"),o=a("7c46f42788"),d=a("9559b6ab8e"),c=a("78db0f5ada"),l=a("64a9e88aee");function u(e,t,a){const s={};if(a===r.Ab.mediacall){const a=e(`${d.t}${t}`,0);Object(n.assert)(a,"mediaTimeNode should not be undefined"),(null==a?void 0:a.video)&&(s.video=a.video),(null==a?void 0:a.audio)&&(s.audio=a.audio)}return s}class h extends i.a{apply(e){var t;if(!this.data.pageId)return;const{pageId:a,timeNode:s,triggerId:n,index:r}=this.data,i=e.store.models.get(a,...o.e);null==i||null===(t=i.store.timing)||void 0===t||t.store.setAnimation(n,r,s)}invert(e){var t;const a=e.store.models.get(this.data.pageId,...o.e);Object(n.assert)(null==a?void 0:a.timing,"page should have timing");const i=null==a||null===(t=a.timing)||void 0===t?void 0:t.getTimeNode(this.data.triggerId,this.data.index);Object(n.assert)(i,"timeNode should not be undefined");const d=new c.a(Object(s.a)({},i)),l=u(a.timing.getTimeNode.bind(a.timing),this.data.shapeId,d.presetClass);d.setData(Object(s.a)({},d.getData(),l));const{pageId:h,shapeId:p,triggerId:f,index:g,seqType:m}=this.data;return[{type:r.c.SetAnimationProperties,pageId:h,shapeId:p,triggerId:f,seqType:m,index:g,timeNode:d.getData()}]}check(e){const{pageId:t,shapeId:a,triggerId:s,index:n,seqType:r}=this.data;return Object(l.d)(e,r,s,a,t,n)}constructor(...e){super(...e),this.type=r.c.SetAnimationProperties}}},fe82ecf3fc:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return b}));var s,n,r=a("1f69014a3c"),i=a("51767cbdc7"),o=a("d7c625d1f2"),d=a("2f766f71b0"),c=a.n(d),l=a("026cc7da1f"),u=a("fdddc95d9b"),h=a("ed0457c1f8"),p=a("cf3340a08c"),f=a("262843d1f7"),g=a("1af4b2dbf4"),m=a("025e3e9b74");!function(e){e.None="none",e.Undo="undo",e.Redo="redo",e.Editor="editor",e.Collaborator="collaborator",e.Offline="offline"}(s||(s={})),function(e){e.UndoRedo="undo-redo",e.Offline="offline",e.Collaboration="collaboration"}(n||(n={}));const v="[SDK][UR]";class b{setMaxCommand(e){if(e<0)throw new Error("maxCommand must be greater than 0");this.maxCommand=e}get canUndo(){return this.getCanRedoUndoCommand(this.undoCommandList).index>-1}get canRedo(){return this.getCanRedoUndoCommand(this.redoCommandList).index>-1}get undoCommandSize(){return this.undoCommandList.length}get redoCommandSize(){return this.redoCommandList.length}get status(){return{canUndo:this.canUndo,canRedo:this.canRedo}}undo(){var e;const{index:t,command:a}=this.getCanRedoUndoCommand(this.undoCommandList);if(!a)return;let s=!1;t!==this.undoCommandList.length-1&&(s=!0,this.transformCommand({index:t,command:a},this.undoCommandList)),this.undoCommandList.splice(t,1),null===(e=this.logger)||void 0===e||e.info(v,"execute undo command:",a.getData()),a.execute(s),a.canDeprecate||this.redoCommandList.push(a.reverse()),this.events.emit(m.b.UndoRedoChange,Object(i.a)(Object(r.a)({},this.status),{commandId:a.getData().commandId,source:"undo",mutationsType:a.getData().undoCommand.mutations.map((e=>e.type))}))}redo(){var e;const{index:t,command:a}=this.getCanRedoUndoCommand(this.redoCommandList);if(!a)return;let s=!1;t!==this.redoCommandList.length-1&&(s=!0,this.transformCommand({index:t,command:a},this.redoCommandList)),this.redoCommandList.splice(t,1),null===(e=this.logger)||void 0===e||e.info(v,"execute redo command:",a.getData()),a.execute(s),a.canDeprecate||this.undoCommandList.push(a.reverse()),this.events.emit(m.b.UndoRedoChange,Object(i.a)(Object(r.a)({},this.status),{commandId:a.getData().commandId,source:"redo",mutationsType:a.getData().undoCommand.mutations.map((e=>e.type))}))}init(){return this.events.on(m.e.CommitCommand,this.handleCommitMutations),this}addCommand(e){if(e.canExecute)return this.clearRedoCommandList(),this.undoCommandList.push(e),void(this.undoCommandList.length>this.maxCommand&&this.undoCommandList.shift());this.undoCommandList.push(e),this.redoCommandList.push(e),this.removeUnusedCollaborationCommand()}createCommand(e,t,a){return new y(e,t,a,this.idGenerator.next(),(e=>{try{var t;return null===(t=this.presentationProvider)||void 0===t?void 0:t.applyMutations(e,u.a.UndoRedo)}catch(e){this.events.emit(m.b.Error,e)}return[]}),this.logger)}clearRedoCommandList(){const e=this.redoCommandList.splice(0,this.redoCommandList.length);this.events.emit(m.b.ClearCommand,e.map((e=>e.getData().commandId)))}removeUnusedCollaborationCommand(){const e=this.undoCommandList.findIndex((e=>e.canExecute)),t=this.redoCommandList.findIndex((e=>e.canExecute)),a=(()=>e>0?this.undoCommandList.splice(0,e):e<0?this.undoCommandList.splice(0,this.undoCommandList.length):void 0)(),s=(()=>t>0?this.redoCommandList.splice(0,t):t<0?this.redoCommandList.splice(0,this.redoCommandList.length):void 0)();(a||s)&&this.events.emit(m.b.ClearCommand,[...a||[],...s||[]].map((e=>e.getData().commandId)))}getCanRedoUndoCommand(e){for(let t=e.length-1;t>=0;t--)if(e[t].canExecute)return{index:t,command:e[t]};return{index:-1,command:null}}getCommandSource(e){switch(e){case u.a.Editor:return"editor";case u.a.Offline:return"offline";case u.a.Collaborator:case u.a.CollaboratorConflict:return"collaborator"}return"none"}transformCommand({command:e,index:t},a){for(let r=t+1;r<a.length;r++){var s,n;const t=a[r],i=e.getData().undoCommand,o=t.getData().redoCommand;null===(s=this.logger)||void 0===s||s.info(v,"followCommand start transform, localUndoCommand:",i,"collaborationRedoCommand:",o);const[d,c]=this.followCommand(i,o,!0);null===(n=this.logger)||void 0===n||n.info(v,"followCommand end transform, followLocalUndoCommand:",d,"followCollaborationRedoCommand:",c),e.setUndoCommand(d),t.setRedoCommand(c)}}followCommand(e,t,a){var s,n,o;const d=null===(s=this.getTransformManager)||void 0===s?void 0:s.call(this);Object(l.assert)(d,"transformManager is undefined");const{transformedA:c,transformedB:u}=d.syncTransform([g.a.fromMutations(e.mutations).getCommandData()],[g.a.fromMutations(t.mutations).getCommandData()],a,"undo-redo");var h,p;return[Object(i.a)(Object(r.a)({},e),{mutations:g.a.fromMutationData(null!==(h=null===(n=c[0])||void 0===n?void 0:n.mutations)&&void 0!==h?h:[]).getMutations()}),Object(i.a)(Object(r.a)({},t),{mutations:g.a.fromMutationData(null!==(p=null===(o=u[0])||void 0===o?void 0:o.mutations)&&void 0!==p?p:[]).getMutations()})]}constructor(e,t,a,s){this.events=e,this.presentationProvider=t,this.logger=a,this.getTransformManager=s,this.undoCommandList=[],this.redoCommandList=[],this.maxCommand=100,this.handleCommitMutations=(e,t,a)=>{const s=c()(t.reverse());if(0===s.length)return;const n=this.createCommand({mutations:e},{mutations:s},a);this.addCommand(n),this.events.emit(m.b.UndoRedoChange,Object(i.a)(Object(r.a)({},this.status),{commandId:n.getData().commandId,source:this.getCommandSource(a),mutationsType:n.getData().redoCommand.mutations.map((e=>e.type))}))},this.idGenerator=new f.b,this.init()}}Object(o.__decorate)([Object(p.a)(h.a.Undo)],b.prototype,"undo",null),Object(o.__decorate)([Object(p.a)(h.a.Redo)],b.prototype,"redo",null);class y{get canExecute(){return[u.a.None,u.a.Editor].includes(this.type)}get canSubmit(){return[u.a.Editor].includes(this.type)}get canDeprecate(){return 0===this.redoCommand.mutations.length&&0===this.undoCommand.mutations.length}execute(e){const t=this.apply(this.undoCommand.mutations);var a;e&&(this.redoCommand.mutations=t,null===(a=this.logger)||void 0===a||a.info(v,"command updated:",this.getData()))}reverse(){return new y(this.undoCommand,this.redoCommand,this.type,this.commandId,this.apply,this.logger)}getData(){return{type:this.type,revision:this.revision,commandId:this.commandId,redoCommand:this.redoCommand,undoCommand:this.undoCommand}}setRedoCommand(e){this.redoCommand=e}setUndoCommand(e){this.undoCommand=e}constructor(e,t,a,s,n,r){this.redoCommand=e,this.undoCommand=t,this.type=a,this.commandId=s,this.apply=n,this.logger=r}}},ff9b6dacaf:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a("8f58e78419"),n=a.n(s),r=a("711a53c9fc"),i=a("4289c697da"),o=a("33fdb9613c"),d=a("29d6d62747"),c=a("7c46f42788"),l=a("16d54e1923");class u extends l.a{getPage(){return this.context.getPage()}getFrame(){var e,t;return i.a.fromTransform(null!==(t=null===(e=this.props.spPr)||void 0===e?void 0:e.xfrm)&&void 0!==t?t:{})}isSpecialPlaceholderVisible(e){if(!this.isSpecialPlaceholder)return;const t=e,a=t.getMaster();if(!(null==a?void 0:a.props.hf)||(null==t?void 0:t.isTitleLayout)&&!1===this.context.getPresentation().props.showSpecialPlsOnTitleSld)return;const s=r.U[this.placeholderType];return!1!==n()(a.props.hf,s)||void 0}getAncestorShapes(){const e=[];return this.forEachAncestorShapes((t=>{e.push(t)})),e}forEachAncestorShapes(e,t={}){const{reverse:a}=t;if(this.parent.parent.type===c.a.GroupShape){const t=this.parent;a?(t.forEachAncestorShapes(e,{reverse:a}),e(t)):(e(t),t.forEachAncestorShapes(e,{reverse:a}))}}getDescription(){var e;const{descr:t}=null!==(e=this.props.nvPr)&&void 0!==e?e:{};if(t)try{return JSON.parse(t)}catch(e){return}}get isPlaceholder(){var e;return!!(null===(e=this.props.nvPr)||void 0===e?void 0:e.ph)}get isSpecialPlaceholder(){return this.placeholderType&&o.a.includes(this.placeholderType)}get placeholderType(){var e,t;return(null===(t=this.props.nvPr)||void 0===t||null===(e=t.ph)||void 0===e?void 0:e.type)||r.U.PBDEFAULT}get name(){var e;return null===(e=this.props.nvPr)||void 0===e?void 0:e.name}constructor(e,t){super(e),this.context=new d.a(t),this.context.setTarget(this)}}}}]);
//# sourceMappingURL=slide-common~e81cc08e-7844bc.js.map
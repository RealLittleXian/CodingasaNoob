(this.webpackJsonp=this.webpackJsonp||[]).push([["async~0c7d7381"],{"024a0dc4be":function(e,t,n){(e.exports=n("9dddfe0040")(!1)).push([e.i,'.template-force-modal{width:840px;height:560px;padding-left:0;padding-right:0;padding-top:0}.template-force-modal .dui-modal-title{margin-left:24px;height:56px;line-height:56px;margin-bottom:0}.template-force-modal .dui-modal-close{top:17px}.template-force-modal .template-force-modal-footer{display:flex;justify-content:flex-end;grid-gap:12px;gap:12px;margin-top:11px;padding-right:24px}.template-force-modal .template-force-modal-footer-continue,.template-force-modal .template-force-modal-footer-random{padding:8px 16px;text-align:center;-webkit-font-feature-settings:"init" on,"fina" on;font-feature-settings:"init" on,"fina" on;font-family:PingFang SC;font-size:14px;font-weight:600;line-height:20px;border-radius:4px}.template-force-modal .template-force-modal-footer-random{background:rgba(51,77,102,.08)}.template-force-modal .template-force-modal-footer-continue{color:#fff;background:linear-gradient(257deg,#db94ff,#5179ff 45.66%,#5ab0ff)}.template-force-content{display:flex;border-top:1px solid rgba(0,0,0,.08)}.template-force-content-left{width:460px;height:431px;padding:16px 14px;box-sizing:border-box;background:rgba(51,77,102,.08);background:var(--TDoc-Light-Tsp-Fill-tsp-fill-medium,rgba(51,77,102,.08));overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.template-force-content-left::-webkit-scrollbar{display:none}.template-force-content-left-cover{width:432px;height:243px;border:1px solid rgba(0,0,0,.08);border-radius:4px;background-position:0 0;background-repeat:no-repeat;background-size:cover}.template-force-content-left-list{width:432px;display:flex;grid-gap:12px;gap:12px;flex-wrap:wrap;margin-top:12px}.template-force-content-left-list-item{width:134px;height:77px;border:1px solid rgba(0,0,0,.08);border-radius:4px;background-position:0 0;background-repeat:no-repeat;background-size:cover}.template-force-content-right{width:380px;height:433px;padding:16px 21px;box-sizing:border-box;display:flex;grid-gap:12px;gap:12px;flex-wrap:wrap;align-content:flex-start;overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.template-force-content-right::-webkit-scrollbar{display:none}.template-force-content-right-block{width:160px;height:90px;border:1.5px solid rgba(0,0,0,.0784313725490196);border-radius:4px;background-position:0 0;background-repeat:no-repeat;background-size:cover;cursor:pointer}.template-force-content-right-block-selected{border:1.5px solid #1e6fff}.template-force-modal--mobile{position:fixed;bottom:0;left:0;width:100%;height:auto}.template-force-modal--mobile .dui-m-modal-title{padding:16px 24px 0}.template-force-modal--mobile .dui-m-modal-content{padding:0;margin-bottom:0}.template-force-modal--mobile .dui-modal-close{border-radius:50%;background-color:rgba(51,77,102,.0784313725490196)}.template-force-modal--mobile .dui-modal-title{text-align:center}.template-force-modal--mobile .template-force-content{width:100%;border-top:0}.template-force-modal--mobile .template-force-content-right{width:100%}.template-force-modal--mobile .template-force-content-right-block{width:calc(50% - 8px);padding-bottom:calc(28.125% - 8px);background-clip:padding-box}.template-force-modal--mobile .template-force-modal-footer{justify-content:center;margin-top:0;padding:24px 0}.template-force-modal--mobile .template-force-modal-footer-continue{width:200px;height:44px;font-size:17px;line-height:24px}.template-force-modal--mobile .template-modal-close-btn{z-index:100;position:absolute;width:24px;height:24px;right:16px;top:16px}',""])},"0b26c2e813":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-template-topic-menu-container-v5I6R{width:100%;padding:16px 12px 16px 16px;display:flex;flex-wrap:nowrap;justify-content:space-between;background-color:#fff;position:relative}.index-template-topic-item-container-scroll-YGJJV{width:466px;height:36px;overflow-x:auto;overflow-y:hidden}.index-template-topic-item-container-scroll-YGJJV::-webkit-scrollbar{display:none}.index-template-topic-item-mask-r7DzE{position:absolute;right:180px;top:16px;width:40px;height:36px;background:linear-gradient(270deg,#fff,transparent);pointer-events:none}.index-template-topic-item-container-5Q0I-{box-sizing:content-box;width:-webkit-max-content;width:max-content;height:28px;flex-shrink:0;padding:4px 0}.index-template-topic-menu-item-38vHn{display:inline-block;box-sizing:content-box;height:28px;line-height:28px;padding:0 8px;border-radius:2px;margin-right:12px;background:rgba(43,78,104,.06);font-size:12px}.index-menu-item-selected-313FB,.index-template-topic-menu-item-38vHn:hover{background:rgba(0,113,255,.12)}.index-template-topic-search-2-XG5{box-sizing:content-box;width:168px;height:36px;flex-shrink:0}.index-template-topic-search-input-8UwsE{height:100%;width:100%;background-color:#fff}.template-topic-search-for-global>.dui-input-input{padding-left:37px!important}",""]),t.locals={"template-topic-menu-container":"index-template-topic-menu-container-v5I6R","template-topic-item-container-scroll":"index-template-topic-item-container-scroll-YGJJV","template-topic-item-mask":"index-template-topic-item-mask-r7DzE","template-topic-item-container":"index-template-topic-item-container-5Q0I-","template-topic-menu-item":"index-template-topic-menu-item-38vHn","menu-item-selected":"index-menu-item-selected-313FB","template-topic-search":"index-template-topic-search-2-XG5","template-topic-search-input":"index-template-topic-search-input-8UwsE"}},"0d31fb9b89":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n("9132715560"),i=n.n(a),r=n("85d0a7609b"),o=n.n(r),c=n("176815363d"),l=n.n(c),s=n("3ef2352f0b"),d=n.n(s),u=(n("c6244f7705"),n("081c8cafea"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("b1e2246d82"),n("d3d31c86eb")),p=function(){var e=l()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55")]).then(n.bind(null,"39cb6f3a5e")));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function e(){i()(this,e)};o()(f,"reportAddonIframeClick",function(){var e=l()(d.a.mark((function e(t){var n,a,i,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return n=e.sent,a=n.DocAddonBridge,e.next=6,a.getAddon(t,{needInstalled:!1});case 6:i=e.sent,r=i.name,Object(u.c)({action:"clk",module:"iframe_container",opername:"doc_addon_use",ver6:t,ver7:r});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},"0ec6428f27":function(e,t,n){"use strict";n.r(t),n.d(t,"AIGenerator",(function(){return oe}));n("b1e2246d82"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287");var a,i,r=n("6136199546"),o=n.n(r),c=n("14502724a6"),l=n.n(c),s=n("176815363d"),d=n.n(s),u=n("9132715560"),p=n.n(u),f=n("6a364eb35c"),v=n.n(f),m=n("85d0a7609b"),h=n.n(m),b=n("3ef2352f0b"),g=n.n(b),y=(n("c6244f7705"),n("081c8cafea"),n("dc43ab0d64"),n("dfaa0b7716"),n("8ee19818c4"),n("342844cefa"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("6e20b6a7d8"),n("759492dad9"),n("8a35b54c1d"),n("2c4d03fe19"),n("75563bc376"),n("963f2eaace"),n("3bf1976a4f"),n("1bab7b5fb7"),n("9d7978d445"),n("a2a09da1e3"),n("22569efd03"),n("63513d8b56"),n("020899bf26")),x=n("f57c18cbbf"),S=n("af753b49bd"),w=n("7c46f42788"),A=n("a7888a8b87"),E=n.n(A),T=n("526377a04a"),k=n("a1d9765e8a"),I=n("86753a9dc2"),O=(n("c554310b5c"),n("bcb5d93d36"),n("730477bb20")),C=n.n(O),P=n("a6e2554eb0"),D=n.n(P),M=(n("b8217400dc"),n("e6f68cdf2e"),n("bd80bf2d0f"),n("9af8f0fa82")),L=n("19bc4fb0a6"),R=n("d289e8c7fb"),_=n("2df8131d1b"),N=n("533aafea7e");function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.COMMERCIALIZE_REASON=11607]="COMMERCIALIZE_REASON",e[e.SENSITIVE_TOPICS=411208]="SENSITIVE_TOPICS"}(a||(a={})),function(e){e.CONTENT="content",e.ERROR="error",e.DONE="done",e.STOP="stop"}(i||(i={}));var F=function(){function e(){p()(this,e)}var t;return v()(e,null,[{key:"setScenario",value:function(e){this.scenario=e}},{key:"setCurrentFileId",value:function(e){this.currentFileId=e}},{key:"call",value:(t=d()(g.a.mark((function e(t,n){var r,o,c,l,s,d,u,p,f,v=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>2&&void 0!==v[2]&&v[2],o=C()({},t),this.abortController=new AbortController,!r){e.next=37;break}c=t.outline.split("\n"),l=!1,s=!1,e.prev=7,u=D()(c);case 9:return e.next=11,u.next();case 11:if(!(l=!(p=e.sent).done)){e.next=19;break}return f=p.value,n({type:i.CONTENT,data:"".concat(f,"\n")}),e.next=16,Object(R.delay)(1e3);case 16:l=!1,e.next=9;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(7),s=!0,d=e.t0;case 25:if(e.prev=25,e.prev=26,!l||null==u.return){e.next=30;break}return e.next=30,u.return();case 30:if(e.prev=30,!s){e.next=33;break}throw d;case 33:return e.finish(30);case 34:return e.finish(25);case 35:return n({type:i.DONE,data:null}),e.abrupt("return");case 37:Object(L.a)("".concat(window.location.origin).concat("/api/ai/slide:generation"),{headers:j({"X-AI-Scenario":this.scenario},this.currentFileId?{"X-AI-File-Id":this.currentFileId}:{}),method:"POST",body:JSON.stringify(j(j({},o),{},{author:{role:M.f.USER}})),signal:this.abortController.signal,openWhenHidden:!0,fetch:window.AI_SPACE.fetch,onmessage:function(e){var t=e.data;if(t){var r=Object(k.d)(t);if(r)return"code"in r?(n({type:i.ERROR,data:r}),void([a.COMMERCIALIZE_REASON,a.SENSITIVE_TOPICS].includes(r.code)||(window.log.error("[AI] sse request error: ".concat(JSON.stringify(t))),_.a.getInstance().aegis.reportEvent({name:"SSE_REQUEST_ERR",ext1:r.code.toString()})))):void(r.content&&n({type:i.CONTENT,data:r.content}))}},onerror:function(e){throw e},onclose:function(){n({type:i.DONE,data:null})}}).catch((function(e){e.stack="[AI] ".concat(e.stack),window.log.error(e),Object(N.c)({message:e.message,error:e},N.a.ERROR),n({type:i.ERROR,data:{code:-1,msg:""}})})),this.abortController.signal.addEventListener("abort",(function(){n({type:i.STOP,data:null})}));case 39:case"end":return e.stop()}}),e,this,[[7,21,25,35],[26,,30,34]])}))),function(e,n){return t.apply(this,arguments)})},{key:"stop",value:function(){this.abortController&&(this.abortController.abort(),this.close())}},{key:"close",value:function(){this.abortController=null}}]),e}();h()(F,"scenario","slide"),h()(F,"abortController",null),h()(F,"currentFileId",void 0);var U=n("477433b002"),z=n("6ad6ba1542"),G=n("9da6335152"),H=n("d3d31c86eb"),q=n("82f2dc9440"),V=n.n(q),W=n("ea00dd14b1"),Y=n.n(W),K=n("12b829499b"),J=n("4780632d19"),X=(n("9d0daf5c3f"),n("a0388d3b54"));var Q,Z=function(){function e(t,n){var a=this;p()(this,e),h()(this,"pendingTaskQueue",[]),h()(this,"activeTasks",0),h()(this,"execute",d()(g.a.mark((function e(){var t,n,i,r,o=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=o.length,n=new Array(t),i=0;i<t;i++)n[i]=o[i];if(!(a.activeTasks<a.concurrency)){e.next=14;break}return e.prev=2,a.activeTasks+=1,e.next=6,a.method.apply(a,n);case 6:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,a.activeTasks-=1,a.processQueue(),e.finish(8);case 12:e.next=15;break;case 14:return e.abrupt("return",new Promise((function(e,t){var i=function(){var i=d()(g.a.mark((function i(){var r;return g.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,a.activeTasks+=1,i.next=4,a.method.apply(a,n);case 4:r=i.sent,e(r),i.next=11;break;case 8:i.prev=8,i.t0=i.catch(0),t(i.t0);case 11:return i.prev=11,a.activeTasks-=1,a.processQueue(),i.finish(11);case 15:case"end":return i.stop()}}),i,null,[[0,8,11,15]])})));return function(){return i.apply(this,arguments)}}();a.pendingTaskQueue.push(i)})));case 15:case"end":return e.stop()}}),e,null,[[2,,8,12]])})))),this.method=t,this.concurrency=n}var t;return v()(e,[{key:"processQueue",value:(t=d()(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.activeTasks>=this.concurrency||0===this.pendingTaskQueue.length)){e.next=2;break}return e.abrupt("return");case 2:if(t=this.pendingTaskQueue.shift()){e.next=5;break}return e.abrupt("return",this.processQueue());case 5:t();case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancelAll",value:function(){this.pendingTaskQueue.length=0}}]),e}(),$=function(e){var t=e.split("?")[1];if(!t)return null;var n=new URLSearchParams(t),a=n.get("w"),i=n.get("h");if(!a||!i)return null;var r=+a,o=+i;return isNaN(r)||isNaN(o)?null:{width:r,height:o}},ee=function(){function e(){var t=this;p()(this,e),h()(this,"task",void 0),h()(this,"create",void 0),h()(this,"createImage",function(){var e=d()(g.a.mark((function e(n,a){var i,r,o,c,l,s,d,u,p;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=t.getShapeSize(n)){e.next=3;break}return e.abrupt("return");case 3:return s=Object(X.a)(l),e.next=6,Object(J.a)({keyword:a,title:null!==(i=null===(r=y.a.SlideTitleManager())||void 0===r?void 0:r.title)&&void 0!==i?i:"",width:s.width,height:s.height,upload:!0});case 6:d=e.sent,(u=null!==(o=null==d?void 0:d.generate_image.url)&&void 0!==o?o:"")||(window.log.info("AIGenerator","get image failed, use fallback"),u="https://docimg4.docs.qq.com/image/AgAABTW7Ya4hnqF4u2VHSZIAGp6G2s8F.png?w=1920&h=1080"),p=null!==(c=$(u))&&void 0!==c?c:s;try{t.updateShapeImage(n,u,a,p)}catch(e){console.error(e)}case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.task=new Z(this.createImage,2),this.create=this.task.execute}return v()(e,[{key:"isRunning",get:function(){return this.task.activeTasks>0}},{key:"cancelAll",value:function(){this.task.cancelAll()}},{key:"updateShapeImage",value:function(e,t,n,a){var i,r=null===(i=e.props.spPr.xfrm)||void 0===i?void 0:i.ext;if(null!=r&&r.cx&&null!=r&&r.cy){var o,c,l=r.cx/r.cy;a.width/a.height>l?(o=a.height*l,c=a.height):(o=a.width,c=a.width/l);var s=Math.floor((a.width-o)/2/a.width*1e5),d=Math.floor((a.height-c)/2/a.height*1e5);e.type===w.a.Shape?e.api.updateProps({nvPr:{name:n},spPr:{blipFill:{blip:{embed:t},srcRect:{l:s,t:d,r:s,b:d},egFillModeProperties:{tile:{flip:1,algn:5,sx:1e5,sy:1e5}}}}}):e.api.updateProps({nvPr:{name:n},blipFill:{blip:{embed:t},srcRect:{l:s,t:d,r:s,b:d}}})}}},{key:"getShapeSize",value:function(e){var t,n=null===(t=e.props.spPr.xfrm)||void 0===t?void 0:t.ext;if(null!=n&&n.cx&&null!=n&&n.cy)return{width:n.cx/12700,height:n.cy/12700}}}]),e}(),te=n("77c89fc0e0"),ne=n("45770891c9"),ae=n("0230345688");function ie(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw r}}}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}!function(e){e.AI_GENERATE_OUTLINE="AI_GENERATE_OUTLINE",e.AI_GENERATE_POSITION="AI_GENERATE_POSITION",e.AI_GENERATE_IMAGE="AI_GENERATE_IMAGE"}(Q||(Q={}));var oe=function(){function e(t,n,a){p()(this,e),h()(this,"shouldFocusOnAddPage",!0),h()(this,"extractedSlides",void 0),h()(this,"initPromise",void 0),h()(this,"imageGenerator",new ee),this.uiDataService=t,this.contentLayoutAnalyzer=n,this.selectionService=a,this.initPromise=this.initBaseTemplate()}var t,n,a,r,c,s,u,f,m,b,A;return v()(e,[{key:"waitForReady",value:(A=d()(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.initPromise);case 1:case"end":return e.stop()}}),e,this)}))),function(){return A.apply(this,arguments)})},{key:"initBaseTemplate",value:(b=d()(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(I.a)("1fw5ztun97bgtyp6z4qxibcysy");case 3:t=e.sent,n=Object(x.a)(t),x.c.updateBaseTemplate(n);case 6:case"end":return e.stop()}}),e)}))),function(){return b.apply(this,arguments)})},{key:"getTemplateDataById",value:(m=d()(g.a.mark((function e(t){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(I.b)(t);case 3:return n=e.sent,a=Object(x.a)(E()(n)),e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),new ae.a(ae.b.FetchTemplateErr);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(e){return m.apply(this,arguments)})},{key:"updateTemplateDataById",value:(f=d()(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTemplateDataById(t);case 2:n=e.sent,x.c.updateTemplate(n,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"applyTemplate",value:(u=d()(g.a.mark((function e(t,n){var a,i,r,o,c,l,s,d,u;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.extractSlideListByTag();case 4:return a=e.sent,x.c.updateTemplate(t,n),r={},o=a.flatMap((function(e){if(!e)return[];var t=(i=x.c.generateSlideFromMarkdownPage(e.markdown,e.type).presentationData).slideList;return t[0]&&(r[e.slideId]=t[0].id),t})),i&&(i.slideList=o,(l=null===(c=y.a.SDKDataServices.PresentationStoreService())||void 0===c?void 0:c.getPresentation())?(s=l.getCloneData(),d=s.noteSlideMap,u={},Object.keys(d).forEach((function(e){var t=r[d[e].slideId];t&&(d[e].slideId=t,u[e]=d[e])})),i.noteSlideMap=u):i.noteSlideMap={}),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"insertSlides",value:(s=d()(g.a.mark((function e(t){var n,a,r,o,c,l,s,u,p=this,f=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]&&f[1],a=f.length>2?f[2]:void 0,r=t.outline,o=t.templateId,c=t.conversationId,l=t.messageId,s=t.enableImageGeneration,u=void 0!==s&&s,Object(H.c)({opername:G.e.DOC_PPT_AI,module:G.d.CREAT_PPT,action:G.b.AI_CLK,ver6:t.templateId,ver7:n?1:2,ver8:u?1:0}),e.next=6,this.waitForReady();case 6:return e.abrupt("return",new Promise((function(e,s){var f=ne.a.start(Q.AI_GENERATE_OUTLINE,{ext1:n?"new":"insert",ext2:u?"enable":"disable"}),v=[],m=function(e){if("string"!=typeof e)return A+=1,void v.push(e);var t=e,n=S.d.page;/^### /.test(t)&&(n=S.d.page),/^## /.test(t)&&(n=S.d.session),/^# /.test(t)&&(n=S.d.cover),A+=1,v.push({markdown:t,type:n})},h=!0,b="",w=!1,A=0,E=0,T=[];F.call({outline:r,conversationId:c,messageId:l},(function(e){var t=e.data,a=e.type;if(w)window.log.error("receive unexpected data after completed",a);else switch(a){case i.CONTENT:return/^(#|##|###) /.test(t)&&(b&&(h?(h=!1,n||m(b),m({type:S.d.catalogue,markdown:Object(x.b)(r)})):m(b),I()),b=""),void(b+=t);case i.DONE:case i.STOP:return window.log.info("receive ".concat(a)),w=!0,b&&(m(b),m({type:S.d.ending,markdown:""}),I(),b=""),void f.success({ext3:"".concat(A)});case i.ERROR:var o=t.msg;return V.a.show({message:o||te.l.t("未知错误，请稍后重试"),type:"warning",closable:!0,autoClose:!1}),f.fail({ext3:"".concat(t.code)}),void s(new ae.a(ae.b.ServerGenerationErr))}}));var k=!1;p.getTemplateDataById(o).then((function(e){x.c.updateTemplate(e,o),window.log.info("fetch template success ",o),k=!0,v.length>0&&I()})).catch(s);var I=function e(){if(k){var t=v.shift();if(t){var n=t.type,a=t.markdown,i=y.a.SDKDataServices.PresentationStoreService().getPresentation(),r=!1;if(n===S.d.page&&(E+=1,r=u&&E%3==1),r){var o=p.addPage(i,a,n,{onlyTitle:!0}),c=p.replaceSlidesWithPageHasImage(o,i,a,n);T.push(c)}else p.addPage(i,a,n);v.length>0?e():w&&O()}}},O=function(){var i=d()(g.a.mark((function i(){var r,o,c,l,s;return g.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!T.length){i.next=5;break}return r=ne.a.start(Q.AI_GENERATE_POSITION),i.next=4,Promise.all(T);case 4:r.success();case 5:if(Object(H.c)({opername:G.e.DOC_PPT_AI,module:G.d.CREAT_PPT,action:G.b.AI_SUCCESS,ver5:A,ver6:t.templateId,ver7:n?1:2,ver8:u?1:0}),p.imageGenerator.isRunning){i.next=9;break}return e(),i.abrupt("return");case 9:o=p.imageGenerator.task,c=o.pendingTaskQueue.length+o.activeTasks,null==a||a({total:c,left:c}),l=ne.a.start(Q.AI_GENERATE_IMAGE),s=setInterval((function(){var t=o.pendingTaskQueue.length+o.activeTasks;null==a||a({total:c,left:t}),0===t&&(clearInterval(s),l.success(),e())}),500);case 14:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}()})));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"extractSlideContentAsMarkdownText",value:(c=d()(g.a.mark((function e(){var t,n,a,i,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.extractSlideByAnalysis(),this.extractSlideListByTag()]);case 2:return t=e.sent,n=l()(t,2),a=n[0],i=n[1],this.extractedSlides=i.map((function(e,t){return null!=e?e:a[t]})),r=this.extractedSlides.map((function(e){return e.markdown})).filter((function(e){return!!e})).join("\n"),window.log.info("extractSlideContentAsMarkdownText",r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"insertSpeechTextIntoNotes",value:function(e){for(var t=this,n=this.extractedSlides.some((function(e){return e.type===S.d.ending})),a=T.marked.lexer(e).filter((function(e){return"heading"===e.type||"paragraph"===e.type})),i=[],r=null,o=0;o<a.length;o++){var c,l=a[o];if("heading"!==l.type)n&&o===a.length-1&&r&&r.notes.length>0?i.push({type:S.d.ending,title:"",notes:[l.text]}):null===(c=r)||void 0===c||c.notes.push(l.text);else{var s={type:1===l.depth?S.d.cover:2===l.depth?S.d.session:S.d.page,title:l.text,notes:[]};i.push(s),r=s}}var d=[],u=Y()(this.extractedSlides,(function(e){return e.type}));if(i.forEach((function(e){if(0!==e.notes.length){var n=t.matchExtractedSlide(u,e.type,e.title.trim());if(n){var a=t.uiDataService.slideModelList.find((function(e){return e.id===n.slideId}));a?a.noteData.updateNoteText(e.notes):d.push(e)}else d.push(e)}})),window.log.info("Not match notes: ".concat(d.length)),i.length===d.length)throw new ae.a(ae.b.NoteNotMatchErr)}},{key:"insertPresentation",value:function(e){var t,n=null===(t=y.a.SDKDataServices.PresentationStoreService())||void 0===t?void 0:t.getPresentation();n&&n.api.addPresentation(e,n.slideList.length)}},{key:"replacePresentation",value:function(e){var t,n=null===(t=y.a.SDKDataServices.PresentationStoreService())||void 0===t?void 0:t.getPresentation();null==n||n.api.replacePresentation(e)}},{key:"extractSlideListByTag",value:(r=d()(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.SDKDataServices.PresentationStoreService.promise();case 2:return t=e.sent,n=t.getPresentation(),e.abrupt("return",n.slideList.map(k.a));case 5:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"extractSlideByAnalysis",value:(a=d()(g.a.mark((function e(){var t,n,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.uiDataService,n=t.presentation,a=t.slideModelList,e.next=3,this.contentLayoutAnalyzer.analysisTextResult(n);case 3:return i=e.sent,e.abrupt("return",i.map((function(e,t){var n,i=a[t].sdkData.id;if(e.pageType===K.b.TableOfContents)return{slideId:i,type:S.d.catalogue,title:"",markdown:""};if(e.pageType===K.b.Acknowledgments)return{slideId:i,type:S.d.ending,title:"",markdown:""};if(e.pageType===K.b.CoverPage){var r=e.texts.map((function(e){return e.text})).join(" ").trim();return{slideId:i,type:S.d.cover,title:r,markdown:Object(k.e)(r,S.d.cover)}}if(e.texts.length<3){var c=e.texts.map((function(e){return e.text})).join(" ").trim();if(c.length<20)return{slideId:i,type:S.d.session,title:c,markdown:Object(k.e)(c,S.d.session)}}var l=o()(e.texts),s=l[0],d=l.slice(1),u=(null!==(n=s.text)&&void 0!==n?n:"").trim(),p="".concat(Object(k.e)(u,S.d.page)).concat(d.map((function(e){return e.text})).join(" "));return{slideId:i,type:S.d.page,title:u,markdown:p}})));case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"addPage",value:function(e,t,n,a){var i,r,o=t;window.log.info("generateSlideFromMarkdownPage",t),null!=a&&a.onlyTitle&&(o=t.split("\n")[0]);var c=x.c.generateSlideFromMarkdownPage(o,n),l=c.presentationData,s=c.metaInfo;l.noteSlideMap={};var d=l.slideList.length;if(0===d)return[];Object(z.a)(l,"ai_add_page",w.a.Presentation),(null!==(i=null==a?void 0:a.shouldFocusOnAddPage)&&void 0!==i?i:this.shouldFocusOnAddPage)||this.selectionService.selectedWithCommit.markSpecialOperate(U.a.keep);var u,p=null!==(r=null==a?void 0:a.toIndex)&&void 0!==r?r:e.slideList.length,f=e.api.addPresentation(E()(l),p).slideIdsArr,v=ie(s.imageKeyArr);try{for(v.s();!(u=v.n()).done;)for(var m=u.value,h=m.keyword,b=m.shapeId,g=0;g<f.length;g++){var y,S=l.slideList[g],A=f[g],T=A.get(S.id),k=A.get(b);if(T&&k){var I=null===(y=e.getSlideById(T))||void 0===y?void 0:y.getShapeById(k);if(I){I.type!==w.a.Picture&&I.type!==w.a.Shape||this.imageGenerator.create(I,h);break}}}}catch(e){v.e(e)}finally{v.f()}return e.slideList.slice(p,p+d)}},{key:"replaceSlidesWithPageHasImage",value:(n=d()(g.a.mark((function e(t,n,a,i){var r,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getImagePosition(a);case 2:if(r=e.sent,!((o=n.slideList.indexOf(t[0]))<0)){e.next=6;break}return e.abrupt("return");case 6:this.selectionService.selectedWithCommit.markSpecialOperate(U.a.keep),n.api.removeSlides(t),this.addPage(n,r,i,{toIndex:o,shouldFocusOnAddPage:!1});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,a,i){return n.apply(this,arguments)})},{key:"getImagePosition",value:(t=d()(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,Object(J.b)({input:t});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=t;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"matchExtractedSlide",value:function(e,t,n){var a=e[t],i=a.findIndex((function(e){return e.title===n}));if(i>-1){var r=a[i];return a.splice(i,1),r}var o=Object(k.b)(n,a.map((function(e){return e.title}))),c=l()(o,1)[0];if(c){window.log.info("fuzzySearch",n,c.text,c.similarity);var s=a[c.index];return a.splice(c.index,1),s}return null}}]),e}()},"14df5cde4b":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ke}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a,i=n("176815363d"),r=n.n(i),o=n("9132715560"),c=n.n(o),l=n("6a364eb35c"),s=n.n(l),d=n("547611bd96"),u=n.n(d),p=n("8eec1e4a03"),f=n.n(p),v=n("bd29e2df90"),m=n.n(v),h=n("ab5eb40518"),b=n.n(h),g=n("1b4cdd6a36"),y=n.n(g),x=n("85d0a7609b"),S=n.n(x),w=n("3ef2352f0b"),A=n.n(w),E=(n("c6244f7705"),n("081c8cafea"),n("8296b34ae7")),T=n("9af8f0fa82"),k=n("d5c3deb8c7"),I=n("995e8a78e5"),O=n("711a53c9fc"),C=n("77c89fc0e0");!function(e){e.standard="standard",e.wide="wide",e.vertical="vertical",e.custom="custom"}(a||(a={}));var P=function(){function e(t,n,i,o,l){var s=this;c()(this,e),S()(this,"replaceImage",function(){var e=r()(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.confirmSearch,e.prev=1,n){e.next=5;break}return s.aiService.showRecommendCard(),e.abrupt("return",{success:!0});case 5:return setTimeout((function(){return s.aiService.showRecommendCard()}),1e3),e.abrupt("return",{success:!0,tips:"✅ 图片替换完毕"});case 9:return e.prev=9,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",{success:!1,tips:"输入不合法"});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()),S()(this,"changeBackgroundFill",function(){var e=r()(A.a.mark((function e(t){var n,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.range,a=t.color,e.prev=1,s.backgroundFillTask.updateBackgroundFill(n,a),e.abrupt("return",{success:!0,tips:"✅ 背景已更改"});case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",{success:!1,tips:"输入不合法"});case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()),S()(this,"changeSlideSize",function(){var e=r()(A.a.mark((function e(t){var n,i,r,o,c,l,d,u,p,f,v,m;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.range,n={},S()(n,a.standard,O.jb.screen4x3),S()(n,a.wide,O.jb.screen16x9),o=n,i={},S()(i,O.jb.screen4x3,a.standard),S()(i,O.jb.screen16x9,a.wide),c=i,r!==a.standard&&r!==a.wide){e.next=19;break}if(!(u=null===(l=s.uiDataService.presentation)||void 0===l?void 0:l.props.type)||c[u]!==r){e.next=7;break}return e.abrupt("return",{success:!0,tips:"当前已经是该比例"});case 7:return e.next=9,null===(d=s.slideSizeService)||void 0===d?void 0:d.promise();case 9:if(p=e.sent){e.next=12;break}return e.abrupt("return",{success:!1});case 12:return f=o[r],e.next=15,p.showSlideSizeConfirmDialog(f);case 15:if(e.sent){e.next=18;break}return e.abrupt("return",{success:!0,tips:"已取消修改"});case 18:return e.abrupt("return",{success:!0,tips:"✅ 比例已修改"});case 19:if(r!==a.custom){e.next=27;break}return e.next=22,null===(v=s.slideSizeService)||void 0===v?void 0:v.promise();case 22:if(m=e.sent){e.next=25;break}return e.abrupt("return",{success:!1});case 25:return m.showSlideSizeDialog(),e.abrupt("return",{success:!0,tips:"✅ 已成功打开“自定义比例”功能"});case 27:return e.abrupt("return",{success:!1,tips:"输入比例不合法"});case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S()(this,"enterMasterLayoutEdit",(function(){var e=s.masterLayoutEditService;if(!e)return{success:!1};e.changeEditType(C.d.MASTER_LAYOUT);var t=Object(k.r)((function(){return e.isMasterEditType}),(function(e){e||(t(),s.aiService.showSideBar())}));return{success:!0,tips:"✅ PPT成功进入母版视图"}})),this.backgroundFillTask=t,this.aiService=n,this.uiDataService=i,this.masterLayoutEditService=o,this.slideSizeService=l}return s()(e,[{key:"getTools",value:function(){return{changeSlideSize:{description:"更改PPT比例",exec:this.changeSlideSize},enterMasterLayoutEdit:{description:"编辑PPT母版",exec:this.enterMasterLayoutEdit},changeBackgroundFill:{description:"一键填充背景",exec:this.changeBackgroundFill},searchImages:{description:"替换图片",exec:this.replaceImage}}}}]),e}(),D=n("7a5536c9bf"),M=n.n(D),L=n("14502724a6"),R=n.n(L),_=(n("6e20b6a7d8"),n("70f774518a")),N=n("5fac0349d3"),B=n("017877e9ad"),j=n("c606e82f8d"),F=n("75f19a1449"),U=n("4f3b15d017"),z=n("b438b29dcd"),G=n.n(z),H=n("1748118723"),q=n.n(H),V=n("69084d01d3"),W=n.n(V),Y=(n("3bf1976a4f"),n("580eefa367")),K=n("2ba7871556"),J=[["#E5EFFF","#99BEFF"],["#FFF9E3","#C7ECFF"],["#D9EAD3","#678F00"],["#8C7BE8","#FEE4FF"],["#EE93F6","#FFD966"],["#FFB700","#E75200"],["#C4C4C4","#9D9D9D"]],X=function(e,t){return"linear-gradient(225deg,".concat(e," 0%,").concat(t," 100%)")},Q=function(e,t,n){return{gsList:[{pos:0,color:new F.a({rgbaStr:e,alpha:n})},{pos:100,color:new F.a({rgbaStr:t})}],pathGradient:{path:K.c.Linear},rotateWithShape:1,lin:{ang:135,scaled:1}}},Z=function e(t,n,a){var i=this;c()(this,e),S()(this,"updateBackgroundFill",(function(e,t){var n=function(e){var n;if("gradColor"in t)e.getBackgroundFill().updateCurrentFillForCurrentModel({gradFill:Q.apply(void 0,M()(t.gradColor).concat([1-t.transparency/100])),shadeToTitle:0});else{var a=t.enableCustom?t.customColor:new F.a({themeKey:t.themeKey});a.originAlpha=1-t.transparency/100,e.getBackgroundFill().updateCurrentFillForCurrentModel({solidFill:{color:a}})}null===(n=e.sdkData)||void 0===n||n.api.updateShowMasterSp(!1)};Object(Y.f)((function(){if("all"===e)i.uiDataService.presentation.children.forEach(n);else{var t=i.selectionService.currentSlide;t&&n(t)}}))})),S()(this,"getColorOptions",(function(){var e,t,n,a,r=null===(e=i.themeColorManager)||void 0===e?void 0:e.currentThemeModel;if(!r)return[];var o=(null===(t=i.selectionService.currentSlide)||void 0===t?void 0:t.getRelationMasterModel().clrMap.tx1)===O.eb.lt1,c=null===(n=r.sdkData)||void 0===n||null===(a=n.props.themeElements)||void 0===a?void 0:a.clrScheme;return c?(o?["dk1","dk2","accent3","accent4","accent5","accent6"]:["lt1","lt2","accent3","accent4","accent5","accent6"]).map((function(e){var t;return{themeKey:O.eb[e],color:"#".concat(null===(t=c[e].srgbClr)||void 0===t?void 0:t.val)}})):[]})),this.uiDataService=t,this.selectionService=n,this.themeColorManager=a},$=n("e792a3169a"),ee=n.n($),te=n("2dc38956e5"),ne=n.n(te),ae={insert:"head",singleton:!1},ie=(ee()(ne.a,ae),ne.a.locals||{});function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){return function(t){var n,a,i,r,o,c=t.props,l=t.onResult,s=t.disable,d=null!==(n=e.getColorOptions())&&void 0!==n?n:[],u=Object(V.useState)(null!==(a=null==c?void 0:c.enableCustom)&&void 0!==a&&a),p=R()(u,2),f=p[0],v=p[1],m=Object(V.useState)(null!==(i=null==c?void 0:c.themeKey)&&void 0!==i?i:d[0].themeKey),h=R()(m,2),b=h[0],g=h[1],y=Object(V.useState)(new F.a({themeKey:b})),x=R()(y,2),w=x[0],A=x[1],E=Object(V.useState)(null!==(r=null==c?void 0:c.transparency)&&void 0!==r?r:0),T=R()(E,2),k=T[0],I=T[1];return W.a.createElement("div",{className:q()({"color-options-card":!0,"color-options-card--pc":!U.default.isMobile,"color-options-card--mobile":U.default.isMobile}),style:{pointerEvents:s?"none":"unset"}},W.a.createElement("p",{className:"color-options-card-description"},N.a.t("请选择你喜欢的配色")),W.a.createElement("ul",{className:ie.colorList},W.a.createElement("li",{className:q()((o={},S()(o,ie.palette,!0),S()(o,ie.color,!0),S()(o,ie.selected,f),o)),onClick:function(){return v(!0)}},W.a.createElement(G.a,{alignment:"auto-outer",dropContent:W.a.createElement(B.a,{colorPickerType:j.d.StandardPC,selectedTdColor:w,onColorChange:function(e){A(e)}})},W.a.createElement("div",{style:{width:30,height:30}}))),d.map((function(e){var t;return W.a.createElement("li",{key:e.themeKey,style:{backgroundColor:e.color},className:q()((t={},S()(t,ie.color,!0),S()(t,ie.selected,!f&&e.themeKey===b),t)),onClick:function(){v(!1),g(e.themeKey)}})}))),W.a.createElement(se,{value:k,onChange:I}),!s&&W.a.createElement("button",{className:"ai-assistant-sdk-button ai-assistant-sdk-button--primary",onClick:function(){var e={enableCustom:f,themeKey:b,customColor:w,transparency:k};l(e,oe(oe({},c),e),N.a.t("选择完成"))}},N.a.t("选择完成")))}},le=function(e){var t=e.props,n=e.onResult,a=e.disable,i=Object(V.useState)(J[0]),r=R()(i,2),o=r[0],c=r[1],l=Object(V.useState)(0),s=R()(l,2),d=s[0],u=s[1];return W.a.createElement("div",{className:q()({"color-options-card":!0,"color-options-card--pc":!U.default.isMobile,"color-options-card--mobile":U.default.isMobile}),style:{pointerEvents:a?"none":"unset"}},W.a.createElement("p",{className:"color-options-card-description"},N.a.t("请选择你喜欢的配色")),W.a.createElement("ul",{className:ie.colorList},J.map((function(e,t){var n;return W.a.createElement("li",{key:t,style:{background:X.apply(void 0,M()(e)),backgroundClip:"content-box"},className:q()((n={},S()(n,ie.color,!0),S()(n,ie.selected,e===o),n)),onClick:function(){c(e)}})}))),W.a.createElement(se,{value:d,onChange:u}),!a&&W.a.createElement("button",{className:"ai-assistant-sdk-button ai-assistant-sdk-button--primary",onClick:function(){var e={gradColor:o,transparency:d};n(e,oe(oe({},t),e),N.a.t("选择完成"))}},N.a.t("选择完成")))},se=function(e){return W.a.createElement("div",{className:ie.sliderWrapper},W.a.createElement(_.a,{title:N.a.t("透明度"),value:e.value,toFixed:2,slideBarStep:1,numberInputStep:1,lowerLimit:0,upperLimit:100,allowDecimal:!0,postFix:"%",sliderStyle:{width:144},sliderContainerStyle:{marginTop:0},type:"opacity",onBlur:function(){},onFocus:function(){},onValueChange:function(t,n){return e.onChange(n)},onValueEnter:function(){},onValueLeave:function(){},canShowEmptyString:!0,isIntegerOfStep:!0}))},de=(n("f45588a8ad"),n("d0336c61c6")),ue=n.n(de),pe={insert:"head",singleton:!1},fe=(ee()(ue.a,pe),ue.a.locals||{}),ve=n("b1f388d5a8"),me=function(e){var t=e.props,n=e.onResult,a=e.disable;return W.a.createElement("div",{className:q()(S()({},fe["card-disable"],a))},W.a.createElement("div",{className:fe["card-title"]},t.title),W.a.createElement("div",{style:{marginBottom:8}},t.description),W.a.createElement("div",{style:{display:"flex"}},W.a.createElement("button",{className:"ai-assistant-sdk-button ai-assistant-sdk-button--primary ".concat(fe["card-button"]),onClick:function(){var e;null!==(e=ve.a.getAllAiPictures().length)&&void 0!==e&&e?n(!0,t,t.confirmText):n(!1,t,N.a.t("很抱歉，当前文档里没有可以替换的图片"))}},W.a.createElement("div",{className:fe["tick-icon"]}),t.confirmText),t.extraText&&W.a.createElement("button",{className:"ai-assistant-sdk-button  ".concat(fe["card-button"]),onClick:function(){return n(!1,t,t.extraText)}},t.extraText)))},he=(n("8aebbf296a"),n("85d48ef22b"),n("963f2eaace"),n("8410cfccc9")),be=n.n(he),ge={insert:"head",singleton:!1},ye=(ee()(be.a,ge),be.a.locals||{}),xe=n("4780632d19"),Se=n("020899bf26"),we=function(e){var t=function(e){var t,n=e.hasSubImages,a=e.images;return W.a.createElement("div",{className:q()((t={},S()(t,ye["image-item-container"],!0),S()(t,ye["image-loading"],!n&&""===a[0]),t)),style:n||a.length<1?{outline:"none"}:null===a[0]?{}:{backgroundImage:"url(".concat(a[0],")")}},n&&W.a.createElement("div",{className:ye["images-sub-galley"]},a.map((function(e,t){var n;return W.a.createElement("div",{key:"".concat(e).concat(t),className:q()((n={},S()(n,ye["image-item-sub-container"],!0),S()(n,ye["image-loading"],""===e),S()(n,ye["image-sub-loading"],!0),n)),style:e?{backgroundImage:"url(".concat(e,")")}:{}})}))))};return function(n){var a,i=n.props,o=i.description,c=void 0===o?"":o,l=i.confirmText,s=void 0===l?"":l,d=i.containerCount,u=void 0===d?6:d,p=i.maxPage,f=void 0===p?3:p,v=i.showLastMoreImages,m=void 0===v||v,h=n.onResult,b=n.disable,g=function(){return u+(m?3:0)},y=Object(V.useState)(Array.from({length:g()},(function(){return""}))),x=R()(y,2),w=x[0],E=x[1],T=Object(V.useState)(0),k=R()(T,2),I=k[0],O=k[1],C=Object(V.useRef)([]);return Object(V.useEffect)((function(){var e,t,n;if((null===(e=C.current[I])||void 0===e?void 0:e.length)>0)E(C.current[I].map((function(e){return e.thumb_url})));else if(b)E(Array.from({length:g()},(function(){return null})));else{E(Array.from({length:g()},(function(){return""})));var a=null!==(t=null===(n=Se.a.SlideTitleManager())||void 0===n?void 0:n.title)&&void 0!==t?t:"";Object(xe.c)({keyword:a,num:g(),page:I}).then((function(e){var t,n;E(null!==(t=null==e?void 0:e.search_image.images.map((function(e){return e.thumb_url})))&&void 0!==t?t:[]),C.current[I]=null!==(n=null==e?void 0:e.search_image.images)&&void 0!==n?n:[]}))}}),[I]),W.a.createElement("div",{className:q()((a={},S()(a,ye["search-images-container"],!0),S()(a,ye["search-images-container-disable"],b),a))},W.a.createElement("div",{style:{marginBottom:8}},c),W.a.createElement("div",{className:ye["images-galley"]},Array.from({length:u}).map((function(e,n){var a=n===u-1,i=a?w.slice(n,n+4):w.slice(n,n+1);return W.a.createElement(t,{key:"image".concat(n),hasSubImages:a,images:i})}))),W.a.createElement("div",{style:{display:"flex"}},W.a.createElement("button",{className:"ai-assistant-sdk-button ai-assistant-sdk-button--primary ".concat(ye["card-button"]),onClick:r()(A.a.mark((function t(){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==e?void 0:e.showBulkReplaceDialog(C.current[I],I);case 2:h(void 0,{description:c,confirmText:s,containerCount:u,maxPage:f,showLastMoreImages:m});case 3:case"end":return t.stop()}}),t)})))},W.a.createElement("div",{className:ye["tick-icon"]}),s),W.a.createElement("button",{className:"ai-assistant-sdk-button ai-assistant-sdk-button--normal ".concat(ye["card-button"]),onClick:function(){return function(e){return O(e%f)}(I+1)}},N.a.t("换一批"))))}};function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return b()(this,n)}}var ke=function(e){m()(l,e);var t,n,a,i,o=Te(l);function l(){var e;return c()(this,l),e=o.call(this),S()(u()(e),"editorReaction",void 0),S()(u()(e),"onHistoryShow",(function(){e.hideSideBar()})),e}return s()(l,[{key:"toggleSidebar",value:(i=r()(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.aiControllerLoader;case 2:this.aiSidebarController.isVisible?this.hideSideBar():this.showSideBar(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"showSideBar",value:(a=r()(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.aiControllerLoader;case 2:this.aiSidebarController.show(Ee({tabIndex:-1},t)),this.attachListener();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"hideSideBar",value:(n=r()(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()(y()(l.prototype),"hideSideBar",this).call(this);case 2:this.removeListener();case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"createAIController",value:(t=r()(A.a.mark((function e(){var t,n,a,i,r=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.a)();case 2:return t=e.sent,this.registerDocsApi(t.api),n=t.initialize({context:{clientVars:{}},source:T.d.SOURCE_SLIDE,lifecycles:{onShow:function(){var e,t;null===(e=r.aiLifeCyclesFunction)||void 0===e||null===(t=e.onShow)||void 0===t||t.call(e)},onHide:function(){var e,t;null===(e=r.aiLifeCyclesFunction)||void 0===e||null===(t=e.onHide)||void 0===t||t.call(e)}}}),a=new Z(this.services.uiDataService,this.services.selectionService,this.services.themeColorManager),n.registerCustomAgents([new P(a,this,this.services.uiDataService,this.services.masterLayoutEditService,this.services.slideSizeService)]),e.next=9,this.services.aiReplaceImageService.promise();case 9:return i=e.sent,n.registerCustomTaskCards({"solid-palette":ce(a),"grad-palette":le,"slide-tips":me,"slide-search-images":we(i)}),e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"attachListener",value:function(){var e,t=this;this.editorReaction=Object(k.r)((function(){var e,n,a,i,r,o,c,l;return{isPropertyEditorShown:null===(e=t.services)||void 0===e||null===(n=e.rightSideBarManager)||void 0===n?void 0:n.isPropertyEditorShown,isAnimationEditorShown:null===(a=t.services)||void 0===a||null===(i=a.rightSideBarManager)||void 0===i?void 0:i.isAnimationEditorShown,isPlaying:null===(r=t.services)||void 0===r||null===(o=r.playManager)||void 0===o?void 0:o.isPlaying,isMasterEditType:null===(c=t.services)||void 0===c||null===(l=c.masterLayoutEditService)||void 0===l?void 0:l.isMasterEditType}}),(function(e){var n=e.isPropertyEditorShown,a=e.isAnimationEditorShown,i=e.isPlaying,r=e.isMasterEditType;(n||a||i||r)&&t.hideSideBar()})),null===(e=this.getHistoryManager())||void 0===e||e.on("show",this.onHistoryShow)}},{key:"removeListener",value:function(){var e,t;null===(e=this.editorReaction)||void 0===e||e.call(this),null===(t=this.getHistoryManager())||void 0===t||t.off("show",this.onHistoryShow)}},{key:"getHistoryManager",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.historyManager}}]),l}(E.a)},"17d54d24b1":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".accusation-service-userReport-mask-1ZfsV{background-color:#000;opacity:.2;z-index:6007;width:100%;height:100%}.accusation-service-userReport-container-2bvLY,.accusation-service-userReport-mask-1ZfsV{position:absolute;left:0;top:0;margin:auto}.accusation-service-userReport-container-2bvLY{width:381px;height:338px;z-index:9007;right:0;bottom:0;background:none;background-color:none}.accusation-service-userReport-frame-20aGh{position:relative;width:100%;height:100%;border:none}",""]),t.locals={"userReport-mask":"accusation-service-userReport-mask-1ZfsV","userReport-container":"accusation-service-userReport-container-2bvLY","userReport-frame":"accusation-service-userReport-frame-20aGh"}},"19f0bdbef9":function(e,t,n){"use strict";var a,i=n("176815363d"),r=n.n(i),o=n("3ef2352f0b"),c=n.n(o),l=(n("c6244f7705"),n("081c8cafea"),n("0d2ffd3bdb")),s=(n("b1e2246d82"),n("963f2eaace"),n("8fa580e5fd"),n("48cf2b24ba")),d=n("dd1b838932"),u=n("020899bf26"),p=n("3bd887f5ab");function f(){return v.apply(this,arguments)}function v(){return(v=r()(c.a.mark((function e(){var t,n,a,i,r,o,l,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.extensionService.getExtension(p.a.name);case 2:t=e.sent,n=u.a.DocInfoManager()||{},a=n.domainId,i=n.padId,r=n.localPadId,o=Object(d.getPathname)(),l=o.slice(o.lastIndexOf("/")+1),f={padType:s.a.Slide,domainId:a,docId:l,padId:i||r},t.show(f);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.TemplateMall="templatemall",e.Vip="vip",e.Desktop="desktop"}(a||(a={}));var m,h,b=n("37091e4240"),g=Object(l.createExtensionService)({metadataLoaderOptions:{specifiedVersion:1}}),y={initPromise:new Promise((function(e){return m=e})),extensionService:g,init:(h=r()(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.scanAndHandleExtensions(t);case 2:m(),b.b.onIncludingPast(b.a.VISIBLE_PAGE_DISPLAY,(function(){f()}));case 4:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},x=t.a=y},"1d6e84dd0c":function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));n("73b854064b");var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("547611bd96"),d=n.n(s),u=n("bd29e2df90"),p=n.n(u),f=n("ab5eb40518"),v=n.n(f),m=n("1b4cdd6a36"),h=n.n(m),b=n("85d0a7609b"),g=n.n(b),y=n("3ef2352f0b"),x=n.n(y),S=(n("3bf1976a4f"),n("c6244f7705"),n("081c8cafea"),n("1bab7b5fb7"),n("34cd92f77a"),n("b1e2246d82"),n("659f690fe6")),w=n("77c89fc0e0");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var E="read-record",T=function(e){p()(n,e);var t=A(n);function n(e){var a;return o()(this,n),a=t.call(this),g()(d()(a),"readRecordPlugin",void 0),a.readRecordPlugin=e,a}return l()(n,[{key:"name",get:function(){return E}},{key:"show",value:function(){var e=this;this.readRecordPlugin.showModule(this.DOMNode,(function(){e.showWrapper()}),(function(){e.hideWrapper()})).then((function(){}))}},{key:"wrapperDidHide",value:function(){this.readRecordPlugin.removeModule()}}]),n}(w.g),k=n("19f0bdbef9"),I=n("e7c4e8f59c"),O=n("8b13fcae36"),C=n("020899bf26");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var D=function(e){p()(a,e);var t,n=P(a);function a(){var e;o()(this,a);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e=n.call.apply(n,[this].concat(i)),g()(d()(e),"extension",void 0),e}return l()(a,[{key:"initPlugin",value:function(){var e;null===(e=this.editExtensionService)||void 0===e||e.registerRightSideBarModule(new T(this))}},{key:"showModule",value:(t=i()(x.a.mark((function e(t,n,a){var i,r,o,c,l,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=C.a.DocInfoManager()||{},r=i.userId,o=i.domainId,c=i.padId,l=i.creatorDomain,s=null==r?void 0:r.replace(/^p\./,""),e.next=4,k.a.extensionService.getExtension(I.a.name);case 4:this.extension=e.sent,this.extension.show({container:t,creatorDomain:l,domainId:o,padId:c,userId:s,onClose:a}),null==n||n();case 7:case"end":return e.stop()}}),e,this)}))),function(e,n,a){return t.apply(this,arguments)})},{key:"removeModule",value:function(){var e;null===(e=this.extension)||void 0===e||e.hide(),this.extension=void 0}},{key:"show",value:function(){var e;null===(e=this.editExtensionService)||void 0===e||e.showRightSideBar(E)}},{key:"showOnMobile",value:function(){var e=C.a.DocInfoManager()||{},t=e.domainId,n=e.padId,a=e.creatorDomain,i="padId=".concat(n,"&domId=").concat(t,"&cd=").concat(a);if(w.i.isMiniProgram)window.wx&&window.wx.miniProgram.navigateTo({url:"/pages/readRecord/readRecord?".concat(i)});else if(window.mqq){var r,o,c;null===(r=window.mqq)||void 0===r||null===(o=r.ui)||void 0===o||null===(c=o.openUrl)||void 0===c||c.call(o,{url:"https://".concat(window.hostname,"/components/docs/ReadRecord.html?").concat(i,"&_wv=3&from=desktop_m"),target:1,style:1})}else{var l="https://".concat(window.hostname,"/components/docs/ReadRecord.html?").concat(i,"&_wv=3&from=desktop_m");Object(O.setNewWindowUrl)(window,l)}}}]),a}(S.a),M={name:"no-edit-read-record",plugin:D}},"2026a1094a":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"Modal",(function(){return L})),n.d(t,"AnonymousStatus",(function(){return a})),n.d(t,"AnonymousViewService",(function(){return _}));var a,i=n("176815363d"),r=n.n(i),o=n("9132715560"),c=n.n(o),l=n("6a364eb35c"),s=n.n(l),d=n("85d0a7609b"),u=n.n(d),p=n("3ef2352f0b"),f=n.n(p),v=(n("b1e2246d82"),n("c6244f7705"),n("081c8cafea"),n("8ee19818c4"),n("bd80bf2d0f"),n("41858aeaba")),m=n("b8e6877859"),h=n("b40469cb12"),b=n("020899bf26"),g=n("f2b6d66c40"),y=n("9049777d9b"),x=n("4f3b15d017"),S=n("52d461bc51"),w=n.n(S),A=n("8980a7557e"),E=n.n(A),T=n("5cdbac46e8"),k=n("a8236551f7"),I=n("aba9dcef64"),O=n("9d300b2194"),C=n("82f2dc9440"),P=n.n(C),D=n("b74ee0edd6"),M=n.n(D),L=x.default.isMobile?E.a:w.a,R=x.default.isMobile?M.a:P.a;!function(e){e[e.NONE=O.a.NONE]="NONE",e[e.OPEN=O.a.OPEN]="OPEN",e[e.CLOSED=O.a.CLOSED]="CLOSED",e[e.EXPIRED=3]="EXPIRED"}(a||(a={}));var _=function(){function t(){var e=this;c()(this,t),u()(this,"anonymousStatus",void 0),u()(this,"isExpired",!1),u()(this,"events",Object(m.a)()),u()(this,"modalInstance",void 0),u()(this,"userPrivilegeService",void 0),u()(this,"rightSidebarService",void 0),u()(this,"hideRightSidebar",(function(t){if(t!==T.a.EDITABLE&&(e.anonymousStatus&&![k.a.NOTIFY,k.a.SHORTCUT,k.a.READ_RECORD].some((function(t){return e.rightSidebarService.isShown(t)})))){var n=e.rightSidebarService;if(n){var a=n.getVisibleModule();if((null==a?void 0:a.name)===k.a.HISTORY)a.historyManager.canUpdateEditorState=!1;e.rightSidebarService.hide()}}})),u()(this,"toggleHistoryEntryStatus",function(){var e=r()(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.extensionService.getExtension("docs-component-save-tips");case 2:e.sent.store.dispatch.saveTips.setShouldShowSaveTips(t===T.a.EDITABLE);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var n,i,o,l,d,p;return s()(t,[{key:"setServiceDelegates",value:function(e){var t=this;this.userPrivilegeService=e.userPrivilegeService,this.rightSidebarService=e.rightSidebarService,x.default.isPC&&[this.toggleHistoryEntryStatus,this.hideRightSidebar].forEach((function(e){t.userPrivilegeService.onPPTEditorStateChange(e)})),this.userPrivilegeService.addStateWillChangeCallbacks((function(e){return e!==T.a.EDITABLE||!t.anonymousStatus}))}},{key:"listenStatusChange",value:(p=r()(f.a.mark((function e(){var t,n,i=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.SDKDataServices.EventManager.promise();case 2:return t=e.sent,e.next=5,I.a.CursorManager.promise();case 5:n=e.sent,t.socketEvents.onAnonymousChange((function(e){var t,r,o,c=e.status,l=e.operator,s=null===(t=b.a.ClientVarsService())||void 0===t||null===(r=t.getClientVars)||void 0===r?void 0:r.call(t),d=(null==s||null===(o=s.userInfo)||void 0===o?void 0:o.uid)||"";n.userManager.updateUserInfoCache(),l===d&&(i.anonymousStatus=c===a.OPEN,i.isExpired=c===a.EXPIRED,i.setPPTEditorState(),i.events.emit("ANONYMOUS_CHANGE"))}));case 7:case"end":return e.stop()}}),e)}))),function(){return p.apply(this,arguments)})},{key:"getAnonymousViewStatus",value:(d=r()(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getRealAnonymousViewStatus();case 3:return(t=e.sent)===a.EXPIRED?this.isExpired=!0:this.isExpired=!1,n=t===a.OPEN,this.anonymousStatus=n,this.setPPTEditorState(),e.abrupt("return",this.anonymousStatus);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",this.anonymousStatus);case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return d.apply(this,arguments)})},{key:"setAnonymousViewStatus",value:(l=r()(f.a.mark((function t(){var n,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getAnonymousViewStatus();case 3:return n=t.sent,t.next=6,h.a.extensionService.scanAndHandleExtensions([v.a]);case 6:return t.next=8,h.a.extensionService.getExtension(v.a.name);case 8:t.sent.show({guideType:"setPersonalizeAnonymous",anonymousStatus:n?a.OPEN:a.CLOSED,position:"titlebar",onError:function(e){console.error(e),this.getAnonymousViewStatus()}}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),null===(i=e.log)||void 0===i||i.error(t.t0),this.getAnonymousViewStatus();case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return l.apply(this,arguments)})},{key:"showAnonymousEditModal",value:function(e,t){var n=this;!this.modalInstance&&this.anonymousStatus&&(this.modalInstance=L.confirm({title:g.default.t("提示"),destroyOnClose:!0,content:g.default.t("编辑内容时，将取消隐身查看设置，点击确定取消隐身。"),style:{maxWidth:450},maskStyle:{zIndex:1e4},onOk:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){n.handleConfirm(),Object(y.h)({module:"close",opername:"doc_vip_invisible",action:"click",ver9:x.default.isMobile?"mobile_editpopup":"pc_editsnackbar"}),n.modalInstance=null,null==e||e()})),onClose:function(){n.modalInstance=null,null==t||t()},onCancel:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){n.modalInstance=null,null==t||t()}))}),Object(y.h)({module:"close",opername:"doc_vip_invisible",action:"show",ver9:x.default.isMobile?"mobile_editpopup":"pc_editsnackbar"}))}},{key:"setRealAnonymousViewStatus",value:(o=r()(f.a.mark((function e(t){var n,a,i,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null!==(n=null===(a=b.a.DocInfoManager())||void 0===a?void 0:a.padId)&&void 0!==n?n:"",e.next=3,h.a.extensionService.dependentServiceCombinder.collaborateDomain.collaborateAggregate.setPersonalizeAnonymous(t,i);case 3:return r=e.sent,o=r.resData,e.abrupt("return",!(null==o||!o.data));case 6:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"getRealAnonymousViewStatus",value:(i=r()(f.a.mark((function e(){var t,n,a,i,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null!==(t=null===(n=b.a.DocInfoManager())||void 0===n?void 0:n.padId)&&void 0!==t?t:"",e.next=3,h.a.extensionService.dependentServiceCombinder.collaborateDomain.collaborateAggregate.getPersonalizeAnonymous(i);case 3:return r=e.sent,o=r.resData,e.abrupt("return",(null==o||null===(a=o.data.result)||void 0===a?void 0:a.status)||0);case 6:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"setPPTEditorState",value:function(){var e=this.anonymousStatus?T.a.COPYABLE:this.userPrivilegeService.fileAuth;this.userPrivilegeService.setPPTEditorState({state:e})}},{key:"handleConfirm",value:(n=r()(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.setRealAnonymousViewStatus(O.a.CLOSED);case 3:t.sent?(this.anonymousStatus=!1,this.setPPTEditorState()):this.showFailTips(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),null===(n=e.log)||void 0===n||n.error(t.t0),this.showFailTips();case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})},{key:"showFailTips",value:function(){R.show({message:g.default.t("取消隐身查看失败"),type:"info",duration:3e3})}}]),t}()}.call(this,n("5ef37df1a0"))},"2805ad1ce5":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-template-select-container-2e3EG{width:100%;height:100%;overflow-y:auto;display:flex;flex-wrap:wrap;justify-content:flex-start;align-content:flex-start}.index-template-detail-list-container-ZJzhb{width:100%;box-sizing:content-box;padding:16px 8px 0 16px;height:539px;overflow-y:scroll}",""]),t.locals={"template-select-container":"index-template-select-container-2e3EG","template-detail-list-container":"index-template-detail-list-container-ZJzhb"}},"2abe3146de":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var a=n("c92b994f13"),i=a(n("4fa24ed6b1")),r=a(n("fc72e90596")),o=a(n("f988910aa7")),c=a(n("72c29dca8f")),l=a(n("1d8bb7a515")),s=a(n("778753cce7"));t.push([e.i,".index-template-detail-list-item-container-3Tkit{width:100%;margin-bottom:16px}.index-template-detail-list-container-1lM7W{width:100%}.index-template-detail-list-item-title-breadcrumb-SZGjc{width:100%;margin-bottom:16px;height:20px;display:flex;justify-content:start}.index-template-detail-list-item-title-breadcrumb-SZGjc .index-bread-crumb-back-1bEQp{cursor:pointer;font-size:14px;font-weight:400;line-height:20px;color:rgba(0,0,0,.48);margin-right:8px}.index-template-detail-list-item-title-breadcrumb-SZGjc .index-bread-crumb-back-arrow-2HbsX{position:relative;top:2px;width:16px;height:16px;background:url("+i+") 50%;background-size:cover;margin-right:8px}.index-template-detail-list-item-title-breadcrumb-SZGjc .index-title-text-cMbeQ{font-size:14px;font-weight:600;line-height:20px;color:rgba(0,0,0,.88)}.index-template-detail-list-item-title-1od2f{width:100%;margin-bottom:16px;height:20px;display:flex;justify-content:space-between}.index-template-detail-list-item-title-1od2f .index-title-text-cMbeQ{font-size:14px;font-weight:600;line-height:20px;color:rgba(0,0,0,.88)}.index-template-detail-list-item-title-1od2f .index-title-more-2_R1J{font-size:12px;font-style:normal;font-weight:400;line-height:20px;width:68px;position:relative;cursor:pointer}.index-template-detail-list-item-title-1od2f .index-title-more-2_R1J .index-title-arrow-2mBL6{width:20px;height:20px;position:absolute;right:0;top:0;background:url("+i+") 50%;background-size:cover}.index-template-detail-list-item-card-container-3bwd_{width:100%;display:flex;justify-content:start;margin-right:16px;flex-wrap:wrap}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy:hover>.index-card-mask-1KfPH{visibility:visible}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy{box-sizing:content-box;width:198px;height:163px;border-radius:4px;border:1px solid rgba(0,0,0,.08);background:#fff;box-shadow:0 1px 4px 0 rgba(0,0,0,.08);position:relative}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-load-1KcQw{background:rgba(0,0,0,.64);width:100%;height:100%;position:absolute;left:0;top:0;border-radius:4px;display:flex;justify-content:center;align-items:center;pointer-events:none}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-load-1KcQw .index-card-loading-3afGt{width:100%;font-size:14px;font-weight:400;line-height:24px;color:hsla(0,0%,100%,.92);display:flex;flex-wrap:nowrap;justify-content:center}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-load-1KcQw .index-card-loading-3afGt .index-card-loading-icon-1dTvf{height:24px;width:24px;margin-right:4px}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-load-1KcQw .index-card-loading-3afGt .index-card-loaded-icon-3noy3{height:24px;width:24px;margin-right:4px;background:url("+r+");background-size:cover}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-load-1KcQw .index-card-loading-3afGt .index-card-loading-text-1KLAw{height:24px}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-mask-1KfPH{background:rgba(0,0,0,.64);width:100%;height:100%;position:absolute;left:0;top:0;visibility:hidden;border-radius:4px;display:flex;justify-content:center;align-items:center}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-mask-1KfPH .index-card-preview-button-2-VZN{width:36px;height:36px;display:flex;justify-content:center;align-items:center;background:#fff;border-radius:4px;cursor:pointer}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-mask-1KfPH .index-card-preview-button-2-VZN .index-card-preview-button-icon-2_0HM{width:20px;height:20px;background:url("+o+");background-size:cover}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-cover-1z6jW{width:164px;height:93px;margin:16px 16px 0;background-repeat:no-repeat;background-position:0 0;border:1px solid rgba(0,0,0,.08);border-radius:4px}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-cover-1z6jW .index-cover-border-tNWeC{border:1px solid rgba(0,0,0,.08);border-radius:4px}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-cover-1z6jW .index-cover-img-1QV-Y{border-radius:4px;box-sizing:border-box;width:100%;height:100%}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-title-1RXSq{width:168px;height:20px;padding:16px;position:relative;display:flex;justify-content:flex-start;flex-wrap:nowrap}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-title-1RXSq .index-card-title-icon-vhSiP{margin:2px;width:16px;height:16px;background:url("+c+") 50%;background-size:cover;flex-shrink:0}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-title-1RXSq .index-card-title-text-BqWEP{flex-shrink:1;height:20px;font-size:14px;font-weight:600;line-height:20px;color:rgba(0,0,0,.88);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-title-1RXSq .index-card-vip-icon-3m3CH{flex-shrink:0;margin:2px 2px 2px 4px;width:16px;height:16px;background-size:cover}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-title-1RXSq .index-card-vip-icon-3m3CH.index-super-vip-31nd5,.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-title-1RXSq .index-card-vip-icon-3m3CH.index-vip-1jzE1{background-image:url("+l+")}.index-template-detail-list-item-card-container-3bwd_ .index-card-container-1sAcy .index-card-title-1RXSq .index-card-vip-icon-3m3CH.index-pay-by-price-1k_Vn{background-image:url("+s+")}",""]),t.locals={"template-detail-list-item-container":"index-template-detail-list-item-container-3Tkit","template-detail-list-container":"index-template-detail-list-container-1lM7W","template-detail-list-item-title-breadcrumb":"index-template-detail-list-item-title-breadcrumb-SZGjc","bread-crumb-back":"index-bread-crumb-back-1bEQp","bread-crumb-back-arrow":"index-bread-crumb-back-arrow-2HbsX","title-text":"index-title-text-cMbeQ","template-detail-list-item-title":"index-template-detail-list-item-title-1od2f","title-more":"index-title-more-2_R1J","title-arrow":"index-title-arrow-2mBL6","template-detail-list-item-card-container":"index-template-detail-list-item-card-container-3bwd_","card-container":"index-card-container-1sAcy","card-mask":"index-card-mask-1KfPH","card-load":"index-card-load-1KcQw","card-loading":"index-card-loading-3afGt","card-loading-icon":"index-card-loading-icon-1dTvf","card-loaded-icon":"index-card-loaded-icon-3noy3","card-loading-text":"index-card-loading-text-1KLAw","card-preview-button":"index-card-preview-button-2-VZN","card-preview-button-icon":"index-card-preview-button-icon-2_0HM","card-cover":"index-card-cover-1z6jW","cover-border":"index-cover-border-tNWeC","cover-img":"index-cover-img-1QV-Y","card-title":"index-card-title-1RXSq","card-title-icon":"index-card-title-icon-vhSiP","card-title-text":"index-card-title-text-BqWEP","card-vip-icon":"index-card-vip-icon-3m3CH","super-vip":"index-super-vip-31nd5",vip:"index-vip-1jzE1","pay-by-price":"index-pay-by-price-1k_Vn"}},"2dc38956e5":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var a=n("c92b994f13")(n("4154aaa58b"));t.push([e.i,".palette-card-colorList-2r_7A{display:flex;justify-content:space-between;width:270px}.palette-card-color-1IBdh{cursor:pointer;width:30px;height:30px;border:1.5px solid transparent;border-radius:50%;padding:1.5px;background:content-box}.palette-card-color-1IBdh.palette-card-selected-1Yqta,.palette-card-color-1IBdh:hover{border:1.5px solid #00a3f5}.palette-card-palette-xeR2e{background-image:url("+a+");background-size:100%}.palette-card-sliderWrapper-2u7KD *{box-sizing:border-box!important}.palette-card-sliderWrapper-2u7KD input{border-radius:6px!important;background:transparent!important}",""]),t.locals={colorList:"palette-card-colorList-2r_7A",color:"palette-card-color-1IBdh",selected:"palette-card-selected-1Yqta",palette:"palette-card-palette-xeR2e",sliderWrapper:"palette-card-sliderWrapper-2u7KD"}},"3b24fb4804":function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a=n("7a5536c9bf"),i=n.n(a),r=n("85d0a7609b"),o=n.n(r),c=n("9132715560"),l=n.n(c),s=n("6a364eb35c"),d=n.n(s),u=(n("b8217400dc"),n("e6f68cdf2e"),n("b1e2246d82"),n("9657b29818")),p=n("e0e8dd9366"),f=n("c9c92622ff"),v=n("c13f133f92"),m=n("0cbec907c5"),h=n("b00adb794a"),b=n("6b7f29d5c0"),g=n("b0233a497a");function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=100,w=function(){function e(){l()(this,e)}return d()(e,null,[{key:"switch",value:function(t,n){return e.isSwitchToShapeModel(t,n)?e.switchToShapeModel(t,n):e.isSwitchToPictureModel(t,n)?e.switchToPictureModel(t,n):void 0}},{key:"isSwitchToShapeModel",value:function(e,t){return[m.n.TEXT,m.n.SIMPLE_TEXT,m.n.CARD].includes(t)}},{key:"isSwitchToPictureModel",value:function(e,t){return e.type===p.d.SHAPE&&t===m.n.PREVIEW}},{key:"switchToShapeModel",value:function(e,t){var n,a=e.slideRef,i=x(x(x({},Object(b.a)(e)),this.getPosterInfo(e)),{},{showType:t}),r=(null===(n=e.props)||void 0===n?void 0:n.style)||{},o=r.left,c=r.top,l=this.getShapeModelProps(i,o,c,t),s=this.getShapeModelExtraInfo(e,i);this.changeElementAndSelect(a,e,[[p.d.SHAPE],[l],[s]])}},{key:"switchToPictureModel",value:function(e,t){var n,a=e.slideRef,i=(null===(n=e.props)||void 0===n?void 0:n.style)||{},r=i.left,o=i.top,c=x(x({},e.props.attachment),{},{showType:t}),l=this.getImageModelProps(c,r,o),s=this.getImageModelExtraInfo(c);this.changeElementAndSelect(a,e,[[p.d.IMAGE],[l],[s]])}},{key:"changeElementAndSelect",value:function(e,t,n){var a,r;Object(u.b)((function(){e.deleteElement([t]),e.addElement.apply(e,i()(n))}));var o=e.children[e.children.length-1];null===(a=e.selectionService)||void 0===a||a.selectedElements.clear(),null===(r=e.selectionService)||void 0===r||r.selectedElements.add(o)}},{key:"getImageModelProps",value:function(e,t,n){var a={bgShape:v.b.RECT,left:t||S,top:n||S};switch(e.classify){case m.b.VIDEO:var i,r,o=Object(g.b)(null===(i=e.posterInfo)||void 0===i?void 0:i.url),c=Object(g.d)(o),l=c.width,s=c.height;return{src:(null===(r=e.posterInfo)||void 0===r?void 0:r.url)||m.z,style:x(x({},a),{},{width:l,height:s})};case m.b.AUDIO:return{src:m.a,style:x(x({},a),{},{width:m.e,height:m.d})};case m.b.IMAGE:var d,u,p=Object(g.b)(null===(d=e.posterInfo)||void 0===d?void 0:d.url),f=Object(g.c)(p),h=f.width,b=f.height;return{attachment:e,src:null===(u=e.posterInfo)||void 0===u?void 0:u.url,style:x(x({},a),{},{width:h,height:b})}}}},{key:"getImageModelExtraInfo",value:function(e){var t=e.objKey,n=e.type,a=e.size;switch(e.classify){case m.b.VIDEO:return{video:{link:t,format:n,size:a},name:e.name};case m.b.AUDIO:return{audio:{link:t,format:n,size:a},name:e.name};case m.b.IMAGE:return{name:e.name}}}},{key:"getShapeModelProps",value:function(e,t,n,a){return a===m.n.TEXT||a===m.n.SIMPLE_TEXT?{attachment:e,style:{bgShape:v.b.RECT,left:t||S,top:n||S},subType:h.a.TEXT_ELEMENT}:a===m.n.CARD?{attachment:e,style:{bgShape:v.b.RECT,left:t||S,top:n||S,width:m.g,height:m.f},subType:h.a.SHAPE}:void 0}},{key:"getShapeModelExtraInfo",value:function(e,t){var n;return null===(n=e.getAttachmentManager())||void 0===n?void 0:n.getAttachmentExtraInfo(t)}},{key:"getPosterInfo",value:function(e){return Object(f.G)(e)||Object(f.b)(e)?{posterInfo:{url:e.props.src}}:null}}]),e}()},"3bd887f5ab":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={name:"docs-component-common-loader",loadType:n("0d2ffd3bdb").LoadType.EAGER}},"4154aaa58b":function(e,t){e.exports="//docs.gtimg.com/slide/img/slide/application/service/ai/core/pc/task/background-fill/components/palette-ceec98.png"},"45770891c9":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n("342844cefa"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a=n("9132715560"),i=n.n(a),r=n("6a364eb35c"),o=n.n(r),c=n("85d0a7609b"),l=n.n(c),s=(n("a84962d637"),n("f45588a8ad"),n("c6244f7705"),n("3bf1976a4f"),n("2df8131d1b"));function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=new(function(){function e(){i()(this,e),l()(this,"markMap",{})}return o()(e,[{key:"start",value:function(e,t){var n=this;this.markMap[e]||(this.markMap[e]={});var a=this.markMap[e],i=Symbol(e);return a[i]={startTime:performance.now(),reportData:t},this.report({eventName:e,action:"start"},t),{uniqueId:i,success:function(t){return n.success(e,i,t)},fail:function(t){return n.fail(e,i,t)}}}},{key:"success",value:function(e,t,n){this.end("success",e,t,n)}},{key:"fail",value:function(e,t,n){this.end("fail",e,t,n)}},{key:"end",value:function(e,t,n,a){var i=this.markMap[t],r=null==i?void 0:i[n];if(r){var o=performance.now()-r.startTime;this.report({eventName:t,action:e,duration:o},u(u({},r.reportData),a)),delete i[n]}}},{key:"report",value:function(e,t){"start"===e.action?s.a.getInstance().aegis.reportEvent(u({name:"".concat(e.eventName,"-").concat(e.action)},t)):(s.a.getInstance().aegis.reportEvent(u({name:"".concat(e.eventName,"-").concat(e.action)},t)),s.a.getInstance().aegis.reportT(u({name:e.eventName,duration:e.duration},t)))}}]),e}())},"45f26372f8":function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),p=n.n(u),f=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("1bab7b5fb7"),n("9d7978d445"),n("081c8cafea"),n("8ee19818c4"),n("b1e2246d82"),n("3bf1976a4f"),n("f84436e584"),n("39cb6f3a5e")),v=n("82f2dc9440"),m=n.n(v),h=(n("bd80bf2d0f"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("798a9cd6f2")),b=n("d3d31c86eb"),g=n("3b24c833e2"),y=n("9da6335152"),x=n("5fac0349d3"),S=n("ba4ddefc1e"),w=n("e0e8dd9366"),A=n("fb75408061"),E=n("3825cc7c15"),T=n("cd1934c1b5"),k=n("775b80aea6");function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(){function e(t,n){var a,r,c=this;o()(this,e),d()(this,"insertDocElementFnMap",void 0),d()(this,"updateDocElementFnMap",void 0),d()(this,"getCursor",(function(){})),d()(this,"getSelectedDocElements",i()(p.a.mark((function e(){var t,n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Multiply"!==(null==(t=c.selectionService.getSelectedModel())?void 0:t.type)){e.next=6;break}return n=t.selectedModels,a=[],(void 0===n?[]:n).forEach(function(){var e=i()(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.parseSelectedModel(t);case 2:n=e.sent,a.push(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",a);case 6:if(!t){e.next=11;break}return e.next=9,c.parseSelectedModel(t);case 9:return r=e.sent,e.abrupt("return",[r]);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})))),d()(this,"insertDocElement",(function(e){var t=f.DocAddonBridge.getDocElementType(e),n=c.insertDocElementFnMap[t];null==n||n(e)})),d()(this,"updateDocElement",(function(e){var t=f.DocAddonBridge.getDocElementType(e),n=c.updateDocElementFnMap[t];null==n||n(e)})),d()(this,"uploadImage",(function(e){return h.c&&e?new Promise((function(t,n){Object(g.a)({blob:e}).then((function(e){var n=e.url,a=e.width,i=e.height,r=Object(E.a)(n,{w:a,h:i});t(r)})).catch((function(e){n(e)}))})):Promise.resolve("")})),d()(this,"getAddonIframeOptions",(function(e){return{title:e.displayText||"",embedUrl:e.embedURL,originUrl:e.originURL,width:e.width,height:e.height,aid:e.addonId,extraData:e.extraData,mode:A.b.IFRAME,docElement:e}})),d()(this,"importSlide",function(){var e=i()(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=c.addonManagerDelegate.importFileManagerDelegate)||void 0===n?void 0:n.promise();case 2:return a=e.sent,e.abrupt("return",null==a?void 0:a.parseAndInsertISlideFile(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"getDocConfigService",(function(){return{getLanguage:function(){return x.a.language}}})),d()(this,"getDocEditorService",(function(){return{getCursor:c.getCursor,getSelectedDocElements:c.getSelectedDocElements,insertDocElement:c.insertDocElement,updateDocElement:c.updateDocElement}})),d()(this,"getDocAdvancedService",(function(){return{uploadImage:c.uploadImage,importSlide:c.importSlide,callOCR:c.addonManagerDelegate.uploadPictureFormulaOcr}})),d()(this,"getAddonDialogOptions",(function(e){return{aid:e.id,html:e.src,title:e.title||"",width:e.width||0,height:e.height||0,hiddenClose:!1,hiddenHeader:!1}})),d()(this,"onLoadDialog",(function(){})),d()(this,"insertImageAddonElement",(function(e){c.addonManagerDelegate.insertAddonPicture(e)})),d()(this,"insertWebAddonElement",(function(e){var t=c.getAddonIframeOptions(e);c.addonManagerDelegate.insertIframeContainer(t),Object(b.c)({opername:y.e.DOC_ADDON_PLATFORM,module:y.d.ADDON_IFRAME,action:y.b.ADDON_INSERT,ver6:t.aid})})),d()(this,"updateImageAddonElement",(function(e){c.addonManagerDelegate.updateAddonPicture(e)})),d()(this,"updateWebAddonElement",(function(e){c.addonManagerDelegate.refreshIframe(e.originURL,e.embedURL,e.displayText)})),d()(this,"getRandomAnchorId",(function(){return Math.random().toString(36).substr(2,6)})),d()(this,"getAddonElementForNotAddon",function(){var e=i()(p.a.mark((function e(t){var n,a,i,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==w.d.IMAGE){e.next=14;break}if(a=(null===(n=t.props)||void 0===n?void 0:n.src)||"",!T.a.isBlobUrl(a)){e.next=13;break}if(i=k.a.getInstance().getResourceByUrl(a),!(r=null==i?void 0:i.getCdnUrl())){e.next=9;break}a=r,e.next=13;break;case 9:return o=new Promise((function(e,t){null==i||i.onDidUpload((function(t){e(t.getCdnUrl())})),null==i||i.onUploadError((function(){t("")}))})),e.next=12,o;case 12:a=e.sent;case 13:return e.abrupt("return",{anchorId:t.key,addonId:"",src:a,sourceType:f.ImageSourceType.PIC});case 14:return e.abrupt("return",{});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"parseSelectedModel",function(){var e=i()(p.a.mark((function e(t){var n,a,i,r,o,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null==t||null===(n=t.props)||void 0===n?void 0:n.addon,null==t||!t.isTextMath){e.next=3;break}return e.abrupt("return",{anchorId:t.key||c.getRandomAnchorId(),addonId:S.a,extraData:"",src:(null===(i=t.props)||void 0===i||null===(r=i.style)||void 0===r||null===(o=r.fillBackground)||void 0===o||null===(l=o.image)||void 0===l?void 0:l.src)||"",sourceType:f.ImageSourceType.LATEX});case 3:if(a){e.next=7;break}return e.next=6,c.getAddonElementForNotAddon(t);case 6:return e.abrupt("return",e.sent);case 7:if(null==a||!a.docElement){e.next=9;break}return e.abrupt("return",O(O({},a.docElement),{},{displayText:a.title}));case 9:if(null==a||!a.iframeId){e.next=11;break}return e.abrupt("return",{anchorId:c.getRandomAnchorId(),addonId:a.iframeId,extraData:a.extraData,embedURL:a.embedUrl,originURL:a.originUrl,displayText:a.title});case 11:if("latex"!==(null==a?void 0:a.type)){e.next=13;break}return e.abrupt("return",{anchorId:c.getRandomAnchorId(),addonId:a.aid,extraData:a.extraData,src:(null===(s=t.props)||void 0===s?void 0:s.src)||"",sourceType:f.ImageSourceType.LATEX});case 13:return e.abrupt("return",{});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.addonManagerDelegate=t,this.selectionService=n,this.insertDocElementFnMap=(a={},d()(a,f.DocElementType.IMAGE,this.insertImageAddonElement),d()(a,f.DocElementType.WEB,this.insertWebAddonElement),a),this.updateDocElementFnMap=(r={},d()(r,f.DocElementType.IMAGE,this.updateImageAddonElement),d()(r,f.DocElementType.WEB,this.updateWebAddonElement),r)}return l()(e,[{key:"docService",get:function(){return{config:this.getDocConfigService(),ui:{},editor:this.getDocEditorService(),advanced:this.getDocAdvancedService()}}}]),e}(),P=n("3404d6c52c"),D=n.n(P),M=n("020899bf26"),L=function(){function e(t,n,a){var i,r,c=this;o()(this,e),d()(this,"addonContentContainerMap",new Map),d()(this,"addonInfoMap",new Map),d()(this,"addonMetaMap",new Map),d()(this,"addonAbility",void 0),d()(this,"isLoadAddonInfoList",!1),d()(this,"docAddonBridge",void 0),d()(this,"event",void 0),this.api=t,this.selectionService=a;var l=null===(i=M.a.ClientVarsService())||void 0===i||null===(r=i.getClientVars)||void 0===r?void 0:r.call(i);this.event=this.api.event,this.addonAbility=new C(n,a),this.docAddonBridge=f.DocAddonBridge,l&&this.getAddonInfo(),M.a.ClientVarsService.promise().then((function(e){e.getClientVars()||c.getAddonInfo()}))}var t,n;return l()(e,[{key:"executeMenuAction",value:function(e,t){var n,a,i,r,o=null==t||null===(n=t.split("_"))||void 0===n?void 0:n[1],c=null===(a=this.addonMetaMap.get(e))||void 0===a||null===(i=a.config)||void 0===i||null===(r=i.menus)||void 0===r?void 0:r[o],l=null==c?void 0:c.actionStore;return this.docAddonBridge.executeMenuAction(e,l).catch((function(e){m.a.show({message:e,autoClose:!0,type:"error"})}))}},{key:"openAddonPanel",value:(n=i()(p.a.mark((function e(t,n){var a,i,r,o,c,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.DocAddonBridge.getAddon(t,{shouldGetLatest:!0});case 2:return i=e.sent,(null==(r=this.selectionService.getSelectedModel())?void 0:r.type)===w.d.IMAGE&&(l=(null===(c=r.props)||void 0===c?void 0:c.src)||"",T.a.isBlobUrl(l)&&((null==(s=k.a.getInstance().getResourceByUrl(l))?void 0:s.getCdnUrl())||(o=D.a.show({tip:x.a.t("正在插入图片..."),zIndex:11001})))),e.next=7,f.DocAddonBridge.fetchAddonMenu(t);case 7:return null===(a=o)||void 0===a||a.close(),e.next=10,f.DocAddonBridge.executeMenuAction(t,i.menuConfiguration);case 10:if(!n){e.next=13;break}return e.next=13,n();case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getDocData",value:function(){return{metaInfo:this.getGeneralParams(),service:this.addonAbility.docService}}},{key:"initAddonOptions",value:function(e){this.docAddonBridge.setup(e)}},{key:"getCompatibleAddon",value:function(e){var t,n=d()({},f.ActionName.DIALOG,2),a=e.menuConfiguration,i=[];if(Array.isArray(a)){var r=0,o=0;a.forEach((function(t){if(t.type!==f.MenuType.DIVIDE){var a=null==t?void 0:t.action;i.push({action:n[null==a?void 0:a.name],height:null==a?void 0:a.options.height,icon:t.icon,id:"".concat(e.addonId,"_").concat(r),name:null==a?void 0:a.options.title,page:null==a?void 0:a.options.src,report_id:null,title:t.title,width:null==a?void 0:a.options.width,actionStore:a,category:"cate-".concat(o)}),r+=1}else o+=1}))}else{var c=a;i.push({action:n[null==c?void 0:c.name],height:null==c?void 0:c.options.height,icon:e.icons.small,id:"".concat(e.addonId,"_0"),name:e.name,page:null==c?void 0:c.options.src,report_id:null,title:null==c?void 0:c.options.title,width:null==c?void 0:c.options.width,actionStore:c,description:e.shortDesc,subtitle:e.vendorName,imageUrl:e.icons.intro})}var l={};return l.aid=e.addonId,l.config={domains:(null==e||null===(t=e.config)||void 0===t?void 0:t.domains)||null,menus:i,name:e.name},l.file_path="//".concat(e.staticHost,"/").concat(e.staticPath),l}},{key:"getGeneralParams",value:function(){var e,t,n,a=null===(e=M.a.ClientVarsService())||void 0===e||null===(t=e.getClientVars)||void 0===t?void 0:t.call(e),i=(null==a?void 0:a.creatorId)||"",r=(null==a||null===(n=a.userInfo)||void 0===n?void 0:n.uid)||"";return{fileId:(null==a?void 0:a.globalPadId)||"",fileType:f.FileType.SLIDE,creatorId:i,uid:r}}},{key:"saveAddonInfo",value:function(e){this.addonInfoMap.set(e.addonId,e)}},{key:"saveAddonMeta",value:function(e){this.addonMetaMap.set(e.aid,e)}},{key:"saveContentContainer",value:function(e,t){this.addonContentContainerMap.set(e,t)}},{key:"fetchAddonInfoList",value:function(){return this.docAddonBridge.fetchAddonList()}},{key:"fetchContentContainer",value:(t=i()(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.docAddonBridge.fetchContentContainerConfiguration(t);case 2:return n=e.sent,this.saveContentContainer(t,n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}()},"465ab2c0ab":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return W}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("547611bd96"),d=n.n(s),u=n("bd29e2df90"),p=n.n(u),f=n("ab5eb40518"),v=n.n(f),m=n("1b4cdd6a36"),h=n.n(m),b=n("85d0a7609b"),g=n.n(b),y=n("3ef2352f0b"),x=n.n(y),S=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("081c8cafea"),n("75563bc376"),n("963f2eaace"),n("8ee19818c4"),n("b1e2246d82"),n("6e20b6a7d8"),n("8a35b54c1d"),n("a2a09da1e3"),n("3bf1976a4f"),n("f84436e584"),n("39cb6f3a5e")),w=n("0a8ecd6412"),A=n("ba4ddefc1e"),E=n("6884e1a126"),T=n("48088c26a7"),k=n("382929c8da"),I=n("f4f8c95f42"),O=n("6230269dca"),C=n("e0e8dd9366"),P=n("5fac0349d3"),D=n("570b26a0fa"),M=n("9da6335152"),L=n("4aef4ce634"),R=n.n(L),_=n("45f26372f8"),N=n("b86964b011"),B=n("fb75408061"),j=n("02ae07c580"),F=n("d7a2286b24"),U=n("4e7af1026b"),z=n("e0a67dc3fe"),G=n("37091e4240"),H=n("cc17a96b7f");function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var W=function(e){p()(s,e);var t,a,r,c=V(s);function s(e,t,a,r){var l;return o()(this,s),l=c.call(this,e,t,a),g()(d()(l),"addonQuickItemsMap",new Map),g()(d()(l),"addonSceneItemsMap",new Map),g()(d()(l),"addonScenes",void 0),g()(d()(l),"getSceneAddonListForMenu",R()(function(){var e=i()(x.a.mark((function e(t,n,a){var i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.DocAddonBridge.getSceneAddonList({scene:t,extraAddonIds:[n]});case 2:return i=e.sent,l.addonSceneItemsMap.set(t,i),e.abrupt("return",l.formatAddonSceneList(i,n,a));case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),500)),g()(d()(l),"quickSettingManager",void 0),g()(d()(l),"updateToolbar",void 0),g()(d()(l),"addonManager",void 0),g()(d()(l),"emitMessageToAddon",function(){var e=i()(x.a.mark((function e(t,n,a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("$onLoadToolbarButtons"!==t){e.next=4;break}return e.next=3,l.fetchToolbarButtonsType(a);case 3:case 8:return e.abrupt("return",e.sent);case 4:if("$onToolbarClick"===t&&l.executeToolbarButton(a),"$onPasteUrl"!==t){e.next=9;break}return e.next=8,l.parseLinkAsAddon(n);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()),g()(d()(l),"updateQuickMenu",function(){var e=i()(x.a.mark((function e(t,n){var a,i,r,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=I.j.find((function(e){return e.id===k.a.ADDON}))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,l.getSceneAddonListForMenu(t,n,!0);case 5:if(r=e.sent,i.dropdown&&(i.dropdown.data=r),l.quickSettingManager){e.next=9;break}return e.abrupt("return");case 9:o=t===S.AddonScenes.IMAGE?"doc_detail_pic_toolbar":"doc_detail_iframe_toolbar",Object(D.tdw)({opername:M.e.DOC_ADDON,module:M.d.ADDON_LIST,action:M.b.LIST_VIEW,eventcode:M.a.DOC_ADDON_ADDON_LIST_LIST_VIEW,ver9:o,file_type:M.c.SLIDE}),null===(a=l.quickSettingManager)||void 0===a||a.updateContent();case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),g()(d()(l),"updateIframeFloatMenu",function(){var e=i()(x.a.mark((function e(t,n){var a,i,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.linkManager){e.next=2;break}return e.abrupt("return");case 2:if(!l.linkManager.linkFloatBarService.isShown()){e.next=12;break}if(a=l.linkManager.linkFloatBarService.getCurrentConfig(),i=a.importConfig.find((function(e){return e.id===k.a.ADDON}))){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,l.getSceneAddonListForMenu(t,n,!0);case 9:r=e.sent,i.config.items=r,l.linkManager.linkFloatBarService.show(a,!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),g()(d()(l),"openAddonDetailPanel",(function(e){Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519")]).then(n.t.bind(null,"0a6f3d15f7",7)).then((function(t){var n=t.openAddonPanel,a=t.closeAddonPanel;n({type:"slide",page:"detail",query:{id:e},onOpenAddon:function(e){var t=e.id;l.openAddonPanel(t,a)},onClose:function(){l.updateAddonInfoList()}})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))})),g()(d()(l),"handleAddonSceneItemClick",(function(e,t){var n,a,i,r=e.slice(6);l.addonSceneItemsMap.forEach((function(e){var t=e.installed,o=e.uninstalled,c=t.find((function(e){return e.addonId===r})),l=o.find((function(e){return e.addonId===r}));c&&(n=c,i=c.name),l&&(a=l.marketId,i=l.name)})),n?l.openAddonPanel(r):l.openAddonDetailPanel(a),Object(D.tdw)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({opername:M.e.DOC_ADDON,module:M.d.ADDON_LIST,action:M.b.CLK_ADDON,eventcode:M.a.DOC_ADDON_ADDON_LIST_CLK_ADDON,ver6:r,ver7:i,file_type:M.c.SLIDE},t))})),l.api=e,l.linkManager=r,l.updateToolbar=l.api.updateToolbar,l.addonScenes=S.AddonScenes,l.addonManager=t,Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~service")]).then(n.bind(null,"7f21889145")).then((function(e){l.quickSettingManager=e.default.getInstance()})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})),l}return l()(s,[{key:"fetchToolbarButtonsType",value:(r=i()(x.a.mark((function e(t){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchContentContainer(t);case 2:return n=e.sent,a=(null==n?void 0:n.toolbar)||[],e.abrupt("return",a.map((function(e){return e.type})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"executeToolbarButton",value:(a=i()(x.a.mark((function e(t){var n,a,i,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchContentContainer(t);case 2:a=e.sent,i=null==a||null===(n=a.toolbar)||void 0===n?void 0:n[0],r=null==i?void 0:i.action,this.docAddonBridge.executeToolbarButtonAction(t,r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"parseLinkAsAddon",value:(t=i()(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.docAddonBridge.parseAsAddon(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",n);case 5:return n.aid=n.addonId,n.embedUrl=n.embedURL,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"openFormulaDialog",value:function(e){return this.docAddonBridge.invokeFormulaAddonWithLaTexOCR(e)}},{key:"formatAddonSceneList",value:function(e,t,n){var a;if(e){var i=e.installed,r=e.uninstalled;null===(a=F.default.getInstance().getConfig(U.k.addonUnofficialIframe))||void 0===a||a||(i=i.filter((function(e){return-1===A.c.indexOf(e.addonId)})),r=r.filter((function(e){return-1===A.c.indexOf(e.addonId)})));var o=[],c=[];i.length&&(o=[{id:k.a.INSTALLED_ADDON,title:P.a.t("已添加插件"),disable:!0}].concat(i.map((function(e){return{id:"".concat(B.a).concat(e.addonId),title:e.sceneName,addon:e,extraAddonId:t}})))),r.length&&(i.length&&(c=[{id:k.a.DIVIDER}]),c=c.concat([{id:k.a.RECOMMEND_ADDON,title:P.a.t("推荐插件"),disable:!0}].concat(r.map((function(e){return{id:"".concat(B.a).concat(e.addonId),title:e.sceneName,addon:e,extraAddonId:t}})))));var l=o.concat(c);return n?l.map((function(e){var n,a=e.addon,i={id:e.id,icon:null===(n=e.addon)||void 0===n?void 0:n.icons.small,content:e.title,disable:e.disable,extraAddonId:t};if(a){var r={title:a.name,vendorName:a.vendorName,vendorSite:a.vendorSite,imageUrl:a.icons.intro,description:a.shortDesc},o={titleComponent:O.a,titleProps:r};i.tooltip=o}return i})):l}}},{key:"getSceneType",value:function(){var e,t,n,a=this.selectionService.getSelectedModel();switch(null==a?void 0:a.type){case C.d.IMAGE:n=S.AddonScenes.IMAGE;break;case C.d.SHAPE:"iframe"===(null===(e=a.props.addon)||void 0===e||null===(t=e.docElement)||void 0===t?void 0:t.type)&&(n=S.AddonScenes.IFRAME);break;default:n=S.AddonScenes.CURSOR}return n}},{key:"updateAddonInfoList",value:function(){var e=this;this.docAddonBridge.fetchAddonList().then((function(t){e.clearAddonInfoList(),e.handleFetchAddonInfoList(t),t.forEach((function(e){E.e.get(T.BaseAddonService).updateAddonMenuSchema(e)}))})).catch((function(e){window.log.error("fetchAddonInfoList error",e)}))}},{key:"initAddonInfoList",value:function(){var e=this;this.docAddonBridge.fetchAddonList().then((function(t){var n;if(!e.isLoadAddonInfoList){e.handleFetchAddonInfoList(t),e.isLoadAddonInfoList=!0,e.event.emit(j.a.ADDON_INFO_LOAD_READY);var a=t;null===(n=F.default.getInstance().getConfig(U.k.addonUnofficialIframe))||void 0===n||n||(a=t.filter((function(e){return-1===A.c.indexOf(null==e?void 0:e.addonId)})));var i=function(){return a.forEach((function(e){E.e.get(T.BaseAddonService).updateAddonMenuSchema(e)}))};e.addonManager.workbenchLoaded?i():G.b.on(G.a.WORKBENCH_IS_MOUNT,(function(){i()}))}})).catch((function(e){window.log.error("fetchAddonInfoList error",e)}))}},{key:"initAddonImageSceneList",value:function(){var e=this;this.fetchAddonSceneInfoList(S.AddonScenes.IMAGE).then((function(t){e.addonSceneItemsMap.set(S.AddonScenes.IMAGE,t)}))}},{key:"initAddonIframeSceneList",value:function(){var e=this;this.fetchAddonSceneInfoList(S.AddonScenes.IFRAME).then((function(t){e.addonSceneItemsMap.set(S.AddonScenes.IFRAME,t)}))}},{key:"initAddonCurosrSceneList",value:function(){var e=this;this.fetchAddonSceneInfoList(S.AddonScenes.CURSOR).then((function(t){e.addonSceneItemsMap.set(S.AddonScenes.CURSOR,t)}))}},{key:"renderAddon",value:function(e){var t=(this.addonInfoMap.get(e)||{}).isOfficial,n=this.addonMetaMap.get(e)||{};t?(e===A.a&&this.updateToolbar(n,w.a.FORMULA),e===A.b&&this.updateToolbar(n,w.a.INSERT)):this.updateToolbar(n,w.a.UNOFFICIAL)}},{key:"fetchAddonSceneInfoList",value:function(e){return S.DocAddonBridge.getSceneAddonList({scene:e})}},{key:"handleFetchAddonInfoList",value:function(e){var t=this;e.forEach((function(e){var n=t.getCompatibleAddon(e);t.saveAddonMeta(n),t.saveAddonInfo(e),t.renderAddon(e.addonId)}))}},{key:"clearAddonInfoList",value:function(){this.addonMetaMap.clear(),this.addonInfoMap.clear()}},{key:"getAddonInfo",value:function(){var e;if(!Object(H.a)()){var t=this.getDocData();this.initAddonOptions(t),(null===(e=z.a.getConfig("custom.addon"))||void 0===e||e)&&this.initAddonInfoList(),Object(N.k)()&&(this.initAddonImageSceneList(),this.initAddonIframeSceneList(),this.initAddonCurosrSceneList())}}}]),s}(_.a)},"4780632d19":function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return S}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a,i,r=n("85d0a7609b"),o=n.n(r),c=n("176815363d"),l=n.n(c),s=n("3ef2352f0b"),d=n.n(s),u=(n("c6244f7705"),n("081c8cafea"),n("3bf1976a4f"),n("f4e4ed5c17")),p=n("db0c73f5df"),f=n("020899bf26"),v=n("45770891c9");!function(e){e[e.ACTION_TYPE_UNKNOWN=0]="ACTION_TYPE_UNKNOWN",e[e.ACTION_TYPE_RECOMMEND_INSTRUCTION=10001]="ACTION_TYPE_RECOMMEND_INSTRUCTION",e[e.ACTION_TYPE_GENERATE_IMAGE=10002]="ACTION_TYPE_GENERATE_IMAGE",e[e.ACTION_TYPE_SEARCH_IMAGE=10003]="ACTION_TYPE_SEARCH_IMAGE",e[e.ACTION_TYPE_GENERATE_DOCUMENT=10004]="ACTION_TYPE_GENERATE_DOCUMENT",e[e.ACTION_TYPE_MODIFY_CONTENT=10005]="ACTION_TYPE_MODIFY_CONTENT",e[e.ACTION_TYPE_SUMMARY_CONTENT=10006]="ACTION_TYPE_SUMMARY_CONTENT",e[e.ACTION_TYPE_TRANSLATE=10007]="ACTION_TYPE_TRANSLATE",e[e.ACTION_TYPE_UPLOAD_IMAGE=10008]="ACTION_TYPE_UPLOAD_IMAGE",e[e.ACTION_TYPE_IMAGE_POSITION=10009]="ACTION_TYPE_IMAGE_POSITION"}(i||(i={}));var m=(a={},o()(a,i.ACTION_TYPE_UNKNOWN,""),o()(a,i.ACTION_TYPE_RECOMMEND_INSTRUCTION,"recommend_instruction"),o()(a,i.ACTION_TYPE_GENERATE_IMAGE,"generate_image"),o()(a,i.ACTION_TYPE_SEARCH_IMAGE,"search_image"),o()(a,i.ACTION_TYPE_GENERATE_DOCUMENT,"generate_document"),o()(a,i.ACTION_TYPE_MODIFY_CONTENT,"modify_content"),o()(a,i.ACTION_TYPE_SUMMARY_CONTENT,"summary_content"),o()(a,i.ACTION_TYPE_TRANSLATE,"translate"),o()(a,i.ACTION_TYPE_UPLOAD_IMAGE,"upload_image"),o()(a,i.ACTION_TYPE_IMAGE_POSITION,"image_position"),a);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(){var e=l()(d.a.mark((function e(t){var n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({actionType:i.ACTION_TYPE_SEARCH_IMAGE,RequestData:{search_image:b(b({},t),{},{file_id:null!==(n=null===(a=f.a.ClientVarsService())||void 0===a?void 0:a.getClientVars().globalPadId)&&void 0!==n?n:""})}});case 2:return r=e.sent,e.abrupt("return",null==r?void 0:r.result);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=l()(d.a.mark((function e(t){var n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({actionType:i.ACTION_TYPE_UPLOAD_IMAGE,RequestData:{upload_image:{image:b({},t),file_id:null!==(n=null===(a=f.a.ClientVarsService())||void 0===a?void 0:a.getClientVars().globalPadId)&&void 0!==n?n:""}}});case 2:return r=e.sent,e.abrupt("return",null==r?void 0:r.result);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=l()(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({actionType:i.ACTION_TYPE_GENERATE_IMAGE,RequestData:{generate_image:b({},t)}});case 2:return n=e.sent,e.abrupt("return",null==n?void 0:n.result);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=l()(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({actionType:i.ACTION_TYPE_IMAGE_POSITION,RequestData:{gen_image_identifier:b({},t)},onGetResponse:function(e,t,n){n.result.image_identifier.positioned_keyword===t.gen_image_identifier.input&&(e.fail({ext1:"NO_IMAGE_POSITION"}),console.error("getImagePosition useless: ",JSON.stringify(n)))}});case 2:return n=e.sent,e.abrupt("return",null==n?void 0:n.result.image_identifier.positioned_keyword);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=l()(d.a.mark((function e(t){var n,a,r,o,c,l,s,f;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.actionType,a=t.RequestData,r=t.onGetResponse,o=v.a.start(i[n]),e.prev=2,e.next=5,Object(u.a)({method:"POST",url:"".concat("/api/ai/v1/copilot/actions","?xsrf=").concat(Object(p.b)()),data:b({action_type:n,action_name:m[n]},a),timeout:6e4});case 5:if(l=e.sent,0===(s=l.data).retcode){e.next=11;break}return o.fail({ext1:"code-".concat(s.retcode)}),console.error("getImagePosition error: ",JSON.stringify(s)),e.abrupt("return",null);case 11:if(f=null!==(c=null==r?void 0:r(o,a,s))&&void 0!==c?c:{},!f.fail){e.next=14;break}return e.abrupt("return",null);case 14:return o.success(),e.abrupt("return",s);case 18:return e.prev=18,e.t0=e.catch(2),o.fail({ext1:"http-".concat(e.t0.code)}),console.error("getImagePosition error: ",e.t0),e.abrupt("return",null);case 23:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}()},"4953944b6f":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-bullets-size-26rDg{margin-right:20px}.style-bullets-size-label-1FkjD{font-size:12px;margin-bottom:5px}.style-bullets-size-input-container-hR7vY{display:flex;align-items:center}.style-bullets-size-26rDg .style-input-suffix-text-1iEkc{font-size:12px;padding-left:6px}",""]),t.locals={"bullets-size":"style-bullets-size-26rDg","bullets-size-label":"style-bullets-size-label-1FkjD","bullets-size-input-container":"style-bullets-size-input-container-hR7vY","input-suffix-text":"style-input-suffix-text-1iEkc"}},5268094230:function(e,t,n){"use strict";n.r(t),n.d(t,"AnimationEditorService",(function(){return ie}));n("73b854064b"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var a=n("0cf3719522"),i=n.n(a),r=n("7a5536c9bf"),o=n.n(r),c=n("14502724a6"),l=n.n(c),s=n("9132715560"),d=n.n(s),u=n("6a364eb35c"),p=n.n(u),f=n("547611bd96"),v=n.n(f),m=n("bd29e2df90"),h=n.n(m),b=n("ab5eb40518"),g=n.n(b),y=n("1b4cdd6a36"),x=n.n(y),S=n("85d0a7609b"),w=n.n(S),A=(n("6e20b6a7d8"),n("a2a09da1e3"),n("b1e2246d82"),n("8a35b54c1d"),n("3bf1976a4f"),n("8ee19818c4"),n("b8217400dc"),n("e6f68cdf2e"),n("75563bc376"),n("963f2eaace"),n("eb9e932508"),n("22569efd03"),n("3dc760a4d9"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("342844cefa"),n("0acdc5834b"),n("580eefa367"));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=x()(e);if(t){var i=x()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return g()(this,n)}}var T=function(e){h()(n,e);var t=E(n);function n(){var e;d()(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),w()(v()(e),"animList",void 0),w()(v()(e),"hasAnimSupportElement",void 0),w()(v()(e),"unfoldItemKey",void 0),e}return p()(n,[{key:"initModel",value:function(e,t){this.unfoldItemKey=null,null!=t&&t.hasAnimSupportElement&&(this.hasAnimSupportElement=t.hasAnimSupportElement),null!=t&&t.animList&&(this.animList=t.animList)}}]),n}(n("375d29afab").a),k=n("6b7f29d5c0"),I=n("9e6e95de85"),O=n("d5c3deb8c7"),C=n("cde423b297"),P=n("ff948b66a1"),D=n("e0e8dd9366"),M=n("e5a826a0ff"),L=n("8f58e78419"),R=n.n(L),_=n("54bdd803dc"),N=n.n(_),B=n("a9e0ee82c1"),j=n.n(B),F=n("dc795b1e68"),U=n("77c89fc0e0"),z=n("8cec191691"),G=n("c245805ecf"),H=n("d3d31c86eb"),q=n("0a0a3572fb"),V=n("9559b6ab8e"),W=n("711a53c9fc"),Y=n("7c46f42788"),K=n("b8e6877859"),J=n("bd94425522"),X=n("9657b29818"),Q=n("dc9f7c6814"),Z=n("9da6335152"),$=n("82f2dc9440"),ee=n.n($);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=x()(e);if(t){var i=x()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return g()(this,n)}}var ie=function(e){h()(n,e);var t=ae(n);function n(){var e;return d()(this,n),e=t.call(this),w()(v()(e),"events",Object(K.a)()),w()(v()(e),"services",void 0),w()(v()(e),"updateContainerClassTimer",void 0),w()(v()(e),"animListLength",void 0),w()(v()(e),"dragPosition",void 0),w()(v()(e),"lastSelectInfo",void 0),w()(v()(e),"mounted",void 0),w()(v()(e),"refreshAction",void 0),w()(v()(e),"triggerReaction",void 0),w()(v()(e),"animCategoryManager",void 0),w()(v()(e),"setServiceDelegates",(function(t){e.services=ne(ne({},e.services),t)})),w()(v()(e),"componentDidMount",(function(){e.mounted=!0,e.refreshAction=Object(O.r)((function(){var t=e.getSelectionService(),n=t.currentSlide;return{animList:n?n.animList:[],animListLength:null!=n&&n.animList?n.animList.length:0,hasAnimSupportElement:e.filterAnimSupportElements(t.selectedElements.selectedArray).length>0}}),(function(t){e.mounted&&e.updateModel({animList:t.animList,hasAnimSupportElement:t.hasAnimSupportElement})}),{fireImmediately:!0}),e.triggerReaction=Object(O.r)((function(){var t=e.getSelectionService();return t.currentSlide?t.currentSlide.children.map((function(e){return Object(A.d)(e)})):[]}),(function(){e.updateModel({})}),{fireImmediately:!0}),e.services.animCategoryManager.promise().then((function(t){e.animCategoryManager=t}))})),w()(v()(e),"componentWillUnmount",(function(){var t,n,a,i;e.mounted=!1,null===(t=(n=e).refreshAction)||void 0===t||t.call(n),null===(a=(i=e).triggerReaction)||void 0===a||a.call(i)})),w()(v()(e),"componentDidUpdate",(function(){e.updateContainerClassTimer&&clearTimeout(e.updateContainerClassTimer),e.updateContainerClassTimer=setTimeout((function(){e.handleContainerClass()}),200)})),w()(v()(e),"getAnimListLength",(function(){return e.animListLength})),w()(v()(e),"setAnimListLength",(function(t){e.animListLength=t})),w()(v()(e),"clearDragPosition",(function(){e.dragPosition=null})),w()(v()(e),"isDragHover",(function(t,n){var a=e.findAnimIndexFromAnimList(t,n);return N()(a,e.dragPosition)})),w()(v()(e),"saveDragPositionChange",(function(t,n){if(t){var a=e.findAnimIndexFromAnimList(t,n);e.dragPosition=ne(ne({},a),{},{animIndex:a.animIndex+1})}else{var i=l()(e.model.animList[n].data,1)[0];e.dragPosition=e.findAnimIndexFromAnimList(i,n)}})),w()(v()(e),"handleVisibleChange",(function(t,n){e.updateModel({unfoldItemKey:n?t.key:null})})),w()(v()(e),"playAnimation",(function(t){var n;null===(n=e.getAnimPreviewManager())||void 0===n||n.previewOneToOneAnims([t]),e.tdwReport(F.g.playAnim,t)})),w()(v()(e),"deleteAnimation",(function(t){var n,a;null===(n=e.getSelectionService().currentSlide)||void 0===n||n.removeAnimation(t),e.events.emit(q.a.MODIFY_ANIM_TYPE,{animType:""}),null===(a=e.getSelectedAnims())||void 0===a||a.remove(t),e.tdwReport(F.g.deleteAnim,t)})),w()(v()(e),"modifyAnimation",(function(t,n,a){var i,r,o,c=null===(i=e.getSelectionService().currentSlide)||void 0===i?void 0:i.animList;-1!==(null==c?void 0:c[a].data.indexOf(t))&&(null===(r=e.getSelectionService().currentSlide)||void 0===r||r.modifyAnimation(t,n),n.animType&&e.events.emit(q.a.MODIFY_ANIM_TYPE,{animType:n.animType}),(n.animType||n.subType||n.by)&&(null===(o=e.getAnimPreviewManager())||void 0===o||o.previewOneToOneAnims([t])))})),w()(v()(e),"moveAnimation",(function(t){if(e.dragPosition){var n,a=e.model.animList[e.lastSelectInfo.queueIndex].clickSpid,i=e.lastSelectInfo.animIndex,r=e.model.animList[e.dragPosition.queueIndex].clickSpid,o=e.getToIndex(a,r,i);if(!(N()(a,r)&&N()(i,o)||j()(o)))null===(n=e.getSelectionService().currentSlide)||void 0===n||n.moveAnimation(i,o,a,r),e.lastSelectInfo=e.findAnimIndexFromAnimList(t,e.dragPosition.queueIndex),e.tdwReport(F.g.dragAnim)}e.dragPosition=null})),w()(v()(e),"calcAnimItemSty",(function(e,t,n,a){var i=0===a,r=a===t.length-1?4:0,o=i?4:0;return{marginTop:n&&i?0:-1,borderTopLeftRadius:o,borderTopRightRadius:o,borderBottomLeftRadius:r,borderBottomRightRadius:r}})),w()(v()(e),"calcIISty",(function(e,t){return{marginBottom:t===e.length-1?0:-8,zIndex:999}})),w()(v()(e),"getTriggerSelectOptions",(function(){var t=[{name:U.l.t("无"),value:V.j}],n=e.getSelectionService().currentSlide;if(!n)return t;var a=n.children.map((function(e){return{name:Object(P.a)({elementModel:e}).name,value:e.id||""}}));return t.concat(a).filter((function(e){return!!e.name}))})),w()(v()(e),"selectAnimation",(function(t,n,a){var i=t.metaKey,r=t.ctrlKey,o=t.shiftKey,c=e.getSelectedAnims();e.getSelectionService().selectedElements.clear();var l=e.findAnimIndexFromAnimList(n,a);i||r?(e.keyDownControl(n,c),e.lastSelectInfo=l):o?e.keyDownShift(l,c):(1===(null==c?void 0:c.length)&&c.findItem(n)||(null==c||c.clear(),null==c||c.add(n)),e.lastSelectInfo=l)})),w()(v()(e),"filterBlindsAnimationFor3DModels",(function(){var t=[q.d,q.b,q.f],n=e.getSelectionService().selectedElements.selectedArray;t.forEach((function(e){e.forEach((function(e){null!=n&&n.some((function(e){return e.scene3d||e.shape3d}))&&e.id&&[V.b.EntrBlinds,V.b.ExitBlinds].includes(e.id)&&(e.disabled=!0)}))}))})),w()(v()(e),"previewAllAnimation",(function(){var t;null===(t=e.getAnimPreviewManager())||void 0===t||t.previewFromBeginning(),e.tdwReport(ne(ne({},F.g.playAll),{},{ver5:e.animListLength,ver6:"",ver7:""}))})),w()(v()(e),"getAnimQueues",(function(t){var n=[];return t.forEach((function(t){var a=t.data,i=t.clickSpid,r=t.sequenceTypes,o=e.isMainSeq(i),c=e.getSelectionService().currentSlide,l={data:null==c?void 0:c.getAnimationClickGroup({data:a,clickSpid:i,sequenceTypes:r}),sequenceTypes:r,title:"",canEdit:!0,isMainSeq:o};if(o)n.unshift(l);else{var s,d=null===(s=e.getSelectionService().currentSlide)||void 0===s?void 0:s.children.find((function(e){return e.id===i}));l.title=Object(P.a)({elementModel:d}).name,n.push(l)}})),n})),w()(v()(e),"addAnimation",(function(t,n,a){var i,r,c;e.hideDropDown();var l=e.getSelectionService(),s=e.filterAnimSupportElements(l.selectedElements.selectedArrayForType(M.a.SLIDE));if(0!==R()(s,"length",void 0))if(e.getDisableAnimList(s).includes(t))ee.a.show({message:U.l.t("选中元素中包含不支持此动画的元素"),autoClose:!0,closable:!0,duration:5e3});else{e.updateElement(s);var d=ne(ne({},F.g.addAnim),{},{ver7:null===(i=e.selectedModel)||void 0===i?void 0:i.type}),u=null;t&&(d.ver5=n,u=t),e.addCanvasAnimWrapper(s),null===(r=l.currentSlide)||void 0===r||r.addAnimation(s,t||"");var p=null===(c=l.currentSlide)||void 0===c?void 0:c.animList,f=null==p?void 0:p.find((function(e){return e.clickSpid===V.j}));if(f){var v,m,h,b,g=f.data.slice(-s.length),y=f.data[f.data.length-1];e.updateModel({unfoldItemKey:y.key}),y.needScroll=!0;var x=e.getAnimPreviewManager(),S=null==x?void 0:x.getAutoPreview();f.data.length!==s.length||null!==(v=l.currentSlide)&&void 0!==v&&null!==(m=v.sdkData)&&void 0!==m&&m.timing?S&&(null==x||x.previewOneToOneAnims(g)):S&&(null==x||x.asyncPreviewWithAnims(g)),null===(h=e.getSelectedAnims())||void 0===h||h.clear(),null===(b=e.getSelectedAnims())||void 0===b||b.add.apply(b,o()(g))}var w=!!a;e.tdwReport(ne(ne({},d),{},{ver6:u,ver8:w}))}})),w()(v()(e),"addSlideAnimation",(function(t,n,a,i){var r=t.shapeList.slice().sort((function(t,n){return e.getElementType(t)-e.getElementType(n)})),o=[];r.forEach((function(i,r){var c,l,s=[i.id],d=e.getMainSeqLength(t),u=e.getElementType(i),p=(l=u)===J.n[J.m.IMAGE]||l===J.n[J.m.TABLE],f=0===r?W.Db.clickEffect:W.Db.withEffect,v=e.getAnimType(a,p,n),m={shapeIds:s,nodeType:f,index:d,triggerId:V.q,animType:v,delay:e.getDelay(p,n)};o.push(v),null===(c=t.timing)||void 0===c||c.api.addAnimation(m)})),e.addSlideAnimationTdwReport(t,i,n,o)})),w()(v()(e),"addSelectedSlidesAnimation",(function(t,n,a){var i,r=(i={},w()(i,J.d.SIMPLE_AND_FASHIONABLE,(function(a,i){e.addSlideAnimation(a,n,[J.y[i%5]],t.length)})),w()(i,J.d.UNIFIED_STYLE,(function(i){e.addSlideAnimation(i,n,[a],t.length)})),w()(i,J.d.SMART_JUMP,(function(a,i){e.addSlideAnimation(a,n,J.A[i%5],t.length)})),i);Object(X.b)((function(){t.forEach((function(e,t){var a;(null!==(a=r[n])&&void 0!==a?a:function(){})(e,t)}))}))})),w()(v()(e),"getSelectionService",(function(){var t;return null===(t=e.services)||void 0===t?void 0:t.selectionService})),w()(v()(e),"isMainSeq",(function(e){return e===V.j})),w()(v()(e),"getMainSeqLength",(function(e){var t,n,a,i,r=null===(t=e.timing)||void 0===t||null===(n=t.props)||void 0===n||null===(a=n.unitTimeNodeMap[V.q])||void 0===a?void 0:a.unitTimeNodeList;return null!==(i=null==r?void 0:r.length)&&void 0!==i?i:0})),w()(v()(e),"getElementType",(function(e){var t,n,a;return null!==(a=(n={},w()(n,Y.a.Shape,null!==(t=e.props.nvPr)&&void 0!==t&&t.txBox?J.n[J.m.TEXT]:J.n[J.m.SHAPE]),w()(n,Y.a.Picture,e.props.video||e.props.audio?J.n[J.m.OTHER]:J.n[J.m.IMAGE]),w()(n,Y.a.GraphicalObjectFrameTable,J.n[J.m.TABLE]),n)[e.type])&&void 0!==a?a:J.n[J.m.OTHER]})),w()(v()(e),"getAnimType",(function(e,t,n){return e[t&&n===J.d.SMART_JUMP?J.x.SIMPLE_AND_FASHIONABLE:J.x.OTHER]})),w()(v()(e),"getDelay",(function(e,t){return e&&t===J.d.SMART_JUMP?J.z[J.m.IMAGE]:J.z[J.m.OTHER]})),w()(v()(e),"addSlideAnimationTdwReport",(function(e,t,n,a){var i={opername:Z.e.DOC_PPT,module:Z.d.ANIMATION_BATCH,action:Z.b.ADD_SUCCESS,eventcode:Z.a.DOC_PPT_ANIMATION_BATCH_ADD_SUCCESS};Object(H.c)(ne(ne({},i),{},{ver5:e.parent.slideList.length===t?J.B.ALL_SLIDE:J.B.SELECTED_SLIDE,ver6:n,ver7:a}))})),w()(v()(e),"updateElement",(function(e){for(var t=0;t<e.length;t++){var n,a,i=e[t];if((null==i?void 0:i.type)===D.d.SHAPE)null==i||null===(n=i.editorInstance)||void 0===n||null===(a=n.triggerBlur)||void 0===a||a.call(n);else(null==i?void 0:i.type)===D.d.TABLE&&(null==i||i.uploadEditingCellData())}})),w()(v()(e),"filterAnimSupportElements",(function(e){return e?e.filter((function(e){return Object(k.d)(e)})):[]})),w()(v()(e),"handleContainerClass",(function(){var t,n,a,i,r,o,c,l=null===(t=e.viewDelegate)||void 0===t?void 0:t.getElementById(F.a.EDITOR_BOTTOM),s=null===(n=e.viewDelegate)||void 0===n?void 0:n.getElementById(F.a.SCROLL_CONTAINER);0!==e.model.animList.length?s&&(null==s?void 0:s.scrollHeight)>(null==s?void 0:s.clientHeight)?(null==s||null===(a=s.classList)||void 0===a||a.add(C.a.bottomBorder),null==l||null===(i=l.classList)||void 0===i||i.add(C.a["editor-bottom-padding-top"])):(null==s||null===(r=s.classList)||void 0===r||r.remove(C.a.bottomBorder),null==l||null===(o=l.classList)||void 0===o||o.remove(C.a["editor-bottom-padding-top"])):null==l||null===(c=l.classList)||void 0===c||c.add(C.a["editor-bottom-padding-top"])})),w()(v()(e),"addCanvasAnimWrapper",(function(t){var n=e.getAnimManager().editSlideComponent;n&&t.forEach((function(e){var t;if(e){var a=null==e?void 0:e.key,i=Object(G.a)(a,n);if(i)if(!(i instanceof z.a)){var r=null==i?void 0:i.parent,o=null==r||null===(t=r.children)||void 0===t?void 0:t.findIndex((function(e){return e===i}));if(-1!==o&&!j()(o)){r.removeChild(i);var c=new z.a(i.factoryOptions,i.factoryDispose,i.factoryUpdateComponent);c.addChild(i),r.addChildAt(c,o)}}}}))})),w()(v()(e),"keyDownControl",(function(e,t){e.selected?t.remove(e):t.add(e)})),w()(v()(e),"keyDownShift",(function(t,n){var a=t.animIndex,i=e.model.animList.find((function(e){return e.clickSpid===V.j}));if(i){(e.lastSelectInfo.animIndex<0||e.lastSelectInfo.animIndex>=i.data.length)&&(e.lastSelectInfo=t);var r=Math.min(e.lastSelectInfo.animIndex,a),c=Math.max(e.lastSelectInfo.animIndex,a)+1,l=i.data.slice(r,c);n.clear(),n.add.apply(n,o()(l))}})),w()(v()(e),"findAnimIndexFromAnimList",(function(t,n){return{queueIndex:n,animIndex:e.model.animList[n].data.indexOf(t)}})),w()(v()(e),"getToIndex",(function(t,n,a){var i,r;return t===n&&null!==(i=e.dragPosition)&&void 0!==i&&i.animIndex&&e.dragPosition.animIndex>a?e.dragPosition.animIndex-1:null===(r=e.dragPosition)||void 0===r?void 0:r.animIndex})),w()(v()(e),"hideDropDown",(function(){var t,n=null===(t=e.viewDelegate)||void 0===t?void 0:t.getElementById(F.a.DROP_DOWN);n&&n.hide()})),w()(v()(e),"tdwReport",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.props,a=(n=void 0===n?{}:n).animType,i=void 0===a?"":a,r=n.presetClass,o=void 0===r?"":r,c=t.elementModel,l=(c=void 0===c?{}:c).type,s=void 0===l?"":l;Object(H.c)(ne(ne({},F.f),{},{ver5:o,ver6:i,ver7:s},e))})),w()(v()(e),"getAnimPreviewManager",(function(){var t,n;return null===(t=(n=e.services).editorAnimPreviewManager)||void 0===t?void 0:t.call(n)})),w()(v()(e),"getSelectedAnims",(function(){return e.services.selectedAnims})),w()(v()(e),"getAnimManager",(function(){return e.services.animManager})),e.dragPosition=null,e.lastSelectInfo={queueIndex:0,animIndex:-1},e}return p()(n,[{key:"deleteSlideAnimation",value:function(e){var t=this,n=e.slideDataModel,a=e.shapeTargetId,i=e.deletePresetClassList,r=void 0===i?[]:i;n&&Object(X.b)((function(){var e,i=null===(e=n.timing)||void 0===e?void 0:e.props.unitTimeNodeMap;i&&Object.entries(i).forEach((function(e){var i=l()(e,2),o=i[0],c=i[1],s=(null!=c?c:{}).unitTimeNodeList;if(s)for(var d=s.length-1;d>=0;d--){var u,p,f,v,m,h,b=null===(u=s[d].par)||void 0===u||null===(p=u.cTn)||void 0===p?void 0:p.presetClass,g=a?t.findSpid(null===(f=s[d].par)||void 0===f||null===(v=f.cTn)||void 0===v||null===(m=v.childTnLst)||void 0===m?void 0:m.egTimeNodeChoice):a;b&&r.includes(b)&&a===g&&(null===(h=n.timing)||void 0===h||h.api.removeAnimation(Q.a.getSdkTriggerId(o),d))}}))}))}},{key:"deleteSelectedElementAnimation",value:function(e){var t=this,n=e.shapeModels,a=void 0===n?[]:n,i=e.deletePresetClassList,r=void 0===i?[]:i;Object(X.b)((function(){a.forEach((function(e){var n,a=null===(n=e.parent)||void 0===n?void 0:n.sdkData,i=e.id;i&&t.deleteSlideAnimation({slideDataModel:a,deletePresetClassList:r,shapeTargetId:i})}))}))}},{key:"deleteSelectedSlideAnimation",value:function(e){var t=this,n=e.slideList,a=e.deletePresetClassList,i=void 0===a?[]:a;Object(X.b)((function(){n&&n.forEach((function(e){t.deleteSlideAnimation({slideDataModel:e,deletePresetClassList:i})}))}))}},{key:"createViewModel",value:function(){return new T}},{key:"getInitModelValue",value:function(){var e,t=null===(e=this.services)||void 0===e?void 0:e.selectionService.selectedElements.selectedArray,n=this.getSelectionService();return{animList:n.currentSlide?n.currentSlide.animList:[],hasAnimSupportElement:this.filterAnimSupportElements(t).length>0}}},{key:"selectedModel",get:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.selectionService.getSelectedModel()}},{key:"findSpid",value:function(e){if("object"===i()(e)){if("spid"in e)return e.spid;for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],r=this.findSpid(e[a]);if(void 0!==r)return r}}}},{key:"getDisableAnimList",value:function(e){var t=this;return e.reduce((function(e,n){var a=t.animCategoryManager.getDisabledAnimTypeList(n);return[].concat(o()(e),o()(a))}),[])}}]),n}(I.a)},"5476253e4e":function(e,t,n){"use strict";n.r(t),n.d(t,"AccusationService",(function(){return M}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),p=n.n(u),f=(n("3bf1976a4f"),n("1bab7b5fb7"),n("34cd92f77a"),n("c6244f7705"),n("081c8cafea"),n("2e0796c118")),v=n.n(f),m=n("82f2dc9440"),h=n.n(m),b=n("e792a3169a"),g=n.n(b),y=n("17d54d24b1"),x=n.n(y),S={insert:"head",singleton:!1},w=(g()(x.a,S),x.a.locals||{}),A=n("5fac0349d3"),E=n("402eb050f3"),T=n("0e41c725b0"),k=n("798a9cd6f2"),I=n("020899bf26"),O=n("aba9dcef64"),C=n("d095530179");function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(){function e(){var t=this;o()(this,e),d()(this,"urlUserReport",""),d()(this,"showJuBao",!1),d()(this,"services",void 0),d()(this,"onGetUserReportToken",(function(e){try{var n=e.data;if(0===n.retcode&&n.token.length>0){var a,i,r,o=n.token;o=encodeURIComponent(o);var c="token=".concat(o,"&scene=6001&openid=").concat(null===I.a||void 0===I.a||null===(a=I.a.ClientVarsService)||void 0===a||null===(i=a.call(I.a))||void 0===i||null===(r=i.getClientVars())||void 0===r?void 0:r.userDomain),l="".concat(k.d.REPORT,"?").concat(c);t.urlUserReport=l,t.showJuBao=!0,window.addEventListener("message",t._onReciveJuBaoPageMessage),t._renderJuBaoPage()}else h.a.show({message:A.a.t("请求失败，请稍后重试。"),duration:5e3})}catch(e){h.a.show({message:A.a.t("请求失败，请稍后重试。"),duration:5e3})}})),d()(this,"showSupportPage",(function(e){var n,a;if(E.b.supportEnterprise(E.a.ALL)&&T.e.tdocs)return T.e.tdocs.openSupportPage();var i,r=t.getUserInfo(),o=r.nick,c=r.avatar,l=r.uid||"";l?"p"===l.charAt(0)&&(l=l.replace(/p./,"")):l=null===(i=I.a.ClientVarsService())||void 0===i?void 0:i.getClientVars().uin;var s,d,u=" ";void 0!==(null===(n=I.a.DocInfoManager())||void 0===n?void 0:n.pVer)&&(u="".concat(u," pver/").concat(null===(s=I.a.DocInfoManager())||void 0===s?void 0:s.baseRevision));void 0!==(null===(a=I.a.DocInfoManager())||void 0===a?void 0:a.gray)&&(u="".concat(u," gray/").concat(null===(d=I.a.DocInfoManager())||void 0===d?void 0:d.gray));var p=window.navigator.userAgent+u;t.gotoTucaoWithLoginState({openid:l,nickname:o,avatar:c,url:window.location.href,clientInfo:p},e)})),d()(this,"_onReciveJuBaoPageMessage",(function(e){if(null!=e&&e.data)try{var n=e.data;"string"==typeof e.data&&(n=JSON.parse(e.data)),n&&"jubao"===n.from&&"jubao_close"===n.cmd&&t.hideJuBaoPage()}catch(e){var a;null===(a=window.log)||void 0===a||a.error("onReciveJuBaoPageMessage error:".concat(e))}})),d()(this,"_renderJuBaoPage",(function(){var e=t.urlUserReport,n=document.getElementById("jubao-contianer");n||((n=document.createElement("div")).id="jubao-contianer",document.body.appendChild(n)),v.a.render(t.showJuBao?React.createElement("div",null,React.createElement("div",{className:w["userReport-container"]},React.createElement("iframe",{className:w["userReport-frame"],src:e})),React.createElement("div",{className:w["userReport-mask"]})):React.createElement(React.Fragment,null),n)})),d()(this,"gotoTucaoWithLoginState",(function(e,t){Object(C.a)(e,t)}))}var t;return l()(e,[{key:"setServiceDelegates",value:function(e){this.services=D(D({},this.services),e)}},{key:"showJuBaoPage",value:(t=i()(p.a.mark((function e(){var t,n,a,i,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.DocInfoManager.promise();case 2:return t=e.sent,n=t.domainId,a=void 0===n?"":n,i=t.padId,r=void 0===i?"":i,e.next=9,O.a.OnlineApiService.promise();case 9:e.sent.getUserReportToken(a,r).then(this.onGetUserReportToken);case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"hideJuBaoPage",value:function(){this.showJuBao=!1,window.removeEventListener("message",this._onReciveJuBaoPageMessage),this._renderJuBaoPage()}},{key:"getUserInfo",value:function(){var e;return(null===(e=this.services.extensionService.getDocInfo())||void 0===e?void 0:e.userInfo)||{}}}]),e}()},"556cd47817":function(e,t,n){"use strict";n.r(t),n.d(t,"AuthGuideManager",(function(){return y}));var a=n("9132715560"),i=n.n(a),r=n("6a364eb35c"),o=n.n(r),c=n("85d0a7609b"),l=n.n(c),s=n("d3d31c86eb"),d=n("5fac0349d3"),u=n("82f2dc9440"),p=n.n(u),f=n("b86964b011"),v=n("872ba9d13a"),m=n("73e651ca0f"),h=n("020899bf26"),b=n("37091e4240"),g=n("1cc9d00e0c"),y=function(){function e(t){var n=this;i()(this,e),l()(this,"applyAuthStatus",void 0),l()(this,"extensionService",void 0),l()(this,"applyAuthService",void 0),l()(this,"hasApplyAuthInit",!1),l()(this,"showLoginGuide",(function(){var e,t;null!==(e=n.getExtensionCallbacks())&&void 0!==e&&null!==(t=e.isLogin)&&void 0!==t&&t.call(e)||(Object(s.c)({opername:"doc_login",module:"readonly",action:"try_edit_toast_exp_pc"}),p.a.show({message:d.a.t("你只能查看此文档。若要编辑文档，请登录后编辑。"),action:d.a.t("立即登录"),closable:!1,duration:5e3,type:"info",onClickAction:function(){Object(s.c)({opername:"doc_login",module:"readonly",action:"try_edit_toast_login_pc"}),n.showLogin()}}))})),l()(this,"showLogin",(function(){var e,t;Object(s.c)({opername:"doc_login",module:"readonly",action:"login_exp_pc"}),null===(e=n.getExtensionCallbacks())||void 0===e||null===(t=e.login)||void 0===t||t.call(e)})),l()(this,"showAuthGuide",(function(){var e,t,a;if(null===(e=n.applyAuthStatus)||void 0===e||!e.apply||null!==(t=n.applyAuthStatus)&&void 0!==t&&t.noPass||null!==(a=n.applyAuthStatus)&&void 0!==a&&a.pass){var i,r;if(Object(s.c)({opername:"doc_author",module:"edit",action:"try_edit_toast_apply_exp_pc"}),!n.injectable.shouldShowNoAuthGuide)return!1;if(null!==(i=n.applyAuthStatus)&&void 0!==i&&i.noPass)return void p.a.show({message:d.a.t("申请暂未通过，请在24小时后重试。"),autoClose:!0,duration:3e3});if(!n.applyAuthService.canApplyEdit()){var o=Object(v.a)();return void p.a.show({message:o?d.a.t("该文档只能查看。"):d.a.t("编辑失败，企业授权已经到期，请联系管理员更新授权。"),closable:!1,duration:3e3,type:"info"})}var c=null!==(r=h.a.PrivilegeManager())&&void 0!==r&&r.canGenerateCopies?d.a.t("编辑文档"):d.a.t("申请编辑权限");p.a.show({closable:!1,duration:3e3,type:"info",message:d.a.t("当前文档权限为“只能查看”。"),action:c,onClickAction:function(){Object(s.c)({opername:"doc_author",module:"edit",action:"try_edit_toast_apply_clk_pc"}),n.showAuthApply()}})}else{var l;p.a.show({message:d.a.t("权限申请已提交，请等待创建者 {0} 审核。",{0:Object(f.t)((null===(l=h.a.DocInfoManager())||void 0===l?void 0:l.extra.ownerNick)||"",7)}),duration:3e3,type:"info"})}})),l()(this,"showAuthApply",(function(){var e;Object(m.a)({}),null!==(e=h.a.PrivilegeManager())&&void 0!==e&&e.canGenerateCopies?Object(s.c)({opername:"doc_author",module:"edit",action:"clk_tip"}):Object(s.c)({opername:"doc_author",module:"edit",action:"readonly_apply_tip_clk_pc"})})),this.injectable=t,this.injectable.shouldListenLoginGuide&&b.b.on(b.a.SHOW_LOGIN_GUIDE_PC,(function(){n.showLoginGuide()})),this.injectable.shouldListenAuthGuide&&b.b.on(b.a.SHOW_AUTH_GUIDE_PC,(function(){n.showAuthGuide()}))}return o()(e,[{key:"setServiceDelegates",value:function(e){var t=this,n=e.extensionService,a=e.applyAuthService;this.extensionService=n,this.applyAuthService=a,Object(h.b)((function(){t.setAuthStatus()}))}},{key:"setAuthStatus",value:function(){var e=this;this.hasApplyAuthInit||(this.hasApplyAuthInit=!0,this.applyAuthService.init().then((function(){var t=e.applyAuthService.applyInfo,n=t.hasApplied,a=t.applyResult;e.applyAuthStatus={apply:n,pass:a===g.a.Pass,noPass:a===g.a.NotPass}})))}},{key:"getExtensionCallbacks",value:function(){return this.extensionService.getCallBackAdapter()}}]),e}()},"560bea0cc4":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var a="no-edit-auth-mobile",i="no-edit-auth-pc"},"5a075649c6":function(e,t,n){"use strict";t.a=function(){var e=document.createElement("div");return e.setAttribute("contenteditable","true"),e.setAttribute("tabindex","0"),e.style.cssText="position: absolute; left: -999px; top: 0; width: 0; height: 0",e}},"6083914f81":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));n("73b854064b");var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("547611bd96"),d=n.n(s),u=n("bd29e2df90"),p=n.n(u),f=n("ab5eb40518"),v=n.n(f),m=n("1b4cdd6a36"),h=n.n(m),b=n("85d0a7609b"),g=n.n(b),y=n("3ef2352f0b"),x=n.n(y),S=(n("c6244f7705"),n("081c8cafea"),n("b1e2246d82"),n("8ee19818c4"),n("39cb6f3a5e")),w=n("5aa0e40fcc"),A=n("45f26372f8"),E=n("9da6335152"),T=n("d3d31c86eb"),k=n("e0a67dc3fe");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var O=function(e){p()(n,e);var t=I(n);function n(e,a,r,c){var l;return o()(this,n),l=t.call(this,e,a,r),g()(d()(l),"mobileClosePanelFlag",!1),g()(d()(l),"handleMobileAddonItemClick",function(){var e=i()(x.a.mark((function e(t){var n,a,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.DocAddonBridge.fetchAddonMenu(t);case 2:a=e.sent,i=null===(n=l.addonInfoMap.get(t))||void 0===n?void 0:n.name,S.DocAddonBridge.executeMenuAction(t,a),Object(T.c)({opername:E.e.DOC_ADDON,module:E.d.ADDON_LIST,action:E.b.CLK_ADDON,eventcode:E.a.DOC_ADDON_ADDON_LIST_CLK_ADDON,ver6:t,ver7:i,ver9:E.m.DETAIL_INSERT,ver11:E.g.OPEN,file_type:E.c.SLIDE});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g()(d()(l),"getAddonHook",(function(){return{onOpen:function(){l.mobileClosePanelFlag=!0;var e=l.getNativeTitlebarManager();Object(w.c)()&&e&&(e.visible=!1)},onClose:function(){l.mobileClosePanelFlag=!1;var e=l.getNativeTitlebarManager();Object(w.c)()&&e&&(e.visible=!0)}}})),l.api=e,l.getNativeTitlebarManager=c,l}return l()(n,[{key:"initAddonInfoList",value:function(){var e,t=this;(null===(e=k.a.getConfig("feature.addonListMobile"))||void 0===e||e)&&this.docAddonBridge.fetchAddonList({channel:S.AddonListChannel.MOBILE}).then((function(e){e.forEach((function(e){t.addonInfoMap.set(e.addonId,e)}))})).catch((function(e){window.log.error("fetchAddonInfoList mobile error",e)}))}},{key:"handleFetchAddonInfoList",value:function(e){var t=this;e.forEach((function(e){var n=t.getCompatibleAddon(e);t.saveAddonMeta(n),t.saveAddonInfo(e)}))}},{key:"getAddonInfo",value:function(){var e=this.getDocData();this.initAddonOptions(e),this.initAddonInfoList()}}]),n}(A.a)},"650f4f6a32":function(e,t,n){"use strict";n.r(t),n.d(t,"CENTER_TITLE_PLACEHOLDER",(function(){return yt})),n.d(t,"TITLE_PLACEHOLDER",(function(){return xt})),n.d(t,"SUB_TITLE_PLACEHOLDER",(function(){return St})),n.d(t,"CONTENT_PLACEHOLDER",(function(){return wt})),n.d(t,"DATE_PLACEHOLDER",(function(){return At})),n.d(t,"FOOTER_PLACEHOLDER",(function(){return Et})),n.d(t,"BODY_PLACEHOLDER",(function(){return Tt})),n.d(t,"SLIDE_NUMBER_PLACEHOLDER",(function(){return kt})),n.d(t,"PICTURE_PLACEHOLDER",(function(){return It})),n.d(t,"EAILayoutType",(function(){return gt})),n.d(t,"default",(function(){return Ot}));n("963f2eaace"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287");var a=n("7a5536c9bf"),i=n.n(a),r=n("730477bb20"),o=n.n(r),c=n("176815363d"),l=n.n(c),s=n("1f925d7f50"),d=n.n(s),u=n("9132715560"),p=n.n(u),f=n("6a364eb35c"),v=n.n(f),m=n("85d0a7609b"),h=n.n(m),b=n("2dc700e1e6"),g=n.n(b),y=(n("f1054791f4"),n("3ef2352f0b")),x=n.n(y),S=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("081c8cafea"),n("8ee19818c4"),n("22569efd03"),n("24f382e0f4"),n("63513d8b56"),n("b1e2246d82"),n("75563bc376"),n("c9a7ecac4d"),n("1bab7b5fb7"),n("34cd92f77a"),n("b8217400dc"),n("8a35b54c1d"),n("5fac0349d3")),w=n("9657b29818"),A=n("d5c3deb8c7"),E=n("e0e8dd9366"),T=n("711a53c9fc"),k=n("7c46f42788"),I=n("51b2ea9953"),O=n("020899bf26"),C=n("fe82ecf3fc"),P=n("7e4a465ef4"),D=n("743ef67b0e"),M=n("a7888a8b87"),L=n.n(M),R=n("745b159130"),_=n("2e0796c118"),N=n.n(_),B=n("69084d01d3"),j=n.n(B),F=(n("73b854064b"),n("547611bd96")),U=n.n(F),z=n("bd29e2df90"),G=n.n(z),H=n("ab5eb40518"),q=n.n(H),V=n("1b4cdd6a36"),W=n.n(V),Y=n("52d461bc51"),K=n.n(Y),J=n("3404d6c52c"),X=n.n(J),Q=n("e792a3169a"),Z=n.n(Q),$=n("6639273864"),ee=n.n($),te={insert:"head",singleton:!1},ne=(Z()(ee.a,te),ee.a.locals||{}),ae=n("8a6c5a3b5b"),ie=n("8de2e7a1cd"),re=n.n(ie),oe={insert:"head",singleton:!1},ce=(Z()(re.a,oe),re.a.locals||{}),le=n("03f607044f"),se=n("0ad329aafc"),de=n("73776ff547"),ue=n.n(de),pe={insert:"head",singleton:!1},fe=(Z()(ue.a,pe),ue.a.locals||{}),ve=n("cd2a2f393a"),me=n.n(ve),he=n("1748118723"),be=n.n(he);function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=W()(e);if(t){var i=W()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return q()(this,n)}}var ye,xe=function(e){G()(n,e);var t=ge(n);function n(e){var a;return p()(this,n),a=t.call(this,e),h()(U()(a),"handlePreviewSizeChange",(function(e,t){a.setState({selectedKey:t}),a.props.onSelect(t)})),a}return v()(n,[{key:"render",value:function(){var e,t=this,n=this.props,a=n.selectedTemplateId,i=n.isLoading,r=!a||i;return j.a.createElement("div",{className:fe["detail-header-container"]},j.a.createElement("div",{className:fe["detail-header-title-container"]},j.a.createElement("div",{className:fe["detail-header-title-text"]},this.props.title),j.a.createElement("div",{className:fe["detail-header-title-button"]},j.a.createElement(me.a,{style:{width:112},onClick:this.handlePreviewSizeChange,activeId:this.props.previewMode},j.a.createElement(me.a.Segment,{id:ae.a.BIG},S.a.t("大图")),j.a.createElement(me.a.Segment,{id:ae.a.SMALL},S.a.t("小图"))))),this.props.showUndo&&j.a.createElement("div",{onClick:function(){var e,n;r||null===(e=(n=t.props).onUndo)||void 0===e||e.call(n)},className:be()((e={},h()(e,fe["detail-header-undo-container"],!0),h()(e,fe.disabled,r),e))},j.a.createElement("div",{className:fe["undo-button"]},j.a.createElement("div",{className:fe["undo-icon"]}),j.a.createElement("div",{className:fe["undo-text"]},S.a.t("全部恢复")))))}}]),n}(j.a.Component),Se=n("422db28d9b");function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=W()(e);if(t){var i=W()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return q()(this,n)}}!function(e){e.USER_DOC="0",e.TEMPLATE="1"}(ye||(ye={}));var Ae=function(e){G()(n,e);var t=we(n);function n(e){var a;return p()(this,n),(a=t.call(this,e)).state={colNumber:1,activeId:ye.USER_DOC,previewMode:ae.a.BIG},a}return v()(n,[{key:"render",value:function(){var e,t,n,a=this,i=this.props,r=i.cloneUiDataService,o=i.slideWidth,c=i.slideHeight,l=i.templateUiDataService,s=i.selectedTemplateId,d=i.isLoading,u=i.showVipGuideButton,p=i.isVipTemplate,f=(null==l||null===(e=l.presentation)||void 0===e?void 0:e.props)||{},v=f.slideWidth,m=void 0===v?1920:v,h=f.slideHeight,b=void 0===h?1080:h;return j.a.createElement("div",{className:ce["template-preview-container"]},s&&j.a.createElement("div",{className:ce["template-ok-container"]},j.a.createElement("div",{className:ce["template-select-ok"]},j.a.createElement(se.a,{onClick:this.props.onClick,disabled:d,type:p?"golden":"primary",style:{width:u?164:151}},u?S.a.t("开通超级会员免费使用"):S.a.t("应用美化"))),j.a.createElement("div",{className:ce["template-select-ok-append"]})),j.a.createElement("div",{className:ce["template-preview-list-container"]},j.a.createElement(le.a,{onChange:function(e){var t=e;a.setState({activeId:t})},alignment:"left",indicatorWidth:"small",activeId:this.state.activeId,activeItemStyle:{color:"#1E6FFF"},indicatorStyle:{background:"#1E6FFF"},tabBarSize:"medium"},j.a.createElement(le.a.TabPane,{forceRender:!0,tab:S.a.t("效果预览"),id:ye.USER_DOC},j.a.createElement("div",{className:ce["preview-container"]},this.state.activeId===ye.USER_DOC&&j.a.createElement(xe,{selectedTemplateId:this.props.selectedTemplateId,isLoading:this.props.isLoading,showUndo:!0,onUndo:this.props.onUndo,title:S.a.t("效果预览"),showSelectAll:!0,previewMode:this.state.previewMode,onSelect:function(e){a.setState({previewMode:e})}}),j.a.createElement("div",{style:{height:498}},j.a.createElement(Se.a,{mode:this.state.previewMode,originSlideWidth:o,originSlideHeight:c,showBorder:!0,uiDataService:r,slideList:(null==r||null===(t=r.presentation)||void 0===t?void 0:t.children)||[]})))),l&&s?j.a.createElement(le.a.TabPane,{forceRender:!0,tab:S.a.t("模版详情"),id:ye.TEMPLATE},j.a.createElement("div",{className:ce["preview-container"]},this.state.activeId===ye.TEMPLATE&&j.a.createElement(xe,{selectedTemplateId:this.props.selectedTemplateId,isLoading:this.props.isLoading,showUndo:!1,title:S.a.t("效果预览"),showSelectAll:!0,previewMode:this.state.previewMode,onSelect:function(e){a.setState({previewMode:e})}}),j.a.createElement("div",{style:{height:530}},j.a.createElement(Se.a,{mode:this.state.previewMode,originSlideWidth:m,originSlideHeight:b,showBorder:!0,uiDataService:l,slideList:(null==l||null===(n=l.presentation)||void 0===n?void 0:n.children)||[]})))):j.a.createElement("div",null))))}}]),n}(j.a.Component),Ee=(n("6e20b6a7d8"),n("4bbb5840d5"),n("2805ad1ce5")),Te=n.n(Ee),ke={insert:"head",singleton:!1},Ie=(Z()(Te.a,ke),Te.a.locals||{}),Oe=n("0b26c2e813"),Ce=n.n(Oe),Pe={insert:"head",singleton:!1},De=(Z()(Ce.a,Pe),Ce.a.locals||{}),Me=n("7cda620e53"),Le=n.n(Me),Re=n("374cdb0e21"),_e=n("f2b6d66c40"),Ne=n("8ed98eb6ea");function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=W()(e);if(t){var i=W()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return q()(this,n)}}var je=function(e){G()(n,e);var t=Be(n);function n(e){var a;return p()(this,n),a=t.call(this,e),h()(U()(a),"handleSearch",(function(){var e=a.state.searchValue.replaceAll(" ","");a.props.onSearch(e)})),h()(U()(a),"getTopicList",l()(x.a.mark((function e(){var t,n,i,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state.topicList.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(Ne.c)();case 4:t=e.sent,null!=(n=null==t?void 0:t[0])&&n.length&&((r=null===(i=n.filter)||void 0===i?void 0:i.call(n,(function(e){var t;return e.topicId&&(null===(t=e.style)||void 0===t?void 0:t.desc)}))).unshift({topicId:"",style:{desc:_e.default.t("全部")}}),a.setState({topicList:r}),a.props.onTopicInit(r));case 7:case"end":return e.stop()}}),e)})))),a.state={topicList:[],searchValue:""},a.getTopicList(),a}return v()(n,[{key:"render",value:function(){var e,t=this,n=this.props.selectedTopicId;return j.a.createElement("div",{className:De["template-topic-menu-container"]},j.a.createElement("div",{className:De["template-topic-item-container-scroll"]},j.a.createElement("div",{className:De["template-topic-item-container"]},this.state.topicList.map((function(e,a){var i,r;return j.a.createElement("div",{key:e.topicId,onClick:function(){t.props.onTopicSelect(e.topicId)},className:be()((i={},h()(i,De["template-topic-menu-item"],!0),h()(i,De["menu-item-selected"],e.topicId===n),i))},null===(r=e.style)||void 0===r?void 0:r.desc)})))),j.a.createElement("div",{className:De["template-topic-item-mask"]}),j.a.createElement("div",{className:De["template-topic-search"]},j.a.createElement(Re.a,{value:this.state.searchValue,onChange:function(e){t.setState({searchValue:e})},onKeyUp:function(e){"Enter"===e.key&&t.handleSearch()},className:be()((e={},h()(e,De["template-topic-search-input"],!0),h()(e,"template-topic-search-for-global",!0),e)),leftIcon:Le.a,placeholder:_e.default.t("搜索")})))}}]),n}(j.a.Component),Fe=(n("e6f68cdf2e"),n("2abe3146de")),Ue=n.n(Fe),ze={insert:"head",singleton:!1},Ge=(Z()(Ue.a,ze),Ue.a.locals||{}),He=n("50e5e071a2"),qe=n("7eb1f75416");function Ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=W()(e);if(t){var i=W()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return q()(this,n)}}var We=function(e){G()(n,e);var t=Ve(n);function n(e){var a;return p()(this,n),a=t.call(this,e),h()(U()(a),"getIsSuperVipTemplate",(function(e,t){var n,a=null===(n=e.prices)||void 0===n?void 0:n.find((function(e){return e.itemId===t}));return(null==a?void 0:a.requirements.type)||ae.b.Free})),h()(U()(a),"getVipType",(function(e,t){var n,a,i=null===(n=e.prices)||void 0===n?void 0:n.find((function(e){return e.itemId===t}));return ae.c[(null==i||null===(a=i.requirements)||void 0===a?void 0:a.type)||""]})),h()(U()(a),"getBreadcrumb",(function(e){var t;return j.a.createElement("div",{className:be()(h()({},Ge["template-detail-list-item-title-breadcrumb"],!0))},j.a.createElement("div",{onClick:function(){a.props.onBack()},className:Ge["bread-crumb-back"]},_e.default.t("主题模板")),j.a.createElement("div",{className:Ge["bread-crumb-back-arrow"]}),j.a.createElement("div",{className:Ge["title-text"]},null===(t=e.topic)||void 0===t?void 0:t.name))})),h()(U()(a),"getAllDetailTitle",(function(e){var t;return j.a.createElement("div",{className:Ge["template-detail-list-item-title"]},j.a.createElement("div",{className:Ge["title-text"]},null===(t=e.topic)||void 0===t?void 0:t.name),j.a.createElement("div",{onClick:function(){var t;a.props.onMoreClick((null===(t=e.topic)||void 0===t?void 0:t.id)||"")},className:Ge["title-more"]},_e.default.t("查看更多"),j.a.createElement("div",{className:Ge["title-arrow"]})))})),h()(U()(a),"getCoverSrc",(function(e){var t,n,a;return(null==e||null===(t=e.images)||void 0===t?void 0:t.pc_thumb_2x.url)||(null==e||null===(n=e.images)||void 0===n?void 0:n.pc_preview)||(null==e||null===(a=e.images)||void 0===a?void 0:a.mobile_thumb_2x)})),h()(U()(a),"getValidMeta",(function(e){try{return e?JSON.parse(e):{}}catch(e){return window.log.error("getValidMeta err",e),{}}})),a}return v()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.detailList,a=t.selectedTopicId,r=t.searchKey,o=(t.isLoading,t.selectedTemplateId),c=n,l=3;if(a){var s=n.find((function(e){return e.topic.id===a}));s&&(c=[s],l=9999)}else if(r){var d=[],u=[];n.forEach((function(e){e.items.forEach((function(t){t.name.includes(r)&&d.push(t),e.prices&&u.push.apply(u,i()(e.prices))}))})),c=[{topic:{name:_e.default.t("搜索结果"),id:""},items:d,prices:u}],l=9999}var p=a||r;return j.a.createElement("div",{className:Ge["template-detail-list-container"]},c.map((function(t){var n,a;return j.a.createElement("div",{key:null===(n=t.topic)||void 0===n?void 0:n.id,className:Ge["template-detail-list-item-container"],style:{marginBottom:p&&0}},p?e.getBreadcrumb(t):e.getAllDetailTitle(t),j.a.createElement("div",{className:Ge["template-detail-list-item-card-container"]},null===(a=t.items)||void 0===a?void 0:a.slice(0,l).map((function(n,a){var i;return j.a.createElement(B.Fragment,{key:n.id},j.a.createElement("div",{className:Ge["card-container"],style:{marginRight:(a+1)%3==0?0:15,marginBottom:p?16:0}},j.a.createElement("div",{className:Ge["card-cover"]},j.a.createElement("div",{className:Ge["cover-img"],style:{background:"url(".concat(e.getCoverSrc(e.getValidMeta(n.metaOfEachType)),")"),backgroundSize:"cover"}})),j.a.createElement("div",{className:Ge["card-title"]},j.a.createElement("div",{className:Ge["card-title-icon"]}),j.a.createElement("div",{className:Ge["card-title-text"]},n.name),j.a.createElement("div",{className:be()((i={},h()(i,Ge["card-vip-icon"],!0),h()(i,Ge[e.getVipType(t,n.id)],!0),i))})),n.id!==o&&j.a.createElement("div",{className:be()(h()({},Ge["card-mask"],!0))},j.a.createElement(He.a,{title:_e.default.t("预览"),placement:"bottom"},j.a.createElement("div",{onClick:function(){e.props.isLoading||e.props.onClick(n.id,e.getIsSuperVipTemplate(t,n.id))},className:Ge["card-preview-button"]},j.a.createElement("div",{className:Ge["card-preview-button-icon"]})))),n.id===o&&j.a.createElement("div",{className:be()(h()({},Ge["card-load"],!0))},e.props.isLoading?j.a.createElement("div",{className:Ge["card-loading"]},j.a.createElement("div",{className:Ge["card-loading-icon"]},j.a.createElement(qe.a,{spinType:"primary",style:{height:24,width:24}})),j.a.createElement("div",{className:Ge["card-loading-text"]},_e.default.t("生成预览"))):j.a.createElement("div",{className:Ge["card-loading"]},j.a.createElement("div",{className:Ge["card-loaded-icon"]}),j.a.createElement("div",{className:Ge["card-loading-text"]},_e.default.t("预览完成"))))))}))))})))}}]),n}(j.a.Component),Ye=n("99f931ad4f");function Ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=W()(e);if(t){var i=W()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return q()(this,n)}}var Je=function(e){G()(n,e);var t=Ke(n);function n(e){var a;return p()(this,n),a=t.call(this,e),h()(U()(a),"scrollContainerRef",void 0),h()(U()(a),"handleTopicInit",function(){var e=l()(x.a.mark((function e(t){var n,i,r,o,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(null==t||null===(n=t.filter)||void 0===n?void 0:n.call(t,(function(e){return!!e.topicId})))||[],r=i.map((function(e){return e.topicId})),0!==a.state.detailList.length){e.next=10;break}return e.next=5,Object(Ne.d)(r);case 5:o=e.sent,c={},o.forEach((function(e){var t=e.items.filter((function(e){var t=e.id;if(c[t])return!1;if(Ye.a[t])return!1;var n=a.getCoverSrc(a.getValidMeta(e.metaOfEachType));return!(null==n||!n.startsWith("http"))&&(c[t]=!0,!0)}));e.items=t})),a.setState({topicList:i,detailList:o}),a.props.changeTemplateService.detailList=o;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(U()(a),"scrollToTop",(function(){a.scrollContainerRef&&(a.scrollContainerRef.scrollTop=0)})),h()(U()(a),"handleBack",(function(){a.setState({selectedTopicId:"",searchKey:""})})),h()(U()(a),"handleTopicSelect",(function(e){a.setState({selectedTopicId:e,searchKey:""})})),h()(U()(a),"handleSearch",(function(e){a.setState({selectedTopicId:"",searchKey:e})})),h()(U()(a),"getCoverSrc",(function(e){var t,n,a;return(null==e||null===(t=e.images)||void 0===t?void 0:t.pc_thumb_2x.url)||(null==e||null===(n=e.images)||void 0===n?void 0:n.pc_preview.url)||(null==e||null===(a=e.images)||void 0===a?void 0:a.mobile_thumb_2x.url)})),h()(U()(a),"getValidMeta",(function(e){try{return e?JSON.parse(e):{}}catch(e){return window.log.error("getValidMeta err",e),{}}})),a.state={selectedTopicId:"",topicList:[],detailList:a.props.changeTemplateService.detailList,searchKey:""},a}return v()(n,[{key:"componentDidUpdate",value:function(e,t){this.state.selectedTopicId===t.selectedTopicId&&this.state.searchKey===t.searchKey||this.scrollToTop()}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{className:Ie["template-select-container"]},j.a.createElement(je,{selectedTopicId:this.state.selectedTopicId,onTopicSelect:this.handleTopicSelect,onTopicInit:this.handleTopicInit,onSearch:this.handleSearch}),j.a.createElement("div",{ref:function(t){return e.scrollContainerRef=t},className:Ie["template-detail-list-container"]},j.a.createElement(We,{selectedTemplateId:this.props.selectedTemplateId,isLoading:this.props.isLoading,onBack:this.handleBack,selectedTopicId:this.state.selectedTopicId,onMoreClick:this.handleTopicSelect,detailList:this.state.detailList,searchKey:this.state.searchKey,onClick:this.props.onTemplateSelect})))}}]),n}(j.a.Component),Xe=n("9049777d9b"),Qe=n("16e55f093a");function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=W()(e);if(t){var i=W()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return q()(this,n)}}var $e,et,tt,nt,at,it,rt,ot=function(e){G()(n,e);var t=Ze(n);function n(e){var a;return p()(this,n),a=t.call(this,e),h()(U()(a),"reaction",void 0),h()(U()(a),"reaction2",void 0),h()(U()(a),"vipTemplateMap",new Map),h()(U()(a),"getIsVipButton",(function(){var e=a.vipTemplateMap.get(a.state.selectedTemplateId);return e===ae.b.FreeForVIP&&!Object(Xe.d)()||e===ae.b.FreeForSuperVIP&&!Object(Xe.c)()})),h()(U()(a),"getIsVipTemplate",(function(){var e=a.vipTemplateMap.get(a.state.selectedTemplateId);return e===ae.b.FreeForVIP||e===ae.b.FreeForSuperVIP})),h()(U()(a),"revertPreview",l()(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.changeTemplateService.revertPreviewSlide();case 2:t=e.sent,a.setState({selectedTemplateId:"",previewUiDataService:t});case 4:case"end":return e.stop()}}),e)})))),h()(U()(a),"ddd",(function(e){})),h()(U()(a),"vipGuide",(function(){Object(Qe.b)(a.props.aid)})),h()(U()(a),"handleTemplateSelect",function(){var e=l()(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.changeTemplateService,a.setState({isLoading:!0,selectedTemplateId:t}),setTimeout(l()(x.a.mark((function e(){var i,r,o,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.changeTemplateService.getPresentationByCached(t);case 2:return i=e.sent,e.next=5,n.createTemplateUiDataService(i);case 5:return r=e.sent,o=r.cloneUiDataService,e.next=9,n.previewBeautifyUi(t,i,!0);case 9:c=e.sent,a.setState({templateUiDataService:o,isLoading:!1,previewUiDataService:c});case 11:case"end":return e.stop()}}),e)}))),100);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(U()(a),"handleTemplateOk",l()(x.a.mark((function e(){var t,n,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(((t=a.vipTemplateMap.get(a.state.selectedTemplateId))!==ae.b.FreeForVIP||Object(Xe.d)())&&(t!==ae.b.FreeForSuperVIP||Object(Xe.c)())){e.next=4;break}return a.vipGuide(),e.abrupt("return");case 4:return n=X.a.show({tip:S.a.t("加载中...")}),i=a.props.changeTemplateService,e.next=8,i.updateTemplateToSlide(a.state.selectedTemplateId);case 8:requestAnimationFrame((function(){a.onCancel(),a.setState({selectedTemplateId:""}),setTimeout((function(){n.close()}),1e3)}));case 9:case"end":return e.stop()}}),e)})))),h()(U()(a),"onCancel",(function(){a.revertPreview(),a.closeModal()})),h()(U()(a),"updateComponent",(function(){a.forceUpdate()})),h()(U()(a),"closeModal",(function(){a.props.changeTemplateService.closeTemplateBeautifyDialog()})),h()(U()(a),"handleThemeSelect",l()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),h()(U()(a),"handleOk",l()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),h()(U()(a),"handleSnackbar",(function(){})),h()(U()(a),"initEvent",(function(){a.reaction=Object(A.r)((function(){return a.props.changeTemplateService.dialogVisible}),(function(e){a.setState({dialogVisible:e})}))})),a.state={dialogVisible:a.props.changeTemplateService.dialogVisible,templateUiDataService:void 0,selectedTemplateId:"",isLoading:!1,previewUiDataService:a.props.uiDataService},a.initEvent(),a}return v()(n,[{key:"componentDidUpdate",value:function(e,t,n){this.props.uiDataService!==t.previewUiDataService&&this.setState({previewUiDataService:this.props.uiDataService})}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){var e,t;null===(e=this.reaction)||void 0===e||e.call(this),null===(t=this.reaction2)||void 0===t||t.call(this)}},{key:"render",value:function(){var e,t=this,n=this.props.uiDataService.presentation.props,a=n.slideWidth,i=n.slideHeight;return j.a.createElement(K.a,{zIndex:9999,destroyOnClose:!0,title:j.a.createElement(ct,{title:S.a.t("更多模板")}),onCancel:this.onCancel,style:{padding:0,width:1001},footer:null,className:be()((e={},h()(e,ne["template-modal-container"],!0),h()(e,"slide-template-modal-container-for-global",!0),e)),visible:this.state.dialogVisible},j.a.createElement("div",{onContextMenu:function(e){e.preventDefault()},className:ne["template-dialog-container"]},j.a.createElement("div",{className:ne["template-dialog-operation-area-container"]},j.a.createElement(Je,{selectedTemplateId:this.state.selectedTemplateId,isLoading:this.state.isLoading,changeTemplateService:this.props.changeTemplateService,onTemplateSelect:function(e,n){t.vipTemplateMap.set(e,n),t.handleTemplateSelect(e)}})),j.a.createElement(Ae,{onClick:l()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.handleTemplateOk();case 2:case"end":return e.stop()}}),e)}))),showVipGuideButton:this.getIsVipButton(),isVipTemplate:this.getIsVipTemplate(),onUndo:this.revertPreview,selectedTemplateId:this.state.selectedTemplateId,isLoading:this.state.isLoading,cloneUiDataService:this.state.previewUiDataService,templateUiDataService:this.state.templateUiDataService,slideHeight:i,slideWidth:a})))}}]),n}(j.a.Component),ct=function(e){G()(n,e);var t=Ze(n);function n(){return p()(this,n),t.apply(this,arguments)}return v()(n,[{key:"render",value:function(){return j.a.createElement("div",{className:ne["modal-title-container"]},j.a.createElement("div",{className:ne["modal-title-wrapper"]},this.props.title))}}]),n}(j.a.Component),lt=n("75f19a1449"),st=n("6ad6ba1542"),dt=n("86753a9dc2"),ut=n("f57c18cbbf"),pt=n("3344f1a2e7"),ft=n("1d0dc9eef2"),vt=n("af47f040ba"),mt=n("3f38f7f582");function ht(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw r}}}}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var gt,yt={title:S.a.t("标题"),type:T.U.ctrTitle},xt={title:S.a.t("标题"),type:T.U.title},St={title:S.a.t("副标题"),type:T.U.subTitle},wt={title:S.a.t("内容占位符"),type:void 0},At={title:S.a.t("日期占位符"),type:T.U.dt},Et={title:S.a.t("页脚占位符"),type:T.U.ftr},Tt={title:S.a.t("文本占位符"),type:T.U.body},kt={title:S.a.t("灯片编号占位符"),type:T.U.sldNum},It={title:S.a.t("图片占位符"),type:T.U.sldNum};!function(e){e[e.title=0]="title",e[e.secHead=1]="secHead",e[e.titleOnly=2]="titleOnly",e[e.end=3]="end"}(gt||(gt={}));var Ot=($e=Reflect.metadata("design:type",String),et=Reflect.metadata("design:type",void 0===R.IUiDataService?Object:R.IUiDataService),tt=function(){function e(){var t=this;p()(this,e),d()(this,"selectedName",nt,this),d()(this,"dialogVisible",at,this),d()(this,"templateSelectedKey",it,this),d()(this,"previewUiDataService",rt,this),h()(this,"detailList",[]),h()(this,"templateDataCached",new Map),h()(this,"services",void 0),h()(this,"willReplaceElement",new Map),h()(this,"beautifiedSlideCached",new Map),h()(this,"dialogContainer",document.createElement("div")),h()(this,"aid",void 0),h()(this,"setDelegate",(function(e){var n;t.services=e,t.updateSelectedName(),null===(n=O.a.SDKDataServices.EventManager())||void 0===n||n.commandEvents.onUndoRedoChange((function(e){e.source!==C.b.Undo&&e.source!==C.b.Redo||t.updateSelectedName()}))})),h()(this,"revertPreviewSlide",l()(x.a.mark((function e(){var n,a,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.createPreviewPresentationData(),e.next=3,t.createTemplateUiDataService(n);case 3:return a=e.sent,i=a.cloneUiDataService,t.previewUiDataService=i,e.abrupt("return",t.previewUiDataService);case 7:case"end":return e.stop()}}),e)})))),h()(this,"showTemplateBeautifyDialog",function(){var e=l()(x.a.mark((function e(n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:requestAnimationFrame(l()(x.a.mark((function e(){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dialogVisible=!0,a=t.createPreviewPresentationData(),e.next=4,t.createUiDataServiceWithNoConvert(a);case 4:t.previewUiDataService=e.sent,N.a.render(j.a.createElement(ot,o()({},n,{uiDataService:t.previewUiDataService,changeTemplateService:t,aid:t.aid})),t.dialogContainer);case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(this,"closeTemplateBeautifyDialog",(function(){t.dialogVisible=!1})),h()(this,"addNewMaster",(function(e,n,a){var i,r=(n?t.previewUiDataService:t.services.uiDataService).presentation,o=e.masterList[0].id,c=void 0,l=r.sdkData;O.a.SDKDataServices.DataValidator();Object(st.a)(e,"change_template_add_master",k.a.Presentation);var s=(null==l?void 0:l.api.addPresentation(e,null!==(i=null!=a?a:r.slideCount)&&void 0!==i?i:0))||{},d=s.redundantMasterMap,u=s.masterIdsArr;return null!=d&&d.has(o)?c=d.get(o)||"":null==u||u.forEach((function(e){null!=e&&e.has(o)&&(c=e.get(o)||"")})),c})),h()(this,"clearCached",(function(){t.willReplaceElement=new Map,t.beautifiedSlideCached=new Map})),h()(this,"applyCover",(function(e,n,a,i,r){var o=0,c=0,l=null,s=i.presentation;if(e.ctrTitleLeaf){var d,u,p,f=e.ctrTitleLeaf.text,v=null===(d=e.ctrTitleLeaf.contentBlock.visualBlocks[0].info)||void 0===d?void 0:d.element,m=null===(u=n.ctrTitleLeaf)||void 0===u||null===(p=u.contentBlock.visualBlocks[0].info)||void 0===p?void 0:p.element;if(m&&m.type===E.d.SHAPE){var h=m,b=v;r((function(){h.updateTextAdjust({autoFitType:I.a.FONT_AUTO_FIT,autoBreakType:I.g.WRAP})})),t.applyText(h,f),l=t.getRelationSlide(h),c=s.children.findIndex((function(e){return e===l})),o=t.getRelationSlideIndex(b,a),v&&t.willReplaceElement.set(v,!0)}else{var g,y,x={};Object.getPrototypeOf(v).constructor.convertDataUiToSdk(v,x,e.pageModel),null===(g=n.pageModel)||void 0===g||null===(y=g.sdkData)||void 0===y||y.api.addShapes([x])}}if((l=l||n.pageModel||null)&&!t.beautifiedSlideCached.has(l)&&t.beautifiedSlideCached.set(l,{index:o,templateIndex:c}),e.subTitleLeaf){var S,w,A=e.subTitleLeaf.text,T=null===(S=n.subTitleLeaf)||void 0===S||null===(w=S.contentBlock.visualBlocks[0].info)||void 0===w?void 0:w.element;if(T&&T.type===E.d.SHAPE){var k=T;r((function(){k.updateTextAdjust({autoFitType:I.a.FONT_AUTO_FIT,autoBreakType:I.g.WRAP})})),t.applyText(k,A)}}})),h()(this,"applyText",(function(e,t,n){var a,i,r=e,o=L()(r.paragraphList);null!=o&&null!==(a=o[0])&&void 0!==a&&null!==(i=a.textRuns)&&void 0!==i&&i[0]&&(o[0].textRuns[0].text=t,o.splice(1,o.length-1),o[0].textRuns.splice(1,o[0].textRuns.length-1)),r.updateParagraphList(o,n)})),h()(this,"getRelationSlide",(function(e){return function e(t){return(null==t?void 0:t.type)===E.d.SLIDE||null===t?t:e(t.parent)}(e)})),h()(this,"getRelationSlideIndex",(function(e,n){var a=t.getRelationSlide(e);return n.presentation.children.findIndex((function(e){return e===a}))})),h()(this,"getRelationSlideIndexBySlide",(function(e,t){return t.presentation.children.findIndex((function(t){return t===e}))})),h()(this,"applyContents",(function(e,n,a,i,r){var o,c,l=i.presentation,s=n.pageModel,d=l.children.findIndex((function(e){return e===s})),u=t.getRelationSlideIndexBySlide(e.pageModel,a);if(t.beautifiedSlideCached.has(s)||t.beautifiedSlideCached.set(s,{index:u,templateIndex:d}),e.ctrTitleLeaf){var p,f,v,m=e.ctrTitleLeaf.text,h=null===(p=e.ctrTitleLeaf.contentBlock.visualBlocks[0].info)||void 0===p?void 0:p.element,b=null===(f=n.ctrTitleLeaf)||void 0===f||null===(v=f.contentBlock.visualBlocks[0].info)||void 0===v?void 0:v.element;if(b&&b.type===E.d.SHAPE){var g=b;r((function(){g.updateTextAdjust({autoFitType:I.a.FONT_AUTO_FIT,autoBreakType:I.g.WRAP})})),t.applyText(g,m),h&&t.willReplaceElement.set(h,!0)}}e.titleLeafList&&e.titleLeafList.forEach((function(e,a){var i,o,c=e.text,l=null===(i=n.titleLeafList)||void 0===i?void 0:i[a],s=null==l||null===(o=l.contentBlock.visualBlocks[0].info)||void 0===o?void 0:o.element;if(s&&s.type===E.d.SHAPE){var d=s;r((function(){d.updateTextAdjust({autoFitType:I.a.FONT_AUTO_FIT,autoBreakType:I.g.WRAP})})),t.applyText(d,c)}})),e.subTitleLeafList&&e.subTitleLeafList.forEach((function(e,a){var i,o,c=e.text,l=null===(i=n.subTitleLeafList)||void 0===i?void 0:i[a],s=null==l||null===(o=l.contentBlock.visualBlocks[0].info)||void 0===o?void 0:o.element;if(s&&s.type===E.d.SHAPE){var d=s;r((function(){d.updateTextAdjust({autoFitType:I.a.FONT_AUTO_FIT,autoBreakType:I.g.WRAP})})),t.applyText(d,c)}}));var y=null===(o=e.titleLeafList)||void 0===o?void 0:o.length;y&&null!==(c=n.titleLeafList)&&void 0!==c&&c.length&&y<n.titleLeafList.length&&n.titleLeafList.forEach((function(e,a){if(a>=y){var i,o,c=null===(i=n.titleLeafList)||void 0===i?void 0:i[a],l=null==c||null===(o=c.contentBlock.visualBlocks[0].info)||void 0===o?void 0:o.element;if(l&&l.type===E.d.SHAPE){var s=l;r((function(){s.updateTextAdjust({autoFitType:I.a.FONT_AUTO_FIT,autoBreakType:I.g.WRAP})})),t.applyText(s,S.a.t("请输入标题"))}}}))})),h()(this,"applySection",(function(e,n,a,i,r){r((function(){e.forEach((function(e,o){var c;if(e.ctrTitleLeaf){var l,s,d=e.ctrTitleLeaf.text,u=null===(l=e.ctrTitleLeaf.contentBlock.visualBlocks[0].info)||void 0===l?void 0:l.element,p=n.ctrTitleLeaf,f=null==p||null===(s=p.contentBlock.visualBlocks[0].info)||void 0===s?void 0:s.element;if(f&&f.type===E.d.SHAPE){var v;r((function(){var a,i,c=f;if(v=u,r((function(){c.updateTextAdjust({autoFitType:I.a.FONT_AUTO_FIT,autoBreakType:I.g.WRAP})})),t.applyText(c,d),e.subTitleLeaf){var l,s,p,m=e.subTitleLeaf.text,h=e.subTitleLeaf,b=null===(l=n.subTitleLeaf)||void 0===l?void 0:l.contentBlock,g=null===(s=h.contentBlock.visualBlocks[0].info)||void 0===s?void 0:s.element,y=null==b||null===(p=b.visualBlocks[0].info)||void 0===p?void 0:p.element;if(y&&y.type===E.d.SHAPE){var x=y;v=g,t.applyText(x,m)}}null!==(a=n.indexLeaf)&&void 0!==a&&a.text&&t.setIndex(n.indexLeaf,o),null!==(i=n.subIndexLeaf)&&void 0!==i&&i.text&&t.setIndex(n.subIndexLeaf,o)})),r((function(){var e,n,a=null===(e=t.getRelationSlide(f).sdkData)||void 0===e?void 0:e.getCloneData();null===(n=i.presentation.sdkData)||void 0===n||n.api.addSlides([a])}));var m=i.presentation,h=m.children.length-1,b=m.children[h],g=m.children.findIndex((function(e){return e===b}));c=t.getRelationSlideIndex(v,a),t.beautifiedSlideCached.has(b)||t.beautifiedSlideCached.set(b,{index:c,templateIndex:g}),u&&t.willReplaceElement.set(u,!0)}}}))}))})),h()(this,"applyCoverBack",(function(e,n,a,i){var r,o,c=i.presentation;if(e.ctrTitleLeaf){var l,s,d,u=e.ctrTitleLeaf.text,p=null===(l=e.ctrTitleLeaf.contentBlock.visualBlocks[0].info)||void 0===l?void 0:l.element,f=null===(s=n.ctrTitleLeaf)||void 0===s||null===(d=s.contentBlock.visualBlocks[0].info)||void 0===d?void 0:d.element;if(f&&f.type===E.d.SHAPE){var v=f,m=p;t.applyText(v,u),o=t.getRelationSlide(v);var h=c.children.findIndex((function(e){return e===o}));r=t.getRelationSlideIndex(m,a),t.beautifiedSlideCached.has(o)||t.beautifiedSlideCached.set(o,{index:r,templateIndex:h}),p&&t.willReplaceElement.set(p,!0)}}if(e.subTitleLeaf){var b,g,y=e.subTitleLeaf.text,x=null===(b=n.subTitleLeaf)||void 0===b||null===(g=b.contentBlock.visualBlocks[0].info)||void 0===g?void 0:g.element;if(x&&x.type===E.d.SHAPE){var S=x;t.applyText(S,y)}}})),h()(this,"deleteUnUseTemplateSlide",(function(e){var n,a,i=[];e.presentation.children.forEach((function(e){if(!t.beautifiedSlideCached.has(e)&&e.sdkData){var n=e.sdkData;i.push(n)}})),null===(n=e.presentation.sdkData)||void 0===n||null===(a=n.api)||void 0===a||a.removeSlides(i)})),h()(this,"createPreviewPresentationData",(function(){return t.services.uiDataService.presentation.sdkData.getCloneData()})),h()(this,"changeTemplate",function(){var e=l()(x.a.mark((function e(n,a){var i,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.slideList=[],n.noteSlideMap={},i=t.services.uiDataService,e.next=5,null==i?void 0:i.forceConvertSlides(i.presentation.children);case 5:t.formatLayout(n),t.selectedName=n.masterList[0].cSld.name,r=n.masterList[0].themeId,n.themeList.find((function(e){return e.id===r})),Object(w.b)((function(){Object(w.b)((function(){t.services.themeColorManager.convertCustomColorToTheme(!1)}));var e="";Object(w.b)((function(){e=t.addNewMaster(n,!1)||""})),e&&(Object(w.b)((function(){var n=t.findMasterIndexByMasterId(e,t.services.uiDataService),a=t.services.uiDataService.presentation.children,i=t.services.uiDataService.presentation;if(null!=i&&i.sdkData){var r=i.sdkData.masterList[n];t.formatSlide(a),a.forEach((function(e,a){if(0===a)t.setFirstSlide(e,n);else{var i=t.mappingTitleType(e),o=t.getMappingName(i),c=t.classifyAndFormatAITemplate(r,o);t.changeLayout(e,r,c)}}))}})),t.deleteOldMasterAndLayout(e))})),t.services.themeColorManager.updateCurrentThemeModel();case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),h()(this,"previewBeautifyUi",function(){var e=l()(x.a.mark((function e(n,a,i){var r,o,c,l,s,d,u,p,f,v,m,h,b,g,y;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.clearCached(),e.next=3,t.createTemplateUiDataService(a);case 3:if(r=e.sent,o=r.cloneUiDataService,c=r.cloneStoreService,l=Object(w.a)(c),s=t.services.uiDataService,d=w.b,!i){e.next=19;break}return u=t.createPreviewPresentationData(),e.next=13,t.createTemplateUiDataService(u);case 13:p=e.sent,f=p.cloneUiDataService,v=p.cloneStoreService,s=f,v&&(d=Object(w.a)(v)),t.previewUiDataService=s;case 19:return e.next=21,t.services.templateContentAnalyzerService.promise();case 21:return m=e.sent,e.next=24,m.analyzerUserDocs({templatePresentation:s.presentation});case 24:return h=e.sent,e.next=27,m.analyzerNonStandardTemplate({templatePresentation:o.presentation});case 27:return b=e.sent,y=s.presentation.layoutList.length,l((function(){t.services.templateFormatService.formatTemplateStandard(o)})),d((function(){var e;d((function(){t.scaleTemplateForSameSize(s,o)}));var n,a=!1,r=!1,c=b.templateContentBackResult,u=c.firstElement,p=c.secondElement,f=c.thirdElement,v=c.fillBackground,x=c.pageModel,S=c.relationLayoutIndex;y+=S||0,d((function(){t.applyFillBeautify(h,b,s,o,d)})),d((function(){if(b.templateContentBackResult&&h.userDocContentResult){n=v;var i=o.presentation,c=m.isBackgroundElement({element:u,slide:x,isStrict:!0,presentation:i}),l=m.isBackgroundElement({element:p,slide:x,isStrict:!0,presentation:i}),g=m.isBackgroundElement({element:f,slide:x,isStrict:!0,presentation:i});a=c||l||g||!!v,(r=c||l||g)&&d((function(){t.handleBackgroundClear(s,m)})),e=b.mainFontColor;var y=[];u&&y.push(u),p&&y.push(p),f&&y.push(f)}})),l((function(){t.deleteUnUseTemplateSlide(o)})),g=t.replaceFillSlide({templateUiDataService:o,willChangeUiDataService:s,isPreview:i,masterId:g,willChangeTransaction:d});var w=[];t.changeLayoutForTemplate({willChangeUiDataService:s,oldLayoutNumber:y,masterId:g,slideList:w,willChangeTransaction:d}),d((function(){t.beautifyBackgroundFill({fillBackground:n,slideList:w})})),d((function(){t.beautifyMainFontColor({mainFontColor:e,hasBack:a,templateFillBackground:n,hasBackElement:r,slideList:w})})),d((function(){g&&t.deleteUnUseMasterAndLayoutAndTheme(s)}))})),e.abrupt("return",s);case 32:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()),h()(this,"createTemplateUiDataService",function(){var e=l()(x.a.mark((function e(n){var a,i,r,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O.a.SDKDataServices.PresentationStoreService().createFromData(n),i=null==a?void 0:a.getPresentation(),r=new P.a({selectionService:t.services.selectionService}),(o=new D.a).presentation=r,o.presentation.asyncConvertChildren=!1,o.presentation.asyncConvertSlideChildren=!1,o.setSlideRenderStateManagerDelegate(t.services.slideRenderStateManager),e.next=10,r.bindSDK(i);case 10:return e.next=12,null==o?void 0:o.forceConvertSlides(o.presentation.children);case 12:return e.abrupt("return",{cloneUiDataService:o,cloneStoreService:a});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(this,"createUiDataServiceWithNoConvert",function(){var e=l()(x.a.mark((function e(n){var a,i,r,o,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null===(a=O.a.SDKDataServices.PresentationStoreService())||void 0===a?void 0:a.createFromData(n),r=null==i?void 0:i.presentation,o=new P.a({selectionService:t.services.selectionService}),(c=new D.a).presentation=o,c.setSlideRenderStateManagerDelegate(t.services.slideRenderStateManager),e.next=8,o.bindSDK(r);case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(this,"updateTemplateToSlide",function(){var e=l()(x.a.mark((function e(n){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPresentationByCached(n);case 2:return a=e.sent,e.next=5,t.previewBeautifyUi(n,a,!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(this,"getCoverSrc",(function(e){var t,n,a;return(null==e||null===(t=e.images)||void 0===t?void 0:t.pc_thumb_2x.url)||(null==e||null===(n=e.images)||void 0===n?void 0:n.pc_preview)||(null==e||null===(a=e.images)||void 0===a?void 0:a.mobile_thumb_2x)})),h()(this,"checkSimilarHsl",(function(e,t){var n=Math.abs(e.L-t.L);if(n<20)return!0;if(n<50){var a=Math.abs(e.H-t.H);if(a<30)return!0;if(Math.abs(a-255)<30)return!0}return!1})),h()(this,"hasSimilarFill",(function(e,n,a){var i=!1,r=t.getRect(e),o=t.getFillColor(e);return n.forEach((function(e,n){var o=e.rect,c=e.fillColor;t.checkRectOverLap(o,r)&&t.checkSimilarHsl(c.hsl,a.hsl)&&(i=!0)})),r&&o&&n.set(e,{rect:r,fillColor:o}),i})),h()(this,"getFillColor",(function(e){var t,n=e.props.style.fillBackground;return null==n||null===(t=n.solidFill)||void 0===t?void 0:t.color})),h()(this,"getRect",(function(e){var t=e.props.style;return{left:t.left,top:t.top,width:t.width,height:t.height}})),h()(this,"checkRectOverLap",(function(e,t){var n=e.left,a=e.left+e.width,i=e.top,r=e.top+e.height,o=t.left,c=t.left+t.width,l=t.top;return!(i>t.top+t.height)&&(!(a<o)&&(!(r<l)&&!(n>c)))})),h()(this,"changeMainFontColor",(function(e,n){var a,i,r,o,c;switch(e.type){case E.d.SHAPE:t.changeMainFontColorForShape(e,n);break;case E.d.GROUP:t.changeMainFontColorForGroup(e,n);break;case E.d.TABLE:e.clearAllCellFill(),e.updateTblProp({tableStyleId:"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}",firstRow:!0,bandRow:!0});break;case E.d.CHART:null!==(a=e.props)&&void 0!==a&&null!==(i=a.style)&&void 0!==i&&i.fillBackground&&1!==(null===(r=e.props)||void 0===r||null===(o=r.style)||void 0===o||null===(c=o.fillBackground)||void 0===c?void 0:c.noFill)||e.updateProps({chartSpace:{props:{style:{fillBackground:{solidFill:new ft.a(new lt.a({rgbaStr:"#ffffff"}))}}}}}),e.chartProperty.updateChartColors(vt.d.colorful[0]);break;default:return}})),h()(this,"changeMainFontColorForGroup",(function(e,n){e.children.forEach((function(e){e.type===E.d.GROUP?t.changeMainFontColorForGroup(e,n):e.type===E.d.SHAPE?t.changeMainFontColorForShape(e,n):(e.type,E.d.CHART)}))})),h()(this,"changeMainFontColorForShape",(function(e,t){var n;if(e.paragraphList&&t&&(!e.props.style.fillBackground||1===(null===(n=e.props.style.fillBackground)||void 0===n?void 0:n.noFill))){var a=L()(e.paragraphList);a.forEach((function(e){var n;null===(n=e.textRuns)||void 0===n||n.forEach((function(e){e.styles&&(e.styles.gradFill=null,e.styles.tdColor=t,e.styles["raw-tdColor"]=!0,e.styles["raw-color"]=!0,e.styles.color=t.srgb_color)}))})),e.updateParagraphList(a)}})),h()(this,"formatLayout",(function(e){var n=t.services.uiDataService.presentation.sdkData,a=e.sldSz,i=a.cx,r=a.cy,o=n.props.sldSz,c=o.cx,l=o.cy;e.sldSz.cx=c,e.sldSz.cy=l;var s=i/c,d=r/l,u=e.layoutMap;for(var p in u){var f,v=ht(u[p].cSld.spTree.shapeList);try{for(v.s();!(f=v.n()).done;){var m=f.value;t.scaleShapeFrame(m,s,d)}}catch(e){v.e(e)}finally{v.f()}}})),h()(this,"changeLayout",(function(e,t,n){e.changeLayoutLite(t,n)})),h()(this,"findMasterIndexByMasterId",(function(e,t){var n=(t.presentation.sdkData||{}).masterList;return(void 0===n?[]:n).findIndex((function(t){return e===t.id}))})),h()(this,"classifyAndFormatAITemplate",(function(e,t){var n=e.layoutList,a=n.findIndex((function(e){return e.props.cSld.name===t}));return-1===a?n[0]:n[a]})),h()(this,"getMappingName",(function(e){switch(e){case gt.title:return S.a.t("封面");case gt.secHead:return S.a.t("节标题");case gt.titleOnly:return S.a.t("仅标题");default:return S.a.t("封底")}})),h()(this,"mappingTitleType",(function(e){var t=e.children,n=0,a=0,i=0;return t.forEach((function(e){var t,r,o,c;e.isPlaceholder&&("ctrTitle"===(null==e||null===(t=e.placeHolder)||void 0===t?void 0:t.type)&&(n+=1),"subTitle"===(null==e||null===(r=e.placeHolder)||void 0===r?void 0:r.type)&&1,"body"===(null==e||null===(o=e.placeHolder)||void 0===o?void 0:o.type)&&(a+=1),"title"===(null==e||null===(c=e.placeHolder)||void 0===c?void 0:c.type)&&(i+=1))})),1===n?gt.title:1===i&&1===a?gt.secHead:gt.titleOnly})),h()(this,"setFirstSlide",(function(e,n){var a,i=t.getMappingName(gt.title),r=null===(a=t.services.uiDataService.presentation.sdkData)||void 0===a?void 0:a.masterList[n],o=t.classifyAndFormatAITemplate(r,i);t.changeLayout(e,r,o)})),h()(this,"formatSlide",(function(e){e.forEach((function(e){e.getBackgroundFill().updateCurrentFill({});var n=!1,a=e.children[0];if((null==a?void 0:a.type)===E.d.IMAGE){var i=a;n=n||t.handleImage(e,i)}t.handlePlaceholder(e,n)}))})),h()(this,"handleImage",(function(e,n){var a=!1,i=t.services.uiDataService.presentation.props,r=i.slideWidth,o=i.slideHeight,c=n.props.style||{},l=c.width,s=void 0===l?0:l,d=c.height;return s>.9*r&&(void 0===d?0:d)>.9*o&&(e.deleteElement([n]),a=!0),a})),h()(this,"handlePlaceholder",(function(e,t){e.children.forEach((function(e,n){t&&0===n||e.type===E.d.SHAPE&&e.isPlaceholder&&e.placeHolder&&e.updateTextAdjust({autoFitType:I.a.NO_AUTO_FIT,autoBreakType:I.g.NO_WRAP})}))})),h()(this,"deleteUnUseMasterAndLayoutAndTheme",(function(e){var t,n,a,r,o=e.presentation,c=[],l=new Set,s=[];null===(t=o.sdkData)||void 0===t||t.slideList.forEach((function(e){var t,n,a,i=null===(t=e.getLayout())||void 0===t||null===(n=t.getMaster())||void 0===n?void 0:n.id,r=null===(a=o.sdkData)||void 0===a?void 0:a.masterList.find((function(e){return e.id===i}));r&&l.add(r)})),null===(n=o.sdkData)||void 0===n||n.masterList.forEach((function(e){l.has(e)||c.push(e)})),null==c||c.forEach((function(e){s.push.apply(s,i()(e.layoutList))})),null===(a=o.sdkData)||void 0===a||a.api.removeLayouts(s),null===(r=o.sdkData)||void 0===r||r.api.removeMasters(c)}))}var t;return v()(e,[{key:"setIndex",value:function(e,t){var n,a,i=null==e||null===(n=e.text)||void 0===n?void 0:n.toLowerCase(),r=e,o=null==r||null===(a=r.contentBlock.visualBlocks[0].info)||void 0===a?void 0:a.element;if((null==o?void 0:o.type)===E.d.SHAPE&&i){var c,l,s,d,u,p=o,f=/0?[\d]$/,v=/一/,m=/壹/,h=/one/,b=null===(c=f.exec(i))||void 0===c?void 0:c[0],g=null===(l=v.exec(i))||void 0===l?void 0:l[0],y=null===(s=m.exec(i))||void 0===s?void 0:s[0],x=null===(d=h.exec(i))||void 0===d?void 0:d[0],w="";if(((null==b?void 0:b.length)||0)>0&&t<10&&(w="".concat(t+1),w="0".concat(w),i=i.replace(f,w)),((null==g?void 0:g.length)||0)>0&&t<10){var A=[S.a.t("一"),S.a.t("二"),S.a.t("三"),S.a.t("四"),S.a.t("五"),S.a.t("六"),S.a.t("七"),S.a.t("八"),S.a.t("九")];w="".concat(A[t])||"",i=i.replace(v,w)}if(((null==y?void 0:y.length)||0)>0&&t<10){var T=[S.a.t("壹"),S.a.t("贰"),S.a.t("叁"),S.a.t("肆"),S.a.t("伍"),S.a.t("陆"),S.a.t("柒"),S.a.t("捌"),S.a.t("玖")];w="".concat(T[t])||"",i=i.replace(m,w)}if(((null==x?void 0:x.length)||0)>0&&t<10){w="".concat(["one","two","three","four","five","six","seven","eight","nine"][t])||"",i=i.replace(h,w)}this.applyText(p,null===(u=i)||void 0===u?void 0:u.toUpperCase())}}},{key:"updateAid",value:function(e){this.aid=Object(mt.getAidForReport)(e)}},{key:"getPresentationByCached",value:(t=l()(x.a.mark((function e(t){var n,a,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.templateDataCached.has(t)){e.next=10;break}return e.next=3,Object(dt.b)(t);case 3:a=e.sent,(i=Object(ut.a)(L()(a))).noteSlideMap={},this.templateDataCached.set(t,i),n=i,e.next=11;break;case 10:n=this.templateDataCached.get(t);case 11:return e.abrupt("return",L()(n));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"beautifyBackgroundFill",value:function(e){var t=e.fillBackground,n=e.slideList;t&&n.forEach((function(e){e.getBackgroundFill().updateCurrentFill(t)}))}},{key:"beautifyMainFontColor",value:function(e){var t=this,n=e.mainFontColor,a=e.hasBack,i=e.templateFillBackground,r=e.hasBackElement,o=e.slideList;if(n&&a){if(i&&n&&!r){var c,l,s=null===(c=i.solidFill)||void 0===c||null===(l=c.color)||void 0===l?void 0:l.hsl,d=n.hsl;if(s&&d&&Math.abs(s.H-d.H)<10&&Math.abs(s.S-d.S)<10&&Math.abs(s.L-d.L)<10)return}o.forEach((function(e){var a=new Map;e.children.forEach((function(i){var r;if(n){var o=e.sdkData;-1!==(null==o||null===(r=o.shapeList)||void 0===r?void 0:r.findIndex((function(e){return e===i.sdkData})))&&(i.type!==E.d.SHAPE&&i.type!==E.d.CHART&&i.type!==E.d.GROUP&&i.type!==E.d.TABLE||t.hasSimilarFill(i,a,n)||t.changeMainFontColor(i,n))}}))}))}}},{key:"replaceFillSlide",value:function(e){var t=this,n=e.templateUiDataService,a=e.willChangeUiDataService,i=e.isPreview,r=e.willChangeTransaction,o=e.masterId;return r((function(){var e,c=null===(e=n.presentation.sdkData)||void 0===e?void 0:e.getCloneData();c&&(c.slideList=[],n.presentation.children.forEach((function(e){r((function(){var n,l=t.beautifiedSlideCached.get(e),s=(null==l?void 0:l.index)||0,d=null===(n=e.sdkData)||void 0===n?void 0:n.getCloneData(),u=a.presentation;if(d){var p,f=null===(p=u.children[s])||void 0===p?void 0:p.sdkData;f&&r((function(){var e=u.sdkData;null==e||e.api.removeSlides([f])})),r((function(){c.slideList=[d];var e=t.addNewMaster(c,i,s);o||(o=e)}))}}))})))})),o}},{key:"changeLayoutForTemplate",value:function(e){var t=this,n=e.willChangeUiDataService,a=e.oldLayoutNumber,i=e.masterId,r=e.slideList;(0,e.willChangeTransaction)((function(){var e=[];t.beautifiedSlideCached.forEach((function(t,n,a){e.push(t.index)}));var o=n.presentation,c=o.sdkData,l=((null==c?void 0:c.layoutList)||[])[a];o.children.forEach((function(a,o){if(!e.includes(o)&&i){r.push(a);var s=t.findMasterIndexByMasterId(i,n),d=c.masterList[s];l&&a.changeLayoutLite(d,l)}}))}))}},{key:"applyFillBeautify",value:function(e,t,n,a,i){var r;e.userDocCoverResult&&t.templateCoverResult&&this.applyCover(e.userDocCoverResult,t.templateCoverResult,n,a,i),e.userDocContentsResult&&t.templateContentsResult&&this.applyContents(e.userDocContentsResult,t.templateContentsResult,n,a,i),null!==(r=e.userDocSectionResult)&&void 0!==r&&r.length&&t.templateSectionResult&&this.applySection(e.userDocSectionResult,t.templateSectionResult,n,a,i)}},{key:"handleBackgroundClear",value:function(e,t){var n=e.presentation;e.presentation.children.forEach((function(e){var a=[];e.children.forEach((function(i){t.isBackgroundElement({element:i,slide:e,isStrict:!0,presentation:n})&&a.push(i)})),null==e||e.getBackgroundFill().updateCurrentFill({}),a.length&&e.deleteElement(a)}))}},{key:"scaleTemplateForSameSize",value:function(e,t){var n=e.presentation.props.slideWidth,a=e.presentation.props.slideHeight,i=t.presentation.props.slideWidth,r=t.presentation.props.slideHeight,o=i/n;1===o&&1===r/a||e.presentation.updateCustomSlideSize(Object(pt.E)(i)/2,Object(pt.E)(r)/2,o,T.jb.custom)}},{key:"scaleShapeFrame",value:function(e,t,n){if(e.spPr.xfrm){var a=e.spPr.xfrm.off,i=e.spPr.xfrm.ext;e.spPr.xfrm.off={x:((null==a?void 0:a.x)||0)/t,y:((null==a?void 0:a.y)||0)/n},e.spPr.xfrm.ext={cx:((null==i?void 0:i.cx)||0)/t,cy:((null==i?void 0:i.cy)||0)/n}}}},{key:"moveShapeFrame",value:function(e,t,n){if(e.getOwnedData().spPr.xfrm){var a=e.getFrame().move(t,n).floor(),i=a.left,r=a.top;e.api.updateTransform({off:{x:i,y:r}})}}},{key:"deleteOldMasterAndLayout",value:function(e){var t=this;Object(w.b)((function(){var n,a,r,o=t.services.uiDataService.presentation,c=(null===(n=o.sdkData)||void 0===n?void 0:n.masterList.filter((function(t){return t.id!==e})))||[],l=[];null==c||c.forEach((function(e){l.push.apply(l,i()(e.layoutList))})),null===(a=o.sdkData)||void 0===a||a.api.removeLayouts(l),null===(r=o.sdkData)||void 0===r||r.api.removeMasters(c)}))}},{key:"updateSelectedName",value:function(){var e,t,n=null===(e=this.services.selectionService.currentSlide)||void 0===e?void 0:e.getRelationMasterModel();n&&(this.selectedName=null===(t=n.sdkData)||void 0===t?void 0:t.props.cSld.name)}}]),e}(),nt=g()(tt.prototype,"selectedName",[A.q,$e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at=g()(tt.prototype,"dialogVisible",[A.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),it=g()(tt.prototype,"templateSelectedKey",[A.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),rt=g()(tt.prototype,"previewUiDataService",[A.q,et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt)},"659f690fe6":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("9132715560"),i=n.n(a),r=n("6a364eb35c"),o=n.n(r),c=n("85d0a7609b"),l=n.n(c),s=function(){function e(t){i()(this,e),l()(this,"props",void 0),l()(this,"noEditService",void 0),l()(this,"editExtensionService",void 0),this.props=t,this.noEditService=t.noEditService,this.editExtensionService=t.extensionService}return o()(e,[{key:"hide",value:function(e){}},{key:"show",value:function(e){}},{key:"dispose",value:function(){}}]),e}();l()(s,"pluginTag",0)},6639273864:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".template-beautify-style-template-dialog-container-1Mpyk{width:100%;height:623px;box-sizing:content-box;position:relative;display:flex;justify-content:space-between;border-top:1px solid #e8e8e8;-webkit-user-select:none;-ms-user-select:none;user-select:none;overflow-y:hidden}.slide-template-modal-container-for-global>.dui-modal-title{margin-bottom:16px}.slide-template-modal-container-for-global>.dui-modal-close{top:17px}.template-beautify-style-template-modal-container-3rJOk{width:1080px;height:680px}.template-beautify-style-template-dialog-operation-area-container-2PG92{width:662px;height:623px;background:#f1f4f6}.template-beautify-style-modal-title-container-1STMi{padding:17px 24px 1px;font-family:PingFang SC;font-size:16px;font-style:normal;font-weight:600;line-height:22px;display:flex;align-items:center}.template-beautify-style-modal-title-wrapper-3JXnY{margin-right:8px}.template-beautify-style-modal-icon-1XA12{display:block;width:12px;height:12px;margin:0 4px}.template-beautify-style-modal-vip-tips-1hWfJ{font-size:12px;font-weight:400;color:rgba(0,0,0,.64);margin-right:4px}.template-beautify-style-modal-vip-button-pMVaL{font-size:12px;font-weight:600;color:#e59837;margin:0 4px;cursor:pointer}.template-beautify-style-modal-footer-container-25Gm9{padding:24px;font-family:PingFang SC;position:relative;height:84px}.template-beautify-style-modal-footer-button-container-3-IT5{position:absolute;right:24px;width:208px;display:flex;justify-content:space-between}",""]),t.locals={"template-dialog-container":"template-beautify-style-template-dialog-container-1Mpyk","template-modal-container":"template-beautify-style-template-modal-container-3rJOk","template-dialog-operation-area-container":"template-beautify-style-template-dialog-operation-area-container-2PG92","modal-title-container":"template-beautify-style-modal-title-container-1STMi","modal-title-wrapper":"template-beautify-style-modal-title-wrapper-3JXnY","modal-icon":"template-beautify-style-modal-icon-1XA12","modal-vip-tips":"template-beautify-style-modal-vip-tips-1hWfJ","modal-vip-button":"template-beautify-style-modal-vip-button-pMVaL","modal-footer-container":"template-beautify-style-modal-footer-container-25Gm9","modal-footer-button-container":"template-beautify-style-modal-footer-button-container-3-IT5"}},"715e175f43":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-bullets-menu-2AWbT{display:flex;flex-flow:row wrap;border:none;box-shadow:none;background:none;-webkit-backdrop-filter:none;backdrop-filter:none}.style-bullets-menu-2AWbT>div{width:25%;height:80px}.style-bullets-menu-item-d06Vi{width:100%;height:100%;padding:0;margin:0;display:inline-flex;align-items:center;justify-content:center}.style-bullets-menu-item-d06Vi>div{padding:10px 20px}.style-bullets-menu-item-d06Vi.style-selected-8kksF{background-color:rgba(0,0,0,.08)}",""]),t.locals={"bullets-menu":"style-bullets-menu-2AWbT","bullets-menu-item":"style-bullets-menu-item-d06Vi",selected:"style-selected-8kksF"}},"71b6244252":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-dialog-modal-operation-area-2QHX-{display:flex;margin:10px 0;padding-left:10px}",""]),t.locals={"dialog-modal-operation-area":"style-dialog-modal-operation-area-2QHX-"}},"73776ff547":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var a=n("c92b994f13")(n("0f2367b803"));t.push([e.i,".index-detail-header-container-37GiK{border-top:1px solid #f1f4f6;box-sizing:border-box;width:338px}.index-detail-header-title-container-2uz04{width:100%;height:52px;display:flex;justify-content:space-between;padding:12px 16px}.index-detail-header-title-text-3mxq0{height:28px;padding:4px 0;line-height:20px;font-size:14px;font-weight:600;color:#000;opacity:.88}.index-detail-header-title-button-3NFxL{color:rgba(0,0,0,.64)}.index-detail-header-undo-container-11Kku{width:100%;height:28px;display:flex;justify-content:flex-end;padding:0 16px;cursor:pointer}.index-detail-header-undo-container-11Kku.index-disabled-18_WS{opacity:.28;cursor:not-allowed}.index-detail-header-undo-container-11Kku .index-undo-button-2KBnr{width:76px;line-height:28px;height:28px;display:flex;justify-content:space-between}.index-detail-header-undo-container-11Kku .index-undo-button-2KBnr .index-undo-icon-1_VRN{background:url("+a+");background-size:contain;width:20px;height:20px;margin:4px 2px}.index-detail-header-undo-container-11Kku .index-undo-button-2KBnr .index-undo-text-2Tgog{color:rgba(0,0,0,.88);font-size:12px;font-style:normal;font-weight:400}",""]),t.locals={"detail-header-container":"index-detail-header-container-37GiK","detail-header-title-container":"index-detail-header-title-container-2uz04","detail-header-title-text":"index-detail-header-title-text-3mxq0","detail-header-title-button":"index-detail-header-title-button-3NFxL","detail-header-undo-container":"index-detail-header-undo-container-11Kku",disabled:"index-disabled-18_WS","undo-button":"index-undo-button-2KBnr","undo-icon":"index-undo-icon-1_VRN","undo-text":"index-undo-text-2Tgog"}},"8296b34ae7":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),p=n.n(u),f=(n("c6244f7705"),n("081c8cafea"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("a0a3d3f7da")),v=n("ddcf54e539"),m=n("e83761cccd");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(){function e(){o()(this,e),d()(this,"services",void 0),d()(this,"aiSidebarController",void 0),d()(this,"aiControllerLoader",void 0),d()(this,"aiLifeCyclesFunction",void 0),this.aiControllerLoader=this.initAISideBarController()}var t,n,a,r,c;return l()(e,[{key:"setChannelOptions",value:(c=i()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.aiControllerLoader;case 2:this.aiSidebarController.setChannelOptions(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"showSideBar",value:(r=i()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.aiControllerLoader;case 2:this.aiSidebarController.show(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"hideSideBar",value:(a=i()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.aiControllerLoader;case 2:this.aiSidebarController.hide();case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"showRecommendCard",value:(n=i()(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.aiControllerLoader;case 2:null===(t=(n=this.aiSidebarController).pushRecommendCommandsCard)||void 0===t||t.call(n);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setLifecycleFunction",value:function(e){this.aiLifeCyclesFunction=e}},{key:"setServiceDelegates",value:function(e){this.services=b(b({},this.services),e)}},{key:"registerDocsApi",value:function(e){e.registerSlideApp(f.a.getInstance()),e.registerSlideFeature(v.a.getInstance()),e.registerFileKit(m.a.getInstance())}},{key:"initAISideBarController",value:(t=i()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createAIController();case 2:this.aiSidebarController=e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()},"8410cfccc9":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,'.search-images-search-images-container-YXTbR{display:flex;flex-direction:column}.search-images-search-images-container-disable-2eAwJ{pointer-events:none;opacity:.5}.search-images-images-galley-b74HC{display:flex;align-self:center;flex-wrap:wrap;justify-content:center;max-width:260px;margin-bottom:16px}.search-images-images-galley-b74HC .search-images-image-item-container-2VIfZ{position:relative;background-size:cover;background-position:50%;width:120px;height:68px;margin:4px;border-radius:4px;outline:1px solid rgba(0,0,0,.08);outline-offset:-1px}.search-images-images-galley-b74HC .search-images-image-item-container-2VIfZ .search-images-images-sub-galley-pBqZO{height:100%;display:flex;flex-wrap:wrap;justify-content:space-between;align-content:space-between}.search-images-images-galley-b74HC .search-images-image-item-container-2VIfZ .search-images-image-item-sub-container-3Gh9F{position:relative;background-size:cover;background-position:50%;width:58px;height:32px;border-radius:4px;outline:1px solid rgba(0,0,0,.08);outline-offset:-1px}.search-images-card-button-2O-q7{margin-right:8px;cursor:pointer}.search-images-image-loading-2u_QY:after{content:"";position:absolute;top:calc(50% - 16px);left:calc(50% - 16px);width:28px;height:28px;border:2px solid #cbcdd1;border-top-color:#979797;border-radius:32px;-webkit-animation-name:search-images-loading-rotate-GcyM9;animation-name:search-images-loading-rotate-GcyM9;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-duration:.8s;animation-duration:.8s;-webkit-animation-timing-function:linear;animation-timing-function:linear}.search-images-image-sub-loading-1bIlt:after{top:calc(50% - 8px);left:calc(50% - 8px);width:12px;height:12px;border:2px solid #cbcdd1;border-top-color:#979797}@-webkit-keyframes search-images-loading-rotate-GcyM9{0%{rotate:0}to{rotate:1turn}}@keyframes search-images-loading-rotate-GcyM9{0%{rotate:0}to{rotate:1turn}}',""]),t.locals={"search-images-container":"search-images-search-images-container-YXTbR","search-images-container-disable":"search-images-search-images-container-disable-2eAwJ","images-galley":"search-images-images-galley-b74HC","image-item-container":"search-images-image-item-container-2VIfZ","images-sub-galley":"search-images-images-sub-galley-pBqZO","image-item-sub-container":"search-images-image-item-sub-container-3Gh9F","card-button":"search-images-card-button-2O-q7","image-loading":"search-images-image-loading-2u_QY","loading-rotate":"search-images-loading-rotate-GcyM9","image-sub-loading":"search-images-image-sub-loading-1bIlt"}},"851dafb037":function(e,t,n){"use strict";n.r(t);var a=n("176815363d"),i=n.n(a),r=n("14502724a6"),o=n.n(r),c=n("3ef2352f0b"),l=n.n(c),s=(n("c6244f7705"),n("081c8cafea"),n("69084d01d3")),d=n.n(s),u=n("52d461bc51"),p=n.n(u),f=n("3c6a87698d"),v=n.n(f),m=n("11246a1392"),h=n.n(m),b=n("5fac0349d3"),g=n("85d0a7609b"),y=n.n(g),x=(n("6e20b6a7d8"),n("57b2cc50f9")),S=n.n(x),w=n("e792a3169a"),A=n.n(w),E=n("715e175f43"),T=n.n(E),k={insert:"head",singleton:!1},I=(A()(T.a,k),T.a.locals||{}),O=n("1748118723"),C=n.n(O);function P(e){var t=e.data,n=e.selectedId,a=e.onChange;return d.a.createElement(S.a,{className:I["bullets-menu"],onClick:function(e){a(e)}},t.map((function(e){var t;return d.a.createElement(S.a.Item,{className:C()((t={},y()(t,I["bullets-menu-item"],!0),y()(t,I.selected,n===e.id),t)),key:e.id,id:e.id},e.content)})))}var D=n("382929c8da"),M=n("a6c7240c95"),L=n("ef195b1c22"),R=n.n(L),_={insert:"head",singleton:!1},N=(A()(R.a,_),R.a.locals||{}),B=n("398c1db7a7"),j=n("c606e82f8d"),F=n("b438b29dcd"),U=n.n(F),z=n("017877e9ad");function G(e){var t=e.color,n=e.disabled,a=void 0!==n&&n,i=e.onChange,r=Object(s.useRef)(null);return d.a.createElement("div",{className:N["color-panel"]},d.a.createElement("div",{className:N["color-panel-label"]},b.a.t("颜色"),"："),d.a.createElement(U.a,{disabled:a,dropContent:function(){if(!a)return d.a.createElement(z.a,{colorPickerType:j.d.StandardPC,selectedTdColor:t||void 0,onColorChange:function(e,t){i(e,t)},actions:[{text:b.a.t("自动"),position:j.a.Top,onClick:function(){i(null,j.e.Theme)}}]})}(),containerFollowVisible:!0},d.a.createElement("div",{className:C()(y()({},N["color-panel-dropdown-container"],!0)),ref:r},d.a.createElement("div",{className:N["color-icon-container"]},d.a.createElement("img",{src:B.Lb,alt:""}),d.a.createElement("div",{className:N["color-bar"],style:{backgroundColor:(null==t?void 0:t.srgb_color)||"#000"}})),d.a.createElement("div",{className:N["color-panel-dropdown"]},d.a.createElement("img",{src:B.Jb,alt:""})))))}n("b4638a0243"),n("826dc923b3");var H=n("b4a31815a1"),q=n("4953944b6f"),V=n.n(q),W={insert:"head",singleton:!1},Y=(A()(V.a,W),V.a.locals||{}),K=n("db262c15c5");function J(e){var t=e.size,n=void 0===t?1:t,a=e.disabled,i=e.onChange,r=n?(100*n).toFixed(0):"";return d.a.createElement("div",{className:Y["bullets-size"]},d.a.createElement("div",{className:Y["bullets-size-label"]},b.a.t("大小"),"："),d.a.createElement("div",{className:Y["bullets-size-input-container"]},d.a.createElement(H.g,{min:K.b,max:K.a,value:r,maxLength:K.c,step:K.d,style:{width:"70px"},disabled:a,onChange:function(e){var t=Number(e)/100;i(t)}}),d.a.createElement("span",{className:Y["input-suffix-text"]},"% ".concat(b.a.t("字高")))))}n("963f2eaace");var X=n("f000f89fa1"),Q=n.n(X),Z=n("b74ee0edd6"),$=n.n(Z),ee=n("82f2dc9440"),te=n.n(ee),ne=n("8da38f8962"),ae=n("d8c1ddce97"),ie=n.n(ae),re={insert:"head",singleton:!1},oe=(A()(ie.a,re),ie.a.locals||{}),ce=n("9405ab31d2"),le=n("b413d1a284");function se(e){var t=e.text,n=void 0===t?"":t,a=e.onTextChange,r=e.onImageChange,c=e.uploadImageCallback,u=Object(s.useRef)(null),p=function(){var e=i()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.current){e.next=2;break}return e.abrupt("return");case 2:u.current.click();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=i()(l.a.mark((function e(t){var n,a,i,s,d,u,p,f,v;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.nativeEvent.target,(s=i.files)&&!(s.length<1)){e.next=3;break}return e.abrupt("return");case 3:if(d=le.b.checkImageBlob(s[0]),u=o()(d,2),p=u[0],f=u[1],p){e.next=7;break}return(ne.a.isMobile?$.a:te.a).show({message:f,type:"info"}),e.abrupt("return");case 7:return e.next=9,c(s);case 9:v=e.sent,r({id:null!==(n=null==v?void 0:v[0].id)&&void 0!==n?n:"",src:null!==(a=null==v?void 0:v[0].src)&&void 0!==a?a:""});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return d.a.createElement("div",{className:oe["customize-bullets"]},d.a.createElement("div",{className:oe["customize-bullets-label"]},b.a.t("自定义")),d.a.createElement("div",{className:oe["customize-bullets-input-container"]},d.a.createElement(Q.a,{inputClassName:oe["customize-bullets-input"],value:n,onChange:function(e,t){t.nativeEvent.isComposing?a(e):a(Object(ce.a)(e).slice(-1)[0])},onCompositionEnd:function(e){a(Object(ce.a)(e.nativeEvent.data).slice(-1)[0])}}),d.a.createElement(h.a,{className:oe["image-upload-btn"],size:"small",onClick:p},b.a.t("图片"),"..."),d.a.createElement("input",{ref:u,hidden:!0,type:"file",accept:"image/*",onChange:f})))}var de=n("e2abf7c15e"),ue=n.n(de),pe={insert:"head",singleton:!1},fe=(A()(ue.a,pe),ue.a.locals||{});function ve(e){var t=e.startNumber,n=void 0===t?1:t,a=e.disabled,i=void 0!==a&&a,r=e.onChange;return d.a.createElement("div",{className:fe["start-number"]},d.a.createElement("div",{className:fe["start-number-label"]},b.a.t("起始编号"),"："),d.a.createElement("div",{className:fe["start-number-input-container"]},d.a.createElement(H.g,{min:K.f,max:K.e,maxLength:K.h,value:"".concat(n),step:K.i,style:{width:"70px"},disabled:i,onChange:function(e){var t=Number(e);r(t)}})))}var me=n("71b6244252"),he=n.n(me),be={insert:"head",singleton:!1},ge=(A()(he.a,be),he.a.locals||{}),ye=n("c2f805291c"),xe=n("9da6335152");t.default=function(e){var t=e.visible,n=e.defaultTabId,a=e.defaultColor,r=e.defaultSize,c=e.defaultStartNumber,u=e.defaultType,f=e.defaultCustomText,m=e.defaultCustomImage,g=e.onClose,y=e.onOk,x=e.copyPasteImageService,S=Object(s.useState)(n||D.a.ITEMNUMBER),w=o()(S,2),A=w[0],E=w[1],T=Object(s.useState)(a),k=o()(T,2),I=k[0],O=k[1],C=Object(s.useState)(r),L=o()(C,2),R=L[0],_=L[1],N=Object(s.useState)(c),B=o()(N,2),j=B[0],F=B[1],U=Object(s.useState)(u),z=o()(U,2),H=z[0],q=z[1],V=Object(s.useState)(f),W=o()(V,2),Y=W[0],K=W[1],X=Object(s.useState)(m),Q=o()(X,2),Z=Q[0],$=Q[1],ee=Object(s.useRef)(),te=function(e){q(e)},ne=function(){var e=Y&&H===ye.b.CUSTOM_TEXT,t=Z&&H===ye.b.CUSTOM_IMAGE;return!(A===D.a.ITEMNUMBER&&(e||t))},ae=H===ye.b.ITEMSYMBOL_NONE,ie=document.querySelector("#workbench");return d.a.createElement(p.a,{title:b.a.t("项目符号和编号"),visible:t,action:d.a.createElement(h.a,{disabled:ne()},b.a.t("重置")),onClose:g,onCancel:g,onOk:function(e){e&&y({color:I,size:R,startNumber:j,type:H,customText:Y,customImage:ee.current})},onClickAction:function(){ne()||(q(ye.b.ITEMSYMBOL_SMALL_CIRCLE),H===ye.b.CUSTOM_TEXT&&K(void 0),H===ye.b.CUSTOM_IMAGE&&$(void 0))},className:"bullets-and-numbering-dialog",containerDom:ie},d.a.createElement(v.a,{tabBarStyle:{borderBottom:"1px solid #f1f1f1"},style:{width:"100%"},activeId:A,onChange:E},d.a.createElement(v.a.TabPane,{tab:b.a.t("项目符号"),id:D.a.ITEMNUMBER},d.a.createElement(P,{selectedId:H,onChange:te,data:Object(M.s)(null==I?void 0:I.srgb_color,Y,Z)})),d.a.createElement(v.a.TabPane,{tab:b.a.t("编号"),id:D.a.DIGITNUMBER},d.a.createElement(P,{selectedId:H,onChange:te,data:Object(M.o)(null==I?void 0:I.srgb_color,j)}))),d.a.createElement("div",{className:ge["dialog-modal-operation-area"]},d.a.createElement(G,{disabled:ae,color:I,onChange:function(t,n){var a;O(t),null===(a=e.colorPickerManager)||void 0===a||a.colorPickerTdwReport({color:(null==t?void 0:t.srgb_color)||void 0,colorPickerFrom:xe.k.COLOR_PICKER_TOOLBAR,colorGroupFrom:n,actionType:xe.j.COLOR_PICKER_BULLETS})}}),d.a.createElement(J,{disabled:ae,size:R,onChange:function(e){_(e)}}),A===D.a.DIGITNUMBER&&d.a.createElement(ve,{disabled:ae,startNumber:j,onChange:function(e){F(e)}}),A===D.a.ITEMNUMBER&&d.a.createElement(se,{text:Y,onTextChange:function(e){e?(q(ye.b.CUSTOM_TEXT),K(e),$(void 0)):(q(ye.b.ITEMSYMBOL_SMALL_CIRCLE),K(void 0))},onImageChange:function(e){q(ye.b.CUSTOM_IMAGE),$(e.src),ee.current=e.id,K(void 0)},uploadImageCallback:function(){var e=i()(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==x?void 0:x.promise();case 2:if(e.t1=n=e.sent,e.t0=null===e.t1,e.t0){e.next=6;break}e.t0=void 0===n;case 6:if(!e.t0){e.next=10;break}e.t2=void 0,e.next=11;break;case 10:e.t2=n.ImageEditManager.getInstance();case 11:return a=e.t2,e.next=14,null==a?void 0:a.uploadWithoutQuickLook(t,b.a.t("正在上传图片..."),{maxWidth:500,maxHeight:500,minWidth:10,minHeight:10,minSize:25e4});case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})))}},"86753a9dc2":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var a=n("176815363d"),i=n.n(a),r=n("3ef2352f0b"),o=n.n(r),c=(n("c6244f7705"),n("081c8cafea"),n("f4e4ed5c17")),l={},s=function(){var e=i()(o.a.mark((function e(t){var n,a,i,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l[t]){e.next=2;break}return e.abrupt("return",l[t]);case 2:return e.next=4,c.a.post("/v2/mall/template/content",{id:t,is_custom:!1,version:2});case 4:if(n=e.sent,0===(a=n.data).retcode){e.next=8;break}throw"get template failed retcode: ".concat(a.retcode);case 8:return e.prev=8,i=a.result.docData.msgAtext[0].bytesText,(r=JSON.parse(atob(i))).metaData=a.result.item_meta,l[t]=r,e.abrupt("return",r);case 16:throw e.prev=16,e.t0=e.catch(8),console.error("get template failed",e.t0),e.t0;case 20:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=i()(o.a.mark((function e(t){var n,a,i,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l[t]){e.next=2;break}return e.abrupt("return",l[t]);case 2:return e.next=4,c.a.post("/api/template/content",{id:t,is_custom:!1,version:2});case 4:if(n=e.sent,0===(a=n.data).retcode){e.next=8;break}throw"get template failed retcode: ".concat(a.retcode);case 8:return e.prev=8,i=a.result.content.doc_data.msg_atext[0].bytes_text,(r=JSON.parse(atob(i))).metaData=a.result.item_meta,l[t]=r,e.abrupt("return",r);case 16:throw e.prev=16,e.t0=e.catch(8),console.error("get template failed",e.t0),e.t0;case 20:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(t){return e.apply(this,arguments)}}()},"8a6c5a3b5b":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return c}));var a,i,r=n("85d0a7609b"),o=n.n(r);!function(e){e[e.PaymentByPrice=0]="PaymentByPrice",e[e.LimitedFree=1]="LimitedFree",e[e.FreeForVIP=2]="FreeForVIP",e[e.NeedVIPAndPay=3]="NeedVIPAndPay",e[e.Free=4]="Free",e[e.FreeForSuperVIP=5]="FreeForSuperVIP",e[e.ChargedByUsage=6]="ChargedByUsage",e[e.InAppPurchased=7]="InAppPurchased",e[e.NoRequirementType=10]="NoRequirementType"}(i||(i={}));var c,l,s,d,u,p,f,v=(a={},o()(a,i.FreeForVIP,"vip"),o()(a,i.FreeForSuperVIP,"super-vip"),o()(a,i.PaymentByPrice,"pay-by-price"),o()(a,i.Free,void 0),o()(a,i.LimitedFree,void 0),o()(a,i.NeedVIPAndPay,void 0),o()(a,i.ChargedByUsage,void 0),o()(a,i.InAppPurchased,void 0),o()(a,i.NoRequirementType,void 0),a);!function(e){e.BIG="0",e.SMALL="1"}(c||(c={})),function(e){e.M_2X="mobile_thumb_2x",e.PC_2X="pc_thumb_2x",e.PC_PREVIEW="pc_preview"}(l||(l={})),function(e){e[e.NoTemplateType=0]="NoTemplateType",e[e.DocxTemplate=1]="DocxTemplate",e[e.SheetTemplate=2]="SheetTemplate",e[e.PPTTemplate=3]="PPTTemplate",e[e.CollectionForm=4]="CollectionForm",e[e.MindTemplate=5]="MindTemplate",e[e.FlowChartTemplate=6]="FlowChartTemplate",e[e.AioTemplate=7]="AioTemplate",e[e.SmartSheet=8]="SmartSheet",e[e.SmartCanvas=9]="SmartCanvas",e[e.Resume=10]="Resume",e[e.SmartWhiteBoard=11]="SmartWhiteBoard"}(s||(s={})),function(e){e[e.NoType=0]="NoType",e[e.Template=1]="Template",e[e.Addon=2]="Addon"}(d||(d={})),function(e){e[e.SubTopic=0]="SubTopic",e[e.MarketingItemInTopic=1]="MarketingItemInTopic",e[e.ArticleInTopic=2]="ArticleInTopic",e[e.AuthorInTopic=3]="AuthorInTopic"}(u||(u={})),function(e){e[e.All=0]="All",e[e.Mall=1]="Mall",e[e.Custom=2]="Custom"}(p||(p={})),function(e){e[e.NoType=0]="NoType",e[e.QuestionnaireTemplate=1]="QuestionnaireTemplate",e[e.CheckInTemplate=2]="CheckInTemplate",e[e.ProblemSetTemplate=3]="ProblemSetTemplate",e[e.RosterTemplate=4]="RosterTemplate"}(f||(f={}))},"8de2e7a1cd":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-template-preview-container-2FVpm{width:338px;height:100%;position:relative;background:#f1f4f6;border-left:1px solid #f1f4f6}.index-template-preview-container-2FVpm .index-template-ok-container-2F74Q{box-sizing:content-box;position:absolute;bottom:0;z-index:9;height:52px;left:0;width:100%}.index-template-preview-container-2FVpm .index-template-select-ok-2wbS3{display:flex;justify-content:center;height:36px;width:100%;z-index:9;background:linear-gradient(transparent,#fff)}.index-template-preview-container-2FVpm .index-template-select-ok-append-2wgUg{height:16px;width:100%;background:#fff}.index-template-preview-title-container-uvQnH{width:100%;height:28px;font-size:12px;font-weight:400;margin-bottom:8px;color:rgba(0,0,0,.88);display:flex;justify-content:space-between}.index-template-preview-title-content-2aqPf{height:28px;line-height:28px}.index-template-preview-select-container-Umo28{width:338px;height:20px;position:relative}.index-template-select-all-wrapper-1wxTE{position:absolute;left:0;height:20px}.index-template-revert-wrapper-_irqC{position:absolute;right:0;height:20px}.index-template-preview-list-container-ShBwR{width:338px;height:100%;overflow-y:hidden}:hover.index-template-selected-scale-RAbVt{border:1px solid #000}.index-template-check-wrapper-3teG4{position:absolute;margin:5px;right:0;bottom:0;height:16px;width:16px}.index-template-preview-button-container-2F610{height:28px;width:100%;position:relative;margin-bottom:8px;display:flex;justify-content:space-between}.index-template-preview-select-all-3kfuP{height:28px}.index-template-preview-select-undo-pZA4H{height:28px;line-height:28px;padding-right:10px;font-size:12px;color:rgba(0,0,0,.88);position:relative;cursor:pointer}.index-template-preview-select-undo-disable-A1PVT{opacity:.4;cursor:not-allowed}.index-template-preview-select-undo-icon-35f5X{width:20px;height:20px;position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:-26px}.index-template-preview-right-button-wrapper-2Iq_u{height:28px}.index-template-preview-item-3ApG_{width:160px;height:90px;position:relative;border:1px solid grey;margin:5px;padding:5px;box-sizing:content-box}.index-preview-container-1Nqox{height:583px;width:100%}",""]),t.locals={"template-preview-container":"index-template-preview-container-2FVpm","template-ok-container":"index-template-ok-container-2F74Q","template-select-ok":"index-template-select-ok-2wbS3","template-select-ok-append":"index-template-select-ok-append-2wgUg","template-preview-title-container":"index-template-preview-title-container-uvQnH","template-preview-title-content":"index-template-preview-title-content-2aqPf","template-preview-select-container":"index-template-preview-select-container-Umo28","template-select-all-wrapper":"index-template-select-all-wrapper-1wxTE","template-revert-wrapper":"index-template-revert-wrapper-_irqC","template-preview-list-container":"index-template-preview-list-container-ShBwR","template-selected-scale":"index-template-selected-scale-RAbVt","template-check-wrapper":"index-template-check-wrapper-3teG4","template-preview-button-container":"index-template-preview-button-container-2F610","template-preview-select-all":"index-template-preview-select-all-3kfuP","template-preview-select-undo":"index-template-preview-select-undo-pZA4H","template-preview-select-undo-disable":"index-template-preview-select-undo-disable-A1PVT","template-preview-select-undo-icon":"index-template-preview-select-undo-icon-35f5X","template-preview-right-button-wrapper":"index-template-preview-right-button-wrapper-2Iq_u","template-preview-item":"index-template-preview-item-3ApG_","preview-container":"index-preview-container-1Nqox"}},"99f931ad4f":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={32024:!0,31241:!0,31655:!0,30252:!0,30400:!0,60096:!0,30672:!0,30247:!0,31658:!0,30567:!0,30568:!0,30576:!0,30573:!0,30570:!0,30574:!0,30397:!0,30401:!0,30402:!0,60092:!0,xwkjuknn3bbxdj3wnoekn5pq6r:!0,eeqpucgpajgc5xk4tr8jutbsuy:!0,x7myhyix7tfefmor84c5exdwpy:!0,"1tr5u58emtycxq199g7tjhf9xh":!0,c66y1zrzgpg67yormm9odisiue:!0,y3w37hfhwt8gznzmuq3jogi4ha:!0,cizyx9o5e3b1jeeio81omfag9w:!0,kpoxwtowd7f5ieqzxqyshot8jy:!0,u5egs6auyjyoi85qd3zesqifpr:!0,wyfqwpycnp8kxbhyi81a1xpese:!0,pd6r7ehnm7rmbdg8dq7zfkps8c:!0,qxcp6hze67nh8d5cd5spy5zszc:!0,co5y6cc6yfb5pf1hrri99qe4ha:!0,"6c77u1ypyigoubpeuc1cemi3xh":!0,ridu5wsojtdhpfrmq7tttqjhmc:!0,egwrjmkbdp89zri966u1ohmthw:!0,"9hu99pfumbfru8795o39pkknmr":!0}},"9eab16bf4b":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={name:"docs-component-file-info-panel",loadType:n("0d2ffd3bdb").LoadType.ON_DEMAND}},a0388d3b54:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("826dc923b3"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("963f2eaace"),n("c6244f7705"),n("b1e2246d82"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287");function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function r(e){for(var t=e.width,n=e.height,i=[],r=768;r<=1280;r+=64)i.push(r);for(var o=t/n,c=Number.POSITIVE_INFINITY,l=[],s=0,d=i;s<d.length;s++){var u,p=d[s],f=a(i);try{for(f.s();!(u=f.n()).done;){var v=u.value,m=p/v,h=Math.abs(o-m);h===c?l.push({width:p,height:v}):h<c&&(l=[{width:p,height:v}],c=h)}}catch(e){f.e(e)}finally{f.f()}}if(1===l.length)return l[0];for(var b=Number.POSITIVE_INFINITY,g=l[0],y=0,x=l;y<x.length;y++){var S=x[y],w=Math.abs(S.width-t)+Math.abs(S.height-n);w<b&&(b=w,g=S)}return g}},a1d9765e8a:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return f}));var a=n("85d0a7609b"),i=n.n(a),r=(n("759492dad9"),n("6e20b6a7d8"),n("405b4a5e2b"),n("3bf1976a4f"),n("8aebbf296a"),n("85d48ef22b"),n("eb9e932508"),n("2c4d03fe19"),n("8ee19818c4"),n("af753b49bd")),o=n("fbd47ef0af"),c=n("9dbd7f12a7"),l=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=null===(t=e.props.txBody)||void 0===t?void 0:t.p;return i&&0!==i.length?i.map((function(e){var t,i,r,o;if(!e.egTextRun||0===e.egTextRun.length)return"";var c=e.egTextRun.map((function(e){var t;return null===(t=e.r)||void 0===t?void 0:t.t})).join(""),l=!!(null!==(t=e.pPr)&&void 0!==t&&t.buAutoNum||null!==(i=e.pPr)&&void 0!==i&&i.buChar);if(!n&&!l)return c;var s=(null!==(r=null===(o=e.pPr)||void 0===o?void 0:o.lvl)&&void 0!==r?r:0)+a,d=Array(s).fill("  ").join("");return"".concat(d,"- ").concat(c)})).join("\n"):""},s=function(e){try{return JSON.parse(e)}catch(e){return null}};function d(e,t){var n=Math.max(e.length,t.length);return 1-function(e,t){for(var n=Array.from({length:e.length+1},(function(){return[]})),a=0;a<=e.length;a++)n[a][0]=a;for(var i=0;i<=t.length;i++)n[0][i]=i;for(var r=1;r<=e.length;r++)for(var o=1;o<=t.length;o++){var c=e[r-1]===t[o-1]?0:1;n[r][o]=Math.min(n[r-1][o]+1,n[r][o-1]+1,n[r-1][o-1]+c)}return n[e.length][t.length]}(e,t)/n}function u(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=[],i=0;i<t.length;i++){var r=t[i],o=d(e,r);o>n&&a.push({index:i,text:r,similarity:o})}return a.sort((function(e,t){return t.similarity-e.similarity})),a}function p(e,t){var n,a=(n={},i()(n,r.d.cover,"#"),i()(n,r.d.session,"##"),i()(n,r.d.page,"###"),n);return e?"".concat(a[t]," ").concat(e):""}function f(e){var t,n=Object(o.b)(e.getWritableOwnedData());if(null==n||!n.isTemplate)return null;var a=null===(t=e.shapeTree)||void 0===t?void 0:t.getWritableOwnedData().shapeList;if(!a)return null;var i=Object(c.c)(a).idMap,r="",s="";if(i.title){var d=e.getShapeById(i.title);if(d){var u;if(i.image){var f,v,m=e.getShapeById(i.image);if(m)u=null===(f=m.props.blipFill)||void 0===f||null===(v=f.blip)||void 0===v?void 0:v.embed}r=l(d).trim(),s+=p(r,n.type),u&&(s+=" ![image](".concat(u,")")),s+="\n"}}if(i.content){var h=e.getShapeById(i.content);h&&(s+="".concat(l(h),"\n"))}return i.list&&i.list.forEach((function(t){if(t.title){var n=e.getShapeById(t.title);if(n){var a;if(t.image){var i,r,o=e.getShapeById(t.image);if(o)a=null===(i=o.props.blipFill)||void 0===i||null===(r=i.blip)||void 0===r?void 0:r.embed}s+="".concat(l(n,!0,0)),a&&(s+=" ![image](".concat(a,")")),s+="\n"}}if(t.content){var c=e.getShapeById(t.content);c&&(s+="".concat(l(c,!0,1),"\n"))}})),{slideId:e.id,type:n.type,title:r,markdown:s}}},a268811c9c:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return G}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("547611bd96"),d=n.n(s),u=n("bd29e2df90"),p=n.n(u),f=n("ab5eb40518"),v=n.n(f),m=n("1b4cdd6a36"),h=n.n(m),b=n("85d0a7609b"),g=n.n(b),y=n("3ef2352f0b"),x=n.n(y),S=(n("3bf1976a4f"),n("c6244f7705"),n("081c8cafea"),n("b1e2246d82"),n("659f690fe6")),w=n("77c89fc0e0");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var E="file-info",T=function(e){p()(n,e);var t=A(n);function n(e){var a;return o()(this,n),a=t.call(this),g()(d()(a),"fileInfoPlugin",void 0),a.fileInfoPlugin=e,a}return l()(n,[{key:"name",get:function(){return E}},{key:"show",value:function(){var e=this;this.fileInfoPlugin.showModule(this.DOMNode,(function(){e.showWrapper()}),(function(){e.hideWrapper()}))}},{key:"wrapperDidHide",value:function(){this.fileInfoPlugin.removeModule()}}]),n}(w.g),k=n("19f0bdbef9"),I=n("9eab16bf4b"),O=n("e792a3169a"),C=n.n(O),P=n("fde6e42547"),D=n.n(P),M={insert:"head",singleton:!1},L=(C()(D.a,M),D.a.locals,n("1d6e84dd0c")),R=n("560bea0cc4"),_=n("ec3bbd441e"),N=n("020899bf26");function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var j="doc-size",F=function(e){p()(n,e);var t=B(n);function n(e){var a;return o()(this,n),a=t.call(this),g()(d()(a),"fileInfoPlugin",void 0),a.fileInfoPlugin=e,a}return l()(n,[{key:"name",get:function(){return j}},{key:"show",value:function(){var e=this;this.fileInfoPlugin.showDocSizeModule(this.DOMNode,(function(){e.showWrapper()}),(function(){e.hideWrapper()}))}},{key:"wrapperDidHide",value:function(){this.fileInfoPlugin.removeModule()}}]),n}(w.g);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var G=function(e){p()(c,e);var t,n,a,r=z(c);function c(){var e;o()(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=r.call.apply(r,[this].concat(n)),g()(d()(e),"extension",void 0),g()(d()(e),"handleAuthShow",i()(x.a.mark((function t(){var n,a,i,r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(i=window.document.activeElement)||null===(n=i.blur)||void 0===n||n.call(i),t.next=4,null===(a=e.noEditService)||void 0===a?void 0:a.getPlugin(R.b);case 4:null==(r=t.sent)||r.show({authUpdateCallback:function(){}});case 6:case"end":return t.stop()}}),t)})))),g()(d()(e),"handleRevisionRecordShow",(function(t){var n;null===(n=e.editExtensionService)||void 0===n||n.showHistoryRightBar({activeId:t})})),g()(d()(e),"handleReadRecordShow",i()(x.a.mark((function t(){var n,a;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=e.noEditService)||void 0===n?void 0:n.getPlugin(L.a.name);case 2:null==(a=t.sent)||a.show();case 4:case"end":return t.stop()}}),t)})))),e}return l()(c,[{key:"initPlugin",value:function(){var e,t,n,a,i=this;null===(e=this.editExtensionService)||void 0===e||e.registerRightSideBarModule(new T(this)),null===(t=this.editExtensionService)||void 0===t||t.registerRightSideBarModule(new F(this)),null===(n=this.editExtensionService)||void 0===n||null===(a=n.watchEditTypeChange)||void 0===a||a.call(n,(function(e){e===w.d.MASTER_LAYOUT&&i.hide()}))}},{key:"showModule",value:function(e,t,n){var a=this,i=w.i.isPad?{onClose:n,onClickLocation:function(){},onClickPermission:this.handleAuthShow,onClickRecently:function(){},onClickHistory:function(){},onClickLastModify:function(){},onClickDocSize:function(){return a.showDocSizePanel()}}:{onClose:n,onClickPermission:this.handleAuthShow,onClickRecently:this.handleReadRecordShow,onClickHistory:function(){return a.handleRevisionRecordShow("version")},onClickLastModify:function(){return a.handleRevisionRecordShow("history")},onClickDocSize:function(){return a.showDocSizePanel()}};this.loadModule(t).then((function(){var t;null===(t=a.extension)||void 0===t||t.show(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({container:e},i))}))}},{key:"showDocSizeModule",value:function(e,t,n){e&&this.loadDocSizeModule(e,t,n)}},{key:"showDocSizePanel",value:(a=i()(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.DocInfoManager.promise();case 2:e.sent.isOwner&&(null===(t=this.editExtensionService)||void 0===t||t.showRightSideBar(j));case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"hideDocSizePanel",value:function(){var e;null===(e=this.editExtensionService)||void 0===e||e.hideRightSideBar()}},{key:"removeModule",value:function(){var e;null===(e=this.extension)||void 0===e||e.hide(),this.extension=void 0}},{key:"show",value:function(){var e;this.isShown()||(null===(e=this.editExtensionService)||void 0===e||e.showRightSideBar(E))}},{key:"hide",value:function(){var e;null===(e=this.editExtensionService)||void 0===e||e.hideRightSideBar()}},{key:"loadDocSizeModule",value:(n=i()(x.a.mark((function e(t,n,a){var i,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.extensionService.getExtension(_.a.name);case 2:return i=e.sent,e.next=5,N.a.DocInfoManager.promise();case 5:r=e.sent,i.show({container:t,onClose:function(){i.hide(),a()},globalPadId:r.globalPadId,mobileMode:w.i.isMobile&&!w.i.isPad}),n();case 8:case"end":return e.stop()}}),e)}))),function(e,t,a){return n.apply(this,arguments)})},{key:"loadModule",value:(t=i()(x.a.mark((function e(t){var n=this;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){k.a.extensionService.getExtension(I.a.name).then((function(a){e(a),n.extension=a,null==t||t()})).catch((function(e){window.log.warn("文件信息面板加载失败"),a(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"isShown",value:function(){var e,t;return!(null===(e=this.editExtensionService)||void 0===e||!e.isShowRightSideBar(E))||!(null===(t=this.editExtensionService)||void 0===t||!t.isShowRightSideBar(j))}}]),c}(S.a)},ac748fffd4:function(e,t,n){"use strict";n.r(t),n.d(t,"SPEAKER_TRIGGER_ID",(function(){return I})),n.d(t,"ACCESSIBILITY_SWITCHER",(function(){return O})),n.d(t,"AccessibilityEventsKeys",(function(){return k})),n.d(t,"AccessibilityRich",(function(){return C}));n("73b854064b");var a=n("9132715560"),i=n.n(a),r=n("6a364eb35c"),o=n.n(r),c=n("547611bd96"),l=n.n(c),s=n("bd29e2df90"),d=n.n(s),u=n("ab5eb40518"),p=n.n(u),f=n("1b4cdd6a36"),v=n.n(f),m=n("85d0a7609b"),h=n.n(m),b=(n("3bf1976a4f"),n("e6d98148ee")),g=n("cd255d4473"),y=n("82f2dc9440"),x=n.n(y),S=n("d3d31c86eb"),w=n("9da6335152"),A=n("5fac0349d3"),E=n("5a075649c6");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return p()(this,n)}}var k,I="speaker-trigger",O="pc-handler-status-accessibility-";!function(e){e.ACTION_ENABLE="isEnable"}(k||(k={}));var C=function(e){d()(n,e);var t=T(n);function n(){var e;i()(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),h()(l()(e),"isEnableState",!1),h()(l()(e),"readStrTimer",void 0),h()(l()(e),"disableTimer",void 0),h()(l()(e),"accessibilityKey",O),h()(l()(e),"hasFullStop",!1),e}return o()(n,[{key:"initWithUid",value:function(e){this.accessibilityKey+=e;var t=localStorage.getItem(this.accessibilityKey);this.isEnableState="1"===t,this.isEnableState&&this.loadTriggerAndExtraDom()}},{key:"enable",value:function(){var e;null===(e=window.log)||void 0===e||e.info(A.a.t("无障碍开启")),x.a.show({type:"success",message:A.a.t("幻灯片已开启屏幕阅读器支持。"),duration:3e3}),localStorage.setItem(this.accessibilityKey,"1"),this.isEnableState=!0,this.disableTimer&&clearTimeout(this.disableTimer),this.loadTriggerAndExtraDom(),this.emit(k.ACTION_ENABLE,!0),Object(S.c)({opername:w.e.DOC_ALL,module:w.d.DOC_ACCESSIBILITY,action:w.b.OPEN,file_type:w.c.SLIDE})}},{key:"disable",value:function(){var e,t=this;null===(e=window.log)||void 0===e||e.info(A.a.t("无障碍关闭")),x.a.show({type:"success",message:A.a.t("幻灯片已关闭屏幕阅读器支持。"),duration:3e3}),localStorage.setItem(this.accessibilityKey,"0"),this.isEnableState=!1,this.disableTimer=setTimeout((function(){t.removeDom(),clearTimeout(t.disableTimer)}),50),this.emit(k.ACTION_ENABLE,!1),Object(S.c)({opername:w.e.DOC_ALL,module:w.d.DOC_ACCESSIBILITY,action:w.b.CLOSE,file_type:w.c.SLIDE})}},{key:"isEnable",value:function(){return this.isEnableState}},{key:"readStr",value:function(e,t){var n=this,a=document.getElementById(I),i=!1;t&&!a&&(this.loadTriggerAndExtraDom(),a=document.getElementById(I),i=!0),a&&(this.readStrTimer&&clearTimeout(this.readStrTimer),this.readStrTimer=setTimeout((function(){a&&(a.textContent="".concat(n.getContentStr(e))),clearTimeout(n.readStrTimer),i&&n.removeDom()}),50))}},{key:"getContentStr",value:function(e){var t=e;return e&&(this.hasFullStop&&(t="".concat(e,"。")),this.hasFullStop=!this.hasFullStop),t}},{key:"loadTriggerAndExtraDom",value:function(){if(!document.getElementById(I)){var e=document.createElement("div");e.setAttribute("id",I),e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),e.setAttribute("aria-hidden","false"),e.style.cssText="position: absolute; left: -999px; top: -1px; height: 0; width: 0;",document.body.appendChild(e),this.accessEventFocus()}}},{key:"accessEventFocus",value:function(){var e=Object(E.a)();e.setAttribute("class",g.a),document.body.append(e),e.focus(),setTimeout((function(){e.remove()}),5e3)}},{key:"removeDom",value:function(){var e=document.getElementById(I);null==e||e.remove()}}]),n}(b.a),P=new C;t.default=P},ba4ddefc1e:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var a=n("402eb050f3"),i=a.b.supportEnterprise(a.a.ALL)?"8856ef52bd434c2d938fbf0c16d82a96":"42da4f2d95c146abb5896087ca5f03dd",r="0b69e1b9517e44a4aee35d33ee021b55",o=["e0b026441751437d8b0c45ff29b508c3","20c67635951045dda4e0fcd3ac7e24d3","c0f0506f24df4e4a8e99717c2bf18b50","9c468c59da0e4e21a4063970ab9036d4","0b69e1b9517e44a4aee35d33ee021b55","9e2c26161b684629a9bf29e52efa6c60"]},cd255d4473:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));t.b={START_PLAY:"startPLay",END_PLAY:"endPlay",PLAY_INDEX_CHANGE:"playIndexChange",MOVE_SELECTED_ELEMENTS_WITH_ARROW:"moveSelectedElementsWithArrow"};var a={PASTE:"paste"},i="extra-div-for-accessibility"},ce413fb4c3:function(e,t,n){"use strict";n.r(t),n.d(t,"TemplateModal",(function(){return F})),n.d(t,"showTemplateModal",(function(){return U}));var a=n("14502724a6"),i=n.n(a),r=(n("6e20b6a7d8"),n("c6244f7705"),n("081c8cafea"),n("5fac0349d3")),o=n("16e55f093a"),c=n("9049777d9b"),l=n("4f3b15d017"),s=n("8980a7557e"),d=n.n(s),u=n("8855b651d7"),p=(n("a816ff618c"),n("3f38f7f582")),f=n("69084d01d3"),v=n.n(f),m=n("2e0796c118"),h=n.n(m),b=n("ad43dc121d"),g=n("7305da29a3"),y=n("ae687ef235"),x=n("493f32bcb9"),S=n("525e822d25"),w=n("ca0e523306"),A=n("0decf6f8e6"),E=n("d03514ba3b"),T=n("3eda56d2ce"),k=n("2bce6ec7cd"),I=n("7a88e406ad"),O=n("fa4c65e7be"),C=n("8dfb2bc6c7"),P=n("f159b61048"),D=n("36d8a5b6b1"),M=n("48509680ac"),L=[{id:"om151maqs78oxpwx5zgaczwkew",cover:"https://docimg7.docs.qq.com/image/AgAABTW7Ya4PMUWLPSNNYr8hnC2QWSjg.png?w=1125&h=5190"},{id:"gbeea8df9iyu3rdtsqjfzeqeca",cover:"https://docimg9.docs.qq.com/image/AgAABTW7Ya7H7UvlwT1Awa9PWT6oXYRF.png?w=1125&h=5190"},{id:"y8ynejiubtgsbkj3uok9ey57fh",cover:"https://docimg8.docs.qq.com/image/AgAABTW7Ya5Bn1lKRTBEha8EqpA1HP0H.png?w=1125&h=5190"},{id:"8gufzibzgbn93pgt8b4g87hubw",cover:"https://docimg6.docs.qq.com/image/AgAABTW7Ya4VFCoUMjZLXJvWF5TMm880.png?w=1125&h=5190"},{id:"5ggds6ajziry7nqqmzmy7fw49h",cover:"https://docimg9.docs.qq.com/image/AgAABTW7Ya63Y2KbDRdFuKNfo2fYJy30.png?w=1125&h=5190"},{id:"d7o87j8757fw3n4od6ce9wd4hr",cover:"https://docimg4.docs.qq.com/image/AgAABTW7Ya76JsGPtSdJ16D4zc09cwwo.png?w=1125&h=5190"},{id:"m5rwe9b9hfyddqte8egknxfipy",cover:"https://docimg9.docs.qq.com/image/AgAABTW7Ya7f9Av5akJNS6YFEnXkqFri.png?w=1125&h=5190"},{id:"tdy5yi8ob3bgt869c6y7fpnyze",cover:"https://docimg8.docs.qq.com/image/AgAABTW7Ya5_NtZm19tLArtS6fis6W0I.png?w=1125&h=5190"},{id:"wrpsoijgw7yizmfzshx4r438yr",cover:"https://docimg5.docs.qq.com/image/AgAABTW7Ya7SMMXu8stIPoTsILURWfH2.png?w=1125&h=5190"},{id:"g6epr8up17bqiqh7gqzrrdikmh",cover:"https://docimg4.docs.qq.com/image/AgAABTW7Ya7w16qpWidOeKROvW1m98Zx.png?w=1125&h=5190"},{id:"oknykfwz9pd75jjitujspfy4uc",cover:"https://docimg4.docs.qq.com/image/AgAABTW7Ya7-l3J8jI1AHanSpBYIt4Zj.png?w=1125&h=5190"},{id:"hepotg7fwfb8tjrmf53rrhestw",cover:"https://docimg6.docs.qq.com/image/AgAABTW7Ya4jP8oe7_ZLh7-m_6tG9QKd.png?w=1125&h=5190"},{id:"s81xj1ypgtnczr43j4bzskdxqy",cover:"https://docimg10.docs.qq.com/image/AgAABTW7Ya5DcjQLYdNL853sLEq1BKpg.png?w=1125&h=5190"},{id:"h5bznagh87n49mbaszhhzths3h",cover:"https://docimg3.docs.qq.com/image/AgAABTW7Ya5YM9nmvMdFdbjlK43Seheg.png?w=1125&h=5190"},{id:"ueu641gwk7nrbk7ozg9wyfuk7h",cover:"https://docimg8.docs.qq.com/image/AgAABTW7Ya6uAwbo9exMGKWrgeSvFGAQ.png?w=1125&h=5190"},{id:"3wr1pbmdtjrh3jjfzwr75chiya",cover:A.a()},{id:"gmkecq1xcbgpbesf4w4jrcmz4r",cover:E.a()},{id:"kdjzibeon3repy5ay4ip9akz5h",cover:T.a()},{id:"yjp75jdsfbb9frnx6858ro4pgo",cover:k.a()},{id:"hw9irrrbyjd9jxkh8k6gtgupye",cover:I.a()},{id:"ujpcqsuz1ifzxno4qckwkhkbir",cover:O.a()},{id:"fdsgqp5mt7y9fj3qduwh7x7bjy",cover:C.a()},{id:"4wo77tdatif1zkf5up7jagxk9w",cover:P.a()},{id:"nagpdhr1t7f5bfz8ouwztpjxgw",cover:D.a()},{id:"o5uw7qdih7bi3drcb1jn4cqo9h",cover:M.a()},{id:"g4cp6mxhy78uudam11m8zmqt9y",cover:b.a()},{id:"1conbzikijrczy9ypxfn8ygnta",cover:g.a()},{id:"rmag5z4xstrt3qh7pqi4i7zhzr",cover:y.a()},{id:"wcihqg1n4jgz7pwewmrddotw8w",cover:x.a()},{id:"rip96cw6o7yyfqkqihdqp7wzia",cover:S.a()},{id:"ofidqcx4cjbazcx6nnrq4sfx3o",cover:w.a()}],R=n("e792a3169a"),_=n.n(R),N=n("024a0dc4be"),B=n.n(N),j={injectType:"singletonStyleTag",attributes:{id:"ppt-editor-global-id"},insert:"head",singleton:!0},F=(_()(B.a,j),B.a.locals,function(e){var t=e.visible,n=void 0!==t&&t,a=e.handleVisibleChange,r=void 0===a?function(){}:a,s=e.onConfirmTemplateModal,m=void 0===s?function(){}:s,h=e.title,b=void 0===h?"":h,g=e.rightBtnText,y=void 0===g?"":g,x=e.className,S=void 0===x?"":x,w=e.defaultValue,A=L,E=Object(f.useState)(!0),T=i()(E,2),k=T[0],I=T[1],O=function(){var e=Object(f.useState)(!1),t=i()(e,2),n=t[0],a=t[1];return Object(f.useEffect)((function(){Object(c.e)().then((function(e){window.log.info("ai user vip status:",e),a(e)}))}),[]),[n,function(){var e=Object(p.getAidForReport)({position:"toolbar",feature:"template-ai",apprec1:"slide"});Object(o.b)(e,void 0,{onSuccess:function(){a(!0)}})}]}(),C=i()(O,2),P=C[0],D=C[1],M=Object(f.useState)(null!=w?w:A[0]),R=i()(M,2),_=R[0],N=R[1],B=function(e,t){I(!1),m(e,t)};return l.default.isMobile?v.a.createElement(d.a,{className:"template-force-modal ".concat(S," template-force-modal--mobile"),title:b,visible:n,onClose:function(){return r(!1)},footer:v.a.createElement("div",{className:"template-force-modal-footer"},v.a.createElement("div",{className:"template-force-modal-footer-continue",onClick:function(){return B({id:_.id,isCustom:!1},!1)}},y)),zIndex:1e4,maskStyle:{background:"#000000A3"},closable:!1,maskClosable:!1},v.a.createElement("div",{className:"template-force-content"},v.a.createElement("div",{className:"template-force-content-right"},A.map((function(e,t){return v.a.createElement("div",{key:t,className:"template-force-content-right-block ".concat(e.id===_.id?"template-force-content-right-block-selected":""),style:{backgroundImage:'url("'.concat(e.cover,'")')},onClick:function(){N(e)}})}))))):v.a.createElement(u.a,{closable:!1,isVip:P,showVIPPay:D,visible:k,handleVisibleChange:r,onConfirm:B})}),U=function(){var e=document.querySelector("#ai-modal-container");return new Promise((function(t){h.a.render(v.a.createElement(F,{visible:!0,handleVisibleChange:function(n){n||(t(void 0),h.a.unmountComponentAtNode(e))},onConfirmTemplateModal:function(n,a){t({templateId:n.id,enableImageGeneration:a}),h.a.unmountComponentAtNode(e)},title:r.a.t("选择主题模板"),leftBtnText:r.a.t("随机获取"),rightBtnText:r.a.t("继续生成")}),e)}))}},d0336c61c6:function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var a=n("c92b994f13")(n("245ecca45e"));t.push([e.i,".tips-card-card-disable-31NKy{pointer-events:none;opacity:.5}.tips-card-card-title-2x9ZE{margin-bottom:8px;font-size:16px;font-weight:600;line-height:22px}.tips-card-card-button-2ee4A{margin:4px 8px 4px 0}.tips-card-card-button-2ee4A .tips-card-tick-icon-2V-qK{width:24px;height:24px;background-image:url("+a+")}",""]),t.locals={"card-disable":"tips-card-card-disable-31NKy","card-title":"tips-card-card-title-2x9ZE","card-button":"tips-card-card-button-2ee4A","tick-icon":"tips-card-tick-icon-2V-qK"}},d8c1ddce97:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-customize-bullets-PN24r{margin-right:20px;font-size:12px}.style-customize-bullets-label-3g3My{font-size:12px;margin-bottom:5px}.style-customize-bullets-input-container-1Y7I9{display:flex;align-items:center}.style-customize-bullets-input-container-1Y7I9 .style-customize-bullets-input--X_M-{width:50px;height:28px;padding:5px 2px}.style-customize-bullets-input-container-1Y7I9 .style-image-upload-btn-doktm{margin-left:6px}",""]),t.locals={"customize-bullets":"style-customize-bullets-PN24r","customize-bullets-label":"style-customize-bullets-label-3g3My","customize-bullets-input-container":"style-customize-bullets-input-container-1Y7I9","customize-bullets-input":"style-customize-bullets-input--X_M-","image-upload-btn":"style-image-upload-btn-doktm"}},db262c15c5:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"g",(function(){return a}));var a,i=25,r=400,o=1,c=3,l=1,s=32767,d=1,u=5;!function(e){e.toolBarBullet="toolBarBullet",e.toolBarNumber="toolBarNumber",e.sideBarBullet="sideBarBullet",e.sideBarNumber="sideBarNumber"}(a||(a={}))},e2abf7c15e:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-start-number-1YVd_{margin-right:20px}.style-start-number-label-1HzMv{font-size:12px;margin-bottom:5px}.style-start-number-input-container-23ElL{display:flex;align-items:center}",""]),t.locals={"start-number":"style-start-number-1YVd_","start-number-label":"style-start-number-label-1HzMv","start-number-input-container":"style-start-number-input-container-23ElL"}},e7c4e8f59c:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={name:"docs-component-read-record",loadType:n("0d2ffd3bdb").LoadType.ON_DEMAND}},e96e32e1e5:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));n("73b854064b");var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("8eec1e4a03"),d=n.n(s),u=n("bd29e2df90"),p=n.n(u),f=n("ab5eb40518"),v=n.n(f),m=n("1b4cdd6a36"),h=n.n(m),b=n("3ef2352f0b"),g=n.n(b),y=(n("c6244f7705"),n("081c8cafea"),n("8296b34ae7")),x=n("9af8f0fa82"),S=n("b2c7b45320"),w=n("6dfa2ef4e4");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return v()(this,n)}}var E=function(e){p()(r,e);var t,n,a=A(r);function r(){return o()(this,r),a.call(this)}return l()(r,[{key:"showSideBar",value:(n=i()(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d()(h()(r.prototype),"showSideBar",this).call(this),w.a();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"createAIController",value:(t=i()(g.a.mark((function e(){var t,n=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.a)();case 2:return t=e.sent,this.registerDocsApi(t.api),e.abrupt("return",t.initialize({context:{clientVars:{}},source:x.d.SOURCE_SLIDE,lifecycles:{onShow:function(){var e,t;null===(e=n.aiLifeCyclesFunction)||void 0===e||null===(t=e.onShow)||void 0===t||t.call(e)},onHide:function(){var e,t;null===(e=n.aiLifeCyclesFunction)||void 0===e||null===(t=e.onHide)||void 0===t||t.call(e)}}}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(y.a)},ec3bbd441e:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={name:"docs-component-doc-size",loadType:n("0d2ffd3bdb").LoadType.EAGER}},ef195b1c22:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-color-panel-30Rag{margin-right:20px}.style-color-panel-label-3OgnC{font-size:12px;margin-bottom:5px}.style-color-panel-dropdown-container-3exbF{display:flex;align-items:center}.style-color-panel-dropdown-container-3exbF.style-disabled-1deyn{opacity:.4}.style-color-panel-dropdown-container-3exbF .style-color-icon-container-3So1F{display:flex;flex-direction:column;align-items:center}.style-color-panel-dropdown-container-3exbF .style-color-icon-container-3So1F img{width:20px;height:20px}.style-color-panel-dropdown-container-3exbF .style-color-icon-container-3So1F .style-color-bar-2mf7o{width:14px;height:3px;margin-top:-3px}.style-color-panel-dropdown-container-3exbF .style-color-panel-dropdown-2q8tG{margin-left:5px}.style-color-panel-dropdown-container-3exbF .style-color-panel-dropdown-2q8tG img{width:10px}",""]),t.locals={"color-panel":"style-color-panel-30Rag","color-panel-label":"style-color-panel-label-3OgnC","color-panel-dropdown-container":"style-color-panel-dropdown-container-3exbF",disabled:"style-disabled-1deyn","color-icon-container":"style-color-icon-container-3So1F","color-bar":"style-color-bar-2mf7o","color-panel-dropdown":"style-color-panel-dropdown-2q8tG"}},f88570ad83:function(e,t,n){"use strict";n.r(t),n.d(t,"AnimCategoryManager",(function(){return b}));var a,i=n("7a5536c9bf"),r=n.n(i),o=n("9132715560"),c=n.n(o),l=n("6a364eb35c"),s=n.n(l),d=n("85d0a7609b"),u=n.n(d),p=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("0acdc5834b"),n("c9a7ecac4d"),n("8ee19818c4"),n("b8217400dc"),n("e6f68cdf2e"),n("6e20b6a7d8"),n("4caeff9a46")),f=n("9559b6ab8e"),v=n("a7888a8b87"),m=n.n(v);!function(e){e.IMAGE="Image",e.TABLE="Table",e.GROUP="Group",e.CONNECTOR="Connector",e.CHART="Chart",e.SHAPE="Shape",e.SHAPE_WITH_TEXT="shape_with_text",e.SHAPE_NO_TEXT="shape_no_text",e.SHAPE_WITH_ADDON="shape_with_addon",e.IMAGE_NO_MEDIA="image_no_media",e.IMAGE_WITH_MEDIA="image_with_media"}(a||(a={}));var h=n("e0e8dd9366"),b=function(){function e(){c()(this,e),u()(this,"disableAnimTypeMap",void 0),u()(this,"selectionService",void 0),u()(this,"selectedAnimManager",void 0);var t=[f.b.FontColor,f.b.BrushColor,f.b.GrowWithColor];this.disableAnimTypeMap=new Map([[a.GROUP,p.o],[a.TABLE,p.o],[a.CHART,p.o],[a.CONNECTOR,t],[a.IMAGE_NO_MEDIA,t],[a.IMAGE_WITH_MEDIA,p.o],[a.SHAPE_NO_TEXT,t],[a.SHAPE_WITH_TEXT,[]],[a.SHAPE_WITH_ADDON,p.o]])}return s()(e,[{key:"setServiceDelegates",value:function(e){this.selectionService=e.selectionService,this.selectedAnimManager=e.selectedAnimManager}},{key:"getAnimCategoryList",value:function(e){var t=this.getElementModelList();return this.getAnimCategoryListByElement(t,e)}},{key:"getAnimCategoryListByElement",value:function(e,t){var n=this,a=null==e?void 0:e.reduce((function(e,t){var a,i=n.getDisabledAnimTypeList(t)||[];return(a=e).push.apply(a,r()(i)),e}),[]);return a=r()(new Set(a)),this.organizeList(a,t)}},{key:"getDisabledAnimTypeList",value:function(e){var t,n=this.getElementType(e);return null!==(t=this.disableAnimTypeMap.get(n))&&void 0!==t?t:[]}},{key:"getElementType",value:function(e){var t,n,i=this,r=e.type;return(null==e||null===(t=e.parent)||void 0===t?void 0:t.type)===h.d.GROUP?a.GROUP:r!==a.SHAPE&&r!==a.IMAGE?r:(n={},u()(n,a.SHAPE,(function(){return i.getShapeType(e)})),u()(n,a.IMAGE,(function(){return i.getImageType(e)})),n)[r]()}},{key:"getShapeType",value:function(e){var t,n,i,r;return null!==(t=e.props)&&void 0!==t&&t.addon?a.SHAPE_WITH_ADDON:null!==(n=e.paragraphList)&&void 0!==n&&null!==(i=n[0])&&void 0!==i&&null!==(r=i.textRuns)&&void 0!==r&&r.length?a.SHAPE_WITH_TEXT:a.SHAPE_NO_TEXT}},{key:"getImageType",value:function(e){return e.video||e.audio?a.IMAGE_WITH_MEDIA:a.IMAGE_NO_MEDIA}},{key:"organizeList",value:function(e,t){var n=m()(t);return n.forEach((function(t){t.children.forEach((function(t){e.includes(t.id)&&(t.disabled=!0)}))})),n}},{key:"getElementModelList",value:function(){var e,t=r()(this.getSelectedElements()),n=null===(e=this.getSelectedAnimList())||void 0===e?void 0:e.map((function(e){return e.elementModel}));return null==n||n.forEach((function(e){t.includes(e)||t.push(e)})),t}},{key:"getSelectedAnimList",value:function(){var e,t;return null!==(e=null===(t=this.selectedAnimManager)||void 0===t?void 0:t.selectedArray)&&void 0!==e?e:[]}},{key:"getSelectedElements",value:function(){var e,t;return null!==(e=null===(t=this.selectionService)||void 0===t?void 0:t.selectedElements.selectedArray)&&void 0!==e?e:[]}}]),e}()},fd4b11cd52:function(e,t,n){"use strict";n.r(t),n.d(t,"BulletsAndNumberingDialogManager",(function(){return O}));n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var a=n("176815363d"),i=n.n(a),r=n("9132715560"),o=n.n(r),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),p=n.n(u),f=(n("8ee19818c4"),n("342844cefa"),n("c6244f7705"),n("081c8cafea"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("b8217400dc"),n("e6f68cdf2e"),n("fce3077cdf"),n("69084d01d3")),v=n.n(f),m=n("2e0796c118"),h=n.n(m),b=n("5cf98436e9"),g=n("382929c8da"),y=n("c2f805291c"),x=n("daef0859e7"),S=n("9657b29818"),w=n("ea3a38d9d4"),A=n("d3d31c86eb"),E=n("9da6335152"),T=n("e0e8dd9366");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(){function e(){var t,a=this;o()(this,e),d()(this,"dialogContainer",document.createElement("div")),d()(this,"loadDialogPromise",void 0),d()(this,"originBulletProps",void 0),d()(this,"services",void 0),d()(this,"hideDialog",(function(){a.originBulletProps=null,h.a.unmountComponentAtNode(a.dialogContainer)})),d()(this,"changeBulletProps",(function(e){var t=a.getSelectedModels();if(null!=t&&t.length){var n,i={};if(Object.keys(e).forEach((function(t){var n;e[t]!==(null===(n=a.originBulletProps)||void 0===n?void 0:n[t])&&(i[t]=e[t])})),a.reportData(i),i.type=e.type,i.type===y.b.CUSTOM_IMAGE||i.type===y.b.CUSTOM_TEXT?delete i.type:(delete i.customText,delete i.customImage),i.type&&a.isNumbering(i.type))i.startNumber=i.startNumber||(null===(n=a.originBulletProps)||void 0===n?void 0:n.startNumber)||1;Object(S.b)((function(){t.forEach((function(e){Object(x.b)(e,{actionType:g.a.BULLET_SET,values:i,menuType:w.a.TOOLBAR})}))})),a.hideDialog()}})),d()(this,"getSelectedModels",(function(){var e=a.services.selectionService,t=null==e?void 0:e.selectedElements.selectedArray;if(t)return t;var n=null==e?void 0:e.selectedElements.getCurrentModel();return n.type===T.d.NOTE?[n]:null})),this.loadDialogPromise=new Promise((function(e){return t=e})),Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~lazyComponents")]).then(n.bind(null,"851dafb037")).then((function(e){t(e.default)}))}var t;return l()(e,[{key:"setServiceDelegates",value:function(e){this.services=I(I({},this.services),e)}},{key:"showDialog",value:function(e,t){this.getSelectedBulletsProps(),this.updateDialog(!0,e),Object(A.c)({opername:E.e.DOC_PPT,module:E.d.BULLETS_AND_NUMBERING_DIALOG,action:E.b.BULLETS_AND_NUMBERING_DIALOG_OPEN_SOURCE,ver5:t})}},{key:"updateDialog",value:(t=i()(p.a.mark((function e(t,n){var a,i,r,o,c,l,s,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDialogPromise;case 2:a=e.sent,i=this.originBulletProps||{},r=i.color,o=i.size,c=i.startNumber,l=i.type,s=i.customText,d=i.customImage,h.a.render(v.a.createElement(a,{visible:t,defaultTabId:n,defaultColor:r,defaultSize:o,defaultStartNumber:c,defaultType:l,defaultCustomText:s,defaultCustomImage:d,onClose:this.hideDialog,onOk:this.changeBulletProps,colorPickerManager:this.services.colorPickerManager,copyPasteImageService:this.services.copyPasteImageService}),this.dialogContainer);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"reportData",value:function(e){var t=e.type,n=e.color,a=e.size,i=e.customText,r=e.customImage,o=e.startNumber,c=(this.originBulletProps||{}).type,l=t||c;t&&Object(A.c)({opername:E.e.DOC_PPT,module:E.d.BULLETS_AND_NUMBERING_DIALOG,action:E.b.BULLETS_AND_NUMBERING_DIALOG_TYPE,ver5:t}),n&&Object(A.c)({opername:E.e.DOC_PPT,module:E.d.BULLETS_AND_NUMBERING_DIALOG,action:E.b.BULLETS_AND_NUMBERING_DIALOG_COLOR,ver5:n}),a&&Object(A.c)({opername:E.e.DOC_PPT,module:E.d.BULLETS_AND_NUMBERING_DIALOG,action:E.b.BULLETS_AND_NUMBERING_DIALOG_SIZE,ver5:a}),o&&this.isNumbering(l)&&Object(A.c)({opername:E.e.DOC_PPT,module:E.d.BULLETS_AND_NUMBERING_DIALOG,action:E.b.BULLETS_AND_NUMBERING_DIALOG_START_NUMBER,ver5:o}),(i&&l===y.b.CUSTOM_TEXT||r&&l===y.b.CUSTOM_IMAGE)&&Object(A.c)({opername:E.e.DOC_PPT,module:E.d.BULLETS_AND_NUMBERING_DIALOG,action:E.b.BULLETS_AND_NUMBERING_DIALOG_CUSTOM_CONTENT,ver5:t===y.b.CUSTOM_TEXT?i:"picture"})}},{key:"getSelectedBulletsProps",value:function(){var e=this.services.selectionService.getSelectedModel();if(e){var t=Object(b.a)(e),n=t[g.a.BULLET_COLOR],a=t[g.a.BULLET_SIZE],i=t[g.a.BULLET_START_NUMBER],r=t[g.a.ITEMNUMBER],o=t[g.a.DIGITNUMBER],c=t[g.a.BULLET_CUSTOM_TEXT],l=t[g.a.BULLET_CUSTOM_IMAGE];this.originBulletProps={color:n,size:a,startNumber:i,type:this.getBulletType(c,l,r,o),customText:c,customImage:l}}}},{key:"getBulletType",value:function(e,t,n,a){return e?y.b.CUSTOM_TEXT:t?y.b.CUSTOM_IMAGE:n||a}},{key:"isNumbering",value:function(e){return!!e&&Object.values(y.d).includes(e)}}]),e}()},fde6e42547:function(e,t,n){(e.exports=n("9dddfe0040")(!1)).push([e.i,".rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(5) .content,.rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(7) .content,.rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(8) .content,.rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(9) .content{cursor:none!important}.rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(5) .content .right-arrow-icon,.rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(7) .content .right-arrow-icon,.rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(8) .content .right-arrow-icon,.rs-bar-container-pad #rs-bar-file-info .fip-wrapper .fip-content .dui-loading-container .info-view-wrapper .list .fip-item:nth-of-type(9) .content .right-arrow-icon{display:none}#rs-bar-doc-size{overflow:auto;background-color:#fff}",""])},ff91d2d7a9:function(e,t,n){"use strict";n.r(t),n.d(t,"AccessibilityManager",(function(){return Y}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var a=n("9132715560"),i=n.n(a),r=n("6a364eb35c"),o=n.n(r),c=n("85d0a7609b"),l=n.n(c),s=(n("963f2eaace"),n("8ee19818c4"),n("3bf1976a4f"),n("ac748fffd4")),d=n("cd255d4473"),u=n("7ea90872c6"),p=n("5fac0349d3"),f=n("d5c3deb8c7"),v=n("52d461bc51"),m=n.n(v),h=n("69084d01d3"),b=n.n(h),g=n("0a8ecd6412"),y=n("3344f1a2e7"),x=n("e0e8dd9366"),S=(n("73b854064b"),n("547611bd96")),w=n.n(S),A=n("bd29e2df90"),E=n.n(A),T=n("ab5eb40518"),k=n.n(T),I=n("1b4cdd6a36"),O=n.n(I),C=function(){function e(t,n){i()(this,e),l()(this,"model",void 0),this.a11yManager=n,this.model=t}return o()(e,[{key:"getAccessibilityContent",value:function(){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:""}}]),e}(),P=(n("0acdc5834b"),n("54ca2f77cb"));function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=O()(e);if(t){var i=O()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return k()(this,n)}}var M=function(e){E()(n,e);var t=D(n);function n(e,a){var r;return i()(this,n),r=t.call(this,e,a),l()(w()(r),"shapeModel",void 0),r.shapeModel=e,r}return o()(n,[{key:"getAccessibilityContent",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a="";return this.shapeModel.paragraphList&&(null===(e=this.shapeModel.paragraphList)||void 0===e?void 0:e.length)>0&&this.shapeModel.paragraphList.forEach((function(e,n){a+=t.getAllTextFromTextRuns(e,n)})),n&&(this.shapeModel.isText?a+=p.a.t("文本框"):a+=p.a.t("形状")),a}},{key:"getAllTextFromTextRuns",value:function(e,t){var n=this,a="";return e.textRuns&&e.textRuns.length>0&&(a+=Object(P.a)(e,this.shapeModel.paragraphList,t),a="".concat(a," ").concat(e.textRuns.reduce((function(e,t){var a,i=t.text;return null!==(a=t.styles)&&void 0!==a&&a.href&&(i=n.getHrefText(t,n.shapeModel.props.addon)),"slidenum"===t.fieldType&&(i=p.a.t("幻灯片编号：")+i),e+i}),""),"。")),a}},{key:"getHrefText",value:function(e,t){var n,a=e.text?e.text:null===(n=e.styles)||void 0===n?void 0:n.href;if(t){var i,r=null===(i=this.a11yManager.services.addonManager)||void 0===i?void 0:i.getAddonFullScreenTitle(t.iframeId,t.extraData);a="".concat(p.a.t("第三方内容"),"：").concat(r)}else a="".concat(p.a.t("链接开头"),"，").concat(a,"，").concat(p.a.t("链接末尾"));return a}}]),n}(C),L=n("8eec1e4a03"),R=n.n(L);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=O()(e);if(t){var i=O()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return k()(this,n)}}var N=function(e){E()(n,e);var t=_(n);function n(e,a){var r;return i()(this,n),r=t.call(this,e,a),l()(w()(r),"pictureModel",void 0),r.pictureModel=e,r}return o()(n,[{key:"getAccessibilityContent",value:function(){return R()(O()(n.prototype),"getAccessibilityContent",this).call(this,!1,p.a.t("图片"))}}]),n}(C);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=O()(e);if(t){var i=O()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return k()(this,n)}}var j=function(e){E()(n,e);var t=B(n);function n(e,a){var r;return i()(this,n),r=t.call(this,e,a),l()(w()(r),"chartModel",void 0),r.chartModel=e,r}return o()(n,[{key:"getAccessibilityContent",value:function(){return R()(O()(n.prototype),"getAccessibilityContent",this).call(this,!1,p.a.t("图表"))}}]),n}(C);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=O()(e);if(t){var i=O()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return k()(this,n)}}var U=function(e){E()(n,e);var t=F(n);function n(e,a){var r;return i()(this,n),r=t.call(this,e,a),l()(w()(r),"connectorModel",void 0),r.connectorModel=e,r}return o()(n,[{key:"getAccessibilityContent",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?p.a.t("连接线"):""}}]),n}(C);function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=O()(e);if(t){var i=O()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return k()(this,n)}}var G=function(e){E()(n,e);var t=z(n);function n(e,a){var r;return i()(this,n),r=t.call(this,e,a),l()(w()(r),"groupModel",void 0),r.groupModel=e,r}return o()(n,[{key:"getAccessibilityContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=this.groupModel.children.length,r=p.a.t("组内有{0}个对象。",{0:i});return this.groupModel.children.forEach((function(i){var o=n.getCanBeGroupChildAccessibilityContent(i,t,a,e.a11yManager);r+=o})),r+=p.a.t("组内容已读完")}}],[{key:"getCanBeGroupChildAccessibilityContent",value:function(e){var t,a,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0;return new(null!==(a=(t={},l()(t,x.d.SHAPE,M),l()(t,x.d.GROUP,n),l()(t,x.d.IMAGE,N),l()(t,x.d.CHART,j),l()(t,x.d.CONNECTOR,U),t)[e.type])&&void 0!==a?a:C)(e,o).getAccessibilityContent(i,r)}}]),n}(C);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=O()(e);if(t){var i=O()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return k()(this,n)}}var q=function(e){E()(n,e);var t=H(n);function n(e,a){var r;return i()(this,n),r=t.call(this,e,a),l()(w()(r),"tableModel",void 0),r.tableModel=e,r}return o()(n,[{key:"getAccessibilityContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=this.tableModel.tableItems[0].length,i=this.tableModel.tableItems.length,r=p.a.t("表格：{0}行，{1}列。",{0:a,1:i});return this.tableModel.tableItems.forEach((function(a,i){a.forEach((function(a,o){var c=e.getShapeAccessibilityContent(a,t,n);r+=0===o?p.a.t("第{0}行，第1列，{1}",{0:i+1,1:c}):p.a.t("第{0}列，{1}",{0:o+1,1:c})}))})),r}},{key:"getShapeAccessibilityContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new M(e,this.a11yManager).getAccessibilityContent(t,n)}}]),n}(C);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=function(){function e(){var t,n,a=this;i()(this,e),l()(this,"isAccessibilityOn",!1),l()(this,"Accessibility",void 0),l()(this,"services",void 0),l()(this,"slideReactionDisposer",void 0),l()(this,"selectorReactionDisposer",void 0),l()(this,"hasRegister",void 0),l()(this,"startPlayOff",void 0),l()(this,"playOff",void 0),l()(this,"endPlayOff",void 0),l()(this,"isJustStartPlay",void 0),l()(this,"timer",void 0),l()(this,"openContent",""),l()(this,"arrowMoveTimer",void 0),l()(this,"moveSelectedEleWithArrow",void 0),l()(this,"keyCode",void 0),l()(this,"lastText",void 0),l()(this,"handleEnterEditing",(function(){var e=a.services.selectionService.getSelectedModel();if((null==e?void 0:e.type)===x.d.TABLE){var t,n,i,r,o=e,c=null!==(t=null===(n=o.selectedRange)||void 0===n?void 0:n.rowEnd)&&void 0!==t?t:0,l=null!==(i=null===(r=o.selectedRange)||void 0===r?void 0:r.colEnd)&&void 0!==i?i:0,d=a.getAccessibilityContent(o.tableItems[c][l],!1,"");s.default.readStr(p.a.t("第{0}行，第{1}列，{2}",{0:c+1,1:l+1,2:d}))}else s.default.readStr(p.a.t("已进入文本选择"))})),l()(this,"handleExitEditing",(function(){a.lastText="",a.keyCode=null,s.default.readStr(p.a.t("已退出文本选择"))})),l()(this,"readMoveEleWithArrow",(function(e,t){var n,a;0!==t&&(n=t,a=t>0?p.a.t("下"):p.a.t("上")),0!==e&&(n=e,a=e>0?p.a.t("右"):p.a.t("左")),a&&(n=Object(y.o)(Math.abs(n)),s.default.readStr(p.a.t("已向{0}微移{1}厘米。",{0:a,1:n})))})),l()(this,"readLeftKey",(function(e,t){var n=p.a.t("换行");return a.lastText&&a.lastText!==t||(n=t.slice(e,e+1)),n})),l()(this,"readRightKey",(function(e,t){var n=t.slice(e-1,e);return 0===e&&(n=p.a.t("换行")),n})),this.Accessibility=s.default,s.default.initWithUid(window.clientVars.tinyid),null===(t=document.getElementsByClassName("manager-wrapper")[0])||void 0===t||t.setAttribute("aria-hidden","true"),null===(n=document.getElementById(g.r.PPT_EDITOR))||void 0===n||n.setAttribute("aria-hidden","true"),this.isJustStartPlay=!0,s.default.on(s.AccessibilityEventsKeys.ACTION_ENABLE,(function(e){a.isAccessibilityOn=e}))}return o()(e,[{key:"setServiceDelegates",value:function(e){this.services=W(W({},this.services),e),s.default.isEnable()&&(this.isAccessibilityOn=!0,this.registerListener())}},{key:"showAccessibilityModal",value:function(e){var t=this,n=this.getModalContent(e);s.default.isEnable()?m.a.confirm({title:p.a.t("无障碍设置"),content:n,onOk:function(){t.disable()},okText:p.a.t("确定"),cancelText:p.a.t("取消")}):m.a.confirm({title:p.a.t("无障碍设置"),content:n,onOk:function(){t.enable()},okText:p.a.t("确定"),cancelText:p.a.t("取消")})}},{key:"enable",value:function(){s.default.isEnable()||(s.default.enable(),this.registerListener())}},{key:"disable",value:function(){s.default.isEnable()&&(s.default.disable(),this.removeListener())}},{key:"readOpenContent",value:function(){this.openContent=p.a.t("欢迎使用腾讯文档。用户可以通过 control 加 反引号 打开或者关闭无障碍。"),s.default.isEnable()?this.readSlide(this.services.selectionService.currentSlide,this.services.selectionService.currentSlideIndex,!1):s.default.readStr(this.openContent,!0),this.openContent=""}},{key:"handleKeydown",value:function(e){this.keyCode=e}},{key:"readKeyArrowContent",value:function(e,t){var n;if(this.keyCode&&t){var a=(n={},l()(n,u.b.left.keyCode,this.readLeftKey),l()(n,u.b.right.keyCode,this.readRightKey),l()(n,u.b.up.keyCode,(function(){return t})),l()(n,u.b.down.keyCode,(function(){return t})),n);if("function"==typeof a[this.keyCode]){var i=a[this.keyCode](e,t);s.default.readStr(p.a.t("{0}",{0:i})),this.lastText=t}}}},{key:"registerListener",value:function(){var e=this;this.hasRegister||(this.hasRegister=!0,this.slideReactionDisposer=Object(f.r)((function(){return e.services.selectionService.currentSlideIndex}),(function(t){e.readSlide(e.services.selectionService.currentSlide,t)})),window.addEventListener("enterEditing",this.handleEnterEditing),window.addEventListener("exitEditing",this.handleExitEditing),window.addEventListener(d.c.PASTE,this.handlePaste,!0),this.selectorReactionDisposer=Object(f.r)((function(){return e.services.selectionService.getSelectedModel()}),(function(t){e.handleSelectModel(t)})),this.startPlayOff=s.default.on(d.b.START_PLAY,(function(){e.isJustStartPlay=!0})),this.playOff=s.default.on(d.b.PLAY_INDEX_CHANGE,(function(t){e.handlePlayIndexChange(t)})),this.endPlayOff=s.default.on(d.b.END_PLAY,(function(){e.readSlide(e.services.selectionService.currentSlide,e.services.selectionService.currentSlideIndex)})),this.moveSelectedEleWithArrow=s.default.on(d.b.MOVE_SELECTED_ELEMENTS_WITH_ARROW,(function(t){var n=t.left,a=t.top;e.handleSelectedEleWithArrow(n,a)})))}},{key:"removeListener",value:function(){var e,t,n,a,i,r;this.hasRegister=!1,null===(e=this.slideReactionDisposer)||void 0===e||e.call(this),null===(t=this.selectorReactionDisposer)||void 0===t||t.call(this),window.removeEventListener("enterEditing",this.handleEnterEditing),window.removeEventListener("exitEditing",this.handleExitEditing),window.removeEventListener(d.c.PASTE,this.handlePaste),null===(n=this.startPlayOff)||void 0===n||n.call(this),null===(a=this.playOff)||void 0===a||a.call(this),null===(i=this.endPlayOff)||void 0===i||i.call(this),null===(r=this.moveSelectedEleWithArrow)||void 0===r||r.call(this)}},{key:"readSlide",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0;if(e){var i="",r=this.services.uiDataService.presentation.slideCount;e.children.forEach((function(e){i+=t.getAccessibilityContent(e)}));var o=this.collectNote(e.noteData),c="".concat(this.openContent).concat(p.a.t("第{0}张幻灯片，共{1}张。",{0:n+1,1:r})).concat(i).concat(o,"。").concat(p.a.t("页面上有{0}个对象，此页已结束。",{0:e.children.length}));n+1===r&&(c+=p.a.t("已到最后一页。")),a&&(c=p.a.t("页面已更改。{0}",{0:c})),s.default.readStr(c)}}},{key:"collectNote",value:function(e){var t="";return e.id&&(t+="".concat(p.a.t("还有演讲者备注：")).concat(this.getAccessibilityContent(e.noteTextBody,!1,""))),t}},{key:"handleSelectModel",value:function(e){var t=this;if(e&&(null==e?void 0:e.type)!==x.d.EMPTY){var n;if(e.type===x.d.MULTIPLY){var a=e.selectedModels,i=a.length;n=p.a.t("共选中{0}个对象。",{0:i}),a.forEach((function(e){n+="".concat(p.a.t("已选中，")).concat(t.getAccessibilityContent(e,!0),"。")}))}else{var r=this.getAccessibilityContent(e,!0);n=p.a.t("已选中，{0}。",{0:r})}s.default.readStr(n)}else s.default.readStr("")}},{key:"handlePlayIndexChange",value:function(e){var t=this;this.isJustStartPlay?(this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.isJustStartPlay=!1,t.timer=null}),50),this.readSlide(this.services.selectionService.slides[e],e)):this.readSlide(this.services.selectionService.slides[e],e,!0)}},{key:"getModalContent",value:function(e){var t,n=p.a.t("确定关闭屏幕阅读器支持能力吗？"),a=p.a.t("开启屏幕阅读器支持，读屏软件可读出文档内容和编辑操作，便于障碍人士使用。"),i=s.default.isEnable(),r=i?n:a;if(e){var o=p.a.t("确定关闭屏幕阅读器支持能力吗？确定请按Enter，取消请按Esc。"),c=p.a.t("开启屏幕阅读器支持，读屏软件可读出文档内容和编辑操作，便于障碍人士使用。确定请按Enter，取消请按Esc。");t=i?o:c}else t=r;return b.a.createElement("div",{"aria-label":"。".concat(t)},b.a.createElement("div",{"aria-hidden":!0},r))}},{key:"handlePaste",value:function(){s.default.readStr(p.a.t("粘贴"))}},{key:"handleSelectedEleWithArrow",value:function(e,t){var n=this;this.arrowMoveTimer&&clearTimeout(this.arrowMoveTimer),this.arrowMoveTimer=setTimeout((function(){n.readMoveEleWithArrow(e,t)}),500)}},{key:"getAccessibilityContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=l()({},x.d.TABLE,q);if(a[e.type])return new(0,a[e.type])(e,this.services.addonManager).getAccessibilityContent(t,n);var i=G.getCanBeGroupChildAccessibilityContent(e,t,n,this);return null!=i?i:new C(e,this).getAccessibilityContent(t,n)}}]),e}()}}]);
//# sourceMappingURL=slide-async~0c7d7381-942157.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([["async~907e9098"],{"02eaf84550":function(e,t,n){"use strict";n.r(t),n.d(t,"FormulaOcrManager",(function(){return f}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("3ef2352f0b"),u=n.n(l),d=(n("c6244f7705"),n("081c8cafea"),n("a84962d637"),n("f45588a8ad"),n("f4e4ed5c17")),f=function(){function e(){o()(this,e)}var t;return s()(e,[{key:"formulaOCR",value:(t=i()(u.a.mark((function e(t){var n,r,i,a,o,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={url:"https://docs.qq.com/api/pdfconvert/ocr/formula",headers:{"Content-Type":"application/json"},method:"post",data:{image_content:t}},e.next=3,Object(d.a)(n).catch((function(){return null}));case 3:if(200===(null==(r=e.sent)?void 0:r.status))try{s=JSON.parse(r.data.data),i=null==s||null===(a=s[0])||void 0===a||null===(o=a.text_annotations)||void 0===o||null===(c=o[0])||void 0===c?void 0:c.description}catch(e){window.log.error("parse formulaText failed",e)}return e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}()},"03f84d48d5":function(e,t,n){"use strict";n.r(t),n.d(t,"DrawerInputManager",(function(){return s}));var r=n("9132715560"),i=n.n(r),a=n("85d0a7609b"),o=n.n(a),c=(n("8ee19818c4"),n("342844cefa"),n("b4a31815a1")),s=function e(){var t=this;i()(this,e),o()(this,"isFocus",void 0),o()(this,"isInputting",void 0),o()(this,"isForceUpdate",void 0),o()(this,"toUpateModel",void 0),o()(this,"numberInputValue",{}),o()(this,"changeFrom",void 0),o()(this,"isOnlyChangeUI",void 0),o()(this,"currentModel",void 0),o()(this,"inputTempModel",void 0),o()(this,"inputtingFeatureKey",void 0),o()(this,"initPropsCallbacks",{}),o()(this,"tempMethod",void 0),o()(this,"updateCurrentModel",(function(e){t.currentModel=e,t.toUpateModel=e})),o()(this,"setInputFocus",(function(e,n){t.isFocus=e,t.isInputting=e,e?t.inputTempModel=null!=n?n:t.currentModel:t.clearInputValueCache()})),o()(this,"initBeforeChangeOnBlur",(function(e){return t.inputtingFeatureKey=e,!!t.isChangeOnBlur()&&(t.toUpateModel!==t.inputTempModel&&(t.toUpateModel=t.inputTempModel,t.executeInitPropsCallback(e)),!0)})),o()(this,"resetAfterChangeOnBlur",(function(e){return!!t.isChangeOnBlur()&&(t.changeFrom=void 0,t.inputTempModel=null,t.toUpateModel=t.currentModel,t.executeInitPropsCallback(e),t.inputtingFeatureKey=void 0,t.tempMethod=void 0,!0)})),o()(this,"clearInputValueCache",(function(){t.isInputting=!1,Object.keys(t.numberInputValue).forEach((function(e){delete t.numberInputValue[e]}))})),o()(this,"getCachedInputValue",(function(e,n){if(e===t.inputtingFeatureKey&&t.isInputting)return t.numberInputValue[n]})),o()(this,"executeInitPropsCallback",(function(e){e&&t.initPropsCallbacks[e]?t.initPropsCallbacks[e]():Object.keys(t.initPropsCallbacks).forEach((function(e){t.initPropsCallbacks[e]()}))})),o()(this,"addInitPropsCallback",(function(e,n){t.initPropsCallbacks[e]||(t.initPropsCallbacks[e]=n,n())})),o()(this,"updateInputStateReInput",(function(){t.isFocus&&(t.isInputting=!0)})),o()(this,"forceUpdateInput",(function(){if(t.tempMethod){t.isForceUpdate=!0;var e=t.tempMethod,n=e.className,r=e.method,i=e.args;r.apply(n,i),t.isForceUpdate=!1}})),o()(this,"updateTempMethod",(function(e){t.tempMethod=e})),o()(this,"isChangeOnBlur",(function(){return(t.changeFrom===c.h.INPUT||t.changeFrom===c.h.ADD_BTN||t.changeFrom===c.h.REDUCE_BTN)&&!t.isFocus}))}},"086c96a9ce":function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return y}));n("b8217400dc"),n("e6f68cdf2e"),n("8a35b54c1d");var r=n("e0e8dd9366"),i=n("55d5f8a022"),a=n("85d0a7609b"),o=n.n(a),c=n("382929c8da");var s=n("8f58e78419"),l=n.n(s);var u=n("f9193d718f");function d(e){var t=u.a.getInstance().getAppServices().viewableServiceLayer.selectionService.currentSlide;return t?function(e){var t;return o()({},c.a.FILLCOLOR,null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillInfo())}(t):{}}var f=n("7d1df7d0fb"),p=n("ee6bb53310"),v=n.n(p);function h(e){var t,n,r=null===(t=null===(n=u.a.getInstance().getAppServices().editableServiceLayer)||void 0===n?void 0:n.menuManager)||void 0===t?void 0:t.mergeMenuValuesCacheMap.get(e);if(r)return r;for(var a=[],o=[],s=0;s<e.selectedCellRanges.length;s++){var l=e.selectedCellRanges[s],d=e.tableItems[l.rowStart][l.colStart],p=i.a(d);a.push(p),o.push(d)}var h=Object(f.c)(a,Object(f.b)(o)),g=e.getBorder().getTableBorderInfo(),m=g.borderStyle,b=g.borderColor;return v()(h,c.a.BORDERSTYLE,m),v()(h,c.a.BORDERCOLOR,b),v()(h,c.a.MERGE_CELL,e.selectOneMergedCell()),h}var g=n("f216b3624d"),m=[r.d.SHAPE,r.d.CONNECTOR,r.d.IMAGE,r.d.EMPTY,r.d.TABLE];function b(e){if(!e)return{};var t=e.type;return[r.d.SHAPE].includes(t)?i.a(e):[r.d.CONNECTOR].includes(t)?function(e){var t;return o()({},c.a.BORDERCOLOR,null===(t=e.getBorder)||void 0===t?void 0:t.call(e).getBorderInfo())}(e):[r.d.IMAGE].includes(t)?function(e){var t,n,r,i;return i={},o()(i,c.a.FILLCOLOR,null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillInfo()),o()(i,c.a.EFFECT,null===(n=e.getEffect)||void 0===n?void 0:n.call(e).getEffectCollection()),o()(i,c.a.BORDERCOLOR,null===(r=e.getBorder)||void 0===r?void 0:r.call(e).getBorderInfo()),o()(i,c.a.SIZE_ADJUST,e.getLock().getLockInfo()),o()(i,c.a.INSERT_PICTURE,{alpha:e.props.style.alpha}),o()(i,c.a.REGULATE,{contrast:l()(e.props.style,"image.contrast"),brightness:l()(e.props.style,"image.brightness"),sharpenSoften:l()(e.props.style,"image.sharpenSoften")}),o()(i,c.a.PICTURE_COLOR,{saturate:l()(e.props.style,"image.saturate"),colorTemperature:l()(e.props.style,"image.colorTemperature")}),o()(i,"imageType",e.props.imageType||""),i}(e):[r.d.EMPTY].includes(t)?d():[r.d.TABLE].includes(t)?h(e):{}}function y(e){return Object(f.a)(e).filter((function(e){return e.type===r.d.IMAGE?e.isImage():Object(g.a)(e)}))}},"0a62bd7e3c":function(e,t,n){"use strict";n.r(t),n.d(t,"LiveDropdownService",(function(){return H}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("547611bd96"),u=n.n(l),d=n("bd29e2df90"),f=n.n(d),p=n("ab5eb40518"),v=n.n(p),h=n("1b4cdd6a36"),g=n.n(h),m=n("85d0a7609b"),b=n.n(m),y=n("3ef2352f0b"),E=n.n(y),S=(n("c6244f7705"),n("081c8cafea"),n("9e6e95de85")),w=n("82f2dc9440"),O=n.n(w),T=n("52d461bc51"),I=n.n(T),R=n("77c89fc0e0"),C=n("d3d31c86eb");n("3bf1976a4f");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var A=function(e){f()(n,e);var t=x(n);function n(){var e;o()(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),b()(u()(e),"action",void 0),e}return s()(n,[{key:"initModel",value:function(e,t){}}]),n}(n("375d29afab").a),k=n("646a4e8f32"),P=n("6884e1a126"),M=n("144183c5db"),D=n("014e696d7d"),_=n("8b13fcae36"),N=n("1f4b665603"),L=n("37091e4240"),F=n("d291ba4ae9"),j=n("020899bf26");function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var H=function(e){f()(n,e);var t=G(n);function n(){var e;return o()(this,n),e=t.call(this),b()(u()(e),"shouldShowLiveInviteDialog",void 0),b()(u()(e),"playActionFeature",void 0),b()(u()(e),"services",void 0),b()(u()(e),"setServiceDelegates",(function(t){e.services=U(U({},e.services),t)})),b()(u()(e),"componentDidMount",(function(){L.b.on(L.a.WORKBENCH_ATTACH_EDITOR_DONE,i()(E.a.mark((function t(){var n,r,a,o,c,s,l;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.services.liveManager.promise();case 2:o=t.sent,e.playActionFeature=P.e.get(k.b),o.event.on(N.ClientReady,i()(E.a.mark((function t(){var n,r,i;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.roomInfo(),r=n.roomid,t.prev=1,t.next=4,o.getRoomInfo(r);case 4:if(i=t.sent,JSON.parse(i.info).moduleName!==M.e.RemoteControl){t.next=8;break}return t.abrupt("return");case 8:t.next=12;break;case 10:t.prev=10,t.t0=t.catch(1);case 12:e.playActionFeature.event.emit(k.a.PLAY_ACTION_ACTIVE_CHANGE,!0),e.shouldShowLiveInviteDialog&&(e.shouldShowLiveInviteDialog=!1,e.showReadyToLiveShow());case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))),c=null===(n=j.a.ClientVarsService())||void 0===n||null===(r=n.getClientVars)||void 0===r?void 0:r.call(n),(null==c||null===(a=c.userInfo)||void 0===a?void 0:a.toid)?o.getShow((function(){})):(s=e.getDocInfoService(),l=null==s?void 0:s.addEventListener(F.a.USER_INFO_READY_EVENT,(function(){null==l||l(),o.getShow((function(){}))})));case 8:case"end":return t.stop()}}),t)}))))})),b()(u()(e),"handleCloseLiveInviteDialog",function(){var t=i()(E.a.mark((function t(n){var r,i;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(r=e.viewDelegate)||void 0===r||r.getElementById(D.a.DROP_INVITE).hide(),t.t0=n,t.next=t.t0===D.b.CLOSE?4:t.t0===D.b.PLAY?5:t.t0===D.b.END?8:15;break;case 4:return t.abrupt("break",15);case 5:return Object(C.c)({opername:"doc_ppt",module:"remote_initiate",action:"play_panel"}),e.handleBeginRemotePlay(),t.abrupt("break",15);case 8:return t.next=10,e.services.liveManager.promise();case 10:return i=t.sent,e.playActionFeature.event.emit(k.a.PLAY_ACTION_ACTIVE_CHANGE,!1),i.liveEnd(),i.closeShowRoom(),t.abrupt("break",15);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),b()(u()(e),"handleBeginRemotePlay",i()(E.a.mark((function t(){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.getSlideRenderStateManager().isAllSlideConvertComplete){t.next=7;break}return t.next=3,e.services.liveManager.promise();case 3:n=t.sent,setTimeout((function(){n.liveWillBegin()}),1),t.next=8;break;case 7:O.a.show({message:R.l.t("加载幻灯片中，请稍后再试"),duration:3e3});case 8:case"end":return t.stop()}}),t)})))),b()(u()(e),"handleOpenDocLive",i()(E.a.mark((function t(){var n,r;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.services.remoteControlManager.promise();case 2:return n=t.sent,t.next=5,n.closeAndStopLive();case 5:return window.log.info("mobileRemoteControlLog-dropdown: closeRoom by remotePlay"),t.next=8,e.services.liveManager.promise();case 8:(r=t.sent).createShow((function(t){e.handleCloseLiveGuideDialog(),t.error?I.a.confirm({content:R.l.t("信息未成功拉取，请刷新后重新发起远程演示。"),onOk:function(){Object(_.tencentDocOpenUrlReload)()},okText:R.l.t("立即刷新"),cancelText:null}):(r.masterEnter(),e.shouldShowLiveInviteDialog=!0)}));case 10:case"end":return t.stop()}}),t)})))),b()(u()(e),"handleCloseLiveGuideDialog",(function(){var t;null===(t=e.viewDelegate)||void 0===t||t.getElementById(D.a.DROP_DOM).hide()})),b()(u()(e),"showReadyToLiveShow",(function(){var t;window.pray().isPlaying||(null===(t=e.viewDelegate)||void 0===t||t.getElementById(D.a.DROP_INVITE).show(),Object(C.c)({opername:"doc_ppt",module:"remote_initiate",action:"su_edit"}))})),b()(u()(e),"getSlideRenderStateManager",(function(){return e.services.slideRenderStateManager})),b()(u()(e),"getDocInfoService",(function(){return e.services.extensionService.getDocInfo()})),e}return s()(n,[{key:"getLiveManager",value:function(){return this.services.liveManager}},{key:"createViewModel",value:function(){return new A}}]),n}(S.a)},"108cf2806f":function(e,t,n){"use strict";n.r(t),n.d(t,"CONST_RET_CODES",(function(){return P})),n.d(t,"CONST_RET_TEXT",(function(){return M})),n.d(t,"ExportManager",(function(){return D}));var r,i=n("176815363d"),a=n.n(i),o=n("9132715560"),c=n.n(o),s=n("6a364eb35c"),l=n.n(s),u=n("85d0a7609b"),d=n.n(u),f=n("3ef2352f0b"),p=n.n(f),v=(n("c6244f7705"),n("081c8cafea"),n("bd80bf2d0f"),n("3bf1976a4f"),n("8ee19818c4"),n("82f2dc9440")),h=n.n(v),g=n("52d461bc51"),m=n.n(g),b=n("d3d31c86eb"),y=n("5fac0349d3");!function(e){e[e.LOOP_TIME_OUT=0]="LOOP_TIME_OUT",e[e.QUERY_ERROR_CATCH=1]="QUERY_ERROR_CATCH",e[e.QUERY_ERROR_UNEXPECT=2]="QUERY_ERROR_UNEXPECT",e[e.EXPORT_ERROR_CATCH=3]="EXPORT_ERROR_CATCH",e[e.EXPORT_ERROR_UNEXPECT=4]="EXPORT_ERROR_UNEXPECT"}(r||(r={}));var E=n("9da6335152"),S=n("1388c273d5"),w=n("020899bf26"),O=n("aba9dcef64"),T=n("3a58133a15"),I=n("bd5de260ae"),R=n("d835d04d7a"),C=n("03c2478429"),x=n("2a81537ef9"),A="[ExportManager]",k=2e3,P={CONST_RET_CODE_SUCCESS:0,CONST_RET_CODE_HTTP_FAIL:-999,CONST_RET_CODE_ID_INVALID:-998,CONST_RET_CODE_FILE_URL_INVALID:-997,CONST_RET_CODE_NOT_HAS_DATA_EXPORT:-996,CONST_RET_CODE_NOT_HAS_DATA_PROGRESS:-995},M={CONST_RET_STATUS_DONE:"Done",CONST_TEXT_HTTP_FAIL:"HTTP FAIL"},D=function(){function e(){var t=this;c()(this,e),d()(this,"loadingBar",null),d()(this,"exporting",!1),d()(this,"interval",null),d()(this,"callbackRef",null),d()(this,"exportSlideFile",function(){var e=a()(p.a.mark((function e(n){var r,i,a,o,c,s=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=s.length>1&&void 0!==s[1]?s[1]:{exportWithAttachment:!1,exportWithFonts:!1,successCallback:function(){}},!t.exporting){e.next=3;break}return e.abrupt("return");case 3:c={finish:(new Date).getTime(),revision:null===(r=O.a.CollaborationManager())||void 0===r?void 0:r.getRevision().getRevisionNumber(),size:""},o.report=c,t.loadingBar=h.a.show({autoClose:!1,type:"loading",message:y.a.t("正在下载，请稍候..."),closable:!0,onClose:function(){Object(b.c)({opername:E.e.DOC_WORD_EDITOR,module:E.d.EXPORT,action:E.b.TOAST_CANCEL})}}),t.exporting=!0,null===(i=window.log)||void 0===i||null===(a=i.info)||void 0===a||a.call(i,"exportSlideFileByDC =",n),t.exportSlideByDC(n,o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"exportSnapshotFile",function(){var e=a()(p.a.mark((function e(n){var r,i,a,o,c,s,l,u,d,f,v,g;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.exporting){e.next=2;break}return e.abrupt("return");case 2:if(null===(r=w.a.ClientVarsService())||void 0===r||!r.isLocalDoc()){e.next=7;break}return e.next=5,Object(T.b)(n);case 5:return s=e.sent,e.abrupt("return",null===(c=C.a.LocalEditService())||void 0===c?void 0:c.saveDocument(JSON.stringify(s),x.s.SaveAs,!0));case 7:return l={finish:(new Date).getTime(),revision:null===(i=O.a.CollaborationManager())||void 0===i?void 0:i.getRevision().getRevisionNumber(),size:""},t.loadingBar=h.a.show({autoClose:!1,type:"loading",message:y.a.t("正在下载，请稍候...")}),t.exporting=!0,e.next=12,w.a.DocInfoManager.promise();case 12:return u=e.sent,d={},e.prev=14,e.next=17,Object(T.a)(n);case 17:d=e.sent.data,Object(I.a)(R.b.EXPORT_DOC_BY_SNAPSHOT,R.a.SUCCESS,"",[u.globalPadId||""]),e.next=27;break;case 21:return e.prev=21,e.t0=e.catch(14),t.closeExporting(),h.a.show({autoClose:!0,type:"warning",message:y.a.t("快照数据错误, 导出失败, 请联系客服处理")}),Object(I.a)(R.b.EXPORT_DOC_BY_SNAPSHOT,R.a.ERROR,e.t0.toString(),[u.globalPadId||""]),e.abrupt("return");case 27:if(f=P.CONST_RET_CODE_SUCCESS,null!==(a=d)&&void 0!==a&&a.operationId&&(null===(o=d)||void 0===o?void 0:o.ret)===f){e.next=31;break}try{Object(I.a)(R.b.EXPORT_DOC_BY_SNAPSHOT,R.a.ERROR,JSON.stringify(d),[u.globalPadId||""])}catch(e){null===(v=window.log)||void 0===v||null===(g=v.error)||void 0===g||g.call(v,"exportSnapshotFile error:",e)}return e.abrupt("return");case 31:return e.abrupt("return",t.handleQueryExportProgress(d.operationId,l));case 32:case"end":return e.stop()}}),e,null,[[14,21]])})));return function(t){return e.apply(this,arguments)}}()),d()(this,"showModalToClearUnSendData",(function(){var e,t;null!==(e=O.a.CollaborationManager())&&void 0!==e&&e.getPersistent().getMutationsPacks().length&&m.a.confirm({title:y.a.t("导出成功"),content:y.a.t("已为你保存数据至副本，是否清除未提交数据?"),okText:y.a.t("清除并刷新"),maskStyle:{zIndex:1e4},containerDom:document.body,onOk:(t=a()(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=O.a.CollaborationManager())||void 0===t?void 0:t.getPersistent().deleteAllData();case 2:location.reload();case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})})})),d()(this,"getSlideFileUrl",(function(e,n){var r;if(!t.exporting){var i={finish:(new Date).getTime(),revision:null===(r=O.a.CollaborationManager())||void 0===r?void 0:r.getRevision().getRevisionNumber(),size:""};t.exporting=!0,t.handleAsyncExportSlide(e,!1,i),t.callbackRef=n}})),d()(this,"invokeCallback",(function(e,n){t.callbackRef&&(t.callbackRef(e,n),t.callbackRef=null)})),d()(this,"closeExporting",(function(){t.exporting=!1,t.interval&&(clearTimeout(t.interval),t.interval=null),t.loadingBar&&t.loadingBar.close()})),d()(this,"handleDownloadFile",(function(e){var t="exportIframe".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:""),n=document.getElementById(t);n&&n.remove();var r=document.createElement("iframe");return r.id="exportIframe",r.style.display="none",r.src=e,document.body.appendChild(r),r})),d()(this,"handleBusinessFail",(function(e,n,r){var i,a;null===(i=window.log)||void 0===i||null===(a=i.error)||void 0===a||a.call(i,"".concat(A," ").concat(e," http fail , ret:").concat(n)),t.invokeCallback(!1,void 0),t.closeExporting();var o=30038===n?y.a.t("插入的本地文件过大，请使用本地PPT文档与附件形式导出。"):y.a.t("导出失败，请稍后重试");h.a.show({autoClose:!0,message:o,duration:4e3}),Object(b.c)({opername:"quality_slide",module:"file",action:"export",ver5:n,ver6:JSON.stringify(r)})})),d()(this,"handleHttpException",(function(e,n,r){var i,a,o,c,s;null===(i=window.log)||void 0===i||null===(a=i.error)||void 0===a||a.call(i,"".concat(e," exception: , ").concat(n.message)),t.invokeCallback(!1,void 0),t.closeExporting(),h.a.show({autoClose:!0,message:y.a.t("导出失败，请稍后重试")});var l=r,u=(null==n||null===(o=n.request)||void 0===o?void 0:o.status)||P.CONST_RET_CODE_HTTP_FAIL,d={status:u,statusText:(null==n||null===(c=n.request)||void 0===c?void 0:c.statusText)||M.CONST_TEXT_HTTP_FAIL,globalPadId:null===(s=w.a.DocInfoManager())||void 0===s?void 0:s.globalPadId};return l.error=d,Object(b.c)({opername:"quality_slide",module:"file",action:"export",ver5:u,ver6:JSON.stringify(l)}),l})),d()(this,"loopHandleQueryExportProgress",(function(e,n,r){var i=r*k,a=i<2e4?k:i<6e4?1e4:3e4;t.interval=setTimeout((function(){t.handleQueryExportProgress(e,n,r)}),a)})),d()(this,"handleQueryExportProgress",function(){var e=a()(p.a.mark((function e(n,r){var i,a,o,c,s=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:0,a=r,o=function(e,n){var r,i=e.file_url,o=e.attachments;i?(t.closeExporting(),a.finish=(new Date).getTime()-a.finish,delete a.error,Object(b.c)({opername:"quality_slide",module:"file",action:"export",ver5:n,ver6:JSON.stringify(a)}),null!==(r=O.a.CollaborationManager())&&void 0!==r&&r.getPersistent().getMutationsPacks().length?t.showModalToClearUnSendData():h.a.show({message:y.a.t("导出成功"),type:"success",duration:3e3}),t.callbackRef?t.invokeCallback(!0,i):(t.handleDownloadFile(i),t.handleAttachments(o))):(a.error=e,t.handleBusinessFail("queryExportProgress",P.CONST_RET_CODE_FILE_URL_INVALID,a))},e.next=5,O.a.OnlineApiService.promise();case 5:return c=e.sent,e.abrupt("return",c.queryExportProgress(n).then((function(e){var r=e.data;if(r){var c=r.ret;if(c===P.CONST_RET_CODE_SUCCESS)r.status===M.CONST_RET_STATUS_DONE?o(r,c):t.loopHandleQueryExportProgress(n,a,i+1);else a.error=r,t.handleBusinessFail("queryExportProgress",c,a)}else t.handleBusinessFail("queryExportProgress",P.CONST_RET_CODE_NOT_HAS_DATA_PROGRESS,a)})).catch((function(e){t.handleHttpException("queryExportProgress",e,a)})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),d()(this,"exportSlideByDC",function(){var e=a()(p.a.mark((function e(n){var i,a,o,c,s,l,u,d,f,v=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(i=v.length>1&&void 0!==v[1]?v[1]:{exportWithAttachment:!1,exportWithFonts:!1,report:null,successCallback:null}).exportWithAttachment,o=i.exportWithFonts,c=i.report,s=i.successCallback,l=c||{},u={docId:n},a&&(u.exportType=1),o&&(u.switches=JSON.stringify({embedFonts:!0})),d=function(e){var r,i;e.attachments&&t.handleAttachments(e.attachments),null==s||s(),t.closeExporting(),null===(r=window.log)||void 0===r||null===(i=r.info)||void 0===i||i.call(r,"".concat(A," exportAsyncByDc success , globalPadId:").concat(n))},f=function(e){var n,i;t.closeExporting(),null===(n=window.log)||void 0===n||null===(i=n.error)||void 0===i||i.call(n,"".concat(A," exportAsyncByDC fail , error:").concat(JSON.stringify(e)));var a=e.error===r.LOOP_TIME_OUT?y.a.t("插入的本地文件过大，请使用本地PPT文档与附件形式导出。"):y.a.t("导出失败，请稍后重试");h.a.show({autoClose:!0,message:a,duration:4e3}),l.error=e,Object(b.c)({opername:"quality_slide",module:"file",action:"export",ver5:e.error,ver6:JSON.stringify(l)})},e.next=10,Object(S.a)(u,d,f);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"handleAsyncExportSlide",function(){var e=a()(p.a.mark((function e(n){var r,i,a=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]&&a[1],i=a.length>2?a[2]:void 0,e.next=5,O.a.OnlineApiService.promise();case 5:e.sent.asyncExportSlide({globalPadId:n,exportWithAttachment:r}).then((function(e){var n=e.data;if(n){var r=n.ret;if(r===P.CONST_RET_CODE_SUCCESS){var a=n.operationId;a?t.handleQueryExportProgress(a,i):(i.error=n,t.handleBusinessFail("asyncExportSlide",P.CONST_RET_CODE_ID_INVALID,i))}else i.error=n,t.handleBusinessFail("asyncExportSlide",r,i)}else t.handleBusinessFail("asyncExportSlide",P.CONST_RET_CODE_NOT_HAS_DATA_EXPORT,i)})).catch((function(e){t.handleHttpException("asyncExportSlide",e,i)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}return l()(e,[{key:"handleAttachments",value:function(e){var t,n,r=this;Array.isArray(e)&&(null===(t=window.log)||void 0===t||null===(n=t.info)||void 0===n||n.call(t,"handleAttachments =",e),setTimeout((function(){e.forEach((function(e,t){null!=e&&e.url&&r.handleDownloadFile(null==e?void 0:e.url,t)}))}),500))}}]),e}()},"1097ede093":function(e,t,n){"use strict";function r(e,t,n){return function(r,i,a){var o=a.value;return a.value=function(){for(var r,i,a,c,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];null===(r=this.getDrawerInputManager())||void 0===r||r.updateTempMethod({className:this,method:o,args:l});var d,f,p,v,h=this.getInputParams();h&&(e=null!==(d=h.key)&&void 0!==d?d:e,t=null!==(f=h.beforeChangeFnName)&&void 0!==f?f:t,n=null!==(p=h.afterBlurFnName)&&void 0!==p?p:n);(t&&(null===(i=this[t])||void 0===i||i.call(this)),null===(a=this.getDrawerInputManager())||void 0===a||a.initBeforeChangeOnBlur(e),o.apply(this,l),null===(c=this.getDrawerInputManager())||void 0===c?void 0:c.resetAfterChangeOnBlur(e))&&(n&&(null===(v=this[n])||void 0===v||v.call(this)))},a}}n.d(t,"a",(function(){return r}))},"1476298fae":function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),s=n.n(c),l=n("79fc58c7b0"),u=n("3a2def422a"),d=n("f4e26884cf"),f=(n("73b854064b"),n("547611bd96")),p=n.n(f),v=n("bd29e2df90"),h=n.n(v),g=n("ab5eb40518"),m=n.n(g),b=n("1b4cdd6a36"),y=n.n(b),E=(n("3bf1976a4f"),function(){function e(){var t=this;i()(this,e),s()(this,"dragStartTime",void 0),s()(this,"startMousePosition",void 0),s()(this,"mouseDownProps",void 0),s()(this,"stopDrag",(function(e){e.preventDefault(),e.stopPropagation(),t.dragStartTime||t.mouseDownProps.dragEnd(e),t.startMousePosition=null})),s()(this,"handleMove",(function(e,n){var r=t.getEventCoordinates(e);t.checkDelayTimeAndCoords(n,r)?(t.dragStartTime=null,t.mouseDownProps.dragStart(e,t.startMousePosition)):t.dragStartTime||(e.stopPropagation(),t.mouseDownProps.onDrag(e))})),s()(this,"getEventCoordinates",(function(e){var t,n,r=e.nativeEvent||e;return{x:null!=r&&null!==(t=r.touches)&&void 0!==t&&t[0]?r.touches[0].clientX:r.clientX,y:null!=r&&null!==(n=r.touches)&&void 0!==n&&n[0]?r.touches[0].clientY:r.clientY}}))}return o()(e,[{key:"startDrag",value:function(e){this.dragStartTime=Date.now(),this.startMousePosition=this.getEventCoordinates(e.event),this.mouseDownProps=e}},{key:"checkDelayTimeAndCoords",value:function(e,t){return this.dragStartTime&&Date.now()-this.dragStartTime>e&&(t.x!==this.startMousePosition.x||t.y!==this.startMousePosition.y)}}]),e}());function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var w=function(e){h()(n,e);var t=S(n);function n(){var e;i()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),s()(p()(e),"handleMouseDownOnElement",(function(t){document.addEventListener("mousemove",e.handleMouseMove),document.addEventListener("mouseup",e.handleDragStop),e.startDrag(t)})),s()(p()(e),"handleDragStop",(function(t){document.removeEventListener("mousemove",e.handleMouseMove),document.removeEventListener("mouseup",e.handleDragStop),e.stopDrag(t)})),s()(p()(e),"handleMouseMove",(function(t){t.preventDefault();e.handleMove(t,100)})),e}return n}(E);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var T=function(e){h()(n,e);var t=O(n);function n(){var e;i()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),s()(p()(e),"isEditing",void 0),s()(p()(e),"handleTouchStartOnElement",(function(t){document.body.addEventListener("touchmove",e.handleTouchMove,{passive:!1}),document.body.addEventListener("touchend",e.handleDragStop),e.isEditing=t.isEditing,e.startDrag(t)})),s()(p()(e),"handleDragStop",(function(t){document.body.removeEventListener("touchmove",e.handleTouchMove),document.body.removeEventListener("touchend",e.handleDragStop),e.stopDrag(t)})),s()(p()(e),"handleTouchMove",(function(t){var n;if(!(e.isEditing||(t.preventDefault(),t.stopPropagation(),(null==t||null===(n=t.touches)||void 0===n?void 0:n.length)>1))){e.handleMove(t,-1)}})),e}return n}(E);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var R=function(){function e(t){var n=this;i()(this,e),s()(this,"startMousePosition",void 0),s()(this,"sizeAtStart",void 0),s()(this,"delegate",void 0),s()(this,"scale",void 0),s()(this,"relativeProps",void 0),s()(this,"isCtrlDown",void 0),s()(this,"pcDragLogic",void 0),s()(this,"mobileDragLogic",void 0),s()(this,"size",void 0),s()(this,"sizeOnSlide",void 0),s()(this,"handleMouseDownOnElement",(function(e){var t;e.isDraggable&&1===(null===(t=e.event)||void 0===t?void 0:t.nativeEvent.which)&&(n.scale=e.scale,n.relativeProps=e.relativeProps,n.size=e.size,n.sizeOnSlide=e.sizeOnSlide,n.pcDragLogic.handleMouseDownOnElement({event:e.event,dragStart:n.startDrag,onDrag:n.handleMove,dragEnd:n.stopDrag}))})),s()(this,"handleTouchStartOnElement",(function(e){e.isDraggable&&(n.scale=e.scale,n.relativeProps=e.relativeProps,n.size=e.size,n.sizeOnSlide=e.sizeOnSlide,n.mobileDragLogic.handleTouchStartOnElement({event:e.event,isEditing:e.isEditing,dragStart:n.startDrag,onDrag:n.handleMove,dragEnd:n.stopDrag}))})),s()(this,"startDrag",(function(e,t){var r;n.startMousePosition=t,n.isCtrlDown=Object(d.a)(e),n.sizeAtStart=n.isCtrlDown?n.sizeOnSlide:n.size,null===(r=n.delegate)||void 0===r||r.onDragStartOnElement(n.sizeAtStart,e)})),s()(this,"stopDrag",(function(e){var t;null===(t=n.delegate)||void 0===t||t.onDragStopOnElement(l.b.MOVE,e),n.startMousePosition&&(n.startMousePosition=null),n.sizeAtStart&&(n.sizeAtStart=null)})),s()(this,"handleMove",(function(e){var t,r=n.getEventCoordinates(e),i=n.targetSizeOnMove(r,e);null===(t=n.delegate)||void 0===t||t.onDragOnElement(e,n.sizeAtStart,i,l.b.MOVE)})),s()(this,"getEventCoordinates",(function(e){var t,n,r=e.nativeEvent||e;return{x:null!=r&&null!==(t=r.touches)&&void 0!==t&&t[0]?r.touches[0].clientX:r.clientX,y:null!=r&&null!==(n=r.touches)&&void 0!==n&&n[0]?r.touches[0].clientY:r.clientY}})),this.delegate=t,this.pcDragLogic=new w,this.mobileDragLogic=new T}return o()(e,[{key:"targetSizeOnMove",value:function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.sizeAtStart),r=(e.x-this.startMousePosition.x)/this.scale/1,i=(e.y-this.startMousePosition.y)/this.scale/1;if(t.shiftKey&&(Math.abs(r)>Math.abs(i)?i=0:r=0),!this.isCtrlDown){var a=u.a.getOffsetWithRelative(this.relativeProps,r,i);r=a.offsetX,i=a.offsetY}return n.left||(n.left=0),n.top||(n.top=0),n.left+=r,n.top+=i,n}}]),e}()},"16045d1632":function(e,t,n){"use strict";n.r(t),n.d(t,"CursorManager",(function(){return ne}));n("73b854064b"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var r,i=n("730477bb20"),a=n.n(i),o=n("1f925d7f50"),c=n.n(o),s=n("9132715560"),l=n.n(s),u=n("6a364eb35c"),d=n.n(u),f=n("547611bd96"),p=n.n(f),v=n("bd29e2df90"),h=n.n(v),g=n("ab5eb40518"),m=n.n(g),b=n("1b4cdd6a36"),y=n.n(b),E=n("85d0a7609b"),S=n.n(E),w=n("2dc700e1e6"),O=n.n(w),T=(n("f1054791f4"),n("963f2eaace"),n("b1e2246d82"),n("0acdc5834b"),n("6e20b6a7d8"),n("63513d8b56"),n("8ee19818c4"),n("342844cefa"),n("22569efd03"),n("69084d01d3")),I=n.n(T),R=n("c73625d763"),C=n.n(R),x=n("d5c3deb8c7"),A=n("7b0ebf3e1a"),k=n("b86964b011");!function(e){e.SHOW="show",e.HIDE="hide",e.REFRESH="refresh",e.CLEAR="clear"}(r||(r={}));var P=n("2e2ccf062e"),M=n("020899bf26"),D=n("2f1cded8d8"),_=n("aba9dcef64"),N=n("c9c92622ff"),L=n("7d52e7e74a"),F=n("b684da8955"),j=(n("8e7cce0ada"),n("c6244f7705"),n("2a6f332b5e"),n("eb9e932508"),n("1748118723")),B=n.n(j),U=n("e792a3169a"),G=n.n(U),H=n("7bbed40ec1"),z=n.n(H),W={insert:"head",singleton:!1},V=(G()(z.a,W),z.a.locals||{});function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var J,q,Q,Z=function(e){h()(n,e);var t=X(n);function n(e){var r;return l()(this,n),r=t.call(this,e),S()(p()(r),"timer",void 0),S()(p()(r),"handleAnimationEnd",(function(){var e,t;(r.autoHide?r.state.visible:r.props.visible)||(null===(e=(t=r.props).onHide)||void 0===e||e.call(t))})),r.state={visible:!0},r}return d()(n,[{key:"componentDidMount",value:function(){this.updateTimer(this.props.duration)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.duration!==this.props.duration&&this.updateTimer(e.duration)}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){var e,t=this.props,n=t.x,r=void 0===n?0:n,i=t.y,a=void 0===i?0:i,o=t.color,c=void 0===o?"white":o,s=t.text,l=void 0===s?"":s,u=!1;return u=this.autoHide?this.state.visible:this.props.visible,I.a.createElement("div",{className:B()((e={},S()(e,V["cursor-tag"],!0),S()(e,V["fade-in"],u),S()(e,V["fade-out"],!u),e)),style:{left:"".concat(r,"px"),top:"".concat(a,"px"),backgroundColor:c},onAnimationEnd:this.handleAnimationEnd},l)}},{key:"updateTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;0!==t?(this.setState({visible:!0}),this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.setState({visible:!1})}),t)):(this.timer&&clearTimeout(this.timer),this.timer=null)}},{key:"autoHide",get:function(){return 0!==this.props.duration}}]),n}(I.a.Component),$=function(e){h()(n,e);var t=X(n);function n(e){var r;return l()(this,n),r=t.call(this,e),S()(p()(r),"tags",void 0),S()(p()(r),"autoHideTimers",void 0),S()(p()(r),"handleRefreshCursorTags",(function(e){var t=Y({},r.tags);e.show.forEach((function(e){t[e.key]||(t[e.key]={x:e.position.x,y:e.position.y,uid:e.cursor.userId,name:e.cursor.name,color:e.cursor.color,visible:!0,duration:3e3})})),e.hide.forEach((function(e){delete t[e.key]})),r.tags=t,r.setState({tags:t})})),S()(p()(r),"handleClearCursorTags",(function(e){var t=e.keys;if(t&&t.length>0){var n=Y({},r.tags);t.forEach((function(e){delete n[e]})),r.tags=n,r.setState({tags:n})}else r.tags={},r.setState({tags:{}})})),S()(p()(r),"handleShowCursorTag",(function(e){var t=Y({},r.tags);t[e.key]={x:e.position.x,y:e.position.y,uid:e.cursor.userId,name:e.cursor.name,color:e.cursor.color,visible:!0,duration:0},r.tags=t,r.setState({tags:t})})),S()(p()(r),"handleHideCursorTag",(function(e){var t=Y({},r.tags),n=t[e.key];n&&(n.visible=!1,n.duration=1e3),r.tags=t,r.setState({tags:t})})),S()(p()(r),"deleteCursorTag",(function(e){var t=Y({},r.tags);delete t[e],r.tags=t,r.setState({tags:t})})),S()(p()(r),"handleCursorTagHide",(function(e){return function(){r.deleteCursorTag(e)}})),r.tags={},r.autoHideTimers={},r.state={tags:{}},r}return d()(n,[{key:"componentDidMount",value:function(){this.props.cursorManager.on(r.REFRESH,this.handleRefreshCursorTags),this.props.cursorManager.on(r.CLEAR,this.handleClearCursorTags),this.props.cursorManager.on(r.SHOW,this.handleShowCursorTag),this.props.cursorManager.on(r.HIDE,this.handleHideCursorTag)}},{key:"componentWillUnmount",value:function(){this.props.cursorManager.off(r.REFRESH,this.handleRefreshCursorTags),this.props.cursorManager.off(r.CLEAR,this.handleClearCursorTags),this.props.cursorManager.off(r.SHOW,this.handleShowCursorTag),this.props.cursorManager.off(r.HIDE,this.handleHideCursorTag)}},{key:"render",value:function(){var e=this,t=this.props,n=t.scale,r=t.top,i=t.left,a=this.state.tags;return I.a.createElement("div",null,Object.keys(a).sort().map((function(t){var o=a[t];return I.a.createElement(Z,{key:t,x:o.x*n+i,y:o.y*n+r,color:o.color,text:o.name,visible:o.visible,duration:o.duration,onHide:e.handleCursorTagHide(t)})})))}}]),n}(I.a.Component);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var ne=(J=Reflect.metadata("design:type",Array),q=function(e){h()(n,e);var t=te(n);function n(e,r){var i;l()(this,n),i=t.call(this),c()(p()(i),"elementsWithCursors",Q,p()(i)),S()(p()(i),"historyManager",void 0),S()(p()(i),"selectReaction",void 0),S()(p()(i),"loadReaction",void 0),i.uiDataService=e,i.selectionService=r;var a=function(e){var t;null!==(t=i.historyManager)&&void 0!==t&&t.isShowingHistory||i.updateElementsCursors(e.isNew)};return M.a.EventManager.promise().then((function(e){return e.on(D.a.CursorInfoUpdate,a)})),i.initReactions(),i}return d()(n,[{key:"initReactions",value:function(){var e=this;this.selectReaction&&this.selectReaction(),this.selectReaction=Object(x.r)((function(){var t=e.selectionService.selectedElements.selectedArray;return t?t.slice(0,t.length):[]}),(function(t){var n;null!==(n=e.historyManager)&&void 0!==n&&n.isShowingHistory||e.handleSelectionChange(t)})),this.loadReaction&&this.loadReaction(),this.loadReaction=Object(x.r)((function(){return e.uiDataService.presentation.operation.loading}),(function(t){var n;null!==(n=e.historyManager)&&void 0!==n&&n.isShowingHistory||t||e.updateElementsCursors(!1)}))}},{key:"renderCursorTags",value:function(e){return I.a.createElement($,a()({},e,{cursorManager:this}))}},{key:"showCursorTagForElement",value:function(e){var t,n;if(!e.selected){var i=this.cursorTagAnchorPosition(e),a=e.selectedByOthers&&e.selectedByOthers.length>0?e.selectedByOthers[0]:null,o=null===(t=this.getCursorManager())||void 0===t?void 0:t.getUserName(null!==(n=null==a?void 0:a.userId)&&void 0!==n?n:"");a&&o&&(a.name=o,this.emit(r.SHOW,{key:this.getSdkIdFromElement(e),position:i,cursor:a}))}}},{key:"hideCursorTagForElement",value:function(e){this.emit(r.HIDE,{key:this.getSdkIdFromElement(e)})}},{key:"refreshCursorTagsForElements",value:function(e){var t=this,n=e.reduce((function(e,n){if(n.selectedByOthers&&n.selectedByOthers.length>0&&!n.selected){var r,i,a=t.cursorTagAnchorPosition(n),o=n.selectedByOthers&&n.selectedByOthers.length>0?n.selectedByOthers[0]:null,c=null===(r=t.getCursorManager())||void 0===r?void 0:r.getUserName(null!==(i=null==o?void 0:o.userId)&&void 0!==i?i:"");o&&c&&(o.name=c,e.show.push({key:t.getSdkIdFromElement(n),position:a,cursor:o}))}else e.hide.push({key:t.getSdkIdFromElement(n)});return e}),{show:[],hide:[]});this.emit(r.REFRESH,n)}},{key:"clearCursorTagsForElements",value:function(e){var t=this,n=[];e&&(n=e.map((function(e){return t.getSdkIdFromElement(e)}))),this.emit(r.CLEAR,{keys:n})}},{key:"isElementInSlide",value:function(e){for(var t=e;t.parent;){var n=this.getPresentationChildrenByUiModel(t);if(!(null==n?void 0:n.some((function(e){return e.key===t.key}))))return!1;t=t.parent}return!0}},{key:"cursorTagAnchorPosition",value:function(e){var t=this,n={x:this.frameOfElement(e).width,y:0};return Object(N.n)(e)&&e.isRootGroup&&(n.x+=L.a,n.y-=L.a),n=this.transformPointByElement(n,e),Object(F.a)(e,(function(e){n=t.transformPointByElement(n,e)})),n}},{key:"transformPointByElement",value:function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),r=this.frameOfElement(t);n.x+=r.left,n.y+=r.top;var i=A.f(r);return i&&(1===(null==r?void 0:r.flipH)&&(n=A.b(n,i.x)),1===(null==r?void 0:r.flipV)&&(n=A.c(n,i.y))),C()(r,"rotate")&&r.rotate&&(n=A.d(n,r.rotate,r.left+r.width/2,r.top+r.height/2)),n}},{key:"frameOfElement",value:function(e){var t=e.operationFrame,n=e.props.style;return{width:t?t.width:n.width,height:t?t.height:n.height,left:t?t.left:n.left,top:t?t.top:n.top,flipH:C()(t,"flipH")?null==t?void 0:t.flipH:C()(n,"flipH")?n.flipH:0,flipV:C()(t,"flipV")?null==t?void 0:t.flipV:C()(n,"flipV")?n.flipV:0,rotate:C()(n,"rotate")?n.rotate:0}}},{key:"handleSelectionChange",value:function(e){var t,n;if(Object(k.k)()&&null!==(t=M.a.PrivilegeManager())&&void 0!==t&&t.editable){var r=e.map((function(e){var t,n;return(null===(t=e.sdkData)||void 0===t?void 0:t.uniqueID)||(null===(n=e.sdkData)||void 0===n?void 0:n.id)}));null===(n=this.getCursorManager())||void 0===n||n.updateCursor({selection:r}),this.clearCursorTagsForElements(e)}}},{key:"updateElementsCursors",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(Object(k.k)()&&this.selectionService.currentSlide&&this.getCursorManager()){var n=this.getCursorBySlide(),r=null===(e=this.selectionService.currentSlide.sdkData)||void 0===e?void 0:e.id,i=[];this.clearCursorElement(),this.update(this.selectionService.currentSlide,n,t,r,i);for(var a=this.elementsWithCursors.length-1;a>=0;a--)this.isElementInSlide(this.elementsWithCursors[a].element)||this.elementsWithCursors.splice(a,1);i.length>0&&this.refreshCursorTagsForElements(i)}}},{key:"getPresentationChildrenByUiModel",value:function(e){var t,n,r;return Object(N.u)(e)?null===(n=e.parent)||void 0===n?void 0:n.masterList:Object(N.t)(e)?null===(r=e.parent)||void 0===r?void 0:r.layoutList:null===(t=e.parent)||void 0===t?void 0:t.children}},{key:"getCursorBySlide",value:function(){var e,t=null===(e=this.getCursorManager())||void 0===e?void 0:e.elementCursors,n=this.selectionService.currentSlideIndex,r={};return Object.keys(t).forEach((function(e){var i,a=null===(i=M.a.SDKDataServices.PresentationStoreService())||void 0===i?void 0:i.getPresentation();(null==a?void 0:a.slideList[n].getShapeById(e))&&(r[e]=t[e])})),r}},{key:"update",value:function(e,t,n,r,i){var a,o=this,c=null!==(a=this.getSdkIdFromElement(e))&&void 0!==a?a:"",s=t[c]||null;if(s&&s.length>0){if(!this.isTheSameCursor(c,s)){var l,u;this.updateCursorValue(c,s,e),e.selectedByOthers=s;var d=!1,f=null;if(f=this.getRootGroup(e)){var p,v=null===(p=f.sdkData)||void 0===p?void 0:p.uniqueID;this.isTheSameCursor(v,s)||(this.updateCursorValue(v,s,f),f.selectedByOthers=s,d=!0)}var h=null===(l=e.sdkData)||void 0===l||null===(u=l.getPage())||void 0===u?void 0:u.id;if(n&&h===r&&(i.push(e),d)){var g=i.findIndex((function(e){return e===f}));-1!==g&&i.splice(g,1)}}}else{var m=this.elementsWithCursors.findIndex((function(e){return e.id===c}));-1!==m&&this.elementsWithCursors.splice(m,1),e.selectedByOthers=null}e.children.forEach((function(e){return o.update(e,t,n,r,i)}))}},{key:"getRootGroup",value:function(e){for(var t=e.parent;t&&(!Object(N.n)(t)||!t.isRootGroup);)t=t.parent;return t}},{key:"clearCursorElement",value:function(){this.elementsWithCursors=[]}},{key:"updateCursorValue",value:function(e,t,n){var r=this.elementsWithCursors.findIndex((function(t){return t.id===e}));-1!==r&&this.elementsWithCursors.splice(r,1),this.elementsWithCursors.push({id:e,element:n,cursor:t})}},{key:"isTheSameCursor",value:function(e,t){var n=this.elementsWithCursors.findIndex((function(t){return t.id===e}));return-1!==n&&!(-1!==n&&this.elementsWithCursors[n].cursor!==t)}},{key:"getCursorManager",value:function(){return _.a.CursorManager()}},{key:"getSdkIdFromElement",value:function(e){var t;return null===(t=e.sdkData)||void 0===t?void 0:t.id}}]),n}(P.a),Q=O()(q.prototype,"elementsWithCursors",[x.q,J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q)},"18157f4ef5":function(e,t,n){"use strict";n.r(t);n("73b854064b");var r,i,a,o,c,s,l,u=n("176815363d"),d=n.n(u),f=n("730477bb20"),p=n.n(f),v=n("1f925d7f50"),h=n.n(v),g=n("9132715560"),m=n.n(g),b=n("6a364eb35c"),y=n.n(b),E=n("547611bd96"),S=n.n(E),w=n("bd29e2df90"),O=n.n(w),T=n("ab5eb40518"),I=n.n(T),R=n("1b4cdd6a36"),C=n.n(R),x=n("85d0a7609b"),A=n.n(x),k=n("2dc700e1e6"),P=n.n(k),M=(n("f1054791f4"),n("7a5536c9bf")),D=n.n(M),_=n("14502724a6"),N=n.n(_),L=n("3ef2352f0b"),F=n.n(L),j=(n("0acdc5834b"),n("3bf1976a4f"),n("6e20b6a7d8"),n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("826dc923b3"),n("081c8cafea"),n("1bab7b5fb7"),n("0aeae65bf4"),n("b1e2246d82"),n("963f2eaace"),n("a2a09da1e3"),n("8a35b54c1d"),n("af802ec74b"),n("69084d01d3")),B=n.n(j),U=n("d5c3deb8c7"),G=n("d3d31c86eb"),H=n("9da6335152"),z=n("6f02e454f9"),W=n("5fac0349d3"),V=n("64d711d957"),K=n("63c4952f3c"),Y=n("846ab59b8e"),X=n("e71df909b9"),J=n("020899bf26"),q=n("668bd0ac65"),Q=n("7c46f42788"),Z=n("9fbcf5162b"),$=n("b479a84af5"),ee=n("6ad6ba1542"),te=n("055c045d91");function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var i=C()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return I()(this,n)}}var re,ie,ae=(re=[[[Y.d.ILLEGAL_OFFICE_CODE],{errorText:W.a.t("导入失败，文件已损坏。")}],[[Y.d.PASSWORD_INCORRECT],{action:function(){this.handlePasswordError()}}],[[Y.d.FILE_ENCRYPTED,Y.d.FILE_ENCRYPTED_113],{action:function(e){this.handleOpenPasswordInput(e)},errorText:""}],[[Y.d.FILE_EXCEPTION,Y.d.POI_EXCEPTION_PARSING],{errorText:W.a.t("文件导入失败，请使用Office另存为*.pptx后再导入。"),action:function(){this.passwordInputManager.close(Y.a.IMPORT_ERROR)}}],[[Y.d.FORMAT_ERROR_03_TO_07,Y.d.FORMAT_TIMEOUT_03_TO_07,Y.d.OOM_03_TO_07],{errorText:W.a.t("文件版本过旧，请使用Office另存为*.pptx后再导入。"),action:function(){this.passwordInputManager.close(Y.a.IMPORT_ERROR)}}],[[Number.MAX_VALUE],{errorText:W.a.t("未知错误"),action:function(){this.passwordInputManager.close(Y.a.IMPORT_ERROR)}}]],ie=re.reduce((function(e,t){var n=N()(t,2),r=n[0],i=n[1];return[].concat(D()(e),D()(r.map((function(e){return[e,i]}))))}),[]),new Map(ie)),oe=(r=Reflect.metadata("design:type",Boolean),i=Reflect.metadata("design:type",Boolean),a=Reflect.metadata("design:type",void 0===Y.ImportFileData?Object:Y.ImportFileData),o=function(e){O()(v,e);var t,r,i,a,o,u,f=ne(v);function v(){var e;return m()(this,v),e=f.call(this),h()(S()(e),"showCancelWarn",c,S()(e)),A()(S()(e),"pagingSelectionManager",void 0),A()(S()(e),"passwordInputManager",void 0),h()(S()(e),"visible",s,S()(e)),h()(S()(e),"data",l,S()(e)),A()(S()(e),"uploadTool",void 0),A()(S()(e),"fakeIncreaseProgress",void 0),A()(S()(e),"cancelWarnQueue",void 0),A()(S()(e),"uiDataService",void 0),A()(S()(e),"selectionService",void 0),A()(S()(e),"importFileInjectable",void 0),A()(S()(e),"LazyImportFileComponent",Object(j.lazy)((function(){return Object(J.d)((function(){return Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~lazyComponents")]).then(n.bind(null,"a2b2c85fda"))}))}))),A()(S()(e),"getLazyImportFileComponent",(function(t){var n=S()(e).LazyImportFileComponent;return B.a.createElement($.a,null,B.a.createElement(n,p()({},t,{importFileManager:S()(e)})))})),A()(S()(e),"closePassword",(function(){var t,n;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.a.BUTTON_CLICK)===Y.a.BUTTON_CLICK&&e.setVisible(!1),null===(t=e.uploadTool)||void 0===t||t.cancel(),null===(n=e.uploadTool)||void 0===n||n.updatePassword("")})),A()(S()(e),"confirmPasswordSuccess",(function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null===(t=e.uploadTool)||void 0===t||t.updatePassword(n);var r=e.passwordInputManager.file;r&&e.parseAndPreviewSlideFile(r)})),e.uploadTool=void 0,e.cancelWarnQueue=[],e.passwordInputManager=new V.b,e.passwordInputManager.onClose(e.closePassword),e.passwordInputManager.onConfirmSuccuss(e.confirmPasswordSuccess),e.createShowCancelWarnReaction(),e}return y()(v,[{key:"clearCancelWarnQueue",value:function(){this.cancelWarnQueue=[]}},{key:"getVisible",value:function(){return this.visible}},{key:"close",value:(u=d()(F.a.mark((function e(){var t;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.visible=!1,this.showCancelWarn=!1,this.cancelWarnQueue=[],null===(t=this.uploadTool)||void 0===t||t.cancel(),this.updateData({type:Y.c.NONE,progress:0});case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"parseAndPreviewSlideFile",value:(o=d()(F.a.mark((function e(t){var n,r,i,a,o,c=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(c.length>1&&void 0!==c[1])||c[1],r=t.name.match(/(.+)(\.pptx?)$/)||[],this.setVisible(!0),e.next=5,this.parseSlideFile(t);case 5:if(i=e.sent,a=i.code,o=i.initialAttributedText,0===a&&this.visible){e.next=10;break}return e.abrupt("return");case 10:this.passwordInputManager.close(!1),this.setVisible(!1),this.pagingSelectionManager.updateData({presentationStr:o,title:r[1]||W.a.t("演示文稿"),useCurrentSlideIndex:n,source:z.a.LOCAL}).setVisible(!0);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"parseAndInsertISlideFile",value:(a=d()(F.a.mark((function e(t){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.parseISlideFile(t);case 2:if(!(n=e.sent)){e.next=6;break}return e.next=6,this.insertISlideFile(n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"setPagingSelectionManager",value:function(e){this.pagingSelectionManager=e}},{key:"setUiDataService",value:function(e){this.uiDataService=e}},{key:"setSelectionService",value:function(e){this.selectionService=e}},{key:"setImportFileInjectable",value:function(e){this.importFileInjectable=e}},{key:"updateSelectedSlidesArray",value:function(e,t){var n=this.uiDataService.presentation.children,r=this.selectionService.selectedSlides,i=-2===e?n.slice(-t):n.slice(e,e+t);r.clearAndAdd.apply(r,D()(i)),this.selectionService.changeCurrentSlideIndexByUserAction(n.map((function(e){return e.id})).indexOf(i[0].id))}},{key:"createShowCancelWarnReaction",value:function(){var e=this;Object(U.r)((function(){return e.showCancelWarn}),(function(t){t||(e.cancelWarnQueue=e.cancelWarnQueue.filter((function(e){try{e()}catch(e){}return!1})))}))}},{key:"progressCb",value:function(e){var t=this,n=e.ret,r=e.code,i=e.progress;if(0===n||0===r)return clearInterval(this.fakeIncreaseProgress),this.fakeIncreaseProgress=setInterval((function(){"number"==typeof t.data.progress&&t.data.progress<i?t.updateData({type:Y.c.LOADING,progress:t.data.progress+1}):clearInterval(t.fakeIncreaseProgress)}),16)}},{key:"handleOpenPasswordInput",value:function(e){var t=this;this.showCancelWarn?this.cancelWarnQueue.push((function(){t.passwordInputManager.open(e)})):this.passwordInputManager.open(e)}},{key:"handlePasswordError",value:function(){this.passwordInputManager.passwordStatus=V.a.WRONG}},{key:"uploadSuccess",value:function(){var e;null===(e=this.uploadTool)||void 0===e||e.updatePassword(""),this.updateData({type:Y.c.SUCCESS}),Object(G.c)({opername:H.e.PAGING_SELECTION,module:H.d.SLIDE_UPLOAD,action:H.b.UPLOAD_SUCCESS})}},{key:"uploadFail",value:function(e,t){var n,r=e.ret,i=e.code,a=r||i,o=null!==(n=ae.get(a))&&void 0!==n?n:ae.get(Number.MAX_VALUE),c=o.errorText,s=o.action;c&&this.updateData({type:Y.c.ERROR,errMsg:c}),null==s||s.call(this,t)}},{key:"updateData",value:function(e){this.data=Object.assign({},this.data,e)}},{key:"setVisible",value:function(e){e?this.visible=!0:this.close()}},{key:"parseSlideFile",value:(i=d()(F.a.mark((function e(t){var r,i,a,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Object(X.b)(t)){e.next=4;break}return this.updateData({type:Y.c.ERROR,errMsg:W.a.t("仅支持.ppt或者.pptx格式，请重新选择")}),e.abrupt("return",{code:Y.d.ILLEGAL_OFFICE_CODE});case 4:if(this.updateData({type:Y.c.LOADING,progress:0}),this.uploadTool){e.next=21;break}return e.next=8,null===(a=this.importFileInjectable)||void 0===a?void 0:a.getUploadToolImpl();case 8:if(e.t1=i=e.sent,e.t0=null!==e.t1,!e.t0){e.next=12;break}e.t0=void 0!==i;case 12:if(!e.t0){e.next=16;break}e.t2=i,e.next=20;break;case 16:return e.next=18,Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519")]).then(n.bind(null,"d289e8c7fb"));case 18:e.t3=e.sent.default,e.t2=new e.t3;case 20:this.uploadTool=e.t2;case 21:return e.next=23,this.uploadTool.parseSlideFile(t,null===(r=J.a.DocInfoManager())||void 0===r?void 0:r.domainId,this.progressCb.bind(this));case 23:return o=e.sent,clearInterval(this.fakeIncreaseProgress),0===o.code&&100===o.progress?this.uploadSuccess():this.uploadFail(o,t),e.abrupt("return",o);case 29:e.prev=29,e.t4=e.catch(0),this.updateData({type:Y.c.ERROR,errMsg:W.a.t("网络请求错误")});case 32:case"end":return e.stop()}}),e,this,[[0,29]])}))),function(e){return i.apply(this,arguments)})},{key:"parseISlideFile",value:(r=d()(F.a.mark((function e(t){var n,r,i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setVisible(!0),e.next=3,this.parseSlideFile(t);case 3:if(n=e.sent,r=n.code,i=n.initialAttributedText,0===r&&this.visible){e.next=8;break}return e.abrupt("return");case 8:return this.setVisible(!1),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"insertISlideFile",value:(t=d()(F.a.mark((function e(t){var n,r,i,a,o,c,s,l,u,d,f,p,v,h,g,m,b;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.selectionService,o=a.currentSlideIndex,c=a.slideClearanceIndex,s=this.uiDataService.presentation.sectionList,l=-1!==c?c:null!=s&&s.length?Z.a.calcClearanceIndexFromSlideIndex(null!=o?o:0,s):o+1,e.next=5,J.a.SDKDataServices.PresentationStoreService.promise();case 5:return u=e.sent,e.next=8,u.createFromCommandData(new q.a(JSON.parse(t)).getCommandData());case 8:if(d=e.sent,f=this.uiDataService.presentation.sdkData,p=f.props.sldSz,v=p.cx,h=p.cy,g=p.type,(null===(n=(r=d.getPresentation().api).resizeSlideSize)||void 0===n?void 0:n.call(r,v,h,g))||console.warn("unSupport resizeSlideSize"),Object(ee.a)(d.getPresentation().getOwnedData(),"iSlide_import",Q.a.Presentation),m=d.getPresentation(),null===(i=J.a.ClientVarsService())||void 0===i||!i.isPCLocalEdit()){e.next=20;break}return e.next=18,Object(te.a)(m.store.data.resourceMap);case 18:b=e.sent,m.api.updateResourceMap(b);case 20:f.api.addPresentation(m.getWritableOwnedData(),l,!(null==s||!s.length));case 21:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),v}(K.a),c=P()(o.prototype,"showCancelWarn",[U.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=P()(o.prototype,"visible",[U.q,i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=P()(o.prototype,"data",[U.q,a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o);t.default=oe},"23cec2bcc1":function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("85d0a7609b"),u=n.n(l),d=n("3ef2352f0b"),f=n.n(d),p=(n("c6244f7705"),n("081c8cafea"),n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("bd29e2df90")),v=n.n(p),h=n("ab5eb40518"),g=n.n(h),m=n("1b4cdd6a36"),b=n.n(m),y=(n("8ee19818c4"),n("3cc783627f")),E=(n("b8217400dc"),n("e6f68cdf2e"),n("bd80bf2d0f"),function(){function e(){o()(this,e),u()(this,"privateTag","tco-slide-data")}return s()(e,[{key:"getPrivateData",value:function(e){var t;if(e.includes(this.privateTag)){var n=(new DOMParser).parseFromString(e,"text/html");return null==n||null===(t=n.querySelector("*[".concat(this.privateTag,"]")))||void 0===t?void 0:t.getAttribute(this.privateTag)}}},{key:"asyncGetHtml",value:function(e,t){var n=this;return Promise.resolve(e).then((function(e){var r;return null===(r=n.getHtml)||void 0===r?void 0:r.call(n,e,t)}))}},{key:"insertPrivateData",value:function(e,t){try{var n=JSON.stringify(t,(function(e,t){return"number"!=typeof t||!isNaN(t)&&isFinite(t)?t:t.toString()}));return e.setAttribute(this.privateTag,n),n}catch(e){window.log.error("[ClipboardManager] insertPrivateData error",e)}}},{key:"getFirstSelectedElement",value:function(e){var t;return null==e||null===(t=e.data)||void 0===t?void 0:t[0]}},{key:"containerTagIsImage",value:function(e,t){var n=document.createElement("Img");return n.setAttribute("src",t||""),this.insertPrivateData(n,e),n.outerHTML}}]),e}());function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var O=function(e){v()(n,e);var t=w(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getHtml",value:function(e,t){var n,r,i,a,o=this.getFirstSelectedElement(e);if(1!==(null==o||null===(n=o.props)||void 0===n?void 0:n.txBox)&&(null==t?void 0:t.imgStr))return this.containerTagIsImage(e,null==t?void 0:t.imgStr);var c=document.createElement("div");this.insertPrivateData(c,e);var s=null===(r=o.txBody)||void 0===r?void 0:r.p;return(null==s?void 0:s.length)&&this.handlerParagraphList(s,c),"iframe"===(null==o||null===(i=o.props)||void 0===i||null===(a=i.addon)||void 0===a?void 0:a.displayMode)&&c.appendChild(this.handlerAddon(o)),c.outerHTML}},{key:"getFirstSelectedElement",value:function(e){var t,n=null==e||null===(t=e.data)||void 0===t?void 0:t[0];return n.inheritedSdkData||n}},{key:"handlerAddon",value:function(e){var t=e.props.addon,n=t.originUrl,r=t.embedUrl,i=t.extraData,a=t.iframeId,o=document.createElement("slide-data");return o.setAttribute("data-src",JSON.stringify({originUrl:n,embedUrl:r,extraData:i,iframeId:a})),o}},{key:"createNewListTag",value:function(e){var t=document.createElement("ul");return Object(y.j)(e)&&(t=document.createElement("ol")),t}},{key:"handlerParagraphList",value:function(e,t){var n,r=this;e.forEach((function(e){var i,a;Object(y.g)(e)?(n||(n=r.createNewListTag(e),t.appendChild(n)),a=document.createElement("li"),n.appendChild(a)):(a=document.createElement("p"),t.appendChild(a),n=null),Object(y.k)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.pPr),a.style),null===(i=e.egTextRun)||void 0===i||i.forEach((function(e){var t,n=(e.r||{}).rPr;null!=n&&n.hlinkClick?(t=document.createElement("a")).href=n.hlinkClick.id:t=document.createElement("span");var r=document.createTextNode(Object(y.e)(e));t.appendChild(r),Object(y.k)(n,t.style),a.appendChild(t)}))}))}}]),n}(E),T=O,I=n("547611bd96"),R=n.n(I),C=(n("3bf1976a4f"),n("ddb144cdda"));function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var A=function(e){v()(n,e);var t=x(n);function n(){var e;o()(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),u()(R()(e),"base64UrlTempMap",void 0),e}return s()(n,[{key:"getHtml",value:function(e){var t=document.createElement("div"),n=this.getFirstSelectedElement(e);return this.insertPrivateData(t,e),t.innerHTML=t.innerHTML+this.getImageHtml(n),t.outerHTML}},{key:"getImageHtml",value:function(e){var t,n,r,i,a=null!==(t=null==e?void 0:e.inheritedSdkData)&&void 0!==t?t:e,o=null==a||null===(n=a.blipFill)||void 0===n||null===(r=n.blip)||void 0===r?void 0:r.embed,c=null===(i=this.base64UrlTempMap)||void 0===i?void 0:i.get(o);return this.convertSDkDataToHtmlString(e,o,c)}},{key:"convertSDkDataToHtmlString",value:function(e,t,n){var r,i,a,o,c,s,l=e.isPlaceholder?e.copyDataByInheritedProperties():e,u=null==l||null===(r=l.spPr)||void 0===r||null===(i=r.xfrm)||void 0===i||null===(a=i.ext)||void 0===a?void 0:a.cx,d=null==l||null===(o=l.spPr)||void 0===o||null===(c=o.xfrm)||void 0===c||null===(s=c.ext)||void 0===s?void 0:s.cy,f=u>0?u/y.i:0,p=d>0?d/y.i:0,v=C.c.stringifyAddonData(e);return'<img src="'.concat(n||t,'" style="width: ').concat(f,"px; height: ").concat(p,'px;"').concat(v,"/>")}}]),n}(E),k=A;function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var M=function(e){v()(n,e);var t=P(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getHtml",value:function(e,t){if(null!=t&&t.imgStr)return this.containerTagIsImage(e,t.imgStr);var n=document.createElement("div");this.insertPrivateData(n,e);var r=document.createElement("p");return n.appendChild(r),n.outerHTML}}]),n}(E),D=M,_=n("8eec1e4a03"),N=n.n(_),L=n("6986953439"),F=n("d9812f1c6f");function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var B,U=function(e){v()(n,e);var t=j(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getHtml",value:function(e){var t=this.getFirstSelectedElement(e),n=L.a.getSingleton().parseSdkDataToHtml(t),r=(new DOMParser).parseFromString(n,"text/html"),i=r.querySelector("table");return i?(this.insertPrivateData(i,e),r.querySelector("html").outerHTML):""}},{key:"getFirstSelectedElement",value:function(e){var t,r;return F.a.isPc?null==e||null===(t=e.data)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.inheritedSdkData:N()(b()(n.prototype),"getFirstSelectedElement",this).call(this,e)}}]),n}(E),G=U;!function(e){e[e.TABLE=0]="TABLE",e[e.IMAGE=1]="IMAGE",e[e.CUSTOM=2]="CUSTOM",e[e.CUSTOM_INHERIT_AND_NO_INHERIT=3]="CUSTOM_INHERIT_AND_NO_INHERIT",e[e.UNFIT_ELEMENT=4]="UNFIT_ELEMENT",e[e.MULTI_ELEMENT=5]="MULTI_ELEMENT",e[e.SLIDE=6]="SLIDE"}(B||(B={}));var H=function(){function e(){o()(this,e),u()(this,"customElementPrepareModel",void 0),u()(this,"imagePrepareModel",void 0),u()(this,"defaultPrepareModel",void 0),u()(this,"tablePrepareModel",void 0),this.customElementPrepareModel=new T,this.imagePrepareModel=new k,this.defaultPrepareModel=new D,this.tablePrepareModel=new G}var t,n;return s()(e,[{key:"getHTMLString",value:function(e,t,n,r){var i;return(null===(i=e.outputOptions)||void 0===i?void 0:i.useAsync)&&!n?this.asyncGetHTMLString(e,t,r):this.syncGetHTMLString(e,t,r)}},{key:"getHTMLBlob",value:(n=i()(f.a.mark((function e(t,n,r){var i,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={type:"text/html"},e.next=3,this.getHTMLString(t,n,!1,r);case 3:return a=e.sent,e.abrupt("return",new Blob([a],i));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"HTMLblobToText",value:(t=i()(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:return n=e.sent,e.abrupt("return",{html:n,privateData:this.defaultPrepareModel.getPrivateData(n)});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"HTMLStringToText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{html:e,privateData:this.defaultPrepareModel.getPrivateData(e)}}},{key:"syncGetHTMLString",value:function(e,t,n){return e.type===B.TABLE?this.tablePrepareModel.getHtml(e.data):e.type===B.IMAGE?(this.imagePrepareModel.base64UrlTempMap=n,this.imagePrepareModel.getHtml(e.data)):e.type===B.CUSTOM||e.type===B.CUSTOM_INHERIT_AND_NO_INHERIT?this.customElementPrepareModel.getHtml(e.data,t):this.defaultPrepareModel.getHtml(e.data,t)}},{key:"asyncGetHTMLString",value:function(e,t,n){return e.type===B.TABLE?this.tablePrepareModel.asyncGetHtml(e.data):e.type===B.IMAGE?(this.imagePrepareModel.base64UrlTempMap=n,this.imagePrepareModel.asyncGetHtml(e.data)):e.type===B.CUSTOM||e.type===B.CUSTOM_INHERIT_AND_NO_INHERIT?this.customElementPrepareModel.asyncGetHtml(e.data,t):this.defaultPrepareModel.asyncGetHtml(e.data,t)}}]),e}();t.b=H},"27b499fefe":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return R}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("85d0a7609b"),u=n.n(l),d=n("3ef2352f0b"),f=n.n(d),p=(n("c6244f7705"),n("081c8cafea"),n("1bab7b5fb7"),n("0aeae65bf4"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("82f2dc9440")),v=n.n(p),h=n("f8fc8e0087"),g=n("6f02e454f9"),m=n("b0c77d1072"),b=n.n(m),y=n("8f58e78419"),E=n.n(y),S=n("5fac0349d3"),w=n("065339d25e"),O=n("e07760dbbb");function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=function(){function e(){var t=this;o()(this,e),u()(this,"pagingSelectionManager",void 0),u()(this,"beforeConfirmHandler",function(){var e=i()(f.a.mark((function e(n,r){var i,a,o,c,s,l,u,d,p,v,m,y;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(null==n||null===(i=n.url)||void 0===i||null===(a=i.match(/.+\/(slide|document)\/(.+)$/))||void 0===a?void 0:a[2])||"",c=n.policy,s=t.promisifyNet(b.a.ajaxGet),e.next=5,s({url:"//".concat(window.hostname,"/dop-api/slide/data/get"),param:{id:o,normal:1,xsrf:Object(h.getCookie)("TOK"),needPaginate:0}});case 5:if(l=e.sent,u=l.retcode,d=l.data,p=E()(d,"collab_client_vars.initialAttributedText.text")||"",v=E()(d,"privilegeAttribute")||{},0!==u||!p){e.next=17;break}if(2!==c||v.can_copy&&v.can_print){e.next=13;break}return t.cannotImportTips(S.a.t("此文档已禁止查看者导出内容。")),e.abrupt("return");case 13:null===(m=t.pagingSelectionManager)||void 0===m||m.updateData({presentationStr:p,title:(null==l||null===(y=l.data)||void 0===y?void 0:y.title)||S.a.t("演示文稿"),useCurrentSlideIndex:!0,source:g.a.ONLINE}).setVisible(!0),null==r||r(),e.next=18;break;case 17:t.cannotImportTips();case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}return s()(e,[{key:"setPagingSelectionManagerDelegate",value:function(e){this.pagingSelectionManager||(this.pagingSelectionManager=e)}},{key:"show",value:function(){var e=this;w.a.getInstance().showFileSelector({mimeTypes:[O.b.TencentSlide],confirmButtonConfig:{onClick:function(t){e.beforeConfirmHandler(t[0]||{})}}})}},{key:"promisifyNet",value:function(e){return function(t){return new Promise((function(n,r){return e(I(I({},t),{},{success:function(e){return n(e)},error:function(e){return r(e)}}))}))}}},{key:"cannotImportTips",value:function(e){var t;null===(t=this.pagingSelectionManager)||void 0===t||t.setVisible(!1),v.a.show({message:e?S.a.t(e):S.a.t("此文档不可查看，请申请权限后重试。"),type:"info",duration:3e3})}},{key:"chain",value:function(e){return e(),this}}]),e}()},"36a8262c2a":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var r,i=n("7a5536c9bf"),a=n.n(i),o=n("9132715560"),c=n.n(o),s=n("6a364eb35c"),l=n.n(s),u=n("85d0a7609b"),d=n.n(u),f=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("6e20b6a7d8"),n("8ee19818c4"),n("b8217400dc"),n("e6f68cdf2e"),n("3bf1976a4f"),n("4bbb5840d5"),n("132ceeffea")),p=n("285f8ccc4f"),v=n("775b80aea6"),h=n("6ba11f23ff"),g=n("ddb144cdda"),m=n("1ec06b7059"),b=n.n(m),y=n("98efcda99e"),E=n.n(y),S=n("ec5cae33cb"),w=n("5cdbac46e8"),O=n("e0e8dd9366"),T=n("d9812f1c6f"),I=n("9fbcf5162b"),R=n("1e174780ae"),C=n("33c34da0d5"),x=n("020899bf26"),A=n("a42b29265b"),k=n("ab17200d42");function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.textBodyModel=0]="textBodyModel",e[e.sdkModel=1]="sdkModel"}(r||(r={}));var D=function(){function e(){c()(this,e),d()(this,"useBase64Copy",!T.a.isMobile),d()(this,"base64UrlTempMap",new Map),d()(this,"uiDataService",void 0),d()(this,"selectionService",void 0),d()(this,"sectionManager",void 0),d()(this,"userPriviledgeService",void 0),d()(this,"editingStateManager",void 0),d()(this,"editorInstanceService",void 0)}return l()(e,[{key:"selectedElements",get:function(){var e,t;return(null===(e=this.selectionService)||void 0===e||null===(t=e.selectedElements)||void 0===t?void 0:t.selectedArray)||[]}},{key:"selectedSlides",get:function(){var e,t;return(null===(e=this.selectionService)||void 0===e||null===(t=e.selectedSlides)||void 0===t?void 0:t.selectedArray)||[]}},{key:"clearanceSelected",get:function(){var e;return-1!==(null===(e=this.selectionService)||void 0===e?void 0:e.slideClearanceIndex)}},{key:"activePointInShape",get:function(){var e;return!(null===(e=this.editorInstanceService)||void 0===e||!e.checkEditorIsEditing())}},{key:"activePointInSideBar",get:function(){var e;return!(null===(e=this.editingStateManager)||void 0===e||!e.isEditing)}},{key:"lastRegion",get:function(){var e;return(null===(e=this.selectionService)||void 0===e?void 0:e.lastMouseDownRegion)||S.a.NONE}},{key:"isEditorRegion",get:function(){return this.lastRegion===S.a.EDITOR}},{key:"isNoteRegion",get:function(){return this.lastRegion===S.a.NOTE}},{key:"isSlideListRegion",get:function(){return this.lastRegion===S.a.SLIDELIST}},{key:"canEditAndCopy",get:function(){return!!this.userPriviledgeService&&this.userPriviledgeService.pptEditorState<w.b.SELECTABLE}},{key:"canEdit",get:function(){return!!this.userPriviledgeService&&this.userPriviledgeService.pptEditorState<=w.b.EDITABLE}},{key:"setServiceDelegates",value:function(e){var t,n,r,i,a,o;this.uiDataService=null!==(t=this.uiDataService)&&void 0!==t?t:e.uiDataService,this.selectionService=null!==(n=this.selectionService)&&void 0!==n?n:e.selectionService,this.editingStateManager=null!==(r=this.editingStateManager)&&void 0!==r?r:e.editingStateManager,this.editorInstanceService=null!==(i=this.editorInstanceService)&&void 0!==i?i:e.editorInstanceService,this.sectionManager=null!==(a=this.sectionManager)&&void 0!==a?a:e.sectionManager,this.userPriviledgeService=null!==(o=this.userPriviledgeService)&&void 0!==o?o:e.userPriviledgeService}},{key:"getTextSelectedAreaCopyData",value:function(e,t){var n,i,a=e.paragraphListWithInherit,o=e.paragraphListWithoutInherit,c={nvPr:{txBox:!0}},s={nvPr:{txBox:!0}};return R.a.convertPartialDataFromUiToSdk(a,c,t,!1),R.a.convertPartialDataFromUiToSdk(o,s,t,!1),{type:r.textBodyModel,globalPadId:null!==(n=null===(i=x.a.DocInfoManager())||void 0===i?void 0:i.globalPadId)&&void 0!==n?n:"",sdkVersion:A.b.Version3,data:[{ownSdkData:s,inheritedSdkData:c}]}}},{key:"getInsertSlideIndex",value:function(){var e,t,n,r,i,a=(null!==(e=this.uiDataService)&&void 0!==e?e:{}).presentation,o=null===(t=this.selectionService)||void 0===t?void 0:t.selectedSlides.sortSelectedArray(a,null===(n=this.selectionService)||void 0===n?void 0:n.selectedSlides.selectedArray),c=0;if(this.clearanceSelected)c=this.getConvertedSlideIndex(null!==(r=null===(i=this.selectionService)||void 0===i?void 0:i.slideClearanceIndex)&&void 0!==r?r:-1);else if(null!=o&&o.length){var s=o[o.length-1];c=s.presentationRef.indexOfSlide(s)+1}else if(this.selectionService&&this.selectionService.currentSlideType!==O.d.MASTER)if(this.sectionManager&&-1!==this.sectionManager.selectedSectionIndex){var l,u;c=I.a.calcFirstSlideIndexFromSectionIndex(this.sectionManager.selectedSectionIndex,null!==(l=null===(u=this.uiDataService)||void 0===u?void 0:u.presentation.sectionList)&&void 0!==l?l:[])}else c=this.selectionService.currentSlideIndex+1;else c=0;return c}},{key:"getInsertGapIndex",value:function(){var e,t,n,r=(null!==(e=this.uiDataService)&&void 0!==e?e:{}).presentation,i=null===(t=this.selectionService)||void 0===t?void 0:t.selectedSlides.sortSelectedArray(r,null===(n=this.selectionService)||void 0===n?void 0:n.selectedSlides.selectedArray),a=0;if(this.clearanceSelected){var o;a=(null===(o=this.selectionService)||void 0===o?void 0:o.slideClearanceIndex)||0}else{if(null!=i&&i.length){var c,s=i[i.length-1],l=s.presentationRef.indexOfSlide(s),u=(null===(c=this.uiDataService)||void 0===c?void 0:c.presentation.sectionList)||[];return u.length?I.a.calcClearanceIndexFromSlideIndex(l,u):l+1}if(this.selectionService&&this.selectionService.currentSlideType!==O.d.MASTER)if(this.sectionManager&&-1!==this.sectionManager.selectedSectionIndex){var d,f;a=I.a.calcClearanceIndexFromSectionIndex(this.sectionManager.selectedSectionIndex,null!==(d=null===(f=this.uiDataService)||void 0===f?void 0:f.presentation.sectionList)&&void 0!==d?d:[])}else a=this.selectionService.currentSlideIndex+1;else a=0}return a}},{key:"getSelectedElementsCopyData",value:function(){var e=this,t=this.getSelectedArray();if(!t.length)return{};var n=t.map((function(t){var n=t.type===O.d.SLIDE,r=e.getCopiedSdkData(t,{cloneCustomizer:function(t,n){if(h.b.forEach((function(e){null!=t&&t[e]&&delete t[e]})),h.a.includes(n)&&e.isRelationId(t)){var r=v.a.getInstance().getResourceByUrl(t);return(null==r?void 0:r.getCdnUrl())||(null==r?void 0:r.getBase64Url())}},withoutInheritedData:k.c&&n});return k.c?r:r[A.a.INHERIT]}));return this.prepareCopyData(n)}},{key:"getSelectedElementsCopyDataToBase64",value:function(){var e=this,t=this.getSelectedArray();if(!t.length)return{};var n=[],r=t.map((function(t){var r=e.getCopiedSdkData(t),i=k.c?r:r.inheritedSdkData;return Object(p.b)(i,(function(t,r){if(h.a.some((function(e){return void 0!==(null==t?void 0:t[e])}))){var i=Object(p.a)(t);return e.handlerIfChildHasImageKey(i,n),i}h.b.forEach((function(e){return(null==t?void 0:t[e])&&delete t[e]}))}))}));return this.prepareCopyData(r)}},{key:"updateStore",value:function(){}},{key:"updateLastMouseDownRegion",value:function(e){this.selectionService&&(this.selectionService.lastMouseDownRegion=e)}},{key:"getSelectedArray",value:function(){var e,t,n,r;if(!this.uiDataService)return[];var i=[];if(!T.a.isMobile&&this.sectionManager){var o=this.sectionManager.selectedSectionIndex;if(-1!==o){var c=this.uiDataService.presentation.getSectionProperty().getSectionByIndex(o);c&&i.push(c)}}var s=null===(e=this.selectionService)||void 0===e?void 0:e.selectedSlides,l=null===(t=this.selectionService)||void 0===t?void 0:t.selectedElements;return i=(n=i).concat.apply(n,a()((this.isSlideListRegion?null===(r=this.selectionService)||void 0===r?void 0:r.selectedSlides.sortSelectedArray(this.uiDataService.presentation,null==s?void 0:s.selectedArray):null==l?void 0:l.getSortedSelectedArray())||[]))}},{key:"handlerIfChildHasImageKey",value:function(e,t){var n=this;b()(e,(function(r,i,a){if(h.b.forEach((function(e){return E()(r,e)})),h.a.includes(i)){if(n.isRelationId(r)){var o=v.a.getInstance().getResourceByUrl(r);return void(o&&(a[i]=o.getCdnUrl()?o.getCdnUrl():o.getBase64Url()))}if(!n.base64UrlTempMap.get(r)){var c=C.i.get({alloyParams:{urlOrImage:r}});null!=c&&c.isComplete&&n.base64UrlTempMap.set(r,Object(f.b)(c))}t.push({target:e,key:i})}}))}},{key:"getCopiedSdkData",value:function(e,t){return e.type===O.d.TABLE?this.getCopiedTableSdkData(e):e.copyModelHandler().getCopiedSdkModel(t)}},{key:"prepareCopyData",value:function(e){var t,n,i={type:r.sdkModel,data:e,globalPadId:null!==(t=null===(n=x.a.DocInfoManager())||void 0===n?void 0:n.globalPadId)&&void 0!==t?t:"",sdkVersion:A.b.Version3};if(this.isSlideListRegion){var a,o=(null===(a=x.a.SDKDataServices.PresentationStoreService())||void 0===a?void 0:a.getPresentation().props.sldSz)||{},c=o.cx,s=void 0===c?12192e3:c,l=o.cy,u=void 0===l?6858e3:l;i.slideSize={width:s,height:u}}return i}},{key:"getCopiedTableSdkData",value:function(e){var t=e.sdkData;return{inheritedSdkData:this.handlerTableSdkData(t.getInheritedData(),e),ownSdkData:this.handlerTableSdkData(t.getOwnedData(),e)}}},{key:"handlerTableSdkData",value:function(e,t){var n,r=t.selectedRange,i=t.selectedCellRanges,a=M(M({},Object(p.a)(e)),{},{selectedRange:r,selectedCellRanges:i});return g.c.extractTblRangeData(a),delete a.selectedRange,delete a.selectedCellRanges,null!==(n=a.nvPr)&&void 0!==n&&n.ph&&delete a.nvPr.ph,a}},{key:"getConvertedSlideIndex",value:function(e){var t;return null!==(t=this.uiDataService)&&void 0!==t&&t.presentation.hasSections()?I.a.calcSlideIndexFromClearanceIndex(e,this.uiDataService.presentation.sectionList||[]):e}},{key:"isRelationId",value:function(e){return!(null==e||!e.startsWith("rel:"))||!(null==e||!e.startsWith("pptx:"))}}]),e}();t.b=D},"370f01aa54":function(e,t,n){"use strict";n.r(t),n.d(t,"PcDriveSelectorPanelService",(function(){return O}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var r=n("85d0a7609b"),i=n.n(r),a=n("176815363d"),o=n.n(a),c=n("9132715560"),s=n.n(c),l=n("6a364eb35c"),u=n.n(l),d=n("bd29e2df90"),f=n.n(d),p=n("ab5eb40518"),v=n.n(p),h=n("1b4cdd6a36"),g=n.n(h),m=n("3ef2352f0b"),b=n.n(m),y=(n("c6244f7705"),n("081c8cafea"),n("97e7d473f8"));function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var O=function(e){f()(r,e);var t,n=w(r);function r(){return s()(this,r),n.apply(this,arguments)}return u()(r,[{key:"show",value:(t=o()(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.serviceList,r=t.config,this.serviceList=n,e.next=4,y.a.getInstance().showDriveSelectorPanel({config:S(S({},r),{},{onResolve:this.onResolve.bind(this)})});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),r}(n("e2a15884de").a)},"39092784fc":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".import-file-content-importContainer-3m1eT{width:100%}.import-file-content-importContainer-3m1eT .import-file-content-importTitle-3xztB{font-size:18px;opacity:.88;font-weight:500;font-stretch:normal;font-style:normal;line-height:1.44;letter-spacing:normal;-ms-user-select:none;user-select:none;-webkit-user-select:none}.import-file-content-importContainer-3m1eT .import-file-content-import-content-wrapper-AWVBh{margin:39px 0 20px}.import-file-content-importContainer-3m1eT .import-file-content-import-content-wrapper-AWVBh .import-file-content-import-button-wrapper-1UM3D{margin:12px 0;padding:1px 20px;border:1px solid rgba(0,0,0,.08);border-radius:4px;box-sizing:border-box;cursor:pointer;transition-property:background-color,border-color;transition-duration:.15s;transition-timing-function:ease}.import-file-content-importContainer-3m1eT .import-file-content-import-content-wrapper-AWVBh .import-file-content-import-button-wrapper-1UM3D:hover{background-color:rgba(30,111,255,.08);padding:0 19px;border:2px solid #1e6fff}.import-file-content-importContainer-3m1eT .import-file-content-import-content-wrapper-AWVBh .import-file-content-import-button-wrapper-1UM3D:active{background-color:rgba(30,111,255,.16);padding:0 19px;border:2px solid #1e6fff}.import-file-content-importContainer-3m1eT .import-file-content-import-content-wrapper-AWVBh .import-file-content-import-button-wrapper-1UM3D .import-file-content-import-button-large-line-3KOuv{font-size:16px;opacity:.88;line-height:1.5;margin-top:16px;font-weight:500;font-stretch:normal;letter-spacing:normal;-ms-user-select:none;user-select:none;-webkit-user-select:none}.import-file-content-importContainer-3m1eT .import-file-content-import-content-wrapper-AWVBh .import-file-content-import-button-wrapper-1UM3D .import-file-content-import-button-small-line-3sea_{opacity:.4;font-size:12px;line-height:1.67;margin-top:2px;margin-bottom:17px;font-stretch:normal;letter-spacing:normal;-ms-user-select:none;user-select:none;-webkit-user-select:none}",""]),t.locals={importContainer:"import-file-content-importContainer-3m1eT",importTitle:"import-file-content-importTitle-3xztB","import-content-wrapper":"import-file-content-import-content-wrapper-AWVBh","import-button-wrapper":"import-file-content-import-button-wrapper-1UM3D","import-button-large-line":"import-file-content-import-button-large-line-3KOuv","import-button-small-line":"import-file-content-import-button-small-line-3sea_"}},"3a2def422a":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),c=(n("6e20b6a7d8"),n("5cdbac46e8")),s=n("b684da8955"),l=function(){function e(){i()(this,e)}return o()(e,null,[{key:"selectable",value:function(e){return e.selectable&&e.currentEditState<=c.b.SELECTABLE}},{key:"editable",value:function(e){return e.currentEditState===c.b.EDITABLE}},{key:"draggable",value:function(e){return e.currentEditState===c.b.EDITABLE}},{key:"sizeInfo",value:function(e){var t=e.props.style;return{width:t.width,height:t.height,left:t.left,top:t.top,centerX:t.width/2+t.left,centerY:t.height/2+t.top}}},{key:"sizeInfoOnSlide",value:function(e){var t,n=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).frameOnSlide();return{width:n.width,height:n.height,left:n.left,top:n.top,centerX:n.width/2+n.left,centerY:n.height/2+n.top}}},{key:"flipInfo",value:function(e){var t=e.props.style;return{flipH:void 0===t.flipH?0:t.flipH,flipV:void 0===t.flipV?0:t.flipV}}},{key:"flipInfoOnSlide",value:function(e){var t,n=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).frameOnSlide();return{flipH:void 0===n.flipH?0:n.flipH,flipV:void 0===n.flipV?0:n.flipV}}},{key:"getOffsetWithRelative",value:function(e,t,n){var r=t,i=n;if(e){if(e.relativeRotate){var a=e.relativeRotate%360*Math.PI/180,o=Math.cos(a),c=Math.sin(a),s=i*o-r*c;r=r*o+i*c,i=s}1===e.relativeFlipH&&(r=-r),1===e.relativeFlipV&&(i=-i)}return{offsetX:r,offsetY:i}}},{key:"getGroupChildrenDirections",value:function(e){return e.map((function(e){var t=1;return Object(s.a)(e,(function(e){var n=e.getFrame().getFrameInfo();n.flipH!==n.flipV&&(t*=-1)})),t}))}}]),e}()},"4399df1885":function(e,t,n){"use strict";n.r(t),n.d(t,"LiveManagerInjectable",(function(){return s}));var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),c=n("e0a67dc3fe"),s=function(){function e(){i()(this,e)}return o()(e,[{key:"enableLive",value:function(){return Object(c.b)("titlebar.remotePlay",!1)}}]),e}()},"45608c2f56":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("382929c8da"),i=n("e0e8dd9366"),a=1;function o(e,t){var n,o,c=t.props.style.image;e[r.a.REGULATE]={contrast:null==c?void 0:c.contrast,brightness:null==c?void 0:c.brightness,sharpenSoften:null==c?void 0:c.sharpenSoften},e[r.a.PICTURE_COLOR]={saturate:null==c?void 0:c.saturate,colorTemperature:null==c?void 0:c.colorTemperature};var s=t.getBackgroundFill().getFillInfo(),l=t.type===i.d.SHAPE?null!==(n=null==s||null===(o=s.image)||void 0===o?void 0:o.alpha)&&void 0!==n?n:a:t.props.style.alpha;e[r.a.INSERT_PICTURE]={alpha:l}}},"457452e346":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.IMAGE_PNG="image/png",e.IMAGE_JPEG="image/jpeg",e.IMAGE_GIF="image/gif",e.IMAGE_BMP="image/bmp",e.IMAGE_SVG_XML="image/svg+xml",e.HTML="text/html",e.TEXT="text/plain"}(r||(r={}))},"4c94f9c8ed":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return L}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var r=n("176815363d"),i=n.n(r),a=n("9b674918eb"),o=n.n(a),c=n("9132715560"),s=n.n(c),l=n("6a364eb35c"),u=n.n(l),d=n("547611bd96"),f=n.n(d),p=n("8eec1e4a03"),v=n.n(p),h=n("bd29e2df90"),g=n.n(h),m=n("ab5eb40518"),b=n.n(m),y=n("1b4cdd6a36"),E=n.n(y),S=n("85d0a7609b"),w=n.n(S),O=n("3ef2352f0b"),T=n.n(O),I=(n("c6244f7705"),n("081c8cafea"),n("1bab7b5fb7"),n("9d7978d445"),n("433247001a"),n("bd80bf2d0f"),n("3bf1976a4f"),n("b1e2246d82"),n("af802ec74b"),n("d0054b9d0b"));var R=n("d3d31c86eb"),C=n("1f4b665603"),x=n("27b6d7435d"),A=n("f8fc8e0087"),k=n("144183c5db"),P=n("3d781306f0"),M=["stages"];function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var L=function(e){g()(r,e);var t,n=N(r);function r(e){var t;s()(this,r),t=n.call(this),w()(f()(t),"moduleName","slideMeetingRoom"),w()(f()(t),"_docType",void 0),w()(f()(t),"_roomDocId",void 0),w()(f()(t),"_myRoom",void 0),w()(f()(t),"playerStateMgr",void 0),t.liveManagerInjectable=e;return t._liveInfo={state:C.LiveState.None,points:"",name:"",page:1,fragment:1,allow_flip:C.AllowFlipState.YES,revision:0,confid:"0",confmsg:JSON.stringify({allMute:0,muteList:[]})},t._docType=k.a.SLIDE,t}return u()(r,[{key:"closeAndStopLive",value:function(){var e=this;return new Promise((function(t){if(e.roomInfo().roomid){var n=function n(){t(),e.event.off(C.LiveSocketShutDown,n)};return e.event.on(C.LiveSocketShutDown,n),e.liveEnd(),e.closeShowRoom(),void setTimeout((function(){t(),e.event.off(C.LiveSocketShutDown,n)}),500)}t()}))}},{key:"handleSocketShutDown",value:function(e){v()(E()(r.prototype),"handleSocketShutDown",this).call(this,e),this._roomInfo=null}},{key:"roomDocId",set:function(e){this._roomDocId=e}},{key:"liveInfo",get:function(){return this._liveInfo}},{key:"role",get:function(){return this._role}},{key:"docID",get:function(){if(this._roomDocId)return this._roomDocId;var e=this.getDocId();return e||(e=window.location.pathname.split("/").pop()||""),e}},{key:"getDocId",value:function(){var e,t;return null!==(e=null===(t=new RegExp("/meetingroom/player/slide/([^/]+?)/?$").exec(location.pathname))||void 0===t?void 0:t[1])&&void 0!==e?e:Object(A.getQuery)("docId")}},{key:"shareUrl",get:function(){var e=this.roomInfo().roomid||0,t=window.location.hostname;return this._docType!==k.a.SLIDE?"https://".concat(t,"/meetingroom/").concat(e,"?docID=").concat(this.docID,"&docType=").concat(this._docType):"https://".concat(t,"/meetingroom/player/slide/").concat(this.docID,"?roomId=").concat(e,"&sceneSource=MeetingRoom")}},{key:"setMeetingRoomHelper",value:function(e){this.playerStateMgr=e}},{key:"enableLive",get:function(){return this.liveManagerInjectable.enableLive()}},{key:"liveBegin",value:function(e){var t,n,i,a,o,c,s,l,u,d;(window.addEventListener("masterPenUpdated",this.onLaserPenMoved.bind(this)),this.emitPenMsg(),e)?(c=(null===(l=(u=window).pray)||void 0===l||null===(d=l.call(u))||void 0===d?void 0:d.editorCurrentSlideIndex)+1,s=1):(c=1,s=1);var f=null===(t=window)||void 0===t||null===(n=t.clientVars)||void 0===n||null===(i=n.userInfo)||void 0===i?void 0:i.nick;f&&(this._liveInfo.name=f);var p=(null===(a=window)||void 0===a||null===(o=a.playerInitData)||void 0===o?void 0:o.rev)||0;return this._liveInfo.revision=p,this.sendLiveMessage("REVISION"),this._liveInfo.page=c,this._liveInfo.fragment=s,v()(E()(r.prototype),"liveBegin",this).call(this,{isFromCurrent:e}),this.GotoPage(),this.turnAnnotation(!1),Object(R.c)({opername:"doc_ppt",module:"remote_initiate",action:"en_play",ver10:"new_menubar"}),!0}},{key:"liveEnd",value:function(){console.log("live end play.");var e=this.memberCount,t=e>0?e-1:0;Object(R.c)({opername:"doc_ppt",module:"remote_initiate",action:"en_uv",ver5:t}),v()(E()(r.prototype),"liveEnd",this).call(this)}},{key:"onLaserPenMoved",value:function(e){if(this.role===C.LiveRoleType.Master){var t=e.detail,n=t.X,r=t.Y,i=t.W,a=t.H,o=t.p,c=t.f,s=this.playerStateMgr.playerState.scale,l=n-i/2,u=r-a/2,d={X:Math.round(l/s),Y:Math.round(u/s),p:o,f:c,ts:(new Date).getTime()};null!==o.X&&null!==o.Y?this.penQ.push(d):console.log("Invalid Pen Data",e.detail)}}},{key:"onLaserPenMovedV2",value:function(e){var t={X:e.X,Y:e.Y,ts:Date.now()};this.penQ.push(t)}},{key:"emitPenMsg",value:function(){this._liveInfo.state===C.LiveState.OnAir&&this.playerStateMgr.playerState.laserTurnOn&&Array.isArray(this.penQ)&&this.penQ.length>0&&(this.sendLaserPoint(this.penQ),this.penQ=[]);var e=this.penCmdQ.shift();e&&e.cmd&&this.sendLaserPoint([e]),this.resetPenTimer(),this.timerPen=window.setTimeout(this.emitPenMsg.bind(this),500)}},{key:"GotoPage",value:function(){var e=this.playerStateMgr.playerState;if(e&&this._role===C.LiveRoleType.Master){console.log("live GotoPage: ".concat(e.currentPage));var t=e.currentPage||0,n=e.currentFragment||0,r=e.iaFragmentInfo||{};this._liveInfo.page=t+1,this._liveInfo.fragment=n+1,this._liveInfo.iaFragmentInfo=r,this._liveInfo.shouldStopMainAnim=e.shouldStopMainAnim,this._liveInfo.shouldStopTransition=e.shouldStopTransition,this._liveInfo.isLoadPageBySwitchForward=e.isLoadPageBySwitchForward,this.sendLiveMessage("PAGE")}else console.log("live GotoPage failed")}},{key:"sendMediaLiveMsg",value:function(e){this._role===C.LiveRoleType.Master&&(this._liveInfo.media=e,this.sendLiveMessage("MEDIA"))}},{key:"turnAnnotation",value:function(e){e?this._liveInfo.extra||(this._liveInfo.extra="{}"):this._liveInfo.extra="",this._liveInfo.boardMessage={action:"TURN_ANNOTATION",enable:e},this.sendLiveMessage("BOARD")}},{key:"sendBoardMessage",value:function(e){var t=e.stages,n=o()(e,M);t&&(this._liveInfo.extra=JSON.stringify(t)),this._liveInfo.boardMessage=n,this.sendLiveMessage("BOARD")}},{key:"setAllowFlip",value:function(e){console.log("live setAllowFlip：".concat(e)),this._liveInfo.allow_flip=e?C.AllowFlipState.YES:C.AllowFlipState.NO,this.sendLiveMessage("ALLOWFLIP")}},{key:"checkIsMyRoom",value:function(e,t){var n=this;return new Promise((function(r){n._myRoom&&n._myRoom.roomid===t?(console.log("room id: ".concat(n._myRoom.roomid,"url room:").concat(t)),r(!0)):n.getShowRequest(e).then((function(e){e.data&&e.data.hasOwnProperty("retcode")&&0===e.data.retcode?(n._myRoom=Object.assign({},n._myRoom,e.data.result),console.log("get show room id: ".concat(n._myRoom.roomid,"url room:").concat(t)),r(n._myRoom&&n._myRoom.roomid===t)):r(!1)})).catch((function(e){console.error(e),r(!1)}))}))}},{key:"showInvite",value:function(e,t){!function(e,t){I.a.load("LiveInvite",(function(n){n.show(e,t)}))}(e,t)}},{key:"init",value:function(){v()(E()(r.prototype),"init",this).call(this)}},{key:"setAllowFlipState",value:function(e){v()(E()(r.prototype),"setAllowFlipState",this).call(this,e),Object(R.c)({opername:"doc_ppt",module:"remote_watch",action:this._liveInfo.allow_flip===C.AllowFlipState.YES?"report":"m_report"})}},{key:"allowFlip",value:function(){return this._liveInfo.allow_flip===C.AllowFlipState.YES}},{key:"userId",get:function(){var e,t,n,r,i,a,o,c,s;return console.debug("[userId]",null===(e=window.clientVars)||void 0===e?void 0:e.userId,null===(t=window.basicClientVars)||void 0===t||null===(n=t.userInfo)||void 0===n?void 0:n.userId,null===(r=window.playerInitData)||void 0===r?void 0:r.userId),null!==(i=(null===(a=window.clientVars)||void 0===a?void 0:a.userId)||(null===(o=window.basicClientVars)||void 0===o||null===(c=o.userInfo)||void 0===c?void 0:c.userId)||(null===(s=window.playerInitData)||void 0===s?void 0:s.userId))&&void 0!==i?i:""}},{key:"playerInitData",get:function(){var e=window,t=e&&e.clientVars,n=t&&t.collab_client_vars;return n||(e.playerInitData?e.playerInitData:{})}},{key:"serverVars",get:function(){return{padId:void 0,globalPadId:void 0,pver:void 0,gray:void 0,appid:void 0,wmode:void 0,client:{upid:void 0,sid:void 0,tid:void 0,sig:void 0}}}},{key:"audienceServerVars",get:function(){return{padId:void 0,globalPadId:void 0,pver:void 0,gray:void 0,appid:void 0,wmode:void 0,userId:this.playerInitData.userId,client:{upid:void 0,sid:void 0,tid:void 0,sig:void 0}}}},{key:"getUserInfos",value:(t=i()(T.a.mark((function e(t){var n,r,i,a,o;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null!==(n=null===(r=window.playerInitData)||void 0===r?void 0:r.globalPadId)&&void 0!==n?n:null===(i=window.clientVars)||void 0===i?void 0:i.globalPadId,e.next=3,Object(P.d)(t,a);case 3:return o=e.sent,e.abrupt("return",null!=o&&o);case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"getNickname",value:function(){var e,t,n;return null===(e=window)||void 0===e||null===(t=e.clientVars)||void 0===t||null===(n=t.userInfo)||void 0===n?void 0:n.nick}},{key:"handleRoomNewInfo",value:function(e){v()(E()(r.prototype),"handleRoomNewInfo",this).call(this,e),this._role===C.LiveRoleType.Audience&&Object(R.c)({opername:"doc_ppt",module:"remote_watch",action:this._liveInfo.allow_flip?"report":"m_report"})}},{key:"isManulFlipped",get:function(){return!!this.playerStateMgr&&this.playerStateMgr.playerState.isManulFlipped}},{key:"getAsyncInfo",get:function(){if(this._role===C.LiveRoleType.Audience&&this.isManulFlipped&&this._liveInfo.state===C.LiveState.OnAir){var e=this.masterName;e=(e=Object(x.b)(e)).length>4?"".concat(e.substr(0,4),"..."):e;var t=this._liveInfo.page;switch(this._docType){case k.a.SLIDE:case k.a.PDF:return t-1===this.playerStateMgr.playerState.pageCount?"".concat(e," 已演示到结束页"):"".concat(e," 正在演示第").concat(t,"页");case k.a.DOC:return"前往正在演示内容"}}return""}},{key:"setDocType",value:function(e){this._docType=e}},{key:"targetPosition",value:function(){var e=v()(E()(r.prototype),"targetPosition",this).call(this);return _(_({},e),{},{stopT:this.liveInfo.shouldStopTransition})}}]),r}(C.LiveCore)},"52ba91852f":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABGCAMAAABG8BK2AAAAjVBMVEUAAAD+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGwn6tPGAAAALnRSTlMA+usafCADw7BGMgr2lI8s7tafaScQ5avz3s6INweCWk5UvG1eFLendnBkQceZF/4aQwAAAqpJREFUWMO1l9eSozAQRSWRo8nRYBzH8f7/5y3FsDteygSh3fsgHtQc1M1VVzWZV1UREalm6F58jwLU8y9uaKr8jPNd9/AtSvEtlt5jLoiRUgB5cDSiuGrTiiPjFuQAaPpYDGkKgF7uChlIuR8oUDSLIBsNYLX0eVOqGaBtZiGWS8Fu1UTAjYG61sxR/DZmpo6xS+FPHuhkwzfJrEwf9ml8WwZei7xmvQB5zG4OaEgW6kjhfN5pKXuyWPsRjgxqcFmU4vqhut1ZeLQDdmSgyEZIOHVEFg1K7yMg3ApQ/O1DF77Fj7F8lH/5idItWaEtpe9u1eCOx2ra+J6Dw9u/A5u4R8BEd/Pw04CekMk6DJF/jrOFF6/FWB5+V/ULJVmLISWCHmhDWY+JYFu9qTWyHkOe2PU5HUUwN3x1bcaDIoKJwLr2i5yIYEiCqOsQqRgm7YrjQhbDyKjbVcdODLPv0ilgimFMFF2FJDGMhKRdM1himBheHyWEUUHblYpiLGTtyhAL1qazcS5a4gj5v/jhWzw7++3FMLvuipeil6HuACfoQpg+nQiJGIZB+X5sRDCb/hgBrpNxmjbTJ4L+ohdEQAWa7lllM1nN5ORVpNMLznqMA+cP0JbWlvhs/6Sio1yLKZG+3YpMIquk2DDfjZiugQxfVDIYayjNII0rkpifIiUD56oadG6KeoCmDsAMJS+mBJM+jAAhH+X4ccgIQXc8lBM+f7cGvS+nhBTy6HBXqwurWwLyxMh2OS+hnC+Tg6DhIWkWuC4Bm7Sr8gR0ZeYe6YA2E6NebdiONAFx2oDbfAmVFKDByFz0CCjwpZAlMnUAeb1VBwfd1jkA3SRLFbkMQHZww4epnGNp8widQwaAuRHhUWW8cgzkO4ZK+CU1cqAVOfMSXwvkRiL/Xb8AU4ZKfa/CHkQAAAAASUVORK5CYII="},"55d5f8a022":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,i,a=n("85d0a7609b"),o=n.n(a),c=(n("1bab7b5fb7"),n("9d7978d445"),n("75563bc376"),n("8ee19818c4"),n("6e20b6a7d8"),n("342844cefa"),n("8a35b54c1d"),n("0acdc5834b"),n("3bf1976a4f"),n("382929c8da")),s=n("51b2ea9953"),l=n("14c02e2331"),u=n("d5c3deb8c7"),d=n("45608c2f56"),f=n("8897cfe637"),p=n("c2f805291c"),v=n("0442e400dc"),h=(r={},o()(r,c.a.BOLD,!1),o()(r,c.a.ITALIC,!1),o()(r,c.a.UNDERLINE,!1),o()(r,c.a.DELETELINE,!1),o()(r,c.a.TEXT_INDENT,0),o()(r,c.a.SUBSCRIPT,!1),o()(r,c.a.SUPERSCRIPT,!1),o()(r,c.a.COLUMN_NUMBER,f.c),o()(r,c.a.COLUMN_SPACE,f.d),r),g=[c.a.BOLD,c.a.ITALIC,c.a.UNDERLINE,c.a.DELETELINE,c.a.FORECOLOR,c.a.BACKCOLOR,c.a.VERTICAL_ALIGN,c.a.HORIZONTAL_ALIGN,v.a.HORIZONTAL_LEFT,v.a.HORIZONTAL_RIGHT,v.a.HORIZONTAL_CENTER,v.a.HORIZONTAL_JUSTIFY,v.a.HORIZONTAL_DISTRIBUTE,c.a.FONTSIZE,c.a.FONTSIZE_UP,c.a.FONTSIZE_DOWN,c.a.FONT,c.a.ROW_SPACE,c.a.LINE_HEIGHT_IS,c.a.ROW_SPACE_ABSOLUTE,c.a.ITEMNUMBER,c.a.DIGITNUMBER,c.a.BULLET_COLOR,c.a.BULLET_SIZE,c.a.BULLET_START_NUMBER,c.a.BULLET_CUSTOM_TEXT,c.a.BULLET_CUSTOM_IMAGE,c.a.INDENT,c.a.TEXT_INDENT,c.a.ENTER_EDITOR,c.a.UNDO,c.a.REDO,c.a.LINK,c.a.TEXT_ADJUST,c.a.MARGIN_LEFT,c.a.SPACE_BEFORE,c.a.SPACE_AFTER,c.a.TAB_LIST,c.a.TAB_SIZE,c.a.PADDING_ADJUST,v.b.INDENT_INCREASE,v.b.INDENT_REDUCE,c.a.FONT_EFFECT,c.a.FONT_FILL,c.a.FONT_BORDER],m=(i={fontWeight:function(e){return{id:c.a.BOLD,value:"bold"===e}},fontStyle:function(e){return{id:c.a.ITALIC,value:"italic"===e}},textDecoration:function(e){return{id:c.a.UNDERLINE,value:"underline"===e}},del:function(e){return{id:c.a.DELETELINE,value:"sng"===e}}},o()(i,l.x,(function(e){return e>0?{id:c.a.SUPERSCRIPT,value:!0}:e<0?{id:c.a.SUBSCRIPT,value:!0}:{}})),o()(i,"fontSize",(function(e){return{id:c.a.FONTSIZE,value:"font-size-".concat(e,"pt")}})),o()(i,"fontFamily",(function(e){var t=(null==e?void 0:e.split(","))||"";return t.length&&(t=t[0]),{id:c.a.FONT,value:t}})),o()(i,"color",(function(e){return{id:c.a.FORECOLOR,value:e}})),o()(i,"backgroundColor",(function(e){return{id:c.a.BACKCOLOR,value:e}})),o()(i,"alignItems",(function(e){return{id:c.a.VERTICAL_ALIGN,value:function(e){switch(e){case"flex-start":return v.a.VERTICAL_TOP;case"center":return v.a.VERTICAL_CENTER;case"flex-end":return v.a.VERTICAL_BOTTOM;default:return}}(e)}})),o()(i,"textAlign",(function(e){return{id:c.a.HORIZONTAL_ALIGN,value:function(e){switch(e){case"left":return v.a.HORIZONTAL_LEFT;case"center":return v.a.HORIZONTAL_CENTER;case"right":return v.a.HORIZONTAL_RIGHT;case"justify":return v.a.HORIZONTAL_JUSTIFY;case"distribute":return v.a.HORIZONTAL_DISTRIBUTE;default:return}}(e)}})),o()(i,"PPTLineHeight",(function(e){return{id:c.a.ROW_SPACE,value:e}})),o()(i,"lineHeight",(function(e){return{id:c.a.ROW_SPACE_ABSOLUTE,value:e}})),o()(i,"lineHeightIs",(function(e){return{id:c.a.LINE_HEIGHT_IS,value:e}})),o()(i,"marginLeft",(function(e){return{id:c.a.MARGIN_LEFT,value:e}})),o()(i,"textIndent",(function(e){return{id:c.a.TEXT_INDENT,value:e}})),o()(i,"paraPaddingTop",(function(e){return{id:c.a.SPACE_BEFORE,value:e}})),o()(i,"paraPaddingBottom",(function(e){return{id:c.a.SPACE_AFTER,value:e}})),o()(i,"tabList",(function(e){return{id:c.a.TAB_LIST,value:Object(u.p)(e)?Object(u.v)(e):e}})),o()(i,"tabSize",(function(e){return{id:c.a.TAB_SIZE,value:e}})),o()(i,"buClr",(function(e){return null!=e&&e.color?{id:c.a.BULLET_COLOR,value:null==e?void 0:e.color}:{}})),o()(i,"buSzPct",(function(e){return"number"==typeof e?{id:c.a.BULLET_SIZE,value:e}:{}})),o()(i,"buAutoNum",(function(e){var t=e||{},n=t.startAt,r=t.type,i=[];return n&&i.push({id:c.a.BULLET_START_NUMBER,value:n}),r&&i.push({id:c.a.DIGITNUMBER,value:r}),i})),o()(i,"character_bullet_char",(function(e,t){if(e){var n;if("multi"===e)return{};var r=t.find((function(e){return"buFont"===e.id})),i=null==r||null===(n=r.value)||void 0===n?void 0:n.typeface;if(i){var a=p.a.find((function(t){return t.typeface===i&&t.character_bullet_char===e}));if(a)return{id:c.a.ITEMNUMBER,value:a.type}}return{id:c.a.BULLET_CUSTOM_TEXT,value:e}}})),o()(i,"buBlip",(function(e){var t;return null!=e&&null!==(t=e.blip)&&void 0!==t&&t.src?{id:c.a.BULLET_CUSTOM_IMAGE,value:null==e?void 0:e.blip.src}:{}})),o()(i,c.a.TEXT_ADJUST,(function(e){return{id:c.a.TEXT_ADJUST,value:e}})),o()(i,"effect",(function(e){return{id:c.a.FONT_EFFECT,value:e}})),o()(i,c.a.FONT_FILL,(function(e){return{id:c.a.FONT_FILL,value:Object(u.p)(e)?Object(u.v)(e):e}})),o()(i,"border",(function(e){return{id:c.a.FONT_BORDER,value:Object(u.p)(e)?Object(u.v)(e):e}})),o()(i,c.a.COLUMN_NUMBER,(function(e){return{id:c.a.COLUMN_NUMBER,value:e}})),o()(i,c.a.COLUMN_SPACE,(function(e){return{id:c.a.COLUMN_SPACE,value:e}})),o()(i,"tdColor",(function(e){return{id:c.a.FONT_THEME_COLOR,value:e}})),i);function b(e){var t,n,r,i,a,o,u,f,p,v,b=function(e){var t,n,r=e.selectionStyles||{};return!e.editorInstance||null!==(t=e.editorInstance)&&void 0!==t&&t.isEditing||(r=(null===(n=e.editorInstance)||void 0===n?void 0:n.getAllStylesSync())||{}),["alignItems","backgroundColor","displayFontSize","fonts","rawFontSize","textDecoration",l.x].forEach((function(e){"multi"===r[e]&&delete r[e]})),Object.keys(r).map((function(e){return{id:e,value:r[e]}}))}(e),y=(v=b).filter((function(e){return m[e.id]})).reduce((function(e,t){var n,r,i=m[t.id](t.value,v);return i||null===(n=window)||void 0===n||null===(r=n.log)||void 0===r||r.error("[Data Error] convertStyleToMenu to null, raw style: ".concat(JSON.stringify(t))),Array.isArray(i)?e.concat(i):e.concat([i])}),[]).filter((function(e){return e})),E={};return y.forEach((function(e){E[e.id]=e.value})),E[c.a.SIZE_ADJUST]=e.getLock().getLockInfo(),E[c.a.FILLCOLOR]=null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillInfo(),E[c.a.EFFECT]=null===(n=e.getEffect)||void 0===n?void 0:n.call(e).getEffectCollection(),E[c.a.BORDERCOLOR]=null===(r=e.getBorder)||void 0===r?void 0:r.call(e).getBorderInfo(),E[c.a.TEXT_ADJUST]={autoFitType:(null==e||null===(i=e.textBodyStyle)||void 0===i?void 0:i.autoFitType)||s.a.NO_AUTO_FIT,autoBreakType:(null==e||null===(a=e.textBodyStyle)||void 0===a||null===(o=a.bodyStyle)||void 0===o?void 0:o.whiteSpace)||s.g.WRAP,rawData:null==e||null===(u=e.textBodyStyle)||void 0===u?void 0:u.bodyStyle},E[c.a.TEXT_DIRECTION]=(null==e||null===(f=e.textBodyStyle)||void 0===f||null===(p=f.wrapperStyle)||void 0===p?void 0:p.textDirection)||s.d.HORIZONTAL,g.forEach((function(e){E[e]=E[e]||void 0})),Object.keys(h).forEach((function(e){void 0===E[e]&&(E[e]=h[e])})),Object(d.a)(E,e),E}},"59087c860a":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.ENTER_LINK_EDIT="enterLinkEdit",e.ENTER_ELEMENT="enterElement",e.LEAVE_ELEMENT="leaveElement",e.LINK_CLICK="linkClick"}(r||(r={}))},"5cf98436e9":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));n("b8217400dc"),n("e6f68cdf2e");var r=n("e0e8dd9366"),i=n("55d5f8a022");var a=n("14502724a6"),o=n.n(a),c=(n("8ee19818c4"),n("7d1df7d0fb")),s=n("382929c8da"),l=n("310c0b6a04"),u=n("d5c3deb8c7"),d=n("f9193d718f"),f=n("086c96a9ce"),p=n("2ba7871556"),v=n("45608c2f56");function h(e){var t,n,r,i=null===(t=null===(r=d.a.getInstance().getAppServices().editableServiceLayer)||void 0===r?void 0:r.menuManager)||void 0===t?void 0:t.mergeMenuValuesCacheMap.get(e);if(i)return i;if(null!==(n=e.children)&&void 0!==n&&n.length&&e.isRootGroup){var a,h=Object(c.a)(e,!0),g=[];u.w((function(){null==h||h.forEach((function(e){var t=Object(f.c)(e);!function(e,t){e.forEach((function(e){delete t[e]}))}([p.a],t),g.push(t)}))}));var m=Object(c.c)(g,Object(c.b)(h));(m[s.a.SIZE_ADJUST]||e.props[l.b.LOCKS])&&(m[s.a.SIZE_ADJUST]=e.getLock().getLockInfo());var b=Object(f.b)(e),y=o()(b,1)[0];return y&&Object(v.a)(m,y),m[p.a]=null!==(a=e.getBackgroundFill().getFillInfo())&&void 0!==a?a:void 0,m}return{}}var g=n("85d0a7609b"),m=n.n(g);n("75563bc376");function b(e){if(e.selectedModels){var t,n=null===(t=null===(g=d.a.getInstance().getAppServices().editableServiceLayer)||void 0===g?void 0:g.menuManager)||void 0===t?void 0:t.mergeMenuValuesCacheMap.get(e);if(n)return n;var i=[];u.w((function(){e.selectedModels.forEach((function(e){e.type===r.d.GROUP?i.push(h(e)):e.type!==r.d.TABLE&&i.push(Object(f.c)(e))})),e.selectedModels.every((function(e){return e.type===r.d.SHAPE}))&&(i.push(m()({},s.a.FONTSIZE_INCREASE,void 0)),i.push(m()({},s.a.FONTSIZE_UP,void 0)))}));var a=Object(c.c)(i,Object(c.b)(e.selectedModels));e.selectedModels.find((function(e){return e.type!==r.d.TABLE}))&&(a[s.a.PARAGRAPH_MORE]=1);var l=Object(f.b)(e),p=o()(l,1)[0];return p&&Object(v.a)(a,p),a}var g;return{}}function y(e){return e?f.a.includes(e.type)?Object(f.c)(e):[r.d.NOTE].includes(e.type)?function(e){return i.a(e.noteTextBody)}(e):[r.d.GROUP].includes(e.type)?h(e):[r.d.MULTIPLY].includes(e.type)?b(e):{}:{}}},"5ef200d392":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAACMCAMAAACZHrEMAAAAjVBMVEUAAAD+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGz+bGwn6tPGAAAALnRSTlMASfQD/N0j5xALBtf48HdBNC5xWcyvnO3iTzrHHbmhabSofmMUkSiXGcBf0ImFPoEHLQAABhlJREFUeNrtnNmWmkAQhot9jYIoAiqiKKKj/f6Pl1TjdDCDo2zdOTn5rpw5oj+19obwr2GZB9O0QChraXZcrLQf5M4PbbU4bqU1cOYQX88oopHl+RqbwAd7ev0gL5nfpgqMjCKFS/In8vIX8lcLhaPqKa5GXcMq3AdJcWC+K5JgH67q7jOuOoyDdCafqPNj8PRr9OD0obK3bqThzaPkDjN/GpgvIzxImTudizKslIv2mb+pZL8Z6FIqf8oJBpQjfVpllVvQAitfkYqPKQyDnt0DZedBa5LFPXwW+hAemsiVlFDveC9pJUee9faVfy9wux43VuzuhdCHXszcKlYS6EUyJ4i77dOCNlUG5f2dva1qYXaAjnhRFXrlID2+SoPIg05cXGqWCwxELlNXBdCBfRUtOgyGXkXOvr2TU4KcbBgQOyRIqLS8bEFNmsPAbFVaJ1rdokXTaDmFwZFoVmUt1NhUS1TACPhGOzUK9ZG2hlHQNeqpd+OGxq5TwkisqZoTvMVkPLvU1UzgDQIaL2sYEZ2W9gBe4stYdn0YFR9zSn75JSaa0J3CyEgqhqUJ30Pb2RZGZ0ZT6kWFpOUaOEBTNodvKDBg5jZwwPrAsNHhKcqKvWFcWKacXzgyB05svw3PNWrNgBsbLCLPCtoOnbQGbuh48yk0knTOaskwJGgJazweNDHHaagCHTAIMaADtoMDW2ggRpndSi9eCV2Q8MoGoyqY9wvgJ4bF8Ly5Was+bzEeXhrDn6xor+AtBhZNlW+KH+jzFcNMkzQo3AB/MbD56pFSxVQSIQYTyj18KT8OiBADOJqbff2PEDFf7eBRW4kRU6p/pM6VFjz+YlgI3+A3Ec4cRInJcZoGDB/HDpYoMSYuShUPMZSBKDGwecieMw5kxImZ1QuujXbSxYkpMEqU2hAvAnFiwMABXy1kdiLFLDBoaq+3IsXMatbQ0EoixSQ4+gaKpRKiWiLFWNiNbNaYNBAlhnUAn41+F2LFYNmLWTIdxYo5snQ64SuRYur2WKCNxIoJWG6vcPgrVsyUTVgc7OBixXis0ODWfClWjM66I67JmmLFHMjnOgYu2VhixZi4hlX7KKFisB/If4sYapm/z01/QQCXLICNvyO1NVb0fPFFbw7IWXw7kHCywhplIFbMBRslG0xMxIrBow5XNjY/iRUTsvlJjA4TKwbDVmJrEJFYMUs2v1Zwqn0QKWZdm2x/YG6LFCPV9jNSTCeRYjCZwtr+3EKkmE21G8kieClQjCLXRuEK9m1PnJikbgzaEPbixNxYM0Dy2j4Lx23B+n7k5SHP1bJHahqR1K/KkPJR2xYEMaFV5vHvMwgCLTF7HPZhcxCCj9+9/nOH8gpCODKv1PPJsEEA1vLLQNOSaXoJAM2wtOCBExuf8zsLgShOwyKeruJgi3/Ri7HErZuWzFf82wHm9a75wIrEW0z85NBKhlGj8HMTi5jFs4MAOd/etH16GmSHtcYEjpjLp+ecdJdmGUdO3xzyuqHREuDG9Luz9laEJwG4NQULo1ezns9fePbL04tDXmlVbLggvTrTaqKjjBI4sF6ik8xvY0rFrsAhbOz5G9lyZSffxyV856kV5Uza7oV1Pki5UeAFhwjtF8OoBKhFO8BLPBnr4hRGRHLfPsEfq6gmgdGYymh8qcUR5h9jqUEtbeaMezKipyS5ZYpc2dNrgxO4rR9FuxFkAoOz7/JY3IQg4cC12E4JMuv29Np8DQOiz6n7866BtoxhMOIlTdNOieFrBDlZMAhWSBDN7/XorTZIjkvVrWUmdETZq1UcH6AnZRW56h56kFT382Nm90qi2Y/Kxh70wgwJRQuUvr9WoA4QfVOn108Y2JfP65NBKtVEJpRoZrY27CQiFHkyVP0sQ/X+kWErryfp/TbUsIThKHYoB3H2BbyFf9NIhZrqMCxF6JI72lF6EYqWdEIlFPdUwPCUN6P+yyYXz2yMMP9yrP2uSbQ/wDgoceaSGsY5nFzixCt0vfCSOJ+cMqf+BnchKTAiZr5xyVu42cWE0bHik0Ne4GBY8eIQ37KINBJlt7gE7phePDum2WruaJozX2XpcRJ4JvxneH4CP1lGMpcsAC0AAAAASUVORK5CYII="},"617779fa67":function(e,t,n){"use strict";n.r(t),n.d(t,"DRAWER_HEIGHT",(function(){return R})),n.d(t,"DrawerStateManager",(function(){return C}));var r,i,a=n("1f925d7f50"),o=n.n(a),c=n("9132715560"),s=n.n(c),l=n("6a364eb35c"),u=n.n(l),d=n("85d0a7609b"),f=n.n(d),p=n("2dc700e1e6"),v=n.n(p),h=(n("f1054791f4"),n("8ee19818c4"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("f27f5f5885")),g=n("6884e1a126"),m=n("432f93125e"),b=n("6a9e93341e"),y=n("0a8ecd6412"),E=n("d5c3deb8c7"),S=n("77c89fc0e0"),w=n("7f21889145");function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=[h.b.SLIDE_PROPERTY_DRAWER,h.b.ANIMATION_RIGHT_DRAWER,h.b.SELECT_WINDOW_RIGHT_DRAWER],R="100%",C=(r=function(){function e(){var t=this;s()(this,e),o()(this,"isDrawerMenuShown",i,this),f()(this,"drawerService",void 0),f()(this,"showHolderTimeout",void 0),f()(this,"showDrawerTimeout",void 0),f()(this,"services",void 0),f()(this,"closeRightDrawer",(function(e){var n,r,i,a,o=!1;if([{type:h.b.SLIDE_PROPERTY_DRAWER,state:null===(n=t.services.rightSideBarManager)||void 0===n?void 0:n.isPropertyEditorShown},{type:h.b.ANIMATION_RIGHT_DRAWER,state:null===(r=t.services.rightSideBarManager)||void 0===r?void 0:r.isAnimationEditorShown},{type:h.b.SLIDE_RATING_DRAWER,state:null===(i=t.services.rightSideBarManager)||void 0===i?void 0:i.isSlideRatingShown},{type:h.b.SELECT_WINDOW_RIGHT_DRAWER,state:null===(a=t.services.rightSideBarManager)||void 0===a?void 0:a.isSelectWindowShown}].forEach((function(t){t.type!==e&&(o=t.state||o)})),!o){if(t.handleDrawerHolderVisiable(!1),!t.drawerService.isRightOpening(e)&&t.drawerService.isRightOpening())return;t.drawerService.closeRightDrawer()}})),f()(this,"handleDrawerHolderVisiable",(function(e){var n=document.getElementById("slide-drawer-holder");n&&(e?t.showHolderTimeout=setTimeout((function(){n.style.display="flex",n.style.width="".concat(t.getDrawerWidth(),"px"),clearTimeout(t.showHolderTimeout),w.default.getInstance().updateAnchorRect()}),100):n.style.display="none")})),f()(this,"updateDrawerHolderStyle",(function(){var e=document.getElementById("slide-drawer-holder");e&&(e.style.width="".concat(t.getDrawerWidth(),"px"))})),f()(this,"resetSelectWindowActions",(function(){t.services.rightSideBarManager&&t.services.rightSideBarManager.setSelectWindowShowAction(y.t.NONE)})),f()(this,"getDrawerWidth",(function(){var e;return null!==(e=t.services.rightSideBarManager)&&void 0!==e&&e.isSelectWindowShown?t.services.rightSideBarManager.selectWindowWidth:b.d})),f()(this,"handleAddonDrawerAfterOpened",(function(){clearTimeout(t.showDrawerTimeout),t.showDrawerTimeout=setTimeout((function(){var e=t.drawerService.isRightOpening();I.forEach((function(n){t.drawerService.isRightOpening(n)&&(e=!1)})),e&&(t.resetSelectWindowActions(),t.services.rightSideBarService.hide())}),50)})),f()(this,"updateDrawerStyle",(function(){var e,t=null===(e=document.getElementById("workbench-drawer-right"))||void 0===e?void 0:e.parentElement;null!=t&&t.style&&(t.style.bottom="".concat(b.D,"px"))})),f()(this,"registerRightSideBarCallback",(function(){t.services.rightSideBarService.registerCallback({beforeShow:function(){t.closeRightDrawerDirectly([h.b.SLIDE_PROPERTY_DRAWER])}}),t.services.userPrivilegeService.onPPTEditorStateChange((function(e){e!==S.f.EDITABLE&&t.closeRightDrawerDirectly([h.b.AUTH])}))}))}return u()(e,[{key:"setServiceDelegates",value:function(e){this.services=T(T({},this.services),e)}},{key:"init",value:function(){this.drawerService=g.e.get(m.c),this.updateDrawerStyle(),this.registerRightSideBarCallback()}},{key:"closeRightDrawerDirectly",value:function(e){var t=this;e.some((function(e){return t.drawerService.isRightOpening(e)}))||this.drawerService.closeRightDrawer()}}]),e}(),i=v()(r.prototype,"isDrawerMenuShown",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r)},"64c77c74c5":function(e,t,n){"use strict";n.r(t),n.d(t,"InsertTdocManager",(function(){return g}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("85d0a7609b"),u=n.n(l),d=n("3ef2352f0b"),f=n.n(d),p=(n("c6244f7705"),n("081c8cafea"),n("4bbb5840d5"),n("efc1955963")),v=n("065339d25e"),h=n("e07760dbbb"),g=function(){function e(){var t=this;o()(this,e),u()(this,"isEditing",void 0),u()(this,"selectionService",void 0),u()(this,"linkManager",void 0),u()(this,"attachmentManager",void 0),u()(this,"insertIframeContainer",function(){var e=i()(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.selectionService.selectedElements.clear(),r=t.selectionService.currentSlide){e.next=4;break}return e.abrupt("return");case 4:if(!n.mimeType){e.next=7;break}return t.addElementWithParagraphList(n,r),e.abrupt("return");case 7:t.linkManager.requestLinkData(n.url).then((function(e){if(e&&0===e.retcode){var i=e.result.linkInfo.mimeType;n.mimeType=i,t.addElementWithParagraphList(n,r)}}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u()(this,"cacheIsEditing",(function(){var e,n=t.selectionService.selectedElements.getCurrentModel();t.isEditing=null===(e=n.editorInstance)||void 0===e?void 0:e.isEditing})),u()(this,"insertTdocText",(function(e){if(!t.isEditing)return Promise.resolve();var n=t.selectionService.selectedElements.getCurrentModel();return new Promise((function(r){var i=t.getEditorInstanceByModel(n);i&&(e.mimeType?t.insertLinkText(e,i,r):t.linkManager.requestLinkData(e.url).then((function(n){if(n&&0===n.retcode){var a=n.result.linkInfo.mimeType;e.mimeType=a,t.insertLinkText(e,i,r)}})))}))}))}var t;return s()(e,[{key:"setSelectionServiceDelegate",value:function(e){this.selectionService=e}},{key:"setLinkManagerDelegate",value:function(e){this.linkManager=e}},{key:"setAttachmentManagerDelegate",value:function(e){this.attachmentManager=e}},{key:"show",value:function(){this.showModal()}},{key:"addElementWithParagraphList",value:function(e,t){var n=[{textRuns:[{styles:u()({href:{url:e.url,mimeType:e.mimeType,iconMode:!0}},"raw-href",!0),text:e.title}]}],r={style:{width:40*(e.title.length+1)}};t.addElementWithParagraphList(r,n)}},{key:"getEditorInstanceByModel",value:function(e){var t=null;if(e instanceof p.a&&e.selectedRange){var n=e.selectedRange.rowStart,r=e.selectedRange.colStart,i=e.tableItems[n][r];t=null==i?void 0:i.editorInstance}else t=null==e?void 0:e.editorInstance;return t}},{key:"insertLinkText",value:function(e,t,n){var r=u()({href:{url:e.url,mimeType:e.mimeType,iconMode:!0}},"raw-href",!0);t.insertText(e.title,r),setTimeout((function(){t.triggerBlur(),n(!0)}),0)}},{key:"onSelectorConfirmed",value:(t=i()(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t,"onSelectorConfirmed-data"),null!==t){e.next=3;break}return e.abrupt("return");case 3:if(t.type!==h.a.Attachment){e.next=6;break}return this.attachmentManager.insertAttachmentDirectly([t]),e.abrupt("return");case 6:if(n={url:this.processURL(t.url),title:t.title,mimeType:t.mimeType},!this.isEditing){e.next=11;break}this.insertTdocText(n),e.next=13;break;case 11:return e.next=13,this.insertIframeContainer(n);case 13:this.isEditing=!1;case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"processURL",value:function(e){return e&&!e.startsWith("http")?"https:".concat(e):e}},{key:"showModal",value:function(){var e,t=this;this.cacheIsEditing(),v.a.getInstance().showFileSelector({onConfirm:(e=i()(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.onSelectorConfirmed(n[0]||{});case 1:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})})}}]),e}()},"64d711d957":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));n("73b854064b");var r,i,a,o,c,s,l,u,d,f,p,v,h,g,m=n("1f925d7f50"),b=n.n(m),y=n("9132715560"),E=n.n(y),S=n("6a364eb35c"),w=n.n(S),O=n("547611bd96"),T=n.n(O),I=n("bd29e2df90"),R=n.n(I),C=n("ab5eb40518"),x=n.n(C),A=n("1b4cdd6a36"),k=n.n(A),P=n("85d0a7609b"),M=n.n(P),D=n("2dc700e1e6"),_=n.n(D),N=(n("f1054791f4"),n("3bf1976a4f"),n("d5c3deb8c7")),L=n("63c4952f3c");function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return x()(this,n)}}!function(e){e.PASS="pass",e.EMPTY="empty",e.WRONG="wrong",e.CHECKING="checking"}(g||(g={}));var j=(r=Reflect.metadata("design:type",Boolean),i=Reflect.metadata("design:type","undefined"==typeof File?Object:File),a=Reflect.metadata("design:type","undefined"==typeof String?Object:String),o=Reflect.metadata("design:type",String),c=Reflect.metadata("design:type",String),s=Reflect.metadata("design:type",String),l=function(e){R()(n,e);var t=F(n);function n(){var e;E()(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),M()(T()(e),"callback",{}),b()(T()(e),"show",u,T()(e)),b()(T()(e),"file",d,T()(e)),b()(T()(e),"passwordStatus",f,T()(e)),b()(T()(e),"password",p,T()(e)),b()(T()(e),"type",v,T()(e)),b()(T()(e),"errMsg",h,T()(e)),e}return w()(n,[{key:"open",value:function(e){this.initState(e),this.show=!0}},{key:"close",value:function(e){var t,n;this.show&&(this.initState(),this.show=!1,null===(t=(n=this.callback).close)||void 0===t||t.call(n,e))}},{key:"onClose",value:function(e){this.callback.close=e}},{key:"onConfirmSuccuss",value:function(e){this.callback.confirmSuccuss=e}},{key:"initState",value:function(e){this.file=e,this.passwordStatus=g.PASS,this.password="",this.type="loading",this.errMsg=""}}]),n}(L.a),u=_()(l.prototype,"show",[N.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=_()(l.prototype,"file",[N.q,i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=_()(l.prototype,"passwordStatus",[N.q,a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=_()(l.prototype,"password",[N.q,o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=_()(l.prototype,"type",[N.q,c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=_()(l.prototype,"errMsg",[N.q,s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l);t.b=j},"7091f809c6":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,i=n("176815363d"),a=n.n(i),o=n("9132715560"),c=n.n(o),s=n("6a364eb35c"),l=n.n(s),u=n("3ef2352f0b"),d=n.n(u),f=(n("6e20b6a7d8"),n("c6244f7705"),n("081c8cafea"),n("8ee19818c4"),n("759492dad9"),n("3cc783627f")),p=n("6986953439"),v=n("7c46f42788");!function(e){e[e.ELEMENT=0]="ELEMENT",e[e.TEXT=1]="TEXT",e[e.ELEMENT_INHERIT_AND_NO_INHERIT=2]="ELEMENT_INHERIT_AND_NO_INHERIT"}(r||(r={}));var h=function(){function e(){c()(this,e)}var t;return l()(e,[{key:"getTextString",value:function(e){var t=e.data;if(e.type===r.ELEMENT)t=this.plainTextFromElements(e.data);else if(e.type===r.ELEMENT_INHERIT_AND_NO_INHERIT){var n=e.data.map((function(e){return{sdkData:e.inheritedSdkData}}));t=this.plainTextFromElements(n)}return t}},{key:"getTextBlob",value:function(e){return new Blob([this.getTextString(e)],{type:"text/plain"})}},{key:"textBlobToText",value:(t=a()(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"plainTextFromElements",value:function(e){return this.isTable(e)?this.plainTextFromTable(e):this.isAddon(e)?this.plainTextFromAddon(e):this.plainTextFromShape(e)}},{key:"plainTextFromShape",value:function(e){var t=[];return e.forEach((function(e){var n,r,i=null===(n=e.sdkData)||void 0===n||null===(r=n.txBody)||void 0===r?void 0:r.p;null==i||i.forEach((function(e){e.egTextRun.forEach((function(e){t.push(Object(f.e)(e))}))}))})),t.join("")}},{key:"plainTextFromTable",value:function(e){var t=[];return e.forEach((function(e){t.push(p.a.getSingleton().parseSdkDataToPlainText(e.sdkData))})),t.join("")}},{key:"plainTextFromAddon",value:function(e){return e.map((function(e){var t,n;return null===(t=e.props)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.originUrl})).join(" ")}},{key:"isTable",value:function(e){var t=v.a.GraphicalObjectFrameTable;return e.every((function(e){return e.sdkData.type===t}))}},{key:"isAddon",value:function(e){return e.every((function(e){var t,n;return"iframe"===(null===(t=e.props)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.displayMode)}))}}]),e}();t.b=h},"77c89fc0e0":function(e,t,n){"use strict";n.d(t,"g",(function(){return c.a})),n.d(t,"a",(function(){return r.c})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"h",(function(){return s.a})),n.d(t,"f",(function(){return a.a})),n.d(t,"n",(function(){return l.e})),n.d(t,"p",(function(){return l.f})),n.d(t,"k",(function(){return l.d})),n.d(t,"j",(function(){return l.b})),n.d(t,"e",(function(){return i.a})),n.d(t,"l",(function(){return o.a})),n.d(t,"d",(function(){return u.a})),n.d(t,"o",(function(){return d.l})),n.d(t,"m",(function(){return d.g})),n.d(t,"i",(function(){return d.a}));var r=n("780d9b3b59"),i=(n("9cae5c6f5c"),n("05d181ac40")),a=n("5cdbac46e8"),o=n("5fac0349d3"),c=(n("76f3a50d5c"),n("7faf76450d"));n("b86964b011"),n("f8fc8e0087");var s=n("d0054b9d0b"),l=n("3825cc7c15"),u=n("1288bffff3"),d=n("d9812f1c6f");n("1acc787c14")},"7bbed40ec1":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-cursor-tag-354gS{padding:0 6px;display:block;position:absolute;font-size:10px;color:#fff;word-break:keep-all;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-radius:1px;border:0;height:19px;line-height:19px;max-width:160px;pointer-events:none;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;background:red}.index-cursor-tag-354gS.index-fade-in-Qbkk_{-webkit-animation-name:index-cursor-tag-fade-in-1xwAN;animation-name:index-cursor-tag-fade-in-1xwAN}.index-cursor-tag-354gS.index-fade-out-2XNPe{-webkit-animation-name:index-cursor-tag-fade-out-3-9MX;animation-name:index-cursor-tag-fade-out-3-9MX}@-webkit-keyframes index-cursor-tag-fade-in-1xwAN{0%{opacity:0}to{opacity:1}}@keyframes index-cursor-tag-fade-in-1xwAN{0%{opacity:0}to{opacity:1}}@-webkit-keyframes index-cursor-tag-fade-out-3-9MX{0%{opacity:1}to{opacity:0}}@keyframes index-cursor-tag-fade-out-3-9MX{0%{opacity:1}to{opacity:0}}",""]),t.locals={"cursor-tag":"index-cursor-tag-354gS","fade-in":"index-fade-in-Qbkk_","cursor-tag-fade-in":"index-cursor-tag-fade-in-1xwAN","fade-out":"index-fade-out-2XNPe","cursor-tag-fade-out":"index-cursor-tag-fade-out-3-9MX"}},"7fcf08f07a":function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));n("73b854064b");var r=n("14502724a6"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("547611bd96"),u=n.n(l),d=n("bd29e2df90"),f=n.n(d),p=n("ab5eb40518"),v=n.n(p),h=n("1b4cdd6a36"),g=n.n(h),m=n("85d0a7609b"),b=n.n(m),y=(n("c6244f7705"),n("bd80bf2d0f"),n("826dc923b3"),n("69084d01d3")),E=n.n(y),S=n("f000f89fa1"),w=n.n(S),O=n("5fac0349d3"),T=n("d5c3deb8c7"),I=n("382929c8da");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var C=function(e){f()(n,e);var t=R(n);function n(e){var r;o()(this,n),r=t.call(this,e),b()(u()(r),"menuManager",void 0),b()(u()(r),"insertTableRowColManager",void 0),b()(u()(r),"reaction",void 0);var i=e.menuManager;r.menuManager=i;var a=r.menuManager.insertTableRowColManager;r.insertTableRowColManager=a;var c=a||{},s=c.insertBottomRowNumber,l=void 0===s?0:s,d=c.insertTopRowNumber,f=void 0===d?0:d,p=c.insertRightColNumber,v=void 0===p?0:p,h=c.insertLeftColNumber,g=void 0===h?0:h;return r.state={insertBottomRowNumber:l,insertTopRowNumber:f,insertRightColNumber:v,insertLeftColNumber:g},r.initReaction(),r}return s()(n,[{key:"componentWillUnmount",value:function(){this.reaction()}},{key:"render",value:function(){var e=this,t=this.getPrefix(),n=this.getPostfix(),r=this.getInsertNumber();return E.a.createElement("div",{style:{width:166,boxSizing:"content-box",padding:"9px 16px",height:12}},E.a.createElement("div",{style:{position:"absolute",left:16,width:"max-content",top:"50%",transform:"translateY(-50%)"}},t),E.a.createElement("div",{onClick:function(e){var t;e.nativeEvent.stopImmediatePropagation(),null===(t=e.stopPropagation)||void 0===t||t.call(e)},style:{position:"absolute",right:28,width:56,height:20,top:6}},E.a.createElement(w.a,{max:20,min:1,value:r.toString(),maxLength:20,inputStyle:{width:36,height:20,borderRadius:2,margin:"0 10px",textAlign:"center",padding:0,fontSize:12},onChange:function(t){var n=e.fixNumber(t)||1;e.setInsertNumber(n)}})),E.a.createElement("div",{style:{position:"absolute",right:16,width:"max-content",height:20,top:7}},n))}},{key:"getInsertNumber",value:function(){switch(this.props.type){case I.a.INSERT_ROW_TOP:return this.state.insertTopRowNumber||1;case I.a.INSERT_ROW_BOTTOM:return this.state.insertBottomRowNumber||1;case I.a.INSERT_COL_LEFT:return this.state.insertLeftColNumber||1;case I.a.INSERT_COL_RIGHT:return this.state.insertRightColNumber||1;default:return 1}}},{key:"getPrefix",value:function(){switch(this.props.type){case I.a.INSERT_ROW_TOP:return O.a.t("在上方插入");case I.a.INSERT_ROW_BOTTOM:return O.a.t("在下方插入");case I.a.INSERT_COL_LEFT:return O.a.t("在左侧插入");case I.a.INSERT_COL_RIGHT:return O.a.t("在右侧插入");default:return""}}},{key:"getPostfix",value:function(){switch(this.props.type){case I.a.INSERT_ROW_TOP:case I.a.INSERT_ROW_BOTTOM:return O.a.t("行");case I.a.INSERT_COL_LEFT:case I.a.INSERT_COL_RIGHT:return O.a.t("列");default:return""}}},{key:"fixNumber",value:function(e){if(""!==e){var t=Number(e);return isNaN(t)?1:(t<=0&&(t=1),t>=20&&(t=20),t)}}},{key:"initReaction",value:function(){var e=this;this.reaction=Object(T.r)((function(){var t,n,r,i;return[null===(t=e.insertTableRowColManager)||void 0===t?void 0:t.insertBottomRowNumber,null===(n=e.insertTableRowColManager)||void 0===n?void 0:n.insertTopRowNumber,null===(r=e.insertTableRowColManager)||void 0===r?void 0:r.insertRightColNumber,null===(i=e.insertTableRowColManager)||void 0===i?void 0:i.insertLeftColNumber]}),(function(t){var n=i()(t,4),r=n[0],a=n[1],o=n[2],c=n[3];e.setState({insertBottomRowNumber:r||1,insertTopRowNumber:a||1,insertRightColNumber:o||1,insertLeftColNumber:c||1})}))}},{key:"setInsertNumber",value:function(e){var t,n,r,i;switch(this.props.type){case I.a.INSERT_ROW_TOP:this.setState({insertTopRowNumber:e}),null!==(t=this.insertTableRowColManager)&&void 0!==t&&t.insertTopRowNumber&&(this.insertTableRowColManager.insertTopRowNumber=e);break;case I.a.INSERT_ROW_BOTTOM:this.setState({insertBottomRowNumber:e}),null!==(n=this.insertTableRowColManager)&&void 0!==n&&n.insertBottomRowNumber&&(this.insertTableRowColManager.insertBottomRowNumber=e);break;case I.a.INSERT_COL_LEFT:this.setState({insertLeftColNumber:e}),null!==(r=this.insertTableRowColManager)&&void 0!==r&&r.insertLeftColNumber&&(this.insertTableRowColManager.insertLeftColNumber=e);break;case I.a.INSERT_COL_RIGHT:this.setState({insertRightColNumber:e}),null!==(i=this.insertTableRowColManager)&&void 0!==i&&i.insertRightColNumber&&(this.insertTableRowColManager.insertRightColNumber=e);break;default:return""}}}]),n}(E.a.Component)},"846ab59b8e":function(e,t,n){"use strict";var r,i,a;n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),function(e){e.NONE="none",e.SUCCESS="success",e.ERROR="error",e.LOADING="loading"}(r||(r={})),function(e){e.BUTTON_CLICK="button_click",e.IMPORT_ERROR="import_error"}(i||(i={})),function(e){e[e.ILLEGAL_OFFICE_CODE=108]="ILLEGAL_OFFICE_CODE",e[e.PASSWORD_INCORRECT=112]="PASSWORD_INCORRECT",e[e.FILE_ENCRYPTED=115]="FILE_ENCRYPTED",e[e.FILE_ENCRYPTED_113=113]="FILE_ENCRYPTED_113",e[e.FILE_EXCEPTION=104]="FILE_EXCEPTION",e[e.POI_EXCEPTION_PARSING=171]="POI_EXCEPTION_PARSING",e[e.FORMAT_ERROR_03_TO_07=181]="FORMAT_ERROR_03_TO_07",e[e.FORMAT_TIMEOUT_03_TO_07=281]="FORMAT_TIMEOUT_03_TO_07",e[e.OOM_03_TO_07=283]="OOM_03_TO_07"}(a||(a={}))},"85e322a445":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABGCAMAAABG8BK2AAAAn1BMVEUAAAAAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEXs9YZAAAANHRSTlMA+/YFkzPqaUapoCwo7teNiG5aIhu6rl4SC93CfXp1Dwjy5+PMsoBlVk8eF0vQmjdBO8aEKMev0gAAAytJREFUWMO1V+eaokAQnB4yEkQBEVZds2vWrfd/tuNwz4CEgf2ufrQ6w1fY09VhWD0kif0KiiYHjk0A2U4ga0oLimgd2riBCDeo4TpqRKIbBCA2Pd2KpNStyNI9MwZAxlmY5OsAULDu59f764CAxV6IpJMA6sov3vRXKpB0akmGLmHmfZY/8OmpIHdY81cckDupfmbiEg5W1RMDDkcgrooDPijf/gCOn0wAn0dgVKZWGaQxQWgEuXhHBt8wYWxKeD5AeiOJUpFfA9CGNUKP0MuvWRwaawgP01zchw5M1hgmDq+BdeEIRfrt5d0XPREprAVORM/5lUBmrSAjePzYQ520o4lsPArQFR+sJUaPv3OBPWlLM7Rxusety1rD/aeUCad+e5o++PAmaiTsF7j+pIQBr8lhKG8pYWSfNhr4tDvgkstGqFn5xVycxXfg5KM6h5VVCEP8PGMcdvlFA70sYitRFmuORVSgwO/ULlMyMXRmSAp0usncOUAwuRUVwbBoHYvUzuCLFQUby8KatM1iNMVQhOU8hSEVd1HYqQWE+gCHKZX0N1BqOd7W3f3brEI4luoaPLUqJvmIgHpvvcQtFzZmqY3hF3S+wUsPo6pSYiFO7aIg4GNg/dSvgVFVCLOAh9iwIh4v970UvUx+3cJCrAHju4drVoVVRjBAWLS5/un03eycqrDM3LEwK5686G/OyvUTgnqrVzN0yiaG7hG8en591CsT49JJCFyv71TmTaFYlM3ZNL2wOizwdZsHp+iUZdKpvgjB/sn7I2TWGjLkOyHftWWJON0nrrB99+0+qU4B99uxbPlzRoYw2tGEMF5J9TYse0z914yeR81ZdrOccqUEy8YsUoBEyp2Vim7zKKn+m5vUdEz3Ci8ZWlbIxTFA8XtXWZlrcKH6KKuG+BY/l/Ih2CMsI6FILysvgrqN+V7gvj+DWinX/hVY9mtGriVw3dZIaszBZb8iGWUOPpbqk9YAyCwpnheTAGMrNlaFBMQrJfdK6fQdAxSK37wsVwUwDWTtrPR3kd85a3IwBaC6VrO0048xcnBkXWLN4X+NzGQRq/bcSczR1479d/wBLkxV6jjmdPwAAAAASUVORK5CYII="},"899628eb65":function(e,t,n){"use strict";n.r(t),n.d(t,"PcCopyPaste",(function(){return M}));n("73b854064b");var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("547611bd96"),u=n.n(l),d=n("8eec1e4a03"),f=n.n(d),p=n("bd29e2df90"),v=n.n(p),h=n("ab5eb40518"),g=n.n(h),m=n("1b4cdd6a36"),b=n.n(m),y=n("85d0a7609b"),E=n.n(y),S=n("3ef2352f0b"),w=n.n(S),O=(n("3bf1976a4f"),n("c6244f7705"),n("081c8cafea"),n("75563bc376"),n("de8a404165")),T=n("457452e346"),I=n("5b326a30b1"),R=n("0d1cecd3de"),C=n("60b97ecf25"),x=n("82f2dc9440"),A=n.n(x),k=n("5fac0349d3");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var M=function(e){v()(r,e);var t,n=P(r);function r(){var e;o()(this,r);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return e=n.call.apply(n,[this].concat(i)),E()(u()(e),"historyManager",void 0),e}return s()(r,[{key:"setHistoryManagerDelegate",value:function(e){this.historyManager||(this.historyManager=e)}},{key:"registerEventListener",value:function(){f()(b()(r.prototype),"registerEventListener",this).call(this),window.addEventListener("dragover",this.handlerDragover.bind(this),!0)}},{key:"getAspectWIdthBySizeType",value:function(e){switch(e){case I.a.SLIDE_SIZE_4_3:return 1200;case I.a.SLIDE_SIZE_16_9:return 1600;case I.a.SLIDE_SIZE_CUSTOM:default:return 1100}}},{key:"shouldResponsePaste",value:function(e){var t,n;return e?f()(b()(r.prototype),"shouldResponsePaste",this).call(this,e):(null===(t=this.services)||void 0===t||null===(n=t.tipsManager)||void 0===n||n.showBrowserNotSupport(),!1)}},{key:"copyElementDataToImage",value:function(){var e=document.createElement("empty");this.copyDataToImage(e)}},{key:"copySlideDataToImage",value:function(){var e=document.createElement("empty");this.copyDataToImage(e)}},{key:"generateSlideCanvas",value:function(e,t){var n;return(null===(n=this.services)||void 0===n?void 0:n.contentRendererService).copyToImage.generateSlideCanvas(e,t)}},{key:"copyDataToImage",value:function(e){this.clipboardManager.save(E()({},T.a.IMAGE_PNG,{container:e,outputOptions:this.getCopyCanVasOptions()}))}},{key:"handlerDragover",value:(t=i()(w.a.mark((function e(t){var n,r,i,a,o,c,s=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(n=this.getPlayManager())||void 0===n?void 0:n.isPlaying)){e.next=3;break}return e.abrupt("return");case 3:return Object(R.c)(t),o=this.historyManager.isShowHistoryPanel,e.next=7,null===(i=this.services)||void 0===i||null===(a=i.importFilePipelineManager)||void 0===a?void 0:a.promise();case 7:if(e.t1=r=e.sent,e.t0=null===e.t1,e.t0){e.next=11;break}e.t0=void 0===r;case 11:if(!e.t0){e.next=15;break}e.t2=void 0,e.next=16;break;case 15:e.t2=r.isFree();case 16:if(c=e.t2,this.enable&&!o&&c){e.next=19;break}return e.abrupt("return");case 19:if(this.dragStatus.isDragged){e.next=23;break}return this.dragStatus.isDragged=!0,this.dragStatus.enableDrop=!![function(){return{result:s.getDragImgList(t),type:"img"}},function(){return{result:Object(R.b)(t),type:"ppt"}}].find((function(e){var t,n=e();if(null==n||null===(t=n.result)||void 0===t||!t.length)return!1;s.snackbarOp&&s.snackbarOp.close();var r={img:s.getImgDragoverSnackbarMessage(),ppt:k.a.t(n.result.length>1?"一次仅支持导入一个本地文档":"拖动文件到正文，即可导入。")};C.g||(r.ppt="");var i=r[n.type];return i&&(s.snackbarOp=A.a.show({message:i,duration:3e3,autoClose:!1})),!0})),e.abrupt("return");case 23:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),r}(O.a)},"95ce1f63c1":function(e,t){e.exports="//docs.gtimg.com/slide/img/slide/application/service/import-file-manager/core/components/import-file/img/import_success@2x-b81df2.png"},"9668e6a98c":function(e,t,n){"use strict";n.r(t),n.d(t,"Manager",(function(){return r}));var r,i=n("9132715560"),a=n.n(i),o=n("6a364eb35c"),c=n.n(o),s=n("85d0a7609b"),l=n.n(s),u=n("d5c3deb8c7");!function(e){e.None="none",e.IMPORT_FILE_SELECT="import_file_select",e.IMPORT_FILE="import_file",e.PAGE_SELECT="page_select"}(r||(r={}));var d=function(){function e(){var t=this;a()(this,e),l()(this,"currentManager",void 0),l()(this,"importFileManager",void 0),l()(this,"pagingSelectionManager",void 0),l()(this,"importFileSelectManager",void 0),l()(this,"onVisibleChangeCallback",(function(e){return function(n){t.currentManager=n?e:r.None}})),this.currentManager=r.None}return c()(e,[{key:"setImportFileManagerDelegate",value:function(e){this.importFileManager||(this.importFileManager=e,Object(u.r)((function(){return e.getVisible()}),this.onVisibleChangeCallback(r.IMPORT_FILE)))}},{key:"setImportFileSelectManagerDelegate",value:function(e){var t=this;this.importFileSelectManager||(this.importFileSelectManager=e,Object(u.r)((function(){var e;return null===(e=t.importFileSelectManager)||void 0===e?void 0:e.getVisible()}),this.onVisibleChangeCallback(r.IMPORT_FILE_SELECT)))}},{key:"setPagingSelectionManagerDelegate",value:function(e){this.pagingSelectionManager||(this.pagingSelectionManager=e,Object(u.r)((function(){return e.getVisible()}),this.onVisibleChangeCallback(r.PAGE_SELECT)))}},{key:"isFree",value:function(){return this.currentManager===r.None}}]),e}();t.default=d},"9bd2d7461c":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,'.password-wrapper-modal-1lbca{width:388px;height:228px}.password-wrapper-caption-1Ysxg{font-size:14px;color:#333}.password-wrapper-info-3FK1g,.password-wrapper-info--wrong-1_wlu{font-size:13px;margin-top:10px}.password-wrapper-info--wrong-1_wlu{color:#ee4e2e}.password-wrapper-info--checking-2wsYs{color:#777;font-size:13px;margin-top:10px}.password-wrapper-body-1Grtg{width:100%;min-height:88px}.password-wrapper-input-6FlNC{width:100%;height:34px;margin-top:8px;border-radius:2px;border:1px solid #cfcfcf;box-sizing:border-box;padding:5px 10px;font-size:14px;line-height:34px;caret-color:#007cfb;-webkit-appearance:none;box-shadow:inset 0 40px 0 #fff;-webkit-text-security:disc}@supports (text-security:disc){.password-wrapper-input-6FlNC{text-security:disc}}.password-wrapper-input-6FlNC::-webkit-input-placeholder{color:#bbb}.password-wrapper-input-6FlNC:-ms-input-placeholder{color:#bbb}.password-wrapper-input-6FlNC::placeholder{color:#bbb}.password-wrapper-input-6FlNC.password-wrapper-editable-25qiV:hover{border-color:#a1a1a1}.password-wrapper-input-6FlNC.password-wrapper-editable-25qiV:focus{border-color:#007cfb}.password-wrapper-input-6FlNC.password-wrapper-wrong-XotXJ{caret-color:#ee4e2e}.password-wrapper-input-6FlNC.password-wrapper-wrong-XotXJ,.password-wrapper-input-6FlNC.password-wrapper-wrong-XotXJ:focus,.password-wrapper-input-6FlNC.password-wrapper-wrong-XotXJ:hover{border-color:#ee4e2e}@-webkit-keyframes password-wrapper-dots-anim-25hMo{0%{content:"."}50%{content:".."}to{content:"..."}}@keyframes password-wrapper-dots-anim-25hMo{0%{content:"."}50%{content:".."}to{content:"..."}}.password-wrapper-dots-animation-csRME:after{content:"";-webkit-animation-name:password-wrapper-dots-anim-25hMo;animation-name:password-wrapper-dots-anim-25hMo;-webkit-animation-duration:.5s;animation-duration:.5s;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.password-wrapper-footer-25bbS{display:flex;flex-direction:row-reverse;justify-content:flex-start;align-items:center;position:absolute;bottom:24px;right:24px}',""]),t.locals={modal:"password-wrapper-modal-1lbca",caption:"password-wrapper-caption-1Ysxg",info:"password-wrapper-info-3FK1g","info--wrong":"password-wrapper-info--wrong-1_wlu","info--checking":"password-wrapper-info--checking-2wsYs",body:"password-wrapper-body-1Grtg",input:"password-wrapper-input-6FlNC",editable:"password-wrapper-editable-25qiV",wrong:"password-wrapper-wrong-XotXJ","dots-animation":"password-wrapper-dots-animation-csRME","dots-anim":"password-wrapper-dots-anim-25hMo",footer:"password-wrapper-footer-25bbS"}},a2b2c85fda:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ee}));n("73b854064b");var r=n("730477bb20"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("547611bd96"),u=n.n(l),d=n("bd29e2df90"),f=n.n(d),p=n("ab5eb40518"),v=n.n(p),h=n("1b4cdd6a36"),g=n.n(h),m=n("85d0a7609b"),b=n.n(m),y=(n("a2a09da1e3"),n("759492dad9"),n("fce3077cdf"),n("69084d01d3")),E=n.n(y),S=n("4f3b15d017"),w=n("e792a3169a"),O=n.n(w),T=n("ebfafdff96"),I=n.n(T),R={insert:"head",singleton:!1},C=(O()(I.a,R),I.a.locals||{}),x=n("52d461bc51"),A=n.n(x),k=n("34a6623f15"),P=n("5fac0349d3"),M=n("9bd2d7461c"),D=n.n(M),_={insert:"head",singleton:!1},N=(O()(D.a,_),D.a.locals||{}),L=n("1748118723"),F=n.n(L),j=n("64d711d957"),B=n("11246a1392"),U=n.n(B);function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var H=function(e){f()(n,e);var t=G(n);function n(e,r){var i;return o()(this,n),i=t.call(this,e,r),b()(u()(i),"passwordInput",void 0),b()(u()(i),"handlePasswordChange",(function(e){i.props.passwordInputManager.password=e.target.value,i.props.passwordInputManager.passwordStatus=j.a.PASS})),b()(u()(i),"handleClose",(function(){i.props.passwordInputManager.close()})),b()(u()(i),"confirmPassword",(function(e){if(null==e||e.preventDefault(),i.state.passwordStatus!==j.a.WRONG){var t,n=i.state.password;if(n)!/[\x00-\x1F\x7F]/.test(n)?(i.props.passwordInputManager.passwordStatus=j.a.CHECKING,i.props.passwordInputManager.callback.confirmSuccuss&&i.props.passwordInputManager.callback.confirmSuccuss(n)):(i.props.passwordInputManager.errMsg=P.a.t("文件已加密，请删除密码后导入。"),i.props.passwordInputManager.type="error");else i.props.passwordInputManager.passwordStatus=j.a.EMPTY,window.focus(),null===(t=i.passwordInput)||void 0===t||t.focus();return!1}})),i.state={passwordStatus:j.a.PASS,password:"",type:"loading",errMsg:"",visible:!1},i.props.passwordInputManager.bindMultiReaction([{stateName:"visible",managerStateName:"show"},{stateName:"passwordStatus",managerStateName:"passwordStatus"},{stateName:"password",managerStateName:"password"},{stateName:"type",managerStateName:"type"},{stateName:"errMsg",managerStateName:"errMsg"}],u()(i)),i}return s()(n,[{key:"componentWillUnmount",value:function(){this.props.passwordInputManager.flushReaction()}},{key:"renderContent",value:function(){var e,t=this,n=this.state.passwordStatus;return E.a.createElement("div",{className:N.body},E.a.createElement("div",{className:N.caption},P.a.t("文件已加密，请输入密码：")),E.a.createElement("input",{className:F()(N.input,(e={},b()(e,N.wrong,n===j.a.EMPTY||n===j.a.WRONG),b()(e,N.editable,n!==j.a.CHECKING),e)),disabled:n===j.a.CHECKING,ref:function(e){return t.passwordInput=e},value:this.state.password,placeholder:P.a.t("输入密码"),onChange:this.handlePasswordChange}),n===j.a.WRONG&&E.a.createElement("div",{className:N["info--wrong"]},P.a.t("密码不正确，请重新输入。")),n===j.a.EMPTY&&E.a.createElement("div",{className:N["info--wrong"]},P.a.t("密码为空，请重新输入。")),n===j.a.CHECKING&&E.a.createElement("div",{className:F()(N["info--checking"],N["dots-animation"])},P.a.t("正在解析文档")))}},{key:"renderFooter",value:function(){var e=this.state.passwordStatus===j.a.CHECKING;return E.a.createElement("div",{className:N.footer},E.a.createElement(U.a,{type:"primary",style:{marginLeft:16},disabled:e||""===this.state.password,onClick:this.confirmPassword},P.a.t("确定")),E.a.createElement(U.a,{disabled:e,onClick:this.handleClose},P.a.t("取消")))}},{key:"render",value:function(){return this.state.visible?E.a.createElement(A.a,{className:N.modal,visible:!0,title:P.a.t("输入文档密码"),content:this.renderContent(),footer:this.renderFooter(),onClose:this.handleClose}):null}}]),n}(y.Component),z=n("402eb050f3"),W=n("d5c3deb8c7"),V=n("846ab59b8e");function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var Y={success:n("85e322a445"),"success@2x":n("95ce1f63c1"),fail:n("52ba91852f"),"fail@2x":n("5ef200d392")},X=function(e){return window.devicePixelRatio&&window.devicePixelRatio>=2?Y["".concat(e,"@2x")]:Y[e]},J=function(e){f()(n,e);var t=K(n);function n(e,r){var i;return o()(this,n),i=t.call(this,e,r),b()(u()(i),"showCancelWarnReaction",void 0),b()(u()(i),"handleWarnOK",(function(){i.props.importFileManager.clearCancelWarnQueue(),i.hideCloseWarn(),i.props.onClose()})),b()(u()(i),"hideCloseWarn",(function(){i.props.importFileManager.showCancelWarn=!1})),b()(u()(i),"handleClose",(function(){i.props.data.type!==V.c.LOADING?i.props.onClose():i.props.importFileManager.showCancelWarn=!0})),i.state={showCancelWarn:!1},i.showCancelWarnReaction=Object(W.r)((function(){return i.props.importFileManager.showCancelWarn}),(function(e){i.setState({showCancelWarn:e})})),i}return s()(n,[{key:"componentWillUnmount",value:function(){this.showCancelWarnReaction()}},{key:"renderStatus",value:function(){var e=this.props.data,t=e.type,n=e.progress,r=e.errMsg;return t===V.c.LOADING?E.a.createElement("div",{className:C.progress},E.a.createElement("svg",{className:C["import-file-circle"],width:"70",height:"70"},E.a.createElement("circle",{stroke:"#dddddd",fill:"none",strokeWidth:"2",cx:"35",cy:"35",r:"34",strokeDasharray:"214 214"}),E.a.createElement("circle",{id:"circle",className:"animation",transform:"matrix(0,-1,1,0,0,70)",stroke:"#0188fb",fill:"none",strokeWidth:"2",cx:"35",cy:"35",r:"34",strokeDasharray:"".concat(n/100*214," 214")}),E.a.createElement("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"central"},n,"%")),E.a.createElement("div",{className:C.status},P.a.t("正在导入"),"..."),E.a.createElement("div",{className:C.tips},P.a.t("快速导入中，请耐心等待"),"。")):t===V.c.SUCCESS?E.a.createElement("div",{className:C.progress},E.a.createElement("img",{src:X("success"),alt:"success"}),E.a.createElement("div",{className:C.status},P.a.t("导入成功"))):t===V.c.ERROR?E.a.createElement("div",{className:C.progress},E.a.createElement("img",{src:X("fail"),alt:"fail"}),E.a.createElement("div",{className:C.status},P.a.t("导入失败")),E.a.createElement("div",{className:C.tips},r)):null}},{key:"renderWarn",value:function(){if(this.state.showCancelWarn){var e=E.a.createElement("div",{className:C["cancel-warn-modal-body "]},E.a.createElement("div",{className:C["cancel-warn-modal-caption"]},P.a.t("是否取消文档导入？")));return E.a.createElement(A.a,{className:C["cancel-warn-modal"],title:P.a.t("取消导入"),visible:!0,content:e,cancelText:P.a.t("取消"),okText:P.a.t("确定"),onOk:this.handleWarnOK,onCancel:this.hideCloseWarn,onClose:this.hideCloseWarn})}return null}},{key:"render",value:function(){return E.a.createElement(k.b,null,E.a.createElement(A.a,{className:C.modal,title:z.b.supportEnterprise(z.a.ALL)?P.a.t("导入本地文档"):P.a.t("导入内容"),visible:!0,footer:null,cancelText:"",onCancel:this.handleClose},this.renderStatus(),E.a.createElement(H,{passwordInputManager:this.props.importFileManager.passwordInputManager}),this.renderWarn()))}}]),n}(y.Component),q=n("d3d31c86eb"),Q=n("9da6335152"),Z=n("e71df909b9");function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var ee=function(e){f()(n,e);var t=$(n);function n(e,r){var i;return o()(this,n),i=t.call(this,e,r),b()(u()(i),"onClose",(function(){Object(q.c)({opername:Q.e.PAGING_SELECTION,module:Q.d.SLIDE_UPLOAD,action:Q.b.UPLOAD_CANCEL}),i.props.importFileManager.close()})),i.state={visible:!1,data:{type:V.c.NONE,progress:0,errMsg:""}},i.props.importFileManager.bindMultiReaction([{stateName:"visible",managerStateName:"visible"},{stateName:"data",managerStateName:"data"}],u()(i)),i}return s()(n,[{key:"getAcceptType",value:function(e){if(S.default.userAgent.indexOf("WeComCEF")>-1){if(z.b.supportEnterprise(z.a.APP_PC))return e.join(",");if(z.b.supportEnterprise(z.a.ALL))return".ppt|".concat(e.join(";"))}return e.join(",")}},{key:"componentWillUnmount",value:function(){this.props.importFileManager.flushReaction()}},{key:"render",value:function(){var e=this;return E.a.createElement(E.a.Fragment,null,E.a.createElement("input",{id:"import-slide-input",type:"file",accept:this.getAcceptType(Object.values(Z.a)),onChange:function(t){var n=t.target;e.props.importFileManager.parseAndPreviewSlideFile(n.files[0]),n.value=""},hidden:!0}),this.state.visible?E.a.createElement(J,i()({},this.props,{data:this.state.data,onClose:this.onClose})):null)}}]),n}(y.Component)},a92392f0fb:function(e,t,n){"use strict";n.r(t),n.d(t,"ImageUploadService",(function(){return V}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("547611bd96"),u=n.n(l),d=n("bd29e2df90"),f=n.n(d),p=n("ab5eb40518"),v=n.n(p),h=n("1b4cdd6a36"),g=n.n(h),m=n("85d0a7609b"),b=n.n(m),y=n("3ef2352f0b"),E=n.n(y),S=(n("c6244f7705"),n("081c8cafea"),n("8a35b54c1d"),n("6e20b6a7d8"),n("963f2eaace"),n("8ee19818c4"),n("3bf1976a4f"),n("9e6e95de85"));function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var O=function(e){f()(n,e);var t=w(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"initModel",value:function(e,t){}}]),n}(n("375d29afab").a),T=n("3344f1a2e7"),I=n("e0e8dd9366"),R=n("d3d31c86eb"),C=n("9da6335152"),x=n("db50d57b55"),A=n("145eddafd2"),k=n("ec5cae33cb"),P=n("c73625d763"),M=n.n(P),D=n("ee6bb53310"),_=n.n(D),N=n("f8fc8e0087"),L=n("382929c8da"),F=n("82f2dc9440"),j=n.n(F),B=n("77c89fc0e0");function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var z="placeholder",W="slide",V=function(e){f()(n,e);var t=H(n);function n(){var e;return o()(this,n),e=t.call(this),b()(u()(e),"service",void 0),b()(u()(e),"imgIndex",void 0),b()(u()(e),"injectable",void 0),b()(u()(e),"setServiceDelegates",(function(t){e.service=G(G({},e.service),t)})),b()(u()(e),"handleImageChange",function(){var t=i()(E.a.mark((function t(n){var r,i,a,o,c,s,l,u,d,f,p,v,h;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.imgIndex=-1,!e.noNeedImageChange(n)){t.next=3;break}return t.abrupt("return");case 3:return a=e.service.uiDataService.presentation,o=null===(r=e.service.selectionService)||void 0===r?void 0:r.currentSlideIndex,c=null===(i=e.service.selectionService)||void 0===i?void 0:i.slides,e.setImageSize(n),s=[],l=[],u=c[o],n=n.reverse(),t.next=13,e.service.copyPasteImageService.promise();case 13:if(d=t.sent,f=d.ImageEditManager,p=d.replaceImage,!f.getInstance().imageReplacing){t.next=20;break}if(f.getInstance().imageReplacing=!1,!p(n,e.service.selectionService.getSelectedModel())){t.next=20;break}return t.abrupt("return");case 20:v=e.insertToSelectedPlaceHolderIfExist(u,n,s,l),e.insertToExtraPlaceHolderIfExist(u,n,v,s,a,l),e.deleteOrAddElement(l,n,u,s),e.service.selectionService&&(e.service.selectionService.lastMouseDownRegion=k.a.EDITOR,e.service.selectionService.selectedSlides.clear()),(h=document.getElementById("select_pic_input"))&&(h.value=null),e.reportClick();case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),b()(u()(e),"getCopyPasteImageService",i()(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.service.copyPasteImageService.promise();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))),b()(u()(e),"noNeedImageChange",(function(t){var n;return!(null!==(n=e.service.selectionService)&&void 0!==n&&n.currentSlide&&t&&0!==t.length)})),b()(u()(e),"isPlaceHolderAcceptPic",(function(e){return e.isPlaceholder&&!e.isCustomPlaceholder&&(e.placeHolder.type===x.a.PIC||void 0===e.placeHolder.type)})),b()(u()(e),"getAllSeletedModelsAcceptPic",(function(t){return!t||void 0===t||t.length<1?[]:t.filter((function(t){return e.isPlaceHolderAcceptPic(t)}))})),b()(u()(e),"insertToSelectedPlaceHolderIfExist",(function(t,n,r,i){var a,o=null===(a=e.service.selectionService)||void 0===a?void 0:a.selectedElements.selectedArray,c=e.getAllSeletedModelsAcceptPic(o);return!c||void 0===c||c.length<1?0:n.length>c.length?(c.map((function(e,t){var a=n[t],o=e.props.style;this.resetStylePH(o,a,z,e.placeHolder),r.push(I.d.IMAGE),i.push(e)}),u()(e)),c.length):(n.map((function(e,t){var n=c[t],a=n.props.style;this.resetStylePH(a,e,z,n.placeHolder),r.push(I.d.IMAGE),i.push(n)}),u()(e)),n.length)})),b()(u()(e),"insertToExtraPlaceHolderIfExist",(function(t,n,r,i,a,o){if(!(n.length<=r)){var c=r>0?n.slice(r):n,s=t.getElementsOfPlaceholderTypeInSlideExceptSlected(x.a.PIC);void 0===s||s.length<1?e.insertToSlide(t,c.slice(s.length),i,a):c.length>s.length?(s.map((function(e,t){this.resetStylePH(e.props.style,c[t],z,e.placeHolder),i.push(I.d.IMAGE),o.push(e)}),u()(e)),e.insertToSlide(t,c.slice(s.length),i,a)):c.map((function(e,t){e.style=s[t].props.style,this.resetStylePH(s[t].props.style,e,z,s[t].placeHolder),i.push(I.d.IMAGE),o.push(s[t])}),u()(e))}})),b()(u()(e),"insertToSlide",(function(t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a];e.resetStylePH(i.props,o,W,void 0),r.push(I.d.IMAGE)}n.length>1&&e.showAutoLayoutTips()})),b()(u()(e),"resetStylePH",(function(t,n,r,i){if(e.imgIndex=e.imgIndex+1,(null==i?void 0:i.type)===x.a.PIC)return e.resetPICPlaceHolder(t,n,i);var a=e.getSlideSize(r,t),o=a.slideWidth,c=a.slideHeight,s=e.getImgNextSize(n,o,c),l=s.nextWidth,u=s.nextHeight,d=(o-l)/2,f=(c-u)/2;r===W&&(d+=10*e.imgIndex,f+=10*e.imgIndex),M()(t,"left")&&(d=t.left+(o-l)/2),M()(t,"top")&&(f=t.top+(c-u)/2),n.style=r===W?{position:"absolute",left:d,top:f,rotate:void 0===t.rotate?0:t.rotate,width:l,height:u,opacity:1,bgShape:A.b.rect}:{position:"absolute",left:d,top:f,rotate:void 0===t.rotate?0:t.rotate,width:l,height:u,opacity:1,placeholder:{index:i.index,type:i.type},bgShape:A.b.rect},n.prstGeom={prstGeomType:A.b.rect}})),b()(u()(e),"resetPICPlaceHolder",(function(e,t,n){var r=t.width,i=t.height,a=e.width,o=e.height,c=a/r,s=o/i,l=c<s?s:c,u=(r*l-a)/(r*l*2),d=(i*l-o)/(i*l*2);t.style={position:"absolute",left:e.left,top:e.top,width:e.width,height:e.height,rotate:void 0===e.rotate?0:e.rotate,opacity:1,srcRect:{l:u,r:u,t:d,b:d},placeholder:{index:n.index,type:n.type}}})),e}return s()(n,[{key:"setImageUploadServiceInjectable",value:function(e){this.injectable=e}},{key:"createViewModel",value:function(){return new O}},{key:"setImageSize",value:function(e){for(var t=0;t<e.length;t++){var n,r;null!==(n=e[t])&&void 0!==n&&n.width&&(e[t].width=Object(T.C)(e[t].width)),null!==(r=e[t])&&void 0!==r&&r.height&&(e[t].height=Object(T.C)(e[t].height))}}},{key:"deleteOrAddElement",value:function(e,t,n,r){if(e.length>0){var i=t.map((function(e){var t={};return t.eleType=I.d.IMAGE,t.eleProps=e,t}));n.deletePlaceHolderAndAddNewElements(e,i)}else t.forEach((function(e){_()(e,"style.bgShape",A.b.rect)})),n.addElement(r,t)}},{key:"reportClick",value:function(){1===this.service.toolbarStateManager.lastInsertButtonClick?Object(R.c)({opername:C.e.DOC_PPT,module:C.d.PC_EDIT_INSERT,action:C.b.TOOL_IMAGE,ver10:C.f.NEW_MENUBAR}):2===this.service.toolbarStateManager.lastInsertButtonClick&&Object(R.c)({opername:C.e.DOC_PPT,module:C.d.PC_EDIT_INSERT,action:C.b.MENU_IMG,ver10:C.f.NEW_MENUBAR})}},{key:"showAutoLayoutTips",value:function(){var e,t=this,n=Object(N.getCookie)(L.a.MUTI_PICTURE_POS_SETTING);null===(e=this.injectable)||void 0===e||!e.enableQuickTool()||n&&(new Date).getTime()-n<864e5||(this.setCookieForLayoutTips(),j.a.show({message:B.l.t("多图插入成功，可尝试"),action:B.l.t("批量图片布局"),type:"success",duration:5e3,onClickAction:function(){t.service.quickToolDialogManager.promise().then((function(e){e.showDialog(L.a.MUTI_PICTURE_POS_SETTING)}))}}))}},{key:"setCookieForLayoutTips",value:function(){var e=(new Date).getTime();document.cookie="".concat(L.a.MUTI_PICTURE_POS_SETTING," = ").concat(e,";path=/")}},{key:"getSlideSize",value:function(e,t){var n=0,r=0;return e===z?(n=t.width,r=t.height):(n=t.slideWidth,r=t.slideHeight),{slideWidth:n,slideHeight:r}}},{key:"getImgNextSize",value:function(e,t,n){var r=e.width,i=e.height,a=r,o=i;if(r>t||i>n){var c=t/r,s=n/i,l=c<s?c:s;a=r*l,o=i*l}return{nextWidth:a,nextHeight:o}}}]),n}(S.a)},c4e98dd4ab:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("3ef2352f0b"),u=n.n(l),d=(n("c6244f7705"),n("081c8cafea"),n("4bbb5840d5"),n("e70264714e")),f=n("457452e346"),p=["image/png","image/jpeg","image/gif","image/bmp","image/svg+xml"],v=function(){function e(){o()(this,e)}var t;return s()(e,[{key:"getImageBlobAndString",value:(t=i()(u.a.mark((function e(t,n,r){var i,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==r?void 0:r.copyToImage.generateImageUrl(n);case 2:return i=e.sent,null==t||t.remove(),e.next=6,this.getImageBlob(i);case 6:return a=e.sent,e.abrupt("return",{imgStr:i,imgBlob:a});case 8:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"getImageBlob",value:function(e){return this.dataBase64ToBlob(e)}},{key:"dataBase64ToBlob",value:function(e){var t=new Blob([],{type:f.a.IMAGE_PNG});if(!this.isBase64Png(e))return t;var n=d.b.convertDataUriToBlob(e);return n||t}},{key:"isBase64Png",value:function(e){return!(!e||"string"!=typeof e)&&e.startsWith("data:image/png;base64")}}]),e}();t.b=v},d289e8c7fb:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"CHUNK_SIZE",(function(){return J})),n.d(t,"SIZE_MAX_MD5",(function(){return q})),n.d(t,"SIZE_MIN_MD5",(function(){return Q})),n.d(t,"RETRY_MAX_COUNT",(function(){return Z})),n.d(t,"SECRET_KEY_PATH",(function(){return $})),n.d(t,"PARSE_FILE_PATH",(function(){return ee})),n.d(t,"PARSE_RESULT_PATH",(function(){return te})),n.d(t,"SLIDE_URL_PATH",(function(){return ne})),n.d(t,"ABORT_UPLOAD",(function(){return re})),n.d(t,"UPLOAD_PERCENT",(function(){return ie})),n.d(t,"PARSE_PERCENT",(function(){return ae})),n.d(t,"SIMULATION_PARSE_MAX_COUNT",(function(){return oe})),n.d(t,"delay",(function(){return ce})),n.d(t,"promisifyCos",(function(){return se})),n.d(t,"promisifyNet",(function(){return le})),n.d(t,"errorRecord",(function(){return ue})),n.d(t,"default",(function(){return de}));n("342844cefa"),n("a84962d637"),n("8ee19818c4"),n("bcb5d93d36");var r,i,a,o,c,s,l,u,d,f,p,v,h,g,m,b,y,E,S=n("176815363d"),w=n.n(S),O=n("9132715560"),T=n.n(O),I=n("6a364eb35c"),R=n.n(I),C=n("2dc700e1e6"),x=n.n(C),A=n("85d0a7609b"),k=n.n(A),P=n("3ef2352f0b"),M=n.n(P),D=(n("c6244f7705"),n("081c8cafea"),n("b1e2246d82"),n("8e7cce0ada"),n("c9a7ecac4d"),n("85d48ef22b"),n("2a6f332b5e"),n("94965cc6d4"),n("963f2eaace"),n("3bf1976a4f"),n("bd80bf2d0f"),n("af802ec74b"),n("6e20b6a7d8"),n("405b4a5e2b"),n("8a35b54c1d"),n("c554310b5c"),n("b0c77d1072")),_=n.n(D),N=n("8a87f57c32"),L=n.n(N),F=n("9f996cd882"),j=n.n(F),B=n("7cb7923785"),U=n.n(B),G=n("d3d31c86eb"),H=n("9da6335152"),z=n("3f15ca3004"),W=n.n(z),V=n("020899bf26"),K=n("db0c73f5df");function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){k()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=1048576,q=20971520,Q=10485760,Z=3,$="//".concat(window.location.hostname,"/v1/import/secretKey"),ee="//".concat(window.location.hostname,"/v1/import/parse"),te="//".concat(window.location.hostname,"/v1/import/query_parse_progress"),ne="//".concat(window.location.hostname,"/v1/import/file"),re="//".concat(window.location.hostname,"/impexp/cancelimport"),ie=80,ae=100-ie,oe=10,ce=function(e){return new Promise((function(t){setTimeout(t,e)}))};function se(e){return function(t){return new Promise((function(n,r){return e(t,(function(e,t){return e?r(e):n(t)}))}))}}function le(e){return function(t){return new Promise((function(n,r){return e(X(X({},t),{},{success:function(e){return n(e)},error:function(e){return r(e)}}))}))}}function ue(e){return function(t,n,r){var i=r.value;r.value=function(){try{for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i.apply(this,n)}catch(t){var o=t.message,c=t.stack,s={name:r.name,message:o,stack:c};null==e||e.call(this,s),Promise.reject(s)}}}}var de=(r=ue((function(e){Object(G.c)({opername:H.e.PAGING_SELECTION,module:H.d.SLIDE_UPLOAD,action:H.b.GET_SECRET_KEY,ver6:JSON.stringify(e)})})),i=Reflect.metadata("design:type",Function),a=Reflect.metadata("design:paramtypes",[]),o=ue((function(e){Object(G.c)({opername:H.e.PAGING_SELECTION,module:H.d.SLIDE_UPLOAD,action:H.b.UPLOAD_SINGLE_CHUNK,ver6:JSON.stringify(e)})})),c=Reflect.metadata("design:type",Function),s=Reflect.metadata("design:paramtypes",[void 0,void 0]),l=ue((function(){})),u=Reflect.metadata("design:type",Function),d=Reflect.metadata("design:paramtypes",[]),f=ue((function(e){Object(G.c)({opername:H.e.PAGING_SELECTION,module:H.d.SLIDE_UPLOAD,action:H.b.START_PASE_SLIDE,ver6:JSON.stringify(e)})})),p=Reflect.metadata("design:type",Function),v=Reflect.metadata("design:paramtypes",[]),h=ue((function(e){Object(G.c)({opername:H.e.PAGING_SELECTION,module:H.d.SLIDE_UPLOAD,action:H.b.GET_SLIDE_TEXT,ver6:JSON.stringify(e)})})),g=Reflect.metadata("design:type",Function),m=Reflect.metadata("design:paramtypes",[void 0,void 0]),E=y=function(){function t(){T()(this,t),k()(this,"cancelled",!1),k()(this,"progressCb",void 0),k()(this,"passwordCb",void 0),k()(this,"cos",void 0),k()(this,"file",void 0),k()(this,"fileMD5",""),k()(this,"fileMD5List",new Set),k()(this,"userDomain",""),k()(this,"password",""),k()(this,"secretKey",void 0),k()(this,"uploadId",void 0),k()(this,"fileBuffer",void 0)}var n,r,i,a,o,c,s,l,u,d,f,p;return R()(t,[{key:"updatePassword",value:function(e){this.password=e}},{key:"uploadSlideFile",value:(p=w()(M.a.mark((function e(t){var n,r,i,a=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",r=a.length>2?a[2]:void 0,i=a.length>3?a[3]:void 0,e.prev=3,this.cancelled=!1,e.next=7,this.calculateMD5(t);case 7:return this.fileMD5=e.sent,e.next=10,this.upload(t,n,r,i);case 10:return e.abrupt("return",this.getSlideUrl());case 13:e.prev=13,e.t0=e.catch(3),this.cancel(),Promise.reject(e.t0);case 17:case"end":return e.stop()}}),e,this,[[3,13]])}))),function(e){return p.apply(this,arguments)})},{key:"parseSlideFile",value:(f=w()(M.a.mark((function e(t){var n,r,i,a,o,c=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:"",r=c.length>2?c[2]:void 0,i=c.length>3?c[3]:void 0,e.prev=3,this.cancelled=!1,e.next=7,this.calculateMD5(t);case 7:if(this.fileMD5=e.sent,!this.fileIsExist()){e.next=12;break}null===(a=this.progressCb)||void 0===a||a.call(this,{ret:0,progress:ie}),e.next=14;break;case 12:return e.next=14,this.upload(t,n,r,i);case 14:return e.next=16,this.startPraseSlide();case 16:return o=e.sent,e.next=19,ce(1e3);case 19:return e.abrupt("return",this.getSlideText(o.operation_id));case 22:return e.prev=22,e.t0=e.catch(3),e.next=26,this.cancel();case 26:Promise.reject(e.t0);case 27:case"end":return e.stop()}}),e,this,[[3,22]])}))),function(e){return f.apply(this,arguments)})},{key:"calculateMD5",value:function(t){var n=this;return new Promise((function(r,i){if(!t)return i("no file");var a=new FileReader;a.onloadend=function(){var a=w()(M.a.mark((function a(o){var c,s,l,u;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if((null==o||null===(c=o.target)||void 0===c?void 0:c.result)instanceof ArrayBuffer){a.next=2;break}return a.abrupt("return",i("file read error"));case 2:s=e.from(o.target.result),n.fileBuffer=s,t.size>q&&(l=s.slice(0,Q),u=s.slice(t.size-Q),s=e.concat([l,u])),r(j()(U.a.create(s)).toString());case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),a.readAsArrayBuffer(t)}))}},{key:"cancel",value:function(){this.cancelled=!0,this.fileMD5List.delete(this.fileMD5)}},{key:"upload",value:(d=w()(M.a.mark((function e(t){var n,r,i,a,o=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,i=o.length>3?o[3]:void 0,Object.assign(this,{file:t,userDomain:n,passwordCb:i,progressCb:r}),e.next=6,this.getSecretKey();case 6:return this.secretKey=e.sent,e.next=9,this.initMultiUploadTool();case 9:return e.next=11,this.startUploadMultiChunks();case 11:return a=e.sent,e.next=14,this.completeMultiUpload(a);case 14:this.fileMD5List.add(this.fileMD5);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"fileKey",get:function(){return this.secretKey.Key}},{key:"stopUpload",get:function(){return this.cancelled||!this.secretKey}},{key:"getSecretKey",value:(u=w()(M.a.mark((function e(){var t,n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=le(_.a.ajaxPost),e.next=3,t({url:$,type:"json",param:{Files:[{fileMD5:this.fileMD5,FileName:this.file.name}]}});case 3:return n=e.sent,e.abrupt("return",X(X(X({},n),W()(["TmpSecretId","TmpSecretKey","Token"].map((function(e){return[e,n[e]&&atob(n[e])]})))),{},{Key:n.CosKeyList[0].CosFileKey}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"initCOS",value:function(){var e=this.secretKey,t=e.TmpSecretId,n=e.TmpSecretKey,r=e.Token,i=e.StartTime,a=e.ExpiredTime;return new L.a({getAuthorization:function(e,o){o({TmpSecretId:t,TmpSecretKey:n,XCosSecurityToken:r,StartTime:i,ExpiredTime:a,ScopeLimit:!0})}})}},{key:"initMultiUploadTool",value:(l=w()(M.a.mark((function e(){var t,n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cancelled){e.next=2;break}return e.abrupt("return");case 2:return this.cos=this.initCOS(),t=se(this.cos.multipartInit.bind(this.cos)),e.next=6,t({Bucket:this.secretKey.Bucket,Region:this.secretKey.Region,Key:this.secretKey.Key});case 6:n=e.sent,this.uploadId=n.UploadId;case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"uploadSingleChunk",value:(s=w()(M.a.mark((function e(t){var n,r,i,a=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.prev=1,r=se(this.cos.multipartUpload.bind(this.cos)),e.next=5,r({Bucket:this.secretKey.Bucket,Region:this.secretKey.Region,Key:this.secretKey.Key,UploadId:this.uploadId,PartNumber:t+1,Body:this.file.slice(t*J,(t+1)*J)});case 5:return i=e.sent,e.abrupt("return",i.ETag);case 9:if(e.prev=9,e.t0=e.catch(1),!(n>=Z)){e.next=13;break}return e.abrupt("return",Promise.reject(e.t0));case 13:return e.next=15,ce(1e3);case 15:return e.abrupt("return",this.uploadSingleChunk(t,n+1));case 16:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return s.apply(this,arguments)})},{key:"startUploadMultiChunks",value:(c=w()(M.a.mark((function e(){var t,n,r,i,a=this;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cancelled&&this.uploadId){e.next=2;break}return e.abrupt("return");case 2:return t=new Array(Math.ceil(this.file.size/J)).fill(""),n=[],r=t.length,i=t.map((function(e,t){return a.uploadSingleChunk(t).then((function(e){var i;n[t]=e;var o=n.filter((function(e){return!!e})).length,c=Math.round(o/r*ie);null===(i=a.progressCb)||void 0===i||i.call(a,{ret:0,progress:c})}))})),e.next=8,Promise.all(i);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"completeMultiUpload",value:(o=w()(M.a.mark((function e(t){var n,r,i,a,o;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=se(this.cos.multipartComplete.bind(this.cos)),r=this.secretKey,i=r.Bucket,a=r.Region,o=r.Key,e.abrupt("return",n({Bucket:i,Region:a,Key:o,UploadId:this.uploadId,Parts:null==t?void 0:t.map((function(e,t){return{ETag:e,PartNumber:t+1}}))}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"startPraseSlide",value:(a=w()(M.a.mark((function e(){var t,n,r,i,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.stopUpload){e.next=2;break}return e.abrupt("return",{});case 2:return a=le(_.a.ajaxPost),e.abrupt("return",a({url:ee,param:{filename:this.file.name,fileKey:this.fileKey,password:this.password,needDataVersion:null===(t=V.a.ClientVarsService())||void 0===t||null===(n=t.getClientVars().collab_client_vars)||void 0===n?void 0:n.dver,globalPadId:null!==(r=V.a.ClientVarsService())&&void 0!==r&&r.isLocalEdit()?"":null===(i=V.a.ClientVarsService())||void 0===i?void 0:i.getClientVars().globalPadId}}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getSlideText",value:(i=w()(M.a.mark((function e(t){var n,r,i,a,o,c,s=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:0,!this.stopUpload){e.next=3;break}return e.abrupt("return",{});case 3:return r=le(_.a.ajaxGet),e.next=6,r({url:te,param:{operationId:t}});case 6:if(i=e.sent,a=i.code,o=i.progress,0!==a||100===o){e.next=13;break}return null===(c=this.progressCb)||void 0===c||c.call(this,{code:a,progress:(n<oe?n/oe*ae:ae-1)+ie}),e.next=12,this.getSlideTextDelay(n);case 12:return e.abrupt("return",this.getSlideText(t,n+1));case 13:return e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getSlideTextDelay",value:(r=w()(M.a.mark((function e(t){var n,r;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=t*(n=2e3))<2e4)){e.next=4;break}return e.abrupt("return",ce(n));case 4:if(!(r<6e4)){e.next=6;break}return e.abrupt("return",ce(5*n));case 6:return e.abrupt("return",ce(15*n));case 7:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"getSlideUrl",value:(n=w()(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.stopUpload){e.next=2;break}return e.abrupt("return",{});case 2:return t=le(_.a.ajaxPost),e.abrupt("return",t({url:ne,param:{xsrf:Object(K.b)(),folder_Id:"/",operation_id:this.uploadId,filename:this.file.name,md5:this.fileMD5,cos_file_key:this.fileKey}}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fileIsExist",value:function(){return this.fileMD5List.has(this.fileMD5)}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}]),t}(),k()(y,"instance",void 0),b=E,x()(b.prototype,"getSecretKey",[r,i,a],Object.getOwnPropertyDescriptor(b.prototype,"getSecretKey"),b.prototype),x()(b.prototype,"uploadSingleChunk",[o,c,s],Object.getOwnPropertyDescriptor(b.prototype,"uploadSingleChunk"),b.prototype),x()(b.prototype,"startUploadMultiChunks",[l,u,d],Object.getOwnPropertyDescriptor(b.prototype,"startUploadMultiChunks"),b.prototype),x()(b.prototype,"startPraseSlide",[f,p,v],Object.getOwnPropertyDescriptor(b.prototype,"startPraseSlide"),b.prototype),x()(b.prototype,"getSlideText",[h,g,m],Object.getOwnPropertyDescriptor(b.prototype,"getSlideText"),b.prototype),b)}.call(this,n("ec247fcea0").Buffer)},e2a15884de:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("14502724a6"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("85d0a7609b"),u=n.n(l),d=(n("8ee19818c4"),function(){function e(){var t=this;o()(this,e),u()(this,"serviceList",void 0),u()(this,"result",void 0),u()(this,"serviceDelegates",void 0),u()(this,"onResolve",(function(e){var n,r,a=i()(e,2),o=a[0],c=a[1];c?null===(n=window)||void 0===n||n.log.error(c):(null===(r=window)||void 0===r||r.log.info("get result!!: ",o),t.setSelectedResult=o,t.serviceList.forEach((function(e){if("attachmentManager"===e)t.serviceDelegates.attachmentManager.insertAttachmentDirectly([o])})))}))}return s()(e,[{key:"setServiceDelegates",value:function(e){this.serviceDelegates=e}},{key:"getSelectedResult",get:function(){return this.result}},{key:"setSelectedResult",set:function(e){this.result=e}}]),e}())},ebd85bf338:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="&imageMogr2/format/png"},ebfafdff96:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-wrapper-modal-3lpzy{width:388px;height:320px}.index-wrapper-modal-3lpzy .index-wrapper-progress-1m8Tr{margin:48px auto;min-height:138px;display:flex;flex-direction:column;align-items:center}.index-wrapper-modal-3lpzy .index-wrapper-progress-1m8Tr img{width:70px;height:70px}.index-wrapper-modal-3lpzy .index-wrapper-progress-1m8Tr .index-wrapper-status-jw4er{margin-top:18px;color:#333;font-size:16px;line-height:16px}.index-wrapper-modal-3lpzy .index-wrapper-progress-1m8Tr .index-wrapper-tips-iKyVc{margin-top:14px;color:#777;font-size:14px;line-height:20px;white-space:pre-line;text-align:center}.index-wrapper-modal-3lpzy .index-wrapper-progress-1m8Tr .index-wrapper-import-file-circle-3VobV{position:relative}.index-wrapper-modal-3lpzy .index-wrapper-progress-1m8Tr .index-wrapper-import-file-circle-3VobV #index-wrapper-circle-Dscbm{transition:stroke-dasharray .25s;-webkit-transform:rotate(-90deg) translateX(-70px);transform:rotate(-90deg) translateX(-70px)}.index-wrapper-cancel-warn-modal-LG5_S{width:388px}.index-wrapper-cancel-warn-modal-LG5_S .dui-modal-content{min-height:0}.index-wrapper-cancel-warn-modal-body-1pAb8{width:100%}.index-wrapper-cancel-warn-modal-caption-IYOSi{font-size:14px;color:#333}",""]),t.locals={modal:"index-wrapper-modal-3lpzy",progress:"index-wrapper-progress-1m8Tr",status:"index-wrapper-status-jw4er",tips:"index-wrapper-tips-iKyVc","import-file-circle":"index-wrapper-import-file-circle-3VobV",circle:"index-wrapper-circle-Dscbm","cancel-warn-modal":"index-wrapper-cancel-warn-modal-LG5_S","cancel-warn-modal-body":"index-wrapper-cancel-warn-modal-body-1pAb8","cancel-warn-modal-caption":"index-wrapper-cancel-warn-modal-caption-IYOSi"}},ed6338ea75:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return L}));var r=n("1f925d7f50"),i=n.n(r),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),s=n.n(c),l=n("85d0a7609b"),u=n.n(l),d=n("2dc700e1e6"),f=n.n(d),p=(n("f1054791f4"),n("af802ec74b"),n("69084d01d3")),v=n.n(p),h=n("52d461bc51"),g=n.n(h),m=(n("73b854064b"),n("bd29e2df90")),b=n.n(m),y=n("ab5eb40518"),E=n.n(y),S=n("1b4cdd6a36"),w=n.n(S),O=n("e792a3169a"),T=n.n(O),I=n("39092784fc"),R=n.n(I),C={insert:"head",singleton:!1},x=(T()(R.a,C),R.a.locals||{}),A=n("5fac0349d3"),k={sheet:A.a.t("表格"),doc:A.a.t("文档"),slide:A.a.t("幻灯片"),form:A.a.t("收集表")};function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var i=w()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return E()(this,n)}}var M,D,_=function(e){b()(n,e);var t=P(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"handleNewPageClick",value:function(){this.props.importFunction.newPageImport&&this.props.importFunction.newPageImport()}},{key:"handleInsertClick",value:function(){this.props.importFunction.insertPageImport&&this.props.importFunction.insertPageImport()}},{key:"handleAnnexInsertClick",value:function(){this.props.importFunction.annexInsertImport&&this.props.importFunction.annexInsertImport()}},{key:"render",value:function(){var e=this;return v.a.createElement("div",{className:x.importContainer},v.a.createElement("div",{className:x.importTitle},A.a.t("导入本地文件")),v.a.createElement("div",{className:x["import-content-wrapper"]},this.props.importFunction.newPageImport&&v.a.createElement("div",{className:x["import-button-wrapper"],onClick:function(){return e.handleNewPageClick()}},v.a.createElement("div",{className:x["import-button-large-line"]},A.a.t("新建在线"),k[this.props.type]||this.props.type),v.a.createElement("div",{className:x["import-button-small-line"]},A.a.t("可随时查看，在线协作"))),this.props.importFunction.insertPageImport&&v.a.createElement("div",{className:x["import-button-wrapper"],onClick:function(){return e.handleInsertClick()}},v.a.createElement("div",{className:x["import-button-large-line"]},A.a.t("选择页面插入到当前文档")),v.a.createElement("div",{className:x["import-button-small-line"]},A.a.t("将在当前页面后追加"))),this.props.importFunction.annexInsertImport&&v.a.createElement("div",{className:x["import-button-wrapper"],onClick:function(){return e.handleAnnexInsertClick}},v.a.createElement("div",{className:x["import-button-large-line"]},A.a.t("以附件插入当前文档")),v.a.createElement("div",{className:x["import-button-small-line"]},A.a.t("可在线预览和下载")))))}}]),n}(v.a.Component),N=n("d5c3deb8c7"),L=(M=function(){function e(){var t=this;o()(this,e),i()(this,"visible",D,this),u()(this,"type",void 0),u()(this,"importFunction",void 0),u()(this,"modal",void 0),u()(this,"showModal",(function(){t.modal=g.a.confirm({title:null,footer:null,content:t.renderModalContent(),style:{width:400},onClose:function(){t.setVisible(!1)}})})),u()(this,"closeModal",(function(){t.modal&&(t.modal.close(),t.modal=null,t.updateData({type:"slide",importFunction:{}}))}))}return s()(e,[{key:"updateData",value:function(e){var t=this;return this.chain((function(){t.type=e.type,t.importFunction=Object.assign({},t.importFunction,e.importFunction)}))}},{key:"setVisible",value:function(e){this.visible=e,e?this.showModal():this.closeModal()}},{key:"getVisible",value:function(){return this.visible}},{key:"renderModalContent",value:function(){return v.a.createElement(_,{type:this.type,importFunction:this.importFunction})}},{key:"chain",value:function(e){return e(),this}}]),e}(),D=f()(M.prototype,"visible",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M)},fe7418aa16:function(e,t,n){"use strict";n.r(t),n.d(t,"MobileDriveSelectorPanelService",(function(){return O}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var r=n("85d0a7609b"),i=n.n(r),a=n("176815363d"),o=n.n(a),c=n("9132715560"),s=n.n(c),l=n("6a364eb35c"),u=n.n(l),d=n("bd29e2df90"),f=n.n(d),p=n("ab5eb40518"),v=n.n(p),h=n("1b4cdd6a36"),g=n.n(h),m=n("3ef2352f0b"),b=n.n(m),y=(n("c6244f7705"),n("081c8cafea"),n("0f9a03a227"));function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var O=function(e){f()(r,e);var t,n=w(r);function r(){return s()(this,r),n.apply(this,arguments)}return u()(r,[{key:"show",value:(t=o()(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.serviceList,r=t.config,this.serviceList=n,e.next=4,y.a.getInstance().showDriveSelectorPanel({config:S(S({},r),{},{onResolve:this.onResolve.bind(this)})});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),r}(n("e2a15884de").a)}}]);
//# sourceMappingURL=slide-async~907e9098-29d867.js.map
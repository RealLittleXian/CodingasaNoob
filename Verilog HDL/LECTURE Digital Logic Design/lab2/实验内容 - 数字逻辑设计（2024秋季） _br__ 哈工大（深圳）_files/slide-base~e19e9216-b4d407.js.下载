(this.webpackJsonp=this.webpackJsonp||[]).push([["base~e19e9216"],{"10a677037a":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i="text"},"1476298fae":function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),s=n.n(l),c=n("79fc58c7b0"),d=n("3a2def422a"),u=n("f4e26884cf"),f=(n("73b854064b"),n("547611bd96")),h=n.n(f),p=n("bd29e2df90"),v=n.n(p),g=n("ab5eb40518"),m=n.n(g),y=n("1b4cdd6a36"),b=n.n(y),S=(n("3bf1976a4f"),function(){function e(){var t=this;r()(this,e),s()(this,"dragStartTime",void 0),s()(this,"startMousePosition",void 0),s()(this,"mouseDownProps",void 0),s()(this,"stopDrag",(function(e){e.preventDefault(),e.stopPropagation(),t.dragStartTime||t.mouseDownProps.dragEnd(e),t.startMousePosition=null})),s()(this,"handleMove",(function(e,n){var i=t.getEventCoordinates(e);t.checkDelayTimeAndCoords(n,i)?(t.dragStartTime=null,t.mouseDownProps.dragStart(e,t.startMousePosition)):t.dragStartTime||(e.stopPropagation(),t.mouseDownProps.onDrag(e))})),s()(this,"getEventCoordinates",(function(e){var t,n,i=e.nativeEvent||e;return{x:null!=i&&null!==(t=i.touches)&&void 0!==t&&t[0]?i.touches[0].clientX:i.clientX,y:null!=i&&null!==(n=i.touches)&&void 0!==n&&n[0]?i.touches[0].clientY:i.clientY}}))}return o()(e,[{key:"startDrag",value:function(e){this.dragStartTime=Date.now(),this.startMousePosition=this.getEventCoordinates(e.event),this.mouseDownProps=e}},{key:"checkDelayTimeAndCoords",value:function(e,t){return this.dragStartTime&&Date.now()-this.dragStartTime>e&&(t.x!==this.startMousePosition.x||t.y!==this.startMousePosition.y)}}]),e}());function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m()(this,n)}}var E=function(e){v()(n,e);var t=k(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),s()(h()(e),"handleMouseDownOnElement",(function(t){document.addEventListener("mousemove",e.handleMouseMove),document.addEventListener("mouseup",e.handleDragStop),e.startDrag(t)})),s()(h()(e),"handleDragStop",(function(t){document.removeEventListener("mousemove",e.handleMouseMove),document.removeEventListener("mouseup",e.handleDragStop),e.stopDrag(t)})),s()(h()(e),"handleMouseMove",(function(t){t.preventDefault();e.handleMove(t,100)})),e}return n}(S);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m()(this,n)}}var M=function(e){v()(n,e);var t=I(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),s()(h()(e),"isEditing",void 0),s()(h()(e),"handleTouchStartOnElement",(function(t){document.body.addEventListener("touchmove",e.handleTouchMove,{passive:!1}),document.body.addEventListener("touchend",e.handleDragStop),e.isEditing=t.isEditing,e.startDrag(t)})),s()(h()(e),"handleDragStop",(function(t){document.body.removeEventListener("touchmove",e.handleTouchMove),document.body.removeEventListener("touchend",e.handleDragStop),e.stopDrag(t)})),s()(h()(e),"handleTouchMove",(function(t){var n;if(!(e.isEditing||(t.preventDefault(),t.stopPropagation(),(null==t||null===(n=t.touches)||void 0===n?void 0:n.length)>1))){e.handleMove(t,-1)}})),e}return n}(S);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var w=function(){function e(t){var n=this;r()(this,e),s()(this,"startMousePosition",void 0),s()(this,"sizeAtStart",void 0),s()(this,"delegate",void 0),s()(this,"scale",void 0),s()(this,"relativeProps",void 0),s()(this,"isCtrlDown",void 0),s()(this,"pcDragLogic",void 0),s()(this,"mobileDragLogic",void 0),s()(this,"size",void 0),s()(this,"sizeOnSlide",void 0),s()(this,"handleMouseDownOnElement",(function(e){var t;e.isDraggable&&1===(null===(t=e.event)||void 0===t?void 0:t.nativeEvent.which)&&(n.scale=e.scale,n.relativeProps=e.relativeProps,n.size=e.size,n.sizeOnSlide=e.sizeOnSlide,n.pcDragLogic.handleMouseDownOnElement({event:e.event,dragStart:n.startDrag,onDrag:n.handleMove,dragEnd:n.stopDrag}))})),s()(this,"handleTouchStartOnElement",(function(e){e.isDraggable&&(n.scale=e.scale,n.relativeProps=e.relativeProps,n.size=e.size,n.sizeOnSlide=e.sizeOnSlide,n.mobileDragLogic.handleTouchStartOnElement({event:e.event,isEditing:e.isEditing,dragStart:n.startDrag,onDrag:n.handleMove,dragEnd:n.stopDrag}))})),s()(this,"startDrag",(function(e,t){var i;n.startMousePosition=t,n.isCtrlDown=Object(u.a)(e),n.sizeAtStart=n.isCtrlDown?n.sizeOnSlide:n.size,null===(i=n.delegate)||void 0===i||i.onDragStartOnElement(n.sizeAtStart,e)})),s()(this,"stopDrag",(function(e){var t;null===(t=n.delegate)||void 0===t||t.onDragStopOnElement(c.b.MOVE,e),n.startMousePosition&&(n.startMousePosition=null),n.sizeAtStart&&(n.sizeAtStart=null)})),s()(this,"handleMove",(function(e){var t,i=n.getEventCoordinates(e),r=n.targetSizeOnMove(i,e);null===(t=n.delegate)||void 0===t||t.onDragOnElement(e,n.sizeAtStart,r,c.b.MOVE)})),s()(this,"getEventCoordinates",(function(e){var t,n,i=e.nativeEvent||e;return{x:null!=i&&null!==(t=i.touches)&&void 0!==t&&t[0]?i.touches[0].clientX:i.clientX,y:null!=i&&null!==(n=i.touches)&&void 0!==n&&n[0]?i.touches[0].clientY:i.clientY}})),this.delegate=t,this.pcDragLogic=new E,this.mobileDragLogic=new M}return o()(e,[{key:"targetSizeOnMove",value:function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.sizeAtStart),i=(e.x-this.startMousePosition.x)/this.scale/1,r=(e.y-this.startMousePosition.y)/this.scale/1;if(t.shiftKey&&(Math.abs(i)>Math.abs(r)?r=0:i=0),!this.isCtrlDown){var a=d.a.getOffsetWithRelative(this.relativeProps,i,r);i=a.offsetX,r=a.offsetY}return n.left||(n.left=0),n.top||(n.top=0),n.left+=i,n.top+=r,n}}]),e}()},"278320107d":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDEwIDE2Ij4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgZmlsbD0iIzgxODY4RiI+CiAgICAgICAgICAgIDxnPgogICAgICAgICAgICAgICAgPGc+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEuNjI1IDE1LjQ1M0wuMzY4IDE0LjE5NiA2LjY1MyA3LjkxLjM2OCAxLjYyNSAxLjYyNS4zNjhsNy41NDMgNy41NDMtNy41NDMgNy41NDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjggLTE2KSB0cmFuc2xhdGUoMjggMTQpIG1hdHJpeCgtMSAwIDAgMSAxMCAyKSIvPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K"},"2ef9a3e750":function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i,r,a,o,l,s=n("9b674918eb"),c=n.n(s),d=n("176815363d"),u=n.n(d),f=n("1f925d7f50"),h=n.n(f),p=n("9132715560"),v=n.n(p),g=n("6a364eb35c"),m=n.n(g),y=n("85d0a7609b"),b=n.n(y),S=n("2dc700e1e6"),k=n.n(S),E=(n("f1054791f4"),n("3ef2352f0b")),I=n.n(E),M=(n("c6244f7705"),n("081c8cafea"),n("af802ec74b"),n("8a35b54c1d"),n("bd80bf2d0f"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("5fac0349d3")),P=n("d23788dda5"),w=n("d5c3deb8c7"),x=n("4f3b15d017"),O=n("e0a67dc3fe"),A=n("4e7af1026b"),C=n("05d181ac40"),R=n("b74ee0edd6"),D=n.n(R),T=n("82f2dc9440"),L=n.n(T),F=n("020899bf26"),j=n("fccb99d836"),B=["onFetchPage","onClose"],z=["onClose"],U=["onClose"];function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=(i=w.q,r=w.d,a=function(){function e(t){var i=this;v()(this,e),h()(this,"isImageCopying",o,this),b()(this,"copyPasteManager",void 0),b()(this,"selectionService",void 0),b()(this,"uiDataService",void 0),b()(this,"watermarkManager",void 0),b()(this,"exportImage",u()(I.a.mark((function e(){var t,n,r=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},!x.default.isMobile){e.next=8;break}if(null!==(n=F.a.ContentStatusManager())&&void 0!==n&&n.isDocumentReady()){e.next=5;break}return i.showLoadingTips(),e.abrupt("return");case 5:return e.next=7,i.exportImageMobile(t);case 7:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,i.exportImagePC(t);case 11:case"end":return e.stop()}}),e)})))),b()(this,"prepareExportImage",u()(I.a.mark((function e(){var t,n=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},x.default.isMobile){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,i.exportImageMobile(G({isLoadingExportImage:!0,isMobile:!0},t));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))),b()(this,"addWatermaskOption",u()(I.a.mark((function e(){var t,n,r,a,o,l=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},e.next=3,i.watermarkManager.promise();case 3:n=e.sent,n.watermarkInfo.show&&(r=n.watermarkInfo,a=r.type,o=r.text,t.docWatermark=Object.assign({variant:a,content:o,placement:"tile",size:n.getWaterMarkSizeForExportImage()},n.isShowGuestWaterMark()?{content2:n.nickName}:{}));case 6:case"end":return e.stop()}}),e)})))),b()(this,"createSlideReaction",(function(e){var t,n=w.r((function(){return i.uiDataService.slideModelList.length}),(function(t){e.set({pagesCount:t})})),r=null===(t=F.a.SDKDataServices.EventManager())||void 0===t?void 0:t.mutationEvents.onCommitCommand((function(){return e.invalidate()}));return function(){n(),null==r||r()}})),b()(this,"exportImageCommon",u()(I.a.mark((function e(){var t,n,r,a,o,l,s,d,f=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=f.length>0&&void 0!==f[0]?f[0]:{}).onFetchPage,r=t.onClose,a=c()(t,B),o=function(){},0===(l=i.uiDataService.presentation.children.filter((function(e){return e.isShowInPlay}))).length&&(l=i.uiDataService.presentation.children),j.a.isExportingToImage=!0,s=G(G({pagesCount:l.length,onFetchPage:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=u()(I.a.mark((function e(t,r){var a,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==n?void 0:n(t,r);case 2:return o=l[t-1],e.abrupt("return",null===(a=i.copyPasteManager)||void 0===a?void 0:a.getSlideDataToCanvas([o],r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),onClose:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null==r||r(),j.a.isExportingToImage=!1,o()})),watermarkSecurityCheck:!C.a.IS_LOCAL_EDIT},a),i.getConfigExtraOpt()),i.addWatermaskOption(s),e.next=10,Object(P.a)(s);case 10:return d=e.sent,o=i.createSlideReaction(d),e.abrupt("return",d);case 13:case"end":return e.stop()}}),e)})))),h()(this,"exportImageMobile",l,this),b()(this,"exportImagePC",u()(I.a.mark((function e(){var t,n,r,a,o=arguments;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=o.length>0&&void 0!==o[0]?o[0]:{}).onClose,r=c()(t,z),a=G({concurrency:1,onClose:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null==n||n()}))},r),e.next=5,i.exportImageCommon(a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))),b()(this,"getConfigExtraOpt",(function(){var e,t=!1,n=!1;return null===(e=O.a.getConfig(A.k.exportImgVip))||void 0===e||e||(t=!0,n=!0),{disableVipValidation:t,disableWatermarkContentInput:n}})),this.slideRenderStateManager=t,t.getVisiblePageDisplayPromise().then((function(){Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55")]).then(n.bind(null,"bbb3fbcf7a")).then((function(e){var t;e.componentPropsBridge.setProps({shareConfig:{showExportImage:(t=u()(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.exportImage(t);case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}})}))}))}var t;return m()(e,[{key:"setCopyPasteManager",value:function(e){this.copyPasteManager=e}},{key:"setSelectionService",value:function(e){this.selectionService=e}},{key:"setUiDataService",value:function(e){this.uiDataService=e}},{key:"setWatermarkManager",value:function(e){this.watermarkManager=e}},{key:"addFakeCurrentSlide",value:(t=u()(I.a.mark((function e(){var t,n,i,r,a,o,l;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.copyPasteManager&&null!==(t=this.selectionService)&&void 0!==t&&t.currentSlide){e.next=2;break}return e.abrupt("return");case 2:return this.removeFakeCurrentSlide(),e.next=5,this.copyPasteManager.getSlideDataToCanvas([null===(n=this.selectionService)||void 0===n?void 0:n.currentSlide],1,this.copyPasteManager.getCopyCanVasOptions());case 5:return i=e.sent,e.next=8,i.toDataURL();case 8:r=e.sent,a=document.createElement("div"),o=document.createElement("img"),a.setAttribute("id","export-image-fake-modal"),o.setAttribute("src",r),a.append(o),null==(l=document.getElementById("select-view"))||l.insertBefore(a,null==l?void 0:l.firstElementChild);case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"removeFakeCurrentSlide",value:function(){var e=document.getElementById("export-image-fake-modal");null==e||e.remove()}},{key:"showLoadingTips",value:function(){(x.default.isMobile?D.a:L.a).show({message:M.a.t("数据正在加载中，请稍侯"),autoClose:!0,duration:3e3})}}]),e}(),o=k()(a.prototype,"isImageCopying",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=k()(a.prototype,"exportImageMobile",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return u()(I.a.mark((function t(){var n,i,r,a,o=arguments;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=(n=o.length>0&&void 0!==o[0]?o[0]:{}).onClose,r=c()(n,U),e.isImageCopying=!0,a=G({concurrency:3,onClose:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null==i||i(),e.isImageCopying=!1})),isLocal:C.a.IS_MOBILE_LOCAL_EDIT},r),t.next=6,e.exportImageCommon(a);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))}}),a)},"31068517f9":function(e,t,n){"use strict";n.d(t,"a",(function(){return ee}));n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("963f2eaace"),n("c6244f7705"),n("b1e2246d82"),n("8aebbf296a"),n("f45588a8ad"),n("de37db1287");var i,r,a,o,l=n("1f925d7f50"),s=n.n(l),c=n("9132715560"),d=n.n(c),u=n("6a364eb35c"),f=n.n(u),h=n("2dc700e1e6"),p=n.n(h),v=(n("f1054791f4"),n("85d0a7609b")),g=n.n(v),m=(n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("8ee19818c4"),n("342844cefa"),n("9657b29818")),y=n("e0e8dd9366"),b=n("efc1955963"),S=n("c45b58bbe8"),k=n("d5c3deb8c7"),E=n("2c0f58c21b"),I=n("f6115d1d70"),M=n("d3d31c86eb"),P=n("c6c7cf6a47"),w=n("5fac0349d3"),x=n("8930941e65"),O=n("787f07bc3b"),A=n("ee6bb53310"),C=n.n(A),R=n("c73625d763"),D=n.n(R),T=n("8f58e78419"),L=n.n(T),F=n("a63e675687"),j=n("9789b08c01"),B=n("ea3a38d9d4"),z=n("e5a826a0ff"),U=n("5cdbac46e8"),N=n("c9c92622ff"),G=n("672a8f3b69"),_=n("e0b2192bab"),V=n("02f00c4a7b"),H=n("f216b3624d"),K=n("836e76da54"),W=n("ed2cd44ea8"),q=n("382929c8da"),Y=n("10a677037a");function J(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=(i={},g()(i,y.d.SHAPE,["border","fillBackground","effect"]),g()(i,y.d.CONNECTOR,["border"]),g()(i,y.d.GROUP,[]),g()(i,y.d.IMAGE,["border","fillBackground","effect","alpha","image"]),g()(i,y.d.TABLE,[]),i),ee=(r=Reflect.metadata("design:type",Object),a=function(){function e(t){var n=this;d()(this,e),g()(this,"id",q.a.FORMAT_BRUSH),s()(this,"formatBrushState",o,this),g()(this,"_isContinuous",!1),g()(this,"services",void 0),g()(this,"clearFormatBrushState",(function(){n.formatBrushState.data&&(n.formatBrushState={data:null})})),g()(this,"onElementSelectionMouseUp",(function(){var e;null!==(e=n.services.animBrushManager)&&void 0!==e&&e.animBrushState?n.onCancelBrush():n.formatBrushState.data&&(n.services.userPriviledgeService.pptEditorState>U.b.EDITABLE?n.services.tipsManager.showCannotEditTips():n.applyStyle(),n._isContinuous||n.onCancelBrush())})),this.services=t}return f()(e,[{key:"processMenuItemData",value:function(e,t){if(t===B.a.TOOLBAR||t===B.a.QUICK_SETTING){var n=w.a.t("格式刷，双击可重复使用"),i=!0;this.formatBrushState.data&&(n=w.a.t("退出格式刷(Esc)"),i=!1),e.tipMsg=n,e.canDoubleClick=i}var r=!!this.formatBrushState.data,a=!1,o=this.services.selectionService.selectedElements;if(1===o.length){var l,s=null===(l=o.selectedArray)||void 0===l?void 0:l[0];a=s instanceof b.a||s instanceof S.a||s instanceof I.a}e.enable=r||a&&this.services.userPriviledgeService.pptEditorState<U.b.COPYABLE}},{key:"processMenuItemValues",value:function(e){var t=this.formatBrushState.data;return e[q.a.FORMAT_BRUSH]=t,e}},{key:"onClickButton",value:function(){this.formatBrushState.data?this.onCancelBrush():(this.beginBrush(),Object(M.c)({opername:"doc_ppt",module:"format_brush",action:"thin"}))}},{key:"beginBrush",value:function(){if(!this.services.animBrushManager.animBrushState){var e=this.getProps();(e.textStyle||e.propNumber)&&(this.formatBrushState=e),this.log("copied ".concat(JSON.stringify(e)," props"))}}},{key:"onDoubleClickButton",value:function(){this._isContinuous=!0,this.beginBrush(),Object(M.c)({opername:"doc_ppt",module:"format_brush",action:"double"})}},{key:"onCancelBrush",value:function(){this._isContinuous=!1,this.clearFormatBrushState()}},{key:"getProps",value:function(){var e,t="shape",n={},i=0,r=!1,a={},o=this.services.selectionService.selectedElements;if(o.length){var l,s,c,d,u=null===(l=o.selectedArray)||void 0===l?void 0:l[0];if(u instanceof b.a){var f=u,h=f.tableItems[0][0];if(f.selectedCellRanges.length>0){var p=f.selectedCellRanges[0];h=f.tableItems[p.rowStart][p.colStart]}u=h,r=!0}if(null!==(s=u)&&void 0!==s&&s.editorInstance){var v=u.editorInstance.getData(),g=v.paragraphList,m=v.textBodyStyle;if(u.editorInstance.isEditing){var S=u.editorInstance.getSelectionPara();e=this.getTextSytleData(S),r=!0}else{if(g[0]){g[0].para=!0;var k=g[0],E=k.paragraphProps,I=k.paragraphCharacter;g[0].paragraphProps=Q(Q({},E),I)}e=this.getTextSytleData(g)}if(e=Q(Q({},e),W.a.getTextBodyStyle(m)),r)return{data:t=Y.a,textStyle:e}}if(Object(H.a)(u))c=$[y.d.IMAGE];else c=null!==(d=$[u.type])&&void 0!==d?d:[];var M,P=J(c);try{for(P.s();!(M=P.n()).done;){var w,x,O,A,R=M.value,D=null!==(w=null===(x=u)||void 0===x||null===(O=x.props)||void 0===O||null===(A=O.style)||void 0===A?void 0:A[R])&&void 0!==w?w:null;"border"===R?C()(n,"style.".concat(R),this.getBorderProps(D)):C()(n,"style.".concat(R),D),i+=1}}catch(e){P.e(e)}finally{P.f()}u.scene3d&&C()(a,"scene3d",u.scene3d),u.shape3d&&C()(a,"shape3d",u.shape3d)}return{data:t,srcProps:n,propNumber:i,textStyle:e,threeD:a}}},{key:"getBorderProps",value:function(e){return e&&!e.color&&!e.gradFill&&0===e.width?Q(Q({},e),{},{color:null}):e}},{key:"getTextSytleData",value:function(e){var t,n=null,i=null,r=J(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(null===n){var o,l=[],s=J(a.textRuns||[]);try{for(s.s();!(o=s.n()).done;){var c=o.value;l.push(c);break}}catch(e){s.e(e)}finally{s.f()}n=Q({},a)}if(a.para){i=Q({},a);break}}}catch(e){r.e(e)}finally{r.f()}return{textRunStyle:W.a.getTextRunStyle(n,0),paraStyle:i?W.a.getParagraphStyle(i):{}}}},{key:"applyStyle",value:function(){var e=this,t=this.services.selectionService.selectedElements;if(t.length||t.selectedArrayForType){var n=t.selectedArrayForType(z.a.SLIDE);if(!this.isIframeSelectedElement(n)){var i=this.formatBrushState;if((i=Object(k.v)(i)).data===Y.a){var r,a,o,l=null===(r=t.selectedArray)||void 0===r?void 0:r[0];if(l instanceof b.a){var s=l,c=!1,d=[];return s.props.items.forEach((function(e,t){var n=[];e.forEach((function(e,r){if(!e.hMerge&&!e.vMerge&&s.cellSelectedState(t,r,s.selectedRange)){var a=void 0;if(e.editorInstance){var o=e.editorInstance.getData(!0),l=null;if(e.editorInstance.isEditing){if(!e.editorInstance.isExpanded())return void n.push(void 0);l=e.editorInstance.getSelection()}Object.keys(i.textStyle||{}).forEach((function(e){Object(x.a)(i.textStyle[e]).isObj()?Object.keys(i.textStyle[e]).forEach((function(t){i.textStyle[e]["raw-".concat(t)]=!0})):i.textStyle["raw-".concat(e)]=!0})),(a=W.a.setStyleForTextBody(o,i.textStyle,l)).textBodyStyle=o.textBodyStyle,c=!0}n.push(a)}else n.push(void 0)})),d.push(n)})),void(c&&s.updateTableAllParagraphList({items:d}))}var u=null===(a=l.editorInstance)||void 0===a?void 0:a.isEditing,f=null===(o=l.editorInstance)||void 0===o?void 0:o.getSelection();if(u&&f){if(!l.editorInstance.isExpanded())return;this.updateTextFontSize(l,i);var h=l.editorInstance.getData(!0),p=W.a.setStyleForTextBody(h,i.textStyle,f).paragraphList;return void this.commitChangeForEditing(l,h,p)}}else(n[0].editorInstance&&i.textStyle||i.propNumber)&&Object(m.b)((function(){var t,r=n[0],a=J(e.getUpdateItems(r,i));try{for(a.s();!(t=a.n()).done;){var o,l,s=t.value;if(s.sdkProps&&K.a.sdkV3UpdateAndRemoveProps(s.element.sdkData,s.sdkProps,s.sdkRemoveProps),s.sdkParagraph){var c=s.sdkParagraph.txBody;V.a.sdkV3UpdateParagraphList(s.element.sdkData,c)}null===(o=s.element.get3DProperty())||void 0===o||o.updateShape3D(i.threeD.shape3d),null===(l=s.element.get3DProperty())||void 0===l||l.updateScene3D(i.threeD.scene3d)}}catch(e){a.e(e)}finally{a.f()}}))}}}},{key:"commitChangeForEditing",value:function(e,t,n){Object(m.b)((function(){_.a.addParagraphListRawSignProps(n,n),e.updateParagraphList(n)}))}},{key:"updateTextFontSize",value:function(e,t){var n=e.editorInstance.getResizeLevel();if(!Object(x.a)(n).isNullOrUndefined()){var i,r,a=Object(O.c)(null==t||null===(i=t.textStyle)||void 0===i||null===(r=i.textRunStyle)||void 0===r?void 0:r.fontSize,n);a&&C()(t,"textStyle.textRunStyle.fontSize",a)}}},{key:"isIframeSelectedElement",value:function(e){return!e.length||Object(N.o)(e[0])}},{key:"getUpdateItems",value:function(e,t){var n=[],i=this.services.borderSketchManager;return function e(r){var a,o;r.type===y.d.SHAPE&&L()(t.srcProps,"style.fillBackground.image")&&(D()(t.srcProps,"style.image")||D()(t.srcProps,"style.alpha"))?a=$[y.d.IMAGE]:a=null!==(o=$[r.type])&&void 0!==o?o:[];var l,s={style:{}},c=0,d=J(a);try{for(d.s();!(l=d.n()).done;){var u=l.value;if(D()(t.srcProps,"style.".concat(u))){var f=t.srcProps.style[u];C()(s,"style.".concat(u),Object(j.a)(f,!0)),c+=1}}}catch(e){d.e(e)}finally{d.f()}if(r instanceof E.a){var h,p=J(r.children);try{for(p.s();!(h=p.n()).done;){e(h.value)}}catch(e){p.e(e)}finally{p.f()}}else if(r instanceof S.a&&r.editorInstance&&t.textStyle){var v,g;null!==(v=s.style)&&void 0!==v&&null!==(g=v.fillBackground)&&void 0!==g&&g.grpFill&&(s.style.fillBackground.grpFill=void 0);var m=r.editorInstance.getData(),b=W.a.setStyleForTextBody(m,t.textStyle),k=b.paragraphList,M=b.textBodyStyle;Object(F.b)(r,{textBodyStyle:M,paragraphList:k}),P.a.getInstance().updateElementProps(r,s,{textBodyStyle:M,paragraphList:k}),i.updatePathWithFormatBrush(r,s.style);var w=Object(j.a)(s,!0,[G.a]),x=r.prepareUpdateAndRemoveSdkProps(w);_.a.addParagraphListRawSignProps(k,k);var O=r.prepareSDKParagraphListData(k,M);n.push({element:r,sdkProps:x.update,sdkRemoveProps:x.remove,sdkParagraph:O})}else if(c>0){var A;if(r instanceof I.a&&null!==(A=s.style)&&void 0!==A&&A.image){var R,T=null===(R=r.props)||void 0===R?void 0:R.imageType;"gif"===T?s.style.image=void 0:"svg+xml"!==T&&"svg"!==T||(s.style.image.colorTemperature=void 0,s.style.image.saturate=void 0,s.style.image.sharpenSoften=void 0)}i.updatePathWithFormatBrush(r,s.style);var B=Object(j.a)(s,!0,[G.a]),z=r.prepareUpdateAndRemoveSdkProps(B);n.push({element:r,sdkProps:z.update,sdkRemoveProps:z.remove})}}(e),n}},{key:"log",value:function(e){console.log("FormatBrush:".concat(e))}}]),e}(),o=p()(a.prototype,"formatBrushState",[k.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:null}}}),a)},"3a2def422a":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=(n("6e20b6a7d8"),n("5cdbac46e8")),s=n("b684da8955"),c=function(){function e(){r()(this,e)}return o()(e,null,[{key:"selectable",value:function(e){return e.selectable&&e.currentEditState<=l.b.SELECTABLE}},{key:"editable",value:function(e){return e.currentEditState===l.b.EDITABLE}},{key:"draggable",value:function(e){return e.currentEditState===l.b.EDITABLE}},{key:"sizeInfo",value:function(e){var t=e.props.style;return{width:t.width,height:t.height,left:t.left,top:t.top,centerX:t.width/2+t.left,centerY:t.height/2+t.top}}},{key:"sizeInfoOnSlide",value:function(e){var t,n=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).frameOnSlide();return{width:n.width,height:n.height,left:n.left,top:n.top,centerX:n.width/2+n.left,centerY:n.height/2+n.top}}},{key:"flipInfo",value:function(e){var t=e.props.style;return{flipH:void 0===t.flipH?0:t.flipH,flipV:void 0===t.flipV?0:t.flipV}}},{key:"flipInfoOnSlide",value:function(e){var t,n=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).frameOnSlide();return{flipH:void 0===n.flipH?0:n.flipH,flipV:void 0===n.flipV?0:n.flipV}}},{key:"getOffsetWithRelative",value:function(e,t,n){var i=t,r=n;if(e){if(e.relativeRotate){var a=e.relativeRotate%360*Math.PI/180,o=Math.cos(a),l=Math.sin(a),s=r*o-i*l;i=i*o+r*l,r=s}1===e.relativeFlipH&&(i=-i),1===e.relativeFlipV&&(r=-r)}return{offsetX:i,offsetY:r}}},{key:"getGroupChildrenDirections",value:function(e){return e.map((function(e){var t=1;return Object(s.a)(e,(function(e){var n=e.getFrame().getFrameInfo();n.flipH!==n.flipV&&(t*=-1)})),t}))}}]),e}()},"553ec40726":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".snapshot-list-list-cAfpw{width:100%}.snapshot-list-item-2RrGe{padding:16px 0 16px 32px;box-sizing:border-box}.snapshot-list-time-3Bg89{font-weight:600;font-size:14px;color:rgba(0,0,0,.64);line-height:20px;margin-bottom:8px;text-align:left}.snapshot-list-actions-38gCH{display:flex;align-items:center}.snapshot-list-action-2PWbh+.snapshot-list-action-2PWbh{margin-left:8px}",""]),t.locals={list:"snapshot-list-list-cAfpw",item:"snapshot-list-item-2RrGe",time:"snapshot-list-time-3Bg89",actions:"snapshot-list-actions-38gCH",action:"snapshot-list-action-2PWbh"}},"5589c66022":function(e,t,n){"use strict";var i=n("14502724a6"),r=n.n(i),a=n("176815363d"),o=n.n(a),l=n("1f925d7f50"),s=n.n(l),c=n("9132715560"),d=n.n(c),u=n("6a364eb35c"),f=n.n(u),h=n("85d0a7609b"),p=n.n(h),v=n("2dc700e1e6"),g=n.n(v),m=(n("f1054791f4"),n("3ef2352f0b")),y=n.n(m),b=(n("c6244f7705"),n("081c8cafea"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("b8217400dc"),n("e6f68cdf2e"),n("22569efd03"),n("d5c3deb8c7")),S=n("da1378f0cf"),k=n.n(S),E=n("281cbdced7"),I=n.n(E),M=n("f8fc8e0087"),P=n("82f2dc9440"),w=n.n(P),x=n("ac50752089"),O=n("d9812f1c6f"),A=n("5fac0349d3"),C=n("ec5cae33cb"),R=n("fdddc95d9b"),D=n("020899bf26"),T=(n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("3bf1976a4f"),n("bd80bf2d0f"),n("9f996cd882")),L=n.n(T),F=n("7264fb5e8f");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z,U,N,G=function(){function e(t,n,i){d()(this,e),p()(this,"requestingPool",{}),this.logPrefix=t,this.socket=n,this.logger=i}var t,n;return f()(e,[{key:"send",value:(n=o()(y.a.mark((function t(n){var i,r,a,o,l,s,c=arguments;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=c.length>1&&void 0!==c[1]?c[1]:{},r=c.length>2&&void 0!==c[2]?c[2]:{},a=c.length>3&&void 0!==c[3]?c[3]:0,o=c.length>4?c[4]:void 0,l=L()(JSON.stringify({cmd:n,data:i,customParam:r,taskId:a})).toString(),!this.requestingPool[l]){t.next=8;break}return null===(s=this.logger)||void 0===s||s.info("[".concat(this.logPrefix,"] REQUEST CMD <").concat(n,"> failed, reason: command is requseting")),t.abrupt("return",e.makeResponse(!1,{message:"command is requseting"}));case 8:return t.prev=8,this.requestingPool[l]=!0,t.next=12,this.sendDirectly(n,i,r,a,o);case 12:return t.abrupt("return",t.sent);case 13:return t.prev=13,delete this.requestingPool[l],t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[8,,13,16]])}))),function(e){return n.apply(this,arguments)})},{key:"sendDirectly",value:(t=o()(y.a.mark((function t(n){var i,r,a,o,l,s=this,c=arguments;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>1&&void 0!==c[1]?c[1]:{},r=c.length>2&&void 0!==c[2]?c[2]:{},a=c.length>3&&void 0!==c[3]?c[3]:0,o=c.length>4?c[4]:void 0,l=B({timeout:F.DEFAULT_SEND_MESSAGE_TIMEOUT,maxRetryCount:3,waitAcceptCmd:[]},r),t.abrupt("return",new Promise((function(t){s.socket.sendMessage({cmd:n,taskId:a,data:JSON.stringify(i),customParam:l,additionalFieldsToHead:o,onError:function(n,i,r,a){if(a&&0!==a.errCode){var o,l=a.errCode;return null===(o=s.logger)||void 0===o||o.info("[".concat(s.logPrefix,"] REQUEST CMD <").concat(i,"> failed, reason: send error ").concat(l)),t(e.makeResponse(!1,{errorCode:l,message:"send error ".concat(l)}))}return t(e.makeResponse(!0))},onsend:function(n,i,r,a){var o,l,c,d,u=null==a?void 0:a.errCode,f=null==a||null===(o=a.response)||void 0===o||null===(l=o.onpost)||void 0===l?void 0:l.result;return 0!==u||0!==f?(null===(d=s.logger)||void 0===d||d.info("[".concat(s.logPrefix,"] REQUEST CMD <").concat(i,"> failed, reason: post error ").concat(u,", retCode ").concat(f)),t(e.makeResponse(!1,{errorCode:u,message:"post error ".concat(u,", retCode ").concat(f)}))):(null===(c=s.logger)||void 0===c||c.info("[".concat(s.logPrefix,"] REQUEST CMD <").concat(i,"> succeeded")),t(e.makeResponse(!0)))}})})));case 6:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]),e}();function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}p()(G,"makeResponse",(function(e,t){return{success:e,error:t}})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.NON_COMPLIANCE_TITLE=12e3]="NON_COMPLIANCE_TITLE",e[e.DOC_HAS_BEEN_USED=64e3]="DOC_HAS_BEEN_USED",e[e.EMPTY_PRESENT_INFO=64003]="EMPTY_PRESENT_INFO",e[e.HOST_NOT_EXIST=64004]="HOST_NOT_EXIST"}(z||(z={})),function(e){e.host="HOST",e.audience="AUDIENCE"}(U||(U={})),function(e){e.meeting="meeting"}(N||(N={}));var H,K,W,q,Y,J,X,Z=function(){function e(t,n,i,r){d()(this,e),p()(this,"requestManager",void 0),p()(this,"isInited",!1),p()(this,"biztype",void 0),p()(this,"bizid",void 0),this.socket=t,this.clientVarService=n,this.apiService=i,this.editingPresentManager=r,this.requestManager=new G("EditingPresent",this.socket,this.logger)}var t,n,i;return f()(e,[{key:"logger",get:function(){return D.a.Infra.Logger()}},{key:"init",value:(i=o()(y.a.mark((function e(t){var n,i,r,a,o,l,s,c,d,u,f,h,p,v,g,m,b;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.bizid,o=t.biztype,l=t.initRole,this.biztype=o,this.bizid=a,s=this.clientVarService.getClientVars(),c=s.globalPadId,d=void 0===c?"":c,u=s.tinyid,f=void 0===u?"":u,null===(n=this.logger)||void 0===n||n.info("[EditingPresent] sdk init, biztype: ".concat(o," bizid: ").concat(a," docId: ").concat(d," uid: ").concat(f)),e.next=7,this.getPresetInfo(d,a);case 7:if(null!==(h=e.sent)){e.next=12;break}return null===(p=this.logger)||void 0===p||p.info("[EditingPresent] get presentInfo failed, roleType is forced to AUDIENCE"),this.isInited=!0,e.abrupt("return",{role:U.audience});case 12:if(null===(i=this.logger)||void 0===i||i.info("[EditingPresent] get presentInfo ".concat(JSON.stringify(h))),(v=l)!==U.host||h.hostInfo){e.next=20;break}return null===(g=this.logger)||void 0===g||g.info("[EditingPresent] setPresentInfo"),e.next=18,this.apiService.setPresentInfo(d,a,f);case 18:e.next=22;break;case 20:b=null===(m=h.hostInfo)||void 0===m?void 0:m.uid,v=b&&b===f?U.host:U.audience;case 22:return null===(r=this.logger)||void 0===r||r.info("[EditingPresent] user role is ".concat(v)),this.isInited=!0,e.abrupt("return",V(V({},h),{},{role:v}));case 25:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"hostBroadcast",value:(n=o()(y.a.mark((function e(t){var n,i,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isInited){e.next=2;break}throw new Error("not inited");case 2:return n=this.clientVarService.getClientVars(),i=n.globalPadId,r=V({docid:void 0===i?"":i,biztype:this.biztype,bizid:this.bizid},t),e.abrupt("return",this.requestManager.send("PRESENT_INFO",r));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"handleEditingPresentNotice",value:function(e){var t,n;return!!this.isInited&&(this.bizid&&e.bizid===this.bizid?(null===(t=this.logger)||void 0===t||t.info("[EditingPresent] host broadcast ".concat(JSON.stringify(e))),this.editingPresentManager.onReceivePresentInfo(e),!0):(null===(n=this.logger)||void 0===n||n.info("[EditingPresent] host broadcast bizid [".concat(e.bizid,"] dont match [").concat(this.bizid,"]")),!1))}},{key:"convertPresentInfo",value:function(e){var t=JSON.parse(e),n=t.hostInfo,i=t.editPos,r={hostInfo:n};return"string"==typeof i&&(r.editPos=JSON.parse(i)),r}},{key:"getPresetInfo",value:(t=o()(y.a.mark((function e(t,n){var i,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.apiService.getPresentInfo(t,n);case 3:if(i=e.sent,(r=i.data).retcode===z.SUCCESS){e.next=9;break}if(![z.HOST_NOT_EXIST,z.EMPTY_PRESENT_INFO].includes(r.retcode)){e.next=8;break}return e.abrupt("return",{});case 8:throw"failed with retcode ".concat(r.retcode);case 9:return e.abrupt("return",this.convertPresentInfo(r.result));case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e,n){return t.apply(this,arguments)})}]),e}(),Q=Z,$=n("aba9dcef64");!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.NON_COMPLIANCE_TITLE=12e3]="NON_COMPLIANCE_TITLE",e[e.DOC_HAS_BEEN_USED=64e3]="DOC_HAS_BEEN_USED",e[e.EMPTY_PRESENT_INFO=64003]="EMPTY_PRESENT_INFO",e[e.HOST_NOT_EXIST=64004]="HOST_NOT_EXIST"}(X||(X={}));var ee=k()((function(){w.a.show({message:A.a.t("你可以自由浏览此文档"),type:"success",autoClose:!0})})),te=(H=Reflect.metadata("design:type",void 0===U?Object:U),K=Reflect.metadata("design:type",String),W=function(){function e(t){var n=this;d()(this,e),s()(this,"role",q,this),s()(this,"isPresentFollowing",Y,this),p()(this,"hostAvatar",void 0),s()(this,"hostSlideId",J,this),p()(this,"candidateHostSlideId",null),p()(this,"hasRegisterEndFollowEvent",!1),p()(this,"editingPresent",void 0),p()(this,"debouncedBroadcast",I()((function(e){var t,i;e&&(n.editingPresent.hostBroadcast({slideId:e,avatar:null!==(t=null===(i=D.a.ClientVarsService())||void 0===i?void 0:i.getClientVars().userPic)&&void 0!==t?t:""}),window.log.info("[EditingPresent] [host] slideId change to ".concat(e)))}),300)),p()(this,"onReceivePresentInfo",(function(e){window.log.info("[EditingPresent] [audience] receive notice ".concat(JSON.stringify(e))),e&&(n.hostAvatar=e.avatar,n.setHostSlideId(e.slideId))})),this.selectionService=t,this.init()}var t;return f()(e,[{key:"init",value:(t=o()(y.a.mark((function e(){var t,n,i,a,o,l,s,c,d,u,f=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.a.SDKDataServices.EventManager.promise().then((function(e){e.socketEvents.onPresentInfo(f.onReceivePresentInfo)})),e.next=3,Object(x.b)();case 3:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=7;break}e.t0=void 0!==t;case 7:if(!e.t0){e.next=11;break}e.t2=t,e.next=12;break;case 11:e.t2=Object(M.getQuery)("editingPresentId");case 12:if(n=e.t2){e.next=15;break}return e.abrupt("return");case 15:return e.next=17,Promise.all([D.a.ClientVarsService.promise(),D.a.SlideAppService.promise(),$.a.CollaborationManager.promise(),$.a.OnlineApiService.promise()]);case 17:return i=e.sent,a=r()(i,4),o=a[0],l=a[1],s=a[2],c=a[3],e.next=25,l.onReadyPromise();case 25:return this.editingPresent=new Q(s.getSocket(),o,c,this),d=null,e.prev=27,e.next=30,this.editingPresent.init({biztype:N.meeting,bizid:n,initRole:"speaker"===Object(M.getQuery)("login")?U.host:U.audience});case 30:d=e.sent,e.next=40;break;case 33:if(e.prev=33,e.t3=e.catch(27),window.log.error("[EditingPresent] error whilie init",e.t3),e.t3.retCode!==X.DOC_HAS_BEEN_USED){e.next=39;break}return w.a.show({message:A.a.t("该文档已被其他会议占用，无法开启跟随模式"),type:"info",autoClose:!0}),e.abrupt("return");case 39:w.a.show({message:A.a.t("未知错误 {0}，无法开启跟随模式",{0:e.t3.retCode}),type:"info",autoClose:!0});case 40:if(d){e.next=42;break}return e.abrupt("return");case 42:this.role=d.role,this.role===U.host?this.initHost(null===(u=d.editPos)||void 0===u?void 0:u.slideId):this.initAudience(d.editPos);case 44:case"end":return e.stop()}}),e,this,[[27,33]])}))),function(){return t.apply(this,arguments)})},{key:"startPresentFollow",value:function(){this.isPresentFollowing=!0;var e=this.selectionService;null==e||e.selectedElements.clear(),e&&(e.lastMouseDownRegion=C.a.NONE),this.updateCurrentSlideByStore()}},{key:"endPresentFollow",value:function(){this.isPresentFollowing=!1,ee()}},{key:"getSlideIndex",value:function(){var e,t,n=this.findSlideIndex(this.hostSlideId),i=O.a.isMobile?null===(e=this.selectionService)||void 0===e?void 0:e.mobileCurrentDisplayIndex:null===(t=this.selectionService)||void 0===t?void 0:t.currentSlideIndex;return{hostSlideIndex:Math.max(0,n),localSlideIndex:void 0===i?-1:i}}},{key:"initHost",value:function(e){var t=this;if(e)this.switchToSlideById(e);else{var n,i,r=null===(n=this.selectionService)||void 0===n||null===(i=n.currentSlide)||void 0===i?void 0:i.id;r&&this.debouncedBroadcast(r)}O.a.isMobile?Object(b.r)((function(){var e;return null===(e=t.selectionService)||void 0===e?void 0:e.mobileCurrentDisplayIndex}),(function(e){var n,i=null===(n=t.selectionService)||void 0===n?void 0:n.slides[e];null!=i&&i.id&&t.debouncedBroadcast(i.id)})):Object(b.r)((function(){var e,n;return null===(e=t.selectionService)||void 0===e||null===(n=e.currentSlide)||void 0===n?void 0:n.id}),this.debouncedBroadcast)}},{key:"initAudience",value:function(e){var t=this;if(e){var n,i,r;this.hostAvatar=e.avatar;var a=null!==(n=e.slideId)&&void 0!==n?n:null===(i=this.selectionService)||void 0===i||null===(r=i.slides[0])||void 0===r?void 0:r.id;this.setHostSlideId(a)}Object(b.r)((function(){var e;return null===(e=t.selectionService)||void 0===e?void 0:e.slides.length}),(function(){t.candidateHostSlideId&&t.setHostSlideId(t.candidateHostSlideId)}))}},{key:"setHostSlideId",value:function(e){"string"==typeof e&&e&&(-1!==this.findSlideIndex(e)?(this.hostSlideId=e,this.candidateHostSlideId=null,this.isPresentFollowing&&this.updateCurrentSlideByStore(),this.hasRegisterEndFollowEvent||this.registerEndFollowEvent()):this.candidateHostSlideId=e)}},{key:"registerEndFollowEvent",value:function(){var e=this;this.hasRegisterEndFollowEvent=!0,D.a.SDKDataServices.EventManager.promise().then((function(t){t.mutationEvents.onCommitCommand((function(t){if([R.a.Editor,R.a.UndoRedo].includes(t)){if(!e.isPresentFollowing)return;window.log.info("[EditingPresent] [audience] 参会者主动发起变更, 退出跟随"),e.endPresentFollow()}}))})),Object(b.r)((function(){var t;return null===(t=e.selectionService)||void 0===t?void 0:t.lastMouseDownRegion}),(function(t){t!==C.a.EDITOR&&t!==C.a.NOTE||e.isPresentFollowing&&(window.log.info("[EditingPresent2] [audience] 参会者选中区域变更 ".concat(t,", 退出跟随")),e.endPresentFollow())})),window.addEventListener("onCurrentSlideIndexChangeByUserAction",(function(){e.isPresentFollowing&&(window.log.info("[EditingPresent] [audience] 参会者主动切换页面, 退出跟随"),e.endPresentFollow())}))}},{key:"updateCurrentSlideByStore",value:function(){window.log.info("[EditingPresent] [audience] updateCurrentSlideByStore ".concat(this.hostSlideId)),this.hostSlideId&&this.switchToSlideById(this.hostSlideId)}},{key:"switchToSlideById",value:function(e){var t=this.findSlideIndex(e);if(-1===t)return!1;if(O.a.isMobile)window.dispatchEvent(new CustomEvent("scrollSlideIntoViewByIndexMobile",{detail:{slideIndex:t}}));else{var n=this.selectionService;(null==n?void 0:n.currentSlideIndex)!==t&&(null==n||n.selectedSlides.clear(),n&&(n.currentSlideIndex=t))}return!0}},{key:"findSlideIndex",value:function(e){var t=this.selectionService;return t?t.slides.findIndex((function(t){return t.id===e})):-1}}]),e}(),q=g()(W.prototype,"role",[b.q,H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=g()(W.prototype,"isPresentFollowing",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),J=g()(W.prototype,"hostSlideId",[b.q,K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W);t.a=te},"60329c397a":function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));n("73b854064b");var i=n("14502724a6"),r=n.n(i),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),s=n.n(l),c=n("547611bd96"),d=n.n(c),u=n("bd29e2df90"),f=n.n(u),h=n("ab5eb40518"),p=n.n(h),v=n("1b4cdd6a36"),g=n.n(v),m=n("85d0a7609b"),y=n.n(m),b=n("8f58e78419"),S=n.n(b),k=n("530271770f"),E=n("9da6335152"),I=n("d3d31c86eb"),M=n("e0e8dd9366"),P=n("d9812f1c6f"),w=n("e5a826a0ff"),x=n("6664e39d13"),O=n("1476298fae"),A=n("3a2def422a"),C=n("1b0526663d"),R=n("2e2ccf062e"),D=n("9486306832");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p()(this,n)}}var L=function(e){f()(n,e);var t=T(n);function n(e,i,r,a){var l;return o()(this,n),l=t.call(this),y()(d()(l),"elementModel",void 0),y()(d()(l),"dragLogic",void 0),y()(d()(l),"multiRect",void 0),y()(d()(l),"needMouseUp",void 0),y()(d()(l),"editProcessLogic",void 0),y()(d()(l),"handledCallBack",void 0),y()(d()(l),"handleCallbackAfterDrag",void 0),y()(d()(l),"isGroupChildren",void 0),y()(d()(l),"isSmartArtChildren",void 0),y()(d()(l),"dragToSlide",void 0),y()(d()(l),"isPc",void 0),y()(d()(l),"tempElementManager",void 0),y()(d()(l),"moveElementManager",void 0),y()(d()(l),"guidesManager",void 0),y()(d()(l),"absorbManager",void 0),y()(d()(l),"snapLineService",void 0),y()(d()(l),"handleMouseDownOnElement",(function(e,t,n,i,r,a){l.initialize(t,r),l.needMouseUp=i,l.handleCallbackAfterDrag=a;var o=l.getMouseDownProps(t),s=o.isDraggable,c=o.relativeProps,d=o.size,u=o.sizeOnSlide;l.dragLogic.handleMouseDownOnElement({event:e,scale:n,isDraggable:s,relativeProps:c,size:d,sizeOnSlide:u})})),y()(d()(l),"handleTouchStartOnElement",(function(e,t,n,i,r,a){var o;if(!l.editorInstanceService.checkEditorIsEditing()){l.initialize(t,r),l.needMouseUp=i,l.handleCallbackAfterDrag=a;var s=l.getMouseDownProps(t),c=s.isDraggable,d=s.relativeProps,u=s.size,f=s.sizeOnSlide,h=null===(o=l.editorInstanceService.getEditorInstance())||void 0===o?void 0:o.isEditing;l.dragLogic.handleTouchStartOnElement({event:e,scale:n,isDraggable:c,relativeProps:d,size:u,sizeOnSlide:f,isEditing:h})}})),y()(d()(l),"handleDragStart",(function(e,t,n){l.initialize(e),l.onDragStartOnElement(t,n)})),y()(d()(l),"handleDrag",(function(e,t,n,i){l.onDragOnElement(e,t,n,i)})),y()(d()(l),"handleDragStop",(function(e,t){l.onDragStopOnElement(e,t)})),y()(d()(l),"onDragStartOnElement",(function(e,t){var n,i;if(l.multiRect=k.a.getInstance().getMultiRect(),l.emit(D.a.DRAG_START,{elementModel:l.elementModel,e:t,originalSize:e}),k.a.getInstance().calculateSnapLines(),l.editingStateManager.updateElementDraggingState(!0),l.isGroupChildren)l.handleDragStartForRootGroup(e,t);else if(l.isSmartArtChildren)l.handleDragStartForRootGroup(e,t);else{var r;if(l.linkManager.linkFloatBarService.hide(),l.needMouseUp=!1,l.handledCallBack&&l.handledCallBack(),null===(n=l.moveElementManager)||void 0===n||n.checkIsDelayUpdatePosing(),l.isPc&&null!==(i=l.tempElementManager)&&void 0!==i&&i.isMoveWithCopy(t))null===(r=l.tempElementManager)||void 0===r||r.addSelectElements();l.reportForDragStart()}})),y()(d()(l),"onDragOnElement",(function(e,t,n,i){var r,a,o;if(l.emit(D.a.DRAGGING,{elementModel:l.elementModel,e:e,nextSize:n,originalSize:t,multiRect:l.multiRect,mode:i}),l.isPc&&null!==(r=l.tempElementManager)&&void 0!==r&&r.isCopyAndMoving)o=l.handleOnCopyAndMoving(e,n,t,o,i);else if(l.isPc&&null!==(a=l.tempElementManager)&&void 0!==a&&a.isMoveWithCopy(e)){var s,c;null===(s=l.editProcessLogic)||void 0===s||s.updateOperationFrame(null),null===(c=l.tempElementManager)||void 0===c||c.addSelectElements()}else{var d;o=null===(d=l.editProcessLogic)||void 0===d?void 0:d.runConstraints(e,t,n,i,l.multiRect)}l.isGroupChildren&&l.handleDragForRootGroup(e,t,n,i,o),l.isSmartArtChildren&&l.handleDragForRootGroup(e,t,n,i,o)})),y()(d()(l),"onDragStopOnElement",(function(e,t){var n,i,r,a,o,s;if(l.emit(D.a.DRAG_STOP,{elementModel:l.elementModel,e:t}),l.multiRect=null,k.a.getInstance().handleDragResizeStop(),l.editingStateManager.updateElementDraggingState(!1),null===(n=(i=l).handleCallbackAfterDrag)||void 0===n||n.call(i),l.isGroupChildren)l.handleDragStopForRootGroup(e,t);else if(l.isSmartArtChildren)l.handleDragStopForRootSmartArt(e,t);else{var c;if(null===(r=l.editProcessLogic)||void 0===r||r.persistSize(e),null===(a=l.editProcessLogic)||void 0===a||a.updateOperationFrame(null),l.isPc&&null!==(o=l.tempElementManager)&&void 0!==o&&o.isCopyAndMoving)null===(c=l.tempElementManager)||void 0===c||c.pasteElements();l.isPc&&(null===(s=l.tempElementManager)||void 0===s||s.clear()),l.clear()}})),y()(d()(l),"handleDragStopForRootSmartArt",(function(e,t){var n,i,r;if(l.dragToSlide)l.onDragStopOnElement(e,t);else if(null===(n=l.editProcessLogic)||void 0===n||n.persistSizeForSmartArt(null===(i=l.elementModel)||void 0===i?void 0:i.rootSmartArtModel,!1),null===(r=l.editProcessLogic)||void 0===r||r.updateOperationFrameForGroup(null),P.a.isPc){var a,o,s;if(null!==(a=l.tempElementManager)&&void 0!==a&&a.isMoveWithCopy(t))null===(s=l.tempElementManager)||void 0===s||s.pasteElements();null===(o=l.tempElementManager)||void 0===o||o.clear()}l.dragToSlide=!1,l.clear()})),y()(d()(l),"handleDragStartForRootGroup",(function(e,t){var n,i,r;if(null===(n=l.moveElementManager)||void 0===n||n.checkIsDelayUpdatePosing(),l.needMouseUp&&(l.needMouseUp=!1,l.dragToSlide=!0),l.dragToSlide)l.initialize(null===(r=l.elementModel)||void 0===r?void 0:r.rootGroupModel,l.handledCallBack),l.onDragStartOnElement(e,t);else if(l.isPc&&null!==(i=l.tempElementManager)&&void 0!==i&&i.isMoveWithCopy(t)){var a;null===(a=l.tempElementManager)||void 0===a||a.addSelectElements()}l.reportForGroup()})),y()(d()(l),"handleDragForRootGroup",(function(e,t,n,i,r){var a,o;if(l.isPc&&null!==(a=l.tempElementManager)&&void 0!==a&&a.isCopyAndMoving)l.handleForCopyAndMovingOfRoot(e,n,t,i,r);else if(l.isPc&&null!==(o=l.tempElementManager)&&void 0!==o&&o.isMoveWithCopy(e)){var s,c;null===(s=l.editProcessLogic)||void 0===s||s.updateOperationFrameForGroup(null),null===(c=l.tempElementManager)||void 0===c||c.addSelectElements()}else if(l.isSmartArtChildren){var d;null===(d=l.editProcessLogic)||void 0===d||d.runConstraintsForSmartArt(e,t,n,i,null,r)}else{var u;null===(u=l.editProcessLogic)||void 0===u||u.runConstraintsForGroup(e,t,n,i,null,r)}})),y()(d()(l),"handleDragStopForRootGroup",(function(e,t){var n,i,r;if(null===(n=l.editProcessLogic)||void 0===n||n.persistSizeForGroup(null===(i=l.elementModel)||void 0===i?void 0:i.rootGroupModel,!1),null===(r=l.editProcessLogic)||void 0===r||r.updateOperationFrameForGroup(null),P.a.isPc){var a,o,s;if(null!==(a=l.tempElementManager)&&void 0!==a&&a.isMoveWithCopy(t))null===(s=l.tempElementManager)||void 0===s||s.pasteElements();null===(o=l.tempElementManager)||void 0===o||o.clear()}l.clear()})),y()(d()(l),"getMouseDownProps",(function(e){var t,n,i,r=A.a.draggable(e);l.selectionService.selectedElements.selectedArrayForType(w.a.GROUP).length>0&&(i=Object(C.c)(e));var a=null===(t=e.getFrame())||void 0===t?void 0:t.getFrameInfo(),o=null===(n=e.getFrame())||void 0===n?void 0:n.frameOnSlide();return{isDraggable:r,relativeProps:i,size:{width:a.width,height:a.height,left:a.left,top:a.top},sizeOnSlide:{width:o.width,height:o.height,left:o.left,top:o.top}}})),l.selectionService=e,l.editorInstanceService=i,l.editingStateManager=r,l.linkManager=a,l.dragLogic=new O.a(d()(l)),l.isPc=P.a.isPc,l}return s()(n,[{key:"setGuidesManagerDelegate",value:function(e){this.guidesManager=e}},{key:"setAbsorbManagerDelegate",value:function(e){this.absorbManager=e}},{key:"setSnapLineServiceDelegate",value:function(e){this.snapLineService=e}},{key:"setMoveElementManagerDelegate",value:function(e){this.moveElementManager||(this.moveElementManager=e)}},{key:"setTempElementManagerDelegate",value:function(e){this.tempElementManager||(this.tempElementManager=e)}},{key:"initialize",value:function(e,t){this.clear(),this.elementModel=e,this.editProcessLogic=new x.a(this.editingStateManager,e),this.editProcessLogic.setSelectionService(this.selectionService),this.editProcessLogic.setGuidesManagerDelegate(this.guidesManager),this.editProcessLogic.setAbsorbManagerDelegate(this.absorbManager),this.editProcessLogic.setSnapLineServiceDelegate(this.snapLineService),this.isGroupChildren=S()(e,"parent.type")===M.d.GROUP,this.isSmartArtChildren=S()(e,"parent.type")===M.d.SMART_ART,t&&(this.handledCallBack=t)}},{key:"handleOnCopyAndMoving",value:function(e,t,n,i,r){var a,o,l,s,c=i;null!==(a=this.tempElementManager)&&void 0!==a&&a.isMoveWithCopy(e)?null===(o=this.tempElementManager)||void 0===o||o.move(t.left-n.left,t.top-n.top):(null===(l=this.tempElementManager)||void 0===l||l.clear(),c=null===(s=this.editProcessLogic)||void 0===s?void 0:s.runConstraints(e,n,t,r,this.multiRect));return c}},{key:"reportForGroup",value:function(){if(1===this.selectionService.selectedElements.selectedArrayForType(w.a.GROUP).length){var e=this.selectionService.selectedElements.selectedArrayForType(w.a.GROUP),t=r()(e,1)[0],n=this.getReportInfo(t);this.reportTDW(n.tdwModule,n.action)}}},{key:"reportForDragStart",value:function(){if(1===this.selectionService.selectedElements.selectedArrayForType(w.a.SLIDE).length){var e=this.selectionService.selectedElements.selectedArrayForType(w.a.SLIDE),t=r()(e,1)[0],n=this.getReportInfo(t);this.reportTDW(n.tdwModule,n.action)}}},{key:"reportTDW",value:function(e,t){e&&t&&Object(I.c)({opername:E.e.DOC_PPT,module:e,action:t})}},{key:"getReportInfo",value:function(e){var t,n;switch(e.type){case M.d.SHAPE:t=P.a.isMobile?E.d.M_SHAPE_EDIT:E.d.PC_OBJ,n=P.a.isMobile?E.b.M_EDIT_MOVE:E.b.SHAPE_MOVE;break;case M.d.IMAGE:t=P.a.isMobile?E.d.M_PIC_EDIT:E.d.PC_OBJ,n=P.a.isMobile?E.b.M_EDIT_MOVE:E.b.IMG_MOVE;break;case M.d.TABLE:t=P.a.isMobile?E.d.M_EXCEL_EDIT:E.d.PC_TABLE_FORMAT,n=P.a.isMobile?E.b.M_EDIT_MOVE:E.b.TABLE_MOVE;break;default:t=null,n=null}return{tdwModule:t,action:n}}},{key:"handleForCopyAndMovingOfRoot",value:function(e,t,n,i,r){var a,o,l,s;null!==(a=this.tempElementManager)&&void 0!==a&&a.isMoveWithCopy(e)?null===(o=this.tempElementManager)||void 0===o||o.move(t.left-n.left,t.top-n.top):(null===(l=this.tempElementManager)||void 0===l||l.clear(),null===(s=this.editProcessLogic)||void 0===s||s.runConstraintsForGroup(e,n,t,i,null,r))}},{key:"clear",value:function(){this.elementModel=null,this.editProcessLogic=null,this.isGroupChildren=!1,this.isSmartArtChildren=!1,this.dragToSlide=!1,this.needMouseUp=!1,this.handledCallBack=void 0,this.handleCallbackAfterDrag=void 0,this.multiRect=null}}]),n}(R.a)},"62f93f77a8":function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i,r,a=n("14502724a6"),o=n.n(a),l=n("1f925d7f50"),s=n.n(l),c=n("9132715560"),d=n.n(c),u=n("6a364eb35c"),f=n.n(u),h=n("85d0a7609b"),p=n.n(h),v=n("2dc700e1e6"),g=n.n(v),m=(n("f1054791f4"),n("6e20b6a7d8"),n("8ee19818c4"),n("b86964b011")),y=n("6664e39d13"),b=n("e5a826a0ff"),S=n("e0e8dd9366"),k=n("d1f05b304b"),E=n("9da6335152"),I=n("d3d31c86eb"),M=n("d9812f1c6f"),P=n("2e684a2cea"),w=n("d5c3deb8c7"),x=n("7b0ebf3e1a"),O=n("3a2def422a"),A=(i=function(){function e(t,n,i,a){var o=this;d()(this,e),p()(this,"doubleFingerRotating",!1),s()(this,"isMobileRotatingMode",r,this),p()(this,"elementModel",void 0),p()(this,"editProcessLogic",void 0),p()(this,"isGroupChildren",void 0),p()(this,"slideTopLeft",void 0),p()(this,"scale",void 0),p()(this,"centerPointOnSlide",void 0),p()(this,"rotate",void 0),p()(this,"elementRotates",[]),p()(this,"cachedTouches",void 0),p()(this,"lastOffsetAngle",void 0),p()(this,"mouseStartPostion",void 0),p()(this,"selectedUiModels",void 0),p()(this,"groupChildrenDirections",void 0),p()(this,"isShiftKey",void 0),p()(this,"groupChildrenOffsetRotates",void 0),p()(this,"handleRotateStart",(function(e,t,n){var i;if(o.mouseStartPostion=o.getEventCoordinates(n),o.lastOffsetAngle=0,o.elementModel=e,o.isGroupChildren=(null==e||null===(i=e.parent)||void 0===i?void 0:i.type)===S.d.GROUP,o.scale=t,o.rotate=e.getFrame().getRotate(),o.slideTopLeft=o.getSlideTopLeft(),o.editProcessLogic=new y.a(o.editingStateManager,e),o.editProcessLogic.setSelectionService(o.selectionService),o.isGroupChildren)o.handleRotateStartForRootGroup();else{o.linkManager.linkFloatBarService.hide(),o.moveElementManager.checkIsDelayUpdatePosing(),o.editingStateManager.updateElementRotateState(!0);var r=o.selectionService.selectedElements;o.selectedUiModels=r.selectedArrayForType(b.a.SLIDE),o.setElementRotates(o.selectedUiModels),o.isGroupChildren||r.clear(b.a.GROUP),M.a.isMobile&&null!=n&&n.touches&&(o.cachedTouches=n.touches),o.report()}})),p()(this,"handleDoubleFingersRotate",(function(e){var t,n;if(!o.isGroupChildren){var i=o.elementModel;if(o.rotate=null!==(t=null!==(n=o.rotate)&&void 0!==n?n:null==i?void 0:i.props.style.rotate)&&void 0!==t?t:0,i){var r=o.rotateAngleWidthDomItemAndPointForDoubleFingers(o.elementModel,e,o.cachedTouches,o.rotate),a=((r=(r+360)%360)-o.rotate+360)%360;o.handleRotateForSelectedModels(a),o.cachedTouches=e.touches}}})),p()(this,"handleRotate",(function(e){if(o.isShiftKey=!(null==e||!e.shiftKey),o.isGroupChildren)o.handleRotateForRootGroup(e);else{var t=o.elementModel;if(t){var n={x:t.props.style.left+t.props.style.width/2,y:t.props.style.top+t.props.style.height/2},i=o.getMouseAngleChangeRelativeToCenterPoint(e,n),r=(i-o.lastOffsetAngle+360)%360;o.lastOffsetAngle=i,o.handleRotateForSelectedModels(r)}}})),p()(this,"updateRotateWhileRotating",(function(e){if(o.selectedUiModels){o.clearConnectorStartAndEnd();for(var t=o.selectedUiModels.length,n=0;n<t;n++){var i,r,a=null!==(i=null===(r=o.groupChildrenDirections)||void 0===r?void 0:r[n])&&void 0!==i?i:1,l=o.selectedUiModels[n];l.type!==S.d.TABLE&&(l.props.style.rotate=(e*a+360)%360,o.notifyRotate(l),o.handleRelatedModel(l))}o.rotate=(o.rotate+e)%360}})),p()(this,"handleRotateStop",(function(){var e,t;o.lastOffsetAngle=0,o.selectedUiModels=null,o.mouseStartPostion=null,o.isGroupChildren?o.handleRotateStopForRootGroup():(o.editingStateManager.updateElementRotateState(!1),null===(e=o.editProcessLogic)||void 0===e||e.persistSize(""),null===(t=o.editProcessLogic)||void 0===t||t.updateOperationFrame(null),window.dispatchEvent(new Event("resize")))})),p()(this,"handleRotateStartForRootGroup",(function(){o.moveElementManager.checkIsDelayUpdatePosing(),o.editingStateManager.updateElementRotateState(!0),o.selectedUiModels=o.selectionService.selectedElements.selectedArrayForType(b.a.GROUP),o.groupChildrenDirections=O.a.getGroupChildrenDirections(o.selectedUiModels),o.groupChildrenOffsetRotates=o.selectedUiModels.map((function(e){return e.parent.getFrame().getRotate(!0)})),o.report(),o.setElementRotates(o.selectedUiModels)})),p()(this,"handleRotateForRootGroup",(function(e){var t=o.elementModel;if(t){if(!o.centerPointOnSlide){var n,i,r=null===(n=t.getFrame)||void 0===n?void 0:n.call(t).frameOnSlide();o.centerPointOnSlide=null!==(i=Object(x.f)(r))&&void 0!==i?i:null}var a=o.getMouseAngleChangeRelativeToCenterPoint(e,o.centerPointOnSlide),l=(a-o.lastOffsetAngle+360)%360;o.lastOffsetAngle=a,o.handleRotateOfSelectedForRoot(l)}})),p()(this,"handleRotateStopForRootGroup",(function(){var e,t,n;o.editingStateManager.updateElementRotateState(!1),null===(e=o.editProcessLogic)||void 0===e||e.persistSizeForGroup(null===(t=o.elementModel)||void 0===t?void 0:t.rootGroupModel),null===(n=o.editProcessLogic)||void 0===n||n.updateOperationFrame(null),o.centerPointOnSlide=null,o.groupChildrenDirections=null,o.groupChildrenOffsetRotates=null})),p()(this,"getAdsorpAngle",(function(e,t,n){if(o.isShiftKey)return 15*Math.floor(e/15);var i=e,r=Object(P.g)(i,n,t);return Math.abs(r)<=t&&(r>0?i=Math.floor(e/n)*n:r<0&&(i=(Math.floor(e/n)+1)*n)),i})),p()(this,"notifyRotate",(function(e){var t=k.a.createObserver(e);null==t||t.notifyLocalChange()})),p()(this,"handleRelatedModel",(function(e,t){t||(t=e);for(var n=0;n<e.relatedUIModelRefs.length;n++){var i=e.relatedUIModelRefs[n];if(!o.isElementInTargetGroup(i,t)){var r=i.connectorCaculater.getUpdateStyle({rotate:e.props.style.rotate});i.updateModelStyle(r);var a=k.a.createObserver(i);null==a||a.notifyLocalChange()}}e.type===S.d.GROUP&&e.children.forEach((function(e){o.handleRelatedModel(e,t)}))})),p()(this,"getEventCoordinates",(function(e){return e?{x:e.touches?e.touches[0].clientX:e.clientX,y:e.touches?e.touches[0].clientY:e.clientY}:null})),p()(this,"getAngleOnSlide",(function(e,t){return(o.groupChildrenOffsetRotates[e]+t*o.groupChildrenDirections[e])%360})),p()(this,"convertSlideAngleToSelf",(function(e,t){return((t-o.groupChildrenOffsetRotates[e])/o.groupChildrenDirections[e]+360)%360})),this.editingStateManager=t,this.moveElementManager=n,this.selectionService=i,this.linkManager=a}return f()(e,[{key:"setIsMobileRotatingMode",value:function(e){Object(m.m)()||this.isMobileRotatingMode===e||window.dispatchEvent(new Event("resize")),this.isMobileRotatingMode=e}},{key:"setElementRotates",value:function(e){this.elementRotates=[];for(var t=0;t<e.length;t++){var n;if(e[t].props.style.rotate)this.elementRotates.push(null!==(n=e[t].props.style.rotate)&&void 0!==n?n:0);else this.elementRotates.push(0)}}},{key:"handleRotateForSelectedModels",value:function(e){if(this.selectedUiModels){this.clearConnectorStartAndEnd();for(var t=this.selectedUiModels.length,n=0;n<t;n++){var i=this.selectedUiModels[n],r=i.getFrame().getRotate(),a=this.elementRotates[n];if(i.type!==S.d.TABLE){if(i.type===S.d.CONNECTOR)i.props.style.rotate=(r+e)%360;else{a=(a+e)%360;var o=this.getAdsorpAngle(a,P.b,P.a);i.props.style.rotate=(o+360)%360,this.elementRotates[n]=a}this.notifyRotate(i),this.handleRelatedModel(i)}}this.rotate=(this.rotate+e)%360}}},{key:"handleRotateOfSelectedForRoot",value:function(e){if(this.selectedUiModels&&this.groupChildrenDirections){this.clearConnectorStartAndEnd();for(var t=this.selectedUiModels.length,n=e,i=0;i<t;i++){var r=this.selectedUiModels[i];n=e*this.groupChildrenDirections[i];var a=r.getFrame().getRotate(),o=this.elementRotates[i];if(r.type===S.d.CONNECTOR)r.props.style.rotate=(a+n)%360;else{var l=(o+n)%360,s=this.getAngleOnSlide(i,l),c=this.getAdsorpAngle(s,P.b,P.a),d=this.convertSlideAngleToSelf(i,c);r.props.style.rotate=(d+360)%360,this.elementRotates[i]=l%360}this.notifyRotate(r),this.handleRelatedModel(r)}this.rotate=(this.rotate+n)%360}}},{key:"getAction",value:function(){var e;if(1===(null===(e=this.selectedUiModels)||void 0===e?void 0:e.length))switch(o()(this.selectedUiModels,1)[0].type){case S.d.SHAPE:return E.b.SHAPE_WHIRL;case S.d.IMAGE:return E.b.IMG_WHIRL}return""}},{key:"report",value:function(){var e=this.getAction();e&&Object(I.c)({opername:E.e.DOC_PPT,module:E.d.PC_OBJ,action:e})}},{key:"isElementInTargetGroup",value:function(e,t){var n;return!!e.parent&&((null===(n=e.parent)||void 0===n?void 0:n.key)===t.key||this.isElementInTargetGroup(e.parent,t))}},{key:"getSlideTopLeft",value:function(){var e,t,n=document.getElementById("edit-panel"),i=null==n?void 0:n.getBoundingClientRect();return{x:null!==(e=null==i?void 0:i.left)&&void 0!==e?e:0,y:null!==(t=null==i?void 0:i.top)&&void 0!==t?t:0}}},{key:"rotateAngleWidthDomItemAndPointForDoubleFingers",value:function(e,t,n,i){var r,a=i;if(e&&2===(null==t||null===(r=t.touches)||void 0===r?void 0:r.length)){var o=t.touches,l=this.getTouchesAngle(o[0],o[1])-this.getTouchesAngle(n[0],n[1]);a=Math.round(a+l),a%=360}return a}},{key:"getTouchesAngle",value:function(e,t){var n=e.pageX-t.pageX,i=e.pageY-t.pageY;return 180*Math.atan2(i,n)/Math.PI}},{key:"getMouseAngleChangeRelativeToCenterPoint",value:function(e,t){if(!this.mouseStartPostion)return 0;var n={x:t.x*this.scale+this.slideTopLeft.x,y:t.y*this.scale+this.slideTopLeft.y},i=this.getEventCoordinates(e);return Object(P.d)(this.mouseStartPostion,n,i)}},{key:"clearConnectorStartAndEnd",value:function(){var e;null===(e=this.selectedUiModels)||void 0===e||e.forEach((function(e){e.type===S.d.CONNECTOR&&e.clearStartAndEnd()}))}}]),e}(),r=g()(i.prototype,"isMobileRotatingMode",[w.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i)},"6664e39d13":function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),s=n.n(l),c=(n("af802ec74b"),n("6e20b6a7d8"),n("8ee19818c4"),n("342844cefa"),n("75563bc376"),n("3bf1976a4f"),n("d5c3deb8c7")),d=n("730207179f"),u=n("e0e8dd9366"),f=n("ee6bb53310"),h=n.n(f),p=n("c73625d763"),v=n.n(p),g=n("8f58e78419"),m=n.n(g),y=n("c6c7cf6a47"),b=n("8e31e67bb3"),S=n("e5a826a0ff"),k=n("79fc58c7b0"),E=n("ffc220634f"),I=n("9657b29818"),M=n("153bd00100");function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(){function e(t,n,i){var a=this;r()(this,e),s()(this,"elementModel",void 0),s()(this,"editingStateManagerRef",void 0),s()(this,"selectionService",void 0),s()(this,"borderSketchManager",void 0),s()(this,"guidesManager",void 0),s()(this,"absorbManager",void 0),s()(this,"snapLineService",void 0),s()(this,"runConstraints",(function(e,t,n,i,r,o){var l,s=!1;if(Object(c.w)((function(){a.calFrameForSizeMap(e,o,i,r),l=a.calOffsetFrame(t,n);Object.assign({},l);if(a.elementModel){var c,d;if(0===a.elementModel.props.style.rotate)null!==(c=a.guidesManager)&&void 0!==c&&c.displayGuides&&a.guidesManager.handleDragAdsorbGuides({offsetFrame:l,originalSize:t,mode:i,model:a.elementModel,multiRect:r,sizeMap:o}),null===(d=a.absorbManager)||void 0===d||d.handleGridAbsorbElement({offsetFrame:l,originalSize:t,mode:i,model:a.elementModel,multiRect:r,sizeMap:o});a.handleSnapLineAdsorb({e:e,originalSize:t,nextSize:n,offsetFrame:l,mode:i,multiRect:r,elementModel:a.elementModel,sizeMap:o}),m()(a.elementModel,"parent.type")!==u.d.GROUP&&m()(a.elementModel,"parent.type")!==u.d.SMART_ART||(s=!0)}!s&&a.updateOperationFrame(l,o,i)})),s)return l})),s()(this,"persistSize",(function(e,t,n){var i=a.selectionService.selectedElements,r=null!=n?n:i.selectedArrayForType(S.a.SLIDE),o=[],l=[];Object(I.b)((function(){var n=r.map((function(n){try{if(n.type===u.d.TABLE){var i,r,s,c,d,f,h,p=null===(i=n.sdkData)||void 0===i||null===(r=i.store)||void 0===r||null===(s=r.data)||void 0===s||null===(c=s.graphic)||void 0===c||null===(d=c.graphicData)||void 0===d||null===(f=d.tbl)||void 0===f||null===(h=f.tr)||void 0===h?void 0:h.length;window.log.info("table-operate","persistSize",JSON.stringify({uiRowHeightsLength:n.props.rowHeights.length,sdkRowHeightsLength:p}))}}catch(e){window.log.info("table-operate-err",e)}var v,g=a.propsForUiModel({curItem:n,toRemoveUIModels:o,toRemovePropsArr:l,mode:e,needAdjustText:t});e!==k.b.MOVE&&(null===(v=a.borderSketchManager)||void 0===v||v.updatePathListWhenSizeChange(n));return g})),i=r.map((function(e){return e}));a.handleRelatedInfo(r,i,n),a.commitChange(o,i,l,n)}))})),s()(this,"runConstraintsForGroup",(function(e,t,n,i,r,o,l){o||(o=a.calOffsetFrame(t,n)),a.updateOperationFrameForGroup(o,l)})),s()(this,"updateOperationFrameForGroup",(function(e,t){Object(c.w)((function(){for(var n=a.selectionService.selectedElements.selectedArrayForType(S.a.GROUP),i=0;i<n.length;i++){var r,o=n[i];if((null==t?void 0:t.size)>1)e=null===(r=t.get(o.key))||void 0===r?void 0:r.offsetFrame;null===e?Object(d.b)(o,"operationFrame",null):a.updateSelectedUIModelFrame(o,e),a.updateRelatedInfoForConnector(o);for(var l=0;l<o.relatedUIModelRefs.length;l++){var s=o.relatedUIModelRefs[l],c=s.connectorCaculater.getUpdateStyle(e,t);s.updateModelStyle(c)}}}))})),s()(this,"persistSizeForGroup",(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,r=null!=i?i:a.selectionService.selectedElements.selectedArrayForType(S.a.GROUP),o=[],l=[],s=[],c=[];if((null!==(t=null==e?void 0:e.getFrame().getAdjustedElementsAndProps())&&void 0!==t?t:[]).forEach((function(e){e.uiModel.type!==u.d.GROUP&&(l.push(e.props),o.push(e.uiModel))})),r.forEach((function(e){a.calculateSelectedModelForGroup(e,s,c,o,l)})),a.getRelatedUIModelsChangesForGroup(r,o,l),n)return{toRemoveUIModels:s,updateModels:o,toRemovePropsArr:c,propsArr:l,selectedUiModels:r,groupModel:e};a.commitChangeForGroup(s,o,c,l,r,e)})),s()(this,"runConstraintsForSmartArt",(function(e,t,n,i,r,o,l){o||(o=a.calOffsetFrame(t,n)),a.updateOperationFrameForSmartArt(o,l)})),s()(this,"updateOperationFrameForSmartArt",(function(e,t){Object(c.w)((function(){for(var n=a.selectionService.selectedElements.selectedArrayForType(S.a.SMART_ART),i=0;i<n.length;i++){var r,o=n[i];if(console.log("log-updateOperationFrameForSmartArt",o),(null==t?void 0:t.size)>1)e=null===(r=t.get(o.key))||void 0===r?void 0:r.offsetFrame;null===e?Object(d.b)(o,"operationFrame",null):a.updateSelectedUIModelFrame(o,e)}}))})),s()(this,"persistSizeForSmartArt",(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,r=null!=i?i:a.selectionService.selectedElements.selectedArrayForType(S.a.SMART_ART),o=[],l=[],s=[],c=[];if((null!==(t=null==e?void 0:e.getFrame().getAdjustedElementsAndProps())&&void 0!==t?t:[]).forEach((function(e){var t;null===(t=a.borderSketchManager)||void 0===t||t.updatePathListWhenSizeChange(e.uiModel,e.props.style),e.uiModel.type!==u.d.SMART_ART&&(l.push(e.props),o.push(e.uiModel))})),r.forEach((function(e){a.calculateSelectedModelForGroup(e,s,c,o,l)})),a.getRelatedUIModelsChangesForGroup(r,o,l),n)return{toRemoveUIModels:s,updateModels:o,toRemovePropsArr:c,propsArr:l,selectedUiModels:r,smartArtModel:e};a.commitChangeForSmartArt(s,o,c,l,r,e)})),s()(this,"isNeedToAdjustText",(function(e,t,n){return y.a.getInstance().enableAdjustText()&&Object(b.c)(e)&&t!==k.b.MOVE&&n})),s()(this,"checkOffsetIsChanged",(function(e,t){var n=!1;return Object.keys(e).forEach((function(i){e[i]!==t[i]&&(n=!0)})),n})),s()(this,"handleSnapLineAdsorb",(function(e){var t;null===(t=a.snapLineService)||void 0===t||t.handleNotifyEvent(e)})),this.editingStateManagerRef=t,this.elementModel=n,this.borderSketchManager=i}return o()(e,[{key:"setSelectionService",value:function(e){this.selectionService||(this.selectionService=e)}},{key:"setGuidesManagerDelegate",value:function(e){this.guidesManager=e}},{key:"setAbsorbManagerDelegate",value:function(e){this.absorbManager=e}},{key:"setSnapLineServiceDelegate",value:function(e){this.snapLineService=e}},{key:"updateOperationFrame",value:function(e,t,n){var i=this;Object(c.w)((function(){for(var r=i.selectionService.selectedElements.selectedArrayForType(S.a.SLIDE),a=0;a<r.length;a++){var o,l=r[a];if((null==t?void 0:t.size)>1)e=null===(o=t.get(l.key))||void 0===o?void 0:o.offsetFrame;null===e?(Object(d.b)(l,"operationFrame",null),Object(d.b)(l,"operatingGraphicInfo",null)):i.updateForConnector(l,e,n),i.updateRelatedOperationFrame(l,e,t)}}))}},{key:"commitChangeForSmartArt",value:function(e,t,n,i,r,a){this.commitChange(e,t,n,i),(null==r?void 0:r.length)>0&&(null==a||a.getFrame().clearTempInfosWithElement(r[0]))}},{key:"updateRelatedOperationFrame",value:function(e,t,n,i){var r=this;i||(i=[]);for(var a=function(r){var a=e.relatedUIModelRefs[r];if(!i.find((function(e){return e.key===a.key}))){var o=a.connectorCaculater.getUpdateStyle(t,n);a.updateModelStyle(o),i.push(a)}},o=0;o<e.relatedUIModelRefs.length;o++)a(o);e.type===u.d.GROUP&&e.children.forEach((function(e){r.updateRelatedOperationFrame(e,t,n,i)}))}},{key:"calculateSelectedModelForGroup",value:function(e,t,n,i,r){if(e.type===u.d.CONNECTOR){var a=e.toRemoveConnectorInfoProps();a&&(t.push(e),n.push(a))}this.findIfRelatedModelNeedUpdate(i,e,r)||(i.push(e),r.push(this.frameInfoOfModel(e))),y.a.getInstance().enableAdjustText()&&this.updateConnectorInfo(e,i)}},{key:"updateConnectorInfo",value:function(e,t){var n=this;Object(b.c)(e)&&(null==t||t.forEach((function(t){if(t===e){var i,r=n.getOffsetFrame(t.props.style,e.operationFrame);null==e||null===(i=e.relatedUIModelRefs)||void 0===i||i.forEach((function(e){var t=e.connectorCaculater.getUpdateStyle(r);e.updateModelStyle(t)}))}})))}},{key:"getOffsetFrame",value:function(e,t){return{height:e.height-(null==t?void 0:t.height),width:e.width-(null==t?void 0:t.width),left:e.left-(null==t?void 0:t.left),top:e.top-(null==t?void 0:t.top),flipH:e.flipH,flipV:e.flipV,rotate:e.rotate}}},{key:"findIfRelatedModelNeedUpdate",value:function(e,t,n){for(var i=!1,r=0;r<e.length;r++)if(e[r]===t){i=!0,n[r].style.rotate=t.props.style.rotate,n[r].style.flipH=v()(t,"operationFrame.flipH")?t.operationFrame.flipH:t.props.style.flipH,n[r].style.flipV=v()(t,"operationFrame.flipV")?t.operationFrame.flipV:t.props.style.flipV,t.props.style.controlValues&&(n[r].style.controlValues=Object(c.v)(t.props.style.controlValues)),t.props.style.bgLine&&(n[r].style.bgLine=t.props.style.bgLine);break}return i}},{key:"frameInfoOfModel",value:function(e){var t=e.getFrame().getFrameInfo(!0);return{style:{left:t.left,top:t.top,width:t.width,height:t.height,flipH:t.flipH,flipV:t.flipV,rotate:e.props.style.rotate}}}},{key:"commitChangeForGroup",value:function(e,t,n,i,r,a){var o=this;Object(I.b)((function(){t.forEach((function(e){var t;null===(t=o.borderSketchManager)||void 0===t||t.updatePathListWhenSizeChange(e)})),o.commitChange(e,t,n,i)})),(null==r?void 0:r.length)>0&&(null==a||a.getFrame().clearTempInfosWithElement(r[0]))}},{key:"getRelatedUIModelsChangesForGroup",value:function(e,t,n){for(var i=0;i<e.length;i++)for(var r=e[i],a=0;a<r.relatedUIModelRefs.length;a++)this.getConnectorUpdateInfo(r,a,t,n);return{updateModels:t,propsArr:n}}},{key:"getConnectorUpdateInfo",value:function(e,t,n,i){var r=e.relatedUIModelRefs[t];r.type===u.d.CONNECTOR&&(this.findIfRelatedModelNeedUpdate(n,r,i)||(n.push(r),i.push({style:w(w({},r.operationFrame),{},{bgLine:r.props.style.bgLine||r.bgLine,controlValues:Object(c.v)(r.props.style.controlValues||r.controlValues)})})))}},{key:"updateSelectedUIModelFrame",value:function(e,t,n){var i=e.props.style.width+t.width,r=e.props.style.height+t.height;if(e.type===u.d.TABLE&&(i=t.flipH?0:i,r=t.flipV?0:r),Object(d.b)(e,"operationFrame",{left:e.props.style.left+t.left,top:e.props.style.top+t.top,width:i,height:r}),v()(t,"flipH")&&Object(d.b)(e,"operationFrame.flipH",t.flipH),v()(t,"flipV")&&Object(d.b)(e,"operationFrame.flipV",t.flipV),n!==k.b.MOVE){var a,o=null===(a=this.borderSketchManager)||void 0===a?void 0:a.getSketchPathList(e,{width:e.props.style.width+t.width,height:e.props.style.height+t.height}),l=Object(E.b)(e,e.props);(null==o?void 0:o.length)>0&&Object(d.b)(e,"operatingGraphicInfo",{controlValues:l,pathList:o})}}},{key:"updateForConnector",value:function(e,t,n){var i=!0;if(e.type===u.d.CONNECTOR){var r=e.startUIModel,a=e.endUIModel;i=this.checkIfNeedUpdateForConnector(r,e,a,i)}i&&this.updateSelectedUIModelFrame(e,t,n)}},{key:"handleRelatedInfo",value:function(e,t,n){for(var i=0;i<e.length;i++){for(var r=e[i],a=function(e){var i=r.relatedUIModelRefs[e];i.type!==u.d.CONNECTOR||t.find((function(e){return e.key===i.key}))||(t.push(i),n.push({style:w(w({},i.operationFrame),{},{bgLine:i.props.style.bgLine,controlValues:Object(c.v)(i.props.style.controlValues)})}))},o=0;o<r.relatedUIModelRefs.length;o++)a(o);r.type===u.d.GROUP&&this.handleRelatedInfo(r.children,t,n)}}},{key:"commitChange",value:function(e,t,n,i){var r,a;e.length>0?(t.forEach((function(){return n.unshift(void 0)})),e.forEach((function(){return i.push(null)})),null===(r=this.selectionService.currentSlide)||void 0===r||r.updateAndRemovePropsForElements(i,n,t.concat(e))):null===(a=this.selectionService.currentSlide)||void 0===a||a.updateElementsProps(i,t)}},{key:"propsForUiModel",value:function(e){var t=e.curItem,n=e.toRemoveUIModels,i=e.toRemovePropsArr,r=e.mode,a=e.needAdjustText,o=void 0===a||a;if(t.type===u.d.CONNECTOR){var l=t.toRemoveConnectorInfoProps();l&&(n.push(t),i.push(l))}return t.type!==u.d.TABLE||!t.operationFrame||t.props.style.width===t.operationFrame.width&&t.props.style.height===t.operationFrame.height?this.isNeedToAdjustText(t,r,o)?this.frameInfoAfterAdjust(t,r):this.frameInfoOfModel(t):t.resizeTable(t.operationFrame,r)}},{key:"frameInfoAfterAdjust",value:function(e,t){var n,i,r,a,o=Object(M.a)(null==e||null===(n=e.textBodyStyle)||void 0===n||null===(i=n.wrapperStyle)||void 0===i?void 0:i.textDirection),l=o.blockSize,c=o.inlineSize,d=this.frameInfoOfModel(e);if(["flipH","flipV","rotate",c].every((function(t){return d.style[t]===e.props.style[t]})))return{style:w(w({},d.style),{},(a={},s()(a,l,e.props.style[l]),s()(a,"left",e.props.style.left),s()(a,"top",e.props.style.top),a))};var u=y.a.getInstance().adjustShape(e,d,t),f=this.getOffsetFrame(u.style,e.props.style);return this.updateForConnector(e,f),null==e||null===(r=e.relatedUIModelRefs)||void 0===r||r.forEach((function(e){var t=e.connectorCaculater.getUpdateStyle(f);e.updateModelStyle(t)})),u}},{key:"updateRelatedInfoForConnector",value:function(e){e.type===u.d.CONNECTOR&&e.resetStartAndEndForMove(this.editingStateManagerRef.isDragging)}},{key:"checkIfNeedUpdateForConnector",value:function(e,t,n,i){return this.editingStateManagerRef.isDragging?t.resetStartAndEndForMove(!0):(null!=e&&e.selected||null!=n&&n.selected)&&(i=!1),i}},{key:"calFrameForSizeMap",value:function(e,t,n,i){var r=this;(null==t?void 0:t.size)>1&&t.forEach((function(e){e.offsetFrame=r.calOffsetFrame(e.originalSize,e.nextSize)}))}},{key:"calOffsetFrame",value:function(e,t){if(!e||!t)return{};var n={left:t.left-e.left,top:t.top-e.top,width:t.width-e.width,height:t.height-e.height};return v()(t,"flipH")&&h()(n,"flipH",t.flipH),v()(t,"flipV")&&h()(n,"flipV",t.flipV),n}}]),e}()},"6b3d7565ba":function(e,t,n){"use strict";n.d(t,"a",(function(){return M})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return w}));var i=n("176815363d"),r=n.n(i),a=n("14502724a6"),o=n.n(a),l=n("3ef2352f0b"),s=n.n(l),c=(n("6e20b6a7d8"),n("c6244f7705"),n("081c8cafea"),n("69084d01d3")),d=n.n(c),u=n("f1f2954cff"),f=n.n(u),h=n("11246a1392"),p=n.n(h),v=n("5fac0349d3"),g=n("b390895db3"),m=n("e792a3169a"),y=n.n(m),b=n("553ec40726"),S=n.n(b),k={insert:"head",singleton:!1},E=(y()(S.a,k),S.a.locals||{}),I=n("020899bf26");function M(e){var t=e.visible,n=void 0!==t&&t,i=e.style,a=void 0===i?{}:i,l=e.exportSnapshotFile,u=Object(c.useState)([]),f=o()(u,2),h=f[0],m=f[1];return Object(c.useEffect)((function(){var e,t=null===(e=I.a.SDKDataServices.SnapshotManager())||void 0===e?void 0:e.getSnapshotStorage();n&&t&&t.list().then((function(e){return m(e.reverse())})).catch((function(e){window.log.error("[SnapshotList] get snapshot from store failed",e)}))}),[n]),n?d.a.createElement("ul",{className:E.list,style:a},h.map((function(e){return d.a.createElement("li",{className:E.item,key:e.id},d.a.createElement("div",{className:E.time},Object(g.a)(new Date(e.createdAt))),d.a.createElement("div",{className:E.actions},d.a.createElement(p.a,{className:E.action,size:"small",onClick:r()(s.a.mark((function t(){var n,i,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=null===(n=I.a.SDKDataServices.SnapshotManager())||void 0===n?void 0:n.getSnapshotStorage(),t.next=3,null==i?void 0:i.getById(e.id);case 3:(r=t.sent)&&(null==l||l(r));case 5:case"end":return t.stop()}}),t)})))},v.a.t("导出为")," .pptx")))}))):null}function P(e){var t,n,i,r,a,o,l,s=e.visible,c=void 0!==s&&s,u=e.style,f=void 0===u?{}:u,h=e.exportSnapshotFile,m=null===(t=I.a.DocInfoManager())||void 0===t||null===(n=t.docInfo)||void 0===n||null===(i=n.doc_meta)||void 0===i?void 0:i.last_modify_ts;m=m?1e3*m:void 0;var y=(null!==(r=null===(a=window.basicClientVars)||void 0===a?void 0:a.docInfo)&&void 0!==r?r:{}).lastModifyTime;return y=null!==(o=null!==(l=y)&&void 0!==l?l:m)&&void 0!==o?o:Date.now(),c?d.a.createElement("ul",{className:E.list,style:f},d.a.createElement("li",{className:E.item},d.a.createElement("div",{className:E.time},Object(g.a)(new Date(y))),d.a.createElement("div",{className:E.actions},d.a.createElement(p.a,{className:E.action,size:"small",onClick:h},v.a.t("导出为")," .pptx")))):null}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=0,i=Date.now();return function(){Date.now()-i<250?n+=1:n=1,n>=t&&(e(),n=0),i=Date.now()}}M.propTypes={visible:f.a.bool,style:f.a.object}},"6fc2b77709":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return h}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var i,r=n("9132715560"),a=n.n(r),o=n("6a364eb35c"),l=n.n(o),s=n("85d0a7609b"),c=n.n(s);n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("8ee19818c4"),n("0acdc5834b"),n("6e20b6a7d8"),n("405b4a5e2b");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE",e[e.MUITI=3]="MUITI"}(i||(i={}));var f=.95,h=function(){function e(t){var n=this;a()(this,e),c()(this,"frameMap",new Map),c()(this,"tilingType",void 0),c()(this,"services",void 0),c()(this,"adjustElementsSize",(function(e,t,i){var r=t,a=!1;e.forEach((function(e){if(!e.adjustedSize&&e.frame.height>i){var t=e.originalSize,n=t.width,o=t.height;e.frame.height=i,e.frame.width=n/o*i,r-=e.frame.width,a=!0,e.adjustedSize=!0}}));var o=e.reduce((function(e,t){return t.adjustedSize?e:t.originalSize.width+e}),0);a&&(e.forEach((function(e){if(!e.adjustedSize){var t=e.originalSize.width/o*r,n=e.originalSize.height/e.originalSize.width*t;e.frame.width=t,e.frame.height=n}})),n.adjustElementsSize(e,r,i))})),c()(this,"updateElementsFrame",(function(e){var t,i=[],r=[];e.forEach((function(e){var t,n;i.push(e.elementModel);var a=null===(t=(n=e.elementModel).getFrame)||void 0===t?void 0:t.call(n).getFrameInfo();r.push(u(u({},a),e.frame))})),null===(t=n.services.selectionService.currentSlide)||void 0===t||t.getBatchUpdateFrame().batchUpdateFrame({frame:r,updateModelArr:i})})),c()(this,"getElementsInfo",(function(e,t,n){return e.map((function(e){var i=e.props.style,r=i.width,a=i.height,o=r/t*n;return{elementModel:e,frame:{width:o,height:a/r*o,left:0,top:0},originalSize:{width:r,height:a},adjustedSize:!1}}))})),c()(this,"adjustElementsPos",(function(e,t,n,i,r,a){var o=e.reduce((function(e,t){return t.frame.width+e}),0),l=r*((1-f)/2),s=a*((1-f)/2)+i*(n+5);e.forEach((function(e){var i=e.frame.width/o*t,r=(i-e.frame.width)/2,a=(n-e.frame.height)/2;e.frame.left=l+r,e.frame.top=s+a,l+=i+5}))})),c()(this,"getElementLayoutArr",(function(e){var t=new Array(n.tilingType).fill("").map((function(){return[]})),i=e.length%n.tilingType||n.tilingType,r=Math.ceil(e.length/n.tilingType),a=0;return e.forEach((function(e){t[a].push(e);var n=t[a].length;a<i?n===r&&(a+=1):n===r-1&&(a+=1)})),t})),c()(this,"getMaxLineHeight",(function(e){return e/n.tilingType*f-5*(n.tilingType-1)})),this.services=t}return l()(e,[{key:"layout",value:function(e,t,n,i){var r=this;this.tilingType=i;var a=this.getMaxLineHeight(n);this.getElementLayoutArr(e).forEach((function(e,i){if(e.length){var o=e.reduce((function(e,t){return t.props.style.width+e}),0),l=t*f-5*(e.length-1),s=r.getElementsInfo(e,o,l);r.adjustElementsSize(s,l,a),r.adjustElementsPos(s,l,a,i,t,n),r.updateElementsFrame(s)}})),this.frameMap.clear()}},{key:"getElementsInfoAfterLayout",value:function(e,t,n,i){var r=this;this.tilingType=i;var a=this.getMaxLineHeight(n),o=this.getElementLayoutArr(e),l=[];return o.forEach((function(e,i){if(e.length){var o=e.reduce((function(e,t){return t.props.style.width+e}),0),s=t*f-5*(e.length-1),c=r.getElementsInfo(e,o,s);r.adjustElementsSize(c,s,a),r.adjustElementsPos(c,s,a,i,t,n),l.push(c)}})),this.frameMap.clear(),l}}]),e}()},"73301bd1eb":function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));n("73b854064b");var i=n("176815363d"),r=n.n(i),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),s=n.n(l),c=n("bd29e2df90"),d=n.n(c),u=n("ab5eb40518"),f=n.n(u),h=n("1b4cdd6a36"),p=n.n(h),v=n("3ef2352f0b"),g=n.n(v),m=(n("c6244f7705"),n("081c8cafea"),n("b1e0ea6d5e")),y=n("a2cf71de79");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return f()(this,n)}}var S=function(e){d()(n,e);var t=b(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"setEditState",value:function(e){this.services.userPriviledgeService&&this.services.userPriviledgeService.setPPTEditorState({state:e,scope:y.a.CURRENT})}},{key:"registerRightSideBarModule",value:function(e){var t;null===(t=this.services.rightSideBarService)||void 0===t||t.registerModule(e)}},{key:"showRightSideBar",value:function(e,t){var n=this;this.onRightSideBarMount((function(){var i;null===(i=n.services.rightSideBarService)||void 0===i||i.show(e,t)}))}},{key:"isShowRightSideBar",value:function(e){var t;return!(null===(t=this.services.rightSideBarService)||void 0===t||!t.isShown(e))}},{key:"hideRightSideBar",value:function(){var e;null===(e=this.services.rightSideBarService)||void 0===e||e.hide()}},{key:"getDisplayRightSlideBarName",value:function(){var e;return(null===(e=this.services.rightSideBarService)||void 0===e?void 0:e.displayingModuleName())||""}},{key:"onRightSideBarMount",value:function(e){var t=function(){return!!document.getElementById("rs-bar-container")};if(!t())return r()(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t()){e.next=5;break}return e.next=3,new Promise((function(e){return setTimeout(e,100)}));case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})))().then(e);e()}}]),n}(m.a)},"77c89fc0e0":function(e,t,n){"use strict";n.d(t,"g",(function(){return l.a})),n.d(t,"a",(function(){return i.c})),n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return i.b})),n.d(t,"h",(function(){return s.a})),n.d(t,"f",(function(){return a.a})),n.d(t,"n",(function(){return c.e})),n.d(t,"p",(function(){return c.f})),n.d(t,"k",(function(){return c.d})),n.d(t,"j",(function(){return c.b})),n.d(t,"e",(function(){return r.a})),n.d(t,"l",(function(){return o.a})),n.d(t,"d",(function(){return d.a})),n.d(t,"o",(function(){return u.l})),n.d(t,"m",(function(){return u.g})),n.d(t,"i",(function(){return u.a}));var i=n("780d9b3b59"),r=(n("9cae5c6f5c"),n("05d181ac40")),a=n("5cdbac46e8"),o=n("5fac0349d3"),l=(n("76f3a50d5c"),n("7faf76450d"));n("b86964b011"),n("f8fc8e0087");var s=n("d0054b9d0b"),c=n("3825cc7c15"),d=n("1288bffff3"),u=n("d9812f1c6f");n("1acc787c14")},"83f23a2c67":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));var i=n("d9812f1c6f"),r=n("e0ea7b145b"),a=n.n(r),o=n("143172a8e2"),l=n.n(o),s=n("798a9cd6f2"),c=i.a.isIE||i.a.isEdge,d={TEXT:c?s.a.IMAGE.BRUSH_IE:a.a,SHAPE:c?s.a.IMAGE.BRUSH_IE:l.a};function u(e){var t='url("'.concat(d.TEXT,'")10 10, auto'),n='url("'.concat(d.SHAPE,'")3 3, auto');return e?t:n}function f(e){var t=e.formatBrushManager,n=e.animBrushManager,i=(t||{}).formatBrushState,r=(n||{}).animBrushState;return(null==i?void 0:i.data)||r&&!r.allMediaEffect}},"852a563065":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.DATA_READY="data_ready",e.INFRASTRUCTURE_DID_READY="infrastructure_did_ready",e.FIRST_SLIDE_RENDER="first_slide_render"}(i||(i={}))},"862b984676":function(e,t,n){"use strict";var i,r;n.d(t,"a",(function(){return r})),function(e){e.ADD="add",e.DELETE="delete"}(i||(i={})),function(e){e.EDITOR="editor",e.PLAYER="player",e.MOBILE_PREVIEW="mobilePreview"}(r||(r={}))},"8ba4036387":function(e,t,n){"use strict";n.d(t,"a",(function(){return Ht}));n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var i=n("176815363d"),r=n.n(i),a=n("14502724a6"),o=n.n(a),l=n("9132715560"),s=n.n(l),c=n("6a364eb35c"),d=n.n(c),u=n("85d0a7609b"),f=n.n(u),h=n("3ef2352f0b"),p=n.n(h),v=(n("1bab7b5fb7"),n("0aeae65bf4"),n("34cd92f77a"),n("b8217400dc"),n("e6f68cdf2e"),n("8a35b54c1d"),n("a2a09da1e3"),n("3bf1976a4f"),n("c6244f7705"),n("081c8cafea"),n("8ee19818c4"),n("7a3400cab1"),n("c7530f2183")),g=n("5fac0349d3"),m=n("d3d31c86eb"),y=n("c13f133f92"),b=n("e0e8dd9366"),S=n("44d0621778"),k=n("d2df6c0011"),E=n("d9812f1c6f"),I=n("96818dd0e4"),M=n("b86964b011"),P=n("1e07095161"),w=n("f4e4ed5c17"),x=n("a86564e558"),O=n("51b2ea9953"),A=n("ec5cae33cb"),C=n("fb75408061"),R=n("0a8ecd6412"),D=n("c9c92622ff"),T=n("9da6335152"),L=n("d09b3891fa"),F=n("7a5536c9bf"),j=n.n(F),B=(n("0acdc5834b"),n("54bdd803dc")),z=n.n(B),U=n("1c66973d9e"),N=function(){function e(){s()(this,e)}return d()(e,null,[{key:"getSameLinkTextElements",value:function(e,t){return t&&e?[].concat(j()(this.getLeftSameLinkTextElements(e,t)),[e],j()(this.getRightSameLinkTextElements(e,t))):[]}},{key:"getBounds",value:function(e){var t={minX:1/0,minY:1/0,maxX:0,maxY:0};return e.reduce((function(e,t){return e.concat(U.b.get(t))}),[]).reduce((function(e,t){var n=e.minX,i=e.minY,r=e.maxX,a=e.maxY,o=t.worldBounds,l=o.minX,s=o.minY,c=o.maxX,d=o.maxY;return{minX:Math.min(n,l),minY:Math.min(i,s),maxX:Math.max(r,c),maxY:Math.max(a,d)}}),t)}},{key:"getLeftSameLinkTextElements",value:function(e,t){var n=t.getPrevTextElement(e);if(!n)return[];var i=this.getLinkConfig(e),r=this.getLinkConfig(n);return this.isSameLink(r,i)?[].concat(j()(this.getLeftSameLinkTextElements(n,t)),[n]):[]}},{key:"getRightSameLinkTextElements",value:function(e,t){var n=t.getNextTextElement(e);if(!n)return[];var i=this.getLinkConfig(e),r=this.getLinkConfig(n);return this.isSameLink(r,i)?[n].concat(j()(this.getRightSameLinkTextElements(n,t))):[]}},{key:"isSameLink",value:function(e,t){return e===t||!(!e||!t)&&(e.url===t.url&&e.tooltip===t.tooltip&&z()(e.slideJump,t.slideJump))}},{key:"getLinkConfig",value:function(e){return(null==e?void 0:e["origin-href"])||null}}]),e}(),G=n("020899bf26"),_=n("147aa73f92"),V=function(){function e(t,n){s()(this,e),f()(this,"defaultLinkColor","#0563C1"),this.uiDataService=t,this.selectionService=n}return d()(e,[{key:"getLinkThemeColor",value:function(e){var t="";if("number"==typeof e){var n=e-1;t=this.getLinkColor(this.uiDataService.presentation.children[n])}return t||this.getCurrentSlideLinkThemeColor()}},{key:"getCurrentSlideLinkThemeColor",value:function(){var e;return this.getLinkColor(null===(e=this.selectionService)||void 0===e?void 0:e.currentSlide)||this.defaultLinkColor}},{key:"getLinkColor",value:function(e){var t,n,i;if(null!=e&&e.sdkData){var r,a,o=null===(r=G.a.SDKDataServices.ColorManager())||void 0===r||null===(a=r.getHLinkColor(e.sdkData))||void 0===a?void 0:a.srgbClr;return Object(_.f)(o)}return null==e||null===(t=e.props)||void 0===t||null===(n=t.style)||void 0===n||null===(i=n.linkColor)||void 0===i?void 0:i.srgb_color}}]),e}(),H=n("69084d01d3"),K=n.n(H),W=n("ad922c423b"),q=(n("73b854064b"),n("547611bd96")),Y=n.n(q),J=n("bd29e2df90"),X=n.n(J),Z=n("ab5eb40518"),Q=n.n(Z),$=n("1b4cdd6a36"),ee=n.n($),te=(n("6e20b6a7d8"),n("826dc923b3"),n("11246a1392")),ne=n.n(te),ie=n("d436b8c143"),re=n.n(ie),ae=n("7eb0635f44"),oe=n.n(ae),le=n("2e0796c118"),se=n.n(le),ce=n("f000f89fa1"),de=n.n(ce),ue=n("e792a3169a"),fe=n.n(ue),he=n("f1ae602d16"),pe=n.n(he),ve={insert:"head",singleton:!1},ge=(fe()(pe.a,ve),pe.a.locals||{});function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var ye=function(e){X()(n,e);var t=me(n);function n(e,i){var r;return s()(this,n),r=t.call(this,e,i),f()(Y()(r),"inputRef",void 0),f()(Y()(r),"handleChange",(function(e){r.props.handleInputChange(e)})),f()(Y()(r),"handleBlur",(function(){r.props.handleBlur&&r.props.handleBlur()})),f()(Y()(r),"focusInput",(function(){var e;null===(e=r.inputRef)||void 0===e||e.current.focus()})),r.inputRef=K.a.createRef(),r}return d()(n,[{key:"componentDidMount",value:function(){if(E.a.isSafari){var e=Object(le.findDOMNode)(this.inputRef.current);null==e||e.classList.add("safari-input")}}},{key:"render",value:function(){var e={opacity:.8,fontFamily:"PingFangSC",borderRadius:4,borderColor:this.props.isWarning?"#ff7272":void 0,height:"32px"};return K.a.createElement("div",{className:ge["link-menu-item"]},K.a.createElement("label",{className:ge["link-menu-item-label"]},this.props.itemName),K.a.createElement(de.a,{className:ge["link-menu-item-input"],placeholder:this.props.itemPlaceholder,style:{width:"284px",height:"32px"},inputStyle:e,value:this.props.inputTextInfo,onChange:this.handleChange,onBlur:this.handleBlur,inputRef:this.inputRef}))}}]),n}(K.a.Component),be=n("73f8a2368f");function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var Ee=[{label:g.a.t("网页"),value:"url"},{label:g.a.t("幻灯片"),value:"ppt"},{label:g.a.t("电子邮件"),value:"email"}],Ie=[{label:g.a.t("下一张幻灯片"),value:"ppaction://hlinkshowjump?jump=nextslide"},{label:g.a.t("上一张幻灯片"),value:"ppaction://hlinkshowjump?jump=previousslide"},{label:g.a.t("第一张幻灯片"),value:"ppaction://hlinkshowjump?jump=firstslide"},{label:g.a.t("最后一张幻灯片"),value:"ppaction://hlinkshowjump?jump=lastslide"},{label:g.a.t("幻灯片"),value:"ppaction://hlinksldjump"}],Me=function(e){X()(n,e);var t=ke(n);function n(e){var i;s()(this,n),i=t.call(this,e),f()(Y()(i),"listRef",null),f()(Y()(i),"editRef",null),f()(Y()(i),"linkRef",null),f()(Y()(i),"addrRef",null),f()(Y()(i),"initializeData",(function(){var e,t=i.props.data;if(t){var n={};return t.url?(n.selectedLinkType="url",n.urlLinkInfo=t.url):t.slideJump?i.initializeSlideJumpCase(t,n):t.mail?i.initializeMailCase(t,n):t.text&&i.initializeTextCase(t,n),n.linkTextContent=t.text||"",n.tipContent=t.tooltip||"",n.totalPPTPage=(null===(e=i.getSlideList())||void 0===e?void 0:e.length)||0,n}})),f()(Y()(i),"handleFocus",(function(){var e,t,n=i.state,r=n.selectedLinkType,a=n.urlLinkInfo,o=n.emailAddrInfo;if("url"!==r||a){if("email"===r&&!o){var l,s;null===(l=i.addrRef)||void 0===l||null===(s=l.current)||void 0===s||s.focusInput()}}else null===(e=i.linkRef)||void 0===e||null===(t=e.current)||void 0===t||t.focusInput()})),f()(Y()(i),"handleSelectTypeChange",(function(e){i.state.selectedLinkType!==e?i.setState({selectedLinkType:e},(function(){i.handleFocus(),i.adjustHeight(e)})):i.handleFocus()})),f()(Y()(i),"handleSelectPPTChange",(function(e){i.setState({selectedPPTAction:e})})),f()(Y()(i),"handleSelectTargetChange",(function(e){i.setState({selectedPPTTarget:e})})),f()(Y()(i),"handlePageVisibleChange",(function(e){i.props.handleDropDsiable&&setTimeout((function(){var t,n;null===(t=(n=i.props).handleDropDsiable)||void 0===t||t.call(n,e)}),e?0:50)})),f()(Y()(i),"handleLinkChange",(function(e){i.setState({isUrlWarning:!1,isEmailWarning:!1}),"url"===i.state.selectedLinkType?i.setState({urlLinkInfo:e}):i.setState({emailAddrInfo:e})})),f()(Y()(i),"handleTextChange",(function(e){i.setState({linkTextContent:e})})),f()(Y()(i),"handleSubjectChange",(function(e){i.setState({emailSubInfo:e})})),f()(Y()(i),"handleTipContentChange",(function(e){e.length>255||i.setState({tipContent:e})})),f()(Y()(i),"handleBlur",(function(){var e=i.state,t=e.selectedLinkType,n=e.urlLinkInfo,r=e.emailAddrInfo;"url"===t?n&&!Object(S.b)(n)&&i.setState({isUrlWarning:!0}):"email"===t&&r&&!Object(S.a)(r)&&i.setState({isEmailWarning:!0})})),f()(Y()(i),"handleSubmit",(function(){var e={},t=i.state,n=t.selectedLinkType,r=t.urlLinkInfo,a=t.emailAddrInfo,o=t.emailSubInfo,l=t.linkTextContent,s=t.selectedPPTAction,c=t.selectedPPTTarget,d=t.tipContent;if("url"===n){if(!Object(S.b)(r))return void i.setState({isUrlWarning:!0});e.url=r,e.text=l||r}else if("email"===n){if(!Object(S.a)(a))return void i.setState({isEmailWarning:!0});e.mail={address:a,subject:o},e.text=l||a}else{if("ppaction://noaction"===s)return;i.handleSubmitWithPPTAction(e,s,c,l)}e.tooltip=d||"",i.props.handleLinkEdit(e)})),f()(Y()(i),"handleCancel",(function(){i.props.hide()})),f()(Y()(i),"adjustHeight",(function(e){var t,n=void 0===i.props.isTextLink||i.props.isTextLink,r=i.state.itemsHeight;if(null!==(t=i.editRef)&&void 0!==t&&t.current){var a=i.editRef.current.getBoundingClientRect(),o=document.body.clientHeight,l=0;a.top<10?l=a.bottom-114:a.bottom>o-10?l=o-a.top-114:"url"===e?l=i.adjustUrlCase(n,a,r):"ppt"===e?l=i.adjustPPTCase(n,a,r):"email"===e&&(l=i.adjustMailCase(n,a,r)),i.setState({itemsHeight:l})}})),f()(Y()(i),"getPosition",(function(){var e=i.props.anchorRect;setTimeout((function(){var t;if(null!==(t=i.editRef)&&void 0!==t&&t.current){var n=i.editRef.current.getBoundingClientRect();n.bottom<=e.y&&i.setState({trianglePos:"bottom"});var r=e.x+Math.floor(e.width/2)-n.left;i.setState({triangleLeft:r})}}),0)})),f()(Y()(i),"getListHeight",(function(){setTimeout((function(){var e;if(null!==(e=i.listRef)&&void 0!==e&&e.current){var t=32*i.state.totalPPTPage+18,n=i.listRef.current.getBoundingClientRect(),r=document.body.clientHeight-n.bottom-46;r>186&&(r=186),t>r&&(t=r),i.setState({listHeight:t})}}),50)}));var r=i.initializeData();return i.state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({selectedLinkType:"url",selectedPPTAction:Ie[0].value,selectedPPTTarget:"1",totalPPTPage:1,isUrlWarning:!1,isEmailWarning:!1,urlLinkInfo:"",emailAddrInfo:"",emailSubInfo:"",linkTextContent:"",tipContent:"",listHeight:0,trianglePos:"top",triangleLeft:180,itemsHeight:0},r),i.listRef=K.a.createRef(),i.editRef=K.a.createRef(),i.linkRef=K.a.createRef(),i.addrRef=K.a.createRef(),i.getPosition(),i}return d()(n,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.adjustHeight(e.state.selectedLinkType),e.handleFocus()}),100)}},{key:"componentDidUpdate",value:function(){this.getListHeight()}},{key:"render",value:function(){var e={height:"28px",width:"72px",marginLeft:"16px",borderRadius:2},t=this.state,n=t.selectedLinkType,i=t.linkTextContent,r=t.tipContent,a=t.trianglePos,o=t.triangleLeft,l=this.state.itemsHeight,s=void 0===this.props.isTextLink||this.props.isTextLink;return l=0===l?"auto":l,K.a.createElement("div",{className:"".concat(ge["link-menu-wrapper"]," ").concat(ge[a]),ref:this.editRef},K.a.createElement("div",{className:"".concat(ge["link-menu-triangle"]," ").concat(ge[a]),style:{left:o}}),K.a.createElement("div",{className:ge["link-menu-content"]},K.a.createElement("div",{className:"".concat(ge["link-menu-items"]," global-scroll"),style:{height:l}},K.a.createElement("div",{style:{display:s?"flex":"none"}},K.a.createElement(ye,{itemName:g.a.t("显示文本"),itemPlaceholder:g.a.t("请输入显示文本"),inputTextInfo:i,handleInputChange:this.handleTextChange})),K.a.createElement("div",{className:ge["link-menu-item"]},K.a.createElement("label",{className:ge["link-menu-item-label"]},g.a.t("链接至")),K.a.createElement(re.a,{style:{width:"284px",height:"32px",borderRadius:4},defaultValue:n,value:n,onChange:this.handleSelectTypeChange,onVisibleChange:this.handlePageVisibleChange},Ee.map((function(e){return K.a.createElement(re.a.Option,{value:e.value,key:"".concat(e.value,"-").concat(e.label)},e.label)})))),this.renderLinkItem(),K.a.createElement(ye,{itemName:g.a.t("屏幕提示"),itemPlaceholder:g.a.t("播放时鼠标停留显示"),inputTextInfo:r,handleInputChange:this.handleTipContentChange})),K.a.createElement("div",{className:ge["link-menu-btns"]},K.a.createElement(ne.a,{style:e,onClick:this.handleCancel},g.a.t("取消")),K.a.createElement(ne.a,{type:"primary",style:e,onClick:this.handleSubmit},g.a.t("确定")))))}},{key:"initializeSlideJumpCase",value:function(e,t){if(t.selectedLinkType="ppt",t.selectedPPTAction="ppaction://noaction"!==e.slideJump.action?e.slideJump.action:Ie[0].value,e.slideJump.target){var n=Object(be.a)(e.slideJump.target,this.getSlideList());t.selectedPPTTarget=n}}},{key:"initializeMailCase",value:function(e,t){t.selectedLinkType="email",t.emailAddrInfo=e.mail.address||"",t.emailSubInfo=e.mail.subject||""}},{key:"initializeTextCase",value:function(e,t){var n=0===e.text.indexOf(I.a);if(Object(S.b)(e.text)&&!n)t.selectedLinkType="url",t.urlLinkInfo=e.text;else if(n){var i=Object(k.b)(e.text);t.selectedLinkType="email",t.emailAddrInfo=i.address,t.emailSubInfo=i.subject}}},{key:"handleSubmitWithPPTAction",value:function(e,t,n,i){e.slideJump={action:t},t===Ie[4].value?e.slideJump.target=Object(be.b)(Number(n),this.getSlideList()):e.slideJump.target="",e.text=i||this.props.getInnerLinkInfo(e.slideJump)}},{key:"adjustUrlCase",value:function(e,t,n){return e?t.height<310?n:0:t.height<252?n:0}},{key:"adjustPPTCase",value:function(e,t,n){return e?t.height<398?n:0:t.height<340?n:0}},{key:"adjustMailCase",value:function(e,t,n){return e?t.height<368?n:0:t.height<310?n:0}},{key:"getSlideList",value:function(){return this.props.uiDataService.slideModelList}},{key:"renderLinkItem",value:function(){for(var e,t=this.state,n=t.selectedLinkType,i=t.selectedPPTAction,r=t.selectedPPTTarget,a=t.isUrlWarning,o=t.isEmailWarning,l=t.urlLinkInfo,s=t.emailAddrInfo,c=t.listHeight,d=t.emailSubInfo,u=[],f=1;f<=this.state.totalPPTPage;f++)u.push("".concat(f));switch(n){case"url":return K.a.createElement("div",{className:ge["link-menu-item-wrapper"]},K.a.createElement(ye,{itemName:g.a.t("链接"),itemPlaceholder:g.a.t("请输入网页链接地址"),isWarning:a,inputTextInfo:l,handleInputChange:this.handleLinkChange,handleBlur:this.handleBlur,ref:this.linkRef}),K.a.createElement("div",{style:{display:a?"block":"none"},className:ge["link-menu-warning"]},g.a.t("链接格式输入错误")));case"ppt":return K.a.createElement("div",{className:ge["link-menu-ppt-items"]},K.a.createElement(oe.a.Group,{value:i,options:Ie,itemStyle:{marginBottom:8,paddingBottom:0},onChange:this.handleSelectPPTChange}),K.a.createElement("div",{className:ge["link-menu-ppt-select"],ref:this.listRef},K.a.createElement(re.a,{defaultValue:r,style:{width:81,height:24},listStyle:{height:c},onChange:this.handleSelectTargetChange,onVisibleChange:this.handlePageVisibleChange,disabled:"ppaction://hlinksldjump"!==i,containerDom:(null===(e=this.listRef)||void 0===e?void 0:e.current)||void 0,destroyOnClose:!1},u.map((function(e){return K.a.createElement(re.a.Option,{value:e,key:e},e)})))));case"email":return K.a.createElement(K.a.Fragment,null,K.a.createElement("div",{className:ge["link-menu-item-wrapper"]},K.a.createElement(ye,{itemName:g.a.t("地址"),itemPlaceholder:g.a.t("请输入邮件地址"),isWarning:o,inputTextInfo:s,handleInputChange:this.handleLinkChange,handleBlur:this.handleBlur,ref:this.addrRef}),K.a.createElement("div",{style:{display:o?"block":"none"},className:ge["link-menu-warning"]},g.a.t("邮件格式输入错误"))),K.a.createElement(ye,{itemName:g.a.t("主题"),itemPlaceholder:g.a.t("选填"),inputTextInfo:d,handleInputChange:this.handleSubjectChange}));default:return null}}}]),n}(K.a.Component),Pe=function(){function e(t,n,i){s()(this,e),f()(this,"DropdownOp",void 0),this.uiDataService=t,this.linkManager=n,this.menuManager=i}return d()(e,[{key:"show",value:function(e){var t=this;if(!this.DropdownOp){var n=e.anchorPoint;this.DropdownOp=W.a.create({anchorPoint:n,anchorRect:e.anchorRect,center:!0,autoAlign:!0,hasShadow:!1,scrollable:!1,hasTransform:!1,isTransparent:!0,onVisibleChange:function(n){t.menuManager&&(t.menuManager.isMenuShown=!!n),n||t.hide(),e.handleVisibleChange&&e.handleVisibleChange(n)},dropContent:K.a.createElement(Me,{data:e.data,anchorRect:n?{x:n.x,y:n.y,width:0,height:0}:e.anchorRect,handleLinkEdit:e.handleLinkEdit,isTextLink:e.isTextLink,uiDataService:this.uiDataService,getInnerLinkInfo:this.linkManager.getInnerLinkInfo,handleDropDsiable:function(e){var n;return null===(n=t.DropdownOp)||void 0===n?void 0:n.setDisable(e)},hide:this.hide.bind(this)})})}this.DropdownOp.show()}},{key:"hide",value:function(){this.DropdownOp&&(this.DropdownOp.close(),this.DropdownOp=null)}},{key:"isShown",value:function(){return!!this.DropdownOp&&this.DropdownOp.isShown()}}]),e}(),we=(n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("9d0daf5c3f"),n("22569efd03"),n("963f2eaace"),n("82f2dc9440")),xe=n.n(we),Oe=n("b74ee0edd6"),Ae=n.n(Oe),Ce=n("235e9f0623"),Re="Tooltip",De="Separator",Te="DropDown",Le="DuiDropDown",Fe={type:Re,id:"url",text:g.a.t("打开链接"),config:{tipText:g.a.t("跳转到源网页")}},je={type:Re,id:"copyUrl",icon:"",config:{tipText:g.a.t("复制链接")}},Be={type:Re,id:"modifyUrl",icon:"",config:{tipText:g.a.t("修改链接")}},ze={type:Re,id:"cancelUrl",icon:"",config:{tipText:g.a.t("取消链接")}},Ue={type:Re,id:"refresh",config:{tipText:g.a.t("刷新")}},Ne={type:Re,id:"delete",config:{tipText:g.a.t("删除")}},Ge={type:Re,id:"fullscreen",config:{tipText:g.a.t("全屏查看")}},_e={type:De,config:{block:"line"}},Ve={type:De,config:{block:"block"}},He=[Fe,_e,je,Ve,Be,_e,{type:Te,id:"changeDisplay",config:{tipText:g.a.t("展示样式"),items:[{name:g.a.t("文字链"),isSelected:!1,id:"normal"},{name:g.a.t("图标+文字链"),isSelected:!0,id:"icon"}]}},_e,ze],Ke=[Fe,_e,je,Ve,Be,_e,ze],We=[Fe,_e,je,Ve,Be,_e,{type:Te,id:"changeDisplay",icon:"",config:{tipText:g.a.t("展示样式"),items:[{name:g.a.t("文字链"),isSelected:!0,id:"normal"},{name:g.a.t("图标+文字链"),isSelected:!1,id:"icon"},{name:g.a.t("卡片预览"),isSelected:!1,id:"iframe"}]}},_e,ze],qe=[Fe,_e,je,Ve,Be,_e,{type:Te,id:"changeDisplay",icon:"",config:{tipText:g.a.t("展示样式"),items:[{name:g.a.t("文字链"),isSelected:!1,id:"normal"},{name:g.a.t("图标+文字链"),isSelected:!0,id:"icon"},{name:g.a.t("卡片预览"),isSelected:!1,id:"iframe"}]}},_e,ze],Ye=[Fe,_e,je,Ve,Be,_e,{type:Te,id:"changeDisplay",config:{tipText:g.a.t("展示样式"),items:[{name:g.a.t("文字链"),isSelected:!1,id:"normal"},{name:g.a.t("图标+文字链"),isSelected:!1,id:"icon"},{name:g.a.t("卡片预览"),isSelected:!0,id:"iframe"}]}},_e,Ue,_e,Ne],Je=[Fe,_e,je,Ve,Be,_e,{type:Te,id:"changeDisplay",config:{tipText:g.a.t("展示样式"),items:[{name:g.a.t("文字链"),isSelected:!1,id:"normal"},{name:g.a.t("图标+文字链"),isSelected:!1,id:"icon"},{name:g.a.t("卡片预览"),isSelected:!0,id:"iframe"}]}},_e,Ge,Ve,Ue,_e,Ne],Xe=[_e,{type:Le,id:"addon",config:{tipText:g.a.t("插件"),items:[{}]}}],Ze=[Fe,_e,je,_e,Ue],Qe=[Fe,_e,je],$e=[Fe,_e,je,_e,Ge,Ve,Ue],et=[Fe,_e,Ue],tt=[Fe],nt=[Fe,_e,Ge,Ve,Ue],it=n("6d623d55ad"),rt=n.n(it),at=n("cca06c0cf5"),ot=n.n(at),lt={insert:"head",singleton:!1},st=(fe()(ot.a,lt),ot.a.locals||{});function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var dt=function(e){X()(n,e);var t=ct(n);function n(){return s()(this,n),t.apply(this,arguments)}return d()(n,[{key:"render",value:function(){return K.a.createElement("div",{className:st["third-party-menu-separator-".concat(this.props.type)]})}}]),n}(K.a.Component);n("b1e2246d82");function ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var ft=function(e){X()(n,e);var t=ut(n);function n(){var e;s()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),f()(Y()(e),"onMouseUp",(function(){e.props.onSelectedItemCallback(e.props.item.id,e.props.index)})),e}return d()(n,[{key:"render",value:function(){var e=this.props.item,t=this.props.selectedIndex===this.props.index?"".concat(Ce.a["link-floatbar-v2-dropdown-item-icon-".concat(e.id)]," ").concat(Ce.a["link-floatbar-v2-dropdown-item-selected"]):"".concat(Ce.a["link-floatbar-v2-dropdown-item-icon-".concat(e.id)]);return K.a.createElement("li",{className:Ce.a["link-floatbar-v2-dropdown-item"],onMouseUp:this.onMouseUp},e.name&&e.name.length>0?K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-item-content"]},K.a.createElement("div",{className:t}),e.name):"")}}]),n}(K.a.Component);function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var pt=function(e){X()(n,e);var t=ht(n);function n(e){var i;return s()(this,n),i=t.call(this,e),f()(Y()(i),"getSelectedIndex",(function(e){var t,n=e.displayMode||(null===(t=e.items)||void 0===t?void 0:t[0].id);i.props.items.map((function(e,t){e.id===n&&i.setState({selectedIndex:t})}))})),i.state={selectedIndex:0},i}return d()(n,[{key:"componentDidMount",value:function(){this.getSelectedIndex({displayMode:this.props.displayMode})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.getSelectedIndex(e)}},{key:"render",value:function(){var e=this;return K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-menu"]},K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-menu-listbox"]},this.props.items.map((function(t,n){return t.name?K.a.createElement(ft,{key:t.name,index:n,item:t,selectedIndex:e.state.selectedIndex,onSelectedItemCallback:e.handleSelectedItem.bind(e)}):null}))))}},{key:"handleSelectedItem",value:function(e,t){this.setState({selectedIndex:t}),this.props.onSelectedItemCallback(e)}}]),n}(H.Component),vt=n("2d47c066fb");function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var mt=function(e){X()(n,e);var t=gt(n);function n(){var e;s()(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),f()(Y()(e),"menuComponent",null),f()(Y()(e),"handleSelectItemCallback",(function(t){e.props.onSelectedItemCallback(t)})),f()(Y()(e),"onMouseUp",(function(){e.props.isDropDownExtendShow?e.props.hideDropDownMenu():e.props.showDropDownMenu()})),e}return d()(n,[{key:"componentWillUnmount",value:function(){this.props.hideDropDownMenu()}},{key:"componentDidUpdate",value:function(){if(this.props.isDropDownExtendShow&&this.menuComponent){var e=this.menuComponent.getBoundingClientRect(),t=document.getElementById(vt.y).getBoundingClientRect();e.bottom>t.bottom&&(this.menuComponent.style.transform="translateY(".concat(0-e.height-R.g,"px)"))}}},{key:"render",value:function(){var e=this,t=this.props.config,n=this.props.getModeFromConfigData();return K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-button-container"]},K.a.createElement(rt.a,{placement:"top",title:g.a.t(t.tipText)},K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-button-wrapper"],onMouseUp:this.onMouseUp},K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-button-".concat(n)]}),K.a.createElement("div",{className:Ce.a["link-floatbar-v2-menu-button-dropdown"]}))),this.props.isDropDownExtendShow?K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-menu-wrapper"],ref:function(t){e.menuComponent=t}},K.a.createElement(pt,{items:t.items,displayMode:n,onSelectedItemCallback:this.handleSelectItemCallback})):"")}}]),n}(H.Component),yt=mt,bt=n("8f58e78419"),St=n.n(bt),kt=n("5cdbac46e8"),Et=n("37091e4240"),It=n("9c63f1cc6f"),Mt=n("b438b29dcd"),Pt=n.n(Mt),wt=n("aa3cc80657");function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var Ot=function(e){X()(n,e);var t=xt(n);function n(e){var i;return s()(this,n),i=t.call(this,e),f()(Y()(i),"floatDom",void 0),f()(Y()(i),"isMouseEnter",void 0),f()(Y()(i),"isMouseEnterBar",(function(){return i.isMouseEnter})),f()(Y()(i),"show",(function(e,t){var n=e||i.state.config;i.state.isShown?i.setState({config:n},(function(){t||i.adjustMenuLoc(n)})):(E.a.isMobile?document.body.addEventListener("touchstart",i.bodyClickHandler):document.body.addEventListener("click",i.bodyClickHandler),window.addEventListener("resize",i.resize),i.setState({isShown:!0,config:n},(function(){i.adjustMenuLoc(n)})))})),f()(Y()(i),"hide",(function(){i.state.isShown&&(i.state.isShown=!1,i.setState({isShown:!1,isDropDownExtendShow:!1}),i.removeListener())})),f()(Y()(i),"isShown",(function(){return i.state.isShown})),f()(Y()(i),"bodyClickHandler",(function(e){!i.state.isShown||document.fullscreenElement||document.querySelector("#addon-modify-modal")||(i.clickOnMenu(e,15)||i.hide())})),f()(Y()(i),"clickOnMenu",(function(e,t){for(var n=e.target,r=0;n&&r<t;){if(r+=1,!(n=n.parentNode))return!1;if(i.state.config.clickElementJudge){if(i.state.config.clickElementJudge(n))return!0}else if("link-float-container-id"===n.id)return!0}return!1})),f()(Y()(i),"handleMouseEnter",(function(){i.isMouseEnter=!0})),f()(Y()(i),"handleMouseLeave",(function(){i.isMouseEnter=!1,i.state.config.handleMouseLeave&&i.state.config.handleMouseLeave()})),f()(Y()(i),"handleMouseMove",(function(e){e.stopPropagation()})),f()(Y()(i),"onVisibleChange",(function(e){if(e){var t,n,r=i.state.config,a=r.addonManager,o=r.selectionService,l=a.addonHandler.getSceneType(),s=null===(t=o.getSelectedModel())||void 0===t||null===(n=t.props.addon)||void 0===n?void 0:n.docElement.addonId;a.addonHandler.updateIframeFloatMenu(l,s)}})),f()(Y()(i),"onAddonItemClick",(function(e){var t={ver9:T.m.DETAIL_IFRAME_TOOLBAR};i.state.config.addonManager.addonHandler.handleAddonSceneItemClick(e,t)})),f()(Y()(i),"removeListener",(function(){E.a.isMobile?document.body.removeEventListener("touchstart",i.bodyClickHandler):document.body.removeEventListener("click",i.bodyClickHandler),window.removeEventListener("resize",i.resize),i.state.config.anchorView=null})),f()(Y()(i),"resize",(function(){E.a.isMobile&&setTimeout((function(){if(i.state.config.anchorView){var e,t,n=null===(e=(t=i.state.config).processFloatBarAnchorRect)||void 0===e?void 0:e.call(t);i.state.config.left=n.left,i.state.config.top=n.top,i.setState({config:i.state.config})}}),200)})),f()(Y()(i),"adjustMenuLoc",(function(e){var t=Y()(i).floatDom;if(t&&e){var n=document.body.clientHeight,r=document.body.clientWidth,a=t.getBoundingClientRect(),o=document.getElementById(vt.y),l={left:0,top:0};o&&(n=(l=o.getBoundingClientRect()).height),e.left-=l.left,e.top-=l.top,e.left+a.width>r&&(e.left=r-a.width),e.top+a.height>n&&(e.top-=e.height?e.height+a.height+6:0),i.setState({config:e})}})),f()(Y()(i),"preventDefault",(function(e){e.preventDefault()})),f()(Y()(i),"handleMouseUp",(function(e){var t,n;null===(t=(n=i.state.config)[{url:"openLink",copyUrl:"handleCopyUrl",modifyUrl:"handleModifyUrl",refresh:"handleRefresh",delete:"deleteElement",fullscreen:"handleFullScreen",cancelUrl:"handleLinkRemove"}[e]])||void 0===t||t.call(n),i.setState({isDropDownExtendShow:!1})})),f()(Y()(i),"parseButtonConfig",(function(e,t,n,r){var a=e.type,o=e.config,l=e.id,s=void 0===l?"":l,c=e.text,d=void 0===c?"":c;if(a===De)return K.a.createElement(dt,{type:o.block});if(a===Re){var u=function(e,t,n){return e&&(t||n)}(d,n,r),f=d?"text":"normal",h=t?"-last":"",p=u?St()(i.state,"config.href"):d,v=function(e,t,n,i){var r=i.tipText;return e&&t?r=g.a.t("链接到幻灯片"):e&&n&&(r=g.a.t("发邮箱至")),r}(u,n,r,o);return K.a.createElement(rt.a,{placement:"top",title:g.a.t(v),visible:!E.a.isMobile&&void 0},K.a.createElement("div",{className:"".concat(Ce.a["button-".concat(f)],"\n                          ").concat(Ce.a["button-".concat(f,"-").concat(s)],"\n                          ").concat(Ce.a["button-".concat(f).concat(h)],"\n                          ppt-link-floatbar-v2-").concat(s,"\n                          "),onClick:function(e){e.preventDefault(),e.stopPropagation(),i.handleMouseUp(s)}},i.getI18nText(p)))}return a===Te?K.a.createElement(yt,{config:o,isDropDownExtendShow:i.state.isDropDownExtendShow,getModeFromConfigData:i.getModeFromConfigData,onSelectedItemCallback:i.onSelectedItemCallback.bind(Y()(i)),showDropDownMenu:i.showDropDownMenu,hideDropDownMenu:i.hideDropDownMenu}):a===Le?K.a.createElement(Pt.a,{trigger:"click",alignment:"left",dropContentStyle:{boxShadow:"0 2px 12px 2px rgba(68, 73, 77, 0.16)",padding:"0"},dropContent:K.a.createElement(It.a,{data:o.items,onMenuClick:i.onAddonItemClick,style:{backgroundColor:"#fff",margin:"0",maxHeight:"100%"}}),onVisibleChange:i.onVisibleChange},K.a.createElement(rt.a,{placement:"top",title:g.a.t(o.tipText),visible:!E.a.isMobile&&void 0,style:{display:"block"}},K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-button-wrapper-addon"]},K.a.createElement("div",{className:Ce.a["link-floatbar-v2-dropdown-button-addon"]}),K.a.createElement("div",{className:Ce.a["link-floatbar-v2-menu-button-dropdown"]})))):void 0})),f()(Y()(i),"getI18nText",(function(e){var t=e.match(/链接至幻灯片\s(\d+)/);return Array.isArray(t)&&t[1]?g.a.t("链接至幻灯片 {0}",{0:t[1]}):g.a.t(e)})),f()(Y()(i),"getModeFromConfigData",(function(){var e;return i.state.config.importConfig.map((function(t){var n;"changeDisplay"===t.id&&(e=null===(n=t.config.items.filter((function(e){return e.isSelected}))[0])||void 0===n?void 0:n.id)})),e})),f()(Y()(i),"onSelectedItemCallback",(function(e){e!==i.getModeFromConfigData()&&(i.state.config.handleModeChange(e),i.setState({isDropDownExtendShow:!1})),i.state.config.tdwOnSelectedItemCallback(e)})),f()(Y()(i),"showDropDownMenu",(function(){i.setState({isDropDownExtendShow:!0})})),f()(Y()(i),"hideDropDownMenu",(function(){i.setState({isDropDownExtendShow:!1})})),i.state={isShown:!1,config:{},isDropDownExtendShow:!1},i}return d()(n,[{key:"componentWillUnmount",value:function(){this.removeListener()}},{key:"shouldComponentUpdate",value:function(e,t){return 0!==Object.keys(t.config).length}},{key:"render",value:function(){var e=this,t=this.state.isShown?"":"none",n=this.state.config,i=n.top,r={left:n.left,top:i,display:t},a=this.state.config.href,o=Object(wt.a)(a),l=function(e){return 0===(null==e?void 0:e.indexOf(I.a))}(a),s=this.state.config.importConfig;return s?K.a.createElement("span",{className:Ce.a["ppt-link-floatbar-v2"],ref:function(t){e.floatDom=t},style:r,onMouseDown:this.preventDefault,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseMove:this.handleMouseMove},s.map((function(t,n){return e.parseButtonConfig(t,n===s.length-1,o,l)}))):null}}]),n}(H.Component),At=n("aa315fe5af"),Ct=n.n(At),Rt={insert:"head",singleton:!1},Dt=(fe()(Ct.a,Rt),Ct.a.locals||{}),Tt=n("1748118723"),Lt=n.n(Tt);function Ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ee()(e);if(t){var r=ee()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Q()(this,n)}}var jt=function(e){X()(n,e);var t=Ft(n);function n(e){var i;return s()(this,n),i=t.call(this,e),f()(Y()(i),"fullScreenRef",void 0),f()(Y()(i),"show",(function(e){var t=i.fullScreenRef;t?(t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen(),i.setState({show:!0,config:e}),document.addEventListener("keydown",i.onExitKeyDown),document.addEventListener("fullscreenchange",i.handleFullScreenChange),document.addEventListener("mozfullscreenchange",i.handleFullScreenChange),document.addEventListener("webkitfullscreenchange",i.handleFullScreenChange),document.addEventListener("msfullscreenchange",i.handleFullScreenChange)):xe.a.show({message:g.a.t("暂不支持该浏览器下全屏"),type:"info",autoClose:!0,duration:1300})})),f()(Y()(i),"handleFullScreenChange",(function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||i.hide()})),f()(Y()(i),"hide",(function(){i.setState({show:!1}),i.removeListener(),n.fullScreenModal=null})),f()(Y()(i),"removeListener",(function(){document.removeEventListener("keydown",i.onExitKeyDown),document.removeEventListener("fullscreenchange",i.handleFullScreenChange),document.removeEventListener("mozfullscreenchange",i.handleFullScreenChange),document.removeEventListener("webkitfullscreenchange",i.handleFullScreenChange)})),f()(Y()(i),"exitFullScreen",(function(){var e;document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():null===(e=n.fullScreenModal)||void 0===e||e.hide()})),f()(Y()(i),"onExitKeyDown",(function(e){var t;"Escape"===e.key&&(null===(t=n.fullScreenModal)||void 0===t||t.hide())})),i.state={show:!1,config:{}},i.fullScreenRef=null,i}return d()(n,[{key:"componentWillUnmount",value:function(){this.removeListener()}},{key:"render",value:function(){var e,t=this,n=St()(this.state,"config.iframeId"),i=St()(this.state,"config.embedUrl"),r=St()(this.state,"config.title");return K.a.createElement("div",{className:Lt()((e={},f()(e,Dt["addon-fullscreen-container"],!0),f()(e,Dt["fullscreen-exit"],!this.state.show),e)),ref:function(e){return t.fullScreenRef=e}},K.a.createElement("div",{className:Dt["fullsreen-header"]},K.a.createElement("span",{className:Dt["back-fullscreen-title"]},r),K.a.createElement("div",{className:Dt["close-fullscreen"],onMouseUp:this.exitFullScreen.bind(this),onTouchEnd:this.exitFullScreen.bind(this)},K.a.createElement("div",{className:Dt["back-fullscreen-icon"]}),K.a.createElement("div",{className:Dt["back-fullscreen-text"]},g.a.t("返回文档")))),K.a.createElement("iframe",{id:n,src:i,allowFullScreen:!0,style:{width:"100%",height:"calc(100% - 48px)",backgroundColor:"white"}}))}}]),n}(H.Component);f()(jt,"fullScreenModal",null),f()(jt,"showFullScreen",(function(e){var t;jt.fullScreenModal||(jt.fullScreenModal=jt.createFullScreen()),null===(t=jt.fullScreenModal)||void 0===t||t.show(e)})),f()(jt,"createFullScreen",(function(){var e=document.createElement("div");return document.body.appendChild(e),se.a.render(K.a.createElement(jt,null),e)}));var Bt=jt,zt=function(){function e(t){var n=this;s()(this,e),f()(this,"leaveTimer",void 0),f()(this,"floatInstance",void 0),f()(this,"show",(function(e,t){n.floatInstance||(n.floatInstance=n.create()),n.floatInstance.show(e,t)})),f()(this,"hide",(function(){n.floatInstance&&n.floatInstance.hide()})),f()(this,"isShown",(function(){return!!n.floatInstance&&n.floatInstance.isShown()})),f()(this,"isMouseEnter",(function(){return!!n.floatInstance&&!!n.floatInstance.isMouseEnterBar()})),f()(this,"getCurrentConfig",(function(){return n.floatInstance?n.floatInstance.state.config:null})),f()(this,"hideAndClearTimeout",(function(){n.isShown()&&(n.clearLeaveTimer(),n.hide())})),f()(this,"clearLeaveTimer",(function(){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null)})),f()(this,"getNormalLinkConfig",(function(e,t){return e.map((function(e){var n;return"changeDisplay"===e.id?(null===(n=e.config.items)||void 0===n||n.forEach((function(e){e.isSelected="icon"===e.id?!!t.iconMode:!t.iconMode})),e):e}))})),this.addonManager=t}return d()(e,[{key:"openUrl",value:function(e){Object(M.s)(Object(M.d)(e))}},{key:"hideWithTimeout",value:function(e){var t=this;this.leaveTimer=setTimeout((function(){t.isMouseEnter()||t.hide()}),e)}},{key:"showAddonFullscreen",value:function(e){return Bt.showFullScreen(e)}},{key:"handleCopyUrl",value:function(e){var t;null!==(t=G.a.PrivilegeManager())&&void 0!==t&&t.copyable&&Et.b.emit(Et.a.TRIGGER_COPY_EVENT,(function(t){t(e);var n={message:g.a.t("复制链接成功"),type:"success",autoClose:!0};E.a.isMobile?Ae.a.show(n):xe.a.show(n)}))}},{key:"getDisplayPrivilege",value:function(e){var t=e||{},n=t.addon,i=t.editState,r=t.linkData,a=t.isIframeLink,o=t.needFullscreen,l=t.needShowAddon,s=t.addonHandler,c=null==n?void 0:n.displayMode;return E.a.isMobile?c===C.b.IFRAME?null:tt:c===C.b.IFRAME?this.getIframeToolBarConfig(i,o,l,s):a?this.geIframeLinkToolBarConfig(i,r):i>kt.b.EDITABLE?tt:e.isElemLink?Ke:this.getNormalLinkConfig(He,r)}},{key:"tdwOnSelectedItemCallback",value:function(e,t){Object(m.c)({opername:T.e.DOC_ADDON_PLATFORM,module:T.d.ADDON_IFRAME,action:T.b.ADDON_INSERT_STYLE,ver5:e===C.b.IFRAME?1:3,ver6:null==t?void 0:t.iframeId})}},{key:"handleTdwReport",value:function(e,t,n){if(t&&t.displayMode===C.b.IFRAME||n){var i=t.iframeId,r=t.embedUrl;Object(m.c)({opername:T.e.DOC_ADDON_PLATFORM,module:T.d.ADDON_INSERT_TOOLBAR,action:e,ver6:i,ver10:new URL(r).host})}}},{key:"create",value:function(){var e=document.createElement("div"),t=document.getElementById("canvas-wrapper");return e.id="link-float-container-id",null==t||t.appendChild(e),se.a.render(K.a.createElement(Ot,{addonManager:this.addonManager}),e)}},{key:"getIframeToolBarConfig",value:function(e,t,n,i){var r;if(e===kt.b.COPYABLE)r=t?$e:Ze;else if(e===kt.b.SELECTABLE)r=t?nt:et;else if(r=t?Je:Ye,n){var a=i.addonSceneItemsMap,o=i.formatAddonSceneList,l=i.addonScenes;Xe[1].config.items=o(a.get(l.IFRAME),!0);var s=r.findIndex((function(e){return"changeDisplay"===e.id}));r=r.slice(0,s+1).concat(Xe).concat(r.slice(s+1))}return r}},{key:"geIframeLinkToolBarConfig",value:function(e,t){return e===kt.b.COPYABLE?Qe:e===kt.b.SELECTABLE?tt:t.iconMode?qe:We}}]),e}(),Ut=n("f08da50217"),Nt=n("db0c73f5df");function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vt=window.hostname||window.location.hostname,Ht=function(){function e(t,n,i,a,l,c,d,u,h){var g=this;s()(this,e),f()(this,"getCanvasSize",void 0),f()(this,"playerInFrame",!1),f()(this,"linkEditMenuService",void 0),f()(this,"linkFloatBarService",void 0),f()(this,"linkUtils",void 0),f()(this,"editMenuTimer",void 0),f()(this,"getLinkColor",(function(e,t){var n;return"tx"===(null===(n=e["origin-href"])||void 0===n?void 0:n.colorType)?e.color:g.getLinkThemeColor(t)})),f()(this,"setLinkWhenEnter",(function(e,t){if(e.selection&&!g.isSelectionHasLink(e)){var n=e.getStartPoint(),i=e.getParent(n.path),r=o()(i,2),a=r[0],l=r[1],s=e.getStartPoint(l),c=e.getString({anchor:s,focus:n});if(c){if(c.match(/(\s+$)/g))return;var d=c.replace(/^\s+|\s+$/g,""),u=g.verifyTextToData(d);if(u){if(g.isParagraphHasLink(a))return;var f={anchor:e.getBeforePoint(n,c.length),focus:n};e.changeTextProps({href:u,"origin-href":u,"origin-raw-href":!0},f),c.toLowerCase().includes(Vt)?g.renameLinkData(e,c,f,u,t):null==t||t()}}}})),f()(this,"showLinkFloatBarMobile",(function(e,t){var n,i=(null===(n=e.currentTarget)||void 0===n?void 0:n.textElement)||{},r=i["origin-href"],a=g.getLinkUrlWithData(r);e.currentTarget&&setTimeout((function(){var e=g.isInNoteArea(),n=N.getSameLinkTextElements(i,t),o=g.processFloatBarAnchorRect(n,e),l=r.slideJump;g.linkFloatBarService.show({left:o.left,top:o.top,href:a,editable:!1,anchorView:E.a.isMobile?i:null,hasChinese:l,openLink:function(){var e,t;(g.openLink(r),g.linkFloatBarService.hide(),g.editorInstanceService.checkEditorIsEditing())&&(null===(e=document.activeElement)||void 0===e||null===(t=e.blur)||void 0===t||t.call(e))},importConfig:g.linkFloatBarService.getDisplayPrivilege(null),processFloatBarAnchorRect:function(){g.processFloatBarAnchorRect(n,e)},addonManager:g.addonManager,menuManager:g.menuManager,selectionService:g.selectionService})}),100)})),f()(this,"openLinkInPlay",(function(e,t){if(t&&e)if(t.slideJump){var n=e.getState(),i=null==n?void 0:n.control;if(i){var r=i.currentPage,a=i.pageCount,o=g.getJumpPage(t.slideJump,r,a);e.dispatch(Object(L.jumpToPage)(o))}}else{var l=g.getLinkUrlWithData(t);!0===g.playerInFrame?(l=Object(M.d)(l),Et.b.emit(Et.a.LINK_CLICKED_IN_FRAME,l)):(g.linkFloatBarService.openUrl(l),Et.b.emit(Et.a.LINK_CLICKED))}})),f()(this,"handleLinkMouseEnter",(function(e,t,n){var i,r=e.currentTarget.textElement["origin-href"];g.updateTitleShowStatus(null===(i=e.currentTarget)||void 0===i?void 0:i.worldBounds,r,!0),n.selected&&(null==t||!t.editor||g.editMenuTimer||g.linkEditMenuService.isShown()||g.playManager.isPlaying||g.editingStateManager.isInAnyEditingState()||(g.linkFloatBarService.clearLeaveTimer(),g.showLinkFloatBarPC(e,t,n)))})),f()(this,"handleLinkMouseLeave",(function(e,t){var n,i,r,a=null===(n=e.currentTarget)||void 0===n||null===(i=n.textElement)||void 0===i?void 0:i["origin-href"];g.updateTitleShowStatus(null===(r=e.currentTarget)||void 0===r?void 0:r.worldBounds,a,!1),t.selected&&(g.linkFloatBarService.clearLeaveTimer(),g.linkFloatBarService.isShown()&&g.linkFloatBarService.hideWithTimeout(500))})),f()(this,"getLinkDataAndSetLink",(function(e){var t=g.getCurrentLinkData(e.editor);setTimeout((function(){g.setTextLink(e,t)}),0)})),f()(this,"getLinkInfo",(function(e){var t=St()(e,"link.href");return t?{tooltip:g.getToolTip(t,!0),href:t}:{}})),f()(this,"getCanvasRect",(function(e){var t,n,i,r,a,o=null,l=null===(t=o=e?document.getElementById(x.a):document.getElementById("canvas"))||void 0===t?void 0:t.getBoundingClientRect();return{left:(null!==(n=null==l?void 0:l.left)&&void 0!==n?n:0)-((null===(i=o)||void 0===i?void 0:i.scrollLeft)||0),top:(null!==(r=null==l?void 0:l.top)&&void 0!==r?r:0)-((null===(a=o)||void 0===a?void 0:a.scrollTop)||0)}})),f()(this,"processAnchorRect",(function(e,t){if(!e)return{x:0,y:0,width:0,height:0};var n=g.getCanvasRect(t);return{x:e.left+e.width/2+n.left,y:e.top+n.top-4,width:0,height:(e.height||0)+8}})),f()(this,"processFloatBarAnchorRect",(function(e,t){var n=g.getCanvasRect(t),i=e.filter((function(e){return!(null==e||!e.text)})),r=N.getBounds(i),a=0,o=0;if(E.a.isMobile){var l,s,c,d=null===(l=g.getCanvasSize)||void 0===l?void 0:l.call(g);a=null!==(s=null==d?void 0:d.left)&&void 0!==s?s:0,o=null!==(c=null==d?void 0:d.top)&&void 0!==c?c:0}return{left:r.minX+n.left+a,top:r.maxY+n.top+o,width:r.maxX-r.minX,height:r.maxY-r.minY}})),f()(this,"setTextLink",(function(e,t){if(null!=e&&e.editor){var n=g.processAnchorRect(e.editor.getSelectionRect(),g.isInNoteArea()),i={},r=!1,a=g.getCurrentLinkData(e.editor,t);a&&(r=!0,i=a),g.linkEditMenuService.show({anchorRect:n,data:i,handleLinkRemove:function(){e.editor&&g.removeTextLink(e.editor,e.updateDataCB),g.linkEditMenuService.hide()},handleLinkEdit:function(t){var n;if(null!==(n=e.editor)&&void 0!==n&&n.selection){if(i.mimeType&&r&&t.url)g.asyncLinkEdit(i,t,e);else{var a,o,l=g.processSavedStylesWithColorType(t,i.colorType,e.editor);t.text===(null===(a=e.editor)||void 0===a?void 0:a.getString())?e.editor.changeTextProps(l):e.editor.insertText(t.text,l),e.editor.updateSurface(),null===(o=e.updateDataCB)||void 0===o||o.call(e)}var s;s=r?T.b.LINK_EDIT:T.b.LINK_INSERT,Object(m.c)({opername:T.e.DOC_PPT,module:T.d.PC_EDIT,action:s})}g.linkEditMenuService.hide()}})}})),f()(this,"processSavedStylesWithColorType",(function(e,t,n){if("tx"!==t)return Object(P.i)({href:e});e.colorType="tx";var i=Object(P.i)({href:e});return _t(_t({},n.getStyle()),i)})),f()(this,"asyncLinkEdit",(function(e,t,n){var i=e.iconMode;g.requestLinkData(t.url).then((function(r){var a,o;if(e.text===n.editor.getString()){var l=t.text,s=R.b;r&&0===r.retcode&&(l=r.result.linkInfo.title,s=r.result.linkInfo.mimeType);var c=Object(P.i)({href:_t(_t({},t),{},{mimeType:s,iconMode:i})});t.text===(null===(a=n.editor)||void 0===a?void 0:a.getString())?n.editor.changeTextProps(c):n.editor.insertText(t.text||l,c),n.editor.updateSurface(),null===(o=n.updateDataCB)||void 0===o||o.call(n)}}))})),f()(this,"removeTextLink",(function(e,t){e.removeTextProps("href"),e.removeTextProps("origin-href"),null==t||t()})),f()(this,"getLinkThemeColor",(function(e){return g.linkUtils.getLinkThemeColor(e)})),f()(this,"verifyTextToData",(function(e){var t;return Object(S.c)(e)?t={url:e}:0===e.indexOf(I.a)?t={mail:Object(k.b)(e)}:Object(S.a)(e)&&(t={mail:Object(k.b)("".concat(I.a).concat(e))}),t})),f()(this,"renameLinkData",(function(e,t,n,i,r){var a=t;g.requestLinkData(a).then((function(a){if(a&&0===a.retcode){if(e.setSelection(n),e.getString()!==t)return void(null==r||r());var o=a.result.linkInfo,l=o.title,s=o.mimeType,c=Object(P.i)({href:_t(_t({},i),{},{mimeType:s,iconMode:!0})});e.insertText(l,c),null==r||r()}}))})),f()(this,"isSelectionHasLink",(function(e){return!!e.getStyle()["origin-href"]})),f()(this,"isParagraphHasLink",(function(e){return!(null==e||!e.children)&&e.children.some((function(e){return!!e["origin-href"]}))})),f()(this,"changeNormalLinkMode",function(){var e=r()(p.a.mark((function e(t,n,i,r,a,o){var l,s,c,d,u,f;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=r.mimeType,s=t.getStyle(),!l){e.next=9;break}c=Object(P.i)({href:_t(_t({},r),{},{mimeType:l,iconMode:"icon"===i})}),t.insertText(a,_t(_t({},s),c)),t.updateSurface(),null==o||o(),e.next=18;break;case 9:if(d=R.b,u=a||n,!v.network.isOnline){e.next=14;break}return e.next=14,new Promise((function(e){g.requestLinkData(n).then((function(t){t&&0===t.retcode&&(u=t.result.linkInfo.title,d=t.result.linkInfo.mimeType),e(null)}))}));case 14:f=Object(P.i)({href:_t(_t({},r),{},{mimeType:d,iconMode:"icon"===i})}),t.insertText(a||u,_t(_t({},s),f)),t.updateSurface(),null==o||o();case 18:case"end":return e.stop()}}),e)})));return function(t,n,i,r,a,o){return e.apply(this,arguments)}}()),f()(this,"changeIframeLinkMode",(function(e,t,n,i,r){var a,o={url:t,text:e.getString()};null===(a=i.editorInstance)||void 0===a||a.triggerBlur(),setTimeout((function(){g.addonManager.changeIframeMode(i,n,o,{},(function(t){return t.filter((function(t,n){if(e.isIncludedInRange([n],r))return!1;var i=t.textRuns;return!i||0===i.length||(t.textRuns=i.filter((function(t,i){var a=[n,i];return!e.isIncludedInRange(a,r)})),0!==t.textRuns.length)}))}))}),100)})),f()(this,"openLink",(function(e){if(e.slideJump){var t=g.getJumpPage(e.slideJump,g.selectionService.currentSlideIndex,g.selectionService.slides.length);g.selectionService.currentSlideIndex!==t&&(g.selectionService.selectedElements.clear(),g.selectionService.changeCurrentSlideIndexByUserAction(t))}else{var n=g.getLinkUrlWithData(e);g.linkFloatBarService.openUrl(n)}})),f()(this,"updateTitleShowStatus",(function(e,t,n){var i=0,r=0;e&&(i=(e.maxX+e.minX)/2,r=e.maxY);var a=g.getToolTip(t,!0);Et.b.emit(Et.a.UPDATE_TITLE_SHOW_STATE,{visible:n,containerOffsetX:i,containerOffsetY:r,title:a})})),f()(this,"isInNoteArea",(function(){return g.selectionService.lastMouseDownRegion===A.a.NOTE})),f()(this,"getSelectedModel",(function(e){var t=g.selectionService.getSelectedModel();if(Object(D.x)(t)){var n=t.getSelectedModels();null==n||n.forEach((function(n){e===n.key&&(t=n)}))}return t})),f()(this,"getCurrentLinkData",(function(e,t){if(t)return t;var n=g.getCurrentLinkInfo(e);if(n){if(e.isSelectionCollapsed()){var i=e.getSelectionNodes((function(e){return"text"===e.type})),r=o()(i,1),a=o()(r[0],1)[0],l=N.getSameLinkTextElements(a,e);e.selectTextElements(l)}return _t(_t({},n),{},{text:e.getString()})}return e.getString()?{text:e.getString()}:null})),this.uiDataService=t,this.selectionService=n,this.addonManager=i,this.playManager=a,this.editingStateManager=l,this.editorInstanceService=c,this.userPriviledgeService=d,this.injectables=u,this.menuManager=h,this.editMenuTimer=null,this.linkUtils=new V(t,n),this.linkEditMenuService=new Pe(t,this,h),this.linkFloatBarService=new zt(i)}var t,n,i;return d()(e,[{key:"setMenuManagerDelegate",value:function(e){this.menuManager||(this.menuManager=e,this.linkEditMenuService.menuManager=e)}},{key:"requestLinkData",value:(i=r()(p.a.mark((function e(t){var n,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=this.injectables)&&void 0!==n&&n.supportLinkInfo){e.next=2;break}return e.abrupt("return",Promise.resolve(null));case 2:return i="https://".concat(Vt,"/v2/file/link/getinfo?xsrf=").concat(Object(Nt.b)()),e.abrupt("return",Object(w.a)({method:"post",url:i,timeout:2e3,data:JSON.stringify({docUrl:t}),headers:{"Content-type":"application/json"}}).then((function(e){return e.data})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"insertTextWithLink",value:function(){var e=this,t={style:{position:"absolute",left:this.uiDataService.presentation.props.slideWidth/2-200,top:this.uiDataService.presentation.props.slideHeight/4,bgShape:y.b.RECT,border:{width:1,style:"solid"}},subType:1},n={textBodyStyle:{autoFitType:O.a.SHAPE_AUTO_FIT}},i=this.selectionService.currentSlideIndex;this.selectionService.slides[i].addElement([b.d.SHAPE],[t],[n]),setTimeout((function(){var t=e.selectionService.getSelectedModel();t.editorInstance&&t.editorInstance.setFocus((function(){var e;null===(e=t.editorInstance)||void 0===e||e.setTextLink()}))}),200)}},{key:"getTextLinkState",value:function(e){return!!this.getCurrentLinkInfo(e)}},{key:"getLinkUrlWithData",value:function(e){return e.url||(e.mail?Object(k.a)(e.mail):"")||(e.slideJump?this.getInnerLinkInfo(e.slideJump,{prefix:g.a.t("链接至")}):"")}},{key:"getJumpPage",value:function(e,t,n){var i=t;if(null!=e&&e.action){var r=e.action.indexOf("?");if(r>0)i=this.getPageWithQuestionMarkInAction(e,r,t,n);else if(e.target){var a=Object(be.a)(e.target,this.uiDataService.presentation.children);i=parseInt(a,10),isNaN(i)?i=t:i-=1}}return i<0&&(i=0),i>=n&&(i=n-1),i}},{key:"getInnerLinkInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=g.a.t("下一张幻灯片");if(e.action){var i=e.action.indexOf("?");if(i>0)switch(e.action.substring(i+6)){case"previousslide":n=g.a.t("上一张幻灯片");break;case"firstslide":n=g.a.t("第一张幻灯片");break;case"lastslide":n=g.a.t("最后一张幻灯片");break;case"nextslide":n=g.a.t("下一张幻灯片")}else if(e.target){var r=Object(be.a)(e.target,this.uiDataService.presentation.children);if(-1!==r.indexOf(Ut.a))return g.a.t("链接已失效, 请重新设置");n="".concat(g.a.t("幻灯片")," ").concat(r)}}return t.prefix?"".concat(t.prefix).concat(n):n}}},{key:"getToolTip",value:function(e,t){var n;if(t){var i=this.getLinkUrlWithData(e);0===(null===(n=i)||void 0===n?void 0:n.indexOf(I.a))&&(i=i.substring(I.a.length));try{return e.tooltip||decodeURI(i)}catch(e){return i}}}},{key:"getPageWithQuestionMarkInAction",value:function(e,t,n,i){var r=n;switch(e.action.substring(t+6)){case"previousslide":r-=1;break;case"firstslide":r=0;break;case"lastslide":r=i-1;break;case"nextslide":r+=1}return r}},{key:"getCurrentLinkInfo",value:function(e){if(e.isSelectionCollapsed()){var t=e.getStyle();return null==t?void 0:t["origin-href"]}var n=e.getSelectionNodes((function(e){return"text"===e.type})),i=o()(n,1),r=o()(i[0],1)[0];return null==r?void 0:r["origin-href"]}},{key:"showLinkFloatBarPC",value:(n=r()(p.a.mark((function e(t,n,i){var r,a,o,l,s,c,d,u,f,h,v,g,m,y,b,S,k,E,I,M=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n&&n.editor&&!this.linkEditMenuService.isShown()){e.next=2;break}return e.abrupt("return");case 2:if(null===(r=this.menuManager)||void 0===r||!r.isMenuShown){e.next=4;break}return e.abrupt("return");case 4:if(s=this.addonManager,(null!==(a=null===(o=this.selectionService.selectedElements)||void 0===o||null===(l=o.selectedArray)||void 0===l?void 0:l.length)&&void 0!==a?a:0)>0&&(c=null===(d=this.selectionService.selectedElements)||void 0===d||null===(u=d.selectedArray)||void 0===u||null===(f=u[0])||void 0===f||null===(h=f.props)||void 0===h?void 0:h.addon),v=t.currentTarget,g=v.textElement,m=null==g?void 0:g["origin-href"],!v){e.next=22;break}if(this.linkFloatBarService.clearLeaveTimer(),y=this.getLinkUrlWithData(m),b=m.slideJump,S=!1,k=this.isInNoteArea()){e.next=19;break}return e.next=18,s.checkLink(y);case 18:S=e.sent;case 19:E=N.getSameLinkTextElements(g,null==n?void 0:n.editor),I=this.processFloatBarAnchorRect(E,k),this.linkFloatBarService.show({left:I.left,top:I.top,height:I.height,width:I.width,href:y,hasChinese:b,iconMode:!!m.iconMode,importConfig:this.linkFloatBarService.getDisplayPrivilege({addon:c,editState:this.userPriviledgeService.pptEditorState,linkData:m,isIframeLink:S}),addonManager:this.addonManager,menuManager:this.menuManager,selectionService:this.selectionService,openLink:function(){M.openLink(m)},handleLinkRemove:function(){if(i.onLinkRemove)i.onLinkRemove();else{var e,r,a,o=E;null!=n&&null!==(e=n.editor)&&void 0!==e&&e.isFocused||(null==n||null===(a=n.editor)||void 0===a||a.focus(),o=N.getSameLinkTextElements(t.currentTarget.textElement,null==n?void 0:n.editor)),null==n||null===(r=n.editor)||void 0===r||r.selectTextElements(o),M.removeTextLink(null==n?void 0:n.editor,n.updateDataCB)}M.linkFloatBarService.hide()},handleModeChange:function(e){var t,r;null==n||null===(t=n.editor)||void 0===t||t.selectTextElements(E);var a=null==n||null===(r=n.editor)||void 0===r?void 0:r.getString();M.handleModeChange(n,_t(_t({},i),{},{text:a}),m,e)},deleteElement:function(){var e;null===(e=M.selectionService.currentSlide)||void 0===e||e.deleteElement()},handleMouseLeave:function(){M.linkFloatBarService.hideWithTimeout(500)},handleCopyUrl:function(){M.linkFloatBarService.handleCopyUrl(y),M.linkFloatBarService.handleTdwReport(T.b.ADDON_COPY,c,S)},handleModifyUrl:function(){if(i.onLinkEdit)i.onLinkEdit();else{var e,r,a,o=E;null!=n&&null!==(e=n.editor)&&void 0!==e&&e.isFocused||(null==n||null===(a=n.editor)||void 0===a||a.focus(),o=N.getSameLinkTextElements(t.currentTarget.textElement,null==n?void 0:n.editor)),null==n||null===(r=n.editor)||void 0===r||r.selectTextElements(o),M.editMenuTimer&&clearTimeout(M.editMenuTimer),M.editMenuTimer=setTimeout((function(){var e;M.setTextLink(n,_t(_t({},m),{},{text:null==n||null===(e=n.editor)||void 0===e?void 0:e.getString()})),M.editMenuTimer=null}),150)}M.linkFloatBarService.hide()},tdwOnSelectedItemCallback:function(e){c||(c=s.getIframeInfo()),M.linkFloatBarService.tdwOnSelectedItemCallback(e,c)}});case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})},{key:"handleModeChange",value:function(e,t,n,i){t.onModeChange?t.onModeChange():this.changeLinkMode(e,t,n,i),this.linkFloatBarService.hide()}},{key:"changeLinkMode",value:(t=r()(p.a.mark((function e(t,n,i,r){var a,o,l,s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.getSelectedModel(n.modelKey),o=t.editor,l=t.updateDataCB,s=o.selection,a&&s){e.next=5;break}return e.abrupt("return");case 5:return c=this.getLinkUrlWithData(i),e.next=8,this.addonManager.checkLink(c);case 8:e.sent&&r===C.b.IFRAME?this.changeIframeLinkMode(o,c,r,a,s):this.changeNormalLinkMode(o,c,r,i,n.text,l);case 10:case"end":return e.stop()}}),e,this)}))),function(e,n,i,r){return t.apply(this,arguments)})}]),e}()},"8eacaf6766":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=n("e0a67dc3fe"),s=function(){function e(){r()(this,e)}return o()(e,[{key:"supportLinkInfo",get:function(){var e;return null===(e=l.a.getConfig("custom.feature.supportLinkInfo"))||void 0===e||e}}]),e}()},"93da285f11":function(e,t,n){"use strict";n.d(t,"a",(function(){return de}));var i,r,a,o,l,s,c,d,u,f,h,p,v,g,m,y,b,S,k,E,I,M,P,w,x,O,A,C,R=n("176815363d"),D=n.n(R),T=n("1f925d7f50"),L=n.n(T),F=n("9132715560"),j=n.n(F),B=n("6a364eb35c"),z=n.n(B),U=n("85d0a7609b"),N=n.n(U),G=n("2dc700e1e6"),_=n.n(G),V=(n("f1054791f4"),n("3ef2352f0b")),H=n.n(V),K=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("081c8cafea"),n("8ee19818c4"),n("c9a7ecac4d"),n("c554310b5c"),n("d5c3deb8c7")),W=n("c7530f2183"),q=n("82f2dc9440"),Y=n.n(q),J=n("b74ee0edd6"),X=n.n(J),Z=n("5fac0349d3"),Q=n("d9812f1c6f"),$=n("dc9dac28cb"),ee=n("3f87030d09"),te=n("862b984676"),ne=n("c9c92622ff"),ie=n("c77811d8de"),re=n("fed003a03b"),ae=n("dca2cfac94"),oe=n("020899bf26"),le=n("7af4d80efc"),se=n("05d181ac40");!function(e){e.ADD="add",e.DELETE="delete"}(C||(C={}));var ce=Q.a.isMobile?X.a:Y.a,de=(i=Reflect.metadata("design:type",String),r=Reflect.metadata("design:type",String),a=Reflect.metadata("design:type",Function),o=Reflect.metadata("design:paramtypes",[]),l=Reflect.metadata("design:type",Function),s=Reflect.metadata("design:paramtypes",[String,Function]),c=Reflect.metadata("design:type",Function),d=Reflect.metadata("design:paramtypes",[]),u=Reflect.metadata("design:type",Function),f=Reflect.metadata("design:paramtypes",[Boolean]),h=Reflect.metadata("design:type",Function),p=Reflect.metadata("design:paramtypes",[Boolean]),v=Reflect.metadata("design:type",Function),g=Reflect.metadata("design:paramtypes",[]),m=function(){function e(){var t=this;j()(this,e),L()(this,"elementKey",y,this),L()(this,"isEditMode",b,this),N()(this,"videoInstances",Object(K.q)(new Map,{deep:!1})),N()(this,"videoInstancesInPlayer",Object(K.q)(new Map,{deep:!1})),N()(this,"audioInstances",Object(K.q)(new Map,{deep:!1})),N()(this,"audioInstancesInPlayer",Object(K.q)(new Map,{deep:!1})),L()(this,"prevIframeSelected",S,this),L()(this,"currentIframeSelected",k,this),L()(this,"iframePoster",E,this),L()(this,"iframePosterCaches",I,this),L()(this,"animatingGif",M,this),L()(this,"playerAnimationFinishedGif",P,this),L()(this,"playerAnimatingGif",w,this),L()(this,"thumbnailElementKey",x,this),L()(this,"notifyGifScaleUpdate",O,this),L()(this,"playerMediaElementKeys",A,this),N()(this,"audioInstancesInMobilePreview",new Map),N()(this,"videoInstancesInMobilePreview",new Map),N()(this,"elementUnSelectedCallback",void 0),N()(this,"preserveAudio",new Map),N()(this,"imageAttachmentPosterUrlMap",new Map),N()(this,"audioInstancePending",new Map),N()(this,"fetchIframePoster",function(){var e=D()(H.a.mark((function e(n){var i,r,a,o,l,s,c,d,u;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.props.addon,r=i.originUrl,a=i.embedUrl,o=i.iframeId,l=i.extraData,s=n.props.style,c=s.width,d=s.height,e.prev=2,e.next=5,$.b.getInstance().getScreenshotImage({originUrl:r,embedUrl:a,iframeId:o,extraData:l},Object(ee.e)({originUrl:r,embedUrl:a}),c,d);case 5:u=e.sent,t.iframePosterCaches.set(n.key,u),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),window.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()),N()(this,"fetchImageAttachmentPoster",(function(e){if(!Object(ne.b)(e))return null;var n=t.imageAttachmentPosterUrlMap.get(e.key);if(n)return n;var i=ae.c.getInstance(),r=function(){var n=D()(H.a.mark((function n(){var r,a,o,l,s;return H.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=i.dcAttachmentModule,n.next=4,o.getMediaPoster({objKey:e.props.attachment.objKey,fileId:null!==(r=null===(a=oe.a.DocInfoManager())||void 0===a?void 0:a.padId)&&void 0!==r?r:""});case 4:return l=n.sent,s=e.key,t.imageAttachmentPosterUrlMap.set(s,l),setTimeout((function(){t.imageAttachmentPosterUrlMap.delete(s)}),6e4),n.abrupt("return",l);case 11:return n.prev=11,n.t0=n.catch(0),n.abrupt("return",null);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(){return n.apply(this,arguments)}}();return i.hasInit?r():new Promise((function(e){i.addUploadListener({onUpLoaderInit:function(){r().then(e)}})}))}))}return z()(e,[{key:"isShowIframe",get:function(){return this.prevIframeSelected&&this.currentIframeSelected}},{key:"shouldRenderGifPoster",value:function(e){return this.animatingGif.has(e)}},{key:"shouldRenderDomGif",value:function(e){return!this.shouldRenderGifPoster(e)}},{key:"shouldPlayerRenderGifPoster",value:function(e){return this.playerAnimatingGif.has(e)&&!this.playerAnimationFinishedGif.has(e)}},{key:"shouldPlayerRenderDomGif",value:function(e){return this.playerAnimationFinishedGif.has(e)}},{key:"onInitAnimStyles",value:function(e,t){var n=this;this.invokeCallbackWithGifElementModelKey(e,(function(e){t?n.playerAnimationFinishedGif.delete(e):n.playerAnimationFinishedGif.add(e),n.playerAnimatingGif.delete(e)}))}},{key:"handleAnimationStart",value:function(e){var t=this;this.invokeCallbackWithGifElementModelKey(e,(function(e){t.animatingGif.add(e)}))}},{key:"handleAnimationEnd",value:function(e){var t=this;this.invokeCallbackWithGifElementModelKey(e,(function(e){t.animatingGif.delete(e)}))}},{key:"handlePlayerAnimationStart",value:function(e){var t=this;this.invokeCallbackWithGifElementModelKey(e,(function(e){t.playerAnimationFinishedGif.delete(e),t.playerAnimatingGif.add(e)}))}},{key:"handlePlayerAnimationEnd",value:function(e,t){var n=this,i=t.props.presetClass===ie.e.EXIT,r=t.props.presetClass===ie.e.EMPH;this.invokeCallbackWithGifElementModelKey(e,(function(a){if(i||n.playerAnimationFinishedGif.add(a),n.playerAnimatingGif.delete(a),r&&t.props.by){var o=t.props.by,l=o.x,s=o.y;n.notifyGifScaleUpdate={key:e.key,widthScale:null!=l?l:1,heightScale:null!=s?s:1}}}))}},{key:"setPlayerGifAnimationFinishedState",value:function(e){var t=this;this.invokeCallbackWithGifElementModelKey(e,(function(e){t.playerAnimationFinishedGif.add(e)}))}},{key:"handlePlayEnd",value:function(){this.playerAnimationFinishedGif.clear(),this.playerAnimatingGif.clear()}},{key:"updateActiveThumbnailMedia",value:function(e,t){this.thumbnailElementKey=e,this.elementUnSelectedCallback=t}},{key:"removeActiveThumbnailMedia",value:function(){var e;this.thumbnailElementKey&&(null===(e=this.elementUnSelectedCallback)||void 0===e||e.call(this),this.elementUnSelectedCallback=null,this.thumbnailElementKey="")}},{key:"updateIframeSelectState",value:function(e){this.prevIframeSelected=this.currentIframeSelected,this.currentIframeSelected=e}},{key:"changeIframeDisplayState",value:function(e){this.prevIframeSelected=e,this.currentIframeSelected=e}},{key:"resetIframeSelectedState",value:function(){this.prevIframeSelected=!1,this.currentIframeSelected=!1}},{key:"updateElementKey",value:function(e){this.elementKey=e}},{key:"updateElementKeyByRegion",value:function(e,t){t===te.a.EDITOR&&this.updateElementKey(e),t===te.a.PLAYER&&this.addPlayerMediaElementKey(e)}},{key:"removeElementKeyByRegion",value:function(e,t){this.elementKey===e&&t===te.a.EDITOR&&this.updateElementKey(null),this.shouldShowPlayerMediaElement(e)&&t===te.a.PLAYER&&this.deletePlayerMediaElementKey(e)}},{key:"addPlayerMediaElementKey",value:function(e){this.playerMediaElementKeys.add(e)}},{key:"clearPlayerMediaElementKey",value:function(){this.playerMediaElementKeys.clear()}},{key:"shouldShowMediaElement",value:function(e,t){return t===te.a.EDITOR?this.elementKey===e:t===te.a.PLAYER?this.shouldShowPlayerMediaElement(e):t===te.a.MOBILE_PREVIEW}},{key:"getVideoInstanceByRegion",value:function(e,t){var n,i,r;return null!==(i=null===(r=(n={},N()(n,te.a.EDITOR,this.videoInstances),N()(n,te.a.PLAYER,this.videoInstancesInPlayer),N()(n,te.a.MOBILE_PREVIEW,this.videoInstancesInMobilePreview),n)[t])||void 0===r?void 0:r.get(e))&&void 0!==i?i:null}},{key:"setVideoInstancesByRegion",value:function(e,t,n){n===te.a.EDITOR&&this.videoInstances.set(e,t),n===te.a.PLAYER&&this.videoInstancesInPlayer.set(e,t),n===te.a.MOBILE_PREVIEW&&this.videoInstancesInMobilePreview.set(e,t)}},{key:"deleteVideoInstanceByRegion",value:function(e,t){this.pauseVideoByRegion(e,t),t===te.a.EDITOR&&this.videoInstances.delete(e),t===te.a.PLAYER&&this.videoInstancesInPlayer.delete(e),t===te.a.MOBILE_PREVIEW&&this.videoInstancesInMobilePreview.delete(e)}},{key:"getPreserveAudioByKey",value:function(e){return this.preserveAudio.get(e)}},{key:"setPreserveAudioByKey",value:function(e,t){this.preserveAudio.set(e,t)}},{key:"deletePreserveAudioByKey",value:function(e){this.preserveAudio.delete(e)}},{key:"setAudioInstanceByRegion",value:function(e,t,n){var i;(n===te.a.EDITOR&&this.audioInstances.set(e,t),n===te.a.PLAYER)&&(this.audioInstancesInPlayer.set(e,t),null===(i=this.audioInstancePending.get(e))||void 0===i||i(t));n===te.a.MOBILE_PREVIEW&&this.audioInstancesInMobilePreview.set(e,t)}},{key:"getAudioInstanceByRegion",value:function(e,t){var n;return(n={},N()(n,te.a.EDITOR,this.audioInstances),N()(n,te.a.PLAYER,this.audioInstancesInPlayer),N()(n,te.a.MOBILE_PREVIEW,this.audioInstancesInMobilePreview),n)[t].get(e)||null}},{key:"deleteAudioInstanceByRegion",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.resetAudioByRegion(e,t,n),t===te.a.EDITOR&&this.audioInstances.delete(e),t===te.a.PLAYER&&(n&&this.preserveAudio.get(e)||this.audioInstancesInPlayer.delete(e)),t===te.a.MOBILE_PREVIEW&&this.audioInstancesInMobilePreview.delete(e)}},{key:"playVideoByRegion",value:function(e,t){if(!this.handleOfflineToast()){if(t===te.a.EDITOR){if(this.updateElementKey(e),this.videoInstances.has(e)){var n=this.videoInstances.get(e);return void this.playVideo(n)}this.videoInstances.set(e,null)}if(t===te.a.PLAYER){if(this.addPlayerMediaElementKey(e),this.videoInstancesInPlayer.has(e)){var i=this.videoInstancesInPlayer.get(e);return void this.playVideo(i)}this.videoInstancesInPlayer.set(e,null)}}}},{key:"playAudioByRegion",value:function(e,t){var n=this;if(!this.handleOfflineToast()){var i;if(t===te.a.EDITOR)if(this.updateElementKey(e),this.audioInstances.has(e))return void(null===(i=this.audioInstances.get(e))||void 0===i||i.play());if(t===te.a.PLAYER){this.addPlayerMediaElementKey(e);var r=this.audioInstancesInPlayer.get(e);r?r.play():this.audioInstancePending.set(e,(function(t){t.addEventListener("canplay",(function(){t.play()}),{once:!0}),n.audioInstancePending.delete(e)}))}}}},{key:"pauseVideoByRegion",value:function(e,t){var n=this.getVideoInstanceByRegion(e,t);null==n||n.pause(),this.removeElementKeyByRegion(e,t)}},{key:"pauseAudioByRegion",value:function(e,t){var n=this.getAudioInstanceByRegion(e,t);null==n||n.pause(),this.removeElementKeyByRegion(e,t)}},{key:"resetAudioByRegion",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getAudioInstanceByRegion(e,t);t===te.a.PLAYER&&this.preserveAudio.get(e)&&n||(this.resetAudio(i),this.removeElementKeyByRegion(e,t))}},{key:"resetVideoByRegion",value:function(e,t){var n=this.getVideoInstanceByRegion(e,t);this.resetVideo(n),this.removeElementKeyByRegion(e,t)}},{key:"shouldVideoRender",value:function(e,t){return t===te.a.EDITOR?this.videoInstances.has(e):t===te.a.PLAYER?this.videoInstancesInPlayer.has(e):t===te.a.MOBILE_PREVIEW}},{key:"resetAllEditorMedia",value:function(){var e=this;this.audioInstances.forEach((function(t){e.resetAudio(t)})),this.videoInstances.forEach((function(t){e.resetVideo(t)}))}},{key:"disposeAllEditorMediaInstance",value:function(){this.resetAllEditorMedia(),this.videoInstances.clear(),this.audioInstances.clear()}},{key:"resetAllPlayerMedia",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.audioInstancesInPlayer.forEach((function(t){e.resetAudio(t)})),this.videoInstancesInPlayer.forEach((function(n){e.resetVideo(n,t)})),this.preserveAudio.forEach((function(t){e.resetAudio(t.audioIns)}))}},{key:"resetAllPlayerMediaIfNeed",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.audioInstancesInPlayer.forEach((function(t,n){e.preserveAudio.get(n)||e.resetAudio(t)})),this.videoInstancesInPlayer.forEach((function(n){e.resetVideo(n,t)}))}},{key:"disposeAllPlayerMediaInstance",value:function(e){var t=this;if(e){this.resetAllPlayerMediaIfNeed(!0);var n=[];this.audioInstancesInPlayer.forEach((function(e,i){t.preserveAudio.get(i)||n.push(i)})),n.forEach((function(e){t.audioInstancesInPlayer.delete(e)}))}else this.resetAllPlayerMedia(!0),this.audioInstancesInPlayer.clear();this.videoInstancesInPlayer.clear()}},{key:"handlePreserveAudioState",value:function(e){var t=this;if(e||0===e){var n=[];this.preserveAudio.forEach((function(t,i){(e>t.stopAtSlideIndex||e<t.startAtSlideIndex)&&n.push(i)})),n.forEach((function(e){var n=t.preserveAudio.get(e).audioIns;t.resetAudio(n),t.deleteAudioInstanceByRegion(e,te.a.PLAYER),t.preserveAudio.delete(e)}))}}},{key:"resetAllMobilePreviewMedia",value:function(){var e=this;this.audioInstancesInMobilePreview.forEach((function(t){e.resetAudio(t)})),this.videoInstancesInMobilePreview.forEach((function(t){e.resetVideo(t)}))}},{key:"handleOfflineToast",value:function(){return!W.network.isOnline&&!se.a.IS_LOCAL_EDIT&&(ce.show({message:Z.a.t("当前处于离线环境，暂不支持预览此附件"),autoClose:!0,duration:2e3}),!0)}},{key:"resetAudio",value:function(e){e&&(re.r||(e.currentTime=0),e.pause())}},{key:"resetVideo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&("stop"in e?(e.pause(),e.stop()):e.pause(),t&&"destroy"in e&&e.destroy())}},{key:"playVideo",value:function(e){e&&(this.isWebVideo(e)?e.replay():e.play(0))}},{key:"isWebVideo",value:function(e){return(null==e?void 0:e.playerType)===le.b.WEB}},{key:"invokeCallbackWithGifElementModelKey",value:function(e,t){Object(ne.l)(e)?t(e.key):Object(ne.n)(e)&&e.getGifsInGroup().forEach((function(e){t(e.key)}))}},{key:"deletePlayerMediaElementKey",value:function(e){this.playerMediaElementKeys.delete(e)}},{key:"shouldShowPlayerMediaElement",value:function(e){return this.playerMediaElementKeys.has(e)}}]),e}(),y=_()(m.prototype,"elementKey",[K.q,i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=_()(m.prototype,"isEditMode",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=_()(m.prototype,"prevIframeSelected",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=_()(m.prototype,"currentIframeSelected",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=_()(m.prototype,"iframePoster",[K.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=_()(m.prototype,"iframePosterCaches",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),M=_()(m.prototype,"animatingGif",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),P=_()(m.prototype,"playerAnimationFinishedGif",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),w=_()(m.prototype,"playerAnimatingGif",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),x=_()(m.prototype,"thumbnailElementKey",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),O=_()(m.prototype,"notifyGifScaleUpdate",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),A=_()(m.prototype,"playerMediaElementKeys",[K.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),_()(m.prototype,"isShowIframe",[K.f,a,o],Object.getOwnPropertyDescriptor(m.prototype,"isShowIframe"),m.prototype),_()(m.prototype,"updateActiveThumbnailMedia",[K.d,l,s],Object.getOwnPropertyDescriptor(m.prototype,"updateActiveThumbnailMedia"),m.prototype),_()(m.prototype,"removeActiveThumbnailMedia",[K.d,c,d],Object.getOwnPropertyDescriptor(m.prototype,"removeActiveThumbnailMedia"),m.prototype),_()(m.prototype,"updateIframeSelectState",[K.d,u,f],Object.getOwnPropertyDescriptor(m.prototype,"updateIframeSelectState"),m.prototype),_()(m.prototype,"changeIframeDisplayState",[K.d,h,p],Object.getOwnPropertyDescriptor(m.prototype,"changeIframeDisplayState"),m.prototype),_()(m.prototype,"resetIframeSelectedState",[K.d,v,g],Object.getOwnPropertyDescriptor(m.prototype,"resetIframeSelectedState"),m.prototype),m)},9486306832:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.DRAGGING="dragging",e.DRAG_START="dragStart",e.DRAG_STOP="dragStop"}(i||(i={}))},"96af49c4f4":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("176815363d"),r=n.n(i),a=n("14502724a6"),o=n.n(a),l=n("3ef2352f0b"),s=n.n(l),c=(n("c6244f7705"),n("081c8cafea"),n("69084d01d3")),d=n.n(c),u=n("5fac0349d3"),f=n("52d461bc51"),h=n.n(f),p=n("6b3d7565ba"),v=n("020899bf26"),g=n("2f1cded8d8");function m(e){var t,n=Object(c.useState)(!1),i=o()(n,2),a=i[0],l=i[1];if(Object(c.useEffect)((function(){var e;return v.a.EventManager.promise().then((function(t){e=t.on(g.a.ShowSnapShotModal,(function(){l(!0)}))})),function(){var t;return null===(t=e)||void 0===t?void 0:t()}}),[]),!a)return null;var f=null!==(t=v.a.ClientVarsService())&&void 0!==t&&t.isLocalEdit()?function(){return d.a.createElement(d.a.Fragment,null,d.a.createElement(p.a,{visible:a,exportSnapshotFile:function(){var t=r()(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.exportManager.promise().then((function(e){e.exportSnapshotFile(n)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}))}:function(){return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{style:{fontWeight:"bold"}},u.a.t("本地备份")),d.a.createElement(p.a,{visible:a,exportSnapshotFile:function(){var t=r()(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.exportManager.promise().then((function(e){e.exportSnapshotFile(n)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),d.a.createElement("div",{style:{fontWeight:"bold"}},u.a.t("远程备份")),d.a.createElement(p.b,{visible:a,exportSnapshotFile:function(){var t;return null===(t=e.menuManager)||void 0===t?void 0:t.actionNativePPT()}}))};return d.a.createElement(h.a,{title:u.a.t("备份"),style:{width:"480px",height:"80vh"},maskStyle:{zIndex:1e4},type:"basic",visible:a,onCancel:function(){return l(!1)},onOk:function(){return l(!1)},cancelText:null,okText:u.a.t("关闭"),containerDom:document.body},d.a.createElement("div",{style:{width:"100%",height:"calc(80vh - 180px)",overflow:"auto"}},f()))}},"997508b724":function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("14502724a6"),r=n.n(i),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),s=n.n(l),c=n("547611bd96"),d=n.n(c),u=n("bd29e2df90"),f=n.n(u),h=n("ab5eb40518"),p=n.n(h),v=n("1b4cdd6a36"),g=n.n(v),m=n("85d0a7609b"),y=n.n(m),b=(n("826dc923b3"),n("530271770f")),S=n("e5a826a0ff"),k=n("e0e8dd9366"),E=n("c6c7cf6a47"),I=n("9da6335152"),M=n("d3d31c86eb"),P=n("8f58e78419"),w=n.n(P),x=n("6664e39d13"),O=n("8da38f8962"),A=n("5b84d9b725"),C=n("3a2def422a"),R=n("6715f30ed9"),D=n("afa09b0be3"),T=n("c9c92622ff"),L=n("2e2ccf062e"),F=n("b9a4a16e8e");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p()(this,n)}}var U=function(e){f()(n,e);var t=z(n);function n(e,i,a,l,s){var c;return o()(this,n),c=t.call(this),y()(d()(c),"elementModel",void 0),y()(d()(c),"multiRect",void 0),y()(d()(c),"editProcessLogic",void 0),y()(d()(c),"isGroupChildren",void 0),y()(d()(c),"isSmartArtChildren",void 0),y()(d()(c),"guidesManager",void 0),y()(d()(c),"absorbManager",void 0),y()(d()(c),"snapLineService",void 0),y()(d()(c),"resizeLogicPCInstance",void 0),y()(d()(c),"handleResizeStart",(function(e,t,n,i){var r;if(c.emit(F.a.RESIZE_START,{elementModel:e,e:null!==(r=null==t?void 0:t.event)&&void 0!==r?r:t}),c.elementModel=e,c.isGroupChildren=w()(e,"parent.type")===k.d.GROUP,c.isSmartArtChildren=w()(e,"parent.type")===k.d.SMART_ART,c.editProcessLogic=new x.a(c.editingStateManager,e,c.borderSketchManager),c.editProcessLogic.setSelectionService(c.selectionService),c.editProcessLogic.setGuidesManagerDelegate(c.guidesManager),c.editProcessLogic.setAbsorbManagerDelegate(c.absorbManager),c.editProcessLogic.setSnapLineServiceDelegate(c.snapLineService),c.multiRect=b.a.getInstance().getMultiRect(),b.a.getInstance().calculateSnapLines(),c.initResizeLogicPC(e,t,n,i),c.isGroupChildren)c.handleResizeStartForRootGroup();else{c.selectionService.selectedElements.clear(S.a.GROUP),c.linkManager.linkFloatBarService.hide(),c.moveElementManager.checkIsDelayUpdatePosing(),c.editingStateManager.updateElementResizeState(!0);var a=c.getActionOfReport();c.reportForAction(a)}})),y()(d()(c),"handleResize",(function(e,t,n,i,r){var a;c.emit(F.a.RESIZING,{elementModel:c.elementModel,e:e,mode:i,nextSize:n,originalSize:t,multiRect:c.multiRect,sizeMap:r}),E.a.getInstance().enableAdjustText()&&E.a.getInstance().updateElementWrapType(c.elementModel,i);var o=null===(a=c.editProcessLogic)||void 0===a?void 0:a.runConstraints(e,t,n,i,c.multiRect,r);c.isGroupChildren?c.handleResizeForRootGroup(e,t,n,i,null,o,r):c.editingStateManager.updateElementResizeState(!0,i)})),y()(d()(c),"handleResizeStop",(function(e){var t,n,i;c.emit(F.a.RESIZE_STOP,{elementModel:c.elementModel}),c.multiRect=null,b.a.getInstance().handleDragResizeStop(),null===(t=c.resizeLogicPCInstance)||void 0===t||t.stopResize(),c.isGroupChildren?c.handleResizeStopForRootGroup(e):(null===(n=c.editProcessLogic)||void 0===n||n.persistSize(e),c.editingStateManager.updateElementResizeState(!1),null===(i=c.editProcessLogic)||void 0===i||i.updateOperationFrame(null))})),y()(d()(c),"handleResizeStartForRootGroup",(function(){var e;if(c.moveElementManager.checkIsDelayUpdatePosing(),c.editingStateManager.updateElementResizeState(!0),1===c.selectionService.selectedElements.selectedArrayForType(S.a.GROUP).length){var t=c.selectionService.selectedElements.selectedArrayForType(S.a.GROUP);switch(r()(t,1)[0].type){case k.d.SHAPE:e=I.b.EDIT_SIZE;break;case k.d.IMAGE:e=I.b.IMG_SIZE}}c.reportForAction(e)})),y()(d()(c),"handleResizeForRootGroup",(function(e,t,n,i,r,a,o){var l;null===(l=c.editProcessLogic)||void 0===l||l.runConstraintsForGroup(e,t,n,i,null,a,o),c.editingStateManager.updateElementResizeState(!0,i)})),y()(d()(c),"handleResizeForRootSmartArt",(function(e,t,n,i,r,a,o){var l;null===(l=c.editProcessLogic)||void 0===l||l.runConstraintsForSmartArt(e,t,n,i,null,a,o),c.editingStateManager.updateElementResizeState(!0,i)})),y()(d()(c),"handleResizeStopForRootGroup",(function(e){var t,n;c.editingStateManager.updateElementResizeState(!1,e),c.elementModel.rootGroupModel&&(c.elementModel.rootGroupModel.childResizeFinished=!0),null===(t=c.editProcessLogic)||void 0===t||t.persistSizeForGroup(c.elementModel.rootGroupModel),c.editingStateManager.updateElementResizeState(!1),null===(n=c.editProcessLogic)||void 0===n||n.updateOperationFrameForGroup(null)})),y()(d()(c),"handleResizeStopForRootSmartArt",(function(e){var t,n;c.editingStateManager.updateElementResizeState(!1,e),c.elementModel.rootSmartArtModel&&(c.elementModel.rootSmartArtModel.childResizeFinished=!0),null===(t=c.editProcessLogic)||void 0===t||t.persistSizeForSmartArt(c.elementModel.rootSmartArtModel),c.editingStateManager.updateElementResizeState(!1),null===(n=c.editProcessLogic)||void 0===n||n.updateOperationFrameForSmartArt(null)})),c.editingStateManager=e,c.moveElementManager=i,c.selectionService=a,c.borderSketchManager=l,c.linkManager=s,c}return s()(n,[{key:"setGuidesManagerDelegate",value:function(e){this.guidesManager=e}},{key:"setAbsorbManagerDelegate",value:function(e){this.absorbManager=e}},{key:"setSnapLineServiceDelegate",value:function(e){this.snapLineService=e}},{key:"initResizeLogicPC",value:function(e,t,n,i){if(O.a.isPc){var r=R.a.relativeInfoForInner(e),a=R.a.frameInfoForInner(e);this.resizeLogicPCInstance=new A.a(B(B({startSize:C.a.sizeInfo(e),startFlip:C.a.flipInfo(e),scale:n},r),{},{isIframe:Object(T.o)(e),rotate:a.rotate,onResize:this.handleResize,modelIsLockAspect:Number(Object(D.a)(this.elementModel.type,this.elementModel.props)),resizeMode:i})),this.resizeLogicPCInstance.startResize(t)}}},{key:"getActionOfReport",value:function(){var e,t=this.selectionService.selectedElements;if(1===t.selectedArrayForType(S.a.SLIDE).length){var n=t.selectedArrayForType(S.a.SLIDE);switch(r()(n,1)[0].type){case k.d.SHAPE:e=I.b.EDIT_SIZE;break;case k.d.IMAGE:e=I.b.IMG_SIZE}}return e}},{key:"reportForAction",value:function(e){e&&Object(M.c)({opername:I.e.DOC_PPT,module:I.d.PC_OBJ,action:e})}}]),n}(L.a)},a07d5d1c57:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var i,r,a,o,l,s,c,d,u,f,h,p,v,g,m,y,b,S,k=n("1f925d7f50"),E=n.n(k),I=n("9132715560"),M=n.n(I),P=n("6a364eb35c"),w=n.n(P),x=n("85d0a7609b"),O=n.n(x),A=n("2dc700e1e6"),C=n.n(A),R=(n("f1054791f4"),n("d5c3deb8c7")),D=(i=Reflect.metadata("design:type","undefined"==typeof IConnectingInfo?Object:IConnectingInfo),r=Reflect.metadata("design:type",Object),a=function(){function e(){M()(this,e),E()(this,"isResizing",o,this),E()(this,"isTableRowColResizing",l,this),O()(this,"resizeMode",null),E()(this,"isDragging",s,this),E()(this,"isDraggingElement",c,this),E()(this,"isRotating",d,this),E()(this,"isCroping",u,this),E()(this,"isConnecting",f,this),E()(this,"readyToConnect",h,this),E()(this,"connectingInfo",p,this),E()(this,"isMovingWithKeyUpDown",v,this),E()(this,"isEditing",g,this),O()(this,"keyFlag4Moving",0),E()(this,"isControlValuesChanging",m,this),E()(this,"insertState",y,this),E()(this,"needDisableIframeEvent",b,this),E()(this,"hasUnsavedTextContent",S,this)}return w()(e,[{key:"isInAnyEditingState",value:function(){return this.isResizing||this.isDragging||this.isCroping||this.isRotating}},{key:"clearInsertState",value:function(){this.insertState={type:null,data:null}}},{key:"updateElementDraggingState",value:function(e){var t=this;Object(R.w)((function(){t.isDragging=e,t.isDraggingElement=e}))}},{key:"updateElementRotateState",value:function(e){var t=this;Object(R.w)((function(){t.isRotating=e}))}},{key:"updateElementResizeState",value:function(e,t){var n=this;Object(R.w)((function(){n.isResizing=e,n.resizeMode=t}))}},{key:"updateElementCropState",value:function(e){var t=this;Object(R.w)((function(){t.isCroping=e}))}},{key:"updateTableRowColResizeState",value:function(e){var t=this;Object(R.w)((function(){t.isTableRowColResizing=e}))}}]),e}(),o=C()(a.prototype,"isResizing",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=C()(a.prototype,"isTableRowColResizing",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=C()(a.prototype,"isDragging",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=C()(a.prototype,"isDraggingElement",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=C()(a.prototype,"isRotating",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=C()(a.prototype,"isCroping",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=C()(a.prototype,"isConnecting",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=C()(a.prototype,"readyToConnect",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=C()(a.prototype,"connectingInfo",[R.q,i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=C()(a.prototype,"isMovingWithKeyUpDown",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=C()(a.prototype,"isEditing",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=C()(a.prototype,"isControlValuesChanging",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=C()(a.prototype,"insertState",[R.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{type:null,data:null}}}),b=C()(a.prototype,"needDisableIframeEvent",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=C()(a.prototype,"hasUnsavedTextContent",[R.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a)},a28c657cc5:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),s=n.n(l),c=(n("75563bc376"),function(){function e(){var t=this;r()(this,e),s()(this,"selectionService",void 0),s()(this,"setSelectionServiceDelegate",(function(e){t.selectionService||(t.selectionService=e)})),s()(this,"getEditorInstance",(function(){var e,n,i,r=t.getSelectedArray();if(r){var a=r.find((function(e){var t;return null==e||null===(t=e.editorInstance)||void 0===t?void 0:t.isEditing}));return null==a?void 0:a.editorInstance}var o=null===(e=t.selectionService)||void 0===e||null===(n=e.currentSlide)||void 0===n||null===(i=n.noteData)||void 0===i?void 0:i.noteInstance;return null!=o&&o.isEditing?o.textEditor:null})),s()(this,"getSelectedArray",(function(){var e,n;return null===(e=t.selectionService)||void 0===e||null===(n=e.selectedElements)||void 0===n?void 0:n.selectedArray}))}return o()(e,[{key:"checkEditorIsEditing",value:function(){var e,t;return null!==(e=!(null===(t=this.getEditorInstance())||void 0===t||!t.isEditing))&&void 0!==e&&e}}]),e}())},aa315fe5af:function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var i=n("c92b994f13")(n("278320107d"));t.push([e.i,".addon-fullscreen-addon-fullscreen-container-2cKKh{width:100%;height:100%;border:1px solid rgba(0,0,0,.08);transition:height 0s ease;position:fixed;left:0;top:0;z-index:1001}.addon-fullscreen-addon-fullscreen-container-2cKKh .addon-fullscreen-fullsreen-header-2Dk-d{width:100%;height:48px;line-height:48px;text-align:center;background-color:#fff;display:inline-block}.addon-fullscreen-addon-fullscreen-container-2cKKh .addon-fullscreen-fullsreen-header-2Dk-d .addon-fullscreen-back-fullscreen-title-2j0Ph{height:20px;font-size:14px;opacity:.88;font-family:PingFang SC}.addon-fullscreen-addon-fullscreen-container-2cKKh .addon-fullscreen-fullsreen-header-2Dk-d .addon-fullscreen-close-fullscreen-25fuq{position:absolute;left:20px;top:14px;height:20px;line-height:20px;z-index:10;display:flex}.addon-fullscreen-addon-fullscreen-container-2cKKh .addon-fullscreen-fullsreen-header-2Dk-d .addon-fullscreen-close-fullscreen-25fuq:hover{opacity:.4}.addon-fullscreen-addon-fullscreen-container-2cKKh .addon-fullscreen-fullsreen-header-2Dk-d .addon-fullscreen-close-fullscreen-25fuq:active{opacity:.88}.addon-fullscreen-addon-fullscreen-container-2cKKh .addon-fullscreen-fullsreen-header-2Dk-d .addon-fullscreen-close-fullscreen-25fuq .addon-fullscreen-back-fullscreen-icon-2JQz6{width:9px;height:15px;line-height:15px;margin:auto 0;background:url("+i+") 50% no-repeat}.addon-fullscreen-addon-fullscreen-container-2cKKh .addon-fullscreen-fullsreen-header-2Dk-d .addon-fullscreen-close-fullscreen-25fuq .addon-fullscreen-back-fullscreen-text-zSSzL{width:56px;height:20px;line-height:20px;margin-left:6px;font-family:PingFang SC;font-size:14px;color:#000;cursor:default}.addon-fullscreen-addon-fullscreen-container-2cKKh iframe{box-sizing:border-box;border:1px solid rgba(0,0,0,.08)}.addon-fullscreen-fullscreen-exit-3rWXb{display:none;width:0;height:0}",""]),t.locals={"addon-fullscreen-container":"addon-fullscreen-addon-fullscreen-container-2cKKh","fullsreen-header":"addon-fullscreen-fullsreen-header-2Dk-d","back-fullscreen-title":"addon-fullscreen-back-fullscreen-title-2j0Ph","close-fullscreen":"addon-fullscreen-close-fullscreen-25fuq","back-fullscreen-icon":"addon-fullscreen-back-fullscreen-icon-2JQz6","back-fullscreen-text":"addon-fullscreen-back-fullscreen-text-zSSzL","fullscreen-exit":"addon-fullscreen-fullscreen-exit-3rWXb"}},b1e0ea6d5e:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),s=n.n(l),c=n("020899bf26"),d=n("7e61746219"),u=n("852a563065"),f=function(){function e(){r()(this,e),s()(this,"services",void 0),s()(this,"docInfo",void 0),s()(this,"editLifecycleAdapter",void 0),s()(this,"callbackAdapter",void 0),s()(this,"hasInit",!1)}return o()(e,[{key:"onReady",value:function(e){Object(c.b)(e)}},{key:"isEditableDriveDocs",value:function(){return!!Object(d.e)()}},{key:"isPreviewDriveDocs",value:function(){return Object(d.g)()}},{key:"isSpecialActivity",value:function(){return!1}},{key:"setDocInfo",value:function(e){this.docInfo=e}},{key:"getDocInfo",value:function(){return this.docInfo}},{key:"setCallBackAdapter",value:function(e){this.callbackAdapter=e}},{key:"getCallBackAdapter",value:function(){return this.callbackAdapter}},{key:"setLifecycleAdapter",value:function(e){this.editLifecycleAdapter=e}},{key:"setServiceDelegates",value:function(e){this.services=e,this.hasInit||(this.hasInit=!0,this.onServiceInit())}},{key:"onServiceInit",value:function(){var e=this,t=this.services.lifeCycleService;t.onEvent(u.a.DATA_READY,(function(){var t;null===(t=e.editLifecycleAdapter)||void 0===t||t.onReady()})),t.onEvent(u.a.INFRASTRUCTURE_DID_READY,(function(){var t;null===(t=e.editLifecycleAdapter)||void 0===t||t.onInfrastructureDidReady()})),t.onEvent(u.a.FIRST_SLIDE_RENDER,(function(){var t;null===(t=e.editLifecycleAdapter)||void 0===t||t.onFirstSlideRender()}))}}]),e}()},b385c36a13:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var i=n("14502724a6"),r=n.n(i),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),s=n.n(l),c=n("85d0a7609b"),d=n.n(c),u=(n("1bab7b5fb7"),n("9d7978d445"),n("63513d8b56"),n("3bf1976a4f"),n("8ee19818c4"),n("8e7cce0ada"),n("c6244f7705"),n("c9a7ecac4d"),n("85d48ef22b"),n("2a6f332b5e"),n("a2a09da1e3"),n("8f58e78419")),f=n.n(u),h=n("c73625d763"),p=n.n(h),v=n("5fac0349d3"),g=n("cd1934c1b5"),m=n("798a9cd6f2"),y=n("f28e450bc1"),b=n("ebd85bf338"),S="retryTimesKey",k="srcKey",E="thumbKey",I="objsKey",M=function(){function e(){var t=this;o()(this,e),d()(this,"convertUrlSet",void 0),d()(this,"elements",void 0),d()(this,"actElements",void 0),d()(this,"loadedUrls",void 0),d()(this,"property",void 0),d()(this,"originalProperty",void 0),d()(this,"loadingElements",void 0),d()(this,"maxLoadNumber",void 0),d()(this,"maxRetryTimes",void 0),d()(this,"preLoadResourceTimer",void 0),d()(this,"timer",void 0),d()(this,"setScrollTarget",(function(e){e.addEventListener("scroll",t.handlescroll)})),d()(this,"addImage",(function(e){t.actElements.push(e);var n=e,i=e.getAttribute(t.property);if(i){if(g.a.isBlobUrl(i))return t.changeHref(e,i),void t.loadBlobImage(e,i);for(var r=0;r<t.loadingElements.length;r++)if(t.loadingElements[r][k]===i)return void t.loadingElements[r][I].push(e);var a=t.executor(e);if(1===a.priority){var o=t.elements.highPriorityDict[i];o&&o.length>0?o.push(e):(o=[e],t.elements.highPriorityDict[i]=o,t.elements.highPriorityArray.push(o)),n.priority=1}else if(0===a.priority){var l=t.elements.lowPriorityDict[i];l&&l.length>0?l.push(e):(l=[e],t.elements.lowPriorityDict[i]=l,t.elements.lowPriorityArray.push(l)),n.priority=0}t.handle()}else{var s=e.getAttribute("xlink:href");g.a.isBlobUrl(s)&&t.loadBlobImage(e,s)}})),d()(this,"getUrlParam",(function(e,t){if(!e)return"";var n=e.split("?");if(n.length>1){for(var i,r=n[1].split("&"),a=0;a<r.length;a++)if(null!==(i=r[a].split("="))&&i[0]===t)return i[1];return""}return""})),d()(this,"checkIsLoaded",(function(e){return p()(t.loadedUrls,t.getThumb1600(e))?1:p()(t.loadedUrls,e)?2:0})),d()(this,"needDownloadElementsCount",(function(){return t.elements.highPriorityArray.length+t.elements.lowPriorityArray.length})),d()(this,"getThumb1600",(function(e){if(!t.checkNeedThumb(e))return e;var n=e.split("?");return 1===n.length?t.getThumbWithOutQuery(e):2===n.length?t.getThumbWithQuery(e):e})),d()(this,"executor",(function(e){var t=e.getBoundingClientRect();return t.y+t.height>=0&&t.y<=window.innerHeight?{obj:e,priority:1}:{obj:e,priority:0}})),d()(this,"objLengthZero",(function(e){return e&&0===e.length})),d()(this,"updateImage",(function(){})),d()(this,"checkUnLoadElemPriority",(function(){for(var e=t.elements.highPriorityArray.length-1;e>=0;e--){var n,i,r=t.elements.highPriorityArray[e],a=t.checkIsInScreen(r),o=a.inScreen,l=a.obj;if(!o&&l&&t.property)t.elements.lowPriorityArray.push(r),t.elements.lowPriorityDict[null!==(n=l.getAttribute(t.property))&&void 0!==n?n:0]=r,t.elements.highPriorityArray.splice(e,1),delete t.elements.highPriorityDict[null!==(i=l.getAttribute(t.property))&&void 0!==i?i:0]}for(var s=t.elements.lowPriorityArray.length-1;s>=0;s--){var c,d,u=t.elements.lowPriorityArray[s],f=t.checkIsInScreen(u),h=f.inScreen,p=f.obj;if(h&&p&&t.property)t.elements.highPriorityArray.push(u),t.elements.highPriorityDict[null!==(c=p.getAttribute(t.property))&&void 0!==c?c:0]=u,t.elements.lowPriorityArray.splice(s,1),delete t.elements.lowPriorityDict[null!==(d=p.getAttribute(t.property))&&void 0!==d?d:0]}})),d()(this,"checkIsInScreen",(function(e){for(var t=!1,n=null,i=0;i<e.length;i++){var r=(n=e[i]).getBoundingClientRect();r.y+r.height>=0&&r.y<=window.innerHeight&&(t=!0)}return{inScreen:t,obj:n}})),d()(this,"handlescroll",(function(){null!==t.timer&&clearTimeout(t.timer),t.timer=setTimeout((function(){t.checkUnLoadElemPriority(),t.handle()}),200)})),d()(this,"checkNeedThumb",(function(e){if(!t.isValidQQAdaptDomain(e)&&!t.isValidDocimg8Domain(e))return!1;if("svg"===t.getUrlParam(e,"_type"))return!1;if("player"===t.getUrlParam(e,"scene"))return!1;var n=e.split("?");return!(!n||n.length>2)})),d()(this,"getThumbWithOutQuery",(function(e){var n=e.split("?");if(n[0].length>4){var i=r()(n,1)[0];if("1600"===i.substring(i.length-4))return e}return t.isValidQQAdaptDomain(e)?"".concat(e.substring(0,e.length-1),"1600"):"".concat(n[0],"/1600")})),d()(this,"getThumbWithQuery",(function(e){var n=window.devicePixelRatio||1,i=window.screen,a=i.width*n,o=i.height*n,l=e.split("?"),s=g.a.getImageSizeFromUrl(e),c=s.width,d=s.height;if(isNaN(c)||isNaN(d))return e;if(c*d<=a*o)return e;if(l[0].length>4){var u=r()(l,1)[0];if("1600"===u.substring(u.length-4))return e}return t.isValidQQAdaptDomain(e)?"".concat(e.substring(0,l[0].length-1),"1600?").concat(l[1]):"".concat(l[0],"/1600?").concat(l[1])})),d()(this,"onLoad",(function(e,n,i,r){for(var a=0;a<e[I].length;a++){var o=e[I][a],l=t.getSrcUrl(e,r);t.changeHref(o,l),o.callback&&o.callback(n,i)}!r&&p()(e,E)?t.loadedUrls[e[E]]=!0:t.loadedUrls[e[k]]=!0;for(var s=-1,c=0;c<t.loadingElements.length;c++)if(e===t.loadingElements[c]){s=c;break}-1!==s&&t.loadingElements.splice(s,1),t.handle()})),d()(this,"handleLoadError",(function(e){for(var n=0;n<e[I].length;n++){var i=e[I][n];i.onLoadError&&i.onLoadError()}for(var r=-1,a=0;a<t.loadingElements.length;a++)if(e===t.loadingElements[a]){r=a;break}-1!==r&&t.loadingElements.splice(r,1);var o=e[E];window.log.info("".concat(v.a.t(" [下载图片]  - ser返回fail [下载失败] - ")).concat(o)),window.dispatchEvent(new Event("check-slide-render-state"))})),d()(this,"onError",(function(e,n,i){var r=e;e[S]<t.maxRetryTimes?(r[S]=e[S]+1,t.lazyLoad(e)):n||e[S]!==t.maxRetryTimes?!i&&e[S]>=t.maxRetryTimes?(r[S]=e[S]+1,t.lazyLoad(e,!0,!0)):t.handleLoadError(e):(r[S]=e[S]+1,t.lazyLoad(e,!0))})),d()(this,"handle",(function(){for(var e=[],n=0;n<t.elements.highPriorityArray.length&&t.loadingElements.length<t.maxLoadNumber;n++)if(t.elements.highPriorityArray[n][0]){var i=t.handleLoadImage(t.elements.highPriorityArray[n]);delete t.elements.highPriorityDict[i],e.push(n)}else e.push(n);for(var r=e.length-1;r>=0;r--)t.elements.highPriorityArray.splice(e[r],1);e=[];for(var a=0;a<t.elements.lowPriorityArray.length&&t.loadingElements.length<t.maxLoadNumber;a++)if(t.elements.lowPriorityArray[a][0]){var o=t.handleLoadImage(t.elements.lowPriorityArray[a]);delete t.elements.lowPriorityDict[o],e.push(a)}else e.push(a);for(var l=e.length-1;l>=0;l--)t.elements.lowPriorityArray.splice(e[l],1)})),d()(this,"handleLoadImage",(function(e){var n=e[0].getAttribute(t.property),i={srcKey:n,objsKey:e,priorityKey:e[0].priority,retryTimesKey:0},r=t.getThumb1600(i.srcKey);return i[E]=r||n,t.loadingElements.push(i),e[0].getAttribute(t.originalProperty)?t.lazyLoad(i,!0):t.lazyLoad(i),n})),d()(this,"lazyLoad",(function(e,n,i){var r=new Image,a=t.getRequestUrl(e,n,i);return r.onload=function(){t.onLoad(e,r.width,r.height,n)},r.onerror=function(){t.onError(e,n,i)},r.crossOrigin="Anonymous",r.src=a,r})),d()(this,"changeHref",(function(e,t){e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t)})),d()(this,"loadPlayIconInfo",(function(){window.isInWorker||[y.a,y.b,y.c,y.d,y.e,y.f,y.g,y.h,y.i].forEach((function(e){(new Image).src=e}))})),this.elements={highPriorityDict:{},highPriorityArray:[],lowPriorityDict:{},lowPriorityArray:[]},this.actElements=[],this.loadedUrls={},this.property="data-src",this.originalProperty="data-original",this.loadingElements=[],this.maxLoadNumber=5,this.maxRetryTimes=3,this.convertUrlSet=new Set,this.preLoadResourceTimer=setTimeout((function(){t.loadPlayIconInfo()}),3e4)}return s()(e,[{key:"removeImage",value:function(e){var t=e.getAttribute(this.property);1===e.priority?this.handleHighPriorityRemoveImage(e,t):0===e.priority&&this.handleLowPriorityRemoveImage(e,t);for(var n=-1,i=0;i<this.actElements.length;i++)if(e===this.actElements[i]){this.changeHref(e,""),n=i;break}-1!==n&&this.actElements.splice(n,1)}},{key:"loadBlobImage",value:function(e,t){var n=new Image;n.onload=function(){var t;null===(t=e.callback)||void 0===t||t.call(e,n.width,n.height)},n.onerror=function(){var t;null===(t=e.onLoadError)||void 0===t||t.call(e)},n.src=t}},{key:"handleHighPriorityRemoveImage",value:function(e,t){for(var n=this.elements.highPriorityDict[t],i=-1,r=0;n&&r<n.length;r++)if(e===n[r]){i=r;break}if(-1!==i&&n.splice(i,1),this.objLengthZero(n)){delete this.elements.highPriorityDict[t],i=-1;for(var a=0;a<this.elements.highPriorityArray.length;a++)if(this.elements.highPriorityArray[a].length>0&&f()(e,"dataset.src")===this.elements.highPriorityArray[a][0].getAttribute(this.property)){i=a;break}-1!==i&&this.elements.highPriorityArray.splice(i,1)}}},{key:"handleLowPriorityRemoveImage",value:function(e,t){for(var n=this.elements.lowPriorityDict[t],i=-1,r=0;n&&r<n.length;r++)if(e===n[r]){i=r;break}if(-1!==i&&this.elements.lowPriorityDict[t].splice(i,1),this.objLengthZero(n)){delete this.elements.lowPriorityDict[t],i=-1;for(var a=0;a<this.elements.lowPriorityArray.length;a++)if(this.elements.lowPriorityArray[a].length>0&&e.dataset.src===this.elements.lowPriorityArray[a][0].getAttribute(this.property)){i=a;break}-1!==i&&this.elements.lowPriorityArray.splice(i,1)}}},{key:"isValidQQAdaptDomain",value:function(e){return!(!e||e.length<1)&&e.indexOf(m.a.CDN.QPIC)>0}},{key:"isValidDocimg8Domain",value:function(e){return!(!e||e.length<1)&&e.indexOf(window.hostname)>0}},{key:"getUrl",value:function(e,t){var n=e[k];return!t&&p()(e,E)&&(n=e[E]),n}},{key:"getRequestUrl",value:function(e,t,n){var i=this.getUrl(e,t);return n&&(this.convertUrlSet.add(i),i="".concat(i).concat(b.a)),i}},{key:"getSrcUrl",value:function(e,t){var n=this.getUrl(e,t);return this.convertUrlSet.has(n)&&(n="".concat(n).concat(b.a)),n}}]),e}()},b9a4a16e8e:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.RESIZING="resizing",e.RESIZE_START="resizeStart",e.RESIZE_STOP="resizeStop"}(i||(i={}))},cca06c0cf5:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".separator-third-party-menu-separator-block-IpNbE{width:6px}.separator-third-party-menu-separator-bigblock-1ajOa,.separator-third-party-menu-separator-block-IpNbE{margin-top:11px;margin-bottom:11px;height:14px;-webkit-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent}.separator-third-party-menu-separator-bigblock-1ajOa{width:14px}.separator-third-party-menu-separator-line--ZVnb{margin:11px 8px;width:1px;height:14px;-webkit-user-select:none;-ms-user-select:none;user-select:none;background-color:#000;opacity:.08}",""]),t.locals={"third-party-menu-separator-block":"separator-third-party-menu-separator-block-IpNbE","third-party-menu-separator-bigblock":"separator-third-party-menu-separator-bigblock-1ajOa","third-party-menu-separator-line":"separator-third-party-menu-separator-line--ZVnb"}},cd540f53a5:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=(n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("77c89fc0e0")),s=n("82f2dc9440"),c=n.n(s),d=function(){function e(){r()(this,e),l.e.IS_LOCAL_EDIT&&(this.handleImportFileObject=this.handleImportFileForLocalEdit)}return o()(e,[{key:"handleImportFileForLocalEdit",value:function(e){var t=this,i={path:Object(l.j)("localFilePath")};Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~service")]).then(n.bind(null,"e3ef1bd298")).then((function(n){n.driveApi.getLocalFile(i).then((function(){t.showImportDialog(e)})).catch((function(e){console.log("driveapi error: ",e),c.a.show({type:"error",duration:5e3,message:l.l.t("本地文件不存在"),autoClose:!0})}))}))}}]),e}()},d6a9dd7ae4:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var i,r=n("176815363d"),a=n.n(r),o=n("9132715560"),l=n.n(o),s=n("6a364eb35c"),c=n.n(s),d=n("85d0a7609b"),u=n.n(d),f=n("3ef2352f0b"),h=n.n(f),p=(n("c6244f7705"),n("081c8cafea"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("7264fb5e8f")),v=n("d3d31c86eb"),g="clone",m="toPdf",y="collect",b="download",S=n("020899bf26");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.Notification=1]="Notification",e[e.PushMessage=2]="PushMessage"}(i||(i={}));var I=function(){function e(t){var n=this;l()(this,e),u()(this,"featureMessageCenter",void 0),u()(this,"handleCollect",void 0),u()(this,"handleToPdf",(function(){})),u()(this,"handleDownload",(function(){})),u()(this,"handleBtnActionType",function(){var e=a()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===g?3:e.t0===m?5:e.t0===b?7:e.t0===y?9:11;break;case 3:return n.services.produceBackupManager.promise().then((function(e){e.generateProduceBackup()})),e.abrupt("break",11);case 5:return n.handleToPdf(),e.abrupt("break",11);case 7:return n.handleDownload(),e.abrupt("break",11);case 9:return n.handleCollect(),e.abrupt("break",11);case 11:return e.abrupt("return");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u()(this,"postReadyMessage",(function(){if(window.clientVars){var e=window.clientVars,t=e.userId,n=e.padId;p.FeatureMessageCenter.getInstance().sendMessage({type:"RETENTION_MESSAGE",uid:t,padid:n,docs_type:"slide",isMiniProgram:!0})}})),u()(this,"onMessage",(function(e){var t,r=JSON.parse(null===(t=JSON.parse(e.data))||void 0===t?void 0:t.message);if(r.msgType===i.PushMessage){var a=r.content,o=r.btnAction,l=r.btnText,s=r.duration,c=r.reportOnAppear,d=r.btnActionType,u=r.reportOnClick;a&&(n.showSnackbar(a,d,o,l,s,u),c&&Object(v.c)(E(E({},c),{},{ver5:a,ver6:d})))}})),this.services=t,this.featureMessageCenter=p.FeatureMessageCenter.getInstance(),this.featureMessageCenter.onFeatureMessageEvent(this.onMessage),Object(S.b)((function(){n.postReadyMessage()}))}return c()(e,[{key:"setServicesDelegate",value:function(e){this.services=e}},{key:"dispose",value:function(){var e;null===(e=this.featureMessageCenter)||void 0===e||e.dispose(),this.featureMessageCenter=void 0}}]),e}()},da0fb09388:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i,r,a,o,l,s,c,d=n("1f925d7f50"),u=n.n(d),f=n("9132715560"),h=n.n(f),p=n("6a364eb35c"),v=n.n(p),g=(n("85d0a7609b"),n("2dc700e1e6")),m=n.n(g),y=(n("f1054791f4"),n("af802ec74b"),n("d5c3deb8c7")),b=(i=function(){function e(){h()(this,e),u()(this,"canvasWidth",r,this),u()(this,"canvasHeight",a,this),u()(this,"slideLeft",o,this),u()(this,"slideTop",l,this),u()(this,"scale",s,this),u()(this,"isAutoAdapter",c,this)}return v()(e,[{key:"getCanvasSize",value:function(){return{canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight,slideLeft:this.slideLeft,slideTop:this.slideTop,scale:this.scale}}},{key:"getCanvasScale",value:function(){return this.scale}},{key:"getCanvasIsAutoAdapter",value:function(){return this.isAutoAdapter}},{key:"setCanvasSize",value:function(e){var t=this,n={canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight,slideLeft:this.slideLeft,slideTop:this.slideTop,scale:this.scale};Object.assign(n,e),Object(y.w)((function(){t.canvasWidth=n.canvasWidth,t.canvasHeight=n.canvasHeight,t.slideLeft=n.slideLeft,t.slideTop=n.slideTop,t.scale=n.scale}))}},{key:"setCanvasScale",value:function(e){this.scale=e}},{key:"setIsAutoAdapter",value:function(e){this.isAutoAdapter=e}},{key:"setCanvasScaleAndIsAutoAdapter",value:function(e,t){var n=this;Object(y.w)((function(){n.scale=e,n.isAutoAdapter=t}))}}]),e}(),r=m()(i.prototype,"canvasWidth",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),a=m()(i.prototype,"canvasHeight",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=m()(i.prototype,"slideLeft",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l=m()(i.prototype,"slideTop",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=m()(i.prototype,"scale",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),c=m()(i.prototype,"isAutoAdapter",[y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),i)},e53e7df5af:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.host="HOST",e.audience="AUDIENCE"}(i||(i={}))},e6043b1d9c:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i=n("14502724a6"),r=n.n(i),a=n("176815363d"),o=n.n(a),l=n("9132715560"),s=n.n(l),c=n("6a364eb35c"),d=n.n(c),u=n("85d0a7609b"),f=n.n(u),h=n("3ef2352f0b"),p=n.n(h),v=(n("75563bc376"),n("c6244f7705"),n("081c8cafea"),n("968ee3f7e6"),n("6e20b6a7d8"),n("e0e8dd9366")),g=n("5cdbac46e8"),m=n("a2cf71de79"),y=n("d5c3deb8c7"),b=n("e68a50bae6"),S=n("aba9dcef64"),k=n("020899bf26"),E=n("a08260f523"),I=n("8f58e78419"),M=n.n(I),P=n("2f1cded8d8"),w=n("1af4b2dbf4"),x=function(){function e(){var t=this;s()(this,e),f()(this,"selectionService",void 0),f()(this,"userPriviledgeService",void 0),f()(this,"rightSideBarManager",void 0),f()(this,"menuManager",void 0),f()(this,"editingStateManager",void 0),f()(this,"textEditorStateService",void 0),f()(this,"editorInstanceService",void 0),f()(this,"historyManager",void 0),f()(this,"setSelectionServiceDelegate",(function(e){t.selectionService||(t.selectionService=e)})),f()(this,"setUserPriviledgeServiceDelegate",(function(e){t.userPriviledgeService||(window.userPriviledgeService=e,t.userPriviledgeService=e)})),f()(this,"setRightSideBarManagerDelegate",(function(e){t.rightSideBarManager||(t.rightSideBarManager=e)})),f()(this,"setMenuManagerDelegate",(function(e){t.menuManager||(t.menuManager=e)})),f()(this,"setEditingStateManagerDelegate",(function(e){t.editingStateManager||(t.editingStateManager=e)})),f()(this,"setTextEditorStateService",(function(e){t.textEditorStateService||(t.textEditorStateService=e)})),f()(this,"setEditorInstanceService",(function(e){t.editorInstanceService||(t.editorInstanceService=e)})),f()(this,"initEvents",(function(){t.registerLockEvent(),t.registerUnlockEvent(),t.registerQueueEvent(),t.registerEditorContentChangeFlagReaction()})),f()(this,"checkLock",(function(){var e,n,i,r,a,o,l,s=null===(e=t.selectionService)||void 0===e?void 0:e.currentSlideIndex,c=null===(n=t.lockManager)||void 0===n?void 0:n.myLockInfo;c&&c.slide.index!==s&&(null===(l=t.lockManager)||void 0===l||l.unlockById(c.slide.id));var d=void 0!==s&&(null===(i=t.lockManager)||void 0===i?void 0:i.getLockInfoByIndex(s,(null===(r=t.selectionService)||void 0===r?void 0:r.currentSlideType)||v.d.SLIDE)),u=null===(a=t.selectionService)||void 0===a||null===(o=a.currentSlide)||void 0===o?void 0:o.preload;d&&!d.user.isSelf||t.userPriviledgeService.isOverCoorperateNum||u?t.lockAction():t.makeEditable()})),f()(this,"registerLockEvent",(function(){var e=function(e){var n,i;if(null===(n=t.historyManager)||void 0===n||!n.isShowingHistory){var r=null===(i=t.selectionService)||void 0===i?void 0:i.currentSlide;if(r){var a,o,l,s,c,d,u=e.find((function(e){return e.slide.id===r.id}));if(u&&!u.user.isSelf)t.userPriviledgeService.setPPTEditorState({state:g.b.COPYABLE,scope:m.a.CURRENT}),null===(a=t.rightSideBarManager)||void 0===a||a.setIsPropertyEditorShown(!1),null===(o=t.rightSideBarManager)||void 0===o||o.setIsAnimationEditorShown(!1),null===(l=t.rightSideBarManager)||void 0===l||l.setIsSelectWindowShown(!1),null===(s=t.rightSideBarManager)||void 0===s||s.setIsSlideRatingShown(!1),t.hideAllMenu(),null===(c=t.editorInstanceService)||void 0===c||null===(d=c.getEditorInstance())||void 0===d||d.triggerBlur(),b.a.isShown()&&b.a.hide()}}};k.a.EventManager.promise().then((function(n){n.on(P.a.Lock,e),n.on(P.a.SetDocCopyable,t.setCopyable),n.on(P.a.SetDocEditable,t.setEditable)}))})),f()(this,"registerUnlockEvent",(function(){var e=function(e){var n,i;if(null===(n=t.historyManager)||void 0===n||!n.isShowingHistory){var r=null===(i=t.selectionService)||void 0===i?void 0:i.currentSlide;if(r)e.find((function(e){return e.slide.id===r.id}))&&t.makeEditable()}};k.a.EventManager.promise().then((function(t){t.on(P.a.Unlock,e)}))})),f()(this,"registerQueueEvent",(function(){return o()(p.a.mark((function e(){var n,i,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.SDKDataServices.PresentationStoreService.promise();case 2:return n=e.sent,e.next=5,k.a.SDKDataServices.EventManager.promise();case 5:return i=e.sent,e.next=8,S.a.CooperationLockManager.promise();case 8:a=e.sent,i.revisionEvents.onEnqueue((function(e){var i,o=-1;(e.commands.map((function(e){var t=e.mutations;return null!=t?t:[]})).flat().find((function(e){var t=w.a.fromMutationData([e]).getValidMutationData(),i=r()(t,1)[0];if(Object(E.a)(i)){var a=M()(i,"pageId");o=n.getPresentation().getPageIndexById(a)}return-1!==o})),-1!==o&&o===(null===(i=t.selectionService)||void 0===i?void 0:i.currentSlideIndex))&&(a.getLockInfoByIndex(o,t.selectionService.currentSlideType)||a.lockByIndex(o,t.selectionService.currentSlideType),a.unlockMyLockInFuture())}));case 10:case"end":return e.stop()}}),e)})))()})),f()(this,"registerEditorContentChangeFlagReaction",(function(){Object(y.r)((function(){var e;return null===(e=t.textEditorStateService)||void 0===e?void 0:e.editorContentChangeFlag}),(function(){var e,n,i,r,a,o,l=null===(e=t.selectionService)||void 0===e?void 0:e.currentSlideIndex;void 0!==l&&((null===(i=t.lockManager)||void 0===i?void 0:i.getLockInfoByIndex(l,(null===(r=t.selectionService)||void 0===r?void 0:r.currentSlideType)||v.d.SLIDE))||null===(a=t.lockManager)||void 0===a||a.lockByIndex(l,(null===(o=t.selectionService)||void 0===o?void 0:o.currentSlideType)||v.d.SLIDE));null===(n=t.lockManager)||void 0===n||n.unlockMyLockInFuture()}))})),f()(this,"hideAllMenu",(function(){t.menuManager&&t.menuManager.hideAllMenu()})),f()(this,"updateElementCropState",(function(e){Object(y.w)((function(){t.editingStateManager&&(t.editingStateManager.isCroping=e)}))})),f()(this,"setCopyable",(function(){t.userPriviledgeService.setPPTEditorState({state:g.b.COPYABLE,scope:m.a.CURRENT})})),f()(this,"setEditable",(function(){t.userPriviledgeService.setPPTEditorState({state:g.b.EDITABLE,scope:m.a.CURRENT})}))}return d()(e,[{key:"setHistoryManagerDelegate",value:function(e){this.historyManager||(this.historyManager=e)}},{key:"lockManager",get:function(){return S.a.CooperationLockManager()}},{key:"lockAction",value:function(){var e,t,n,i,r,a,o,l,s,c=null===(e=this.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t?void 0:t.preload;this.userPriviledgeService.setPPTEditorState({state:c?g.b.SELECTABLE:g.b.COPYABLE,scope:m.a.CURRENT}),null!==(n=this.selectionService)&&void 0!==n&&n.currentSlide&&this.preloadRecover(),null===(i=this.rightSideBarManager)||void 0===i||i.setIsPropertyEditorShown(!1),null===(r=this.rightSideBarManager)||void 0===r||r.setIsAnimationEditorShown(!1),null===(a=this.rightSideBarManager)||void 0===a||a.setIsSelectWindowShown(!1),null===(o=this.rightSideBarManager)||void 0===o||o.setIsSlideRatingShown(!1),this.hideAllMenu(),this.updateElementCropState(!1),null===(l=this.editorInstanceService)||void 0===l||null===(s=l.getEditorInstance())||void 0===s||s.triggerBlur()}},{key:"preloadRecover",value:function(){var e,t,n,i,r=this;if(null!==(e=this.selectionService)&&void 0!==e&&null!==(t=e.currentSlide)&&void 0!==t&&t.preload)var a=null===(n=this.selectionService)||void 0===n||null===(i=n.currentSlide)||void 0===i?void 0:i.id,o=Object(y.r)((function(){var e,t;return null===(e=r.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t?void 0:t.preload}),(function(){var e,t;o();var n=null===(e=r.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t?void 0:t.id;n&&n===a&&r.makeEditable()}))}},{key:"makeEditable",value:function(){var e=this;k.a.PrivilegeManager.promise().then((function(t){t.editable&&e.setEditable()}))}}]),e}()},ebd85bf338:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i="&imageMogr2/format/png"},ec44d5c298:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),s=n.n(l),c=n("e6d98148ee"),d=function(){function e(){r()(this,e),s()(this,"event",void 0),this.event=new c.a}return o()(e,[{key:"emitEvent",value:function(e){this.event.emit(e)}},{key:"onEvent",value:function(e,t){this.event.on(e,t)}}]),e}()},f1ae602d16:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,'.index-link-menu-wrapper-3IMPK{width:400px;box-shadow:0 2px 12px 2px rgba(68,73,77,.16);background:#fff;border:1px solid rgba(0,0,0,.12);border-radius:4px;font-size:14px;position:relative}.index-link-menu-wrapper-3IMPK,.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4{display:flex;flex-direction:column}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3{padding-left:24px;margin:24px 2px 42px 0;overflow-y:auto}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3::-webkit-scrollbar-thumb{background-color:rgba(0,0,0,.16)}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3::-webkit-scrollbar-thumb:hover{background-color:rgba(0,0,0,.24)}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-item-wrapper-3fEn1{position:relative;margin-bottom:24px}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-item-wrapper-3fEn1 .index-link-menu-warning-1i0vj{position:absolute;bottom:-24px;left:72px;font-size:12px;line-height:24px;color:#ff7272}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-item-xrsnl{display:flex;justify-content:left;align-items:center;margin-bottom:24px}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-item-xrsnl:last-child{margin-bottom:0}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-item-xrsnl:first-child{margin-bottom:24px}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-item-label-3hnMV{width:56px;height:20px;font-family:PingFangSC;flex-shrink:0;text-align:left;margin-right:12px}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-ppt-items-3xrm5{width:284px;margin:-12px 0 26px 72px;position:relative}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-items-34RO3 .index-link-menu-ppt-items-3xrm5 .index-link-menu-ppt-select-16rnw{position:absolute;bottom:-2px;left:76px}.index-link-menu-wrapper-3IMPK .index-link-menu-content-1Chb4 .index-link-menu-btns-fGpWn{width:100%;padding:0 24px 18px;display:flex;justify-content:flex-end}.index-link-menu-wrapper-3IMPK .index-link-menu-triangle-242VA{width:0;height:0;content:"";z-index:1;position:absolute;left:0}.index-link-menu-wrapper-3IMPK .index-link-menu-triangle-242VA.index-top-1xca5{top:0}.index-link-menu-wrapper-3IMPK .index-link-menu-triangle-242VA.index-bottom-38STi{bottom:0}.index-link-menu-wrapper-3IMPK .index-link-menu-triangle-242VA:before{width:8px;height:8px;content:"";display:block;background-color:#fff;border:1px solid #fff;position:absolute;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.index-link-menu-wrapper-3IMPK .index-link-menu-triangle-242VA.index-top-1xca5:before{top:-5.5px;margin-left:-5px;border-top-color:rgba(0,0,0,.12);border-left-color:rgba(0,0,0,.12);border-radius:3px 0 0}.index-link-menu-wrapper-3IMPK .index-link-menu-triangle-242VA.index-bottom-38STi:before{box-shadow:2px 2px 4px 0 rgba(68,73,77,.16);bottom:-5px;margin-left:-5px;border-bottom-color:rgba(0,0,0,.12);border-right-color:rgba(0,0,0,.12);border-radius:0 0 3px}',""]),t.locals={"link-menu-wrapper":"index-link-menu-wrapper-3IMPK","link-menu-content":"index-link-menu-content-1Chb4","link-menu-items":"index-link-menu-items-34RO3","link-menu-item-wrapper":"index-link-menu-item-wrapper-3fEn1","link-menu-warning":"index-link-menu-warning-1i0vj","link-menu-item":"index-link-menu-item-xrsnl","link-menu-item-label":"index-link-menu-item-label-3hnMV","link-menu-ppt-items":"index-link-menu-ppt-items-3xrm5","link-menu-ppt-select":"index-link-menu-ppt-select-16rnw","link-menu-btns":"index-link-menu-btns-fGpWn","link-menu-triangle":"index-link-menu-triangle-242VA",top:"index-top-1xca5",bottom:"index-bottom-38STi"}},f2bfa864ad:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("176815363d"),r=n.n(i),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),s=n.n(l),c=n("85d0a7609b"),d=n.n(c),u=n("3ef2352f0b"),f=n.n(u),h=(n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("b1e2246d82"),n("b40469cb12")),p=n("0b52488f7f"),v=n("82f2dc9440"),g=n.n(v),m=n("5fac0349d3"),y=n("3c974148b4"),b=n("3825cc7c15"),S=function(){function e(t){var i=this;o()(this,e),d()(this,"uiDataService",void 0),d()(this,"selectionService",void 0),d()(this,"handleImportFile",(function(e){i.checkImportContainer();var t=null==e?void 0:e[0];t&&i.handleImportFileObject(t)})),d()(this,"handleImportFileOnDesktopApp",(function(e){var t={path:Object(b.b)("localFilePath")};Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~service")]).then(n.bind(null,"e3ef1bd298")).then((function(n){n.driveApi.getLocalFile(t).then((function(){i.showImportDialog(e)})).catch((function(e){console.log("driveapi error: ",e),g.a.show({type:"error",duration:5e3,message:m.a.t("本地文件不存在"),autoClose:!0})}))}))})),d()(this,"showImportDialog",function(){var t=r()(f.a.mark((function t(n){var i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=document.getElementById("import-file-container"))&&(i.style.display="block"),window.log.info("".concat(e.logTag," ArkLoader getExtension import-file")),t.next=5,h.a.extensionService.getExtension(p.a.name);case 5:t.sent.show({file:n,container:i,supportNewUI:!1});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),d()(this,"checkImportContainer",(function(){if(!document.querySelector("#import-file-container")){var e=document.createElement("div");e.id="import-file-container",document.body.appendChild(e)}})),this.injectable=t,this.injectable.handleImportFileObject&&(this.handleImportFileObject=this.injectable.handleImportFileObject.bind(this))}return s()(e,[{key:"setUiDataServiceDelegate",value:function(e){this.uiDataService=e}},{key:"setSelectionServiceDelegate",value:function(e){this.selectionService=e}},{key:"handleImportFileObject",value:function(t){var n=this,i=new FileReader;i.onloadend=function(){i.error?window.log.info("".concat(e.logTag," Error opening presentation")):(y.a===t.type||n.showImportDialog(t),window.log.info("file = ".concat(JSON.stringify(t))))},i.readAsText(t)}}]),e}();d()(S,"logTag","ImportNewFile")}}]);
//# sourceMappingURL=slide-base~e19e9216-b4d407.js.map
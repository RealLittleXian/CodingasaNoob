(this.webpackJsonp=this.webpackJsonp||[]).push([["base~f19eb79b"],{"02598f7304":function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n("176815363d"),r=n.n(a),i=n("9132715560"),o=n.n(i),c=n("6a364eb35c"),u=n.n(c),l=n("85d0a7609b"),s=n.n(l),d=n("3ef2352f0b"),f=n.n(d),v=(n("c6244f7705"),n("081c8cafea"),n("1bab7b5fb7"),n("9d7978d445"),n("3bf1976a4f"),n("a2a09da1e3"),n("0aeae65bf4"),n("d0054b9d0b")),p=n("b86964b011"),h=n("37091e4240"),b=n("aba9dcef64"),g=n("d3d31c86eb"),E=function(){function e(t){var n=this;o()(this,e),s()(this,"injectable",void 0),s()(this,"checkUserInfo",r()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.OnlineApiService.promise();case 2:e.sent.getUserInfo().then(n.onCheckUserInfo).catch((function(e){var t;null===(t=window.log)||void 0===t||t.error("checkUserInfo fail:".concat(JSON.stringify(e)))}));case 4:case"end":return e.stop()}}),e)})))),s()(this,"onCheckUserInfo",(function(e){var t;null!=e&&e.data?0!==e.data.retcode&&n.isDocAppOrLogin():null===(t=window.log)||void 0===t||t.error("checkUserInfo fail:".concat(JSON.stringify(e)))})),s()(this,"registerPskeyErrorListener",(function(){v.a.listen("TX-LOGIN-PSKEY-EXPIRED",n.onListenPSKeyExpired)})),s()(this,"onListenPSKeyExpired",(function(e){var t="unknown url",a=0;if(e.detail){if(e.detail.hasOwnProperty("url")){var r=e.detail.url;if("string"==typeof r)t=r.split("?")[0]}e.detail.hasOwnProperty("code")&&(a=e.detail.code),window.log.error("ptt listen onPskeyError(".concat(t,") = ").concat(a))}else window.log.error("ptt listen onPskeyError opt.detail = null");n.onPskeyError(t,a)})),s()(this,"onPskeyError",(function(e,t){Object(g.c)({opername:"doc_account_web",module:"account_info",action:"log_expired",ver6:t}),e.indexOf("user_info")<0?n.checkUserInfo():n.isDocAppOrLogin()})),s()(this,"handlePskeyError",(function(){Object(p.k)()||window.log.info("handlePskeyError not logged in"),n.injectable.handlePskeyError()})),this.injectable=t,this.registerPskeyErrorListener(),setInterval(this.checkUserInfo,6e5),h.b.on(h.a.PSKEY_ERROR,(function(){n.handlePskeyError()}))}return u()(e,[{key:"isDocAppOrLogin",value:function(){!window.navigator.userAgent.match(/(TencentDocs)/i)?Object(p.k)()&&this.showPskeyErrorTips():setTimeout((function(){var e;null===(e=window.mqq)||void 0===e||e.invoke("docx","logoutAccount")}),100)}},{key:"showPskeyErrorTips",value:function(){h.b.emit(h.a.PSKEY_ERROR)}}]),e}()},"086c96a9ce":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return O}));n("b8217400dc"),n("e6f68cdf2e"),n("8a35b54c1d");var a=n("e0e8dd9366"),r=n("55d5f8a022"),i=n("85d0a7609b"),o=n.n(i),c=n("382929c8da");var u=n("8f58e78419"),l=n.n(u);var s=n("f9193d718f");function d(e){var t=s.a.getInstance().getAppServices().viewableServiceLayer.selectionService.currentSlide;return t?function(e){var t;return o()({},c.a.FILLCOLOR,null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillInfo())}(t):{}}var f=n("7d1df7d0fb"),v=n("ee6bb53310"),p=n.n(v);function h(e){var t,n,a=null===(t=null===(n=s.a.getInstance().getAppServices().editableServiceLayer)||void 0===n?void 0:n.menuManager)||void 0===t?void 0:t.mergeMenuValuesCacheMap.get(e);if(a)return a;for(var i=[],o=[],u=0;u<e.selectedCellRanges.length;u++){var l=e.selectedCellRanges[u],d=e.tableItems[l.rowStart][l.colStart],v=r.a(d);i.push(v),o.push(d)}var h=Object(f.c)(i,Object(f.b)(o)),b=e.getBorder().getTableBorderInfo(),g=b.borderStyle,E=b.borderColor;return p()(h,c.a.BORDERSTYLE,g),p()(h,c.a.BORDERCOLOR,E),p()(h,c.a.MERGE_CELL,e.selectOneMergedCell()),h}var b=n("f216b3624d"),g=[a.d.SHAPE,a.d.CONNECTOR,a.d.IMAGE,a.d.EMPTY,a.d.TABLE];function E(e){if(!e)return{};var t=e.type;return[a.d.SHAPE].includes(t)?r.a(e):[a.d.CONNECTOR].includes(t)?function(e){var t;return o()({},c.a.BORDERCOLOR,null===(t=e.getBorder)||void 0===t?void 0:t.call(e).getBorderInfo())}(e):[a.d.IMAGE].includes(t)?function(e){var t,n,a,r;return r={},o()(r,c.a.FILLCOLOR,null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillInfo()),o()(r,c.a.EFFECT,null===(n=e.getEffect)||void 0===n?void 0:n.call(e).getEffectCollection()),o()(r,c.a.BORDERCOLOR,null===(a=e.getBorder)||void 0===a?void 0:a.call(e).getBorderInfo()),o()(r,c.a.SIZE_ADJUST,e.getLock().getLockInfo()),o()(r,c.a.INSERT_PICTURE,{alpha:e.props.style.alpha}),o()(r,c.a.REGULATE,{contrast:l()(e.props.style,"image.contrast"),brightness:l()(e.props.style,"image.brightness"),sharpenSoften:l()(e.props.style,"image.sharpenSoften")}),o()(r,c.a.PICTURE_COLOR,{saturate:l()(e.props.style,"image.saturate"),colorTemperature:l()(e.props.style,"image.colorTemperature")}),o()(r,"imageType",e.props.imageType||""),r}(e):[a.d.EMPTY].includes(t)?d():[a.d.TABLE].includes(t)?h(e):{}}function O(e){return Object(f.a)(e).filter((function(e){return e.type===a.d.IMAGE?e.isImage():Object(b.a)(e)}))}},"0a85af1b73":function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var a,r,i,o=n("176815363d"),c=n.n(o),u=n("1f925d7f50"),l=n.n(u),s=n("9132715560"),d=n.n(s),f=n("6a364eb35c"),v=n.n(f),p=n("85d0a7609b"),h=n.n(p),b=n("2dc700e1e6"),g=n.n(b),E=(n("f1054791f4"),n("3ef2352f0b")),O=n.n(E),m=(n("c6244f7705"),n("081c8cafea"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("826dc923b3"),n("b4638a0243"),n("8ee19818c4"),n("8a35b54c1d"),n("6e20b6a7d8"),n("3bf1976a4f"),n("5fac0349d3")),T=n("82f2dc9440"),y=n("f8fc8e0087"),S=n("3344f1a2e7"),I=n("fccb99d836"),R=n("4f3b15d017"),A=n("f4e4ed5c17"),_=n("020899bf26"),C=n("d5c3deb8c7"),P=n("8da38f8962"),L=n("cc3f19dfd9"),M=n("37091e4240");function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N,k="print_frame";!function(e){e.BASE64="base64",e.ARRAY_BUFFER="arrayBuffer"}(N||(N={}));var x=(a=C.q,r=function(){function e(t){var n=this;d()(this,e),l()(this,"isPrintOnMobile",i,this),h()(this,"copyPasteManager",void 0),h()(this,"services",void 0),h()(this,"loadingBar",void 0),h()(this,"isPrinting",void 0),h()(this,"printIframe",void 0),h()(this,"jsPDFLoader",void 0),h()(this,"serviceLoadPromise",void 0),h()(this,"copyPasteLoadPromise",void 0),h()(this,"resolveServiceLoad",void 0),h()(this,"resolveCopyPasteLoad",void 0),h()(this,"printInBrowser",c()(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.createIFrame(),n.printInIframe(t);case 2:case"end":return e.stop()}}),e)})))),h()(this,"printInIframe",function(){var e=c()(O.a.mark((function e(t){var a,r,i,o,c,u,l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.appendChild(t),e.next=3,n.getSlideImageList();case 3:if(a=e.sent,r=n.getIframeDoc()){for(n.setPageSize(r),i=r.createElement("div"),o=0;o<a.length;o++)(c=r.createElement("div")).classList.add("print-page"),u=a[o],(l=r.createElement("img")).classList.add("print-img"),l.src=u,c.appendChild(l),i.appendChild(c);r.body.appendChild(i)}setTimeout((function(){var e;t.focus(),null===(e=t.contentWindow)||void 0===e||e.print(),n.disposeResources()}),0);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(this,"disposeResources",(function(){n.isPrinting=!1,n.printIframe=null,n.closeLoadingSnackBar()})),this.injectable=t,this.init(),this.loadJsPDF()}var t,a,r,o,u,s,f,p,b,g,E,C;return v()(e,[{key:"setServiceDelegates",value:function(e){this.services=w(w({},this.services),e),this.resolveServiceLoad()}},{key:"setCopyPasteManager",value:function(e){this.copyPasteManager=e,this.resolveCopyPasteLoad()}},{key:"handlePrint",value:(C=c()(O.a.mark((function e(){var t,n,a,r,i,o=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>0&&void 0!==o[0]&&o[0],!this.isPrinting){e.next=3;break}return e.abrupt("return");case 3:if(null===(t=this.injectable)||void 0===t||!t.shouldSendToDeviceToPrint){e.next=6;break}return this.sendToDeviceToPrint(),e.abrupt("return");case 6:if(n||!this.shouldHidePrint()&&!this.shouldDisablePrint()){e.next=8;break}return e.abrupt("return");case 8:if(e.prev=8,this.openLoadingSnackBar(),null===(a=this.injectable)||void 0===a||!a.shouldInvokeExternalPrintOnLegacy){e.next=13;break}return null===(r=this.injectable)||void 0===r||r.invokeExternalPrint(),e.abrupt("return");case 13:this.isPrinting=!0,Promise.race([this.doPrint(),this.cancelPrint()]),e.next=24;break;case 17:if(e.prev=17,e.t0=e.catch(8),this.disposeResources(),null===(i=this.injectable)||void 0===i||!i.shouldInvokeExternalLoading){e.next=22;break}return e.abrupt("return");case 22:T.Snackbar.show({message:m.a.t("打印失败"),type:"error",autoClose:!0}),console.error("print error",e.t0);case 24:case"end":return e.stop()}}),e,this,[[8,17]])}))),function(){return C.apply(this,arguments)})},{key:"shouldHidePrint",value:function(){var e;return!(null===(e=this.injectable)||void 0===e||!e.shouldHidePrint)}},{key:"shouldDisablePrint",value:function(){var e;return!(null===(e=this.injectable)||void 0===e||!e.shouldDisablePrint)}},{key:"init",value:function(){var e=this;this.serviceLoadPromise=new Promise((function(t){e.resolveServiceLoad=t})),this.copyPasteLoadPromise=new Promise((function(t){e.resolveCopyPasteLoad=t})),this.invokePrintWhenLoad()}},{key:"loadJsPDF",value:function(){this.jsPDFLoader=n.e(20).then(n.bind(null,"5688d8526c"))}},{key:"sendToDeviceToPrint",value:function(){Object(L.a)()}},{key:"cancelPrint",value:(E=c()(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.injectable)||void 0===t?void 0:t.waitForCancel();case 2:if(!e.sent){e.next=9;break}return e.next=6,this.getExportPdfManager();case 6:n=e.sent,this.disposeResources(),n.getInstance().cancelExport();case 9:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"doPrint",value:(g=c()(O.a.mark((function e(){var t,n,a,r,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=this.injectable)||void 0===t||!t.shouldInvokeNewPrintOnApp){e.next=3;break}return this.printOnMobileApp(),e.abrupt("return");case 3:return e.next=5,null===(n=this.injectable)||void 0===n?void 0:n.checkShouldInvokeExternalPrint();case 5:if(!e.sent){e.next=17;break}if(null===(a=this.injectable)||void 0===a||!a.pdfNotNeededWhenExternalPrint){e.next=11;break}null===(r=this.injectable)||void 0===r||r.invokeExternalPrint(),e.next=15;break;case 11:return e.next=13,this.getPrintPdf();case 13:o=e.sent,null===(i=this.injectable)||void 0===i||i.invokeExternalPrint(o);case 15:return this.disposeResources(),e.abrupt("return");case 17:this.printInBrowser();case 18:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getPrintPdf",value:(b=c()(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=this.injectable)||void 0===t||!t.shouldOfflinePrint){e.next=4;break}return e.next=3,this.getLocalPdf("arraybuffer");case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,this.getExportPdf();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"openLoadingSnackBar",value:function(){var e;null!==(e=this.injectable)&&void 0!==e&&e.shouldInvokeExternalLoading||(this.loadingBar=T.Snackbar.show({message:m.a.t("准备打印中，请稍等。"),type:"loading",autoClose:!1}))}},{key:"closeLoadingSnackBar",value:function(){this.loadingBar.close()}},{key:"getExportPdf",value:(p=c()(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getExportPdfManager();case 2:return t=e.sent,e.abrupt("return",new Promise((function(e,n){t.getInstance().localExport({shouldShowTips:!1,onFinish:function(t,a){null!=a&&a.url?e(a.url):n((null==t?void 0:t.message)||m.a.t("导出PDF失败"))}})})));case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"getLocalPdf",value:(f=c()(O.a.mark((function e(){var t,n,a,r,i,o,c,u,l,s,d,f=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:"bloburl",e.next=3,this.getSlideImageList();case 3:return n=e.sent,a=this.services.uiDataService.presentation.props,r=a.slideWidth,i=a.slideHeight,o=Number(Object(S.o)(r).toFixed(2)),c=Number(Object(S.o)(i).toFixed(2)),e.next=9,this.jsPDFLoader;case 9:return u=e.sent,l=u.jsPDF,(s=new l({orientation:"landscape",unit:"cm",format:[o,c]})).deletePage(1),n.forEach((function(e,t){s.addPage(),s.addImage(e,"PNG",0,0,o,c),n[t]=null})),d=s.output(t),e.abrupt("return",d);case 16:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"getSlideImageList",value:(s=c()(O.a.mark((function e(t){var n,a,r,i,o,c,u=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.services.uiDataService.presentation.children.filter((function(e){return e.isShowInPlay})),0===(a=n.length)&&(n=this.services.uiDataService.presentation.children),r=this.copyPasteManager,i=[],I.a.isExportingToImage=!0,o=O.a.mark((function e(o){var c,l,s,d;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getSlideDataToCanvas([n[o]],1);case 2:if(l=e.sent,t!==N.ARRAY_BUFFER){e.next=10;break}return e.next=6,new Promise((function(e){return l.toBlob((function(t){e(null==t?void 0:t.arrayBuffer())}))}));case 6:s=e.sent,i.push(s),e.next=11;break;case 10:i.push(l.toDataURL());case 11:l.height=0,l.width=0,null!==(c=u.injectable)&&void 0!==c&&c.shouldInvokeNewPrintOnApp&&(d=(o+1)/a*.8,u.updatePrintLoadingProgress(Math.round(100*d)));case 14:case"end":return e.stop()}}),e)})),c=0;case 8:if(!(c<a)){e.next=13;break}return e.delegateYield(o(c),"t0",10);case 10:c++,e.next=8;break;case 13:return I.a.isExportingToImage=!1,e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"createIFrame",value:function(){var e,t=document.getElementById(k);t&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t));var n=document.createElement("iframe");return n.setAttribute("style","visibility: hidden; position: absolute; border: 0;"),n.setAttribute("id",k),this.printIframe=n,n}},{key:"getIframeDoc",value:function(){var e;return this.printIframe&&(this.printIframe.contentDocument||(null===(e=this.printIframe.contentWindow)||void 0===e?void 0:e.document))}},{key:"insertPrintStyleSheet",value:function(e,t){var n=t.createElement("style");n.type="text/css",n.media="print";try{n.appendChild(t.createTextNode(e))}catch(t){n.cssText=e}var a=t.getElementsByTagName("head")[0];a&&a.appendChild(n)}},{key:"setPageSize",value:function(e){this.insertPrintStyleSheet("\n        @page {\n            size: A4 landscape;\n            margin: 0;\n        }\n        body {\n            margin: 0;\n        }\n        .print-page {\n            height: 100%;\n            width: 100%;\n            page-break-after: always;\n            box-sizing: border-box;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        .print-page:last-child {\n            page-break-after: avoid;\n        }\n        .print-img {\n            max-width: 100%;\n            max-height: 100%;\n        }\n        ",e)}},{key:"getExportPdfManager",value:(u=c()(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55")]).then(n.t.bind(null,"0d1ab71e9c",7));case 2:return e.abrupt("return",e.sent.ExportPDFManager);case 3:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"invokePrintWhenLoad",value:(o=c()(O.a.mark((function e(){var t,n=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("1"!==Object(y.getQuery)("print")){e.next=7;break}if(null===(t=this.injectable)||void 0===t||!t.shouldInvokeNewPrintOnApp){e.next=6;break}return e.next=5,new Promise((function(e){M.b.onIncludingPast(M.a.ALL_THUMBNAIL_SITE_COMPLETE,(function(){e(!0)}))}));case 5:this.isPrintOnMobile=!0;case 6:Promise.all([this.serviceLoadPromise,this.copyPasteLoadPromise]).then((function(){n.handlePrint(!0)}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"printOnMobileApp",value:(r=c()(O.a.mark((function e(){var t,n,a,r,i,o,c,u=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isPrintOnMobile=!0,e.next=3,this.getSlideImageList(N.ARRAY_BUFFER);case 3:return t=e.sent,e.next=6,this.getLocalServer();case 6:return n=e.sent,a=[],r=0,e.next=11,Promise.all(t.map((function(e,i){var o="img_".concat(i,".png");return a.push(o),u.saveData2TempFile(n,o,e).then((function(e){if(e){var n=(r+=1)/t.length*.2+.8;u.updatePrintLoadingProgress(Math.round(100*n))}return e}))})));case 11:(i=e.sent).length&&i.every((function(e){return e}))&&(c="".concat(null===(o=_.a.SlideTitleManager())||void 0===o?void 0:o.title).concat(P.a.isAndroid?".pdf":""),this.printImageFile(c,a));case 13:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getLocalServer",value:function(){return new Promise((function(e,t){try{window.mqq.invoke("docx","getLocalServer",{},(function(t){e(t.data)}))}catch(e){t(e)}}))}},{key:"saveData2TempFile",value:(a=c()(O.a.mark((function e(t,n,a){var r,i,o,c,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(R.default.isAndroid?"http://":"https://").concat(t,"/local-edit/saveData2TempFile?fileName=").concat(n,"&bodyIsBuffer=1"),e.next=3,Object(A.a)({method:"POST",url:r,data:a});case 3:if(i=e.sent,o=i.data,c=o.code,u=o.message,0===c){e.next=7;break}throw new Error("saveData2TempFile failed, message:".concat(u,", code:").concat(c));case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"printImageFile",value:(t=c()(O.a.mark((function e(t,n){var a=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){try{window.mqq.invoke("docx","printImageFile",{pdfFileName:t,printConfig:{orientation:"landscape"},imageFileNameList:n},(function(t){if(0!==t.code)throw new Error("printImageFile failed, message:".concat(t.message||t.msg,", code:").concat(t.code));e(!0),a.disposeResources()}))}catch(e){throw a.disposeResources(),new Error("printImageFile failed",e)}})));case 1:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"updatePrintLoadingProgress",value:function(e){window.mqq.invoke("docx","updatePrintLoadingProgress",{progress:e})}}]),e}(),i=g()(r.prototype,"isPrintOnMobile",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r)},"0d08e46cdf":function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return P}));var a=n("176815363d"),r=n.n(a),i=n("7a5536c9bf"),o=n.n(i),c=n("3ef2352f0b"),u=n.n(c),l=(n("b8217400dc"),n("e6f68cdf2e"),n("3bf1976a4f"),n("8a35b54c1d"),n("22569efd03"),n("63513d8b56"),n("8ee19818c4"),n("c6244f7705"),n("081c8cafea"),n("75563bc376"),n("963f2eaace"),n("6c458f1652"),n("6e20b6a7d8"),n("e0e8dd9366")),s=n("382929c8da"),d=n("5cdbac46e8"),f=n("b86964b011"),v=n("afaa9e9ffa"),p=n("fb75408061"),h=n("bb66f259e0"),b=n("ee6bb53310"),g=n.n(b),E=n("5fac0349d3"),O=n("60b97ecf25"),m=n("05d181ac40"),T=n("f9193d718f"),y=n("8da38f8962"),S=n("4e7af1026b"),I=n("d7a2286b24"),R=n("f216b3624d"),A=n("086c96a9ce");function _(e){var t=e.type,n=function(e){var t,n,a=M();if(a.getHistoricalVersionStatus())return[];var r=a.pptEditorState,i=[l.d.SLIDE,l.d.GAP].includes(e.type);if(i||void 0===r||r===d.b.EDITABLE)return null;var c=null===(t=L())||void 0===t||null===(n=t.selectedElements)||void 0===n?void 0:n.selectedArray;if(!c)return[];if(1===c.length&&c[0].type===l.d.IMAGE)return[].concat(o()(O.q),o()(O.r));return O.q}(e);return null!==n?n:[l.d.GAP].includes(t)?function(e){if(e.isFromMasterLayout)return O.l;if(-1===e.gapIndex)return O.u.filter((function(e){return e.id!==s.a.ADD_SECTION}));return O.u}(e):[l.d.SECTION].includes(t)?O.w:[l.d.GROUP,l.d.MULTIPLY].includes(t)?function(e){var t;return null!==(t=Object(A.b)(e))&&void 0!==t&&t.length?O.h:O.i}(e):[l.d.CHART].includes(t)?e.isActualRenderChart?O.d:O.c:[l.d.CONNECTOR].includes(t)?O.f:[l.d.SMART_ART].includes(t)?O.x:[l.d.SLIDE].includes(t)?function(){var e=L().selectedSlides.selectedArray,t=o()(O.v),n=e.every((function(e){return!e.isShowInPlay})),a=t.findIndex((function(e){return e.id===s.a.HIDE_SLIDE}));if(n&&a>=0){var r={id:s.a.CANCEL_HIDE_SLIDE,title:E.a.t("取消隐藏页面")};t.splice(a,1,r)}return t}():[l.d.MASTER,l.d.LAYOUT].includes(t)?O.m:[l.d.EMPTY].includes(t)?function(e){var t;if(null!==(t=function(){var e;if(y.a.isMobile||!M().isEditable())return;return null===(e=T.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.masterLayoutEditService}())&&void 0!==t&&t.isMasterEditType)return O.o;var n=O.b;if(D().addonHandler){var a=D().addonHandler,r=a.addonSceneItemsMap,i=a.formatAddonSceneList,o=a.addonScenes,c=n.find((function(e){return e.id===s.a.ADDON}));c&&(c.children=i(r.get(o.CURSOR)),C(o.CURSOR))}return function(e){var t=e.findIndex((function(e){return e.id===s.a.ADD_SECTION}));return t>=0&&e.splice(t,1),e}(function(e){var t=-1,n=-1;return e.forEach((function(e,a){e.id===s.a.HIDE_SLIDE?t=a:e.id===s.a.CANCEL_HIDE_SLIDE&&(n=a)})),t>=0&&e.splice(t,1),n>=0&&e.splice(n,1),e}(n))}():[l.d.IMAGE].includes(t)?function(e){var t,n=O.s;if(function(e,t){if(D().addonHandler){var n,a=D().addonHandler,r=a.addonSceneItemsMap,i=a.formatAddonSceneList,o=a.addonScenes,c=t.find((function(e){return e.id===s.a.ADDON}));if(!c)return;c.children=i(r.get(o.IMAGE)),C(o.IMAGE,null===(n=e.props.addon)||void 0===n?void 0:n.docElement.addonId)}}(e,n),e.isMedia())return function(e){var t=O.e.slice(0,O.e.length-1),n=O.p;if(!e){var a=[s.a.TAILOR_PIC,s.a.SET_COVER];n=n.filter((function(e){return!a.includes(e.id)}))}return t.concat(n)}(e.isVideo());if(e.isAttachment())return O.k;if(function(e,t){var n;if(e.forEach((function(e){e.id===s.a.LINK&&(n=e),e.id===s.a.DOWNLOAD_PICTURE&&m.a.IS_PC_LOCAL_EDIT&&(e.title=E.a.t("另存为图片"))})),n){var a;if(n.title=E.a.t("链接"),!t.editorInstance||t.editorInstance&&!t.editorInstance.isEditing)t.props.link&&(n.title=E.a.t("编辑链接"));else null!==(a=t.editorInstance)&&void 0!==a&&a.getTextLinkState()&&(n.title=E.a.t("编辑链接"))}}(n,e),P(e))return n.filter((function(e){return e.id!==s.a.OCR_PICTURE}));var a=null===(t=e.sdkData)||void 0===t?void 0:t.getDescription();if(null!=a&&a.sourceUrl)return n.concat({id:s.a.TO_SOURCE_URL,title:E.a.t("查看图片来源")});return n}(e):[l.d.TABLE].includes(t)?function(e){var t=O.y;t.forEach((function(t){var n=t;n.id===s.a.MERGE_CELL&&function(e,t){var n=e.selectOneMergedCell()?E.a.t("取消合并单元格"):E.a.t("合并单元格");g()(t,"title",n)}(e,n)}));var n=e.getEditingElement();if(n){var a=t.map((function(e){return e}));e.isEditing&&a.splice(a.length-1,0,{id:s.a.PARAGRAPH_MORE,title:E.a.t("段落")});var r=n.getTextLinkState()?E.a.t("编辑链接"):E.a.t("插入链接");return a.splice(a.length-1,0,{id:s.a.LINK,title:r,shortcut:"Cmd+K"}),a}return t}(e):[l.d.SHAPE].includes(t)?function(e){var t,n,a,r,i=(null===(t=e.props)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.displayMode)===p.b.IFRAME;if(i)return function(e){var t,n,a,r=O.e,i=D().addonHandler,o=i.addonSceneItemsMap,c=i.formatAddonSceneList,u=i.addonScenes,l=i.addonInfoMap,s=null===(t=e.props.addon)||void 0===t||null===(n=t.docElement)||void 0===n?void 0:n.addonId,d=l.get(s);if(null!=d&&d.isOfficial||!d)return r.slice(0,r.length-1);return O.a.children=c(o.get(u.IFRAME)),C(u.IFRAME,null===(a=e.props.addon)||void 0===a?void 0:a.docElement.addonId),r.concat(O.a)}(e);if(e.isAttachment())return O.t;var o=e.isPlaceholder&&(e.isFromLayout||e.isFromMaster);if(o)r=O.n;else if(null!==(a=e.editorInstance)&&void 0!==a&&a.isEditing)r=O.z;else if(Object(R.a)(e)){var c;r=O.A;var u=null===(c=e.sdkData)||void 0===c?void 0:c.getDescription();null!=u&&u.sourceUrl&&(r=r.concat({id:s.a.TO_SOURCE_URL,title:E.a.t("查看图片来源")}))}else r=O.B;return function(e,t){var n;if(t.forEach((function(e){e.id===s.a.LINK&&(n=e)})),n){var a;if(n.title=E.a.t("插入链接"),!e.editorInstance||e.editorInstance&&!e.editorInstance.isEditing)e.props.link&&(n.title=E.a.t("编辑链接"));else null!==(a=e.editorInstance)&&void 0!==a&&a.getTextLinkState()&&(n.title=E.a.t("编辑链接"))}}(e,r),r}(e):[l.d.GUIDES].includes(t)?O.j:[l.d.THEME].includes(t)?O.C:[]}function C(e,t){T.a.getInstance().getAppServices().viewableServiceLayer.rightMenuManager.promise().then(function(){var n=r()(u.a.mark((function n(a){var r,i,o,c,l,d,f,v,p,h,b,g;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=a&&a.lastConfig){n.next=2;break}return n.abrupt("return");case 2:if(r=a.lastConfig,i=r.modelType,o=r.data,c=o.find((function(e){return e.id===s.a.ADDON}))){n.next=6;break}return n.abrupt("return");case 6:return l=D().addonHandler,n.next=9,l.getSceneAddonListForMenu(e,t);case 9:if(d=n.sent,c.children=d,f=a.lastConfig,v=f.modelType,p=f.data,h=f.disableIds,b=f.config,g=f.onMenuItemClickCallBack,v===i){n.next=14;break}return n.abrupt("return");case 14:a.showMenu(i,p,h,b,g);case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}function P(e){var t,n=null===(t=I.default.getInstance().getConfig(S.k.OCR))||void 0===t||t;return Object(f.q)()||!n||!h.a.getKeyValueFromMap(v.b.SLIDE_OCR_ENTRY)||m.a.IS_PC_LOCAL_EDIT||!!e.props.addon&&"latex"===e.props.addon.type}function L(){return T.a.getInstance().getAppServices().viewableServiceLayer.selectionService}function M(){return T.a.getInstance().getAppServices().viewableServiceLayer.userPriviledgeService}function D(){return T.a.getInstance().getAppServices().viewableServiceLayer.addonManager}},"11a20d9676":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=(n("6e20b6a7d8"),n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("d5c3deb8c7")),s=n("730207179f"),d=n("e0e8dd9366"),f=n("cd255d4473"),v=n("e5a826a0ff"),p=n("79fc58c7b0"),h=n("5cdbac46e8"),b=n("6664e39d13"),g=function(){function e(t,a,i,o){var c=this;r()(this,e),u()(this,"moveTimer",void 0),u()(this,"lastSelectArray",void 0),u()(this,"moveOffsetFrame",void 0),u()(this,"currentMoveType",void 0),u()(this,"editProcess",void 0),u()(this,"a11yManager",void 0),u()(this,"checkAndMoveSelectedElementsWithArrow",(function(e){if(!c.menuManagerRef)return!1;if(c.userPriviledgeService.pptEditorState===h.b.EDITABLE){var t=c.selectionService.selectedElements.selectedArrayForType(v.a.GROUP)||[];if(t.length>0)return c.menuManagerRef.hideAllMenuNum+=1,c.currentMoveType=v.a.GROUP,c.lastSelectArray=t.map((function(e){return e})),c.moveSelectedElementsWithArrow(e),!0;var n=c.selectionService.selectedElements.selectedArrayForType(v.a.SLIDE)||[];if(n.length>0)return c.menuManagerRef.hideAllMenuNum+=1,c.currentMoveType=v.a.SLIDE,c.lastSelectArray=n.map((function(e){return e})),c.moveSelectedElementsWithArrow(e),!0}return!1})),u()(this,"moveSelectedElementsWithArrow",(function(e){var t;switch(null===c.moveOffsetFrame&&(c.moveOffsetFrame={left:0,top:0,width:0,height:0}),e){case 37:c.moveOffsetFrame.left-=1;break;case 39:c.moveOffsetFrame.left+=1;break;case 38:c.moveOffsetFrame.top-=1;break;case 40:c.moveOffsetFrame.top+=1}null===(t=c.a11yManager)||void 0===t||t.promise().then((function(e){return e.isAccessibilityOn})).then((function(e){return e?Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~service")]).then(n.bind(null,"ac748fffd4")):null})).then((function(e){e&&e.default.emit(f.b.MOVE_SELECTED_ELEMENTS_WITH_ARROW,c.moveOffsetFrame)})),c.updateOperationFrame(c.moveOffsetFrame),c.moveTimer&&clearTimeout(c.moveTimer),c.moveTimer=setTimeout((function(){c.delayUpdatePropsForKeyMoveing()}),300)})),u()(this,"checkIsDelayUpdatePosing",(function(){c.moveTimer&&clearTimeout(c.moveTimer),c.delayUpdatePropsForKeyMoveing()})),u()(this,"observerSelectElementsAndSlideChanged",(function(){Object(l.r)((function(){return{lengthSlide:c.selectionService.selectedElements.selectedArrayForType(v.a.SLIDE).length,lengthGroup:c.selectionService.selectedElements.selectedArrayForType(v.a.GROUP).length,currentSlideIndex:c.selectionService.currentSlideIndex}}),(function(){c.moveTimer&&c.moveOffsetFrame&&c.delayUpdatePropsForKeyMoveingWhileSelectChange()}),{fireImmediately:!1})})),u()(this,"delayUpdatePropsForKeyMoveing",(function(){if(c.lastSelectArray){if(c.currentMoveType===v.a.GROUP){var e=c.selectionService.selectedElements.selectedArrayForType(v.a.GROUP);null!=e&&e[0]&&(c.editProcess.persistSizeForGroup(e[0].rootGroupModel),c.editProcess.updateOperationFrameForGroup(null))}else{var t;c.editProcess.persistSize(p.b.MOVE),null===(t=c.editingStateManagerRef)||void 0===t||t.updateElementDraggingState(!1),c.editProcess.updateOperationFrame(null)}c.clear()}})),u()(this,"delayUpdatePropsForKeyMoveingWhileSelectChange",(function(){if(c.lastSelectArray){if(c.currentMoveType===v.a.GROUP){var e=c.selectionService.selectedElements.selectedArrayForType(v.a.GROUP);c.lastSelectArray[0]&&(c.editProcess.persistSizeForGroup(e[0].rootGroupModel,!1,c.lastSelectArray),c.editProcess.updateOperationFrameForGroup(null))}else{var t;c.editProcess.persistSize(p.b.MOVE,!1,c.lastSelectArray),null===(t=c.editingStateManagerRef)||void 0===t||t.updateElementDraggingState(!1),c.editProcess.updateOperationFrame(null)}c.clear()}})),u()(this,"updateOperationFrame",(function(e){Object(l.w)((function(){for(var t=c.selectionService.selectedElements.selectedArrayForType(c.currentMoveType)||[],n=0;n<t.length;n++){var a,r=t[n];if(null===e?Object(s.b)(r,"operationFrame",null):Object(s.b)(r,"operationFrame",{left:r.props.style.left+e.left,top:r.props.style.top+e.top,width:r.props.style.width+e.width,height:r.props.style.height+e.height}),null!==(a=c.editingStateManagerRef)&&void 0!==a&&a.isDragging&&r.type===d.d.CONNECTOR){var i=r,o=i.startUIModel;o&&!o.selected&&(i.props.style.connectorInfo.start=void 0,o.removeRelatedUIModelRefs(i));var u=i.endUIModel;u&&!u.selected&&(i.props.style.connectorInfo.end=void 0,u.removeRelatedUIModelRefs(i))}for(var l=0;l<r.relatedUIModelRefs.length;l++){var f=r.relatedUIModelRefs[l],v=f.connectorCaculater.getUpdateStyle(e);f.updateModelStyle(v)}}}))})),u()(this,"clear",(function(){c.moveOffsetFrame=null,c.lastSelectArray=null,c.currentMoveType=null,c.moveTimer&&clearTimeout(c.moveTimer),c.moveTimer=null})),this.menuManagerRef=t,this.editingStateManagerRef=a,this.selectionService=i,this.userPriviledgeService=o,this.moveTimer=null,this.lastSelectArray=null,this.moveOffsetFrame=null,this.currentMoveType=null,this.editProcess=new b.a(a),this.editProcess.setSelectionService(this.selectionService),setTimeout((function(){c.observerSelectElementsAndSlideChanged()}),1e3)}return o()(e,[{key:"setA11yManagerDelegate",value:function(e){this.a11yManager=e}}]),e}()},"1586b83624":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-desensitization-title-2pvgY{height:36px;line-height:36px;text-align:center;color:rgba(0,0,0,.48);font-size:14px}.style-text-desensitization-dialog-2mhaE{width:456px}.style-radio-button-16QIC{display:block;color:rgba(0,0,0,.88);font-size:14px;font-weight:600}.style-radio-describe-LWLFz{display:block;color:rgba(0,0,0,.48);font-size:12px;font-weight:400}",""]),t.locals={"desensitization-title":"style-desensitization-title-2pvgY","text-desensitization-dialog":"style-text-desensitization-dialog-2mhaE","radio-button":"style-radio-button-16QIC","radio-describe":"style-radio-describe-LWLFz"}},"28bba56632":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,'.style-font-select-wrapper-3skYl{justify-content:space-between;margin-bottom:12px}.style-font-select-wrapper-3skYl,.style-subtitle-2gNaS{font-size:14px;width:100%;height:36px;display:flex;flex-direction:row;align-items:center}.style-subtitle-2gNaS{color:rgba(0,0,0,.48);grid-gap:8px;gap:8px}.style-font-select-2L3hV{width:240px;height:36px}.style-list-container-1pRjz [class^="dui-menu dui-menu-normal dui-select-list"]{border:none;overflow-y:hidden}',""]),t.locals={"font-select-wrapper":"style-font-select-wrapper-3skYl",subtitle:"style-subtitle-2gNaS","font-select":"style-font-select-2L3hV","list-container":"style-list-container-1pRjz"}},"29d8d1434d":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-size-container-3Za2z{display:flex;flex-direction:row;align-items:flex-start;width:352px;height:56px;justify-content:space-between;margin-bottom:20px}.style-size-container-3Za2z [class^=number-input_number-input]{height:36px;font-size:14px}.style-size-container-3Za2z [class^=number-input_number-input] [class^=number-input_number-input-buttons]{height:36px}.style-size-container-3Za2z [class^=number-input_number-input] [class^=number-input_number-input-buttons] [class^=number-input_down-button],.style-size-container-3Za2z [class^=number-input_number-input] [class^=number-input_number-input-buttons] [class^=number-input_up-button]{height:17px}.style-size-container-3Za2z .style-single-container-lczBp{display:flex;flex-wrap:wrap;justify-content:center}.style-size-container-3Za2z .style-single-container-lczBp .style-text-2cD_Z{font-size:12px;color:rgba(0,0,0,.64)}",""]),t.locals={"size-container":"style-size-container-3Za2z","single-container":"style-single-container-lczBp",text:"style-text-2cD_Z"}},"2c754d5254":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n("963f2eaace"),n("c6244f7705"),n("b1e2246d82"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287");var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=(n("a2a09da1e3"),n("63513d8b56"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("8ee19818c4"),n("0a8ecd6412"));function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var f=function(){function e(){r()(this,e),u()(this,"itemValueWorkers",[]),u()(this,"itemDataworkers",{})}return o()(e,[{key:"addItemValueWorker",value:function(e){this.itemValueWorkers.push(e)}},{key:"removeItemValueWorker",value:function(e){var t=this.itemValueWorkers.indexOf(e);t>-1&&this.itemValueWorkers.splice(t,1)}},{key:"addItemDataWorker",value:function(e){e&&(this.itemDataworkers[e.id]=e)}},{key:"removeItemDataWorker",value:function(e){e&&delete this.itemDataworkers[e]}},{key:"processMenuItemValues",value:function(e,t){var n,a=e,r=s(this.itemValueWorkers);try{for(r.s();!(n=r.n()).done;){a=n.value.processMenuItemValues(a,t)}}catch(e){r.e(e)}finally{r.f()}return a}},{key:"processItemData",value:function(e,t,n){var a,r=s(e);try{for(r.s();!(a=r.n()).done;){var i=a.value;i.id&&this.processDetailItemData(i,t),n&&n!==l.v.DOUBLE_TOOLBAR||this.processDoubleToolItemData(i,t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"processDetailItemData",value:function(e,t){var n=this.itemDataworkers[e.id];null==n||n.processMenuItemData(e,t)}},{key:"processDoubleToolItemData",value:function(e,t){var n=this;["big","bottom","top"].forEach((function(a){Array.isArray(e[a])&&e[a].forEach((function(e){n.processDetailItemData(e,t)}))}))}}]),e}()},"2c7ea59c19":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=(n("75563bc376"),n("d00a79b9b7")),s=n("e0e8dd9366"),d=n("862b984676"),f=function(){function e(){r()(this,e)}return o()(e,null,[{key:"setMediaManagerDelegate",value:function(t){e.mediaManager||(e.mediaManager=t)}},{key:"setPresentationRefDelegate",value:function(t){e.presentationRef||(e.presentationRef=t)}},{key:"findMediaById",value:function(t){var n=this.getCurrentSlideModel();if(!n)return null;var a=t,r=n.children.find((function(e){return e.id===a&&e.type===s.d.IMAGE}));if(!r)return null;var i=r.key,o=e.mediaManager;return{mediaInstance:null==o?void 0:o.getVideoInstanceByRegion(i,d.a.PLAYER),pictureModelKey:i}}},{key:"updateElementKey",value:function(t){var n=e.mediaManager;null==n||n.updateElementKeyByRegion(t,d.a.PLAYER)}},{key:"playVideo",value:function(t){e.mediaManager.playVideoByRegion(t,d.a.PLAYER)}},{key:"getCurrentSlideModel",value:function(){var t=l.default.getState().control,n=e.presentationRef;return null==n?void 0:n.children[t.currentPage]}}]),e}();u()(f,"presentationRef",void 0),u()(f,"mediaManager",void 0)},"360ad9dd48":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a,r,i=n("1f925d7f50"),o=n.n(i),c=n("9132715560"),u=n.n(c),l=n("85d0a7609b"),s=n.n(l),d=n("2dc700e1e6"),f=n.n(d),v=(n("f1054791f4"),n("d5c3deb8c7")),p=n("ec5cae33cb"),h=n("37091e4240"),b=(a=function e(t,n){u()(this,e),o()(this,"isPlaying",r,this),s()(this,"play",void 0),s()(this,"endPlay",void 0),s()(this,"playAction",void 0),s()(this,"playEndAction",void 0),s()(this,"hasShowRemotePlay",!1),h.b.on(h.a.START_PLAY,(function(){var e;null==n||null===(e=n.getEditorInstance())||void 0===e||e.triggerBlur(),t.lastMouseDownRegion=p.a.NONE})),h.b.on(h.a.END_PLAY,(function(){t.lastMouseDownRegion=p.a.NONE}))},r=f()(a.prototype,"isPlaying",[v.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a)},"377a6e5671":function(e,t,n){"use strict";var a,r,i,o,c,u=n("1f925d7f50"),l=n.n(u),s=n("9132715560"),d=n.n(s),f=n("6a364eb35c"),v=n.n(f),p=(n("85d0a7609b"),n("2dc700e1e6")),h=n.n(p),b=(n("f1054791f4"),n("d5c3deb8c7")),g=n("d9812f1c6f"),E=n("e0a67dc3fe"),O=n("4e7af1026b"),m=null===(a=E.a.getConfig(O.b.showNote))||void 0===a||a,T=(r=function(){function e(){d()(this,e),l()(this,"show",i,this),l()(this,"listShow",o,this),l()(this,"isMobileNoteFullScreen",c,this)}return v()(e,[{key:"setShow",value:function(){this.show=!0}},{key:"setHide",value:function(){this.show=!1}},{key:"setListShow",value:function(){this.listShow=!0}},{key:"setListHide",value:function(){this.listShow=!1}},{key:"enterMobileFullScreen",value:function(){this.isMobileNoteFullScreen=!0}},{key:"leaveMobileFullScreen",value:function(){this.isMobileNoteFullScreen=!1}}]),e}(),i=h()(r.prototype,"show",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!g.a.isMobile&&m}}),o=h()(r.prototype,"listShow",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=h()(r.prototype,"isMobileNoteFullScreen",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r);t.a=T},"395f3e1eb2":function(e,t,n){"use strict";var a,r;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.ALL="all",e.TITLE="title",e.CONTENT="content"}(a||(a={})),function(e){e.ALL="all",e.CURRENT="current"}(r||(r={}))},"4130eb9b7d":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("8930941e65"),r=n("d9812f1c6f"),i=n("6a9e93341e"),o=function(e,t){return r.a.isMobile?e:Object(a.a)(t).isNullOrUndefined()?e-i.s:e-t}},"45608c2f56":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("382929c8da"),r=n("e0e8dd9366"),i=1;function o(e,t){var n,o,c=t.props.style.image;e[a.a.REGULATE]={contrast:null==c?void 0:c.contrast,brightness:null==c?void 0:c.brightness,sharpenSoften:null==c?void 0:c.sharpenSoften},e[a.a.PICTURE_COLOR]={saturate:null==c?void 0:c.saturate,colorTemperature:null==c?void 0:c.colorTemperature};var u=t.getBackgroundFill().getFillInfo(),l=t.type===r.d.SHAPE?null!==(n=null==u||null===(o=u.image)||void 0===o?void 0:o.alpha)&&void 0!==n?n:i:t.props.style.alpha;e[a.a.INSERT_PICTURE]={alpha:l}}},"49560ba51f":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("9132715560"),r=n.n(a),i=n("85d0a7609b"),o=n.n(i),c=n("7af4d80efc"),u=n("2c7ea59c19"),l=function e(){r()(this,e),o()(this,"attachMediaEvent",(function(e,t,n){return n===c.b.DESKTOP&&(null==e||e.onContainerState((function(n){if(e.isShow!==n){var a=(u.a.findMediaById(t)||{}).pictureModelKey;if(!a)return;u.a.updateElementKey(n?a:"")}})),!0)}))}},"524eabcc8f":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("7e61746219"),u=n("a9f4350d0a"),l=n("5fac0349d3"),s=function(){function e(){r()(this,e)}return o()(e,[{key:"getCreateDocNewErrorToastInfo",value:function(e,t,n){return{msg:n||l.a.t("生成副本失败，请稍后重试"),type:"error"}}},{key:"produceBackup",value:function(e,t,n,a){return!!Object(c.e)()&&(Object(u.a)(e,t,n,a),!0)}},{key:"shouldCheckVipStatus",value:function(){return!0}}]),e}()},"55d5f8a022":function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a,r,i=n("85d0a7609b"),o=n.n(i),c=(n("1bab7b5fb7"),n("9d7978d445"),n("75563bc376"),n("8ee19818c4"),n("6e20b6a7d8"),n("342844cefa"),n("8a35b54c1d"),n("0acdc5834b"),n("3bf1976a4f"),n("382929c8da")),u=n("51b2ea9953"),l=n("14c02e2331"),s=n("d5c3deb8c7"),d=n("45608c2f56"),f=n("8897cfe637"),v=n("c2f805291c"),p=n("0442e400dc"),h=(a={},o()(a,c.a.BOLD,!1),o()(a,c.a.ITALIC,!1),o()(a,c.a.UNDERLINE,!1),o()(a,c.a.DELETELINE,!1),o()(a,c.a.TEXT_INDENT,0),o()(a,c.a.SUBSCRIPT,!1),o()(a,c.a.SUPERSCRIPT,!1),o()(a,c.a.COLUMN_NUMBER,f.c),o()(a,c.a.COLUMN_SPACE,f.d),a),b=[c.a.BOLD,c.a.ITALIC,c.a.UNDERLINE,c.a.DELETELINE,c.a.FORECOLOR,c.a.BACKCOLOR,c.a.VERTICAL_ALIGN,c.a.HORIZONTAL_ALIGN,p.a.HORIZONTAL_LEFT,p.a.HORIZONTAL_RIGHT,p.a.HORIZONTAL_CENTER,p.a.HORIZONTAL_JUSTIFY,p.a.HORIZONTAL_DISTRIBUTE,c.a.FONTSIZE,c.a.FONTSIZE_UP,c.a.FONTSIZE_DOWN,c.a.FONT,c.a.ROW_SPACE,c.a.LINE_HEIGHT_IS,c.a.ROW_SPACE_ABSOLUTE,c.a.ITEMNUMBER,c.a.DIGITNUMBER,c.a.BULLET_COLOR,c.a.BULLET_SIZE,c.a.BULLET_START_NUMBER,c.a.BULLET_CUSTOM_TEXT,c.a.BULLET_CUSTOM_IMAGE,c.a.INDENT,c.a.TEXT_INDENT,c.a.ENTER_EDITOR,c.a.UNDO,c.a.REDO,c.a.LINK,c.a.TEXT_ADJUST,c.a.MARGIN_LEFT,c.a.SPACE_BEFORE,c.a.SPACE_AFTER,c.a.TAB_LIST,c.a.TAB_SIZE,c.a.PADDING_ADJUST,p.b.INDENT_INCREASE,p.b.INDENT_REDUCE,c.a.FONT_EFFECT,c.a.FONT_FILL,c.a.FONT_BORDER],g=(r={fontWeight:function(e){return{id:c.a.BOLD,value:"bold"===e}},fontStyle:function(e){return{id:c.a.ITALIC,value:"italic"===e}},textDecoration:function(e){return{id:c.a.UNDERLINE,value:"underline"===e}},del:function(e){return{id:c.a.DELETELINE,value:"sng"===e}}},o()(r,l.x,(function(e){return e>0?{id:c.a.SUPERSCRIPT,value:!0}:e<0?{id:c.a.SUBSCRIPT,value:!0}:{}})),o()(r,"fontSize",(function(e){return{id:c.a.FONTSIZE,value:"font-size-".concat(e,"pt")}})),o()(r,"fontFamily",(function(e){var t=(null==e?void 0:e.split(","))||"";return t.length&&(t=t[0]),{id:c.a.FONT,value:t}})),o()(r,"color",(function(e){return{id:c.a.FORECOLOR,value:e}})),o()(r,"backgroundColor",(function(e){return{id:c.a.BACKCOLOR,value:e}})),o()(r,"alignItems",(function(e){return{id:c.a.VERTICAL_ALIGN,value:function(e){switch(e){case"flex-start":return p.a.VERTICAL_TOP;case"center":return p.a.VERTICAL_CENTER;case"flex-end":return p.a.VERTICAL_BOTTOM;default:return}}(e)}})),o()(r,"textAlign",(function(e){return{id:c.a.HORIZONTAL_ALIGN,value:function(e){switch(e){case"left":return p.a.HORIZONTAL_LEFT;case"center":return p.a.HORIZONTAL_CENTER;case"right":return p.a.HORIZONTAL_RIGHT;case"justify":return p.a.HORIZONTAL_JUSTIFY;case"distribute":return p.a.HORIZONTAL_DISTRIBUTE;default:return}}(e)}})),o()(r,"PPTLineHeight",(function(e){return{id:c.a.ROW_SPACE,value:e}})),o()(r,"lineHeight",(function(e){return{id:c.a.ROW_SPACE_ABSOLUTE,value:e}})),o()(r,"lineHeightIs",(function(e){return{id:c.a.LINE_HEIGHT_IS,value:e}})),o()(r,"marginLeft",(function(e){return{id:c.a.MARGIN_LEFT,value:e}})),o()(r,"textIndent",(function(e){return{id:c.a.TEXT_INDENT,value:e}})),o()(r,"paraPaddingTop",(function(e){return{id:c.a.SPACE_BEFORE,value:e}})),o()(r,"paraPaddingBottom",(function(e){return{id:c.a.SPACE_AFTER,value:e}})),o()(r,"tabList",(function(e){return{id:c.a.TAB_LIST,value:Object(s.p)(e)?Object(s.v)(e):e}})),o()(r,"tabSize",(function(e){return{id:c.a.TAB_SIZE,value:e}})),o()(r,"buClr",(function(e){return null!=e&&e.color?{id:c.a.BULLET_COLOR,value:null==e?void 0:e.color}:{}})),o()(r,"buSzPct",(function(e){return"number"==typeof e?{id:c.a.BULLET_SIZE,value:e}:{}})),o()(r,"buAutoNum",(function(e){var t=e||{},n=t.startAt,a=t.type,r=[];return n&&r.push({id:c.a.BULLET_START_NUMBER,value:n}),a&&r.push({id:c.a.DIGITNUMBER,value:a}),r})),o()(r,"character_bullet_char",(function(e,t){if(e){var n;if("multi"===e)return{};var a=t.find((function(e){return"buFont"===e.id})),r=null==a||null===(n=a.value)||void 0===n?void 0:n.typeface;if(r){var i=v.a.find((function(t){return t.typeface===r&&t.character_bullet_char===e}));if(i)return{id:c.a.ITEMNUMBER,value:i.type}}return{id:c.a.BULLET_CUSTOM_TEXT,value:e}}})),o()(r,"buBlip",(function(e){var t;return null!=e&&null!==(t=e.blip)&&void 0!==t&&t.src?{id:c.a.BULLET_CUSTOM_IMAGE,value:null==e?void 0:e.blip.src}:{}})),o()(r,c.a.TEXT_ADJUST,(function(e){return{id:c.a.TEXT_ADJUST,value:e}})),o()(r,"effect",(function(e){return{id:c.a.FONT_EFFECT,value:e}})),o()(r,c.a.FONT_FILL,(function(e){return{id:c.a.FONT_FILL,value:Object(s.p)(e)?Object(s.v)(e):e}})),o()(r,"border",(function(e){return{id:c.a.FONT_BORDER,value:Object(s.p)(e)?Object(s.v)(e):e}})),o()(r,c.a.COLUMN_NUMBER,(function(e){return{id:c.a.COLUMN_NUMBER,value:e}})),o()(r,c.a.COLUMN_SPACE,(function(e){return{id:c.a.COLUMN_SPACE,value:e}})),o()(r,"tdColor",(function(e){return{id:c.a.FONT_THEME_COLOR,value:e}})),r);function E(e){var t,n,a,r,i,o,s,f,v,p,E=function(e){var t,n,a=e.selectionStyles||{};return!e.editorInstance||null!==(t=e.editorInstance)&&void 0!==t&&t.isEditing||(a=(null===(n=e.editorInstance)||void 0===n?void 0:n.getAllStylesSync())||{}),["alignItems","backgroundColor","displayFontSize","fonts","rawFontSize","textDecoration",l.x].forEach((function(e){"multi"===a[e]&&delete a[e]})),Object.keys(a).map((function(e){return{id:e,value:a[e]}}))}(e),O=(p=E).filter((function(e){return g[e.id]})).reduce((function(e,t){var n,a,r=g[t.id](t.value,p);return r||null===(n=window)||void 0===n||null===(a=n.log)||void 0===a||a.error("[Data Error] convertStyleToMenu to null, raw style: ".concat(JSON.stringify(t))),Array.isArray(r)?e.concat(r):e.concat([r])}),[]).filter((function(e){return e})),m={};return O.forEach((function(e){m[e.id]=e.value})),m[c.a.SIZE_ADJUST]=e.getLock().getLockInfo(),m[c.a.FILLCOLOR]=null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillInfo(),m[c.a.EFFECT]=null===(n=e.getEffect)||void 0===n?void 0:n.call(e).getEffectCollection(),m[c.a.BORDERCOLOR]=null===(a=e.getBorder)||void 0===a?void 0:a.call(e).getBorderInfo(),m[c.a.TEXT_ADJUST]={autoFitType:(null==e||null===(r=e.textBodyStyle)||void 0===r?void 0:r.autoFitType)||u.a.NO_AUTO_FIT,autoBreakType:(null==e||null===(i=e.textBodyStyle)||void 0===i||null===(o=i.bodyStyle)||void 0===o?void 0:o.whiteSpace)||u.g.WRAP,rawData:null==e||null===(s=e.textBodyStyle)||void 0===s?void 0:s.bodyStyle},m[c.a.TEXT_DIRECTION]=(null==e||null===(f=e.textBodyStyle)||void 0===f||null===(v=f.wrapperStyle)||void 0===v?void 0:v.textDirection)||u.d.HORIZONTAL,b.forEach((function(e){m[e]=m[e]||void 0})),Object.keys(h).forEach((function(e){void 0===m[e]&&(m[e]=h[e])})),Object(d.a)(m,e),m}},"56a3a65e0c":function(e,t,n){"use strict";n.r(t),n.d(t,"QUICK_TOOL_AID_FEATURE",(function(){return Ze})),n.d(t,"QUICK_TOOL_AID_POSITION",(function(){return ze})),n.d(t,"QuickToolDialogManager",(function(){return Xe}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a,r,i=n("176815363d"),o=n.n(i),c=n("9132715560"),u=n.n(c),l=n("6a364eb35c"),s=n.n(l),d=n("85d0a7609b"),f=n.n(d),v=n("3ef2352f0b"),p=n.n(v),h=(n("3bf1976a4f"),n("c6244f7705"),n("081c8cafea"),n("6e20b6a7d8"),n("963f2eaace"),n("75563bc376"),n("395f3e1eb2")),b=n("69084d01d3"),g=n.n(b),E=n("2e0796c118"),O=n.n(E),m=n("14502724a6"),T=n.n(m),y=(n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("52d461bc51")),S=n.n(y),I=n("5fac0349d3"),R=n("7a5536c9bf"),A=n.n(R),_=(n("63513d8b56"),n("a6a688d71a")),C=n.n(_),P=n("7eb0635f44"),L=n.n(P),M=n("e792a3169a"),D=n.n(M),w=n("9a52b0912e"),N=n.n(w),k={insert:"head",singleton:!1},x=(D()(N.a,k),N.a.locals||{}),F=n("e0e8dd9366"),U=function(e){var t,n,a=e.onCheckStateChange,r=e.needGetSelectModels,i=e.services,o=null===(t=i.masterLayoutEditService)||void 0===t?void 0:t.isMasterEditType,c=Object(b.useState)(o||!1),u=T()(c,2),l=u[0],s=u[1],d=Object(b.useState)(!1),f=T()(d,2),v=f[0],p=f[1],h=Object(b.useState)(!1),E=T()(h,2),O=E[0],m=E[1],y=Object(b.useState)(!0),S=T()(y,2),R=S[0],_=S[1],P=null===(n=i.selectionService.selectedElements.selectedArray)||void 0===n?void 0:n.length;return Object(b.useEffect)((function(){a(function(){var e=i.selectionService;if(r&&P&&e.currentSlide)return[{children:e.selectedElements.selectedArray,width:e.currentSlide.width,height:e.currentSlide.height,childrenConverted:e.currentSlide.childrenConverted,startConvertChildrenTask:e.currentSlide.startConvertChildrenTask,getBatchUpdateFrame:e.currentSlide.getBatchUpdateFrame}];var t=A()(e.slides);if(l&&e.currentSlide)t=[e.currentSlide];else if(v&&t.splice(0,1),O&&t.splice(-1,1),R||(t=t.filter((function(e){return e.isShowInPlay}))),e.currentSlideType===F.d.MASTER){var n=e.currentSlide;t=[n].concat(A()(n.layoutList))}return t}()),!o&&(v||O||R)&&s(!1)}),[l,v,O,R]),g.a.createElement("div",{style:{width:"100%"}},r&&P?g.a.createElement(C.a,{checked:!0,disabled:!0},I.a.t("仅选中图片")):g.a.createElement("div",{className:x["page-range-wrapper"]},g.a.createElement(L.a.Group,{className:x["current-page-wrapper"],onChange:function(e){var t;t=!!e,p(!1),m(!1),_(!t),s(t)},defaultValue:0},g.a.createElement(L.a,{value:0},g.a.createElement("div",null,I.a.t("全部页面"))),g.a.createElement(L.a,{value:1},g.a.createElement("div",null,I.a.t("仅当前页面")))),!o&&!l&&g.a.createElement("div",{className:x["extra-select-wrapper"]},g.a.createElement(C.a,{onChange:function(e){return _(e)},checked:R},I.a.t("包含隐藏页面")),g.a.createElement(C.a,{onChange:function(e){return p(e)},checked:v},I.a.t("忽略首页")),g.a.createElement(C.a,{onChange:function(e){return m(e)},checked:O},I.a.t("忽略尾页")))))},j=n("d436b8c143"),B=n.n(j),G=n("28bba56632"),H=n.n(G),W={insert:"head",singleton:!1},Y=(D()(H.a,W),H.a.locals||{}),V=n("a6c7240c95");!function(e){e[e.TITLE=0]="TITLE",e[e.CONTENT=1]="CONTENT"}(a||(a={})),function(e){e[e.EA=0]="EA",e[e.LATIN=1]="LATIN"}(r||(r={}));var K=function(e){var t=Object(V.p)(),n=e.onFontChange,i=e.FontListModule,o=e.QuickToolFontList,c=e.fontFamilyInfo,u=Object(b.useState)(null==c?void 0:c.titleFontEa),l=T()(u,2),s=l[0],d=l[1],f=Object(b.useState)(null==c?void 0:c.titleFontLatin),v=T()(f,2),p=v[0],h=v[1],E=Object(b.useState)(null==c?void 0:c.contentFontEa),O=T()(E,2),m=O[0],y=O[1],S=Object(b.useState)(null==c?void 0:c.contentFontLatin),R=T()(S,2),A=R[0],_=R[1],P=Object(b.useState)(!0),L=T()(P,2),M=L[0],D=L[1],w=function(e,t,n){e===a.TITLE?t===r.EA?M?N(n):d(n):h(n):t===r.EA?y(n):_(n)},N=function(e){d(e),h(e),y(e),_(e)},k=function(e,t){return e===a.TITLE?t===r.EA?s:p:(r.EA,m)},x=function(e){if(!e)return I.a.t("未选择");var n=t.find((function(t){return t.id===e}));return n?n.content:e},F=function(e,t,n){return g.a.createElement(B.a,{className:Y["font-select"],renderDropdown:function(){return function(e,t){return g.a.createElement(o,{onFontChange:function(n){w(e,t,n)},selectedFontFamily:k(e,t)||"",FontListModule:i})}(e,t)},listContainerClassName:Y["list-container"],listStyle:{padding:"0"},placeholder:x(n),textStyle:{color:"#000"},onVisibleChange:function(n){!function(e,t,n){e&&w(t,n,void 0)}(n,e,t)}})};return Object(b.useEffect)((function(){n({titleFontEa:s,titleFontLatin:p,contentFontEa:m,contentFontLatin:A})}),[s,p,m,A]),g.a.createElement("div",{style:{marginBottom:"20px",width:"100%"}},g.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},g.a.createElement("div",{style:{width:"50%"},className:Y.subtitle},M?I.a.t("所有文字"):I.a.t("标题")),g.a.createElement(C.a,{style:{height:"20px"},onChange:function(e){D(e),N(e?s||p||m||A:s)},defaultChecked:!0},I.a.t("所有文字字体相同"))),g.a.createElement("div",{className:Y["font-select-wrapper"]},g.a.createElement("span",null,M?I.a.t("目标字体"):I.a.t("中文字体")),F(a.TITLE,r.EA,s)),!M&&g.a.createElement("div",{className:Y["font-select-wrapper"]},g.a.createElement("span",null,I.a.t("西文字体")),F(a.TITLE,r.LATIN,p)),!M&&g.a.createElement("div",{className:Y.subtitle},I.a.t("正文")),!M&&g.a.createElement("div",{className:Y["font-select-wrapper"]},g.a.createElement("span",null,I.a.t("中文字体")),F(a.CONTENT,r.EA,m)),!M&&g.a.createElement("div",{className:Y["font-select-wrapper"]},g.a.createElement("span",null,I.a.t("西文字体")),F(a.CONTENT,r.LATIN,A)))},z=n("580eefa367"),Z=n("9049777d9b"),X=n("3404d6c52c"),q=n.n(X),J=n("daef0859e7"),Q=n("382929c8da"),$=n("ea3a38d9d4"),ee=n("3471fb3b60"),te=function(e){var t,n=null===(t=e.props.nvPr)||void 0===t?void 0:t.descr;return n?function(e){try{return JSON.parse(e)}catch(e){return null}}(n):null},ne=n("77c89fc0e0"),ae="unifyfont",re=function e(t,n){if(t.type!==F.d.GROUP){var a=t.isTitleOrCtrTitlePl||function(e){var t;if((null===(t=e.parent)||void 0===t?void 0:t.type)!==F.d.SLIDE)return!1;if(!e.sdkData)return!1;var n=te(e.sdkData);return(null==n?void 0:n.isTemplate)&&"title"===n.type}(t),r=(null==n?void 0:n.titleFontEa)||(null==n?void 0:n.titleFontLatin),i=(null==n?void 0:n.contentFontEa)||(null==n?void 0:n.contentFontLatin);a&&!r||!a&&!i||Object(J.b)(t,{actionType:Q.a.UNIFORM_FONT,values:{ea:a?null==n?void 0:n.titleFontEa:null==n?void 0:n.contentFontEa,latin:a?null==n?void 0:n.titleFontLatin:null==n?void 0:n.contentFontLatin},menuType:$.a.TOOLBAR})}else t.children.forEach((function(t){e(t,n)}))},ie=function(){var e=o()(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=q.a.show({tip:I.a.t("加载中...")}),e.prev=1,e.next=4,new Promise((function(e){return setTimeout(e,0)}));case 4:return e.next=6,Promise.all(t.map(function(){var e=o()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!(null!=t&&t.childrenConverted),!e.t0){e.next=4;break}return e.next=4,null==t?void 0:t.startConvertChildrenTask(ee.a.HIGH);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:Object(z.f)((function(){t.forEach((function(e){null==e||e.children.forEach((function(e){re(e,n)}))}))})),a.close(),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(1),a.close(),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}(),oe=function(e){var t=e.visible,n=e.onClose,a=e.onCancel,r=e.onOk,i=e.position,c=e.FontListModule,u=e.services,l=e.QuickToolFontList,s=e.fontFamilyInfo,d=Object(b.useState)(),f=T()(d,2),v=f[0],h=f[1],E=Object(b.useState)(),O=T()(E,2),m=O[0],y=O[1],R=function(){var e=o()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.userPrivilegeService.pptEditorState===ne.f.EDITABLE){e.next=3;break}return u.tipsManager.showCannotEditTips(),e.abrupt("return");case 3:if(r(ae,I.a.t("统一字体"))&&m&&v){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,ie(v,m).catch((function(){}));case 7:n();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){a(),n()},_=Object(b.useRef)(null);return Object(b.useEffect)((function(){Object(Z.g)({ref:_.current,name:I.a.t("统一字体"),feature:Ze,position:i,apprec:ae,anchor:"PPT-TOOLS"})}),[_.current]),g.a.createElement(S.a,{title:I.a.t("统一字体"),visible:t,onClose:A,onCancel:A,onOk:R,className:"uniform-font-dialog",okDisabled:function(){if(!m)return!0;var e=m.titleFontEa,t=m.titleFontLatin,n=m.contentFontEa,a=m.contentFontLatin;return!(e||t||n||a)}()},g.a.createElement("div",{style:{width:"100%"},ref:_}),g.a.createElement(K,{QuickToolFontList:l,FontListModule:c,fontFamilyInfo:s,onFontChange:function(e){y(e)}}),g.a.createElement(U,{needGetSelectModels:!1,onCheckStateChange:function(e){return h(e)},services:{masterLayoutEditService:u.masterLayoutEditService,selectionService:u.selectionService}}))},ce=(n("1bab7b5fb7"),n("0aeae65bf4"),n("826dc923b3"),n("b4638a0243"),n("bd80bf2d0f"),n("b4a31815a1")),ue=n("3344f1a2e7"),le=n("29d8d1434d"),se=n.n(le),de={insert:"head",singleton:!1},fe=(D()(se.a,de),se.a.locals||{}),ve=n("c9c92622ff"),pe=n("aaf7ed577b");function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge=50,Ee=0,Oe=.1,me="batsetpicsize",Te=function(e){var t=e.visible,n=e.onClose,a=e.onOk,r=e.position,i=e.services,c=Object(b.useState)(5),u=T()(c,2),l=u[0],s=u[1],d=Object(b.useState)(5),f=T()(d,2),v=f[0],h=f[1],E=Object(b.useState)(!0),O=T()(E,2),m=O[0],y=O[1],R=Object(b.useState)(!1),A=T()(R,2),_=A[0],P=A[1],L=Object(b.useState)(!0),M=T()(L,2),D=M[0],w=M[1],N=Object(b.useState)(),k=T()(N,2),x=k[0],j=k[1],B=function(e){return e.type===F.d.IMAGE&&!Object(ve.F)(e)&&!Object(pe.b)(e)},G=function e(t,n,a){if(t.type===F.d.GROUP&&t.children.forEach((function(t){e(t,n,a)})),B(t)){var r,i,o=null===(r=(i=t).getFrame)||void 0===r?void 0:r.call(i).getFrameInfo();if(o){var c=be(be({},o),{},{width:Object(ue.n)(l),height:Object(ue.n)(v)});n.push(t),a.push(c)}}},H=function e(t,n,a){t.type===F.d.GROUP&&t.children.forEach((function(t){e(t,n,a)})),B(t)&&(n.push(t),a.push(Object(ue.n)(l)))},W=function e(t,n,a){t.type===F.d.GROUP&&t.children.forEach((function(t){e(t,n,a)})),B(t)&&(n.push(t),a.push(Object(ue.n)(v)))},Y=function(){var e=o()(p.a.mark((function e(t){var r,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a(me,I.a.t("批量设置图片尺寸"))&&x){e.next=4;break}return e.abrupt("return");case 4:r=q.a.show({tip:I.a.t("加载中...")}),i=setTimeout(o()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(null==x?void 0:x.map(function(){var e=o()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!t.childrenConverted,!e.t0){e.next=4;break}return e.next=4,t.startConvertChildrenTask(ee.a.HIGH);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:Object(z.f)(V),n(),r.close(),clearTimeout(i);case 6:case"end":return e.stop()}}),e)}))),0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=[],t=[],n=[],a=null==x?void 0:x[0];D?_?(null==x||x.forEach((function(n){n.children.forEach((function(n){H(n,e,t)}))})),null==a||a.getBatchUpdateFrame().batchUpdateWidth({value:t,updateModelArr:e})):(null==x||x.forEach((function(n){n.children.forEach((function(n){W(n,e,t)}))})),null==a||a.getBatchUpdateFrame().batchUpdateHeight({value:t,updateModelArr:e})):(null==x||x.forEach((function(t){t.children.forEach((function(t){G(t,e,n)}))})),null==a||a.getBatchUpdateFrame().batchUpdateFrame({frame:n,updateModelArr:e}))},K=function(e){var t=e.match(/-?\d+(?:\.\d+)?/g);return Number(Number(null==t?void 0:t[0]).toFixed(2))||0},X=function(e,t){return D?t?e.toFixed(2).toString():"":e.toFixed(2).toString()},J=Object(b.useRef)(null);return Object(b.useEffect)((function(){Object(Z.g)({ref:J.current,name:I.a.t("批量设置图片尺寸"),feature:Ze,position:r,apprec:me,anchor:"PPT-TOOLS"})}),[J.current]),g.a.createElement(S.a,{title:I.a.t("批量设置图片尺寸"),visible:t,onClose:n,onCancel:n,onOk:Y,className:"muti-pic-size-dialog"},g.a.createElement("div",{style:{width:"100%",marginBottom:"10px"},ref:J}),g.a.createElement("div",{className:fe["size-container"]},g.a.createElement("div",{className:fe["single-container"]},g.a.createElement(ce.g,{min:Ee,max:ge,allowDecimal:!0,toFixed:2,value:X(v,m),step:Oe,suffix:I.a.t("厘米"),style:{width:"168px"},onChange:function(e){y(!0),P(!1),h(Number(K(e)))}}),g.a.createElement("div",{className:fe.text},I.a.t("高度"))),g.a.createElement("div",{className:fe["single-container"]},g.a.createElement(ce.g,{min:Ee,max:ge,allowDecimal:!0,toFixed:2,value:X(l,_),suffix:I.a.t("厘米"),step:Oe,style:{width:"168px"},onChange:function(e){P(!0),y(!1),s(Number(K(e)))}}),g.a.createElement("div",{className:fe.text},I.a.t("宽度")))),g.a.createElement("div",{style:{marginBottom:"20px"}},g.a.createElement(C.a,{checked:D,style:{fontSize:"12px",color:"rgba(0, 0, 0, 0.64)"},onChange:function(e){return w(e)}},I.a.t("锁定纵横比"))),g.a.createElement(U,{needGetSelectModels:!0,onCheckStateChange:function(e){return j(e)},services:{masterLayoutEditService:i.masterLayoutEditService,selectionService:i.selectionService}}))},ye=(n("405b4a5e2b"),n("0acdc5834b"),n("6fc2b77709")),Se=n("9e6e153df9"),Ie=n.n(Se),Re={insert:"head",singleton:!1},Ae=(D()(Ie.a,Re),Ie.a.locals||{}),_e="batsetpiclay",Ce=function(e){var t=e.visible,n=e.onClose,a=e.onOk,r=e.position,i=e.services,c=Object(b.useState)(),u=T()(c,2),l=u[0],s=u[1],d=Object(b.useState)(ye.a.SINGLE),f=T()(d,2),v=f[0],h=f[1],E=Object(b.useState)(3),O=T()(E,2),m=O[0],y=O[1],R=Object(b.useState)(1),A=T()(R,2),_=A[0],C=A[1],P=function(e){return e.children.filter((function(e){return e.type===F.d.IMAGE&&!e.rootGroupModel&&!Object(ve.F)(e)&&!Object(pe.b)(e)}))},M=Object(b.useRef)(null);Object(b.useEffect)((function(){Object(Z.g)({ref:M.current,name:I.a.t("批量图片布局"),feature:Ze,position:r,apprec:_e,anchor:"PPT-TOOLS"})}),[M.current]);var D=function(e,t,n,a){return g.a.createElement("div",{style:{padding:"".concat(a,"px ").concat(n,"px")},className:Ae["sketch-map-wrapper"]},new Array(e).fill(g.a.createElement("div",{style:{height:"".concat(t,"px")},className:Ae["sketch-map-child"]})))},w=null==l?void 0:l.reduce((function(e,t){return e+P(t).length}),0);return g.a.createElement(S.a,{title:I.a.t("批量图片布局"),visible:t,onClose:n,onCancel:n,className:Ae["muti-pic-pos-dialog"],onOk:function(){if(a(_e,I.a.t("批量图片布局"))&&l)var e=q.a.show({tip:I.a.t("加载中...")}),t=setTimeout(o()(p.a.mark((function a(){return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(null==l?void 0:l.map(function(){var e=o()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!t.childrenConverted,!e.t0){e.next=4;break}return e.next=4,t.startConvertChildrenTask(ee.a.HIGH);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:Object(z.f)((function(){null==l||l.forEach((function(e){var t=P(e);t.length&&i.elementAutoLayoutService.layout(t,e.width,e.height,_)}))})),e.close(),clearTimeout(t),n();case 6:case"end":return a.stop()}}),a)}))),0)}},g.a.createElement("div",{style:{width:"100%",marginBottom:"10px"},ref:M}),g.a.createElement("div",{className:Ae["select-number-tips"]},I.a.t("共选择{0}个图片",{0:w})),g.a.createElement("div",{style:{margin:"20px 0px",width:"100%"}},g.a.createElement(L.a.Group,{style:{display:"flex",justifyContent:"space-between"},onChange:function(e){h(e),C(e===ye.a.MUITI?m:e)},defaultValue:ye.a.SINGLE},g.a.createElement(L.a,{value:ye.a.SINGLE},g.a.createElement("div",{className:Ae["lable-wrapper"]},I.a.t("单行平铺")),D(4,17,5,0)),g.a.createElement(L.a,{value:ye.a.DOUBLE},g.a.createElement("div",{className:Ae["lable-wrapper"]},I.a.t("双行平铺")),D(6,17,16,18)),g.a.createElement(L.a,{value:ye.a.MUITI,labelClickable:!1,labelClassName:Ae["muti-lable-wrapper"]},g.a.createElement("div",{className:Ae["lable-wrapper"]},g.a.createElement(ce.g,{value:(_>=3?_:m).toString(),defaultValue:3,disabled:v!==ye.a.MUITI,step:1,max:7,min:3,onChange:function(e){C(Number(e)),y(Number(e))},style:{width:"40px",height:"24px",display:"inline-block",marginRight:"8px"}}),I.a.t("行平铺")),D(9,14,16,13)))),g.a.createElement(U,{needGetSelectModels:!0,onCheckStateChange:function(e){return s(e)},services:{masterLayoutEditService:i.masterLayoutEditService,selectionService:i.selectionService}}))},Pe=n("17b68c2613"),Le=n("cd1934c1b5"),Me=n("775b80aea6"),De="batdownloadpic",we=function(e){var t=e.visible,n=e.onClose,a=e.onOk,r=e.position,i=e.services,c=Object(b.useState)([]),u=T()(c,2),l=u[0],s=u[1],d=Object(b.useState)(),f=T()(d,2),v=f[0],h=f[1],E=function(){var e=o()(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(De,I.a.t("批量图片下载"))&&v){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all(v.map(function(){var e=o()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!t.childrenConverted,!e.t0){e.next=4;break}return e.next=4,t.startConvertChildrenTask(ee.a.HIGH);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:t=l.map((function(e,t){var n="".concat(I.a.t("图片"),"-").concat(t+1),a=e.props.src;if(Le.a.isBlobUrl(a)){var r=Me.a.getInstance().getResourceByUrl(a),i=null==r?void 0:r.getCdnUrl();i&&(a=i)}return{name:n,url:a}})),Pe.a.downloadMutiImageToZip(t),n();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function e(t,n){if(t.type===F.d.GROUP&&t.children.forEach((function(t){e(t,n)})),t.type===F.d.IMAGE){if(Object(ve.F)(t)||Object(pe.b)(t))return;n.push(t)}},m=function(){var e=[];null==v||v.forEach((function(t){t.children.forEach((function(t){O(t,e)}))})),s(e)};Object(b.useEffect)((function(){m()}),[v]);var y=Object(b.useRef)(null);return Object(b.useEffect)((function(){Object(Z.g)({ref:y.current,name:I.a.t("批量图片下载"),feature:Ze,position:r,apprec:De,anchor:"PPT-TOOLS"})}),[y.current]),g.a.createElement(S.a,{title:I.a.t("批量图片下载"),visible:t,onClose:n,onCancel:n,className:"muti-export-pic-dialog",onOk:E,okDisabled:!l.length},g.a.createElement("div",{style:{width:"100%",marginBottom:"10px"},ref:y}),g.a.createElement("span",{style:{marginBottom:"20px",fontSize:"14px",color:"rgba(0, 0, 0, 0.48)"}},I.a.t("共选择{0}个图片",{0:l.length})),g.a.createElement(U,{needGetSelectModels:!0,onCheckStateChange:function(e){return h(e)},services:{masterLayoutEditService:i.masterLayoutEditService,selectionService:i.selectionService}}))},Ne=n("1586b83624"),ke=n.n(Ne),xe={insert:"head",singleton:!1},Fe=(D()(ke.a,xe),ke.a.locals||{}),Ue="textdesensitization",je=function(e){var t=e.visible,n=e.onClose,a=e.onOk,r=e.position,i=e.services,c=Object(b.useState)(),u=T()(c,2),l=u[0],s=u[1],d=Object(b.useState)(!0),f=T()(d,2),v=f[0],h=f[1],E=function(){var e=o()(p.a.mark((function e(){var t,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(Ue,I.a.t("数字内容脱敏"))&&l){e.next=2;break}return e.abrupt("return");case 2:t=q.a.show({tip:I.a.t("加载中...")}),r=setTimeout(o()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(null==l?void 0:l.map(function(){var e=o()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!t.childrenConverted,!e.t0){e.next=4;break}return e.next=4,t.startConvertChildrenTask(ee.a.HIGH);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:Object(z.f)((function(){var e;l&&(null===(e=i.numberTestManager)||void 0===e||e.replaceSensitiveData(l,v))})),n(),t.close(),clearTimeout(r);case 6:case"end":return e.stop()}}),e)}))),0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=Object(b.useRef)(null);return Object(b.useEffect)((function(){Object(Z.g)({ref:O.current,name:I.a.t("数字内容脱敏"),feature:Ze,position:r,apprec:Ue,anchor:"PPT-TOOLS"})}),[O.current]),g.a.createElement(S.a,{title:I.a.t("数字内容脱敏"),visible:t,onClose:n,onCancel:n,onOk:E,className:Fe["text-desensitization-dialog"]},g.a.createElement("div",{style:{width:"100%",marginBottom:"10px"},ref:O}),g.a.createElement("div",{className:Fe["preview-container"]}),g.a.createElement("div",{className:Fe["desensitization-title"]},I.a.t("脱敏效果")),g.a.createElement(L.a.Group,{onChange:function(e){return h(!!e)},value:v?1:0},g.a.createElement(L.a,{value:1},g.a.createElement("div",{className:Fe["radio-button"]},I.a.t("数字转为***，但是保留“百、千、万、亿”等计数单位")),g.a.createElement("div",{className:Fe["radio-describe"]},I.a.t("如：100万、一百万、1百万，都转为***万"))),g.a.createElement(L.a,{value:0},g.a.createElement("div",{className:Fe["radio-button"]},I.a.t("数字都转为***")),g.a.createElement("div",{className:Fe["radio-describe"]},I.a.t("包括中文、阿拉伯数字，如：一百万、壹佰万、1000000")))),g.a.createElement(U,{needGetSelectModels:!1,onCheckStateChange:function(e){return s(e)},services:{masterLayoutEditService:i.masterLayoutEditService,selectionService:i.selectionService}}))},Be=n("eaf25849e6"),Ge=n("d3d31c86eb"),He=n("9da6335152"),We=n("0a8ecd6412"),Ye=n("0230345688");function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze,Ze="pptquicktool";!function(e){e.RIGHT_MENU="rightmenu",e.TOOLBAR="toolbar",e.AI="aisidebar"}(ze||(ze={}));var Xe=function(){function e(t){var n=this;u()(this,e),f()(this,"dialogContainer",document.createElement("div")),f()(this,"dialogType",void 0),f()(this,"position",void 0),f()(this,"FontListModule",void 0),f()(this,"services",void 0),f()(this,"hideDialog",(function(){O.a.unmountComponentAtNode(n.dialogContainer)})),f()(this,"handleClickOk",(function(e,t){var a=n.getAction(!0);return Object(Ge.c)({opername:He.e.DOC_PPT,module:He.d.PC_TOOLBAR,action:a,eventcode:"".concat(He.e.DOC_PPT,"-").concat(He.d.PC_TOOLBAR,"-").concat(a),ver3:n.getVer3(),ver5:Object(Z.b)()}),!!Object(Z.d)()||(Object(Be.a)({position:n.position,feature:Ze,apprec:e,name:t}),!1)})),this.injectable=t}var t,n,a,r;return s()(e,[{key:"setServiceDelegates",value:function(e){this.services=Ke(Ke({},this.services),e)}},{key:"showDialog",value:(r=o()(p.a.mark((function e(t){var n,a,r,i,o=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:ze.TOOLBAR,r=o.length>2?o[2]:void 0,i=o.length>3?o[3]:void 0,e.next=5,null===(n=this.injectable)||void 0===n?void 0:n.getFontListFontListModule();case 5:this.FontListModule=e.sent,this.position=a,this.dialogType=t,this.updateDialog(!0,a,r,i),Object(Ge.c)({opername:He.e.DOC_VIP_SLIDEQUICKTOOL,module:He.d.FUNCTION,action:He.b.MENU_BAR_CLICK,eventcode:"".concat(He.e.DOC_VIP_SLIDEQUICKTOOL,"-").concat(He.d.PC_TOOLBAR,"-").concat(He.b.MENU_BAR_CLICK),ver5:Object(Z.b)(),ver6:this.getVer6(),ver9:He.m.TOOLBAR});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"showUniformFontDialog",value:(a=o()(p.a.mark((function e(){var t,n,a,r,i,o=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:ze.TOOLBAR,a=o.length>1?o[1]:void 0,r=o.length>2?o[2]:void 0,i=o.length>3?o[3]:void 0,e.next=6,null===(t=this.injectable)||void 0===t?void 0:t.getFontListFontListModule();case 6:this.FontListModule=e.sent,this.position=n,this.dialogType=Q.a.UNIFORM_FONT,this.updateDialog(!0,n,a,r,i),Object(Ge.c)({opername:He.e.DOC_VIP_SLIDEQUICKTOOL,module:He.d.FUNCTION,action:He.b.MENU_BAR_CLICK,eventcode:"".concat(He.e.DOC_VIP_SLIDEQUICKTOOL,"-").concat(He.d.PC_TOOLBAR,"-").concat(He.b.MENU_BAR_CLICK),ver5:Object(Z.b)(),ver6:this.getVer6(),ver9:He.m.TOOLBAR});case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"updateDialog",value:(n=o()(p.a.mark((function e(t,n,a,r,i){var o,c,u,l,s=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=this.getDialogByType(),u=function(e,t){var n=s.handleClickOk(e,t);return n&&(null==a||a()),n},l=function(){null==r||r()},O.a.render(g.a.createElement(c,{visible:t,onClose:this.hideDialog,onOk:u,onCancel:l,position:n,FontListModule:this.FontListModule,QuickToolFontList:null===(o=this.injectable)||void 0===o?void 0:o.getQuickToolFontList(),services:this.services,fontFamilyInfo:i}),this.dialogContainer);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,a,r,i){return n.apply(this,arguments)})},{key:"getRecommendFontList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=Object(V.p)(),a=Math.ceil(n.length/t),r=e>a-1?e%a:e;return n.slice(r*t,r*t+t).map((function(e){return e.content}))}},{key:"applyFont",value:(t=o()(p.a.mark((function e(t){var n,a,r,i,o,c,u,l,s=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:h.a.ALL,a=s.length>2&&void 0!==s[2]?s[2]:h.b.ALL,t){e.next=4;break}throw new Ye.a(Ye.b.InvalidFont);case 4:if(r=Object(V.m)().find((function(e){return e.content.toLowerCase()===t.toLowerCase()}))){e.next=7;break}throw new Ye.a(Ye.b.InvalidFont);case 7:if(i=this.services.selectionService,(o=(a===h.b.CURRENT?[i.currentSlide]:i.slides)||[]).length){e.next=11;break}throw new Ye.a(Ye.b.SlideNotExist);case 11:return c=n!==h.a.CONTENT?r.id:void 0,u=n!==h.a.TITLE?r.id:void 0,l={titleFontEa:c,titleFontLatin:c,contentFontEa:u,contentFontLatin:u},e.prev=14,e.next=17,ie(o,l);case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(14),window.log.error("applyFont -error: ".concat(e.t0)),e.t0;case 23:case"end":return e.stop()}}),e,this,[[14,19]])}))),function(e){return t.apply(this,arguments)})},{key:"getDialogByType",value:function(){var e=this.dialogType;return e===Q.a.UNIFORM_FONT?oe:e===Q.a.MUTI_PICTURE_SIZE_SETTING?Te:e===Q.a.MUTI_PICTURE_POS_SETTING?Ce:e===Q.a.MUTI_PICTURE_EXPORT?we:e===Q.a.DIGITAL_CONTENT_DESENSITIZATION?je:oe}},{key:"getVer6",value:function(){var e=this.dialogType;return e===Q.a.UNIFORM_FONT?"unifyfont":e===Q.a.MUTI_PICTURE_SIZE_SETTING?"batsetpicsize":e===Q.a.MUTI_PICTURE_POS_SETTING?"batsetpiclay":e===Q.a.MUTI_PICTURE_EXPORT?"batdownloadpic":""}},{key:"getAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dialogType;return t===Q.a.UNIFORM_FONT?e?He.b.SHORTCUT_TOOL_UNIFORM_FONT_OK:He.b.SHORTCUT_TOOL_UNIFORM_FONT_CLICK:t===Q.a.MUTI_PICTURE_SIZE_SETTING?e?He.b.SHORTCUT_TOOL_IMAGE_SIZE_OK:He.b.SHORTCUT_TOOL_IMAGE_SIZE_CLICK:t===Q.a.MUTI_PICTURE_POS_SETTING?e?He.b.SHORTCUT_TOOL_IMAGE_LAYOUT_OK:He.b.SHORTCUT_TOOL_IMAGE_LAYOUT_CLICK:t===Q.a.MUTI_PICTURE_EXPORT?e?He.b.SHORTCUT_TOOL_IMAGE_DOWNLOAD_OK:He.b.SHORTCUT_TOOL_IMAGE_DOWNLOAD_CLICK:He.b.SHORTCUT}},{key:"getVer3",value:function(){return this.position===ze.TOOLBAR?this.services.toolbarStateManager.getToolbarMode()===We.v.SINGLE_TOOLBAR?He.h.SINGLE_TOOLBAR:He.h.DOUBLE_TOOLBAR:He.h.RIGHT_MENU}}]),e}()},"59087c860a":function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.ENTER_LINK_EDIT="enterLinkEdit",e.ENTER_ELEMENT="enterElement",e.LEAVE_ELEMENT="leaveElement",e.LINK_CLICK="linkClick"}(a||(a={}))},"5cf98436e9":function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));n("b8217400dc"),n("e6f68cdf2e");var a=n("e0e8dd9366"),r=n("55d5f8a022");var i=n("14502724a6"),o=n.n(i),c=(n("8ee19818c4"),n("7d1df7d0fb")),u=n("382929c8da"),l=n("310c0b6a04"),s=n("d5c3deb8c7"),d=n("f9193d718f"),f=n("086c96a9ce"),v=n("2ba7871556"),p=n("45608c2f56");function h(e){var t,n,a,r=null===(t=null===(a=d.a.getInstance().getAppServices().editableServiceLayer)||void 0===a?void 0:a.menuManager)||void 0===t?void 0:t.mergeMenuValuesCacheMap.get(e);if(r)return r;if(null!==(n=e.children)&&void 0!==n&&n.length&&e.isRootGroup){var i,h=Object(c.a)(e,!0),b=[];s.w((function(){null==h||h.forEach((function(e){var t=Object(f.c)(e);!function(e,t){e.forEach((function(e){delete t[e]}))}([v.a],t),b.push(t)}))}));var g=Object(c.c)(b,Object(c.b)(h));(g[u.a.SIZE_ADJUST]||e.props[l.b.LOCKS])&&(g[u.a.SIZE_ADJUST]=e.getLock().getLockInfo());var E=Object(f.b)(e),O=o()(E,1)[0];return O&&Object(p.a)(g,O),g[v.a]=null!==(i=e.getBackgroundFill().getFillInfo())&&void 0!==i?i:void 0,g}return{}}var b=n("85d0a7609b"),g=n.n(b);n("75563bc376");function E(e){if(e.selectedModels){var t,n=null===(t=null===(b=d.a.getInstance().getAppServices().editableServiceLayer)||void 0===b?void 0:b.menuManager)||void 0===t?void 0:t.mergeMenuValuesCacheMap.get(e);if(n)return n;var r=[];s.w((function(){e.selectedModels.forEach((function(e){e.type===a.d.GROUP?r.push(h(e)):e.type!==a.d.TABLE&&r.push(Object(f.c)(e))})),e.selectedModels.every((function(e){return e.type===a.d.SHAPE}))&&(r.push(g()({},u.a.FONTSIZE_INCREASE,void 0)),r.push(g()({},u.a.FONTSIZE_UP,void 0)))}));var i=Object(c.c)(r,Object(c.b)(e.selectedModels));e.selectedModels.find((function(e){return e.type!==a.d.TABLE}))&&(i[u.a.PARAGRAPH_MORE]=1);var l=Object(f.b)(e),v=o()(l,1)[0];return v&&Object(p.a)(i,v),i}var b;return{}}function O(e){return e?f.a.includes(e.type)?Object(f.c)(e):[a.d.NOTE].includes(e.type)?function(e){return r.a(e.noteTextBody)}(e):[a.d.GROUP].includes(e.type)?h(e):[a.d.MULTIPLY].includes(e.type)?E(e):{}:{}}},"6168a1bafd":function(e,t,n){"use strict";n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a,r=n("85d0a7609b"),i=n.n(r),o=n("9b674918eb"),c=n.n(o),u=n("9132715560"),l=n.n(u),s=n("6a364eb35c"),d=n.n(s),f=(n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("826dc923b3"),n("3bf1976a4f"),n("8959d513b6")),v=n("5fac0349d3"),p=n("020899bf26"),h=n("3344f1a2e7"),b=n("d9812f1c6f"),g=n("d00a79b9b7"),E=n("d09b3891fa"),O=n("37091e4240"),m=n("7e61746219"),T=["onCancel"];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.VIEW="View",e.PLAYING="Playing"}(a||(a={}));var I="[OpenClientApi]",R=function(){function e(t,n,a,r){l()(this,e),this.playManager=t,this.selectionService=n,this.editAreaCanvasSizeManager=a,this.exportImageManager=r,this.connect()}return d()(e,[{key:"transferToPDF",value:function(e){Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55")]).then(n.t.bind(null,"0d1ab71e9c",7)).then((function(t){t.ExportPDFManager.getInstance().onlineExport(e)})).catch((function(t){var n;window.log.error("".concat(I," @tencent/docs-scenario-components-export-pdf load error - ").concat(t));var a=v.a.t("请求失败，请稍后重试。");p.a.UI.Snackbar.promise().then((function(e){e.show({message:a,autoClose:!0,duration:5e3})})),null===(n=e.onFinish)||void 0===n||n.call(e,new Error(a),{url:""})}))}},{key:"transferToImage",value:function(e){var t=null!=e?e:{},n=t.onCancel,a=S(S({},c()(t,T)),{},{onClose:n,showSafeAreaInset:!1});this.exportImageManager.exportImage(a)}},{key:"getPagesNumber",value:function(){var e,t,n;return null!==(e=null===(t=this.selectionService)||void 0===t||null===(n=t.slides)||void 0===n?void 0:n.length)&&void 0!==e?e:0}},{key:"getCurrentPageInfo",value:function(){var e,t;return{pageIndex:b.a.isMobile?null===(e=this.selectionService)||void 0===e?void 0:e.mobileCurrentDisplayIndex:null===(t=this.selectionService)||void 0===t?void 0:t.currentSlideIndex}}},{key:"jumpTo",value:function(e){var t=Number(e);isNaN(t)?window.log.error("".concat(I," jumpTo pageIndex is NaN")):this.selectionService.changeCurrentSlideIndexByUserAction(t)}},{key:"getViewState",value:function(){return this.playManager.isPlaying?a.PLAYING:a.VIEW}},{key:"playPresentation",value:function(e){var t,n,a,r,i;this.playManager.isPlaying||(null!==(t=p.a.ContentStatusManager())&&void 0!==t&&null!==(n=t.isDocumentReady)&&void 0!==n&&n.call(t)?(null===(a=(r=this.playManager).playAction)||void 0===a||a.call(r,null!==(i=null==e?void 0:e.isFromCurrent)&&void 0!==i&&i),O.b.once(O.a.END_PLAY,(function(){var t;null==e||null===(t=e.onFinish)||void 0===t||t.call(e)}))):p.a.UI.Snackbar.promise().then((function(e){e.show({message:v.a.t("加载幻灯片中，请稍后再试"),autoClose:!0,duration:3e3})})))}},{key:"exitPresentation",value:function(e){var t,n;this.playManager.isPlaying&&(null===(t=(n=this.playManager).playEndAction)||void 0===t||t.call(n,e))}},{key:"gotoNextAnimation",value:function(){this.playManager.isPlaying?g.default.dispatch(Object(E.nextPage)()):window.log.error("".concat(I," gotoNextAnimation current is not playing viewState"))}},{key:"gotoPrevAnimation",value:function(){this.playManager.isPlaying?g.default.dispatch(Object(E.prevPage)()):window.log.error("".concat(I," gotoNextAnimation current is not playing viewState"))}},{key:"viewZoom",value:function(e){if(!b.a.isMobile){var t="",n=e;n<=.1?(n=.1,t=v.a.t("已拉伸至最小比例")):n>4&&(n=4,t=v.a.t("已拉伸至最大值")),t&&p.a.UI.Snackbar.promise().then((function(e){e.show({message:t,duration:1e3})})),window.log.error("".concat(I," viewZoom origin ratio: ").concat(e,", final scale: ").concat(n)),this.editAreaCanvasSizeManager.setCanvasScaleAndIsAutoAdapter(Object(h.j)(n),!1),window.dispatchEvent(new CustomEvent("resize",{detail:{countSizeAgain:!0}}))}}},{key:"expandMobileOptionsMenu",value:function(){O.b.emit(O.a.TDOC_SHOW_MENU_MORE)}},{key:"connect",value:function(){Object(m.f)()&&new f.a(this).configure(window)}}]),e}();t.a=R},"6ff710444e":function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return b}));n("73b854064b");var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("bd29e2df90"),u=n.n(c),l=n("ab5eb40518"),s=n.n(l),d=n("1b4cdd6a36"),f=n.n(d),v=n("f8aba17285");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=f()(e);if(t){var r=f()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return s()(this,n)}}var h=function(e){u()(n,e);var t=p(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"getObserveData",value:function(){var e=this.model,t=e.operationFrame,n=e.operatingGraphicInfo,a=e.previewChange;return{selected:this.model.selected,operationFrame:t,operatingGraphicInfo:n,previewChange:a}}}]),n}(v.a),b=function(e){u()(n,e);var t=p(n);function n(){return r()(this,n),t.apply(this,arguments)}return n}(v.a)},"713338c47c":function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));n("73b854064b");var a=n("176815363d"),r=n.n(a),i=n("9132715560"),o=n.n(i),c=n("6a364eb35c"),u=n.n(c),l=n("547611bd96"),s=n.n(l),d=n("bd29e2df90"),f=n.n(d),v=n("ab5eb40518"),p=n.n(v),h=n("1b4cdd6a36"),b=n.n(h),g=n("85d0a7609b"),E=n.n(g),O=n("3ef2352f0b"),m=n.n(O),T=(n("c6244f7705"),n("081c8cafea"),n("5fac0349d3")),y=n("780d9b3b59"),S=n("020899bf26"),I=n("2f1cded8d8"),R=n("aba9dcef64"),A=n("ee6bb53310"),_=n.n(A),C=n("9562979fa7"),P=n("8b13fcae36");function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return p()(this,n)}}var M=function(e){f()(n,e);var t=L(n);function n(e){var a;return o()(this,n),a=t.call(this),E()(s()(a),"logger",void 0),E()(s()(a),"revisionCommitSuccessCb",(function(){a.socketListener.closeOfflineTips()})),E()(s()(a),"revisionCommitFailCb",(function(e){a.handleSlideAppErrorCode(e)})),E()(s()(a),"revertDocCb",(function(e){var t;if(((null==e?void 0:e.head)||{}).uid!==(null===(t=S.a.DocInfoManager())||void 0===t?void 0:t.tinyid)){var n={message:T.a.t("文档已被其他协作者还原，请刷新"),commonTipsType:y.b.INFO,onlyShowOne:!0,actionType:y.a.REFRESH};y.c.getInstance().show(n)}else Object(P.tencentDocOpenUrlReload)()})),E()(s()(a),"fetchMissingDataErrorCb",function(){var e=r()(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.c.getInstance().hide(),!t){e.next=11;break}return e.next=4,R.a.CollaborationManager.promise();case 4:if(!e.sent.getPersistent().getMutationsPacks().length){e.next=8;break}return y.c.getInstance().show({message:T.a.t("文档已被其他协作者还原，本地存在未保存的数据"),commonTipsType:y.b.INFO,onlyShowOne:!0,actionType:y.a.EXPORT_SNAP_SHOT|y.a.CREATE_COPY_DOC,callBack:function(e,t){e===y.a.CREATE_COPY_DOC&&t(!0)}}),e.abrupt("return");case 8:a.revertDocCb(),e.next=12;break;case 11:y.c.getInstance().show({message:T.a.t("拉取增量数据失败，请刷新重试"),commonTipsType:y.b.INFO,onlyShowOne:!0,actionType:y.a.REFRESH});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.socketListener=e,S.a.Infra.Logger.promise().then((function(e){a.logger=e})),S.a.SDKDataServices.EventManager.promise().then((function(e){var t=e.revisionEvents,n=e.socketEvents;t.onCommitSucceed(a.revisionCommitSuccessCb),t.onCommitFail(a.revisionCommitFailCb),t.onEnqueue((function(){var e;return null===(e=S.a.DocInfoManager())||void 0===e?void 0:e.setDocVisible()})),t.onFetchMissingDataError(a.fetchMissingDataErrorCb),t.onUpdateBaseRevision((function(e){var t,n=null===(t=S.a.ClientVarsService())||void 0===t?void 0:t.getClientVars();n&&_()(n,"collab_client_vars.rev",e)})),n.onRevertMessage(a.revertDocCb)})),a}return u()(n,[{key:"onSetVisibleFailed",value:function(e){S.a.EventManager.promise().then((function(t){t.on(I.a.SetVisibleFailed,e)}))}}]),n}(C.a)},"7181c053d9":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n("176815363d"),r=n.n(a),i=n("9132715560"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=n("3ef2352f0b"),s=n.n(l),d=(n("c6244f7705"),n("081c8cafea"),n("020899bf26")),f=n("780d9b3b59"),v=n("5fac0349d3"),p=n("9da6335152"),h=n("fe82ecf3fc"),b=n("aba9dcef64"),g=function e(){var t=this;o()(this,e),u()(this,"logger",void 0),u()(this,"onFatalError",(function(e){var n;f.c.getInstance().hide();var a,i={};i=(null===(n=b.a.CollaborationManager())||void 0===n?void 0:n.getPersistent().getMutationsPacks().length)?{message:v.a.t("更新数据异常，本地存在未保存的数据"),commonTipsType:f.b.ERROR,onlyShowOne:!0,actionType:f.a.HOWTODEAL,callBack:(a=r()(s.a.mark((function t(n,a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n===f.a.CREATE_COPY_DOC&&a(e);case 1:case"end":return t.stop()}}),t)}))),function(e,t){return a.apply(this,arguments)})}:{message:v.a.t("更新数据异常"),commonTipsType:f.b.ERROR,onlyShowOne:!0,actionType:f.a.REFRESH},t.reportDataError(),f.c.getInstance().show(i)})),u()(this,"onTransformError",(function(e){f.c.getInstance().hide();var n={message:v.a.t("处理数据异常，本地存在未保存的数据"),commonTipsType:f.b.ERROR,actionType:f.a.HOWTODEAL,onlyShowOne:!0,callBack:function(t,n){t===f.a.CREATE_COPY_DOC&&n(e===h.c.Offline)}};t.reportDataError(),f.c.getInstance().show(n)})),u()(this,"onTransformTimeout",(function(e){f.c.getInstance().hide();var n={message:v.a.t("处理数据超时，本地存在未保存的数据"),commonTipsType:f.b.INFO,actionType:f.a.HOWTODEAL,onlyShowOne:!0,callBack:function(t,n){t===f.a.CREATE_COPY_DOC&&n(e===h.c.Offline)}};t.reportDataError(),f.c.getInstance().show(n)})),u()(this,"reportDataError",(function(){var e,n;null===(e=t.logger)||void 0===e||null===(n=e.tdw)||void 0===n||n.call(e,{opername:p.e.DOC_PPT,module:p.d.PPT,action:p.b.DATA_ERROR})})),d.a.SDKDataServices.EventManager.promise().then((function(e){var n=e.collaboratorEvents,a=e.otTransformEvents;n.onFatalError(t.onFatalError),a.onTransformError(t.onTransformError),a.onTransformTimeout(t.onTransformTimeout)})),d.a.Infra.Logger.promise().then((function(e){t.logger=e}))}},"7af4d80efc":function(e,t,n){"use strict";var a,r;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.PLAY="play",e.PAUSE="pause",e.SPEED="speed"}(a||(a={})),function(e){e.DESKTOP="desktop",e.WEB="web"}(r||(r={}))},"7b50d7e0b8":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("5fac0349d3"),u=n("05d181ac40"),l=n("780d9b3b59"),s=n("b86964b011"),d=function(){function e(){r()(this,e)}return o()(e,[{key:"handlePskeyError",value:function(){if(Object(s.k)()&&!u.a.IS_LOCAL_EDIT){window.log.info("handlePskeyError logged in");var e={message:c.a.t("登录已失效，请刷新"),commonTipsType:l.b.INFO,actionType:l.a.LOGIN,callBack:function(){}};window.pray().isPlaying?l.c.getInstance().storage(e):l.c.getInstance().show(e)}}}]),e}()},"7faf76450d":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=n("2e0796c118"),s=function(){function e(){r()(this,e),u()(this,"wrapper",void 0)}return o()(e,[{key:"name",get:function(){return"base"}},{key:"show",value:function(e){this.showWrapper()}},{key:"hide",value:function(){this.hideWrapper()}},{key:"showWrapper",value:function(){var e;null===(e=this.wrapper)||void 0===e||e.show()}},{key:"hideWrapper",value:function(){var e;null===(e=this.wrapper)||void 0===e||e.hide()}},{key:"wrapperWillShow",value:function(){}},{key:"wrapperDidHide",value:function(){}},{key:"DOMNode",get:function(){return this.wrapper?Object(l.findDOMNode)(this.wrapper):null}}]),e}()},"85aa87d04f":function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n("176815363d"),r=n.n(a),i=n("9132715560"),o=n.n(i),c=n("6a364eb35c"),u=n.n(c),l=n("85d0a7609b"),s=n.n(l),d=n("3ef2352f0b"),f=n.n(d),v=(n("c6244f7705"),n("081c8cafea"),n("6e20b6a7d8"),n("3bf1976a4f"),n("b8217400dc"),n("e6f68cdf2e"),n("780d9b3b59")),p=n("5fac0349d3"),h=n("020899bf26"),b=n("aba9dcef64"),g=n("a537f7f1aa"),E=n("c7530f2183"),O=n("da1378f0cf"),m=n.n(O),T="recovery-tips-id",y="block-check-tips-id",S=function(){function e(t){var n=this;o()(this,e),s()(this,"isRecovering",!1),s()(this,"tips",void 0),s()(this,"activeBlockCheck",!1),s()(this,"unregisterBeforeunload",(function(){window.removeEventListener("beforeunload",n.onbeforeUnloadCb)})),s()(this,"willRecoverPersistentData",(function(){if(!n.isRecovering){var e={message:p.a.t("正在恢复数据，请耐心等待，整个过程可能会持续几分钟..."),commonTipsType:v.b.INFO,block:!0,closable:!1,id:T};v.c.getInstance().show(e),n.isRecovering=!0}})),s()(this,"didRecoverPersistentData",(function(){n.isRecovering&&(v.c.getInstance().hideById(T),n.isRecovering=!1)})),s()(this,"openDataBaseError",(function(){E.network.isOnline||n.socketListener.handleOnOffline()})),s()(this,"dataBaseFatalError",(function(){n.startDetectBlocked(),E.network.isOnline||n.socketListener.handleOnOffline()})),s()(this,"onbeforeUnloadCb",(function(e){n.guideToSaveSlideData(e)})),s()(this,"registerBeforeunload",(function(){window.addEventListener("beforeunload",n.onbeforeUnloadCb)})),this.socketListener=t,this.tips=v.c.getInstance(),this.registerPersistentEvent(),this.registerBeforeunload()}var t,n;return u()(e,[{key:"startDetectBlocked",value:(n=r()(f.a.mark((function e(){var t,n,a,r=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.activeBlockCheck){e.next=2;break}return e.abrupt("return");case 2:return this.activeBlockCheck=!0,this.reportDetectBlocked("start"),t=m()((function(){return r.reportDetectBlocked("show")})),e.next=7,b.a.CollaborationManager.promise();case 7:n=e.sent.getPersistent(),a=n.getMutationsPacks().map((function(e){return e.taskId})),setInterval((function(){var e=n.getMutationsPacks().map((function(e){return e.taskId}));!e.length||e.length-a.length<10?a=e:(r.tips.hideById(y,!0),r.tips.show({id:y,message:p.a.t("网络连接错误，请刷新后重试。如无法解决您可以尝试清理本地磁盘空间或重启客户端"),block:!0,commonTipsType:v.b.ERROR,actionType:v.a.REFRESH}),t())}),6e4);case 10:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"reportDetectBlocked",value:function(e){var t,n,a=h.a.Infra.Logger();null==a||null===(t=a.monitor)||void 0===t||null===(n=t.reportStatus)||void 0===n||n.call(t,"detectBlock",1,"",["".concat(e,"-").concat(E.network.isOnline?"online":"offline")])}},{key:"guideToSaveSlideData",value:(t=r()(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.CollaborationManager.promise();case 2:if(null==(n=e.sent.getPersistent())||n.onbeforeUnload(),!(a=!!n.getMutationsPacks().length)||![g.b.None,g.b.DidRecoverData].includes(n.getRecoveryStatus())){e.next=8;break}return a&&(t.preventDefault(),t.returnValue=""),e.abrupt("return");case 8:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"registerPersistentEvent",value:function(){var e=this;h.a.SDKDataServices.EventManager.promise().then((function(t){var n=t.persistentEvents;null==n||n.onDataBaseFatalError(e.dataBaseFatalError),null==n||n.onOpenDataBaseError(e.openDataBaseError)})),b.a.CollaborationManager.promise().then((function(t){t.getPersistent().onNeedRecoveryData(e.willRecoverPersistentData),t.getPersistent().onDidRecoveryData(e.didRecoverPersistentData)}))}}]),e}()},"929e788f0c":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n("176815363d"),r=n.n(a),i=n("9132715560"),o=n.n(i),c=n("6a364eb35c"),u=n.n(c),l=n("85d0a7609b"),s=n.n(l),d=n("3ef2352f0b"),f=n.n(d),v=(n("c6244f7705"),n("081c8cafea"),n("a2a09da1e3"),n("8a35b54c1d"),n("b1e2246d82"),n("c33f52ea47")),p=n("281cbdced7"),h=n.n(p),b=n("b40469cb12"),g={name:"docs-component-screenshot",loadType:n("0d2ffd3bdb").LoadType.IDLE},E=n("df0cca3e56"),O=[v.b.allOnlyRead,v.b.allOnlyWrite],m=function(){function e(){o()(this,e),s()(this,"uiDataService",void 0),s()(this,"copyPasteManager",void 0),s()(this,"exportImageManager",void 0),s()(this,"screenshotComponent",void 0),s()(this,"componentShow",!1),s()(this,"screenshotStrategy",{})}var t,n,a,i;return u()(e,[{key:"setCopyPasteManager",value:function(e){this.copyPasteManager=e}},{key:"setExportImageManager",value:function(e){this.exportImageManager=e}},{key:"setUiDataService",value:function(e){this.uiDataService=e}},{key:"init",value:(i=r()(f.a.mark((function e(){var t,n,a,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(E.b)(E.a.SCREENSHOT_COMPONENT),n=t.status,a=t.strategyGroupDataset,r=void 0===a?{}:a,n){e.next=3;break}return e.abrupt("return");case 3:if(this.screenshotStrategy=r,this.listenDocumentPrivilegeChange(),i=b.a.extensionService.dependentServiceCombinder.authDomain.authAggregate.authInfoEntity.documentPrivilege,-1!==O.indexOf(i)){e.next=8;break}return e.abrupt("return");case 8:this.showScreenshotComponent();case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"showScreenshotComponent",value:(a=r()(f.a.mark((function e(){var t,n=this,a=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]&&a[0],!this.componentShow){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.getScreenshotComponent();case 5:e.sent.show({forceCapture:t,triggerStrategy:this.screenshotStrategy,onFetchPage:function(){var e=r()(f.a.mark((function e(t,a){var r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 0===(r=n.uiDataService.presentation.children.filter((function(e){return e.isShowInPlay}))).length&&(r=n.uiDataService.presentation.children),i=r[t-1],n.exportImageManager.isImageCopying=!0,e.next=6,n.copyPasteManager.getSlideDataToCanvas([i],a);case 6:return o=e.sent,n.exportImageManager.isImageCopying=!1,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),this.componentShow=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"disposeScreenshotComponent",value:(n=r()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.componentShow){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getScreenshotComponent();case 4:e.sent.dispose(),this.componentShow=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"listenDocumentPrivilegeChange",value:function(){var e=this;b.a.extensionService.dependentServiceCombinder.authDomain.authAggregate.authInfoEntity.onAuthChanged(h()((function(t){var n=t.newDocumentPrivilege;-1!==O.indexOf(n)?e.showScreenshotComponent(!0):e.disposeScreenshotComponent()}),2e3))}},{key:"getScreenshotComponent",value:(t=r()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.screenshotComponent){e.next=6;break}return e.next=3,b.a.extensionService.scanAndHandleExtensions([g]);case 3:return e.next=5,b.a.extensionService.getExtension(g.name);case 5:this.screenshotComponent=e.sent;case 6:return e.abrupt("return",this.screenshotComponent);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()},"92ec7966a6":function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));n("73b854064b");var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("547611bd96"),u=n.n(c),l=n("bd29e2df90"),s=n.n(l),d=n("ab5eb40518"),f=n.n(d),v=n("1b4cdd6a36"),p=n.n(v),h=n("85d0a7609b"),b=n.n(h),g=(n("8a35b54c1d"),n("b1e2246d82"),n("75563bc376"),n("9e6e95de85"));n("3bf1976a4f");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var O=function(e){s()(n,e);var t=E(n);function n(){var e;r()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),b()(u()(e),"visible",void 0),b()(u()(e),"width",void 0),e}return o()(n,[{key:"initModel",value:function(e,t){this.visible=!1,this.width=280}}]),n}(n("375d29afab").a);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var T=function(e){s()(n,e);var t=m(n);function n(){var e;return r()(this,n),e=t.call(this),b()(u()(e),"modules",[]),b()(u()(e),"visibleModule",void 0),b()(u()(e),"beforeShowCallback",(function(){})),e}return o()(n,[{key:"registerModule",value:function(e){this.modules.filter((function(t){return t.name===e.name})).length>0||(this.modules.push(e),this.refresh())}},{key:"show",value:function(e,t){var n,a=this.getModule(e);a&&(null===(n=this.beforeShowCallback)||void 0===n||n.call(this),this.visibleModule&&(this.visibleModule.hide(),this.resetWidth()),this.visibleModule=a,a.show(t))}},{key:"isShown",value:function(e){var t=this.getModule(e);return!!t&&this.visibleModule===t}},{key:"hide",value:function(){this.visibleModule?this.visibleModule.hide():(this.hideContainer(),this.visibleModule=null)}},{key:"getModule",value:function(e){return this.modules.find((function(t){return t.name===e}))}},{key:"getModules",value:function(){return this.modules}},{key:"getVisibleModule",value:function(){return this.visibleModule}},{key:"_isModuleVisible",value:function(e){return this.visibleModule===e}},{key:"displayingModuleName",value:function(){var e;return null===(e=this.visibleModule)||void 0===e?void 0:e.name}},{key:"setWidth",value:function(e){this._setWidth(e)}},{key:"resetWidth",value:function(){this._resetWidth()}},{key:"registerCallback",value:function(e){var t;this.beforeShowCallback=null!==(t=null==e?void 0:e.beforeShow)&&void 0!==t?t:null}},{key:"_setWidth",value:function(e){this.updateModel({width:e})}},{key:"_resetWidth",value:function(){this._setWidth(null)}},{key:"showContainer",value:function(){this.updateModel({visible:!0})}},{key:"hideContainer",value:function(){this.updateModel({visible:!1})}},{key:"refresh",value:function(){this.updateModel({})}},{key:"onModuleWillShow",value:function(e){e.wrapperWillShow(),this.showContainer()}},{key:"onModuleDidHide",value:function(e){e.wrapperDidHide(),this._isModuleVisible(e)&&(this.hideContainer(),this.visibleModule=null)}},{key:"createViewModel",value:function(){return new O}}]),n}(g.a)},"932efda844":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=n("7e61746219"),s=n("05d181ac40"),d=function(){function e(){r()(this,e),u()(this,"shouldListenSocketShutdown",this.shouldListenSocketChange)}return o()(e,[{key:"shouldListenSocketChange",get:function(){return!s.a.IS_LOCAL_EDIT&&!Object(l.f)()}}]),e}()},"9555d27b64":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n("176815363d"),r=n.n(a),i=n("9132715560"),o=n.n(i),c=n("6a364eb35c"),u=n.n(c),l=n("85d0a7609b"),s=n.n(l),d=n("3ef2352f0b"),f=n.n(d),v=(n("c6244f7705"),n("081c8cafea"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("6e20b6a7d8"),n("69084d01d3")),p=n.n(v),h=n("0865711d4c"),b=n("a6c7240c95"),g=n("e0a67dc3fe"),E=n("4e7af1026b");function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t,n,a=Object(b.p)(),r=e.onFontChange,i=e.selectedFontFamily,o=e.FontListModule;return n=a.map((function(e){return m(m({},e),{},{style:{fontFamily:e.id}})})),null===(t=g.a.getConfig(E.k.cloudFont))||void 0===t||t?p.a.createElement(o,{defaultFonts:n,selectedFontFamily:i,onFontChange:r}):p.a.createElement(h.a,{style:{width:"100%"},items:n,onChange:r,className:"select-list-font-family"})},y=function(){function e(){o()(this,e),s()(this,"FontList",void 0)}var t;return u()(e,[{key:"getFontListFontListModule",value:(t=r()(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.FontList){e.next=6;break}return e.next=3,Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519")]).then(n.bind(null,"c2dfeeb8d1"));case 3:t=e.sent,a=t.FontList,this.FontList=a;case 6:return e.abrupt("return",this.FontList);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getQuickToolFontList",value:function(){return T}}]),e}()},"9562979fa7":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n("9132715560"),r=n.n(a),i=n("85d0a7609b"),o=n.n(i),c=(n("3bf1976a4f"),n("cd88b12bb6"),n("af802ec74b"),n("780d9b3b59")),u=n("77c89fc0e0"),l=n("aba9dcef64"),s=n("8da38f8962"),d=n("93c0e9f7e2"),f=n("7f1cfe4422"),v=n("8b13fcae36"),p=function e(){var t=this;r()(this,e),o()(this,"handleSlideAppErrorCode",(function(e){var n,a,r,i=null===(n=l.a.CollaborationManager())||void 0===n?void 0:n.getPersistent(),p=!(null==i||!i.getMutationsPacks().length),h=(r={message:"",commonTipsType:c.b.INFO,actionType:c.a.REFRESH,onlyShowOne:!0,errorCode:e.code,customerActions:[]},p&&(r.commonTipsType=c.b.ERROR,r.actionType=c.a.HOWTODEAL,r.callBack=function(e,t){e===c.a.CREATE_COPY_DOC&&t(!1)}),r),b={message:"",commonTipsType:c.b.INFO,actionType:c.a.REFRESH,onlyShowOne:!0,errorCode:e.code},g=function(){h.message="".concat(u.l.t("保存失败"),"(").concat(0===e.code?"".concat(e.error):e.code,")"),c.c.getInstance().show(h)},E=(a={},o()(a,f.d.None,(function(){})),o()(a,f.d.Cancel,(function(){})),o()(a,f.d.Unknown,g),o()(a,f.d.ServerError,g),o()(a,f.d.DataError,g),o()(a,f.d.FullRoom,(function(){t.handleSocketShutdown4FullRoom(b,e.code)})),o()(a,f.d.Timeout,(function(){b.message=u.l.t("网络连接超时，请刷新"),c.c.getInstance().show(b)})),o()(a,f.d.LoginExpired,(function(){Object(s.c)()||!Object(d.isLogin)()?(b.message=u.l.t("登录已失效，请刷新"),b.actionType=c.a.LOGIN):b.message=u.l.t("登录已失效，请刷新"),c.c.getInstance().show(b)})),o()(a,f.d.AuthExpired,(function(){h.message=u.l.t("你的权限已发生变化，编辑内容暂无法保存"),c.c.getInstance().show(h)})),o()(a,f.d.SizeLimit,(function(){h.message=u.l.t("修改内容超过限制，编辑内容暂无法保存"),c.c.getInstance().show(h)})),o()(a,f.d.SecurityStrike,(function(){h.message=u.l.t("此内容因违规无法编辑。"),Reflect.deleteProperty(h,"actionType"),h.customerActions=[{text:u.l.t("了解更多"),onClick:function(){c.c.getInstance().hide();var e="https://".concat(window.hostname,"/doc/DWE9lbGhWTU9OV2VF?opendocxfrom=admin");Object(v.setNewWindowUrl)(window,e)}}],c.c.getInstance().show(h)})),a);E[e.error]?E[e.error]():g()})),o()(this,"handleSocketShutdown4FullRoom",(function(e,t){c.c.getInstance().show(Object.assign(e,{message:u.l.t("可编辑人数已达上限，如需编辑请稍后刷新重试。")}))}))}},"9a52b0912e":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-page-range-wrapper-2tYvd{width:100%}.style-page-range-wrapper-2tYvd .style-current-page-wrapper-aY5Ic{display:flex;width:60%;justify-content:space-between}.style-page-range-wrapper-2tYvd .style-extra-select-wrapper-8gR4p{width:100%;display:grid;grid-template-columns:auto auto auto;grid-template-rows:25px}",""]),t.locals={"page-range-wrapper":"style-page-range-wrapper-2tYvd","current-page-wrapper":"style-current-page-wrapper-aY5Ic","extra-select-wrapper":"style-extra-select-wrapper-8gR4p"}},"9ac3b0b039":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=function(){function e(){r()(this,e)}return o()(e,[{key:"customNodeStyle",get:function(){return{}}}]),e}()},"9e6e153df9":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-sketch-map-wrapper-_JDXy{display:flex;width:96px;height:72px;background-color:rgba(51,77,102,.06);justify-content:space-around;align-items:center;border-radius:4px;flex-wrap:wrap}.style-sketch-map-wrapper-_JDXy .style-sketch-map-child-gw3HY{width:20px;flex-shrink:0;background-color:rgba(61,82,102,.12)}.style-muti-pic-pos-dialog-1NqT1{width:456px}.style-muti-pic-pos-dialog-1NqT1 .style-select-number-tips-3hPup{line-height:36px;text-align:center;font-size:14px;font-weight:600}.style-muti-pic-pos-dialog-1NqT1 .style-muti-lable-wrapper-28LDi{position:relative;top:-3px}.style-muti-pic-pos-dialog-1NqT1 .style-lable-wrapper-3HxTB{margin-bottom:8px}",""]),t.locals={"sketch-map-wrapper":"style-sketch-map-wrapper-_JDXy","sketch-map-child":"style-sketch-map-child-gw3HY","muti-pic-pos-dialog":"style-muti-pic-pos-dialog-1NqT1","select-number-tips":"style-select-number-tips-3hPup","muti-lable-wrapper":"style-muti-lable-wrapper-28LDi","lable-wrapper":"style-lable-wrapper-3HxTB"}},a3fbf19e57:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return p}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=(n("c6244f7705"),n("081c8cafea"),n("05d181ac40")),u=n("d9812f1c6f"),l=n("4f3b15d017"),s=n("b86964b011"),d=n("020899bf26"),f=n("7e61746219"),v="3.5.0",p=function(){function e(){r()(this,e)}return o()(e,[{key:"shouldOfflinePrint",get:function(){return u.a.isTencentDocDesktopApp}},{key:"shouldInvokeExternalPrint",get:function(){return u.a.isTencentDocDesktopApp&&l.default.isElectronTencentDocsClientVersionAboveOrEqual("3.2.3")||u.a.isTencentDocApp}},{key:"shouldInvokeExternalPrintOnLegacy",get:function(){return u.a.isTencentDocApp&&(!l.default.isTencentDocsAppVersionAboveOrEqual(v)||c.a.IS_MOBILE_LOCAL_EDIT)}},{key:"shouldInvokeNewPrintOnApp",get:function(){return u.a.isTencentDocApp&&l.default.isTencentDocsAppVersionAboveOrEqual("3.8.0")}},{key:"shouldInvokeExternalLoading",get:function(){return u.a.isTencentDocApp}},{key:"shouldHidePrint",get:function(){return Object(f.g)()}},{key:"shouldDisablePrint",get:function(){var e;return Object(s.h)()||!(null!==(e=d.a.PrivilegeManager())&&void 0!==e&&e.printable)}},{key:"pdfNotNeededWhenExternalPrint",get:function(){return u.a.isTencentDocApp&&!Object(f.e)()}},{key:"invokeExternalPrint",value:function(e){var t,n={downloadUrl:e,printConfig:{orientation:"landscape"},title:null===(t=d.a.SlideTitleManager())||void 0===t?void 0:t.title,type:4};window.mqq.invoke("docx","airPrint",n,null)}},{key:"checkShouldInvokeExternalPrint",value:function(){return this.shouldInvokeExternalPrint?new Promise((function(e){try{var t,n;null===(t=window.mqq)||void 0===t||null===(n=t.invoke)||void 0===n||n.call(t,"docx","printSupport",{},(function(t){0===t.code?e(!0):e(!1)}))}catch(t){e(!1)}})):Promise.resolve(!1)}},{key:"waitForCancel",value:function(){return new Promise((function(e){var t,n;null===(t=window.mqq)||void 0===t||null===(n=t.invoke)||void 0===n||n.call(t,"docx","showPrintLoading",{},(function(t){"cancel"===t.state&&e(!0)}))}))}},{key:"shouldSendToDeviceToPrint",get:function(){return u.a.isMiniProgram||u.a.isWeChat}}]),e}()},b572eb71ea:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a,r,i=n("1f925d7f50"),o=n.n(i),c=n("9132715560"),u=n.n(c),l=n("85d0a7609b"),s=n.n(l),d=n("2dc700e1e6"),f=n.n(d),v=(n("f1054791f4"),n("d5c3deb8c7")),p=(a=function e(){var t=this;u()(this,e),o()(this,"isPreview",r,this),s()(this,"updateElementPreviewState",(function(e){Object(v.w)((function(){t.isPreview=e}))}))},r=f()(a.prototype,"isPreview",[v.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a)},c72a3f66bd:function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var a=n("176815363d"),r=n.n(a),i=n("9132715560"),o=n.n(i),c=n("6a364eb35c"),u=n.n(c),l=n("547611bd96"),s=n.n(l),d=n("bd29e2df90"),f=n.n(d),v=n("ab5eb40518"),p=n.n(v),h=n("1b4cdd6a36"),b=n.n(h),g=n("85d0a7609b"),E=n.n(g),O=n("3ef2352f0b"),m=n.n(O),T=(n("af802ec74b"),n("c6244f7705"),n("081c8cafea"),n("020899bf26")),y=n("9562979fa7"),S=n("780d9b3b59"),I=n("5fac0349d3"),R=n("c7530f2183"),A=n("aba9dcef64"),_=I.a.t("暂时无法本地缓存，请保持联网以同步数据"),C=I.a.t("文档被多个标签页同时打开，请关闭其他标签页后刷新"),P=n("b40469cb12"),L=n("69084d01d3"),M=n.n(L),D=n("6d623d55ad"),w=n.n(D),N=n("8da38f8962");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){E()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return p()(this,n)}}var U=I.a.t("正在离线编辑，编辑内容已缓存，联网后将自动同步云端"),j=I.a.t("离线查看中，文档最新内容会在网络恢复后同步。"),B="offline-tips",G=function(e){f()(n,e);var t=F(n);function n(e,a){var i;return o()(this,n),i=t.call(this),E()(s()(i),"isShowOfflineTips",!1),E()(s()(i),"isShowSyncTips",!1),E()(s()(i),"closeOfflineTips",(function(){i.isShowOfflineTips=!1,S.c.getInstance().hideById(B,!0)})),E()(s()(i),"closeSyncTips",(function(){i.isShowSyncTips=!1,S.c.getInstance().hideById("sync-tips")})),E()(s()(i),"handleOnOnline",(function(){if(i.isShowOfflineTips&&!i.isShowSyncTips){var e={message:I.a.t("离线数据同步中，请稍候"),commonTipsType:S.b.INFO,autoClose:!0,block:!1,closeCallback:i.closeSyncTips};i.closeOfflineTips(),window.pray().isPlaying?S.c.getInstance().clearStorage():S.c.getInstance().show(e)}})),E()(s()(i),"handleOnOffline",(function(){if(!i.isShowOfflineTips){var e=Object.assign({},{message:"",commonTipsType:S.b.INFO,block:!1,id:B},i.getOfflineTipsConfig());i.changeSaveTipsOfflineText(e.message),window.pray().isPlaying?S.c.getInstance().storage(e):S.c.getInstance().show(e),i.isShowOfflineTips=!0}})),E()(s()(i),"changeSaveTipsOfflineText",function(){var e=r()(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.extensionService.getExtension("docs-component-save-tips");case 2:e.sent.store.dispatch.saveTips.setOfflineText(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),T.a.SDKDataServices.EventManager.promise().then((function(t){var n=t.socketEvents;if(e){var r=function(){};a&&(r=n.onShutDown(i.handleSlideAppErrorCode));var o=n.onChangeToOffline(i.handleOnOffline),c=n.onChangeToOnline(i.handleOnOnline);window.addEventListener("beforeunload",(function(){r(),o(),c()})),i.netChangeEvent()}})),i}return u()(n,[{key:"netChangeEvent",value:function(){var e,t=this;R.network.changeEnd((function(n){var a,r=null===(a=A.a.CollaborationManager())||void 0===a?void 0:a.getSocket();if("online"===n)return clearTimeout(e),r?r.opened?void t.handleOnOnline():void 0:void t.handleOnOnline();e=setTimeout((function(){t.handleOnOffline()}))}))}},{key:"getOfflineTipsConfig",value:function(){var e,t,n=this,a=null===(e=T.a.PrivilegeManager())||void 0===e?void 0:e.editable,r=null===(t=A.a.CollaborationManager())||void 0===t?void 0:t.getPersistent(),i={closeCallback:function(){return n.isShowOfflineTips=!1}};return a?null!=r&&r.mutexLockHelper.isLockedByOtherPage()?x({message:C,block:!0},i):null!=r&&r.supportOfflineEdit?x({message:U,block:!1,closable:!0},i):x({message:_,block:!0,customerActions:[{text:this.getDBErrorToolTip()}],shouldCloseAfterAction:!1},i):x({message:j,block:!1},i)}},{key:"getDBErrorToolTip",value:function(){return M.a.createElement(w.a,{title:I.a.t("本地缓存文件写入失败，暂时无法离线缓存您的数据，请保持网络连接以确保数据实时更新。您可以尝试清理本地磁盘空间或重启客户端。"),trigger:N.a.isMobile?"click":"hover"},M.a.createElement("span",{},I.a.t("详情")))}}]),n}(y.a)},d0b83a822c:function(e,t,n){"use strict";n.d(t,"a",(function(){return Le}));n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var a,r,i,o,c,u,l,s,d,f,v,p,h,b=n("7a5536c9bf"),g=n.n(b),E=n("176815363d"),O=n.n(E),m=n("1f925d7f50"),T=n.n(m),y=n("9132715560"),S=n.n(y),I=n("6a364eb35c"),R=n.n(I),A=n("85d0a7609b"),_=n.n(A),C=n("2dc700e1e6"),P=n.n(C),L=(n("f1054791f4"),n("3ef2352f0b")),M=n.n(L),D=(n("8e7cce0ada"),n("c6244f7705"),n("85d48ef22b"),n("ab67fd3ad5"),n("2a6f332b5e"),n("081c8cafea"),n("a2a09da1e3"),n("b1e2246d82"),n("63513d8b56"),n("3bf1976a4f"),n("6e20b6a7d8"),n("b8217400dc"),n("e6f68cdf2e"),n("8a35b54c1d"),n("342844cefa"),n("75563bc376"),n("8ee19818c4"),n("52d461bc51")),w=n.n(D),N=n("c7530f2183"),k=n("0e4dc96964"),x=n("2c0f58c21b"),F=n("e0e8dd9366"),U=n("382929c8da"),j=n("2550128c65"),B=n("63684fef46"),G=n("debba787c1"),H=n("60b97ecf25"),W=n("0a8ecd6412"),Y=n("d9812f1c6f"),V=n("82f2dc9440"),K=n.n(V),z=n("d3d31c86eb"),Z=n("9da6335152"),X=n("3404d6c52c"),q=n.n(X),J=n("32ff3c3c00"),Q=n("d5c3deb8c7"),$=n("e6d98148ee"),ee=n("5fac0349d3"),te=n("132ceeffea"),ne=n("780d9b3b59"),ae=n("c7bf247df7"),re=n("1b0526663d"),ie=n("7463913d61"),oe=n("798a9cd6f2"),ce=n("b40469cb12"),ue=n("e427e5a2bf"),le=n("b86964b011"),se=n("ea3a38d9d4"),de=n("ec5cae33cb"),fe=n("5cdbac46e8"),ve=n("d115d284c3"),pe=n("5cf98436e9"),he=n("daef0859e7"),be=n("59087c860a"),ge=n("f9193d718f"),Ee=n("be572141f1"),Oe=n("48cf2b24ba"),me=n("872ba9d13a"),Te=n("020899bf26"),ye=n("aba9dcef64"),Se=n("02ae07c580"),Ie=n("b55230b666"),Re=n("5ce71228c0"),Ae=n("37091e4240"),_e=n("05d181ac40");function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Le=(a=Q.q,r=Q.q,i=Q.q,o=Q.q,c=Q.q,u=Q.q,l=function(){function e(t){var n=this;S()(this,e),T()(this,"asyncMenuItemReady",s,this),T()(this,"isMenuShown",d,this),T()(this,"hideAllMenuNum",f,this),T()(this,"isColorPicking",v,this),T()(this,"showRatioViewAction",p,this),T()(this,"isDropdownShown",h,this),_()(this,"selectedMgrRef",void 0),_()(this,"selectionServiceRef",void 0),_()(this,"uiDataServiceRef",void 0),_()(this,"userPriviledgeServiceRef",void 0),_()(this,"mergeMenuValuesCacheMap",new WeakMap),_()(this,"paragraphManager",void 0),_()(this,"rightSideBarManager",void 0),_()(this,"themeColorManager",void 0),_()(this,"guidesManager",void 0),_()(this,"snapLineService",void 0),_()(this,"textRulerManager",void 0),_()(this,"gridLineManager",void 0),_()(this,"insertTableRowColManager",void 0),_()(this,"importOnlineFileManager",void 0),_()(this,"historyManager",void 0),_()(this,"exportPreferenceService",void 0),_()(this,"fontManager",void 0),_()(this,"toolbarStateManager",void 0),_()(this,"rightSideBarService",void 0),_()(this,"masterLayoutEditServiceRef",void 0),_()(this,"_event",void 0),_()(this,"refreshReaction",void 0),_()(this,"disableItemIdsCache",void 0),_()(this,"sectionManager",void 0),_()(this,"exportImageManager",void 0),_()(this,"setRightSideBarManagerDelegate",(function(e){n.rightSideBarManager=e})),_()(this,"setRightSideBarServiceDelegate",(function(e){n.rightSideBarService=e})),_()(this,"setThemeColorManager",(function(e){n.themeColorManager=e})),_()(this,"setGuidesManager",(function(e){n.guidesManager=e})),_()(this,"setSnapLineService",(function(e){n.snapLineService=e})),_()(this,"setTextRulerManager",(function(e){n.textRulerManager=e})),_()(this,"setGridLineManager",(function(e){n.gridLineManager=e})),_()(this,"setInsertTableRowColManager",(function(e){n.insertTableRowColManager=e})),_()(this,"_actionBrowseRecord",(function(){var e,t,a;return Object(z.c)({opername:Z.e.DOC_EDITOR_TOPBAR_PC,module:Z.d.MORE_MENU,action:Z.b.BROWSING_HISTORY}),null===(e=n.getAppServices().viewableServiceLayer.extensionService)||void 0===e||null===(t=e.getCallBackAdapter())||void 0===t||null===(a=t.onBrowserReadRecord)||void 0===a||a.call(t),!0})),_()(this,"actionTextFormat",(function(){var e,t;null===(e=n.rightSideBarService)||void 0===e||e.hide(),null===(t=n.rightSideBarManager)||void 0===t||t.setPropertyEditorShowAction(W.q.TEXT_ADJUST_TOGGLE)})),_()(this,"_actionRevisionRecord",(function(e){var t;return Object(z.c)({opername:Z.e.DOC_EDITOR_TOPBAR_PC,module:Z.d.MORE_MENU,action:Z.b.REVISION_HISTORY}),null===(t=n.historyManager)||void 0===t||t.show({showTab:!oe.b,activeId:null==e?void 0:e.activeId,type:null==e?void 0:e.type}),!0})),_()(this,"_actionExitDocument",(function(){var e,t,a;return Object(z.c)({opername:Z.e.DOC_EDITOR_TOPBAR_PC,module:Z.d.MORE_MENU,action:Z.b.EXIT_DOCUMENT}),null===(e=n.getAppServices().viewableServiceLayer.extensionService)||void 0===e||null===(t=e.getCallBackAdapter())||void 0===t||null===(a=t.exitCurrentDocument)||void 0===a||a.call(t),!0})),_()(this,"actionNativePPT",(function(){return n._actionNativePPT()})),_()(this,"_actionNativePPT",(function(){if(Ae.b.emit(Ae.a.START_EXPORT),Object(z.c)({opername:Z.e.DOC_EDITOR_TOPBAR_PC,module:Z.d.MORE_MENU,action:Z.b.EXPORT,ver11:1}),oe.b)return n.exportNativePPTByAnchor();Object(z.c)({opername:Z.e.DOC_WORD_EDITOR,module:Z.d.EXPORT,action:Z.b.ENTRANCE_CLICK}),n._invokeExportPreferenceDialog(function(){var e=O()(M.a.mark((function e(t,a){var r,i,o,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ee.a)();case 2:e.sent.export({padType:Oe.a.Slide,params:{docId:null!==(r=null===(i=Te.a.DocInfoManager())||void 0===i?void 0:i.globalPadId)&&void 0!==r?r:""},allowDownloadInElectronApp:!0,hasAttachments:Object(ae.a)(n.uiDataServiceRef.presentation).hasAttachment,fontOptions:{hasWebFonts:!(null==a||!a.exportFont),hasTencentSans:null==a?void 0:a.hasTencentSans,hasVipFonts:null==a?void 0:a.hasVipFonts},meta:{title:null!==(o=null===(c=Te.a.SlideTitleManager())||void 0===c?void 0:c.title)&&void 0!==o?o:"",url:window.location.href}});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),!0)})),_()(this,"exportNativePPTByAnchor",(function(){n.getAppServices().viewableServiceLayer.exportManager.promise().then((function(e){var t;e.exportSlideFile((null===(t=Te.a.DocInfoManager())||void 0===t?void 0:t.globalPadId)||"",{successCallback:function(){}})}))})),_()(this,"_actionPerformance",(function(){return Re.b.setItem(Re.a.SAVED_SHOW,!0),J.a.showPerformanceStats(),!0})),_()(this,"_actionLink",(function(){if(!n.getAppServices().viewableServiceLayer.editorInstanceService.checkEditorIsEditing()){var e=n.selectionServiceRef.getSelectedModel();(null==e?void 0:e.type)===F.d.EMPTY?n.getAppServices().viewableServiceLayer.linkManager.insertTextWithLink():n.event.emit(be.a.ENTER_LINK_EDIT)}return!0})),_()(this,"actionSetWatermark",(function(){n.getAppServices().viewableServiceLayer.watermarkManager.promise().then((function(e){e.showDialog()}))})),_()(this,"exportPDF",(function(e,t){if(Ae.b.emit(Ae.a.START_EXPORT),oe.b||Object(le.h)())n._getExportPdfManager().then((function(e){e.getInstance().localExport()}));else if(Y.a.isWxMiniProgram)n._getExportPdfManager().then((function(e){e.getInstance().onlineExport()}));else{if(n.uiDataServiceRef.presentation.children.every((function(e){return!e.isShowInPlay})))return void w.a.confirm({title:ee.a.t("导出PDF失败"),content:ee.a.t("所有页面被隐藏无法导出，请重新选择后重试。"),okText:ee.a.t("我知道了"),cancelText:null});n._invokeExportPreferenceDialog(function(){var a=O()(M.a.mark((function a(r,i){return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n._getExportPreferenceDialog();case 2:a.sent.show({onConfigChange:n._onExportDialogConfigChange,onExport:function(a){n._onExportDialogExportPdf(a,e,t)},attachmentOptions:r,fontOptions:i});case 4:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),!1)}})),_()(this,"exportImage",O()(M.a.mark((function e(){var t,a,r=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.length>0&&void 0!==r[0]?r[0]:{},Ae.b.emit(Ae.a.START_EXPORT),!n.uiDataServiceRef.presentation.children.every((function(e){return!e.isShowInPlay}))){e.next=5;break}return w.a.confirm({title:ee.a.t("生成图片失败"),content:ee.a.t("所有页面被隐藏无法生成图片，请重新选择后重试。"),okText:ee.a.t("我知道了"),cancelText:null}),e.abrupt("return");case 5:return e.next=7,null===(t=n.exportImageManager)||void 0===t?void 0:t.exportImage(a);case 7:case"end":return e.stop()}}),e)})))),_()(this,"actionReplaceLatex",function(){var e=O()(M.a.mark((function e(t){var a,r,i,o,c,u,l,s,d,f,v,p,h,b,g=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=g.length>1&&void 0!==g[1]?g[1]:U.a.REPLACE_WITH_LATEX,N.network.isOnline){e.next=4;break}return n.getAppServices().viewableServiceLayer.addonManager.event.emit(Se.a.ERROR_NETWORK),e.abrupt("return");case 4:if(!Y.a.isMobile){e.next=6;break}return e.abrupt("return");case 6:if(r=n.selectionServiceRef.getSelectedModel(),a!==U.a.REPLACE_WITH_LATEX){e.next=12;break}if((null==r?void 0:r.type)===F.d.IMAGE){e.next=10;break}return e.abrupt("return");case 10:null===(i=n.getAppServices().viewableServiceLayer.addonManager.addonHandler)||void 0===i||i.emitMessageToAddon("$onToolbarClick",{action:"editAddon",data:null==r||null===(o=r.props)||void 0===o?void 0:o.addon},null!==(c=null==r||null===(u=r.props.addon)||void 0===u?void 0:u.aid)&&void 0!==c?c:""),Object(z.c)({opername:Z.e.DOC_FORMULA,module:Z.d.FORMULA_RE_EDITED,action:Z.b.FORMULA_CLICK});case 12:if(a!==U.a.OCR_WITH_LATEX){e.next=41;break}if((null==r?void 0:r.type)===F.d.SHAPE){e.next=15;break}return e.abrupt("return");case 15:if(s=n.getAppServices().editableServiceLayer){e.next=18;break}return e.abrupt("return");case 18:if(d=q.a.show({tip:ee.a.t("正在识别公式...")}),f=null==r||null===(l=r.props.style.fillBackground)||void 0===l?void 0:l.image){e.next=22;break}return e.abrupt("return");case 22:return e.prev=22,e.next=25,Object(te.d)(f.src);case 25:return v=e.sent,e.next=28,s.formulaOcrManager.promise();case 28:return p=e.sent,h=p.formulaOCR,e.next=32,h(v);case 32:b=e.sent,d.close(),"string"==typeof b&&b?n.getAppServices().viewableServiceLayer.addonManager.addonHandler.openFormulaDialog(b):ne.c.getInstance().show({message:ee.a.t("无法识别公式，请重试。"),autoClose:!0,block:!1}),e.next=41;break;case 37:e.prev=37,e.t0=e.catch(22),d.close(),ne.c.getInstance().show({message:ee.a.t("无法识别公式，请重试。"),autoClose:!0,block:!1});case 41:case"end":return e.stop()}}),e,null,[[22,37]])})));return function(t){return e.apply(this,arguments)}}()),_()(this,"addonInsertHandler",(function(e){var t=n.getAddonID(e);n.getAppServices().viewableServiceLayer.addonManager.addonHandler.executeMenuAction(t,e)})),_()(this,"getAddonID",(function(e){return e.substring(0,e.indexOf("_"))})),_()(this,"_invokeExportPreferenceDialog",function(){var e=O()(M.a.mark((function e(t,a){var r,i,o;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a?n._getAttachmentOptions():void 0,e.next=3,n._getFontOptions();case 3:o=e.sent,null===(r=window.log)||void 0===r||r.info("export ppt: attachmentOptions = ",i," fontOptions = ",o),t(i,o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),_()(this,"_getExportPreferenceDialog",O()(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ce.a.extensionService.getExtension(ue.a.name));case 1:case"end":return e.stop()}}),e)})))),_()(this,"_getAttachmentOptions",(function(){var e=Object(ae.a)(n.uiDataServiceRef.presentation),t=e.hasAttachment,a=e.isMediaExceedsLimit;if(t)return{exportAttachment:n.exportPreferenceService.exportAttachmentPreference,hasLargeFile:a}})),_()(this,"_getFontOptions",O()(M.a.mark((function e(){var t,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=n.fontManager)||void 0===t?void 0:t.collectFontsUsingStatus();case 2:if(null==(a=e.sent)||!a.hasCustomFonts){e.next=5;break}return e.abrupt("return",{exportFont:n.exportPreferenceService.exportFontPreference?"embed":void 0,hasTencentSans:a.hasTencentSans,hasVipFonts:a.hasVipFonts});case 5:return e.abrupt("return",void 0);case 6:case"end":return e.stop()}}),e)})))),_()(this,"_onExportDialogExportPptx",(function(e,t){n.getAppServices().viewableServiceLayer.exportManager.promise().then((function(n){var a,r,i,o,c;n.exportSlideFile((null===(a=Te.a.DocInfoManager())||void 0===a?void 0:a.globalPadId)||"",{exportWithAttachment:null!==(r=null===(i=e.attachmentOptions)||void 0===i?void 0:i.exportAttachment)&&void 0!==r&&r,exportWithFonts:null!==(o=null===(c=e.fontOptions)||void 0===c?void 0:c.exportFont)&&void 0!==o&&o,successCallback:t})}))})),_()(this,"_onExportDialogExportPdf",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2?arguments[2]:void 0;n._getExportPdfManager(t).then((function(t){var n,r=void 0;null!=e&&null!==(n=e.fontOptions)&&void 0!==n&&n.exportFont&&(r={switches:JSON.stringify({embedFonts:!0})}),t.getInstance().showDialog(Pe(Pe({},a),r))})).catch((function(e){window.log.error("@tencent/docs-scenario-components-export-pdf load error - ".concat(e)),K.a.show({message:ee.a.t("请求失败，请稍后重试。"),duration:5e3})}))})),_()(this,"_onExportDialogConfigChange",(function(e){var t,a;e&&(null!==(t=e.attachmentOptions)&&void 0!==t&&t.exportAttachment?n.exportPreferenceService.exportAttachmentPreference=!0:n.exportPreferenceService.exportAttachmentPreference=!1,n.exportPreferenceService.exportFontPreference=Boolean(null===(a=e.fontOptions)||void 0===a?void 0:a.exportFont))})),this._event=new $.a,this.observeModelMergeValuesChange(),this.addHistoryManagerEventListener(),t.selectionService&&this.setSelectionServiceDelegate(t.selectionService),t.uiDataService&&this.setUiDataServiceDelegate(t.uiDataService)}var t;return R()(e,[{key:"setSelectionServiceDelegate",value:function(e){this.selectionServiceRef||(this.selectionServiceRef=e,this.selectedMgrRef=e.selectedElements)}},{key:"setUiDataServiceDelegate",value:function(e){this.uiDataServiceRef||(this.uiDataServiceRef=e)}},{key:"setSectionManagerDelegate",value:function(e){this.sectionManager||(this.sectionManager=e)}},{key:"setExportImageManagerDelegate",value:function(e){this.exportImageManager||(this.exportImageManager=e)}},{key:"getSectionManagerDelegate",value:function(){return this.sectionManager}},{key:"setUserPriviledgeServiceDelegate",value:function(e){this.userPriviledgeServiceRef||(this.userPriviledgeServiceRef=e)}},{key:"setMasterLayoutEditServiceDelegate",value:function(e){this.masterLayoutEditServiceRef||(this.masterLayoutEditServiceRef=e)}},{key:"setParagraphManager",value:function(e){this.paragraphManager||(this.paragraphManager=e)}},{key:"setToolbarStateManagerDelegate",value:function(e){this.toolbarStateManager=e}},{key:"hideAllMenu",value:function(){this.hideAllMenuNum+=1}},{key:"observeModelMergeValuesChange",value:function(){var e=this;this.event.on(Ie.a.REFRESH_MENU_VALUES_VALUES,(function(t){e.mergeMenuValuesCacheMap.delete(t),e.mergeMenuValuesCacheMap.set(t,Object(pe.a)(t))}))}},{key:"addHistoryManagerEventListener",value:function(){var e,t;null===(e=this.historyManager)||void 0===e||e.on("show",(function(){var e=G.u.indexOf(U.a.SLIDE_PLAY);-1!==e&&G.u.splice(e,1)})),null===(t=this.historyManager)||void 0===t||t.on("hide",(function(){G.u.indexOf(U.a.SLIDE_PLAY)>=0||G.u.push(U.a.SLIDE_PLAY)}))}},{key:"event",get:function(){return this._event}},{key:"topMenu",value:function(){return this.menu(se.a.TOP_MENU)}},{key:"toolbarMenu",value:function(e){return this.menu(se.a.TOOLBAR,e)}},{key:"propertyMenu",value:function(e){return this.menu(se.a.PROPERTY_BAR,e)}},{key:"stylePanelMenu",value:function(){return this.menu(se.a.STYLE_PANEL)}},{key:"quickSetMenu",value:function(){return this.menu(se.a.QUICK_SETTING)}},{key:"rightMenu",value:function(e){return e?this.rightMenu4Slide():this.menu(se.a.POP_MENU)}},{key:"isGroupItemNeedDisabled",value:function(){return!(this.selectionServiceRef.getSelectedModel()instanceof k.a||this.selectionServiceRef.getSelectedModel()instanceof x.a)}},{key:"showRatioView",value:function(){this.showRatioViewAction+=1}},{key:"disableItemIds",value:function(){var e=this;return this.disableItemIdsCache||(this.disableItemIdsCache=this.getDisableItemIdsNoCache(),Promise.resolve().then((function(){e.disableItemIdsCache=null}))),this.disableItemIdsCache}},{key:"getDisableItemIdsNoCache",value:function(){var e,t,n,a,r,i,o=[{id:U.a.NO_AVAILABLE_ADDON},{id:U.a.RECOMMEND_ADDON},{id:U.a.INSTALLED_ADDON},{id:U.a.FONT_HANDLER},{id:U.a.COLOR_HANDLER},{id:U.a.PIC_HANDLER}];o=this.userPriviledgeServiceRef.pptEditorState===fe.b.EDITABLE?this._disableInEditing(o):this._disableInViewing(o),null!==(e=this.masterLayoutEditServiceRef)&&void 0!==e&&e.isMasterEditType&&(o=this._disableInMaster(o)),N.network.isOnline||(o=this._disableWhenOffline(o));var c=!1;if(this.selectionServiceRef.currentSlideIndex>=0){var u,l=ye.a.CooperationLockManager(),s=null==l?void 0:l.getLockInfoByIndex(this.selectionServiceRef.currentSlideIndex,this.selectionServiceRef.currentSlideType),d=s&&!s.user.isSelf,f=null===(u=this.selectionServiceRef.currentSlide)||void 0===u?void 0:u.preload;(d||f)&&(c=!0,o=o.concat(G.f))}if(null!==(t=this.selectionServiceRef.selectedSlides.selectedArray)&&void 0!==t&&t.some((function(e){return e.isMaster}))&&(o=o.concat(H.D)),null!==(n=this.selectionServiceRef.selectedSlides.selectedArray)&&void 0!==n&&n.some((function(e){return e.isLayout}))){var v=this.selectionServiceRef.selectedSlides.selectedArray.map((function(e){return e.id}));this.uiDataServiceRef.slideModelList.some((function(e){return v.includes(e.layoutId)}))&&(o=o.concat(H.E))}return null!==(a=Te.a.DocInfoManager())&&void 0!==a&&a.isOwner||(o=o.concat(G.x)),(this.userPriviledgeServiceRef.pptEditorState!==fe.b.EDITABLE||c)&&(o=o.concat(G.g)),null!==(r=Te.a.SDKDataServices.CommandManager())&&void 0!==r&&r.canUndo||(o=o.concat(G.i)),null!==(i=Te.a.SDKDataServices.CommandManager())&&void 0!==i&&i.canRedo||(o=o.concat(G.h)),this.isGroupItemNeedDisabled()&&(o=o.concat([{id:U.a.GROUP,title:ee.a.t("组合")}])),o=(o=(o=Object(ie.a)(o,this.selectionServiceRef.getSelectedModel())).concat(this.getGroupItemsNeedDisabled())).concat(this.getDistributeNeedDisabled())}},{key:"getDistributeNeedDisabled",value:function(){var e,t=[];this.selectionServiceRef.getSelectedModel()instanceof k.a&&(2===(null===(e=this.selectedMgrRef.selectedArray)||void 0===e?void 0:e.length)&&(t=t.concat(G.s)));return t}},{key:"getGroupItemsNeedDisabled",value:function(){var e=[{id:U.a.GROUP,title:ee.a.t("组合")},{id:U.a.ADDGROUP,title:ee.a.t("组合")},{id:U.a.REMOVEGROUP,title:ee.a.t("取消组合")}];return this.selectionServiceRef.getSelectedModel()instanceof x.a?e=[{id:U.a.ADDGROUP,title:ee.a.t("组合")}]:this.selectionServiceRef.getSelectedModel()instanceof k.a&&(Object(re.a)(this.selectedMgrRef.selectedArray)&&(e=e.filter((function(e){return e.id===U.a.ADDGROUP}))),Object(re.b)(this.selectedMgrRef.selectedArray)&&(e=e.filter((function(e){return e.id===U.a.REMOVEGROUP})))),e}},{key:"_disableInViewing",value:function(e){var t,n=e;n=e.concat(Object.keys(U.a).map((function(e){return{id:U.a[e]}}))).concat(G.t);var a,r=g()(G.u);(this.disableInViewForExpoprtAndCopy(r),this.userPriviledgeServiceRef.pptEditorState===fe.b.COPYABLE&&(r.find((function(e){return e===U.a.COPY}))||(r.push(U.a.COPY),r.push(U.a.DOWNLOAD_PICTURE))),null!==(t=Te.a.DocInfoManager())&&void 0!==t&&t.isOwner&&Object(me.a)())&&(r.push(U.a.REVISION_RECORD),r.push(U.a.BROWSE_RECORD),r.push(U.a.TRANSFER_OWNERSHIP),1===(null===(a=Te.a.DocInfoManager())||void 0===a?void 0:a.dirty)&&r.push(U.a.APPEAL));return this.changeOwnerSettingInView(r),n=n.filter((function(e){return!r.find((function(t){return t===e.id}))}))}},{key:"disableInViewForExpoprtAndCopy",value:function(e){var t,n;(null===(t=Te.a.PrivilegeManager())||void 0===t?void 0:t.exportable)&&([U.a.EXPORT,U.a.NATIVE_PPT,U.a.EXPORT_PDF,"".concat(U.a.EXPORT_PDF,"-toolbar")].forEach((function(t){e.includes(t)||e.push(t)})),!e.find((function(e){return e===U.a.EXPORT_IMAGE}))&&this.selectionServiceRef.slides.length&&e.push(U.a.EXPORT_IMAGE));(null===(n=Te.a.PrivilegeManager())||void 0===n?void 0:n.canGenerateCopies)&&(e.find((function(e){return e===U.a.GENERATE_COPIES}))||e.push(U.a.GENERATE_COPIES),e.find((function(e){return e===U.a.SAVE_TEMP}))||e.push(U.a.SAVE_TEMP))}},{key:"_disableInMaster",value:function(e){return[U.a.INSERT_ANIMATION,U.a.REVISION_RECORD].forEach((function(t){return!e.find((function(e){return t===e}))&&e.push({id:t})})),e}},{key:"_disableInEditing",value:function(e){var t,n,a,r,i=e,o=null;this.selectionServiceRef.lastMouseDownRegion===de.a.NOTE?o=(null===(a=this.selectionServiceRef.currentSlide)||void 0===a?void 0:a.noteData)||this.selectionServiceRef.getSelectedModel():o=this.selectionServiceRef.selectedSlides.length>0&&(null===(r=this.selectionServiceRef.getSelectedModel())||void 0===r?void 0:r.type)===F.d.EMPTY?this.selectionServiceRef.selectedSlides.selectedArray[0]:this.selectionServiceRef.getSelectedModel();return o&&(i=i.concat(Object(ve.a)(o,{editorInstanceService:this.getAppServices().viewableServiceLayer.editorInstanceService}))||[]),null!==(t=Te.a.DocInfoManager())&&void 0!==t&&t.isOwner||(i=i.concat(G.c)),this.selectionServiceRef.slides.length||i.push({id:U.a.EXPORT_IMAGE}),null!==(n=Te.a.PrivilegeManager())&&void 0!==n&&n.copyable||![de.a.EDITOR,de.a.NOTE].includes(this.selectionServiceRef.lastMouseDownRegion)||i.push({id:U.a.CUT},{id:U.a.COPY}),i}},{key:"rightClickTWD",value:function(){Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.INSERT_SLIDE_ENTRY,action:Z.b.INSERT_SLIDE_ENTRY_CLICK})}},{key:"rightMenu4Slide",value:function(){var e=this;this.rightClickTWD();var t=this.selectionServiceRef.currentSlide;if(t){var n=Object(ve.b)(se.a.POP_MENU,t);if(this.userPriviledgeServiceRef.pptEditorState>=fe.b.COPYABLE){var a=G.u;n=n.filter((function(e){return e.id===U.a.COPY?e:a.find((function(t){return t===e.id}))}))}return{type:t.type,items:n,values:Object(pe.a)(t),callback:function(t,n,a,r){return Object(he.a)(e,{menuType:t,actionType:n,values:a,extraOption:r})}}}}},{key:"rightMenu4Layout",value:function(){var e=this,t=this.selectionServiceRef.currentSlide;if(t){var n=Object(ve.b)(se.a.POP_MENU,t);return{type:t.type,items:n,values:Object(pe.a)(t),callback:function(t,n,a,r){return Object(he.a)(e,{menuType:t,actionType:n,values:a,extraOption:r})}}}}},{key:"getRightMenuFromModel",value:function(e){var t=this;this.rightClickTWD();var n=Object(ve.b)(se.a.POP_MENU,e);if(this.userPriviledgeServiceRef.pptEditorState>=fe.b.COPYABLE){var a=G.u;n=n.filter((function(e){return a.find((function(t){return t===e.id}))}))}return{type:e.type,items:n,values:Object(pe.a)(e),callback:function(e,n,a,r){return Object(he.a)(t,{menuType:e,actionType:n,values:a,extraOption:r})}}}},{key:"getRightMenuFromGuides",value:function(e){var t=this;this.rightClickTWD();var n=Object(ve.b)(se.a.POP_MENU,e);return{type:e.type,items:n,values:{},callback:function(e,n,a,r){return Object(he.a)(t,{menuType:e,actionType:n,values:a,extraOption:r})}}}},{key:"getRightMenuFromTheme",value:function(e){var t=this;this.rightClickTWD();var n=Object(ve.b)(se.a.POP_MENU,e);return{type:F.d.THEME,items:n,values:{},callback:function(e,n,a,r){return Object(he.a)(t,{menuType:e,actionType:n,values:a,extraOption:r})}}}},{key:"rightMenu4SlideGap",value:function(e,t){var n=new j.a({gapIndex:e,isFromMasterLayout:t});return this.getRightMenuFromModel(n)}},{key:"rightMenu4Section",value:function(e){var t=new B.a({sectionIndex:e});return this.getRightMenuFromModel(t)}},{key:"menu",value:function(e,t){var n,a,r=this,i=null!=t?t:this.selectionServiceRef.getSelectedModel();if(!i)return{type:"",items:[],values:[],callback:function(){}};var o=Object(pe.a)(i),c=Object(ve.b)(e,i),u=null===(n=this.getAppServices().editableServiceLayer)||void 0===n?void 0:n.menuDataWorkerManager;return null==u||u.processItemData(c,e,null===(a=this.toolbarStateManager)||void 0===a?void 0:a.getToolbarMode()),o=(null==u?void 0:u.processMenuItemValues(o,e))||o,{type:i.type,items:c,values:o,callback:function(e,t,n,a){return!!Object(he.b)(i,{menuType:e,actionType:t,values:n,extraOption:a})||Object(he.a)(r,{menuType:e,actionType:t,values:n,extraOption:a})}}}},{key:"report",value:function(e,t){switch(t){case U.a.ADDGROUP:this._reportAddGroup(e);break;case U.a.REMOVEGROUP:this._reportRemoveGroup(e)}}},{key:"_reportRemoveGroup",value:function(e){switch(Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.REMOVE_COMBINATION_TOTAL_UV}),e){case se.a.TOOLBAR:Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.REMOVE_COMBINATION_TOOL});break;case se.a.TOP_MENU:Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.REMOVE_COMBINATION_COM_MENU});break;case se.a.POP_MENU:Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.REMOVE_COMBINATION_COM_CLICK})}}},{key:"_reportAddGroup",value:function(e){switch(Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.COMBINATION_TOTAL_UV}),e){case se.a.TOOLBAR:Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.COMBINATION_TOOL});break;case se.a.TOP_MENU:Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.COMBINATION_MENU});break;case se.a.POP_MENU:Object(z.c)({opername:Z.e.DOC_PPT,module:Z.d.PPT_PC_EDIT_COMBINATION,action:Z.b.COMBINATION_CLICK})}}},{key:"_getExportPdfManager",value:(t=O()(M.a.mark((function e(){var t=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(!(t.length>0&&void 0!==t[0])||t[0])&&Object(z.c)({opername:Z.e.DOC_EDITOR_TOPBAR_PC,module:Z.d.MORE_MENU,action:Z.b.EXPORT,ver11:2}),e.next=4,Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55")]).then(n.t.bind(null,"0d1ab71e9c",7));case 4:return e.abrupt("return",e.sent.ExportPDFManager);case 5:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"getAppServices",value:function(){return ge.a.getInstance().getAppServices()}},{key:"_disableWhenOffline",value:function(e){return[U.a.INTELLIGENT_TOOL,U.a.ADDON,U.a.EXPORT_IMAGE,U.a.OPEN_MUTI_PICTURE_EXPORT,U.a.PDF_TRANSFORM,!Y.a.isTencentDocDesktopApp&&U.a.INSERT_CHART,U.a.DOWNLOAD_ATTACHMENT,!_e.a.IS_PC_LOCAL_EDIT&&U.a.DOWNLOAD_PICTURE,U.a.OCR_PICTURE,U.a.OCR_WITH_LATEX,U.a.IMPORT_SLIDE].filter(Boolean).forEach((function(t){return!e.find((function(e){return t===e}))&&e.push({id:t})})),e}},{key:"changeOwnerSettingInView",value:function(e){var t;if(null!==(t=Te.a.DocInfoManager())&&void 0!==t&&t.isOwner){var n=e.indexOf(U.a.REVISION_RECORD);-1!==n&&e.splice(n,1),[U.a.PERMISSION_MENU,U.a.PERMISSION_SETTING,U.a.ADVANCED_PERMISSION,U.a.SET_WATER_MARK,U.a.TRANSFER_OWNERSHIP].forEach((function(t){return e.push(t)}))}}}]),e}(),s=P()(l.prototype,"asyncMenuItemReady",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=P()(l.prototype,"isMenuShown",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=P()(l.prototype,"hideAllMenuNum",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=P()(l.prototype,"isColorPicking",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=P()(l.prototype,"showRatioViewAction",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=P()(l.prototype,"isDropdownShown",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l)},d115d284c3:function(e,t,n){"use strict";n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return D}));var a=n("ea3a38d9d4"),r=(n("b8217400dc"),n("e6f68cdf2e"),n("8a35b54c1d"),n("d7a2286b24")),i=n("4e7af1026b"),o=n("e0e8dd9366"),c=n("a6c7240c95"),u=n("382929c8da");function l(e){var t,n,a=e.type;return[o.d.EMPTY,o.d.GAP].includes(a)?c.i.getGroupListByType(c.f.NONE):[o.d.MULTIPLY,o.d.GROUP].includes(a)?c.i.getGroupListByType(c.f.MULTIPLE):[o.d.CONNECTOR].includes(a)?c.i.getGroupListByType(c.f.CONNECTOR):[o.d.TABLE].includes(a)?c.i.getGroupListByType(c.f.TABLE):[o.d.NOTE].includes(a)?(t=c.i.getGroupListByType(c.f.NOTE),n=[u.a.VERTICAL_ALIGN,u.a.FORMAT_BRUSH,u.a.CLEAR_FORMAT,u.a.ROW_SPACE],t.filter((function(e){return!n.includes(e.id)}))):[o.d.IMAGE].includes(a)?function(e){var t=c.i.getGroupListByType(c.f.PICTURE);if(e.isMedia()){var n=[!(e.isVideo()&&r.default.getInstance().getConfig(i.k.tailorVideo))&&u.a.TAILOR_PIC,u.a.TRANSPARENCY].filter(Boolean);t=t.filter((function(e){return!n.includes(e.id)})),t=c.i.filterNeighbourDivider(t)}return t}(e):[o.d.SHAPE].includes(a)?function(e){var t,n,a,r=c.i.getGroupListByType(c.f.SHAPE),i=null===(t=e.props)||void 0===t||null===(n=t.style)||void 0===n||null===(a=n.fillBackground)||void 0===a?void 0:a.image;i&&!e.isTextMath&&(r=i.tile?c.i.getGroupListByType(o.a):c.i.getGroupListByType(o.b));return r}(e):[]}var s=n("fb75408061"),d=n("a831459dec");function f(e){var t=e.type;return[o.d.EMPTY].includes(t)?d.a:[o.d.NOTE].includes(t)?d.e:[o.d.CONNECTOR].includes(t)?d.c:[o.d.TABLE].includes(t)?d.f:[o.d.CHART].includes(t)?[]:[o.d.IMAGE].includes(t)?e.isMedia()?[]:d.d:[o.d.SHAPE].includes(t)?function(e){var t,n,a=e;if((null===(t=a.props)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.displayMode)===s.b.IFRAME)return[];if(a.isAttachment()){if(a.isAttachmentUploaded()){var r=[u.a.TEXT_ADJUST,u.a.SIZE_ADJUST];return d.b.filter((function(e){return!r.includes(e.id)}))}return[]}return d.b}(e):d.b}var v=n("0d08e46cdf"),p=(n("75563bc376"),n("963f2eaace"),n("22569efd03"),n("63513d8b56"),n("3bf1976a4f"),n("c9c92622ff")),h=n("d9812f1c6f"),b=n("bf895b60ba"),g=n("f4f8c95f42"),E=n("f9193d718f"),O=n("2ba7871556"),m=n("086c96a9ce");function T(e){var t=e.type;return[o.d.MULTIPLY].includes(t)?function(e){var t=Object(m.b)(e);if(null!=t&&t.length)return t.some((function(e){var t;return[o.d.IMAGE,o.d.SHAPE].includes(e.type)&&(null===(t=e.parent)||void 0===t?void 0:t.type)!==o.d.GROUP}))?g.b:g.c;return g.d}(e):[o.d.GROUP].includes(t)?function(e){if(Object(m.b)(e).length)return Object(p.v)(e)?g.f:g.h;return Object(p.v)(e)?g.e:g.g}(e):[o.d.TABLE].includes(t)?function(e){var t=e.getEditingElement();if(null!=t&&t.isExpanded())return g.q;return g.p}(e):[o.d.IMAGE].includes(t)?function(e){var t,n,a;if(e.props.addon&&"latex"===e.props.addon.type){var r,i=e.props.addon.aid,o=(null===(r=y().addonHandler.addonQuickItemsMap)||void 0===r?void 0:r.get(i))||["editAddon"];return g.l(o)}if(null!==(t=(n=e).isMedia)&&void 0!==t&&t.call(n))return Object(h.h)()&&(Object(h.j)()||Object(h.k)())?Object(b.a)(g.r,[u.a.DOWNLOAD_ATTACHMENT,u.a.DIVIDER]):g.r;var c=g.j.find((function(e){return e.id===u.a.ADDON}));if(null!=c&&c.dropdown){var l=y().addonHandler,s=l.addonSceneItemsMap,d=l.formatAddonSceneList,f=l.addonScenes;c.dropdown.data=d(s.get(f.IMAGE),!0)}var p=g.j.slice();Object(v.b)(e)&&(p=p.filter((function(e){return e.id!==u.a.OCR_PICTURE})));if(null!==(a=S())&&void 0!==a&&a.checkIsSupportAI()){var E,O=p.findIndex((function(e){return e.id===u.a.REPLACE_PICTURE}));O>=0&&p.splice(O,1,g.k);var m=null===(E=e.sdkData)||void 0===E?void 0:E.getDescription();p=m&&"image"===m.type&&!m.sourceUrl?p.concat(g.s):p.concat(g.t)}return p}(e):[o.d.SHAPE].includes(t)?function(e){var t,n,a,r,i,o=(null===(t=e.props)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.displayMode)===s.b.IFRAME||!1;if(o)return[];if(e.isAttachment())return e.isAttachmentUploaded()?g.r:[];if(e.isTextMath)return g.l(["latexOCR"]);if(null!==(a=e.editorInstance)&&void 0!==a&&a.isExpanded())return g.q;var c=null===(r=(i=e).getBackgroundFill)||void 0===r?void 0:r.call(i).getFillType();if(c===O.b.ImageFill){var l,d=g.i.slice();if(null!==(l=S())&&void 0!==l&&l.checkIsSupportAI()){var f,v=d.findIndex((function(e){return e.id===u.a.REPLACE_PICTURE}));v>=0&&d.splice(v,1,g.k);var p=null===(f=e.sdkData)||void 0===f?void 0:f.getDescription();return p&&"image"===p.type&&!p.sourceUrl?d.concat(g.s):d.concat(g.t)}return d}return g.m}(e):[o.d.CHART].includes(t)?g.a:[o.d.SMART_ART].includes(t)?g.n:[]}function y(){return E.a.getInstance().getAppServices().viewableServiceLayer.addonManager}function S(){var e;return null===(e=E.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.aiController}var I=n("029ea2b91c"),R=n("debba787c1"),A=(n("8ee19818c4"),n("342844cefa"),n("a2a09da1e3"),n("6e20b6a7d8"),n("fce3077cdf"),n("0acdc5834b"),n("5cf98436e9")),_=n("7d1df7d0fb"),C=n("0442e400dc"),P=1;function L(e,t){var n=e.type;return[o.d.CHART].includes(n)?R.b:[o.d.EMPTY].includes(n)?R.j:[o.d.CONNECTOR].includes(n)?R.e:[o.d.GAP].includes(n)?R.j:[o.d.GROUP].includes(n)?M(Object(_.a)(e,!0),t,e):[o.d.SMART_ART].includes(n)?function(e){var t,n,a,r,i,c,l=[];l.concat(R.n);var s=null==e||null===(t=e.sdkData)||void 0===t||null===(n=t.props)||void 0===n||null===(a=n.diagram)||void 0===a||null===(r=a.drawing)||void 0===r||null===(i=r.spTree)||void 0===i?void 0:i.egGroupShapeMsDsp,d=function(e){if(!Array.isArray(e)||0===e.length)return console.error("Invalid input: The parameter should be a non-empty array."),!1;for(var t=0;t<e.length;t++){var n,a,r,i,o,c;if(null!==(n=e[t])&&void 0!==n&&n.sp&&null!==(a=e[t])&&void 0!==a&&null!==(r=a.sp)&&void 0!==r&&r.txXfrm&&void 0!==(null===(i=e[t])||void 0===i||null===(o=i.sp)||void 0===o||null===(c=o.txXfrm)||void 0===c?void 0:c.rot))return!0}return!1};((null===(c=e.parent)||void 0===c?void 0:c.type)===o.d.GROUP||d(s))&&l.push({id:u.a.CONVERT_TO_GROUP});return l}(e):[o.d.NOTE].includes(n)?R.k:[o.d.IMAGE].includes(n)?Object(p.b)(e)?R.a.concat([{id:u.a.INSERT_ANIMATION}]):e.isMedia()?e.isVideo()&&r.default.getInstance().getConfig(i.k.tailorVideo)?R.a.filter((function(e){return e.id!==u.a.TAILOR_PIC})):R.a:R.l:[o.d.SLIDE,o.d.MASTER,o.d.LAYOUT].includes(n)?R.m:[o.d.TABLE].includes(n)?function(e,t){var n=[];e.canMergeSelectedCells()||n.push({id:u.a.MERGE_CELL});var a=R.o;t.checkEditorIsEditing()&&(a=a.filter((function(e){return e.id!==u.a.LINK})));return n.concat(a)}(e,t.editorInstanceService):[o.d.SHAPE].includes(n)?function(e){var t,n;if(e.isAttachment())return e.isAttachmentUploaded()?Object(p.h)(e)||Object(p.d)(e)?R.a.concat([{id:u.a.INSERT_ANIMATION}]):R.a:[{id:u.a.INSERT_ANIMATION}].concat(R.a);var a=(null===(t=e.props)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.displayMode)===s.b.IFRAME||!1,r=a?R.a:R.r,i=e.getBackgroundFill().getFillType();if(i===O.b.ImageFill&&!e.isTextMath){var o;r=(null===(o=e.getBackgroundFill().getCurrentFill())||void 0===o?void 0:o.fillInfo).tile?R.q:R.p}return r}(e):[o.d.MULTIPLY].includes(n)?function(e,t){var n=[u.a.FONT,u.a.FONTSIZE,u.a.FONTSIZE_INCREASE,u.a.BOLD,u.a.ITALIC,u.a.UNDERLINE,u.a.DELETELINE,u.a.SUBSCRIPT,u.a.SUPERSCRIPT,C.a.HORIZONTAL_LEFT,C.a.HORIZONTAL_CENTER,C.a.HORIZONTAL_RIGHT,C.a.HORIZONTAL_JUSTIFY,C.a.HORIZONTAL_DISTRIBUTE,u.a.FORECOLOR,u.a.BACKCOLOR,u.a.FILLCOLOR,u.a.BORDERCOLOR,u.a.HORIZONTAL_ALIGN,u.a.VERTICAL_ALIGN,u.a.ITEMNUMBER,u.a.DIGITNUMBER,u.a.ROW_SPACE,u.a.PARAGRAPH_MORE,u.a.BORDERSTYLE,u.a.PIC_FORMAT],a=[C.a.VERTICAL_TOP,C.a.VERTICAL_CENTER,C.a.VERTICAL_BOTTOM],r=e.selectedModels.filter((function(e){return Object(p.o)(e)})).length;r>0&&n.push(u.a.SHAPE_FORMAT);var i=Object(A.a)(e);Object.keys(i).forEach((function(e){var t=n.indexOf(e);t>=0&&n.splice(t,1)})),e.selectedModels.some((function(e){return Object(p.F)(e)}))&&R.a.forEach((function(e){var t=e.id;return n.push(t)}));var o=Object(m.b)(e).length;o&&o!==P&&n.push(u.a.TRANSPARENCY);n.includes(u.a.VERTICAL_ALIGN)&&n.push.apply(n,a);var c=n.map((function(e){return{id:e}})),l=M(e.selectedModels,t,e);return c.concat(l)}(e,t):[]}function M(e,t,n){if(e){var a={};e.forEach((function(e){a[e.type]=L(e,t)}));var r=Object.values(a);if(r.length>0){var i=r.filter((function(e,t){return 0!==t})).reduce((function(e,t){return function(e,t){var n=[];e&&t&&e.forEach((function(e){for(var a=0;a<t.length;a++)if(e.id===t[a].id){n.push(e);break}}));return n}(e,t)}),r[0]),o=R.d.concat(i),c=Object(m.b)(n).length;return c&&(o=c===P?o.filter((function(e){return![u.a.FORMAT_PIC,u.a.PIC_FORMAT,u.a.TRANSPARENCY].includes(e.id)})):o.filter((function(e){return e.id!==u.a.FORMAT_PIC}))),o}}return[]}function D(e,t){return e===a.a.TOP_MENU?R.w():e===a.a.TOOLBAR?l(t):e===a.a.PROPERTY_BAR?f(t):e===a.a.POP_MENU?Object(v.a)(t):e===a.a.QUICK_SETTING?T(t):e===a.a.STYLE_PANEL?I.a:e===a.a.GUIDES_SETTING||e===a.a.THEME_SETTING?Object(v.a)(t):[]}},d1f05b304b:function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=(n("8e7cce0ada"),n("c6244f7705"),n("85d48ef22b"),n("ab67fd3ad5"),n("2a6f332b5e"),n("73b854064b"),n("bd29e2df90")),s=n.n(l),d=n("ab5eb40518"),f=n.n(d),v=n("1b4cdd6a36"),p=n.n(v),h=n("f8aba17285");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var g=function(e){s()(n,e);var t=b(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"getObserveData",value:function(){return{selected:this.model.selected,previewChange:this.model.previewChange,selectedRange:this.model.selectedRange,operationFrame:this.model.operationFrame}}}]),n}(h.a);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var O=function(e){s()(n,e);var t=E(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"getObserveData",value:function(){var e;return{isEditing:this.model.isEditing,highlightChanged:null===(e=this.model.editorDatahandler)||void 0===e?void 0:e.uiUpdate}}}]),n}(h.a),m=n("547611bd96"),T=n.n(m),y=(n("a2a09da1e3"),n("d5c3deb8c7")),S=n("730207179f");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var R=function(e){s()(n,e);var t=I(n);function n(e,a){var i;return r()(this,n),i=t.call(this,e,a),u()(T()(i),"mediaManager",void 0),i.mediaManager=a.mediaManager,i}return o()(n,[{key:"getObserveData",value:function(){var e,t,n=this.model,a=n.operationFrame,r=n.operatingGraphicInfo,i=n.previewChange,o=n.editorEnterFocus,c=Object(S.a)(this.model.props.addon,"displayMode"),u=this.model.isAttachmentShown;return{selected:this.model.selected,editorEnterFocus:o,operatingGraphicInfo:r,operationFrame:a,previewChange:i,displayMode:c,isAttachmentShown:u,prevIframeSelected:this.model.selected&&(null===(e=this.mediaManager)||void 0===e?void 0:e.prevIframeSelected),currentIframeSelected:this.model.selected&&(null===(t=this.mediaManager)||void 0===t?void 0:t.currentIframeSelected)}}},{key:"addLocalChangeObserver",value:function(e){var t=this;e&&this.callbacks.indexOf(e)<0&&this.callbacks.push(e),this.callbacks.length>0&&!this.actionDispose&&(this.actionDispose=Object(y.r)((function(){return t.getObserveData()}),(function(e){var n,a;t.notifyLocalChange(e,{updateState:null===(n=(a=t.model).getUpdateState)||void 0===n?void 0:n.call(a)})})))}}]),n}(h.a),A=n("8f58e78419"),_=n.n(A),C=n("d9812f1c6f"),P=n("3825cc7c15");function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var M=function(e){s()(n,e);var t=L(n);function n(e,a){var i;return r()(this,n),i=t.call(this,e,a),u()(T()(i),"mediaManager",void 0),u()(T()(i),"editingStateManager",void 0),i.mediaManager=a.mediaManager,i.editingStateManager=a.editingStateManager,i}return o()(n,[{key:"getObserveData",value:function(){var e,t,n=this.model,a=n.operationFrame,r=n.operatingGraphicInfo;return{operationFrame:a,previewChange:n.previewChange,operatingGraphicInfo:r,selected:this.model.selected,isCroping:this.model.selected&&(null===(e=this.editingStateManager)||void 0===e?void 0:e.isCroping),isEditMode:C.a.isMobile&&(null===(t=this.mediaManager)||void 0===t?void 0:t.isEditMode)&&_()(this.model,"props.src")&&"gif"===Object(P.c)(this.model.props.src,"_type")}}}]),n}(h.a);function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var w=function(e){s()(n,e);var t=D(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"getObserveData",value:function(e){return{selected:e?void 0:this.model.selected,operationFrame:this.model.operationFrame,previewChange:this.model.previewChange,refreshGroupByChildrenWithoutChangeSet:e?this.model.refreshGroupByChildrenWithoutChangeSet:void 0}}}]),n}(h.a),N=n("6ff710444e");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var x=function(e){s()(n,e);var t=k(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"getObserveData",value:function(){var e=this.model,t=e.operationFrame,n=e.operatingGraphicInfo,a=e.previewChange;return{selected:this.model.selected,operationFrame:t,operatingGraphicInfo:n,previewChange:a}}}]),n}(h.a);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var U=function(e){s()(n,e);var t=F(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"getObserveData",value:function(e){return{selected:e?void 0:this.model.selected,operationFrame:this.model.operationFrame,previewChange:this.model.previewChange,refreshGroupByChildrenWithoutChangeSet:e?this.model.refreshGroupByChildrenWithoutChangeSet:void 0}}}]),n}(h.a),j=n("e0e8dd9366"),B=new WeakMap,G=function(){function e(){r()(this,e)}return o()(e,null,[{key:"createObserver",value:function(t){var n=B.get(t);if(!n){var a=e.getObserverClass(t),r=e.getObserverClassOptions(t);a&&(n=new a(t,r),B.set(t,n))}return n}},{key:"setMediaManagerDelegate",value:function(t){e.mediaManager||(e.mediaManager=t)}},{key:"setEditingStateManagerDelegate",value:function(t){e.editingStateManager||(e.editingStateManager=t)}},{key:"getObserverClass",value:function(e){var t;return(t={},u()(t,j.d.CONNECTOR,x),u()(t,j.d.GROUP,w),u()(t,j.d.IMAGE,M),u()(t,j.d.TABLE,g),u()(t,j.d.SHAPE,e.inTable?O:R),u()(t,j.d.CHART,N.b),u()(t,j.d.SMART_ART,U),t)[e.type]||null}},{key:"getObserverClassOptions",value:function(t){switch(t.type){case j.d.SHAPE:return{mediaManager:e.mediaManager};case j.d.IMAGE:return{editingStateManager:e.editingStateManager,mediaManager:e.mediaManager};default:return{}}}}]),e}();u()(G,"mediaManager",void 0),u()(G,"editingStateManager",void 0)},daef0859e7:function(e,t,n){"use strict";n.d(t,"a",(function(){return mt})),n.d(t,"b",(function(){return Tt}));n("b8217400dc"),n("e6f68cdf2e");var a=n("e0e8dd9366"),r=n("85d0a7609b"),i=n.n(r),o=n("382929c8da"),c=i()({},o.a.FILLCOLOR,(function(){}));function u(e,t){var n=t.actionType;return!!c[n]&&(c[n](),!0)}var l,s=n("176815363d"),d=n.n(s),f=n("3ef2352f0b"),v=n.n(f),p=(n("c6244f7705"),n("081c8cafea"),n("6c458f1652"),n("8e7cce0ada"),n("2a6f332b5e"),n("3bf1976a4f"),n("4bbb5840d5"),n("fb75408061")),h=n("9da6335152"),b=n("17b68c2613"),g=n("dca2cfac94"),E=n("d3d31c86eb"),O=n("647724681b"),m=n("0974c697cc"),T=n("3b24c833e2"),y=n("ec5cae33cb"),S=n("f9193d718f"),I=n("ab17200d42");function R(){return A.apply(this,arguments)}function A(){return(A=d()(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=S.a.getInstance().getAppServices().editableServiceLayer)||void 0===t||null===(n=t.copyPasteImageService)||void 0===n?void 0:n.promise());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _,C=(l={},i()(l,o.a.ROTATE,(function(e){e.handleRotate()})),i()(l,o.a.DOWNLOAD_PICTURE,(function(e){b.a.downloadImg(e.props.src)})),i()(l,o.a.DOWNLOAD_ATTACHMENT,(function(e){if(e.isAttachment()||e.isMedia()){var t,n,a,r=(null===(t=e.video)||void 0===t?void 0:t.link)||(null===(n=e.audio)||void 0===n?void 0:n.link)||(null===(a=e.props.attachment)||void 0===a?void 0:a.objKey);g.c.getInstance().download(r),Object(E.c)({opername:h.e.DOC_WORD_EDITOR,module:h.d.LOCAL_FILES,action:h.b.DOWNLOAD_CLICK})}})),i()(l,o.a.REPLACE_PICTURE,(function(e,t){var n=t.values;e.handleReplacePicture(n)})),i()(l,o.a.OCR_PICTURE,(function(e,t){var n,a,r=t.values;null===(n=null===(a=S.a.getInstance().getAppServices().editableServiceLayer)||void 0===a?void 0:a.ocrService)||void 0===n||n.promise().then((function(t){return t.showOcrRightBar(e,void 0,r)}))})),i()(l,o.a.INSERT_PICTURE,(function(e,t){var n=t.values,a=t.extraOption;e.handleAlpha(n,a)})),i()(l,o.a.REGULATE,(function(e,t){var n,a=t.values,r=t.extraOption;null===(n=e.getImageEffect)||void 0===n||n.call(e).handleImageEffect(a,r)})),i()(l,o.a.PICTURE_COLOR,(function(e,t){var n,a=t.values,r=t.extraOption;null===(n=e.getImageEffect)||void 0===n||n.call(e).handleImageEffect(a,r)})),i()(l,o.a.REMOVE_LINK,(function(e){e.getLink().removeLink()})),i()(l,o.a.EDIT_LINK,(function(e,t){var n=t.values;e.getLink().updateLink({href:n})})),i()(l,o.a.FILE_COVER,d()(v.a.mark((function e(){var t,n,a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=t.ImageEditManager,a=n.getInstance(),null==(r=document.getElementById("select_pic_input_local_video"))||r.click(),a.imageReplaceAction=1,a.imageReplacing=!0,a.clipDataWaiting=!1;case 12:case"end":return e.stop()}}),e)})))),i()(l,o.a.VIDEO_COVER,(_=d()(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I.d){e.next=3;break}return console.warn("can not support wcjs video player"),e.abrupt("return");case 3:return e.next=5,Object(m.a)("".concat(y.a.EDITOR,"-").concat(t.key)).catch((function(){}));case 5:if(n=e.sent){e.next=9;break}return console.warn("can not set video cover: no blob"),e.abrupt("return");case 9:Object(T.a)({blob:n}).then((function(e){var n=e.url,a=new Image;a.onload=function(){t.handleReplacePicture([{width:a.width,height:a.height,src:a.src,imageType:"jpeg"}])},a.src=n})).catch((function(){console.error("upload file error")}));case 10:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)})),i()(l,o.a.RESET_COVER,(function(e){var t,n;if(null!==(t=e.video)&&void 0!==t&&t.link){var a=e.video.link,r=O.a.VideoImageMap.get(a),i=O.a.VideoSizeMap.get(a);r&&i?e.handleReplacePicture([{width:i.width,height:i.height,src:r,imageType:"jpeg"}]):O.a.setVideoImageAndSize(null===(n=e.video)||void 0===n?void 0:n.link).then((function(){var t=O.a.VideoImageMap.get(a),n=O.a.VideoSizeMap.get(a);t&&n&&e.handleReplacePicture([{width:n.width,height:n.height,src:t,imageType:"jpeg"}])}))}})),l);function P(e,t){var n,a,r,i,c=t.actionType;return C[c]?(C[c](e,t),!0):!c.startsWith(o.a.TAILOR_PIC)||null!=t&&null!==(n=t.extraOption)&&void 0!==n&&n.isMultiGroup?!!c.startsWith(p.a)&&(S.a.getInstance().getAppServices().viewableServiceLayer.addonManager.addonHandler.handleAddonSceneItemClick(c,{ver9:h.m.DETAIL_PIC_RIGHT_CLK}),!0):(null===(a=e.getImageCrop)||void 0===a||null===(r=(i=a.call(e)).handleCrop)||void 0===r||r.call(i,c),!0)}n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var L,M=n("730207179f"),D=n("14c02e2331"),w=n("3344f1a2e7"),N=n("c4c5a68ab8"),k=n("0442e400dc");function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=(L={},i()(L,o.a.FONTSIZE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-size",t,n)})),i()(L,o.a.FONTSIZE_UP,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-size-up",t,n)})),i()(L,o.a.FONTSIZE_DOWN,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-size-down",t,n)})),i()(L,o.a.FONT,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-family",t,n)})),i()(L,o.a.BOLD,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-bold",t,n)})),i()(L,o.a.ITALIC,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-italic",t,n)})),i()(L,o.a.UNDERLINE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-underline",t,n)})),i()(L,o.a.DELETELINE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-delete",t,n)})),i()(L,o.a.SUBSCRIPT,(function(e,t,n){var a,r=t?D.t:0;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("text-baseline-offset",r,n)})),i()(L,o.a.SUPERSCRIPT,(function(e,t,n){var a,r=t?D.v:0;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("text-baseline-offset",r,n)})),i()(L,o.a.FORECOLOR,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-color",t,n)})),i()(L,o.a.BACKCOLOR,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-background",t,n)})),i()(L,o.a.VERTICAL_ALIGN,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-vertical-align",t,n)})),i()(L,o.a.HORIZONTAL_ALIGN,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-horizontal-align",t,n)})),i()(L,o.a.HORIZONTAL_LEFT,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-horizontal-align",t,n)})),i()(L,o.a.HORIZONTAL_CENTER,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-horizontal-align",t,n)})),i()(L,o.a.HORIZONTAL_RIGHT,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-horizontal-align",t,n)})),i()(L,o.a.HORIZONTAL_JUSTIFY,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-horizontal-align",t,n)})),i()(L,o.a.HORIZONTAL_DISTRIBUTE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("font-horizontal-align",t,n)})),i()(L,o.a.UPDATE_PARAGRAPH_PROPS,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("paragraph-props",t,n)})),i()(L,o.a.ROW_SPACE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("paragraph-props",{PPTLineHeight:t,lineHeight:t*w.d,lineHeightIs:"percent"},n)})),i()(L,o.a.ROW_SPACE_ABSOLUTE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("paragraph-props",{PPTLineHeight:null,lineHeight:t,lineHeightType:"absolute"},n)})),i()(L,o.a.MARGIN_LEFT,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("margin-left",t,n)})),i()(L,o.a.TEXT_INDENT,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("text-indent",t,n)})),i()(L,o.a.SPACE_BEFORE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("space-before",t,n)})),i()(L,o.a.SPACE_AFTER,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("space-after",t,n)})),i()(L,o.a.TAB_SIZE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("tab-size",t,n)})),i()(L,o.a.TAB_LIST,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("tab-list",t,n)})),i()(L,o.a.ITEMNUMBER,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations(o.a.BULLET_SET,{type:t},n)})),i()(L,o.a.DIGITNUMBER,(function(e,t,n){var a,r,i,c=((null===(a=e.getMenuManager())||void 0===a||null===(r=a.toolbarMenu())||void 0===r?void 0:r.values)||{})[o.a.BULLET_START_NUMBER]||1;return null===(i=e.editorInstance)||void 0===i?void 0:i.operations(o.a.BULLET_SET,{type:t,startNumber:c},n)})),i()(L,o.a.BULLET_SET,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations(o.a.BULLET_SET,t,n)})),i()(L,o.a.INDENT,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("indent",t,n)})),i()(L,k.b.INDENT_INCREASE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("indent",t,n)})),i()(L,k.b.INDENT_REDUCE,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations("indent",t,n)})),i()(L,o.a.FONT_EFFECT,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations(D.n,t,n)})),i()(L,o.a.TEXT_DIRECTION,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations(o.a.TEXT_DIRECTION,t,n)})),i()(L,o.a.FONT_REFRESH,(function(e){var t;return null===(t=e.editorInstance)||void 0===t?void 0:t.refreshEditorByProps()})),i()(L,o.a.FONT_FILL,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations(D.o,t,n)})),i()(L,o.a.FONT_BORDER,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations(D.m,t,n)})),i()(L,o.a.LINK,(function(e){var t;return null===(t=e.editorInstance)||void 0===t?void 0:t.setTextLink()})),i()(L,o.a.ENTER_EDITOR,(function(e){var t,n;e.editorInstance?null===(t=(n=e.editorInstance).setFocusOrClick)||void 0===t||t.call(n):Object(M.b)(self,"editorEnterFocus",!0)})),i()(L,o.a.UNDO,(function(e){var t;null===(t=e.editorInstance)||void 0===t||t.triggerUndo()})),i()(L,o.a.REDO,(function(e){var t;null===(t=e.editorInstance)||void 0===t||t.triggerRedo()})),i()(L,o.a.TEXT_ADJUST,(function(e,t){var n;return null===(n=e.editorInstance)||void 0===n||n.triggerBlur(),e.updateTextAdjust(t)})),i()(L,o.a.PADDING_ADJUST,(function(e,t){var n;return null===(n=e.editorInstance)||void 0===n||n.triggerBlur(),e.updatePaddingAdjust(t)})),i()(L,o.a.REMOVE_LINK,(function(e){e.getLink().removeLink()})),i()(L,o.a.EDIT_LINK,(function(e,t){e.getLink().updateLink({href:t})})),i()(L,o.a.DOWNLOAD_ATTACHMENT,(function(e){if(e.isAttachment()){var t=e.props.attachment.objKey;g.c.getInstance().download(t),Object(E.c)({opername:h.e.DOC_WORD_EDITOR,module:h.d.LOCAL_FILES,action:h.b.DOWNLOAD_CLICK})}})),i()(L,o.a.REGULATE,(function(e,t,n){var a,r;null===(a=e.getImageFillEffect)||void 0===a||null===(r=a.call(e))||void 0===r||r.handleImageEffect(t,n)})),i()(L,o.a.PICTURE_COLOR,(function(e,t,n){var a,r;null===(a=e.getImageFillEffect)||void 0===a||null===(r=a.call(e))||void 0===r||r.handleImageEffect(t,n)})),i()(L,o.a.INSERT_PICTURE,(function(e,t,n){var a,r;null===(a=e.getImageFillEffect)||void 0===a||null===(r=a.call(e))||void 0===r||r.handleImageAlpha(t,n)})),i()(L,o.a.UNIFORM_FONT,(function(e,t){var n=Object(N.a)(e.paragraphList,t);e.updateParagraphListForUI(n),e.updateParagraphList(n)})),i()(L,o.a.COLUMNS,(function(e,t,n){var a;return null===(a=e.editorInstance)||void 0===a?void 0:a.operations(o.a.COLUMNS,t,n)})),L);function j(e,t){var n,a,r,i,c,u=t.actionType,l=t.values,s=t.extraOption;if([o.a.UNDO,o.a.REDO].includes(u)&&!(null!==(n=e.editorInstance)&&void 0!==n&&n.isEditing))return!1;if(U[u]){var d,f,v={sync:null!==(d=null==s?void 0:s.isMultiGroup)&&void 0!==d&&d,needUpdate:null!==(f=null==s?void 0:s.needUpdate)&&void 0!==f&&f};return U[u](e,l,F(F({},s),v)),o.a.LINK!==u}return u.startsWith(p.a)?(S.a.getInstance().getAppServices().viewableServiceLayer.addonManager.addonHandler.handleAddonSceneItemClick(u,{ver9:h.m.DETAIL_IFRAME_RIGHT_CLK}),!0):!(!u.startsWith(o.a.TAILOR_PIC)||null!=t&&null!==(a=t.extraOption)&&void 0!==a&&a.isMultiGroup)&&(null===(r=e.getImageCrop)||void 0===r||null===(i=(c=r.call(e)).handleCrop)||void 0===i||i.call(c,u),!0)}var B,G=n("14502724a6"),H=n.n(G),W=n("9657b29818");function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=(B={},i()(B,o.a.INSERT_ROW_TOP,(function(e){e.handleInsertRowTop(q(o.a.INSERT_ROW_TOP))})),i()(B,o.a.INSERT_ROW_BOTTOM,(function(e){e.handleInsertRowBottom(q(o.a.INSERT_ROW_BOTTOM))})),i()(B,o.a.INSERT_COL_LEFT,(function(e){e.handleInsertColLeft(q(o.a.INSERT_COL_LEFT))})),i()(B,o.a.INSERT_COL_RIGHT,(function(e){e.handleInsertColRight(q(o.a.INSERT_COL_RIGHT))})),i()(B,o.a.DELETE_ROW,(function(e){return e.handleDeleteRow()})),i()(B,o.a.DELETE_COL,(function(e){return e.handleDeleteCol()})),i()(B,o.a.DELETE_TABLE,(function(e){return e.handleDeleteTable()})),i()(B,o.a.MERGE_CELL,(function(e){return e.handleMergeCell()})),B),z=function(e,t){if(1!==e.selectedCellRanges.length)return!1;var n=H()(e.selectedCellRanges,1)[0],a=n.rowStart,r=n.colStart;return j(e.props.items[a][r],t)},Z=function(e,t){var n=!1;if(null!==e.selectedCellRanges){var a=!1;if(1===e.selectedCellRanges.length){var r,i=H()(e.selectedCellRanges,1)[0],o=i.rowStart,c=i.colStart,u=e.props.items[o][c];!(a=null==u||null===(r=u.editorInstance)||void 0===r?void 0:r.isEditing)&&u.isEditing&&e.uploadEditingCellData(!0)}var l=V(V({},t),{},{extraOption:V(V({},t.extraOption),{},{isMultiGroup:!a,needUpdate:a})});Object(W.b)((function(){for(var t=0;t<e.selectedCellRanges.length;t++){var r=e.selectedCellRanges[t],i=e.props.items[r.rowStart][r.colStart];i.parent=e.parent;var o=j(i,l);n=n||o}a||S.a.getInstance().getAppServices().viewableServiceLayer.textEditorStateService.isTextPreview||!n||e.uploadSelectedCellData()}))}return n},X=function(e,t){for(var n=!1,a=V(V({},t),{},{extraOption:V(V({},t.extraOption),{},{isMultiGroup:!0,needUpdate:!1})}),r=function(e){var t=e.props.rowHeights.length-1,n=e.props.colWidths.length-1,a={rowStart:Math.min(0,t),colStart:Math.min(0,n),rowEnd:Math.max(0,t),colEnd:Math.max(0,n)},r=e.calculatSelectedRange(a);return e.calculatSelectedCells(r)}(e),i=0;i<r.length;i++){var o=r[i],c=e.props.items[o.rowStart][o.colStart];c.parent=e.parent;var u=j(c,a);n=n||u}return n&&e.uploadAllCellData(),n};function q(e){var t,n=null===(t=S.a.getInstance().getAppServices().editableServiceLayer)||void 0===t?void 0:t.insertTableRowColManager,a=1,r=1;switch(e){case o.a.INSERT_ROW_TOP:a=(null==n?void 0:n.insertTopRowNumber)||1;break;case o.a.INSERT_ROW_BOTTOM:a=(null==n?void 0:n.insertBottomRowNumber)||1;break;case o.a.INSERT_COL_LEFT:r=(null==n?void 0:n.insertLeftColNumber)||1;break;case o.a.INSERT_COL_RIGHT:r=(null==n?void 0:n.insertRightColNumber)||1}return{rowSpan:a,colSpan:r}}var J=n("8f58e78419"),Q=n.n(J);function $(){return S.a.getInstance().getAppServices()}var ee=n("d5c3deb8c7"),te=n("a7888a8b87"),ne=n.n(te);function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e,t){var n=re(re({},t),{},{extraOption:re(re({},t.extraOption),{},{isMultiGroup:!0})}),r=!1;return ee.w((function(){Object(W.b)((function(){e.forEach((function(e){var i=re({},n);i.values&&(i.values=ne()(i.values)),a.d.CONNECTOR===e.type&&(r=u(0,i)||r),a.d.IMAGE===e.type&&(r=P(e,i)||r),a.d.SHAPE===e.type&&(r=j(e,i)||r),a.d.GROUP===e.type&&(r=ie(e.children,t)||r)}))}))})),r}var oe,ce=n("eb99b38407"),ue=n("3c97670bd6"),le=(oe={},i()(oe,o.a.MODIFY_CHART_TYPE_TO_COLUMN_CLUSTERED,ce.k.COLUMN_CLUSTERED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_COLUMN_STACKED,ce.k.COLUMN_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_COLUMN_PERCENT_STACKED,ce.k.COLUMN_PERCENT_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_BAR_CLUSTERED,ce.k.BAR_CLUSTERED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_BAR_STACKED,ce.k.BAR_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_BAR_PERCENT_STACKED,ce.k.BAR_PERCENT_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_LINE_STANDARD,ce.k.LINE_STANDARD),i()(oe,o.a.MODIFY_CHART_TYPE_TO_LINE_STACKED,ce.k.LINE_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_LINE_PERCENT_STACKED,ce.k.LINE_PERCENT_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_LINE_STANDARD_WITH_POINT,ce.k.LINE_STANDARD_WITH_POINT),i()(oe,o.a.MODIFY_CHART_TYPE_TO_LINE_STACKED_WITH_POINT,ce.k.LINE_STACKED_WITH_POINT),i()(oe,o.a.MODIFY_CHART_TYPE_TO_LINE_PERCENT_STACKED_WITH_POINT,ce.k.LINE_PERCENT_STACKED_WITH_POINT),i()(oe,o.a.MODIFY_CHART_TYPE_TO_PIE,ce.k.PIE),i()(oe,o.a.MODIFY_CHART_TYPE_TO_OF_PIE,ce.k.OF_PIE),i()(oe,o.a.MODIFY_CHART_TYPE_TO_OF_PIE_BAR,ce.k.OF_PIE_BAR),i()(oe,o.a.MODIFY_CHART_TYPE_TO_DOUGHNUT,ce.k.DOUGHNUT),i()(oe,o.a.MODIFY_CHART_TYPE_TO_AREA,ce.k.AREA),i()(oe,o.a.MODIFY_CHART_TYPE_TO_AREA_STACKED,ce.k.AREA_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_AREA_PERCENT_STACKED,ce.k.AREA_PERCENT_STACKED),i()(oe,o.a.MODIFY_CHART_TYPE_TO_RADAR,ce.k.RADAR),i()(oe,o.a.MODIFY_CHART_TYPE_TO_RADAR_WITH_FILL,ce.k.RADAR_WITH_FILL),i()(oe,o.a.MODIFY_CHART_TYPE_TO_RADAR_WITH_POINT,ce.k.RADAR_WITH_POINT),oe);function se(e,t){var n,a=t.actionType;return void 0!==le[a]?(ue.a.modifyChartType(e,le[a]),!0):a===o.a.EDIT_CHART_DATA&&(null===(n=S.a.getInstance().getAppServices().editableServiceLayer)||void 0===n||n.chartManager.openChartDataEditor(e),!0)}n("b1e2246d82"),n("963f2eaace"),n("29f8c5f672"),n("85d48ef22b");var de=n("c7530f2183"),fe=n("f1463e9e23"),ve=n("3404d6c52c"),pe=n.n(ve),he=n("5b326a30b1"),be=n("5fac0349d3"),ge=n("0a8ecd6412"),Ee=n("798a9cd6f2"),Oe=n("fed003a03b"),me=n("9594d299a9"),Te=n("b40469cb12"),ye=n("a42ce0d75e"),Se=n("1a11bac27f"),Ie=n("d6541e16f3"),Re=n("b4e5a105a8"),Ae=n("1288bffff3"),_e=n("4dcd1c07ed"),Ce=n("b7b86f256a"),Pe=n("4ee598462b"),Le=n("56a3a65e0c"),Me=n("7c14fe028b"),De=n("02ae07c580"),we=n("8b13fcae36"),Ne=function(){return S.a.getInstance().getAppServices()},ke=function(){var e=d()(v.a.mark((function e(){var t,n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=Ne().editableServiceLayer)||void 0===t||null===(n=t.searchReplaceManager)||void 0===n?void 0:n.promise();case 2:a=e.sent,(null==a?void 0:a.dialogOpenFlag)?null==a||a.closeDialog():null==a||a.openDialog(Ce.c.Search);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(e,t){var n,a,r,i,o=t.values,c=null!==(n=null==o?void 0:o.RegionType)&&void 0!==n?n:y.a.EDITOR;if([y.a.EDITOR,y.a.SLIDELIST].includes(c)){null===(a=Ne().editableServiceLayer)||void 0===a||null===(r=a.copyPasteManager)||void 0===r||null===(i=r.dangerousInstance)||void 0===i||i.triggerCutEvent();var u="string"==typeof o||null==o?void 0:o.popupMenuType;[_e.a.LAYOUT_MASTER,_e.a.LAYOUT_MASTER_GAP].includes(u)&&Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.THUMB_CUT})}},Fe=function(e,t){var n,a,r,i,o=t.values,c=null!==(n=null==o?void 0:o.RegionType)&&void 0!==n?n:y.a.EDITOR;if([y.a.EDITOR,y.a.SLIDELIST].includes(c)){null===(a=Ne().editableServiceLayer)||void 0===a||null===(r=a.copyPasteManager)||void 0===r||null===(i=r.dangerousInstance)||void 0===i||i.triggerCopyEvent();var u="string"==typeof o||null==o?void 0:o.popupMenuType;[_e.a.LAYOUT_MASTER,_e.a.LAYOUT_MASTER_GAP].includes(u)&&Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.THUMB_COPY})}},Ue=function(){var e,t,n;null===(e=Ne().editableServiceLayer)||void 0===e||null===(t=e.copyPasteManager)||void 0===t||null===(n=t.dangerousInstance)||void 0===n||n.triggerPasteEvent()},je=function(e){var t=e.selectionServiceRef.currentSlide;null==t||t.moveElement(-1)},Be=function(e){var t=e.selectionServiceRef.currentSlide;null==t||t.moveElement(1)},Ge=function(e){var t=e.selectionServiceRef.currentSlide;null==t||t.setCurrentElementToFrontOrBack(fe.a.FRONT)},He=function(e){var t=e.selectionServiceRef.currentSlide;null==t||t.setCurrentElementToFrontOrBack(fe.a.BACK)},We=function(e){var t,n;null===(t=e.rightSideBarService)||void 0===t||t.hide(),null===(n=e.rightSideBarManager)||void 0===n||n.setIsSelectWindowShown(!0)},Ye=function(e){var t=e.selectionServiceRef.currentSlide,n=e.selectionServiceRef.getSelectedModel();switch(e.selectionServiceRef.lastMouseDownRegion){case y.a.SLIDELIST:e.uiDataServiceRef.presentation.selectAll();break;case y.a.EDITOR:(Ne().viewableServiceLayer.editorInstanceService.checkEditorIsEditing()||Ne().viewableServiceLayer.editingStateManager.isEditing)&&(null==n?void 0:n.type)===a.d.SHAPE&&null!=n&&n.editorInstance?null==n||n.editorInstance.setSelectionAll():null==t||t.selectAll()}},Ve=function(e,t){var n=e.selectionServiceRef.currentSlide;null==n||n.groupElements();var a=t.menuType,r=t.actionType;t.values,t.extraOption;e.report(a,r)},Ke=function(e,t){var n=e.selectionServiceRef.currentSlide;null==n||n.convertToGroup()},ze=function(e,t){var n=e.selectionServiceRef.currentSlide;null==n||n.unGroupElements();var a=t.menuType,r=t.actionType;t.values,t.extraOption;e.report(a,r)},Ze=function(e){var t,n=e.selectionServiceRef.slideClearanceIndex;e.uiDataServiceRef.presentation.addDefaultSlide(),null===(t=e.getSectionManagerDelegate())||void 0===t||t.expandCurrentSection(n)},Xe=function(e){0===e.selectionServiceRef.selectedSlides.length?e.uiDataServiceRef.presentation.duplicateSlide([e.selectionServiceRef.currentSlide]):e.uiDataServiceRef.presentation.duplicateSlide()},qe=function(e){0===e.selectionServiceRef.selectedSlides.length?e.uiDataServiceRef.presentation.deleteSlide([e.selectionServiceRef.currentSlide]):e.uiDataServiceRef.presentation.deleteSlide()},Je=function(e){var t,n;null===(t=(n=Ne().viewableServiceLayer.playManager).playAction)||void 0===t||t.call(n,!0),Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_LOCAL_PLAY,action:h.b.RIGHT_CLICK})},Qe=function(e,t){var n=t.actionType===o.a.SLIDE_WIDE?he.a.SLIDE_SIZE_16_9:he.a.SLIDE_SIZE_4_3;n===he.a.SLIDE_SIZE_16_9?Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_EDIT_PAGE,action:h.b.CHANGE_SN}):n===he.a.SLIDE_SIZE_4_3&&Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_EDIT_PAGE,action:h.b.CHANGE_FT});var a=pe.a.show({tip:be.a.t("切换中...")});setTimeout((function(){e.uiDataServiceRef.presentation.updateSlideSizeType(n),a.close()}),20)},$e=function(){var e=d()(v.a.mark((function e(t,n){var a,r,i,o,c,u,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.actionType,r=n.values,de.network.isOnline){e.next=4;break}return Ne().viewableServiceLayer.addonManager.event.emit(De.a.ERROR_NETWORK),e.abrupt("return");case 4:if("string"==typeof r){e.next=6;break}return e.abrupt("return");case 6:i=t.getAddonID(r),t.addonInsertHandler(r),o=null==r?void 0:r[r.length-1],localStorage.setItem("".concat(a,"-").concat(o,"_red_point"),"false"),localStorage.setItem("insert-iframe_red_point","false"),c=Ne().viewableServiceLayer.addonManager.getAddonReportId(i,r),u=Ne().viewableServiceLayer.addonManager.getAddonReportName(i,r),Object(E.c)({opername:h.e.DOC_ADDON_PLATFORM,module:h.d.THIRD_SERVICES,action:h.b.ADDON_INSERT,ver6:i,ver10:c}),l=Ne().viewableServiceLayer.toolbarStateManager.getToolbarMode(),Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_TOOLBAR_INSERT,action:h.b.ADDON,ver3:l,ver4:h.i.TOOLBAR_NORMAL_DISPLAY,ver5:u});case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),et=function(e){var t;null===(t=e.insertTdocManager)||void 0===t||t.promise().then((function(e){e.show(),Object(E.c)({opername:h.e.DOC_INSERT_TDOC,module:h.d.TDOC_SELECTOR,action:h.b.INSERT_TDOC_ENTER_CLK});var t=Ne().viewableServiceLayer.toolbarStateManager.getToolbarMode();Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_TOOLBAR_INSERT,action:h.b.TDOC,ver3:t,ver4:h.i.TOOLBAR_NORMAL_DISPLAY})}))},tt=function(){var e,t;null===(e=(t=Ne().viewableServiceLayer.playManager).playAction)||void 0===e||e.call(t,!1)},nt=function(){Ne().viewableServiceLayer.editingStateManager.updateElementCropState(!0),Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_OBJ,action:h.b.IMG_CUT})},at=function(e,t){var n,a,r,c,u=t.actionType,l=(n={},i()(n,o.a.PIC_FORMAT,ge.q.IMAGE_TOGGLE),i()(n,o.a.TRANSPARENCY,ge.q.IMAGE_TOGGLE),i()(n,o.a.SHAPE_FORMAT,ge.q.SHAPE_TOOGLE),i()(n,o.a.SET_BG_FORMAT,ge.q.SHAPE_TOOGLE),i()(n,o.a.CHANGE_BG,ge.q.SHAPE_TOOGLE),i()(n,o.a.CHART_FORMAT,ge.q.CHART_TOGGLE),n);l[u]&&(null===(c=e.rightSideBarManager)||void 0===c||c.setPropertyEditorShowAction(l[u]));null===(a=e.rightSideBarManager)||void 0===a||a.setIsPropertyEditorShown(!0),null===(r=e.rightSideBarService)||void 0===r||r.hide()},rt=function(e,t){var n;e.selectionServiceRef.selectedElements.clear(),at(e,t);var a="string"==typeof t.values||null===(n=t.values)||void 0===n?void 0:n.popupMenuType;[_e.a.LAYOUT_MASTER,_e.a.LAYOUT_MASTER_GAP].includes(a)&&Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.THUMB_OPEN_SIDEBAR})},it=function(){var e;null===(e=Ne().editableServiceLayer)||void 0===e||e.undoRedoService.undo();var t=Ne().viewableServiceLayer.toolbarStateManager.getToolbarMode();Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_TOOLBAR,action:h.b.UNDO,ver3:t,ver4:h.i.TOOLBAR_NORMAL_DISPLAY})},ot=function(){var e;null===(e=Ne().editableServiceLayer)||void 0===e||e.undoRedoService.redo();var t=Ne().viewableServiceLayer.toolbarStateManager.getToolbarMode();Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_TOOLBAR,action:h.b.REDO,ver3:t,ver4:h.i.TOOLBAR_NORMAL_DISPLAY})},ct=function(e){var t,n,a,r,i;null===(t=e.rightSideBarManager)||void 0===t||t.setIsAnimationEditorShown(!0),null===(n=e.rightSideBarService)||void 0===n||n.hide(),null===(a=e.selectionServiceRef.currentSlide)||void 0===a||a.convertAnimDataSdkToUi();var o=null===(r=e.selectionServiceRef)||void 0===r||null===(i=r.currentSlide)||void 0===i?void 0:i.timing;if(!o)return!0;var c=Object(Oe.m)(o);Object(E.c)({opername:h.e.PPT_ANIMATION,module:h.d.TIME_NODE,action:h.b.TOOLBAR_ANIM_CLICK,ver6:JSON.stringify(c)})},ut=function(e){var t=e.selectionServiceRef.getSelectedModel();(null==t?void 0:t.type)!==a.d.EMPTY&&e.selectionServiceRef.selectedElements.clear(),Ne().viewableServiceLayer.linkManager.insertTextWithLink(),e.selectionServiceRef.lastMouseDownRegion=y.a.EDITOR;var n=Ne().viewableServiceLayer.toolbarStateManager.getToolbarMode();Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_TOOLBAR_INSERT,action:h.b.LINK,ver3:n,ver4:h.i.TOOLBAR_NORMAL_DISPLAY})},lt=function(e,t){var n=t.actionType,a=t.values;if(e.selectedMgrRef.clear(),de.network.isOnline){if("string"==typeof a){e.addonInsertHandler(a),localStorage.setItem("".concat(n,"_red_point"),"false"),Object(E.c)({opername:h.e.DOC_FORMULA,module:h.d.FORMULA_TOOLBAR,action:h.b.FORMULA_CLICK});var r=Ne().viewableServiceLayer.toolbarStateManager.getToolbarMode();Object(E.c)({opername:h.e.DOC_PPT,module:h.d.PC_TOOLBAR_INSERT,action:h.b.LATEX,ver3:r,ver4:h.i.TOOLBAR_NORMAL_DISPLAY})}}else Ne().viewableServiceLayer.addonManager.event.emit(De.a.ERROR_NETWORK)},st=function(){var e=d()(v.a.mark((function e(t,n){var a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.menuType,r=n.actionType,t.actionReplaceLatex(a,r);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),dt=function(e,t){var n,a=t.values;null===(n=document.getElementById("import-slide-input"))||void 0===n||n.click(),Object(E.c)({opername:h.e.PAGING_SELECTION,module:h.d.SLIDE_UPLOAD,action:h.b.RIGHT_CLICK_IMPORT}),Object(E.c)({opername:h.e.DOC_PPT,module:h.d.INSERT_SLIDE_ENTRY,action:h.b.INSERT_SLIDE_ENTRY_LOCAL,ver5:null==a?void 0:a.TriggerFrom})},ft=function(){var e=d()(v.a.mark((function e(t,n){var a,r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.values,e.next=3,null===(a=t.importOnlineFileManager)||void 0===a?void 0:a.promise();case 3:null==(i=e.sent)||i.show(),Object(E.c)({opername:h.e.DOC_PPT,module:h.d.INSERT_SLIDE_ENTRY,action:h.b.INSERT_SLIDE_ENTRY_ONLINE,ver5:null==r?void 0:r.TriggerFrom});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),vt=function(e,t){var n=t.values;null!=n&&n.visible&&Object(E.c)({opername:h.e.DOC_PPT,module:h.d.INSERT_SLIDE_ENTRY,action:h.b.INSERT_SLIDE_ENTRY_CLICK,ver5:null==n?void 0:n.TriggerFrom})},pt=function(){var e=d()(v.a.mark((function e(){var t,n,a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Te.a.extensionService.getExtension(ye.a.name);case 2:e.sent.show({docId:null===(t=window.clientVars)||void 0===t?void 0:t.globalPadId,corpId:null===(n=window.clientVars)||void 0===n?void 0:n.creatorCorpId,disabledUserIds:[null===(a=window.clientVars)||void 0===a||null===(r=a.userInfo)||void 0===r?void 0:r.uid]});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ht=function(e,t,n){var a;if(t.values&&"string"!=typeof t.values){var r=t.values.sectionIndex;e.uiDataServiceRef.presentation.getSectionProperty().deleteSection(r,n),null===(a=e.getSectionManagerDelegate())||void 0===a||a.deleteSectionStateAt(r)}},bt=function(){Se.a.wwappDocOnOpenMenu({menuType:2,from:"menubar"})},gt=function(e){var t,n=e.actionType;null===(t=Ne().editableServiceLayer)||void 0===t||t.quickToolDialogManager.promise().then((function(e){e.showDialog(n.slice(4),Le.QUICK_TOOL_AID_POSITION.RIGHT_MENU)}))},Et=function(){Ne().viewableServiceLayer.watermarkManager.promise().then((function(e){e.showDialog()}))},Ot=new Map([[o.a.SEARCH_REPLACE,function(){return ke()}],[o.a.CUT,function(e,t){return xe(0,t)}],[o.a.COPY,function(e,t){return Fe(0,t)}],[o.a.CONVERT_TO_GROUP,function(e,t){return Ke(e)}],[o.a.PASTE,function(){return Ue()}],[o.a.MOVE_ITEM_DOWN,function(e){return je(e)}],[o.a.MOVEDOWN,function(e){return je(e)}],[o.a.MOVE_ITEM_UP,function(e){return Be(e)}],[o.a.MOVEUP,function(e){return Be(e)}],[o.a.ROOT_UPPER,function(e){return Ge(e)}],[o.a.MOVETOP,function(e){return Ge(e)}],[o.a.BASE_DOWN,function(e){return He(e)}],[o.a.SELECT_WINDOW,function(e){return We(e)}],[o.a.MOVEBOTTOM,function(e){return He(e)}],[o.a.SELECT_ALL,function(e){return Ye(e)}],[o.a.ADDGROUP,function(e,t){return Ve(e,t)}],[o.a.REMOVEGROUP,function(e,t){return ze(e,t)}],[o.a.NEW_SLIDE,function(e){return Ze(e)}],[o.a.CREATE_SLIDE,function(e){return Ze(e)}],[o.a.COPY_SLIDE,function(e){return Xe(e)}],[o.a.DELETE_SLIDE,function(e){return qe(e)}],[o.a.SLIDE_PLAY,function(e){return Je()}],[o.a.SLIDE_STANDARD,function(e,t){return Qe(e,t)}],[o.a.SLIDE_WIDE,function(e,t){return Qe(e,t)}],[o.a.SLIDE_CUSTOM,function(){return!0}],[o.a.INSERT_IFRAME_ITEM,function(e,t){return $e(e,t)}],[o.a.INSERT_TENCENT_DOC_ID,function(e){return et(e)}],[o.a.SLIDE_HEADER_FOOTER,function(){return!0}],[o.a.BROWSE_RECORD,function(e){return e._actionBrowseRecord()}],[o.a.EXIT_DOCUMENT,function(e){return e._actionExitDocument()}],[o.a.RESTART_DEMO,function(){return tt()}],[o.a.CUR_PAGE_DEMO,function(e){return Je()}],[o.a.TAILOR_PIC_NORMAL,function(){return nt()}],[o.a.CHANGE_BG,function(e,t){return rt(e,t)}],[o.a.SET_BG_FORMAT,function(e,t){return rt(e,t)}],[o.a.SHAPE_FORMAT,function(e,t){return at(e,t)}],[o.a.CHART_FORMAT,function(e,t){return at(e,t)}],[o.a.TRANSPARENCY,function(e,t){return at(e,t)}],[o.a.EDIT_FORMAT,function(e,t){return at(e,t)}],[o.a.PIC_FORMAT,function(e,t){return at(e,t)}],[o.a.REVISION_RECORD,function(e){return e._actionRevisionRecord()}],[o.a.NATIVE_PPT,function(e){return e._actionNativePPT()}],[o.a.SHOW_RATIO,function(e){return e.showRatioView()}],[o.a.UNDO,function(){return it()}],[o.a.REDO,function(){return ot()}],[o.a.MOVE_SLIDE_UP,function(e){return e.uiDataServiceRef.presentation.moveSlides()}],[o.a.PERFORMANCE,function(e){return e._actionPerformance()}],[o.a.INSERT_ANIMATION,function(e){return ct(e)}],[o.a.LINK,function(e){return e._actionLink()}],[o.a.PARAGRAPH_MORE,function(e){var t;return null===(t=e.paragraphManager)||void 0===t?void 0:t.showParagraph()}],[o.a.WATERMARK,function(){return Et()}],[o.a.EXPORT_PDF,function(e){return e.exportPDF()}],[o.a.INSERT_WITH_LINK,function(e){return ut(e)}],[o.a.INSERT_WITH_LATEX,function(e,t){return lt(e,t)}],[o.a.REPLACE_WITH_LATEX,function(e,t){return st(e,t)}],[o.a.OCR_WITH_LATEX,function(e,t){return st(e,t)}],[o.a.PERMISSION_SETTING,function(){var e,t,n,a;return null===(e=Ne())||void 0===e||null===(t=e.viewableServiceLayer.extensionService)||void 0===t||null===(n=t.getCallBackAdapter())||void 0===n||null===(a=n.onAuthClick)||void 0===a?void 0:a.call(n)}],[o.a.ADVANCED_PERMISSION,function(){var e,t;return null===(e=Ne().editableServiceLayer)||void 0===e||null===(t=e.advancedPermissionManager)||void 0===t?void 0:t.showDialog()}],[o.a.SET_WATER_MARK,function(){return Et()}],[o.a.IMPORT_LOCAL_SLIDE,function(e,t){return dt(0,t)}],[o.a.IMPORT_ONLINE_SLIDE,function(e,t){return ft(e,t)}],[o.a.TEXT_FORMAT,function(e){return e.actionTextFormat()}],[o.a.ADDON_UNOFFICIAL,function(e,t){return n=e,a=t.values,void(de.network.isOnline?"string"==typeof a&&(Object(E.c)({opername:h.e.PLUG_IN,module:h.d.PPT,action:h.b.ISLIDE}),n.addonInsertHandler(a)):Ne().viewableServiceLayer.addonManager.event.emit(De.a.ERROR_NETWORK));var n,a}],[o.a.COPY_DOC_LINK,me.a],[o.a.IMPORT_SLIDE,function(e,t){return vt(0,t)}],[o.a.ADDON,function(e,t){return function(e,t){var n,r=t.values;if(null!=r&&r.visible){var i;switch(null===(n=e.selectionServiceRef.getSelectedModel())||void 0===n?void 0:n.type){case a.d.SHAPE:i=h.m.DETAIL_IFRAME_RIGHT_CLK;break;case a.d.IMAGE:i=h.m.DETAIL_PIC_RIGHT_CLK;break;case a.d.EMPTY:i=h.m.DETAIL_TXT_RIGHT_CLK}Object(E.c)({opername:h.e.DOC_ADDON,module:h.d.ADDON_LIST,action:h.b.LIST_VIEW,eventcode:h.a.DOC_ADDON_ADDON_LIST_LIST_VIEW,ver9:i,file_type:h.c.SLIDE})}}(e,t)}],[o.a.FONT_THEME,function(e,t){return n=e,a=t.values,n.uiDataServiceRef.presentation.updateThemeFontFamily(a),void Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.SET_THEME_FONT});var n,a}],[o.a.PLACEHOLDER_FORMAT,function(e,t){return n=e,r=t.values,void(null===(a=n.selectionServiceRef.currentSlide)||void 0===a||a.updatePlaceholderFormat(r));var n,a,r}],[o.a.MASTER_LAYOUT,function(){return null===(e=Ne().editableServiceLayer)||void 0===e||e.masterLayoutEditService.changeEditType(Ae.a.MASTER_LAYOUT),void Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.MASTER_CLICK});var e}],[o.a.INSERT_LAYOUT,function(e){return null==(n=null===(t=e.selectionServiceRef.currentSlide)||void 0===t?void 0:t.presentationRef)||n.addLayout(),void Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.THUMB_INSERT_LAYOUT});var t,n}],[o.a.COPY_LAYOUT,function(e){return null==(n=null===(t=e.selectionServiceRef.currentSlide)||void 0===t?void 0:t.presentationRef)||n.duplicateSlide(),void Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.THUMB_COPY_LAYOUT});var t,n}],[o.a.DELETE_LAYOUT,function(e){return null==(n=null===(t=e.selectionServiceRef.currentSlide)||void 0===t?void 0:t.presentationRef)||n.deleteSlide(),void Object(E.c)({opername:h.e.DOC_PPT,module:h.d.MASTER,action:h.b.THUMB_DELETE_LAYOUT});var t,n}],[o.a.ADD_SECTION,function(e,t){return function(e,t){var n,a,r,i,o;if(t.values&&"string"!=typeof t.values){var c=t.values.gapIndex;if("number"==typeof c){-1===e.selectionServiceRef.slideClearanceIndex&&(c-=1);var u=null!==(n=null===(a=e.uiDataServiceRef.presentation.sectionList)||void 0===a?void 0:a.length)&&void 0!==n?n:0;e.uiDataServiceRef.presentation.getSectionProperty().addNewSection(c,be.a.t("无标题节"));var l=null!==(r=null===(i=e.uiDataServiceRef.presentation.sectionList)||void 0===i?void 0:i.length)&&void 0!==r?r:0;null===(o=e.getSectionManagerDelegate())||void 0===o||o.addUnfoldedSectionStateAt(c,l-u)}}}(e,t)}],[o.a.RENAME_SECTION,function(e,t){return function(e,t){if(t.values&&"string"!=typeof t.values){var n=t.values.sectionIndex,a=e.getSectionManagerDelegate();a&&(a.nameEditingIndex=n)}}(e,t)}],[o.a.DELETE_SECTION,function(e,t){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ht.apply(void 0,t.concat([!1]))}(e,t)}],[o.a.DELETE_SECTION_AND_SLIDES,function(e,t){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ht.apply(void 0,t.concat([!0]))}(e,t)}],[o.a.DELETE_ALL_SECTIONS,function(e,t){return(n=e).uiDataServiceRef.presentation.getSectionProperty().deleteAllSections(),void(null===(a=n.getSectionManagerDelegate())||void 0===a||a.deleteAllSectionsState());var n,a}],[o.a.MOVE_SECTION_UP,function(e,t){return function(e,t){var n;if(t.values&&"string"!=typeof t.values){var a=t.values.sectionIndex,r=e.uiDataServiceRef.presentation.getSectionProperty();r.moveSectionUp(a);var i=r.getSectionSlideModelsAndBeginSlideIndex(a-1),o=H()(i,2)[1];null===(n=e.getSectionManagerDelegate())||void 0===n||n.selectSection(a-1,o)}}(e,t)}],[o.a.MOVE_SECTION_DOWN,function(e,t){return function(e,t){var n;if(t.values&&"string"!=typeof t.values){var a=t.values.sectionIndex,r=e.uiDataServiceRef.presentation.getSectionProperty();r.moveSectionDown(a);var i=r.getSectionSlideModelsAndBeginSlideIndex(a+1),o=H()(i,2)[1];null===(n=e.getSectionManagerDelegate())||void 0===n||n.selectSection(a+1,o)}}(e,t)}],[o.a.COLLAPSE_ALL_SECTIONS,function(e,t){var n;null===(n=e.getSectionManagerDelegate())||void 0===n||n.collapseAllSections()}],[o.a.EXPAND_ALL_SECTIONS,function(e,t){var n;null===(n=e.getSectionManagerDelegate())||void 0===n||n.expandAllSections()}],[o.a.HIDE_SLIDE,function(e,t){return function(e){var t=e.selectionServiceRef.selectedSlides.selectedArray;e.uiDataServiceRef.presentation.toggleShowSlides(t,!1)}(e)}],[o.a.CANCEL_HIDE_SLIDE,function(e,t){return function(e){var t=e.selectionServiceRef.selectedSlides.selectedArray;e.uiDataServiceRef.presentation.toggleShowSlides(t,!0)}(e)}],[o.a.DISPLAY_GUIDES,function(e,t){return function(e){var t;null===(t=e.guidesManager)||void 0===t||t.changeDisplayGuides()}(e)}],[o.a.DISPLAY_TEXT_RULER,function(e,t){return function(e){var t;null===(t=e.textRulerManager)||void 0===t||t.updateDisplayRuler()}(e)}],[o.a.TOGGLE_SNAP_LINE,function(e,t){return function(e){var t;null===(t=e.snapLineService)||void 0===t||t.toggleSnapLine()}(e)}],[o.a.ADD_HORZ_GUIDE,function(e,t){return function(e,t){var n,a,r;null!=t&&null!==(n=t.values)&&void 0!==n&&n.model||null===(r=e.guidesManager)||void 0===r||r.setCurrentGuide(void 0),null===(a=e.guidesManager)||void 0===a||a.addHorzGuide()}(e,t)}],[o.a.ADD_VERT_GUIDE,function(e,t){return function(e,t){var n,a,r;null!=t&&null!==(n=t.values)&&void 0!==n&&n.model||null===(r=e.guidesManager)||void 0===r||r.setCurrentGuide(void 0),null===(a=e.guidesManager)||void 0===a||a.addVertGuide()}(e,t)}],[o.a.DELETE_GUIDE,function(e,t){return function(e,t){var n,a=t.values;null===(n=e.guidesManager)||void 0===n||n.deleteGuide(a.model)}(e,t)}],[o.a.DISPLAY_GRID_LINE,function(e,t){return function(e){var t;null===(t=e.gridLineManager)||void 0===t||t.changeDisplayGridLine()}(e)}],[o.a.GRID_LINE_ALIGN,function(e,t){return function(e){var t;null===(t=e.gridLineManager)||void 0===t||t.changeIsGridAlign()}(e)}],[o.a.GRID_DIALOG,function(e,t){return function(e){e.gridLineManager&&(e.gridLineManager.displayGridLineDialog=!0),Object(E.c)({opername:h.e.DOC_PPT,module:h.d.GRID_LINE_SETTING,action:h.b.OPEN_GRID_LINE_DIALOG})}(e)}],[o.a.OPEN_UNIFORM_FONT,function(e,t){return gt(t)}],[o.a.CHANGE_THEME,function(e,t){return null===(n=Ne().editableServiceLayer)||void 0===n||null===(a=n.themeColorManager)||void 0===a||a.showThemeModal({source:Me.a.rightMenu}),void Object(E.c)({opername:h.e.DOC_PPT,module:h.d.COLOR_SWITCH,action:h.b.THEME_CLICK,ver5:h.j.RIGHT_MENU_SOURCE});var n,a}],[o.a.OPEN_REPLACE_FONT,function(e,t){return gt(t)}],[o.a.OPEN_MUTI_PICTURE_SIZE_SETTING,function(e,t){return gt(t)}],[o.a.OPEN_MUTI_PICTURE_POS_SETTING,function(e,t){return gt(t)}],[o.a.OPEN_MUTI_PICTURE_EXPORT,function(e,t){return gt(t)}],[o.a.QUICK_TOOL,function(e,t){return function(e){var t;null!=e&&null!==(t=e.values)&&void 0!==t&&t.visible&&Object(Pe.b)()}(t)}],[o.a.THEME_EDIT,function(e,t){return function(e){var t;null===(t=e.themeColorManager)||void 0===t||t.updateThemeColorCustomDialogVisible(!0)}(e)}],[o.a.THEME_DELETE,function(e,t){return function(e){var t;null===(t=e.themeColorManager)||void 0===t||t.removeCustomThemeByCurrentEditKey()}(e)}],[o.a.TO_SOURCE_URL,function(e,t){return function(e){try{var t,n,a=null===(n=(null===(t=e.selectionServiceRef)||void 0===t?void 0:t.getSelectedModel()).sdkData)||void 0===n?void 0:n.getDescription();null!=a&&a.sourceUrl&&Object(we.openNewBlankWindow)(a.sourceUrl)}catch(e){var r;return void(null===(r=window.log)||void 0===r||r.error("open source url error",e))}}(e)}]]);function mt(e,t){var n=t.menuType,a=t.actionType,r=t.values;Ee.b&&(Ot.set(o.a.TRANSFER_OWNERSHIP_WEWORK,pt),Ot.set(o.a.FORWARD_DOC_IN_MEETING,bt),Ie.a.setWedriveAction(Ot));var i=Ot.get(a);i?i(e,t):Re.a.getInstance().handleAction(n,a,r)}function Tt(e,t){var n=e.type;if([a.d.CONNECTOR].includes(n))return u(0,t);if([a.d.IMAGE].includes(n))return P(e,t);if([a.d.SHAPE].includes(n))return j(e,t);if([a.d.TABLE].includes(n))return function(e,t){var n=t.actionType;return n===o.a.UNIFORM_FONT?X(e,t):!!e.selectedRange&&([o.a.UNDO,o.a.REDO].includes(n)?z(e,t):K[n]?(K[n](e),!0):Z(e,t))}(e,t);if([a.d.EMPTY].includes(n))return function(e,t){var n,a,r,i=t.actionType,c=t.values;return i.startsWith(p.a)?($().viewableServiceLayer.addonManager.addonHandler.handleAddonSceneItemClick(i,{ver9:h.m.DETAIL_TXT_RIGHT_CLK}),!0):i===o.a.SHOW_MASTER_SHAPE&&(null===(n=$().viewableServiceLayer.selectionService.currentSlide)||void 0===n||null===(a=n.sdkData)||void 0===a||null===(r=a.api)||void 0===r||r.updateShowMasterSp(!!Q()(c,"showMasterSp")),!0)}(0,t);if([a.d.NOTE].includes(n)){var r=e.noteTextBody;return!!r&&j(r,t)}return[a.d.GROUP].includes(n)?ie(e.children,t):[a.d.MULTIPLY].includes(n)?ie(e.selectedModels,t):!![a.d.CHART].includes(n)&&se(e,t)}},f8aba17285:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("9132715560"),r=n.n(a),i=n("6a364eb35c"),o=n.n(i),c=n("85d0a7609b"),u=n.n(c),l=(n("a2a09da1e3"),n("8ee19818c4"),n("63513d8b56"),n("d5c3deb8c7")),s=function(){function e(t,n){r()(this,e),u()(this,"model",void 0),u()(this,"callbacks",void 0),u()(this,"actionDispose",void 0),this.model=t,this.callbacks=[]}return o()(e,[{key:"addChangesetObserver",value:function(e){this.model.changeSetEngine.addChangesetObserver(e)}},{key:"removeChangesetObserver",value:function(e){this.model.changeSetEngine.removeChangesetObserver(e)}},{key:"getObserveData",value:function(e){return{}}},{key:"addLocalChangeObserver",value:function(e,t){var n=this;e&&this.callbacks.indexOf(e)<0&&this.callbacks.push(e),this.callbacks.length>0&&!this.actionDispose&&(this.actionDispose=Object(l.r)((function(){return n.getObserveData(t)}),(function(e){n.notifyLocalChange(e)})))}},{key:"notifyLocalChange",value:function(e,t){var n=this;this.callbacks.forEach((function(a){a(null!=e?e:n.getObserveData(),t)}))}},{key:"removeLocalChangeObserver",value:function(e){var t,n=this.callbacks.indexOf(e);(n>=0&&this.callbacks.splice(n,1),this.callbacks.length<=0)&&(null===(t=this.actionDispose)||void 0===t||t.call(this),this.actionDispose=null)}}]),e}()}}]);
//# sourceMappingURL=slide-base~f19eb79b-a556e5.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([["async~43172549"],{"0d1cecd3de":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));n("8a35b54c1d"),n("8aebbf296a"),n("85d48ef22b");var r=n("e71df909b9"),a=function(e,t){var n,r,a,i;if(!(null!=e&&null!==(n=e.dataTransfer)&&void 0!==n&&null!==(r=n.items)&&void 0!==r&&r.length||null!=e&&null!==(a=e.dataTransfer)&&void 0!==a&&null!==(i=a.files)&&void 0!==i&&i.length))return[];var o=e.dataTransfer,l=o.files,s=o.items;return t(null!=l&&l.length?l:s)},i=function(e){var t,n,r,a,i,o,l,s,c;return!!("file"===(null==e||null===(t=e.dataTransfer)||void 0===t||null===(n=t.items)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.kind)||(null!==(a=window)&&void 0!==a&&null!==(i=a.browser)&&void 0!==i&&null!==(o=i.browser)&&void 0!==o&&o.msie||null!==(l=window)&&void 0!==l&&null!==(s=l.browser)&&void 0!==s&&null!==(c=s.browser)&&void 0!==c&&c.safari)&&null!=e&&e.dataTransfer)&&(e.preventDefault(),!0)},o=function(e){return a(e,(function(e){return Array.from(e).filter((function(e){return Object(r.b)({type:e.type,name:""})}))}))}},"1b1fe27f33":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-column-dialog-body-3wpdy{padding-left:20px}.style-column-dialog-body-3wpdy .style-column-dialog-item-6Qktk{display:flex;align-items:center;justify-content:center}.style-column-dialog-body-3wpdy .style-column-dialog-item-6Qktk:first-child{margin-bottom:10px}.style-column-dialog-body-3wpdy .style-column-dialog-item-6Qktk label{margin-left:auto;margin-right:10px}",""]),t.locals={"column-dialog-body":"style-column-dialog-body-3wpdy","column-dialog-item":"style-column-dialog-item-6Qktk"}},"2efa6f43fe":function(e,t,n){"use strict";n.r(t),n.d(t,"ColumnDialogManager",(function(){return j}));var r=n("9132715560"),a=n.n(r),i=n("6a364eb35c"),o=n.n(i),l=n("85d0a7609b"),s=n.n(l),c=(n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("69084d01d3")),u=n.n(c),d=n("2e0796c118"),p=n.n(d),f=n("14502724a6"),v=n.n(f),h=(n("826dc923b3"),n("7eaa8e90a5"),n("b4638a0243"),n("52d461bc51")),g=n.n(h),m=n("5fac0349d3"),b=n("b4a31815a1"),y=n("e792a3169a"),S=n.n(y),k=n("1b1fe27f33"),P=n.n(k),w={insert:"head",singleton:!1},C=(S()(P.a,w),P.a.locals||{}),E=n("8897cfe637"),x=function(e){var t=e.defaultColumnNumber,n=e.defaultColumnSpace,r=e.onClose,a=e.onOk,i=Object(c.useState)(t),o=v()(i,2),l=o[0],s=o[1],d=Object(c.useState)(n),p=v()(d,2),f=p[0],h=p[1];return u.a.createElement(g.a,{title:m.a.t("分栏"),visible:!0,style:{width:"260px"},onClose:r,onCancel:r,onOk:function(e){e&&a({columnNumber:l,columnSpace:f})}},u.a.createElement("div",{className:C["column-dialog-body"]},u.a.createElement("div",{className:C["column-dialog-item"]},u.a.createElement("label",null,m.a.t("栏数"),":"),u.a.createElement(b.g,{min:E.i,max:E.e,maxLength:E.f,value:"".concat(l||E.c),step:E.a,style:{width:"90px"},onChange:function(e){s(Number(e))}})),u.a.createElement("div",{className:C["column-dialog-item"]},u.a.createElement("label",null,m.a.t("栏间距"),":"),u.a.createElement(b.g,{min:E.j,max:E.g,maxLength:E.h,value:"".concat(f||E.d),step:E.b,style:{width:"90px"},allowDecimal:!0,toFixed:2,suffix:m.a.t("厘米"),onChange:function(e){var t=parseFloat(e);h(parseFloat(t.toFixed(2)))}}))))},D=n("ea3a38d9d4"),T=n("382929c8da"),I=n("3344f1a2e7"),M=n("d3d31c86eb"),O=n("9da6335152"),A=n("8930941e65");function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(){function e(){var t=this;a()(this,e),s()(this,"dialogContainer",document.createElement("div")),s()(this,"originalColumnData",void 0),s()(this,"services",void 0),s()(this,"hideDialog",(function(){t.originalColumnData=null,p.a.unmountComponentAtNode(t.dialogContainer)})),s()(this,"changeColumnData",(function(e){t.reportData(e);var n,r=e.columnNumber,a=e.columnSpace,i=t.originalColumnData||{},o=i.columnNumber,l=i.columnSpace,s={};(r!==o&&(s.columnNumber=r),Object(A.a)(a).isNumber()&&Object(I.k)(a)!==l&&(s.columnSpace=Object(I.k)(a)),Object.keys(s).length>0)&&(null===(n=t.services.menuManager.toolbarMenu())||void 0===n||n.callback(D.a.TOOLBAR,T.a.COLUMNS,s));t.hideDialog()}))}return o()(e,[{key:"setServiceDelegates",value:function(e){this.services=N(N({},this.services),e)}},{key:"showDialog",value:function(e){this.originalColumnData=e,this.updateDialog()}},{key:"reportData",value:function(e){var t=e.columnNumber,n=e.columnSpace;Object(M.c)({opername:O.e.DOC_PPT,module:O.d.PC_TOOLBAR,action:O.b.MORE_COLUMNS,ver5:t,ver6:n})}},{key:"updateDialog",value:function(){var e=this.originalColumnData||{},t=e.columnNumber,n=e.columnSpace;p.a.render(u.a.createElement(x,{defaultColumnNumber:t,defaultColumnSpace:n&&Object(I.t)(n),onClose:this.hideDialog,onOk:this.changeColumnData}),this.dialogContainer)}}]),e}()},"3cc783627f":function(e,t,n){"use strict";n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return s})),n.d(t,"l",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"n",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"e",(function(){return S})),n.d(t,"k",(function(){return k})),n.d(t,"c",(function(){return P})),n.d(t,"g",(function(){return w})),n.d(t,"j",(function(){return C})),n.d(t,"m",(function(){return E}));n("a2a09da1e3"),n("c6244f7705"),n("bd80bf2d0f"),n("1bab7b5fb7"),n("0aeae65bf4"),n("826dc923b3"),n("963f2eaace"),n("75563bc376"),n("759492dad9"),n("7eaa8e90a5"),n("0eec0ee5bb"),n("8ee19818c4");var r=n("8f58e78419"),a=n.n(r),i=n("711a53c9fc"),o=n("147aa73f92"),l=12700,s=100,c={white:"FFFFFF",silver:"C0C0C0",gray:"808080",black:"000000",red:"FF0000",maroon:"800000",yellow:"FFFF00",olive:"808000",lime:"00FF00",green:"008000",aqua:"00FFFF",teal:"008080",blue:"0000FF",navy:"000080",fuchsia:"FF00FF",purple:"800080"},u=function(e,t){if(!t)return e;var n=e.indexOf("<".concat(t));if(-1!==n){var r=e.indexOf("</".concat(t));if(-1!==r)return e.substring(0,n)+e.substring(r+t.length+3)}return e},d=function(){var e="";for(var t=0;t<4;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e},p=function(){return"border:0.5pt solid #dadbda;empty-cells:show;line-height:normal;background-color:#FFF;color:#000;vertical-align:middle;outline-width:0;word-wrap:break-word;word-break:normal;white-space:pre-line; text-align:left;font-family:'Microsoft YaHei','微软雅黑',sans-serif;font-size:10pt;"},f=function(e){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)},v=function(e){var t=e.toString().match(/\d+(\.\d+)?/g),n=1;if(void 0!==t[3]&&(n=Number(t[3])),0===n)return"";var r="#";if(1===n)for(var a=0;a<3;a++)r+="0".concat(Number(t[a]).toString(16)).slice(-2);else{for(var i=0;i<3;i++)r+="0".concat(Number(t[i]).toString(16)).slice(-2);r+=(255*n).toString(16).substring(0,2)}return r},h=function(e){if("string"==typeof e){if("#"===e[0])return e.substring(1);if("rgb"===e.substring(0,3).toLowerCase()){var t=v(e);return"#"===t[0]&&(t=t.substring(1)),t}return c[e]?c[e]:void 0}},g={"font-weight":[{key:"B",value:"bold"}],"font-style":[{key:"I",value:"italic"}],"text-decoration":[{key:"U",value:"underline"},{key:"A",value:"underline"},{key:"S",value:"line-through"}]},m=function(e,t){var n=g[t],r=null==n?void 0:n.find((function(t){return t.key===e}));if(r)return r.value},b=function(e,t){var n,r=null==e||null===(n=e.getAttribute)||void 0===n?void 0:n.call(e,t);if(!r)for(var a=e;a&&"BODY"!==a.tagName;){var i,o,l=null===(i=a=a.parentNode||a.parentNodeText)||void 0===i||null===(o=i.getAttribute)||void 0===o?void 0:o.call(i,t);if(l){r=l;break}}return r},y=function(e,t,n){var r,a,i=(null===(r=e.style)||void 0===r?void 0:r[t])||m(null==e?void 0:e.tagName,t);i||(i=null==e||null===(a=e.getAttribute)||void 0===a?void 0:a.call(e,t));if(!i){var o=n(e);i=null==o?void 0:o[t]}if(!i){for(var l=e,s=[],c=g[t];l&&"HTML"!==l.tagName&&(c?c.length!==s.length:!s.length);)if(l=l.parentNode||l.parentNodeText){var u,d,p=(null===(u=l.style)||void 0===u?void 0:u[t])||m(null===(d=l)||void 0===d?void 0:d.tagName,t);p&&s.push(p)}i=s.join(" ")}return i},S=function(e){var t=(e.r||{}).t;return t||(t="",e.br&&(t="\n")),t},k=function(e,t){e&&(function(e,t){var n,r=e.sz?parseFloat(e.sz)/100:16;t.fontSize="".concat(r,"pt");var a,i="DengXian";"zh-CN"===e.lang?null!==(a=e.ea)&&void 0!==a&&a.typeface&&(i=e.ea.typeface):null!==(n=e.latin)&&void 0!==n&&n.typeface&&(i=e.latin.typeface),t.fontFamily=i,e.i&&(t.fontStyle="italic"),e.b&&(t.fontWeight="bold")}(e,t),function(e,t){if(e.u&&e.u!==i.Nb.none&&(t.textDecoration+="underline"),e.strike&&e.strike!==i.Lb.noStrike&&(t.textDecoration+=" line-through"),e.spc){var n=e.spc/100;t.letterSpacing="".concat(n,"pt")}}(e,t),function(e,t){var n,r,a,i,l,s;null!==(n=e.solidFill)&&void 0!==n&&null!==(r=n.egColorChoice)&&void 0!==r&&r.srgbClr&&(t.color=Object(o.f)(null===(i=e.solidFill)||void 0===i||null===(l=i.egColorChoice)||void 0===l?void 0:l.srgbClr)),null!==(a=e.highlight)&&void 0!==a&&a.srgbClr&&(t.backgroundColor=Object(o.f)(null===(s=e.highlight)||void 0===s?void 0:s.srgbClr))}(e,t),function(e,t){var n,r,a;null!=e&&null!==(n=e.lnSpc)&&void 0!==n&&n.spcPct&&(t.lineHeight="".concat((null===(r=e.lnSpc)||void 0===r||null===(a=r.spcPct)||void 0===a?void 0:a.val)/1e3,"%"))}(e,t))},P=function(e,t){if(!e||!t)return e;for(var n,r=e,a=100;a;){if(a-=1,(n=u(r,t))===r)return n;r=n}return 0===a?"":n},w=function(e){if(null==e||!e.pPr)return!1;var t=e.pPr||{},n=t.buNone,r=t.buChar,a=t.buAutoNum,i=t.buBlip;return 1!==n&&(r||a||i)},C=function(e){var t;return null==e||null===(t=e.pPr)||void 0===t?void 0:t.buAutoNum},E=function(e){var t,n=document.createElement("div");a()(e,"txBody.p.length")>0&&e.txBody.p.forEach((function(e,r){var a,i;if(w(e)?(t||((t=C(e)?document.createElement("ol"):document.createElement("ul")).id=r),i=document.createElement("li")):(i=document.createElement("p"),t=null),e.pPr){var o=e.pPr.defaultRunProps;k(o,i.style)}if(null===(a=e.egTextRun)||void 0===a||a.forEach((function(e){var t,n=e.r.rPr;null!=n&&n.hlinkClick?(t=document.createElement("a")).href=n.hlinkClick.id:t=document.createElement("span");var r=S(e),a=document.createTextNode(r);t.appendChild(a),k(n,t.style),i.appendChild(t)})),t){t.appendChild(i);var l=n.getElementsByTagName("ul"),s=!1;if(l.length>0)for(var c=0;c<l.length;c++){l[c].id===t.id&&(s=!0)}s||n.appendChild(t)}else n.appendChild(i)}));return n.outerHTML}},"58f952d683":function(e,t,n){"use strict";n.r(t),n.d(t,"MobileCopyPaste",(function(){return D}));n("73b854064b");var r,a,i=n("1f925d7f50"),o=n.n(i),l=n("9132715560"),s=n.n(l),c=n("6a364eb35c"),u=n.n(c),d=n("547611bd96"),p=n.n(d),f=n("8eec1e4a03"),v=n.n(f),h=n("bd29e2df90"),g=n.n(h),m=n("ab5eb40518"),b=n.n(m),y=n("1b4cdd6a36"),S=n.n(y),k=(n("85d0a7609b"),n("2dc700e1e6")),P=n.n(k),w=(n("f1054791f4"),n("3bf1976a4f"),n("2c4d03fe19"),n("d5c3deb8c7")),C=n("de8a404165"),E=n("7091f809c6");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var D=(r=function(e){g()(n,e);var t=x(n);function n(){var e;s()(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),o()(p()(e),"isMobileCopyingOrPasting",a,p()(e)),e}return u()(n,[{key:"triggerCopyEvent",value:function(e){return this.copyByAction(e),!0}},{key:"pasteForMobile",value:function(){var e,t;this.isMobileCopyingOrPasting=!0,null===(e=this.services)||void 0===e||null===(t=e.menuManager)||void 0===t||t.hideAllMenu(),this.doClipboardPaste()}},{key:"cutForMobile",value:function(){this.isCut=!0,this.copyForMobile()}},{key:"copyForMobile",value:function(){var e,t=this,n={copyValueStr:null===(e=this.textarea)||void 0===e?void 0:e.getValue().trim(),copyValueMethod:function(){return setTimeout((function(){return t.textarea.setValue("")}),0)}};this.shouldResponseCopy(n)?(this.isMobileCopyingOrPasting=!0,this.clipboardCopyEvent()):this.resetCutStatus()}},{key:"copyPlaceholderDataToText",value:function(){return this.copyDataToText(E.a.TEXT," ")}},{key:"getAspectWIdthBySizeType",value:function(){return 800}},{key:"copy",value:function(e){return(null==e?void 0:e.target)!==document.body&&v()(S()(n.prototype),"copy",this).call(this,e)}},{key:"focusCachedActiveElement",value:function(){var e=this;requestAnimationFrame((function(){var t,n,r;null===(t=e.services)||void 0===t||null===(n=t.editorInstanceService)||void 0===n||null===(r=n.getEditorInstance())||void 0===r||r.triggerBlur()})),this.isMobileCopyingOrPasting=!1}},{key:"generateSlideCanvas",value:function(e,t){var n;return(null===(n=this.services)||void 0===n?void 0:n.contentRendererService).copyToImage.generateSlideCanvas(e,t)}},{key:"copyByAction",value:function(e){var t=this,n={copyValueStr:e,copyValueMethod:function(){return t.copyText(e)}};this.shouldResponseCopy(n)?this.clipboardCopyEvent():this.resetCutStatus()}}]),n}(C.a),a=P()(r.prototype,"isMobileCopyingOrPasting",[w.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r)},"5c2b595cb5":function(e,t,n){"use strict";n.d(t,"a",(function(){return xe}));var r,a=n("176815363d"),i=n.n(a),o=n("1f925d7f50"),l=n.n(o),s=n("9132715560"),c=n.n(s),u=n("6a364eb35c"),d=n.n(u),p=n("85d0a7609b"),f=n.n(p),v=n("2dc700e1e6"),h=n.n(v),g=(n("f1054791f4"),n("3ef2352f0b")),m=n.n(g),b=(n("6e20b6a7d8"),n("8ee19818c4"),n("c6244f7705"),n("081c8cafea"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("9657b29818")),y=n("b8e6877859"),S=n("775b80aea6"),k=n("77af05df23"),P=n("f4baa8f5bf"),w=n("e0a005a7aa");n("3bf1976a4f");!function(e){e.WillCreateImages="will-create-images",e.DidCreateImages="did-create-images",e.CreateImageError="create-image-error",e.UploadError="upload-error",e.DidUpload="did-upload",e.UploadGifError="upload-gif-error",e.DidUploadGif="did-upload-gif",e.ValidateError="validate-error",e.DidValidate="did-validate"}(r||(r={}));var C=n("14502724a6"),E=n.n(C),x=(n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("963f2eaace"),n("b1e2246d82"),n("8aebbf296a"),n("f45588a8ad"),n("de37db1287"),n("d835d04d7a")),D=n("bd5de260ae");function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e){var t,n,a,i,o,l,s,c,u,d,p,f=T((t=x.b.IMAGE_UPLOAD,n=x.b.IMAGE_GIF_FRAME_UPLOAD,a=x.b.IMAGE_DETECT,i=x.a.SUCCESS,o=x.a.ERROR,l=r.UploadError,s=r.DidUpload,c=r.UploadGifError,u=r.DidUploadGif,d=r.ValidateError,[[s,function(){return Object(D.a)(t,i)}],[l,function(){return Object(D.a)(t,o)}],[u,function(){return Object(D.a)(n,i)}],[c,function(){return Object(D.a)(n,o)}],[r.DidValidate,function(){return Object(D.a)(a,i)}],[d,function(e){return Object(D.a)(a,o,e.message)}]]));try{for(f.s();!(p=f.n()).done;){var v=E()(p.value,2),h=v[0],g=v[1];e.on(h,g)}}catch(e){f.e(e)}finally{f.f()}}n("75563bc376");var O=n("5fac0349d3"),A=n("d9812f1c6f"),L=n("82f2dc9440"),N=n.n(L),j=n("b74ee0edd6"),R=n.n(j),F=n("b413d1a284"),B=n("9049777d9b"),_=n("52f1976aee"),H=n("6149d12036");function U(e){return A.a.isMobile?R.a.show(e):N.a.show(e)}var G=n("c25f2f0779");function W(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var V=function(){function e(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).enabled,r=void 0===n||n;c()(this,e),f()(this,"storage",void 0),f()(this,"enabled",void 0),this.storage=new G.a(t),this.enabled=r}var t,n,r,a,o;return d()(e,[{key:"backupAll",value:(o=i()(m.a.mark((function e(t){var n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map((function(e){return n.backup(e)}))));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"backup",value:(a=i()(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:return n=t.getQuickLookUrl(),e.next=5,this.storage.write(t.id,t.getBlob(),{additions:{id:t.id,quickLookUrl:n}});case 5:!(r=t.getLastUploadError())||null!=r&&r.isNetworkError||this.drop(t.id);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"drop",value:(r=i()(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.storage.remove(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"get",value:(n=i()(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.storage.readAsBlob(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"recovery",value:(t=i()(m.a.mark((function e(){var t,n,r,a,i,o,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.list();case 2:t=e.sent,n=[],r=W(t),e.prev=5,r.s();case 7:if((a=r.n()).done){e.next=23;break}return i=a.value,e.next=11,this.storage.readAsBlob(i);case 11:return o=e.sent,e.next=14,this.storage.stat(i);case 14:if(l=e.sent,o&&l){e.next=20;break}return e.next=18,this.drop(i);case 18:e.next=21;break;case 20:n.push({path:i,blob:o,metadata:l});case 21:e.next=7;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(5),r.e(e.t0);case 28:return e.prev=28,r.f(),e.finish(28);case 31:return e.abrupt("return",n);case 32:case"end":return e.stop()}}),e,this,[[5,25,28,31]])}))),function(){return t.apply(this,arguments)})}]),e}(),X=V,K=(n("3dc8f33382"),n("c7530f2183"));function $(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Y(e){return J.apply(this,arguments)}function J(){return(J=i()(m.a.mark((function e(t){var n,r,a,i,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=[],a=$(t),e.prev=3,a.s();case 5:if((i=a.n()).done){e.next=11;break}return o=i.value,e.next=9,o.then((function(e){n.push(e)})).catch((function(e){r.push(e)}));case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:return e.abrupt("return",[n,r]);case 20:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})))).apply(this,arguments)}n("1bab7b5fb7"),n("9d7978d445");var Q,Z,ee,te,ne,re,ae=n("310c0b6a04"),ie=function(){function e(){c()(this,e)}return d()(e,null,[{key:"create",value:function(e,t){return f()({width:t.width,height:t.height,imageName:"",src:e,imageType:t.type.split("/")[1],prstGeom:{prstGeomType:"rect"}},ae.b.LOCKS,{noChangeAspect:1})}}]),e}(),oe=n("05d181ac40"),le=n("e70264714e"),se=n("2135d03ecb"),ce=function(){function e(t,n){c()(this,e),f()(this,"imageRecovery",void 0),f()(this,"eventBus",void 0),this.eventBus=t,this.imageRecovery=n}var t,n,a,o;return d()(e,[{key:"create",value:(o=i()(m.a.mark((function e(t){var n,a,i,o=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={resources:[],images:[]},i=S.a.getInstance(),t){e.next=4;break}return e.abrupt("return",a);case 4:if(K.network.isOnline||oe.a.IS_LOCAL_EDIT){e.next=7;break}return this.eventBus.emit(r.CreateImageError,[new Error(F.a.networkOffline)]),e.abrupt("return",a);case 7:return k.a.getInstance().protect(),this.eventBus.emit(r.WillCreateImages,t),e.prev=9,e.next=12,i.bulkAddImageBlobs(t);case 12:return a.resources=e.sent,e.next=15,this.clearInvalidImages(a);case 15:return e.next=17,this.buildImages(a);case 17:e.next=24;break;case 19:throw e.prev=19,e.t0=e.catch(9),k.a.getInstance().release(),this.eventBus.emit(r.DidCreateImages,a.images),e.t0;case 24:return null===(n=this.imageRecovery)||void 0===n||n.backupAll(a.resources).finally((function(){k.a.getInstance().release(),o.eventBus.emit(r.DidCreateImages,a.images)})),e.abrupt("return",a);case 26:case"end":return e.stop()}}),e,this,[[9,19]])}))),function(e){return o.apply(this,arguments)})},{key:"buildImages",value:(a=i()(m.a.mark((function e(t){var n,a,o,l,s,c,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=S.a.getInstance(),a=[],o=t.resources.map(function(){var e=i()(m.a.mark((function e(t){var r,i,o,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadMeta();case 2:if(r=e.sent,i=ie.create(t.id,r),!se.a.isGif(t.getBlob())){e.next=15;break}return e.next=7,le.b.convertTo(t.getQuickLookUrl(),le.a.JPEG,{isLimitSize:!0});case 7:return o=e.sent,e.next=10,n.addImageBlob(o);case 10:return l=e.sent,e.next=13,l.loadMeta();case 13:i.backupSrc=l.id,a.push(l);case 15:return a.push(t),e.abrupt("return",i);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Y(o);case 5:l=e.sent,s=E()(l,2),c=s[0],(u=s[1]).length>0&&this.eventBus.emit(r.CreateImageError,u),t.resources=a,t.images=c;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"clearInvalidImages",value:(n=i()(m.a.mark((function e(t){var n,r,a,i=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(t.resources.map((function(e){return i.validateImageResource(e)})));case 2:n=e.sent,r=E()(n,1),a=r[0],t.resources=a;case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"validateImageResource",value:(t=i()(m.a.mark((function e(t){var n,a,i,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=F.b.checkImageBlob(t.getBlob()),a=E()(n,2),i=a[0],o=a[1],!i){e.next=3;break}return e.abrupt("return",t);case 3:throw this.eventBus.emit(r.ValidateError,new Error(o)),new Error(o);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),ue=ce,de=n("9d90e7d680"),pe=n("d5c3deb8c7"),fe=n("8da38f8962"),ve=n("d0e9d6a0df"),he=n.n(ve),ge=n("3404d6c52c"),me=n.n(ge),be=n("8d6bbe0c96"),ye=n("020899bf26"),Se=n("16c79d63a4"),ke=n("4c10f0b0ac"),Pe=n("cd1934c1b5"),we=n("4c52987e8a");function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe=(re=ne=function(){function e(){var t,n,a,o,s=this;c()(this,e),l()(this,"imageReplacing",Z,this),l()(this,"imageReplaceAction",ee,this),l()(this,"clipDataWaiting",te,this),f()(this,"enableImageRecovery",!0),f()(this,"eventBus",Object(y.a)()),f()(this,"imageCreator",void 0),f()(this,"imageRecovery",void 0),f()(this,"menuManager",void 0),f()(this,"selectionService",void 0),f()(this,"uploadAndUpdateImages",(function(e){var t,n=function(){return s.eventBus.emit(r.DidUpload)},a=e.map((function(e){return e.onDidUpload(n)})),o=S.a.getInstance();e.forEach((function(e){var t,n,r=null===(t=ye.a.SDKDataServices.PresentationStoreService())||void 0===t?void 0:t.getPresentation();if(r){var a=e.getBlob(),i=a.type,o={size:a.size,type:i},l=(null!==(n=r.getImageResourceById(e.id))&&void 0!==n?n:{}).src;Pe.a.isBase64Url(null!=l?l:"")&&(o.src=""),r.api.updateImageResourceMap(e.id,o)}})),s.uploadImageNonBlocking(e,{onProgress:function(e){e.forEach((function(e){var t;o.mapResourceToUrl(e,e.getCdnUrl()),null===(t=s.imageRecovery)||void 0===t||t.drop(e.id)})),s.batchUpdateResourceUrls(e,e.map((function(e){return e.getCdnUrl()})))},onFinish:function(){a.forEach((function(e){return e()}))},onError:(t=i()(m.a.mark((function e(t,n){var a,i,o,l,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadMeta();case 2:a=e.sent,i=a.width,o=a.height,l=Object(de.b)(O.a.t("图片上传失败，请稍后再试。"),i,o),s.batchUpdateResourceUrls([n],[l]),s.eventBus.emit(r.UploadError,t),t.isNetworkError||null===(c=s.imageRecovery)||void 0===c||c.drop(n.id);case 9:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})})})),f()(this,"replaceImageFromFile",(function(e){var t=document.getElementById("select_pic_input");null==t||t.click(),s.imageReplaceAction=e,s.imageReplacing=!0,s.clipDataWaiting=!1})),f()(this,"replaceImageFromClipBoard",(function(t){e.getInstance().imageReplaceAction=t,e.getInstance().clipDataWaiting=!0})),f()(this,"performImageRecovery",i()(m.a.mark((function e(){var t,n,r,a,o,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(we.e)();case 2:n=null!==(t=ye.a.DocInfoManager())&&void 0!==t?t:{},r=n.globalPadId,a=void 0===r?"":r,o=n.userId,l=void 0===o?"":o,s.imageRecovery=new X([null!=a?a:"@",null!=l?l:"guest","images"],{enabled:s.enableImageRecovery}),s.imageCreator=new ue(s.eventBus,s.imageRecovery),s.imageRecovery.recovery().then(function(){var e=i()(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:return n=S.a.getInstance(),e.next=5,n.bulkAddImageBlobs(t.map((function(e){return e.blob})),t.map((function(e){return e.metadata.additions.id})));case 5:r=e.sent,s.batchUpdateResourceUrls(r,r.map((function(e){return e.id}))),s.uploadAndUpdateImages(r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)})))),function(e){var t,n=0,a=null;function i(){var e;a&&clearTimeout(a),null===(e=t)||void 0===e||e.close(),t=null}e.on(r.WillCreateImages,(function(){n+=1,i(),a=setTimeout((function(){n&&!t&&(t=U({autoClose:!1,type:"loading",message:O.a.t("正在保存图片...")}))}),1e3)})),e.on(r.DidCreateImages,(function(){(n=Math.max(0,n-1))||i()})),e.on(r.CreateImageError,(function(e){U(e.find((function(e){return e.message===F.a.networkOffline}))?{duration:5e3,type:"info",message:F.a.networkOffline}:{duration:5e3,type:"info",message:F.a.broken})})),e.on(r.ValidateError,(function(e){U({duration:5e3,type:"info",message:e.message})})),e.on(r.UploadError,(function(e){var t;20010!==e.retcode?20013!==e.retcode?e.message?U({duration:5e3,type:"info",message:e.message}):null===(t=window.log)||void 0===t||t.error("ImageEditEvents UploadError message is not exist"):Object(_.showDialogWithCode)(e.retcode,{type:H.b.SIZE_LIMIT_COOPERATION_COLLABOR},_.ESpaceAidType.INSERT_PIC_SLIDE):Object(_.showDialogWithCode)(e.retcode,{type:Object(B.c)()?H.b.SIZE_LIMIT_VIP:H.b.SIZE_LIMIT_OWNER},_.ESpaceAidType.INSERT_PIC_SLIDE)}))}(this.eventBus),M(this.eventBus),t=this.eventBus,n="[ImageEditManager]",a=function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=window.log).error.apply(e,[n].concat(r))},o=function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=window.log).info.apply(e,[n].concat(r))},t.on(r.WillCreateImages,(function(e){o("start creating image","|","total=".concat(e.length))})),t.on(r.DidCreateImages,(function(e){o("done creating image","|","success=".concat(e.length))})),t.on(r.CreateImageError,(function(e){a("failed to create image:",e)})),t.on(r.ValidateError,(function(e){o("insert an invalid image:",e)})),t.on(r.UploadError,(function(e){a("failed to upload image:",e)})),t.on(r.UploadGifError,(function(e){a("failed to upload gif:",e)})),this.imageCreator=new ue(this.eventBus),this.performImageRecovery()}var t,n,a,o,s;return d()(e,[{key:"setServicesDelegate",value:function(e){var t,n;this.menuManager=null!==(t=this.menuManager)&&void 0!==t?t:e.menuManager,this.selectionService=null!==(n=this.selectionService)&&void 0!==n?n:e.selectionService}},{key:"createEditorImages",value:(s=i()(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.imageCreator.create(t);case 2:return n=e.sent,this.uploadAndUpdateImages(n.resources),e.abrupt("return",n.images);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"bulkInsertBlobImages",value:(o=i()(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createEditorImages(t);case 2:r=e.sent,ke.a.updateImageOriginalSizeByLocalImages(r),Object(w.b)(r,null===(n=this.selectionService)||void 0===n?void 0:n.slides[this.selectionService.currentSlideIndex]);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"bulkReplaceBlobImages",value:(a=i()(m.a.mark((function e(t){var n,r,a,i=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:null===(n=this.selectionService)||void 0===n?void 0:n.getSelectedModel(),e.next=3,this.createEditorImages(t);case 3:a=e.sent,Object(w.e)(a,r);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"uploadWithoutQuickLook",value:(n=i()(m.a.mark((function e(t){var n,a,i,o,l,s,c,u,d,p,f=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=f.length>1&&void 0!==f[1]?f[1]:O.a.t("正在上传图片..."),l=f.length>2?f[2]:void 0,s=(fe.a.isMobile?he.a:me.a).show({tip:o}),e.prev=3,null===(d=ye.a.ContentStatusManager())||void 0===d||d.emitter.emit(Se.a.ResourceSyncBegin),e.next=7,be.a.uploadBlob(t[0],l);case 7:return c=e.sent,e.next=10,S.a.getInstance().createResourceIdByBlob(t[0]);case 10:u=e.sent,this.updateResourceMap(u,Ee({src:c.url},c)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),this.eventBus.emit(r.UploadError,e.t0);case 17:return e.prev=17,null===(p=ye.a.ContentStatusManager())||void 0===p||p.emitter.emit(Se.a.ResourceSyncEnd),e.finish(17);case 20:return s.close(),e.abrupt("return",[{id:null!==(n=u)&&void 0!==n?n:"",src:null!==(a=null===(i=c)||void 0===i?void 0:i.url)&&void 0!==a?a:""}]);case 22:case"end":return e.stop()}}),e,this,[[3,14,17,20]])}))),function(e){return n.apply(this,arguments)})},{key:"uploadImageNonBlocking",value:(t=i()(m.a.mark((function e(t,n){var r,a,i,o,l,s,c,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.onProgress,i=void 0===a?function(){}:a,o=n.onError,l=void 0===o?function(){}:o,s=n.onFinish,c=void 0===s?function(){}:s,t.length){e.next=3;break}return e.abrupt("return");case 3:u=new P.a,k.a.getInstance().protect(),null===(r=ye.a.ContentStatusManager())||void 0===r||r.emitter.emit(Se.a.ResourceSyncBegin),u.onProgress(i),u.onError(l),u.onFinish((function(){var e;c(),null===(e=ye.a.ContentStatusManager())||void 0===e||e.emitter.emit(Se.a.ResourceSyncEnd),k.a.getInstance().release()})),u.enqueue(t);case 10:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"batchUpdateResourceUrls",value:function(e,t){var n=this;Object(b.b)((function(){e.forEach((function(e,r){e.loadMeta().then((function(a){n.updateResourceMap(e.id,Ee({src:t[r]},a))}))}))}))}},{key:"updateResourceMap",value:function(e,t){var n;null===(n=ye.a.SDKDataServices.PresentationStoreService())||void 0===n||n.getPresentation().api.updateImageResourceMap(e,{src:t.src,width:t.width,height:t.height,size:t.size,type:t.type})}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}(),f()(ne,"instance",void 0),Q=re,Z=h()(Q.prototype,"imageReplacing",[pe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ee=h()(Q.prototype,"imageReplaceAction",[pe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),te=h()(Q.prototype,"clipDataWaiting",[pe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Q)},"5c59da31dd":function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n("85d0a7609b"),a=n.n(r),i=n("14502724a6"),o=n.n(i),l=n("9132715560"),s=n.n(l),c=n("6a364eb35c"),u=n.n(c),d=(n("8ee19818c4"),n("342844cefa"),n("cd88b12bb6"),n("6e20b6a7d8"),n("0acdc5834b"),n("8a35b54c1d"),n("b8217400dc"),n("e6f68cdf2e"),n("b1e2246d82"),n("75563bc376"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36"),n("7c46f42788")),p=n("711a53c9fc"),f=n("a42b29265b"),v=n("a7888a8b87"),h=n.n(v),g=n("020899bf26"),m=n("98efcda99e"),b=n.n(m),y=n("ee6bb53310"),S=n.n(y),k=n("45004b03ed"),P=n("0cbec907c5");function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=function(){function e(){s()(this,e)}return u()(e,null,[{key:"reorganizeSlideSdkData",value:function(e){var t,n=this,r=e.clipboardData,a=e.insertSlideIndex,i=e.sdkDataV3,o=e.slideSdkDataModify,l=(e.uiDataService,r.data),s=r.globalPadId!==(null===(t=g.a.DocInfoManager())||void 0===t?void 0:t.globalPadId),c=r,u=c.slideSize,d=c.layoutList;l.forEach((function(e){var t,r,a,i,o,l,s,c,u,d,p,f;n.modifyPrstGeomAdjName(null===(t=e.ownSdkData)||void 0===t||null===(r=t.cSld)||void 0===r||null===(a=r.spTree)||void 0===a?void 0:a.shapeList),n.modifyPrstGeomAdjName(null===(i=e.inheritedSdkData)||void 0===i||null===(o=i.cSld)||void 0===o||null===(l=o.spTree)||void 0===l?void 0:l.shapeList),n.addPrstGeomInPicture(null===(s=e.ownSdkData)||void 0===s||null===(c=s.cSld)||void 0===c||null===(u=c.spTree)||void 0===u?void 0:u.shapeList),n.addPrstGeomInPicture(null===(d=e.inheritedSdkData)||void 0===d||null===(p=d.cSld)||void 0===p||null===(f=p.spTree)||void 0===f?void 0:f.shapeList)}));var p=h()(l);return p.forEach((function(e){var t=d&&n.getDestinationLayoutId(a,i,e.ownSdkData,d);Object.keys(e).forEach((function(n){var a=e[n];if(s&&r.slideSize){var i=!!t;o.adjustPageData(a,u,i)}n===f.a.OWN&&t&&(a.layoutId=t),Reflect.deleteProperty(a,"noteSlideId")}))})),p}},{key:"updateResourceMap",value:function(e){var t,n=e.presentation,r=e.resourceMap,a=e.copiedDocId;(Object.keys(r.audios).length||Object.keys(r.videos).length)&&a!==(null===(t=g.a.DocInfoManager())||void 0===t?void 0:t.globalPadId)&&(r.audios={},r.videos={}),n.api.updateResourceMap(r)}},{key:"removeAttachment",value:function(e){var t,n=this;return e.globalPadId!==(null===(t=g.a.DocInfoManager())||void 0===t?void 0:t.globalPadId)&&[e.data.map((function(e){return e.ownSdkData})),e.data.map((function(e){return e.inheritedSdkData}))].reduce((function(e,t){return n.removeMediaProperty(t)||e}),!1)}},{key:"updatePlaceHolderData",value:function(e,t){var n,r;if(null==e||null===(n=e.nvPr)||void 0===n||!n.ph)return e;var a=null===(r=g.a.SDKDataServices.DataHelper())||void 0===r?void 0:r.getInheritedDataFromPlaceholder(e,t);return a?(b()(null==a?void 0:a.nvPr,"ph"),a):(b()(null==e?void 0:e.nvPr,"ph"),e)}},{key:"modifyPrstGeomAdjName",value:function(e){var t;(null!==(t=null==e?void 0:e.filter((function(e){var t,n,r;return((null==e?void 0:e.type)===d.a.Shape||(null==e?void 0:e.type)===d.a.Picture)&&(null===(t=e.spPr)||void 0===t||null===(n=t.prstGeom)||void 0===n||null===(r=n.avLst)||void 0===r?void 0:r.gd)})))&&void 0!==t?t:[]).forEach((function(e){var t,n,r,a,i,o=(null!==(t=null===(n=e.spPr)||void 0===n||null===(r=n.prstGeom)||void 0===r?void 0:r.avLst)&&void 0!==t?t:{}).gd,l=void 0===o?[]:o;if(null!==(a=e.spPr)&&void 0!==a&&null!==(i=a.prstGeom)&&void 0!==i&&i.prst){var s=p.gb[e.spPr.prstGeom.prst];l.forEach((function(e,t){if(Object.keys(k.b).includes(s)){var n=k.b[s];if(t<=n.length)return void(e.name=n[t])}1!==l.length||s.includes("Connector")?e.name="adj".concat(t+1):e.name="adj"}))}}))}},{key:"addPrstGeomInPicture",value:function(e){var t;(null!==(t=null==e?void 0:e.filter((function(e){var t;return(null==e?void 0:e.type)===d.a.Picture&&!(null!==(t=e.spPr)&&void 0!==t&&t.prstGeom)})))&&void 0!==t?t:[]).forEach((function(e){e.spPr&&(e.spPr.prstGeom={prst:p.gb.rect})}))}},{key:"getDestinationLayoutId",value:function(e,t,n,r){var a,i,l,s=this.getCopiedLayoutData(n,r);if(s){var c=null===(a=s.cSld)||void 0===a?void 0:a.name,u=null==t||null===(i=t.slideList)||void 0===i||null===(l=i[e])||void 0===l?void 0:l.getMaster();if(u){var d=u.layoutList,p=null==d?void 0:d.find((function(e){var t;return(null===(t=e.props.data.cSld)||void 0===t?void 0:t.name)===c}));if(p)return p.id;var f=t.api.addLayouts([C(C({},s),{},{masterId:u.id})],u.layoutList.length);return o()(f,1)[0].get(s.id)}}}},{key:"getCopiedLayoutData",value:function(e,t){var n=e.layoutId;if(n){var r=t.find((function(e){var t;return(null==e||null===(t=e.ownSdkData)||void 0===t?void 0:t.id)===n}));return null==r?void 0:r.ownSdkData}}},{key:"removeMediaProperty",value:function(e){var t=this;return!(null==e||!e.length)&&e.reduce((function(e,n){if(n.type===d.a.Picture){var r,a;if(null!==(r=n.nvPr)&&void 0!==r&&r.egMedia)return b()(n.nvPr,"egMedia"),b()(n.nvPr,"hlinkClick"),!0;if(null!==(a=n.nvPr)&&void 0!==a&&a.attachment)return b()(n.nvPr,"attachment"),S()(n,"blipFill.blip.embed",P.q),S()(n,"blipFill.srcRect",{b:0,l:0,t:0,r:0}),!0}var i;if(n.type===d.a.Shape)return null!==(i=n.nvPr)&&void 0!==i&&i.attachment?(b()(n.nvPr,"attachment"),!0):e;if(n.type===d.a.Slide){var o,l,s=null===(o=n.cSld)||void 0===o||null===(l=o.spTree)||void 0===l?void 0:l.shapeList;return t.removeMediaProperty(s)}if(n.type===d.a.GroupShape){var c=null==n?void 0:n.shapeList;return t.removeMediaProperty(c)}return e}),!1)}}]),e}()},"692b88f5a6":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("14502724a6"),a=n.n(r),i=n("9132715560"),o=n.n(i),l=n("6a364eb35c"),s=n.n(l),c=n("85d0a7609b"),u=n.n(c),d=(n("8ee19818c4"),n("7c46f42788")),p=n("98efcda99e"),f=n.n(p),v=n("8f58e78419"),h=n.n(v),g=n("020899bf26"),m=function(){function e(){var t=this;o()(this,e),u()(this,"uiDataService",void 0),u()(this,"selectionService",void 0),u()(this,"adjustPageData",(function(e,n,r){if(!r){var a=t.getLayout();e.layoutId=a.id}if(n){var i,o,l,s,c,u=n.width,d=n.height,p=null===(i=g.a.SDKDataServices.PresentationStoreService())||void 0===i?void 0:i.getPresentation(),f=(null==p?void 0:p.props.sldSz.cx)||0,v=(null==p?void 0:p.props.sldSz.cy)||0,h=0,m=0,b=0,y=v/d;if(f/u<=v/d)m=(v-d*(h=f/u))/2;else b=(f-u*(h=v/d))/2;if(null!=e&&null!==(o=e.cSld)&&void 0!==o&&null!==(l=o.spTree)&&void 0!==l&&l.shapeList)null==e||null===(s=e.cSld)||void 0===s||null===(c=s.spTree)||void 0===c||c.shapeList.forEach((function(e){var n,r,a,i,o,l,s,c,u,d,p,f;null!==(n=e.spPr.xfrm)&&void 0!==n&&null!==(r=n.off)&&void 0!==r&&r.x&&(e.spPr.xfrm.off.x=(null===(u=e.spPr.xfrm)||void 0===u||null===(d=u.off)||void 0===d?void 0:d.x)*h+b);null!==(a=e.spPr.xfrm)&&void 0!==a&&null!==(i=a.off)&&void 0!==i&&i.y&&(e.spPr.xfrm.off.y=(null===(p=e.spPr.xfrm)||void 0===p||null===(f=p.off)||void 0===f?void 0:f.y)*y+m);null!==(o=e.spPr.xfrm)&&void 0!==o&&null!==(l=o.ext)&&void 0!==l&&l.cx&&(e.spPr.xfrm.ext.cx*=h),null!==(s=e.spPr.xfrm)&&void 0!==s&&null!==(c=s.ext)&&void 0!==c&&c.cy&&(e.spPr.xfrm.ext.cy*=h),t.adaptElement(e,h,y)}))}}))}return s()(e,[{key:"setServiceDelegates",value:function(e){var t,n;this.uiDataService=null!==(t=this.uiDataService)&&void 0!==t?t:e.uiDataService,this.selectionService=null!==(n=this.selectionService)&&void 0!==n?n:e.selectionService}},{key:"getLayout",value:function(){var e;if(this.checkStateForLayout())e=a()(this.uiDataService.presentation.masterList[0].layoutList,1)[0];else try{for(var t,n,r,i,o,l,s=null===(t=this.selectionService)||void 0===t?void 0:t.currentSlide,c=-1,u=(null!==(n=null===(r=this.uiDataService)||void 0===r?void 0:r.presentation)&&void 0!==n?n:{masterList:[]}).masterList,d=0;d<u.length;d++){var p,f;if((null==s||null===(p=s.sdkData)||void 0===p||null===(f=p.getMaster())||void 0===f?void 0:f.id)===u[d].id){c=d;break}}-1===c&&(c=0);for(var v=-1,h=(null!==(i=null===(o=this.uiDataService)||void 0===o?void 0:o.presentation.masterList[c])&&void 0!==i?i:{layoutList:[]}).layoutList,g=0;g<h.length;g++){var m,b;if((null==s||null===(m=s.sdkData)||void 0===m||null===(b=m.props)||void 0===b?void 0:b.layoutId)===h[g].id){v=g;break}}-1===v&&(v=0),e=null===(l=this.uiDataService)||void 0===l?void 0:l.presentation.masterList[c].layoutList[v]}catch(t){var y,S;if((null!==(y=null===(S=this.uiDataService)||void 0===S?void 0:S.presentation.masterList.length)&&void 0!==y?y:0)>0)e=a()(this.uiDataService.presentation.masterList[0].layoutList,1)[0];else e={id:0}}return e}},{key:"checkStateForLayout",value:function(){var e,t,n;return 0===(null===(e=this.selectionService)||void 0===e?void 0:e.slideClearanceIndex)||-1===(null===(t=this.selectionService)||void 0===t?void 0:t.slideClearanceIndex)&&-1===(null===(n=this.selectionService)||void 0===n?void 0:n.currentSlideIndex)}},{key:"checkPlaceHolder",value:function(e){var t=e.slideData;h()(t,"groupShape.children.length")>0&&t.groupShape.children.forEach((function(e){"shape"===e.type&&e.isPlaceholder&&f()(e.props,"placeholder")}))}},{key:"adaptElement",value:function(e,t,n){var r;e.type===d.a.GroupShape&&this.adaptInnerGroupShape(e,t),e.type===d.a.Shape&&null!==(r=e.txBody)&&void 0!==r&&r.p&&this.adaptTextBody(e.txBody,t),e.type===d.a.GraphicalObjectFrameTable&&this.adaptTable(e,t,n)}},{key:"adaptInnerGroupShape",value:function(e,t){var n,r=this;null!==(n=e.shapeList)&&void 0!==n&&n.length&&e.shapeList.forEach((function(e){var n;e.type===d.a.GroupShape&&r.adaptInnerGroupShape(e,t),e.type===d.a.Shape&&null!==(n=e.txBody)&&void 0!==n&&n.p&&r.adaptTextBody(e.txBody,t)}))}},{key:"adaptTable",value:function(e,t,n){var r,a,i,o,l,s,c,u,d,p=this;null!==(r=e.graphic)&&void 0!==r&&null!==(a=r.graphicData)&&void 0!==a&&a.tbl&&(null===(i=e.graphic)||void 0===i||null===(o=i.graphicData)||void 0===o||null===(l=o.tbl.tblGrid)||void 0===l||null===(s=l.gridCol)||void 0===s||s.forEach((function(e){e.w&&(e.w*=t)})),null===(c=e.graphic)||void 0===c||null===(u=c.graphicData)||void 0===u||null===(d=u.tbl.tr)||void 0===d||d.forEach((function(e){var n;e.h&&(e.h*=t),null===(n=e.tc)||void 0===n||n.forEach((function(e){e.txBody&&p.adaptTextBody(e.txBody,t)}))})))}},{key:"adaptTextBody",value:function(e,t){null!=e&&e.p&&e.p.forEach((function(e){var n,r,a,i,o,l,s,c;(null===(n=e.egTextRun)||void 0===n||n.forEach((function(e){var n,r=null===(n=e.fld||e.r)||void 0===n?void 0:n.rPr;null!=r&&r.sz&&(r.sz*=t)})),e.pPr)&&(e.pPr.indent&&(e.pPr.indent*=t),e.pPr.marL&&(e.pPr.marL*=t),null!==(a=e.pPr.lnSpc)&&void 0!==a&&null!==(i=a.spcPts)&&void 0!==i&&i.val&&(e.pPr.lnSpc.spcPts.val*=t),null!==(o=e.pPr.spcAft)&&void 0!==o&&null!==(l=o.spcPts)&&void 0!==l&&l.val&&(e.pPr.spcAft.spcPts.val*=t),null!==(s=e.pPr.spcBef)&&void 0!==s&&null!==(c=s.spcPts)&&void 0!==c&&c.val&&(e.pPr.spcBef.spcPts.val*=t));null!==(r=e.endParaRPr)&&void 0!==r&&r.sz&&(e.endParaRPr.sz*=t)})),this.lineIndent(e,t)}},{key:"lineIndent",value:function(e,t){e.bodyPr&&(1!==t&&e.bodyPr.normAutofit&&f()(e.bodyPr.normAutofit,"fontScale"),e.bodyPr.bIns&&(e.bodyPr.bIns*=t),e.bodyPr.lIns&&(e.bodyPr.lIns*=t),e.bodyPr.rIns&&(e.bodyPr.rIns*=t),e.bodyPr.tIns&&(e.bodyPr.tIns*=t))}}]),e}()},6986953439:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var r=n("14502724a6"),a=n.n(r),i=n("6a364eb35c"),o=n.n(i),l=n("9132715560"),s=n.n(l),c=n("85d0a7609b"),u=n.n(c),d=(n("7a3400cab1"),n("8ee19818c4"),n("a2a09da1e3"),n("1bab7b5fb7"),n("34cd92f77a"),n("6e20b6a7d8"),n("9d7978d445"),n("7eaa8e90a5"),n("3bf1976a4f"),n("433247001a"),n("bd80bf2d0f"),n("759492dad9"),n("963f2eaace"),n("3cc783627f")),p=n("bfece3da65"),f=n("db587ce538"),v=n("e6d4dedbba"),h=n("54bdd803dc"),g=n.n(h),m=n("91dde34995"),b=n.n(m),y=n("98efcda99e"),S=n.n(y),k=n("8f58e78419"),P=n.n(k),w=n("ee6bb53310"),C=n.n(w),E=n("20b8185c8f"),x=function e(){s()(this,e),u()(this,"lnT",void 0),u()(this,"lnR",void 0),u()(this,"lnB",void 0),u()(this,"lnL",void 0),u()(this,"solidFill",void 0)},D=function(){function e(){var t=this;s()(this,e),u()(this,"mSOStyle",void 0),u()(this,"parseTableNodeToSdkData",(function(e,n){var r,a,i,o,l,s,c,u,p,v=f.a.makeDefaultSdkData(0,0,0,0,0,0),h=(null===(r=v.graphic)||void 0===r||null===(a=r.graphicData)||void 0===a||null===(i=a.tbl)||void 0===i||null===(o=i.tblGrid)||void 0===o?void 0:o.gridCol)||[],g=(null===(l=v.graphic)||void 0===l||null===(s=l.graphicData)||void 0===s||null===(c=s.tbl)||void 0===c?void 0:c.tr)||[],m=e.getElementsByTagName("tbody")[0];if(m){var b=0,y=e.getElementsByTagName("col"),S=function(e){var t=e.style.width;return{w:parseInt(t)*d.i}};!function(){for(var e=0;e<y.length;e++){var t=y[e].getAttribute("span");if(t)for(var n=parseInt(t),r=0;r<n;r++){var a=S(y[e]);h.push(a)}else{var i=S(y[e]);h.push(i)}}}();var k=m.getElementsByTagName("tr");if(k){var P=function(e){return e.getAttribute("colspan")?parseInt(e.getAttribute("colspan")):1},w=k.length,C=0;if(w>0){for(var E=0;E<k[0].children.length;E++){C+=P(k[0].children[E])}for(var x=[],D=0;D<w;D++){g.push({tc:new Array(C)});for(var T=[],I=0;I<k[D].children.length;I++)T.push(k[D].children[I]);k[D].tc=T,x.push(k[D])}b=t.processCells(x,g,b,n)}var M=e.style,O=parseInt(M.width);return O||(O=0,h.forEach((function(e){O+=e.w||0})),O/=d.i),O||(O=800),function(e,t){if(h&&h.length<1)for(var n=e/t,r=0;r<t;r++){var a={w:n*d.i};h.push(a)}}(O,C),null!=v&&null!==(u=v.spPr)&&void 0!==u&&null!==(p=u.xfrm)&&void 0!==p&&p.ext&&(v.spPr.xfrm.ext.cx=O*d.i,v.spPr.xfrm.ext.cy=b*d.i),v}}})),u()(this,"parseTextNodeToTextBody",(function(e){var n;if(e){var r;3===e.nodeType?e.innerText=e.textContent:r=e.innerHTML,null!==(n=r)&&void 0!==n&&n.indexOf(/<span style="mso-spacerun:yes">/)&&(e.innerHTML=r.replace(/<span .*style="mso-spacerun:yes">\s*<\/span>/g,""));var a=e.innerText||e.textContent||"",i={p:[]},o={r:{rPr:{lang:"zh-CN"},t:""}};o.t=a;var l=t.getNodeComputedStyle(e);l=l||e.style;var s=Object(d.f)(l.color);s&&(o.r.rPr.solidFill={egColorChoice:{srgbClr:{val:s}}});var c=l["font-size"];return c&&(o.r.rPr.sz=parseInt(c)*d.h),i.p.push({egTextRun:[o]}),i}}))}return o()(e,[{key:"initParser",value:function(e){this.mSOStyle=e}},{key:"processCells",value:function(e,t,n,r){var a=this;return e.forEach((function(i,o){var l=t[o],s=l.tc,c=0,u=0,f=a.getNodeComputedStyle(i).height,v=parseInt(f);v||(v=28),C()(l,"h",v*d.i),n+=v;for(var h=function(e,t){return t.getAttribute(e)?parseInt(t.getAttribute(e)):0};c<i.tc.length;){for(var m=i.tc[c],y=h("colspan",m),k=h("rowspan",m),P={txBody:{p:[]}},w=u;w<s.length;w++)if(void 0===s[w]){s[w]=P,u=w;break}var E=a.getTcPr(m);!g()(E,{})&&C()(P,"tcPr",E);var x=r.parseNodes(m);if(function(e){return e.nodes&&e.nodes.length>0}(x)){var D=p.a.getSingleton().getTextBodyByNodes(x.nodes);C()(P,"txBody",D)}k>1?(C()(P,"rowSpan",k),a.processMergedCell(e,o,k,t,u,y,P)):y>1&&(C()(P,"gridSpan",y),b()(t[o].tc,{hMerge:1,txBody:{p:[]}},u+1,u+y)),u+=y||1,c+=1}S()(i,"tc")})),n}},{key:"getTcPr",value:function(e){var t=this,n=new x,r=t.getNodeComputedStyle(e)||e.style,i=r["border-width"];i&&i.length>0&&function(){var e=r["border-style"],o=r["border-color"],l=t.getBorderPropsByAttr(i,e,o);if(function(e){return e&&4===e.length}(l)){var s=a()(l,4);n.lnT=s[0],n.lnR=s[1],n.lnB=s[2],n.lnL=s[3]}}();var o=r.border;if(this.checkStyle(o)){var l=this.getBorderProps(o);l&&(n.lnT=l,n.lnB=l,n.lnL=l,n.lnR=l)}var s=r["border-top"];if(this.checkStyle(s)){var c=this.getBorderProps(s);n.lnT=c}var u=r["border-bottom"];if(this.checkStyle(u)){var p=this.getBorderProps(u);n.lnB=p}var f=r["border-left"];if(this.checkStyle(f)){var v=this.getBorderProps(f);n.lnL=v}var h=r["border-right"];if(this.checkStyle(h)){var g=this.getBorderProps(h);n.lnR=g}var m=r.background||r["background-color"],b=Object(d.f)(m);return b&&C()(n,"solidFill.egColorChoice.srgbClr.val",b),n}},{key:"checkStyle",value:function(e){return e&&"none"!==e}},{key:"getBorderPropsByAttr",value:function(e,t,n){if(e&&t&&n){var r=[];for(e&&(r=e.split(" ").map((function(e){return parseFloat(e)})));r.length<4;)r.push(0);for(var a=[],i=n.replace(/\s+/g,""),o=0,l=i.indexOf(")",o);l>0;){l+=1;var s=i.substring(o,l);s=Object(d.f)(s),a.push(s),o=l,l=i.indexOf(")",o)}for(function(e,t){return 0===e.length&&t<0}(a,l)&&n.split(" ").forEach((function(e){var t=Object(d.f)(e);a.push(t)}));a.length<4;)a.push(a[a.length-1]);for(var c=[],u=0;u<4;u++){var p=r[u]*d.i,f=a[u],h={w:p,egLineDashProperties:{prstDash:{val:Object(E.a)(v.a).get(t)}},egLineFillProperties:{solidFill:{egColorChoice:{srgbClr:{val:f}}}}};c.push(h)}return c}}},{key:"getBorderProps",value:function(e){var t=function(e,t,n){for(var r=e.indexOf(t),a=0;a<n;a++)r=e.indexOf(t,r+1);return r},n=t(e," ",0),r=t(e," ",1),a=e.substring(0,n),i=e.substring(n+1,r),o=e.substring(r+1),l=0;a&&(l=parseFloat(a)),"windowtext"===o&&(o="black");var s=Object(d.f)(o);if(s)return{w:l*d.i,egLineDashProperties:{prstDash:{val:Object(E.a)(v.a).get(i)}},egLineFillProperties:{solidFill:{egColorChoice:{srgbClr:{val:s}}}}}}},{key:"getNodeComputedStyle",value:function(e){var t,n=null===(t=this.mSOStyle)||void 0===t?void 0:t.getComputedStyle(e);return n||(n=e.style),n}},{key:"getLnHtmlStyle",value:function(e){var t,n,r,a,i,o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s="";e.egLineFillProperties&&(s+=null!==(t=e.egLineFillProperties)&&void 0!==t&&t.noFill?"":"".concat(l," ").concat(e.w/d.i,"pt"));s&&(s+=" ".concat(v.a.get(null===(n=e.egLineDashProperties)||void 0===n||null===(r=n.prstDash)||void 0===r?void 0:r.val)||"solid"));s&&(s+=" ".concat(this.getEgColorChoiceRgba(null===(a=e.egLineFillProperties)||void 0===a||null===(i=a.solidFill)||void 0===i||null===(o=i.egColorChoice)||void 0===o?void 0:o.srgbClr)||"#000000"));return"".concat(s,";")}},{key:"getBorderStyleSingleContent",value:function(e,t){var n=this,r="",a=function(e,t){return t.egLineFillProperties.noFill?"":"".concat(e,": ").concat(n.getLnHtmlStyle(t),";")};P()(t,"tcPr.lnT.egLineFillProperties.solidFill.egColorChoice")&&(r+=a("border-top",t.tcPr.lnT));P()(t,"tcPr.lnR.egLineFillProperties.solidFill.egColorChoice")&&(r+=a("border-right",t.tcPr.lnR));P()(t,"tcPr.lnB.egLineFillProperties.solidFill.egColorChoice")&&(r+=a("border-bottom",t.tcPr.lnB));P()(t,"tcPr.lnL.egLineFillProperties.solidFill.egColorChoice")&&(r+=a("border-left",t.tcPr.lnL));return r}},{key:"getBorderStyleContent",value:function(e){var t="";if(e.tcPr){var n,r,a;t=this.getBorderStyleSingleContent(t,e);try{var i=JSON.stringify(e.tcPr.lnT),o=JSON.stringify(e.tcPr.lnR),l=JSON.stringify(e.tcPr.lnB),s=JSON.stringify(e.tcPr.lnL);if(function(e,t,n,r){return e===t&&t===n&&n===r}(i,o,l,s)){var c=e.tcPr.lnT;t+=this.getLnHtmlStyle(c,"border:")}}catch(e){var u;null===(u=window.log)||void 0===u||u.error(e)}if(null!=e&&null!==(n=e.tcPr)&&void 0!==n&&null!==(r=n.solidFill)&&void 0!==r&&null!==(a=r.egColorChoice)&&void 0!==a&&a.srgbClr){var d=this.getEgColorChoiceRgba(e.tcPr.solidFill.egColorChoice.srgbClr);t+="background:".concat(d,";"),t+="background-color:".concat(d,";")}}return t}},{key:"parseSdkDataToHtml",value:function(e){var t=this,n=document.createElement("html");n.setAttribute("xmlns:x","tencent");var r=document.createElement("head"),a=document.createElement("style");a.setAttribute("type","text/css");var i=document.createElement("body"),o=document.createTextNode("\x3c!--StartFragment--\x3e");i.appendChild(o);var l=document.createElement("table");l.setAttribute("style","border-collapse:collapse"),l.setAttribute("selecttype","cells");var s=[],c=e.graphic.graphicData.tbl.tblGrid.gridCol,u=e.graphic.graphicData.tbl.tr;c.forEach((function(e){var t=document.createElement("col"),n=e.w/d.i;s.push(n),t.setAttribute("width","".concat(1.34*n));var r="width:".concat(n,"pt");t.setAttribute("style",r),l.appendChild(t)}));var p=[];u.forEach((function(e){var t=e.h/d.i;p.push(t)}));var f="td{padding-top:1px;padding-right:1px;padding-left:1px;color:black;font-size:18.0pt;font-weight:400;font-style:normal;text-decoration:none;font-family:DengXian;text-align:general;vertical-align:bottom;border:none;white-space:nowrap;}ruby{ruby-align:left;}rt{color:windowtext;font-size:9.0pt;font-weight:400;font-style:normal;text-decoration:none;font-family:DengXian;display:none;}",v=65;u.forEach((function(e,n){var r=e.h/d.i,a=document.createElement("tr");a.setAttribute("height","".concat(r));var i="height:".concat(r);a.setAttribute("style",i),e.tc.forEach((function(e,r){if(!e.hMerge&&!e.vMerge){var i=document.createElement("td"),o=s[r],l=p[n];if(e.gridSpan){i.setAttribute("colspan","".concat(e.gridSpan));for(var c=1;c<e.gridSpan;c++)o+=s[r+c]}if(e.rowSpan){i.setAttribute("rowspan","".concat(e.rowSpan));for(var u=1;u<e.rowSpan;u++)l+=p[n+u]}i.setAttribute("width","".concat(o)),i.setAttribute("height","".concat(l));var h="xl".concat(v);v+=1,i.setAttribute("class",h);var g=".".concat(h,"{"),m="";m+="height:".concat(l,"pt;"),g+=t.getBorderStyleContent(e),g+="}",i.setAttribute("style",m),f+=g;var b=Object(d.m)(e);i.innerHTML=b,a.appendChild(i)}})),l.appendChild(a)})),f="\x3c!--".concat(f,"--\x3e");var h=document.createTextNode(f);a.appendChild(h),r.appendChild(a),n.appendChild(r),i.appendChild(l);var g=document.createTextNode("\x3c!--EndFragment--\x3e");i.appendChild(g),n.appendChild(i);var m=n.outerHTML;return m=(m=m.replace(new RegExp(/&lt;!--StartFragment--&gt;/,"gm"),"\x3c!--StartFragment--\x3e")).replace(new RegExp(/&lt;!--EndFragment--&gt;/,"gm"),"\x3c!--EndFragment--\x3e")}},{key:"parseSdkDataToPlainText",value:function(e){var t=[];return e.graphic.graphicData.tbl.tr.forEach((function(e){var n=[];e.tc.forEach((function(e){n.push(function(e){var t,n="",r=null===(t=e.txBody)||void 0===t?void 0:t.p;return(null==r?void 0:r.length)>0&&r.forEach((function(e){var t;null===(t=e.egTextRun)||void 0===t||t.forEach((function(e){var t=((null==e?void 0:e.r)||{}).t;n+=t||""}))})),n}(e))})),t.push(n.join("\t"))})),t.join("\n\r")}},{key:"processMergedCell",value:function(e,t,n,r,a,i,o){e.slice(t,t+n).forEach((function(e,n){n>0&&(r[t+n].tc[a]={vMerge:1,txBody:{p:[]}}),i&&i>1&&(C()(o,"gridSpan",i),b()(r[t+n].tc,0===n?{hMerge:1,txBody:{p:[]}}:{hMerge:1,vMerge:1,txBody:{p:[]}},a+1,a+i))}))}},{key:"getEgColorChoiceRgba",value:function(e){return"#".concat(e.val.replace("#",""))}}]),e}();u()(D,"instance",void 0),u()(D,"getSingleton",(function(){return D.instance||(D.instance=new D),D.instance}))},"6ba11f23ff":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=["src","backupSrc","embed"],a=["chartRelation","chartStaticFolder"]},"7390ec1f17":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var r=n("9132715560"),a=n.n(r),i=n("6a364eb35c"),o=n.n(i),l=n("85d0a7609b"),s=n.n(l),c=(n("968ee3f7e6"),n("6e20b6a7d8"),n("7f8cedd859"),n("826dc923b3"),n("b1e2246d82"),n("75563bc376"),n("69084d01d3")),u=n.n(c),d=n("52d461bc51"),p=n("d436b8c143"),f=n("5fac0349d3"),v=n("116dfe1d48"),h=function(){function e(){a()(this,e),s()(this,"chartModel",void 0),s()(this,"isModalShown",!1),s()(this,"selectedSeriesIdx",void 0),s()(this,"trendlineType",void 0)}return o()(e,[{key:"showSeriesSelectModal",value:function(e,t){var n=this;this.isModalShown||(this.chartModel=e,this.trendlineType=t,d.Modal.confirm({title:f.a.t("添加趋势线"),content:this.getSeriesSelect(),onOk:function(){n.handleTrendlineCommit(),n.onModalClose()},onCancel:function(){return n.onModalClose()},onClose:function(){return n.onModalClose()}}),this.isModalShown=!0)}},{key:"onModalClose",value:function(){this.isModalShown=!1,this.selectedSeriesIdx=void 0,this.trendlineType=void 0,this.chartModel=void 0}},{key:"getSeriesSelect",value:function(){var e=this;if(this.chartModel){var t=this.chartModel.plotArea.charts.map((function(e){return e.series})).flat();return this.selectedSeriesIdx=t[0].idx,u.a.createElement(p.Select,{style:{width:350},onChange:function(t){return e.selectedSeriesIdx=Number.parseInt(t,10)},defaultValue:"".concat(t[0].idx)},t.map((function(e){return u.a.createElement(p.Select.Option,{key:e.idx,value:"".concat(e.idx)},e.name)})))}}},{key:"handleTrendlineCommit",value:function(){var e=this;if(this.chartModel){var t=this.chartModel.plotArea.charts.map((function(e){return e.getSubChartProperty().series})).flat().find((function(t){return t.idx===e.selectedSeriesIdx}));t&&t.createTrendline(this.trendlineType||v.y.linear)}}}]),e}()},"767dcfbe00":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.foreground=1]="foreground",e[e.background=2]="background",e[e.text=3]="text",e[e.multi=4]="multi"}(r||(r={}))},"7b360969bf":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("b8e6877859"),a=Object(r.a)()},"8897cfe637":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"h",(function(){return p}));var r=1,a=1,i=16,o=1,l=2,s=0,c=0,u=40.64,d=.1,p=7},"8c101803a8":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("9132715560"),a=n.n(r),i=n("6a364eb35c"),o=n.n(i),l=n("85d0a7609b"),s=n.n(l),c=(n("8ee19818c4"),n("826dc923b3"),n("ee6bb53310")),u=n.n(c),d=n("e0e8dd9366"),p=n("a42b29265b"),f=function(){function e(){a()(this,e)}return o()(e,null,[{key:"adjustElementPosition",value:function(t,n,r){var a,i,o=0,l=0,s=!1;(n&&function n(a){var i;(null===(i=a.children)||void 0===i?void 0:i.length)&&a.children.forEach((function(a){var i,c,u;switch(a.type===d.d.GROUP&&n(a),r){case p.a.OWN:u=null===(i=a.sdkData.getOwnedData().spPr)||void 0===i?void 0:i.xfrm;break;case p.a.INHERIT:u=null===(c=a.sdkData.props.spPr)||void 0===c?void 0:c.xfrm;break;default:var f;u=null===(f=a.sdkData.props.spPr)||void 0===f?void 0:f.xfrm}if(e.checkFrame(u,t,o,l))return s=!0,o+=1e5,l+=1e5,!1}))}(n),s)&&(void 0!==(null===(a=t.spPr)||void 0===a||null===(i=a.xfrm)||void 0===i?void 0:i.off)?(t.spPr.xfrm.off.x+=o,t.spPr.xfrm.off.y+=l):(u()(t,"spPr.xfrm.off.x",0),u()(t,"spPr.xfrm.off.y",0)))}},{key:"checkFrame",value:function(e,t,n,r){var a,i,o,l,s,c,u,d,p,f;return(null==e?void 0:e.off)&&(null===(a=t.spPr)||void 0===a||null===(i=a.xfrm)||void 0===i?void 0:i.off)&&(null===(o=e.off)||void 0===o?void 0:o.x)===Number(null===(l=t.spPr.xfrm.off)||void 0===l?void 0:l.x)+n&&(null===(s=e.off)||void 0===s?void 0:s.y)===Number(null===(c=t.spPr.xfrm.off)||void 0===c?void 0:c.y)+r&&(null===(u=e.ext)||void 0===u?void 0:u.cx)===(null===(d=t.spPr.xfrm.ext)||void 0===d?void 0:d.cx)&&(null===(p=e.ext)||void 0===p?void 0:p.cy)===(null===(f=t.spPr.xfrm.ext)||void 0===f?void 0:f.cy)}}]),e}();s()(f,"checkAndAdjustElementPosition",(function(e){for(var t=0;t<e.length;t++)for(var n=e[t],r=0;r<t;r++){var a,i,o,l,s,c,d,p,f,v,h,g,m=e[r];if(null!==(a=m.spPr.xfrm)&&void 0!==a&&a.off&&null!==(i=n.spPr.xfrm)&&void 0!==i&&i.off&&(null===(o=m.spPr.xfrm.off)||void 0===o?void 0:o.x)===(null===(l=n.spPr.xfrm.off)||void 0===l?void 0:l.x)&&(null===(s=m.spPr.xfrm.off)||void 0===s?void 0:s.y)===(null===(c=n.spPr.xfrm.off)||void 0===c?void 0:c.y)&&(null===(d=m.spPr.xfrm.ext)||void 0===d?void 0:d.cx)===(null===(p=n.spPr.xfrm.ext)||void 0===p?void 0:p.cx)&&(null===(f=m.spPr.xfrm.ext)||void 0===f?void 0:f.cy)===(null===(v=n.spPr.xfrm.ext)||void 0===v?void 0:v.cy))u()(n,"spPr.xfrm.off.x",(null===(h=n.spPr.xfrm.off)||void 0===h?void 0:h.x)+1e5),u()(n,"spPr.xfrm.off.y",(null===(g=n.spPr.xfrm.off)||void 0===g?void 0:g.y)+1e5)}}))},b413d1a284:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n("9132715560"),a=n.n(r),i=n("85d0a7609b"),o=n.n(i),l=n("5fac0349d3"),s=n("2135d03ecb"),c={tooLarge:l.a.t("请选择20M以内的图片插入"),commonError:l.a.t("未能成功插入图片，请稍后再试。"),networkOffline:l.a.t("网络异常，不支持插入图片，请在网络正常后再试。"),broken:l.a.t("部分图片未能成功插入，图片损坏或不支持该格式。")},u=20*Math.pow(1024,2),d=function e(){a()(this,e)};o()(d,"checkImageBlob",(function(e){return e&&s.a.isImage(e)&&!s.a.isTIFF(e)?e.size>u?[!1,c.tooLarge]:[!0]:[!1,c.broken]}))},bfece3da65:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n("14502724a6"),a=n.n(r),i=n("9132715560"),o=n.n(i),l=n("6a364eb35c"),s=n.n(l),c=n("85d0a7609b"),u=n.n(c),d=(n("8ee19818c4"),n("7a3400cab1"),n("1bab7b5fb7"),n("0aeae65bf4"),n("2c4d03fe19"),n("963f2eaace"),n("b8217400dc"),n("e6f68cdf2e"),n("563386153f"),n("ea241dea66"),n("47b11a1666"),n("0eec0ee5bb"),n("5d557fc3ce"),n("b19fa21abe"),n("a2a09da1e3"),n("c6244f7705"),n("bd80bf2d0f"),n("34cd92f77a"),n("3bf1976a4f"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("af802ec74b"),n("b1e2246d82"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287"),n("3cc783627f"));function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function e(t,n,r,a){if(!function(e){var t=[Node.ELEMENT_NODE,Node.TEXT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_FRAGMENT_NODE];return!!e&&t.includes(e.nodeType)}(t))return null;if(t.nodeType===Node.TEXT_NODE){var i,o,l=t.textContent;if(!a.needSpace)l=null===(o=l)||void 0===o?void 0:o.replace(/\s+?/g," ");return{len:null===(i=l)||void 0===i?void 0:i.length,format:null,text:l}}var s=!1;try{s="mso-spacerun:yes"===t.getAttribute("style")}catch(e){window.log.info("node.getAttribute('style') === 'mso-spacerun:yes error'")}var c={style:{}};!function(e,t,n){var r=Object(d.a)(e,"font-family",t);if(r){var a=r.indexOf(",");-1!==a&&(r=r.slice(0,a)),'"'===r[0]&&(r=r.slice(1,r.length-1)),n.style.fontfamily=r}else n.style.fontfamily=null;var i=Object(d.a)(e,"font-size",t);i&&(-1!==i.toString().toLowerCase().indexOf("pt")?n.style.fontsize=+i.slice(0,-2):-1!==i.toString().toLowerCase().indexOf("rem")?n.style.fontsize=16*+i.slice(0,-3):-1!==i.toString().toLowerCase().indexOf("em")?n.style.fontsize=16*+i.slice(0,-2):n.style.fontsize=parseInt(i,10))}(t,r,c),function(e,t,n,r){var a=n("a"===e.tagName.toLowerCase()?e.style.color:Object(d.a)(e,"color",t));a&&(r.style.fontcolor=a);var i=n(Object(d.a)(e,"background-color",t));i&&(r.style.highlight=i)}(t,r,n,c),function(e,t,n){var r=Object(d.a)(e,"font-weight",t);(r&&("bold"===r||+r>400)||"B"===e.tagName)&&(n.style.bold=1);var a=e.tagName.toLowerCase();"strong"!==a&&"h1"!==a&&"h2"!==a||(n.style.bold=1),"italic"===Object(d.a)(e,"font-style",t)&&(n.style.italic=1),"i"===e.tagName.toLowerCase()&&(n.style.italic=1)}(t,r,c),function(e,t,n){var r=Object(d.d)(e,"href");r&&(n.style.url=r);var a=Object(d.a)(e,"text-decoration",t);a&&(-1!==a.indexOf("underline")&&(n.style.underline="underline"),-1!==a.indexOf("line-through")&&(n.style.strikeline="strikeline"));var i=Object(d.a)(e,"letter-spacing",t);if(i&&"normal"!==i&&"inherit"!==i){var o=parseInt(i,10);n.style.spc=o}var l=Object(d.a)(e,"line-height",t);l&&(n.style.lineHeight=l.includes("%")?+l.slice(0,-1)/100:l)}(t,r,c);var u=t.childNodes;if(null!=u&&u.length){var f=[];u.forEach((function(t){f=f.concat(e(t,n,r,{needSpace:s}))}));var v,h=p(f);try{for(h.s();!(v=h.n()).done;){var g=v.value;g&&(g.format?g.format=Object.assign({},c.style,g.format):g.format=Object.assign({},c.style))}}catch(e){h.e(e)}finally{h.f()}return f}return null},h=function(e){if(e){var t,n,r;e.nodeType===Node.TEXT_NODE?e.innerText=e.textContent:r=e.innerHTML,null!==(t=r)&&void 0!==t&&t.indexOf(/<span style="mso-spacerun:yes">/)&&(e.innerHTML=r.replace(/<span .*style="mso-spacerun:yes">\s*<\/span>/g,""));var a=e.innerText||e.textContent||"";return(a=null===(n=a)||void 0===n?void 0:n.replace(/\u00a0/g," "))&&"　"!==a&&" "!==a?a:""}},g=n("711a53c9fc"),m=n("7c46f42788"),b=n("147aa73f92"),y=n("8316688708"),S=349758,k=function(){function e(){o()(this,e),u()(this,"mSOStyle",void 0)}return s()(e,[{key:"initParser",value:function(e){this.mSOStyle=e}},{key:"parseNodesToSdkData",value:function(e){var t={txBody:this.getTextBodyByNodes(e),nvPr:{txBox:!0},spPr:{xfrm:{off:{x:0,y:0},ext:{cx:400*d.i,cy:400*d.i}}},type:m.a.Shape},n=null;if(e.forEach((function(e){e.forEach((function(e){"slide-data"===e.tagName.toLowerCase()&&(n=e.getAttribute("data-src"))}))})),n){var r=JSON.parse(n);t.spPr.prstGeom={prst:g.gb.rect},t.nvPr.hlinkClick={id:r.originUrl}}return t}},{key:"getTextBodyByNodes",value:function(e){var t=this,n={p:[]},r=n.p;n.bodyPr={};var a=n.bodyPr;return a.lang="zh-CN",e.forEach((function(e){var n,i,o={pPr:{},egTextRun:[]},l=o.pPr,s=o.egTextRun,c=parseInt(null==e||null===(n=e[1])||void 0===n||null===(i=n.style)||void 0===i?void 0:i.fontSize,10);t.reduceBulletProps(e,l).forEach((function(e){if(e.nodeType!==Node.TEXT_NODE&&"li"===e.tagName.toLowerCase()&&(l.algn=null===g.Gb||void 0===g.Gb?void 0:g.Gb.l,l.buFont={charset:"0",typeface:"Arial"},l.buChar={charKeyword:"•"},l.marL=S),"span"===e.tagName.toLowerCase()){var n=1;c&&(n=c/18);var r=e.getAttribute("style")||"";if(/mso-special-format:(\\n)?bullet/.test(r))return t.setBulletStyleFromCopyData(l,e,n),void(l.buChar={charKeyword:e.textContent||"•"});if(/mso-special-format:(\\n)?"numbullet/.test(r)){var i=r.match(/mso-special-format:(?:\\n)?"numbullet(\d+)\\,(\d+)/)||[],o=y.a[i[1]]||(null===g.Ib||void 0===g.Ib?void 0:g.Ib.arabicPeriod),u=i[2]?parseInt(i[2],10):null;return t.setBulletStyleFromCopyData(l,e,n),l.buAutoNum={type:o},void(u&&(l.buAutoNum.startAt=u))}}var f=t.mSOStyle.getComputedStyle(e);t.setAlignment(f,l,a);var m=t.mSOStyle.getComputedStyle,b=function(e,t,n){if(!n)return[];var r=h(e),a=[],i=v(e,t,n,{}),o=0;if(i){var l,s=p(i);try{for(s.s();!(l=s.n()).done;){var c=l.value;if(c){var u=o,d=o+c.len-1,f=r.substring(u,d+1);a.push({text:f,startIndex:u,endIndex:d,format:c.format}),o+=c.len}}}catch(e){s.e(e)}finally{s.f()}}return 1!==a.length||a[0].format?a:[]}(e,d.f,m);b.forEach((function(e){var n={rPr:{}};n.t=e.text,t.setRunDataProps1(e,n.rPr),t.setRunDataProps2(e,n.rPr),t.setRunDataToParagraphProps(e,l),s.push({r:n})}))})),r.push(o)})),n}},{key:"reduceBulletProps",value:function(e,t){var n,r=a()(e,1)[0],i=(null==r||null===(n=r.textContent)||void 0===n?void 0:n.trim())||"";if(1!==i.length)return e;if(this.isWordBulletData(r)){t.indent=-349758,t.marL=S,t.buChar={charKeyword:i},t.buFont={typeface:"Wingdings"};for(var o=1;""===(null===(l=e[o])||void 0===l||null===(s=l.textContent)||void 0===s?void 0:s.trim())&&o<e.length;){var l,s;o+=1}return e.slice(o)}return e}},{key:"isWordBulletData",value:function(e){for(var t=!1,n=!1,r=e;r;){var a;if(t=t||"Wingdings"===r.style.fontFamily,(n=n||(null===(a=r.getAttribute("style"))||void 0===a?void 0:a.includes("mso-list"))||!1)&&t)return!0;r=r.parentElement}return!1}},{key:"setRunDataToParagraphProps",value:function(e,t){"number"==typeof e.format.lineHeight&&(t.lnSpc=t.lnSpc||{},t.lnSpc.spcPct={val:1e5*e.format.lineHeight})}},{key:"setAlignment",value:function(e,t,n){var r=null==e?void 0:e["text-align"];r&&(t.algn={center:g.Gb.ctr,left:g.Gb.l,right:g.Gb.r}[r]);var a=null==e?void 0:e["vertical-align"];a&&(n.anchor={middle:g.Hb.ctr,top:g.Hb.t,bottom:g.Hb.b}[a],n.vert=g.Ob.horz)}},{key:"setBulletStyleFromCopyData",value:function(e,t,n){e.buFont={charset:"0",typeface:t.style.fontFamily||"Arial"},e.indent=-349758*n,e.marL=S}},{key:"setRunDataProps1",value:function(e,t){e.format.fontfamily&&e.format.fontfamily.length>0&&(t.latin={typeface:e.format.fontfamily},t.ea={typeface:e.format.fontfamily}),e.format.fontsize>=0&&(t.sz=100*parseInt(e.format.fontsize,10)),e.format.fontcolor&&e.format.fontcolor.length>0&&(t.solidFill={egColorChoice:Object(b.b)(e.format.fontcolor)}),e.format.highlight&&e.format.highlight.length>0&&(t.highlight=Object(b.b)(e.format.highlight))}},{key:"setRunDataProps2",value:function(e,t){var n=function(e){return e&&e.length>0};n(e.format.underline)&&"underline"===e.format.underline&&(t.u=g.Nb.sng),n(e.format.strikeline)&&"strikeline"===e.format.strikeline&&(t.strike=null===g.Lb||void 0===g.Lb?void 0:g.Lb.sngStrike),e.format.italic&&(t.i=!0),e.format.bold&&(t.b=!0),n(e.format.url)&&(t.hlinkClick={id:e.format.url}),e.format.spc&&(t.spc=e.format.spc*d.h)}}]),e}();u()(k,"instance",void 0),u()(k,"getSingleton",(function(){return k.instance||(k.instance=new k),k.instance}))},ddb144cdda:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return L})),n.d(t,"c",(function(){return j}));n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36"),n("b1e2246d82"),n("8aebbf296a"),n("f45588a8ad"),n("de37db1287");var r=n("14502724a6"),a=n.n(r),i=n("7a5536c9bf"),o=n.n(i),l=n("9132715560"),s=n.n(l),c=n("6a364eb35c"),u=n.n(c),d=n("85d0a7609b"),p=n.n(d),f=(n("8ee19818c4"),n("8a35b54c1d"),n("a2a09da1e3"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("963f2eaace"),n("c6244f7705"),n("6e20b6a7d8"),n("63513d8b56"),n("1bab7b5fb7"),n("34cd92f77a"),n("e5a826a0ff")),v=n("ec5cae33cb"),h=n("e0e8dd9366"),g=n("780d9b3b59"),m=n("d9812f1c6f"),b=n("98efcda99e"),y=n.n(b),S=n("5fac0349d3"),k=n("c73625d763"),P=n.n(k),w=n("8f58e78419"),C=n.n(w),E=n("7c46f42788"),x=n("1a486c8813"),D=n("020899bf26");function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A={MouseEvent:0,ClipboardEvent:1,KeyboardEvent:2,DragEvent:3},L=function(){function e(){s()(this,e)}return u()(e,null,[{key:"setServicesDelegate",value:function(e){var t,n;this.selectionService=null!==(t=this.selectionService)&&void 0!==t?t:e.selectionService,this.uiDataService=null!==(n=this.uiDataService)&&void 0!==n?n:e.uiDataService}}]),e}();p()(L,"selectionService",void 0),p()(L,"uiDataService",void 0);var N=function(){function e(){s()(this,e)}return u()(e,null,[{key:"checkStateForLayout",value:function(){var e,t,n;return 0===(null===(e=L.selectionService)||void 0===e?void 0:e.slideClearanceIndex)||-1===(null===(t=L.selectionService)||void 0===t?void 0:t.slideClearanceIndex)&&-1===(null===(n=L.selectionService)||void 0===n?void 0:n.currentSlideIndex)}}]),e}();p()(N,"getLayout",(function(){var e;if(N.checkStateForLayout())e=a()(L.uiDataService.presentation.masterList[0].layoutList,1)[0];else try{for(var t,n=null===(t=L.selectionService)||void 0===t?void 0:t.currentSlide,r=-1,i=L.uiDataService.presentation.masterList,o=0;o<i.length;o++){var l,s;if((null==n||null===(l=n.sdkData)||void 0===l||null===(s=l.getMaster())||void 0===s?void 0:s.id)===i[o].id){r=o;break}}-1===r&&(r=0);for(var c=-1,u=L.uiDataService.presentation.masterList[r].layoutList,d=0;d<u.length;d++){var p;if((null==n||null===(p=n.sdkData)||void 0===p?void 0:p.layoutId)===u[d].id){c=d;break}}-1===c&&(c=0),e=L.uiDataService.presentation.masterList[r].layoutList[c]}catch(t){if(L.uiDataService.presentation.masterList.length>0)e=a()(L.uiDataService.presentation.masterList[0].layoutList,1)[0];else e={id:0}}return e})),p()(N,"checkPlaceHolder",(function(e){var t=e.slideData;C()(t,"groupShape.children.length")>0&&t.groupShape.children.forEach((function(e){"shape"===e.type&&e.isPlaceholder&&y()(e.props,"placeholder")}))})),p()(N,"adaptTextBody",(function(e,t){P()(e,"paragraphList")&&e.paragraphList.forEach((function(e){if(C()(e,"paragraphItem.length")&&(e.paragraphItem.forEach((function(e){var n;null!==(n=e.props)&&void 0!==n&&n.font_size&&(e.props.font_size=e.props.font_size*t)})),P()(e,"paragraphProps"))){if(P()(e.paragraphProps,"indent")&&(e.paragraphProps.indent=e.paragraphProps.indent*t),P()(e.paragraphProps,"marginLeft")&&(e.paragraphProps.marginLeft=e.paragraphProps.marginLeft*t),P()(e,"paragraphProps.lnSpc.spcPts")){var n=e.paragraphProps;n.lnSpc.spcPts=n.lnSpc.spcPts*t}if(P()(e,"paragraphProps.spcAft.spcPts")){var r=e.paragraphProps;r.spcAft.spcPts=r.spcAft.spcPts*t}if(P()(e,"paragraphProps.spcBef.spcPts")){var a=e.paragraphProps;a.spcBef.spcPts=a.spcBef.spcPts*t}}C()(e,"endParaRPr.font_size")&&(e.endParaRPr.font_size=e.endParaRPr.font_size*t)})),P()(e,"textStyleList")&&e.textStyleList.forEach((function(e){e.defaultRunProps.font_size=e.defaultRunProps.font_size*t})),N.lineIndent(e,t)})),p()(N,"lineIndent",(function(e,t){P()(e,"props")&&P()(e.props,"autoFitType")&&(y()(e.props,"autoFitType"),P()(e.props,"bottom_inset")&&(e.props.bottom_inset=e.props.bottom_inset*t),P()(e.props,"left_inset")&&(e.props.left_inset=e.props.left_inset*t),P()(e.props,"right_inset")&&(e.props.right_inset=e.props.right_inset*t),P()(e.props,"top_inset")&&(e.props.top_inset=e.props.top_inset*t))})),p()(N,"adaptInnerGroupShape",(function(e,t){var n;null!==(n=e.shapeList)&&void 0!==n&&n.length&&e.shapeList.forEach((function(e){var n;"groupShape"===e.type&&N.adaptInnerGroupShape(e,t),null!==(n=e.textBody)&&void 0!==n&&n.paragraphList&&N.adaptTextBody(e.textBody,t)}))})),p()(N,"adaptTable",(function(e,t,n){var r;null!==(r=e.graphicData)&&void 0!==r&&r.tbl&&(e.graphicData.tbl.tblColList.forEach((function(e){e.w=e.w*t})),e.graphicData.tbl.tblRowList.forEach((function(e){var r;e.h=e.h*n,null!==(r=e.tcList)&&void 0!==r&&r.length&&e.tcList.forEach((function(e){e.textBody&&N.adaptTextBody(e.textBody,t)}))})))})),p()(N,"adaptElement",(function(e,t,n){"groupShape"===e.type&&N.adaptInnerGroupShape(e,t),"shape"===e.type&&e.textBody&&e.textBody.paragraphList&&N.adaptTextBody(e.textBody,t),"graphFrame_Tbl"===e.type&&N.adaptTable(e,t,n)}));var j=function(){function e(){s()(this,e)}return u()(e,null,[{key:"getClipboardData",value:function(e){var t=e.originalEvent;return e.clipboardData||(null==t?void 0:t.clipboardData)||window.clipboardData}},{key:"isSelectedNone",value:function(){var e,t,n,r,a,i=null===(e=L.selectionService)||void 0===e||null===(t=e.selectedSlides)||void 0===t?void 0:t.selectedArray,o=null===(n=L.selectionService)||void 0===n||null===(r=n.selectedElements)||void 0===r?void 0:r.selectedArray,l=(null===(a=L.selectionService)||void 0===a?void 0:a.lastMouseDownRegion)===v.a.NOTE;return!(null!=i&&i.length||null!=o&&o.length||l)}},{key:"doCutDelete",value:function(){var e;switch(null===(e=L.selectionService)||void 0===e?void 0:e.lastMouseDownRegion){case v.a.SLIDELIST:L.uiDataService.presentation.deleteSlide();break;case v.a.EDITOR:var t,n,r,a=!0,i=(null===(t=L.selectionService)||void 0===t?void 0:t.selectedElements).selectedArrayForType(f.a.SLIDE);if(1===i.length&&i[0].type===h.d.TABLE){var o=i[0],l=o.clearSelectedCellContent(!1),s=o.selectedCellRanges.length,c=0;o.props.items.forEach((function(e){c+=e.filter((function(e){return!e.vMerge&&!e.hMerge})).length})),!0!==l||s===c||(a=!1)}if(a)null===(n=L.selectionService)||void 0===n||null===(r=n.currentSlide)||void 0===r||r.deleteElement()}}},{key:"tableCannotPasteTipFun",value:function(){var e={message:S.a.t("表格暂不支持此格式粘贴"),commonTipsType:g.b.INFO,block:!1,autoClose:!0,duration:2e3},t=!1;return function(n){t||(g.c.getInstance().show(O(O({},e),n)),setTimeout((function(){t=!1}),2e3),t=!0)}}},{key:"getEventTypeWithTypeName",value:function(e,t){return e.length>8&&(e.indexOf("KeyboardEvent")>0&&(t=A.KeyboardEvent),e.indexOf("ClipboardEvent")>0&&(t=A.ClipboardEvent),e.indexOf("DragEvent")>0&&(t=A.DragEvent),e.indexOf("MouseEvent")>0&&(t=A.MouseEvent)),t}},{key:"isCellInSelection",value:function(e,t,n){var r,a=!1,i=T(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,l=o.rowStart,s=o.rowEnd,c=o.colStart,u=o.colEnd;if(e>=l&&e<=s&&t>=c&&t<=u){a=!0;break}}}catch(e){i.e(e)}finally{i.f()}return a}},{key:"extractTblRangeDataOfCell",value:function(t,n,r,a,i,o,l,s){e.isCellInSelection(t,n,r)||(a[x.b.textBody]=p()({},x.b.paragraphList,[]),delete a.rowSpan,delete a.gridSpan,delete a.hMerge,delete a.vMerge),e.extractTblRangeDataOfCellCheckRow(a,t,i)&&(a.rowSpan-=t+a.rowSpan-i-1),e.extractTblRangeDataOfCellCheckCol(a,n,o)&&(a.gridSpan-=n+a.gridSpan-o-1),n===l&&delete a.hMerge,t===s&&delete a.vMerge}},{key:"extractTblRangeDataOfCellCheckCol",value:function(e,t,n){return e.gridSpan&&e.gridSpan>1&&t+e.gridSpan>=n+1}},{key:"extractTblRangeDataOfCellCheckRow",value:function(e,t,n){return e.rowSpan&&e.rowSpan>1&&t+e.rowSpan>=n+1}},{key:"selectLastAddSlide",value:function(e,t){var n,r,a,i,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.d.SLIDE;L.selectionService.updateCurrentSlideType(l);var s=null===(n=L.selectionService)||void 0===n?void 0:n.slides.slice(e,e+t);null===(r=L.selectionService)||void 0===r||r.selectedSlides.clear(),L.selectionService&&(L.selectionService.currentSlideIndex=e),null===(a=L.selectionService)||void 0===a||(i=a.selectedSlides).add.apply(i,o()(s))}},{key:"checkFrame",value:function(e,t,n,r){return e.props.frame&&t.props.frame&&e.props.frame.left===t.props.frame.left+n&&e.props.frame.top===t.props.frame.top+r&&e.props.frame.width===t.props.frame.width&&e.props.frame.height===t.props.frame.height}},{key:"isMacSafari",value:function(){return!(m.a.isMobile||!m.a.isSafari)}},{key:"isOldMacWxWork",value:function(){return!(!m.a.isMac||!m.a.isWxWork||m.a.isCEFWxWork)}}]),e}();p()(j,"getEventType",(function(e){var t=A.MouseEvent;if(e){var n=Object.prototype.toString.call(e);t=j.getEventTypeWithTypeName(n,t)}return t})),p()(j,"extractTblRangeData",(function(e){var t=e.selectedCellRanges;if(t){var n=C()(e,x.b.tblColList),r=C()(e,x.b.tblRowList),a=x.b.tcList,i=x.b.textBody,l=Math.min.apply(Math,o()(t.map((function(e){return e.rowStart})))),s=Math.max.apply(Math,o()(t.map((function(e){return e.rowEnd})))),c=Math.min.apply(Math,o()(t.map((function(e){return e.colStart})))),u=Math.max.apply(Math,o()(t.map((function(e){return e.colEnd}))));n.splice(u+1,n.length-u),n.splice(0,c),r.splice(s+1,r.length-s),r.splice(0,l),r.forEach((function(e,n){e[a].splice(u+1,e[a].length-u),e[a].splice(0,c),n+=l,e[a].forEach((function(e,r){r+=c,j.extractTblRangeDataOfCell(n,r,t,e,s,u,c,l)}))}));var d=0;r.forEach((function(e){d+=e[a].filter((function(e){return!e.vMerge&&!e.hMerge})).length})),1===d&&(e.type=E.a.Shape,e[i]=r[0][a][0][i],e.nvPr.txBox=!0)}})),p()(j,"selectLastAddElement",(function(e){var t,n,r;if(e&&(null!==(t=L.selectionService)&&void 0!==t&&t.currentSlide&&null!==(n=L.selectionService)&&void 0!==n&&n.currentSlide.children&&(null===(r=L.selectionService)||void 0===r?void 0:r.currentSlide.children.length)>0)){var a,i,l,s,c,u=(null!==(a=null===(i=L.selectionService)||void 0===i?void 0:i.currentSlide)&&void 0!==a?a:{}).children,d=u.slice(u.length-e,u.length);null===(l=L.selectionService)||void 0===l||l.selectedElements.clear(),null===(s=L.selectionService)||void 0===s||(c=s.selectedElements).add.apply(c,o()(d))}})),p()(j,"adjustPosition",(function(e){var t,n=0,r=0,a=null===(t=L.selectionService)||void 0===t?void 0:t.currentSlide,i=!1;!function t(a){var o;(null===(o=a.children)||void 0===o?void 0:o.length)&&a.children.forEach((function(a){"Group"===a.type&&t(a);var o=a.copyModelHandler().getCopiedSdkModel();if(j.checkFrame(o,e,n,r))return i=!0,n+=1e5,r+=1e5,!1}))}(a),i&&(e.props.frame?(e.props.frame.left+=n,e.props.frame.top+=r):e.props.frame={left:0,top:0})})),p()(j,"checkPosition",(function(e){for(var t=0;t<e.length;t++)for(var n=e[t],r=0;r<t;r++){var a=e[r];a.props.frame&&n.props.frame&&a.props.frame.left===n.props.frame.left&&a.props.frame.top===n.props.frame.top&&a.props.frame.width===n.props.frame.width&&a.props.frame.height===n.props.frame.height&&(n.props.frame.left+=1e5,n.props.frame.top+=1e5)}})),p()(j,"adaptSlideSdkData",(function(e,t){var n,r=N.getLayout();if(e.layoutId=r.id,N.checkPlaceHolder(e),t){var a=t.width,i=t.height,o={currentWidth:(n=D.a.SDKDataServices.PresentationStoreService().getPresentation().props.sldSz).cx,currentHeight:n.cy},l=o.currentHeight,s=o.currentWidth,c=0,u=0,d=0,p=l/i;if(s/a<=l/i)u=(l-i*(c=s/a))/2;else d=(s-a*(c=l/i))/2;C()(e,"slideData.groupShape.shapeList")&&e.slideData.groupShape.shapeList.forEach((function(e){if(C()(e,"props.frame")){var t=e.props.frame;e.props.frame.top=t.top*p+u,e.props.frame.left=t.left*c+d,e.props.frame.width=t.width*c,e.props.frame.height=t.height*c}N.adaptElement(e,c,p)}))}})),p()(j,"stringifyAddonData",(function(e){var t=e.props,n=(void 0===t?{}:t).addon,r=void 0===n?{}:n;if("latex"===r.type){var a=JSON.stringify(r).replace(/"/g,"-");return'addon="'.concat(a,'"')}return""})),p()(j,"parseAddonData",(function(e){return JSON.parse(e.replace(/-/g,'"'))}))},de8a404165:function(e,t,n){"use strict";n.d(t,"a",(function(){return jt}));n("a84962d637"),n("c554310b5c"),n("bcb5d93d36"),n("f45588a8ad"),n("de37db1287");var r=n("14502724a6"),a=n.n(r),i=n("176815363d"),o=n.n(i),l=n("9132715560"),s=n.n(l),c=n("6a364eb35c"),u=n.n(c),d=n("85d0a7609b"),p=n.n(d),f=n("3ef2352f0b"),v=n.n(f),h=(n("c6244f7705"),n("081c8cafea"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("2c4d03fe19"),n("3bf1976a4f"),n("6e20b6a7d8"),n("a2a09da1e3"),n("8ee19818c4"),n("342844cefa"),n("75563bc376"),n("b8217400dc"),n("e6f68cdf2e"),n("8a35b54c1d"),n("b1e2246d82"),n("29f8c5f672"),n("fce3077cdf"),n("4bbb5840d5"),n("963f2eaace"),n("24f382e0f4"),n("8aebbf296a"),n("1bab7b5fb7"),n("0aeae65bf4"),n("7eaa8e90a5"),n("af802ec74b"),n("3dc8f33382"),n("bd80bf2d0f"),n("826dc923b3"),n("c4e98dd4ab")),g=n("7091f809c6"),m=n("23cec2bcc1"),b=n("4f3b15d017"),y=n("457452e346"),S=n("82f2dc9440"),k=n.n(S),P=n("b74ee0edd6"),w=n.n(P),C=n("d9812f1c6f"),E=n("5fac0349d3"),x=n("020899bf26"),D=n("53da914cbf"),T=n.n(D),I=function(){function e(){s()(this,e),p()(this,"clipboardData",{})}return u()(e,[{key:"write",value:function(e){this.clipboardData=e}},{key:"read",value:function(){return this.clipboardData}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();p()(I,"instance",void 0);var M=function(){function e(){s()(this,e)}var t,n,r,a;return u()(e,[{key:"write",value:(a=o()(v.a.mark((function e(t){var n,r,a,i,o=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.adapter||{},r=n.event,a=t.legacy||{},i=a.arr,r){e.next=4;break}return e.abrupt("return",new Promise((function(e){o.writeByNavigator([new ClipboardItem(t.adapter.asyncClipboardItemConf)]).then((function(){e()})).catch((function(t){window.log.error("Failed to write to clipboard: ",t),e()}))})));case 4:if(!r){e.next=6;break}return e.abrupt("return",new Promise((function(e){try{null==i||i.forEach((function(e){var t=e.format,n=e.data;o.writeByClipboardEvent({event:r,format:t,data:n})})),e()}catch(t){window.log.error("Failed to write to clipboard: ",t),e()}})));case 6:return e.abrupt("return",Promise.resolve());case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"read",value:(r=o()(v.a.mark((function e(t){var n,r,a,i=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.adapter,r=n.event,a=n.readFile,r){e.next=3;break}return e.abrupt("return",new Promise((function(e){i.readByNavigator().then((function(t){e(t)})).catch((function(t){window.log.error("Failed to read from clipboard: ",t),e(void 0)}))})));case 3:if(!a){e.next=5;break}return e.abrupt("return",new Promise((function(e){try{e(i.readFileByClipboardEvent(r))}catch(t){window.log.error("Failed to read from clipboard: ",t),e(void 0)}})));case 5:return e.abrupt("return",new Promise((function(e){try{e(i.readByClipboardEvent(r))}catch(t){window.log.error("Failed to read from clipboard: ",t),e(void 0)}})));case 6:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"writeByNavigator",value:(n=o()(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.clipboard.write(t));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"readByNavigator",value:(t=o()(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.clipboard.read());case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"writeByClipboardEvent",value:function(e){var t=e.event,n=e.format,r=e.data;t.clipboardData.setData(n,r)}},{key:"readByClipboardEvent",value:function(e){var t=e.clipboardData;return{html:t.getData(y.a.HTML),text:t.getData(y.a.TEXT)}}},{key:"readFileByClipboardEvent",value:function(e){var t=e.clipboardData,n=t.items,r=t.files;return Array.from(r)||Array.from(n).map((function(e){return e.getAsFile()}))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();p()(M,"instance",void 0);var O,A=!1,L=function(){function e(){var t=this;s()(this,e),p()(this,"concreteClipboard",void 0),p()(this,"read",function(){var e=o()(v.a.mark((function e(n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.concreteClipboard){e.next=6;break}return e.next=4,t.getTencentClipboard();case 4:t.concreteClipboard=e.sent,k.a.show({message:E.a.t("请再次尝试粘贴操作")});case 6:if(!n.readFile){e.next=9;break}return e.abrupt("return",t.concreteClipboard.readInClipBoard(n).then((function(e){return e.files})));case 9:return e.abrupt("return",t.concreteClipboard.readInClipBoard(n));case 12:return e.prev=12,e.t0=e.catch(0),window.log.error("Failed to read from clipboard: ",e.t0),e.abrupt("return",Promise.resolve(void 0));case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()),p()(this,"write",o()(v.a.mark((function e(){var n,r,a,i,o,l,s,c,u=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.concreteClipboard){e.next=6;break}return e.next=4,t.getTencentClipboard();case 4:t.concreteClipboard=e.sent,(b.default.isFirefox||b.default.isSafari)&&k.a.show({message:E.a.t("请再次尝试复制操作")});case 6:return A=!0,o=(i=u.length<=0?void 0:u[0]).html,l=i.plain,s=i.syncClipboardItemConf,c=i.asyncClipboardItemConf,e.next=10,t.concreteClipboard.writeInClipBoard({html:null!==(n=null!=o?o:null!==(r=u.length<=1?void 0:u[1])&&void 0!==r&&r.encrypt?null==s?void 0:s[y.a.HTML]:null==c?void 0:c[y.a.HTML])&&void 0!==n?n:"",plain:null!==(a=null!=l?l:null==s?void 0:s[y.a.TEXT])&&void 0!==a?a:"",blobAsync:function(){return Promise.resolve((null==c?void 0:c[y.a.IMAGE_PNG])||new Blob)},blobType:null!=c&&c[y.a.IMAGE_PNG]?y.a.IMAGE_PNG:void 0},u.length<=1?void 0:u[1]);case 10:A=!1,Promise.resolve(),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(0),A=!1,window.log.error("Failed to write to clipboard: ",e.t0),Promise.resolve();case 19:case"end":return e.stop()}}),e,null,[[0,14]])}))))}return u()(e,[{key:"getTencentClipboard",value:function(){return n.e("vendors~tencent-clipboard").then(n.t.bind(null,"73fd51541f",7))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}p()(L,"instance",void 0),function(e){e.TencentClipboard="TENCENT_CLIPBOARD",e.SlideLegacyClipboard="SLIDE_LEGACY_CLIPBOARD"}(O||(O={}));var R=function(){function e(t){s()(this,e),p()(this,"memoryClipboard",void 0),p()(this,"slideLegacyClipboard",void 0),p()(this,"tencentClipboard",void 0),this.clipboardDeviceDelegateInjectable=t,this.memoryClipboard=I.getInstance(),this.slideLegacyClipboard=M.getInstance(),this.tencentClipboard=L.getInstance()}var t,n;return u()(e,[{key:"write",value:(n=o()(v.a.mark((function e(t){var n,r,a,i,o,l,s,c,u,d,p,f,h,g,m,b,y=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=(null==t?void 0:t.options)||{},a=r.useMemoryClipboardExtra,i=r.useMemoryClipboard,o=r.clipboardDevice,a&&(s=(null==t||null===(l=t.params)||void 0===l?void 0:l.memory)||{},c=s.dataMap,this.memoryClipboard.write(c)),!i){e.next=5;break}return e.abrupt("return",new Promise((function(e){try{var n,r=((null==t||null===(n=t.params)||void 0===n?void 0:n.memory)||{}).dataMap;y.memoryClipboard.write(r),e()}catch(t){window.log.error("write memory clipboard error",t),e()}})));case 5:u=(null==t||null===(n=t.params)||void 0===n?void 0:n.adapter)||{},window.log.info("[ClipboardDeviceDelegate] write info:","useMemoryClipboardExtra: ".concat(!!a),"useMemoryClipboard: ".concat(!!i),"clipboardDevice: ".concat(null!=o?o:this.automaticallySelectClipboardDevice)),e.t0=null!=o?o:this.automaticallySelectClipboardDevice,e.next=e.t0===O.SlideLegacyClipboard?10:e.t0===O.TencentClipboard?11:15;break;case 10:return e.abrupt("return",this.slideLegacyClipboard.write({adapter:u,legacy:null==t||null===(d=t.params)||void 0===d?void 0:d.legacy}));case 11:return h=null===(p=x.a.PrivilegeManager())||void 0===p?void 0:p.getPrivilegeAttribute().can_copy_out,(g=!!T()(h)&&!h)&&(null===(m=(b=this.clipboardDeviceDelegateInjectable).showClipboardProtection)||void 0===m||m.call(b)),e.abrupt("return",this.tencentClipboard.write(u,{encrypt:g,encryptKey:null===(f=x.a.ClientVarsService())||void 0===f?void 0:f.getClientVars().creatorCorpId}));case 15:throw Error("No matching clipboard found");case 16:e.next=22;break;case 18:return e.prev=18,e.t1=e.catch(0),window.log.error("Failed to write to clipboard: ",e.t1),e.abrupt("return",Promise.resolve());case 22:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(e){return n.apply(this,arguments)})},{key:"read",value:(t=o()(v.a.mark((function e(t){var n,r,a,i,o,l,s,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=(null==t?void 0:t.options)||{},a=r.useMemoryClipboard,i=r.clipboardDevice,!a){e.next=12;break}if(e.prev=3,l=null!==(o=this.memoryClipboard.read())&&void 0!==o?o:{},!Object.keys(l).length){e.next=7;break}return e.abrupt("return",Promise.resolve(l));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),window.log.error("read memory clipboard error",e.t0);case 12:s=(null==t||null===(n=t.params)||void 0===n?void 0:n.adapter)||{},window.log.info("[ClipboardDeviceDelegate] read info:","useMemoryClipboard: ".concat(!!a),"clipboardDevice: ".concat(null!=i?i:this.automaticallySelectClipboardDevice)),e.t1=null!=i?i:this.automaticallySelectClipboardDevice,e.next=e.t1===O.SlideLegacyClipboard?17:e.t1===O.TencentClipboard?18:19;break;case 17:return e.abrupt("return",this.slideLegacyClipboard.read({adapter:s,legacy:null==t||null===(c=t.params)||void 0===c?void 0:c.legacy}));case 18:return e.abrupt("return",this.tencentClipboard.read(j(j({},s),{},{encryptKey:null===(u=x.a.ClientVarsService())||void 0===u?void 0:u.getClientVars().creatorCorpId})));case 19:throw Error("No matching clipboard found");case 20:e.next=26;break;case 22:return e.prev=22,e.t2=e.catch(0),window.log.error("Failed to read from clipboard: ",e.t2),e.abrupt("return",Promise.resolve(void 0));case 26:case"end":return e.stop()}}),e,this,[[0,22],[3,9]])}))),function(e){return t.apply(this,arguments)})},{key:"automaticallySelectClipboardDevice",get:function(){return this.clipboardDeviceDelegateInjectable.currentEnvIsInPrivate||b.default.isMobile?O.TencentClipboard:O.SlideLegacyClipboard}}]),e}(),F=n("d3d31c86eb"),B=n("9da6335152");function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var W=C.a.isMobile?w.a:k.a,z=function(){function e(t,n){var r,a;s()(this,e),p()(this,"textPreparePlugin",void 0),p()(this,"imagePreparePlugin",void 0),p()(this,"htmlPreparePlugin",void 0),p()(this,"copyDataType",void 0),p()(this,"handler",void 0),p()(this,"clipboardData",void 0),p()(this,"writeTimer",void 0),p()(this,"startWriteTime",null),p()(this,"startCopyTime",void 0),p()(this,"writeLoading",void 0),p()(this,"clipboardDeviceDelegate",void 0),p()(this,"contentRendererService",void 0),this.clipboardManagerInjectable=n,this.handler=t,this.clipboardData={},this.textPreparePlugin=new g.b,this.imagePreparePlugin=new h.b,this.htmlPreparePlugin=new m.b,null===(r=(a=this.clipboardManagerInjectable).onClipboardManagerInit)||void 0===r||r.call(a),this.clipboardDeviceDelegate=new R(this.clipboardManagerInjectable)}var t,n,r,i,l,c,d,f,S,k,P;return u()(e,[{key:"save",value:function(e,t){var n;null!=e&&e[y.a.HTML]&&(this.copyDataType=null===(n=e[y.a.HTML])||void 0===n?void 0:n.type);null!=t&&t.override&&this.deleteClipboardData(),this.updateClipboardData(e)}},{key:"read",value:function(e){return b.default.isMobile?this.readDataFromClientClipboard():this.handlerSyncApiRead(e)}},{key:"readFile",value:(P=o()(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b.default.isMobile){e.next=2;break}return e.abrupt("return",Promise.resolve([]));case 2:return e.abrupt("return",this.clipboardDeviceDelegate.read({params:{adapter:{event:t,readFile:!0}}}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"startCopy",value:function(){this.startCopyTime=Date.now()}},{key:"write",value:function(e){var t=this;if(this.startWriteTimer(),!this.isAllDataWritten()){var n,r;if(!this.clipboardManagerInjectable.supportAsyncClipboardApi)return this.deleteClipboardData([y.a.IMAGE_PNG]),this.syncWriteToClipboard(e),null===(n=this.handler)||void 0===n||n.successWrite(),null===(r=this.handler)||void 0===r||r.finallyWrite(this.clipboardData),void this.endWriteTimer();if(this.isForceAsyncModel)return this.writeToClipboard(e,!0).then((function(){return t.endWriteTimer()}));var a=Object.assign({},this.clipboardData);return this.writeToClipboardPreprocessing(e,!1).then((function(n){var r;if(!!a[y.a.IMAGE_PNG]||n)return t.clipboardData=a,null===(r=window.log)||void 0===r||r.info("[copyPasteManager] 图片类型写入剪贴板"),t.writeToClipboard(e,!0,n)})).catch((function(){var e;null===(e=window.log)||void 0===e||e.error("[copyPasteManager] 写入剪切板失败")})).finally((function(){t.endWriteTimer()}))}this.endWriteTimer()}},{key:"setServicesDelegate",value:function(e){this.contentRendererService=e.contentRendererService}},{key:"handlerSyncApiRead",value:(k=o()(v.a.mark((function e(t){var n,r,a,i,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",{});case 2:return e.next=4,this.clipboardDeviceDelegate.read({params:{adapter:{event:t}}});case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:return r=e.t0,a=r.html,i=r.text,o=r.plain,e.abrupt("return",(n={},p()(n,y.a.HTML,this.handlerStringToString(y.a.HTML,a)),p()(n,y.a.TEXT,this.handlerStringToString(y.a.TEXT,i||o)),n));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"handlerAsyncApiRead",value:(S=o()(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},e.prev=1,!b.default.isMobile){e.next=8;break}return e.next=5,this.readDataFromClientClipboard();case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,this.asyncReadClipboard(t);case 10:n=e.sent;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),null===(r=window)||void 0===r||r.log.warn("[copyPasteManager] read clipboard failed, maybe is empty");case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e){return S.apply(this,arguments)})},{key:"validClipboardTypeArr",get:function(){return Object.values(y.a)}},{key:"isForceAsyncModel",get:function(){return this.handler.isForceAsyncModel()}},{key:"readDataFromClientClipboard",value:(f=o()(v.a.mark((function e(){var t,n,r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clipboardDeviceDelegate.read({options:{useMemoryClipboard:this.clipboardManagerInjectable.useMemoryClipboard}});case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return n=e.t0,r=n.plain,a=n.html,window.log.info("[ClipboardManager] read clipboard data:",{plain:r,html:a}),e.abrupt("return",(t={},p()(t,y.a.TEXT,this.handlerStringToString(y.a.TEXT,r)),p()(t,y.a.HTML,this.handlerStringToString(y.a.HTML,a)),t));case 10:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"writeToClipboardPreprocessing",value:function(e,t){var n;if(this.clipboardManagerInjectable.currentEnvIsInPrivate&&this.clipboardData[y.a.IMAGE_PNG]){var r;null===(r=window.log)||void 0===r||r.info("[ClipboardManager] 跳过文本类型写入剪贴板，等待与图片类型一并写入。"),this.deleteClipboardData([y.a.IMAGE_PNG]);var a=this.getSyncClipboardItemConf();return Promise.resolve(a)}return this.deleteClipboardData([y.a.IMAGE_PNG]),Object.keys(this.clipboardData).length?(null===(n=window.log)||void 0===n||n.info("[ClipboardManager] 文本类型写入剪贴板"),this.writeToClipboard(e,t)):Promise.resolve()}},{key:"isAllDataWritten",value:function(){return!Object.values(this.clipboardData).filter(Boolean).length}},{key:"asyncReadClipboard",value:(d=o()(v.a.mark((function e(t){var n,r,i,o,l,s,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clipboardDeviceDelegate.read();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",{});case 5:r=a()(n,1),i=r[0],o={},l=U(i.types),e.prev=8,l.s();case 10:if((s=l.n()).done){e.next=23;break}return c=s.value,e.next=14,i.getType(c);case 14:if(u=e.sent,e.t0=u,!e.t0){e.next=20;break}return e.next=19,this.handlerBlobToString(c,u);case 19:e.t0=e.sent;case 20:o[c]=e.t0;case 21:e.next=10;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(8),l.e(e.t1);case 28:return e.prev=28,l.f(),e.finish(28);case 31:if(!t){e.next=33;break}return e.abrupt("return",o[t]);case 33:return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,this,[[8,25,28,31]])}))),function(e){return d.apply(this,arguments)})},{key:"updateClipboardData",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.validClipboardTypeArr.includes(n)&&(t.clipboardData[n]=e[n])}))}},{key:"deleteClipboardData",value:function(e){var t=this;null!=e&&e.length?e.forEach((function(e){return delete t.clipboardData[e]})):this.clipboardData={}}},{key:"writeToClipboard",value:(c=o()(v.a.mark((function e(t,n,r){var a,i,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!b.default.isMobile){e.next=6;break}return e.next=4,this.mobileWriteToClipboard(r);case 4:e.next=8;break;case 6:return e.next=8,this.pcWriteToClipboard(t,n,r);case 8:null===(i=this.handler)||void 0===i||i.successWrite(),window.log.info("[ClipboardManager] copy to success"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),null===(o=this.handler)||void 0===o||o.failWrite(),window.log.error("[ClipboardManager] copy to fail:".concat(null===e.t0||void 0===e.t0?void 0:e.t0.toString()));case 16:null===(a=this.handler)||void 0===a||a.finallyWrite(this.clipboardData,n),this.deleteClipboardData();case 18:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e,t,n){return c.apply(this,arguments)})},{key:"startWriteTimer",value:function(){var e,t=this;this.startWriteTime=new Date,clearTimeout(this.writeTimer),null===(e=this.writeLoading)||void 0===e||e.close(),this.writeTimer=setTimeout((function(){t.writeLoading=W.show({message:E.a.t("正在复制中"),autoClose:!1,type:"loading",id:"copying"})}),200)}},{key:"endWriteTimer",value:function(){var e=this,t=new Date;Object(F.c)({opername:B.e.DOC_PPT,module:B.d.COPY_PASTE,action:B.b.COMMON_COPY,ver6:Date.now()-this.startCopyTime,ver7:this.copyDataType});var n,r=Number(t)-Number(this.startWriteTime||t);if(r<1e3&&r>200)var a=setTimeout((function(){var t;e.startWriteTime=null,null===(t=e.writeLoading)||void 0===t||t.close(),clearTimeout(e.writeTimer),clearTimeout(a)}),1e3-r);else this.startWriteTime=null,null===(n=this.writeLoading)||void 0===n||n.close(),clearTimeout(this.writeTimer)}},{key:"pcWriteToClipboard",value:(l=o()(v.a.mark((function e(t,n,r){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",this.syncWriteToClipboard(t));case 2:return e.next=4,this.CEFWriteToClipboard(r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"mobileWriteToClipboard",value:(i=o()(v.a.mark((function e(t){var n,r,a,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t||this.getSyncClipboardItemConf(),a={},n={},p()(n,y.a.HTML,"html"),p()(n,y.a.TEXT,"plain"),i=n,[y.a.HTML,y.a.TEXT].forEach((function(e){e in r&&(a[i[e]]=r[e])})),window.log.info("[ClipboardManager] write to clipboard data:",a),e.next=7,this.clipboardDeviceDelegate.write({params:{memory:{dataMap:a},adapter:H({},a)},options:{useMemoryClipboardExtra:!0}});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"isSupportImageType",value:function(e){return h.a.includes(e)}},{key:"handlerBlobToString",value:function(e,t){var n,r,a=this;if(this.isSupportImageType(e))return t;var i=(n={},p()(n,y.a.TEXT,(function(e){return a.textPreparePlugin.textBlobToText(e)})),p()(n,y.a.HTML,(function(e){return a.htmlPreparePlugin.HTMLblobToText(e)})),n);return null===(r=i[e])||void 0===r?void 0:r.call(i,t)}},{key:"handlerStringToString",value:function(e,t){var n,r,a=this,i=(n={},p()(n,y.a.TEXT,(function(e){return e})),p()(n,y.a.HTML,(function(e){return a.htmlPreparePlugin.HTMLStringToText(e)})),n);return null===(r=i[e])||void 0===r?void 0:r.call(i,t)}},{key:"getClipboardTypeToBlobMethod",value:function(e){var t,n=this;return(t={},p()(t,y.a.IMAGE_PNG,(function(e){var t=e.container,r=e.outputOptions;return n.imagePreparePlugin.getImageBlobAndString(t,r,n.contentRendererService)})),p()(t,y.a.TEXT,(function(e){return n.textPreparePlugin.getTextBlob(e)})),p()(t,y.a.HTML,(function(e,t){var r;return n.htmlPreparePlugin.getHTMLBlob(e,t,null===(r=n.handler)||void 0===r?void 0:r.getBase64UrlMap())})),t)[e]}},{key:"getClipboardTypeToStringMethod",value:function(e){var t,n=this;return(t={},p()(t,y.a.TEXT,(function(e){return n.textPreparePlugin.getTextString(e)})),p()(t,y.a.HTML,(function(e,t){var r;return n.htmlPreparePlugin.getHTMLString(e,t,!0,null===(r=n.handler)||void 0===r?void 0:r.getBase64UrlMap())})),t)[e]}},{key:"getAsyncWebkitClipboardItemConf",value:function(){var e={},t=H({},this.clipboardData),n=this.preHandlerImageBlobAndString(t).then((function(e){return e.imgBlob}));return e[y.a.IMAGE_PNG]=n,window.log.info("[ClipboardManager] getAsyncWebkitClipboardItemConf",e),e}},{key:"getAsyncCEFClipboardItemConf",value:(r=o()(v.a.mark((function e(){var t,n,r,a,i,o,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},n=H({},this.clipboardData),e.next=4,this.preHandlerImageBlobAndString(n);case 4:r=e.sent,t[y.a.IMAGE_PNG]=r.imgBlob,a=U(this.validClipboardTypeArr),e.prev=7,a.s();case 9:if((i=a.n()).done){e.next=18;break}if(o=i.value,!(l=n[o])){e.next=16;break}return e.next=15,this.getClipboardTypeToBlobMethod(o)(l,r);case 15:t[o]=e.sent;case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),a.e(e.t0);case 23:return e.prev=23,a.f(),e.finish(23);case 26:return window.log.info("[ClipboardManager] getAsyncCEFClipboardItemConf",t),e.abrupt("return",t);case 28:case"end":return e.stop()}}),e,this,[[7,20,23,26]])}))),function(){return r.apply(this,arguments)})},{key:"preHandlerImageBlobAndString",value:function(e){var t=y.a.IMAGE_PNG;if(!e[t])return Promise.resolve({});var n=e[t];return delete e[t],this.getClipboardTypeToBlobMethod(t)(n)}},{key:"getSyncClipboardItemConf",value:function(e){var t=this,n={};return this.validClipboardTypeArr.forEach((function(r){var a=t.clipboardData[r];t.clipboardData[r]&&(n[r]=t.getClipboardTypeToStringMethod(r)(a,e))})),window.log.info("[ClipboardManager] getSyncClipboardItemConf",n),n}},{key:"CEFWriteToClipboard",value:(n=o()(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.log.info("[ClipboardManager] use CEF async api to write clipboard"),e.next=3,this.getAsyncCEFClipboardItemConf();case 3:return n=e.sent,e.abrupt("return",this.clipboardDeviceDelegate.write({params:{adapter:{syncClipboardItemConf:t,asyncClipboardItemConf:n}}}));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"webkitWriteToClipboard",value:(t=o()(v.a.mark((function e(){var t,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.log.info("[ClipboardManager] use webkit async api to write clipboard, need permission"),e.next=3,this.getAsyncCEFClipboardItemConf();case 3:return r=e.sent,e.next=6,null===(t=this.handler)||void 0===t||null===(n=t.getUserPermissionToCopyData)||void 0===n?void 0:n.call(t);case 6:return e.abrupt("return",this.clipboardDeviceDelegate.write({params:{adapter:{asyncClipboardItemConf:r}}}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"syncWriteToClipboard",value:function(e){if(e){var t=this.getSyncClipboardItemConf();return this.clipboardDeviceDelegate.write({params:{adapter:{event:e,html:t[y.a.HTML],plain:t[y.a.TEXT]},legacy:{arr:[{format:y.a.HTML,data:t[y.a.HTML]},{format:y.a.TEXT,data:t[y.a.TEXT]}]}}})}throw new Error("sync write to clipboard need clipboardEvent, the clipboardEvent is undefined")}}]),e}(),V=z,X=n("ddb144cdda"),K=(n("8fa580e5fd"),n("7a3400cab1"),n("34cd92f77a"),n("9d7978d445"),n("90fab19f96"),n("0acdc5834b"),n("433247001a"),n("759492dad9"),function(){this.cssImportStatements=[],this.cssKeyframeStatements=[],this.cssRegex=new RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi"),this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.combinedCSSRegex="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)",this.cssImportStatementRegex=new RegExp("@import .*?;","gi")});K.prototype.stripComments=function(e){var t=new RegExp(this.cssCommentsRegex,"gi");return e.replace(t,"")},K.prototype.parseCSS=function(e){if(void 0===e)return[];for(var t=[],n=this.cssImportStatementRegex.exec(e);n;)this.cssImportStatements.push(n[0]),t.push({selector:"@imports",type:"imports",styles:n[0]}),n=this.cssImportStatementRegex.exec(e);e=e.replace(this.cssImportStatementRegex,"");for(var r=new RegExp(this.cssKeyframeRegex,"gi"),a=r.exec(e);a;)t.push({selector:"@keyframes",type:"keyframes",styles:a[0]}),a=r.exec(e);e=e.replace(r,"");var i=new RegExp(this.combinedCSSRegex,"gi");for(a=i.exec(e);a;){var o="";o=void 0===a[2]?a[5].split("\r\n").join("\n").trim():a[2].split("\r\n").join("\n").trim();var l=new RegExp(this.cssCommentsRegex,"gi"),s=l.exec(o);null!==s&&(o=o.replace(l,"").trim());var c=function(e,t){null!==e&&(t.comments=e[0])};if(-1!==(o=o.replace(/\n+/,"\n")).indexOf("@media")){var u={selector:o,type:"media",subStyles:this.parseCSS("".concat(a[3],"\n}"))};c(s,u),t.push(u)}else{var d={selector:o,rules:this.parseRules(a[6])};"@font-face"===o&&(d.type="font-face"),c(s,d),t.push(d)}a=i.exec(e)}return t},K.prototype.parseRules=function(e){var t=e.split("\r\n").join("\n"),n=[];t=(t=t.replace("\\;","8cbdb7f1309a1f76b65356e6afc3948b")).replace("\\\\;","8cbdb7f1309a1f76b65356e6afc3948a").split(new RegExp(";")).map((function(e){return(e=e.replace("8cbdb7f1309a1f76b65356e6afc3948b","\\;")).replace("8cbdb7f1309a1f76b65356e6afc3948a","\\\\;")}));for(var r=0;r<t.length;r++){var a=t[r];if(-1!==(a=a.trim()).indexOf(":")){var i=(a=a.split(":"))[0].trim(),o=a.slice(1).join(":").trim();if(i.length<1||o.length<1)continue;n.push({directive:i,value:o})}else"base64,"===a.trim().substr(0,7)?n[n.length-1].value+=a.trim():a.length>0&&n.push({directive:"",value:a,defective:!0})}return n},K.prototype.findCorrespondingRule=function(e,t,n){void 0===n&&(n=!1);for(var r=!1,a=0;a<e.length&&(e[a].directive!==t||(r=e[a],n!==e[a].value));a++);return r},K.prototype.findBySelector=function(e,t,n){void 0===n&&(n=!1);for(var r=[],a=0;a<e.length;a++)!1===n?e[a].selector===t&&r.push(e[a]):-1!==e[a].selector.indexOf(t)&&r.push(e[a]);if("@imports"===t||r.length<2)return r;for(var i=r[0],o=1;o<r.length;o++)this.intelligentCSSPush([i],r[o]);return[i]},K.prototype.deleteBySelector=function(e,t){for(var n=[],r=0;r<e.length;r++)e[r].selector!==t&&n.push(e[r]);return n},K.prototype.compressCSS=function(e){for(var t=[],n={},r=0;r<e.length;r++){var a=e[r];if(!0!==n[a.selector]){var i=this.findBySelector(e,a.selector);0!==i.length&&(t=t.concat(i),n[a.selector]=!0)}}return t},K.prototype.cssDiff=function(e,t){if(e.selector!==t.selector)return!1;if("media"===e.type||"media"===t.type)return!1;for(var n,r,a={selector:e.selector,rules:[]},i=0;i<e.rules.length;i++)n=e.rules[i],(!1===(r=this.findCorrespondingRule(t.rules,n.directive,n.value))||n.value!==r.value)&&a.rules.push(n);for(var o=0;o<t.rules.length;o++)r=t.rules[o],!1===(n=this.findCorrespondingRule(e.rules,r.directive))&&(r.type="DELETED",a.rules.push(r));return 0!==a.rules.length&&a},K.prototype.intelligentMerge=function(e,t,n){void 0===n&&(n=!1);for(var r=0;r<t.length;r++)this.intelligentCSSPush(e,t[r],n);for(var a=0;a<e.length;a++){var i=e[a];"media"!==i.type&&"keyframes"!==i.type&&(i.rules=this.compactRules(i.rules))}},K.prototype.intelligentCSSPush=function(e,t,n){var r=t.selector,a=!1;void 0===n&&(n=!1);if(function(){if(!1===n){for(var t=0;t<e.length;t++)if(e[t].selector===r){a=e[t];break}}else for(var i=e.length-1;i>-1;i--)if(e[i].selector===r){a=e[i];break}}(),!1===a)e.push(t);else if("media"!==t.type)for(var i=0;i<t.rules.length;i++){var o=t.rules[i],l=this.findCorrespondingRule(a.rules,o.directive);!1===l?a.rules.push(o):"DELETED"===o.type?l.type="DELETED":l.value=o.value}else a.subStyles=a.subStyles.concat(t.subStyles)},K.prototype.compactRules=function(e){for(var t=[],n=0;n<e.length;n++)"DELETED"!==e[n].type&&t.push(e[n]);return t},K.prototype.getCSSForEditor=function(e,t){void 0===t&&(t=0);var n="";void 0===e&&(e=this.css);!function(){for(var t=0;t<e.length;t++)"imports"===e[t].type&&(n+="".concat(e[t].styles,"\n\n"))}();for(var r=0;r<e.length;r++){var a=e[r];if(void 0!==a.selector){var i="";void 0!==a.comments&&(i="".concat(a.comments,"\n")),"media"===a.type?(n+="".concat(i+a.selector,"{\n"),n+=this.getCSSForEditor(a.subStyles,t+1),n+="}\n\n"):"keyframes"!==a.type&&"imports"!==a.type&&(n+="".concat(this.getSpaces(t)+i+a.selector," {\n"),n+=this.getCSSOfRules(a.rules,t+1),n+="".concat(this.getSpaces(t),"}\n\n"))}}return function(){for(var t=0;t<e.length;t++)"keyframes"===e[t].type&&(n+="".concat(e[t].styles,"\n\n"))}(),n},K.prototype.getImports=function(e){for(var t=[],n=0;n<e.length;n++)"imports"===e[n].type&&t.push(e[n].styles);return t},K.prototype.getCSSOfRules=function(e,t){for(var n="",r=0;r<e.length;r++)void 0!==e[r]&&(void 0===e[r].defective?n+="".concat(this.getSpaces(t)+e[r].directive,": ").concat(e[r].value,";\n"):n+="".concat(this.getSpaces(t)+e[r].value,";\n"));return n||"\n"},K.prototype.getSpaces=function(e){for(var t="",n=0;n<4*e;n++)t+=" ";return t},K.prototype.applyNamespacing=function(e,t){var n=this,r=e,a=".".concat(this.cssPreviewNamespace);void 0!==t&&(a=t),"string"==typeof e&&(r=this.parseCSS(e));for(var i=function(e){var i=r[e];if(i.selector.indexOf("@font-face")>-1||i.selector.indexOf("keyframes")>-1||i.selector.indexOf("@import")>-1||i.selector.indexOf(".form-all")>-1||i.selector.indexOf("#stage")>-1)return"continue";if("media"!==i.type){for(var o=i.selector.split(","),l=[],s=0;s<o.length;s++)-1===o[s].indexOf(".supernova")?l.push("".concat(a," ").concat(o[s])):l.push(o[s]);i.selector=l.join(",")}else i.subStyles=n.applyNamespacing(i.subStyles,t)},o=0;o<r.length;o++)i(o);return r},K.prototype.clearNamespacing=function(e,t){void 0===t&&(t=!1);var n=e,r=".".concat(this.cssPreviewNamespace);"string"==typeof e&&(n=this.parseCSS(e));for(var a=0;a<n.length;a++){var i=n[a];if("media"!==i.type){for(var o=i.selector.split(","),l=[],s=0;s<o.length;s++)l.push(o[s].split("".concat(r," ")).join(""));i.selector=l.join(",")}else i.subStyles=this.clearNamespacing(i.subStyles,!0)}return!1===t?this.getCSSForEditor(n):n},K.prototype.createStyleElement=function(e,t,n){if(void 0===n&&(n=!1),!1===this.testMode&&"nonamespace"!==n&&(t=this.applyNamespacing(t)),"string"!=typeof t&&(t=this.getCSSForEditor(t)),!0===n&&(t=this.getCSSForEditor(this.parseCSS(t))),!1!==this.testMode)return this.testMode("create style #".concat(e),t);var r=document.getElementById(e);r&&r.parentNode.removeChild(r);var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=e,i.type="text/css",a.appendChild(i),i.styleSheet&&!i.sheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))};var $,q=K,Y={CSS:{Sequence:($=/\\((([\dA-F]{2}|[\dA-F]{1,5})\s)|([\dA-F]{6}|[\dA-F]{4}))/gim,$.unescape=function(e){var t=String.fromCharCode,n=parseInt;return e.replace(this,(function(e){return t(n(e.slice(2),16))}))},$)}},J=new q,Q=function(){function e(t){s()(this,e),p()(this,"styleSheetsParsed",void 0);var n,r=(n=t)?J.parseCSS(n):(console.error("invalid css string"),[]);this.styleSheetsParsed=this.transform(r),this.getComputedStyle=this.getComputedStyle.bind(this)}return u()(e,[{key:"transform",value:function(e){return e.reduce((function(e,t){return e[t.selector]=(e[t.selector]||[]).concat(t.rules),e}),{})}},{key:"getComputedStyle",value:function(e){if(!e.getAttribute)return{};var t=e.getAttribute("class"),n=e.getAttribute("style"),r=this.getMergedStyles(t,n,e);if(0===Object.keys(r).length&&"span"===e.tagName.toLowerCase()&&e.parentNodeText){var a=e.parentNodeText;t=a.getAttribute("class"),n=a.getAttribute("style"),r=this.getMergedStyles(t,n,a)}return r}},{key:"getMergedStyles",value:function(e,t,n){var r=this.getRulesBySelector(".".concat(e)),a=this.parseRules(t),i=[];n.tagName&&(i=this.getRulesBySelector(n.tagName.toLowerCase()));var o=r||[],l=(i||[]).concat(o);return this.getMergeStyles(l.concat(a))}},{key:"getMergeStyles",value:function(e){var t={};return e.forEach((function(e){var n,r=e.value;/mso/.test(e.directive)&&(n=e.value,r=function(e){return e.replace(/(\\.)/g,(function(e){return e.slice(1)})).replace(/(\\[$\-+/():!^&'~{}<>= ])/g,(function(e){return e.slice(1)}))}(Y.CSS.Sequence.unescape(n))),t[e.directive]=r})),t}},{key:"parseRules",value:function(e){return(t=e)?J.parseRules(t):[];var t}},{key:"getRulesBySelector",value:function(e){return this.styleSheetsParsed[e]}}]),e}(),Z=n("6986953439"),ee=n("bfece3da65"),te=n("3cc783627f"),ne=function(){function e(){s()(this,e),p()(this,"mSOStyle",void 0)}return u()(e,[{key:"parse",value:function(e,t,n){try{var r=Object(te.b)();t&&(r=t.outerHTML),this.mSOStyle=new Q(r)}catch(e){var a=Object(te.b)();this.mSOStyle=new Q(a)}finally{ee.a.getSingleton().initParser(this.mSOStyle),Z.a.getSingleton().initParser(this.mSOStyle)}var i=[],o=[];if(e.nodes&&e.nodes.length>0){var l=ee.a.getSingleton().parseNodesToSdkData(e.nodes);i.push(l)}return e.table.forEach((function(e){var t=Z.a.getSingleton().parseTableNodeToSdkData(e,n);t&&o.push(t)})),{richTextData:i,tableData:o}}}]),e}();p()(ne,"instance",void 0),p()(ne,"getSingleton",(function(){return ne.instance||(ne.instance=new ne),ne.instance}));var re=n("8f58e78419"),ae=n.n(re),ie=n("798a9cd6f2"),oe=ie.a.COPYPASTE.PLACEHOLDER["1X"],le=ie.a.COPYPASTE.PLACEHOLDER["2X"],se=function(){function e(){var t=this;s()(this,e),p()(this,"parseHTML",(function(e,n){if(!e)return null;if(e=t.securityCheck(e),!(e=t.clipHTML(e)))return null;var r=(new DOMParser).parseFromString(e,"text/html");if(n&&n("DOMParseENDTAG"),null!=r&&r.body){var a,i=r.getElementsByTagName("style");i.length>0&&(a=i[0].cloneNode(!0));for(var o=0;o<i.length;o++){var l=i[o];l.parentNode&&l.parentNode.removeChild(l)}var s=t.parseNodes(r.body);if(n&&n("DOMToSimpleNodeENDTAG"),s){var c=ne.getSingleton().parse(s,a,t);return{dataList:c.richTextData,tableList:c.tableData,images:s.images}}return null}})),p()(this,"securityCheck",(function(e){return e=Object(te.c)(e,"script"),e=Object(te.c)(e,"iframe")})),p()(this,"clipHTML",(function(e){if(!e)return null;function t(e,t,n,r){var a=e.indexOf(t),i=e.lastIndexOf(n);return-1!==a&&-1!==i&&(r?a+=t.length:i+=n.length,e=e.substring(a,i)),e}var n="<html>\r\n<body>\r\n\x3c!--StartFragment--\x3e",r="\x3c!--EndFragment--\x3e\r\n</body>\r\n</html>";return e=t(e,n,r,!0),e=t(e,n="<html",r="</html>",!1)})),p()(this,"getImageData",(function(e,n,r,i,o){var l=/^data:image\/(png|gif|jpeg|x-icon|jpg|tiff);base64,.+/i.test(n);window.$;if(t.isLocalImage(n,o,l))return n=window.devicePixelRatio&&window.devicePixelRatio>=2?le:oe,e.src=n,{isLocal:!0,isFromHTML:!0,id:"attachment-".concat(+new Date,"-").concat(Object(te.l)()),url:n,order:void 0,size:{width:440,height:330},anchor:{row:r,col:i},offset:{x:0,y:0},clipInfo:{clipTop:0,clipLeft:0,clipRight:0,clipBottom:0}};if(Object(te.n)(n)||l){var s=t.getWidth(e),c=t.getHeight(e),u=0,d=0,p=0,f=0,v=e.dataset.clip;if(v){var h=v.match(/[\d.]+/g);if(h.length>=4){var g=h.map(Number),m=a()(g,4);u=m[0],d=m[1],p=m[2],f=m[3]}}var b=t.getOffsetX(e),y=t.getOffsetY(e),S={isFromHTML:!0,placeHolder:!0,url:n,id:"attachment-".concat(+new Date,"-").concat(Object(te.l)()),type:"pic",order:void 0,anchor:{row:r,col:i},offset:{x:b,y:y},size:{width:s,height:c},clipInfo:{clipTop:u,clipLeft:f,clipRight:d,clipBottom:p}},k=e.attributes.getNamedItem("addon");if(k){var P=k.value,w=X.c.parseAddonData(P);S=Object.assign(S,{addon:w})}return S}return null})),p()(this,"getWidth",(function(e){return e.style.width?parseInt(e.style.width.replace("px","")):-1})),p()(this,"getHeight",(function(e){return e.style.height?parseInt(e.style.height.replace("px","")):-1})),p()(this,"getOffsetX",(function(e){return e.style.marginLeft?parseInt(e.style.marginLeft.replace("px","")):-1})),p()(this,"getOffsetY",(function(e){return e.style.marginTop?parseInt(e.style.marginTop.replace("px","")):-1})),p()(this,"isLocalImage",(function(e,t,n){return e.match(/^file:\/\/[/].+(gif|jpg|jpeg|tiff|png)$/i)||t&&!n})),p()(this,"isNeedProcess",(function(e,t,n,r){return r[e]||n[e]&&t.childElementCount>0}))}return u()(e,[{key:"makeMap",value:function(e){for(var t={},n=e.split(","),r=0;r<n.length;r++)t[n[r]]=!0;return t}},{key:"parseNodes",value:function(e){var t=[],n=[],r=this.makeMap("address,article,applet,aside,audio,blockquote,button,canvas,center,div,dd,del,dir,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,img,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video,slide-data"),a=this.makeMap("div,p,ul,td"),i=this.makeMap("table,img"),o=this.makeMap("a,abbr,acronym,b,bdo,big,br,cite,code,dfn,em,font,i,img,input,kbd,label,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var,text");if(e){var l=[];l.push(e),this.processNodes(t,o,r,a,l,i)}return{nodes:t,images:n=this.processImages(e,n),table:this.processTables(e)}}},{key:"getParentNode",value:function(e,t,n){for(var r=e,a=t;r&&(a=r.tagName.toLowerCase(),r.nodeType!==Node.ELEMENT_NODE||!n[a]&&"body"!==a);)a=(r=r.parentNode||r.parentNodeText).tagName;return{resultNode:r,resultTagName:a}}},{key:"processNodes",value:function(e,t,n,r,a,i){for(;0!==a.length;){var o=a.pop();this.processNode(o,e,t,n,r,a,i)||this.processNodeStack(o,a)}}},{key:"processNode",value:function(e,t,n,r,a,i,o){if(e.nodeType===Node.TEXT_NODE)return this.processTextNode(e,t,n),!0;if(e.nodeType===Node.ELEMENT_NODE){var l=e.tagName.toLowerCase();if(r[l]||n[l]&&e.childElementCount>0){if(this.isNeedProcess(l,e,n,a)){var s=e.getElementsByTagName("div");return this.processDiv(s,e,i,t),!0}return o[l]||t.push([e]),!0}if("br"===l)return this.processLineFeed(t,n),!0;if(this.processMerge(e,n,t,r))return!0}return!1}},{key:"processNodeStack",value:function(e,t){if(e.tagName&&"span"!==e.tagName.toLowerCase())for(var n=e.childNodes,r=n.length-1;r>=0;r--)t.push(n[r]);else e.handled||(e.handled=!0,t.push(e))}},{key:"processMerge",value:function(e,t,n,r){if(0===e.children.length||t[e.tagName.toLowerCase()]>=0){if((e.textContent||"").length>0)return this.processMergeImpl(n,t,r,e),!0;if("a"!==e.tagName.toLowerCase())return!0}return!1}},{key:"processMergeImpl",value:function(e,t,n,r){var a,i=e[e.length-1],o=i&&i[i.length-1],l=null==o||null===(a=o.tagName)||void 0===a?void 0:a.toLowerCase();ae()(o,"newRow")||o&&t[o.tagName.toLowerCase()]<0||n[l]?e.push([r]):o&&t[o.tagName.toLowerCase()]>=0?this.tryMerge(o,n,r,i,e):o&&!o.newRow?i.push(r):e.push([r])}},{key:"tryMerge",value:function(e,t,n,r,a){var i=e.parentNode||e.parentNodeText,o="",l=this.getParentNode(i,o,t);o=l.resultTagName,i=l.resultNode;var s=n.parentNode||n.parentNodeText;o="",o=(l=this.getParentNode(s,o,t)).resultTagName,s=l.resultNode,e&&!e.newRow&&(i||s)&&i===s?r.push(n):a.push([n])}},{key:"processTables",value:function(e){var t=e.getElementsByTagName("table"),n=[];if(t&&t.length>0)for(var r=0;r<t.length;r++){var a=t[r];n.push(a)}return n}},{key:"processImages",value:function(e,t){var n=e.getElementsByTagName("img");if(t=[],n&&n.length>0)for(var r=0;r<n.length;r++){var a=n[r],i=a.getAttribute("data-src"),o=a.src.includes("localhost")?i:a.src,l=void 0!==a.attributes["v:shapes"],s=this.getImageData(a,o,0,0,l);s&&t.push(s)}return t}},{key:"processLineFeed",value:function(e,t){var n=e[e.length-1],r=n&&n[n.length-1];r&&null!=r&&r.tagName&&t[r.tagName.toLowerCase()]&&r&&!r.newRow&&(r.newRow=!0)}},{key:"processDiv",value:function(e,t,n,r){if(e.length>0)for(var a=t.childNodes,i=a.length-1;i>=0;i--)n.push(a[i]);else this.processChildNodes(t,n,r)}},{key:"processChildNodes",value:function(e,t,n){var r=e.childNodes;if(1===r.length){var i=a()(r,1)[0];if(e.href&&(i.href=e.href),i.nodeType===Node.TEXT_NODE){var o=i.nodeValue;(o=o.replace(/^\s+|\s+$/g,"")).length>0&&n.push([e])}else i.nodeType===Node.ELEMENT_NODE&&t.push(i)}else if(r.length>1)for(var l=r.length-1;l>=0;l--){var s=r[l];if(s.nodeType!==Node.TEXT_NODE)e.href&&(s.href=e.href),t.push(s);else{var c=s.nodeValue.replace(/^\s+|\s+$/g,"");if(c){var u=document.createElement("span");u.textContent=c,e.href&&u.setAttribute("href",e.href),s.parentNode.insertBefore(u,s),s.parentNode.removeChild(s),t.push(u)}}}}},{key:"processTextNode",value:function(e,t,n){var r=e.nodeValue;if((r=r.replace(/^\s+|\s+$/g,"")).length>0){var a=t[t.length-1],i=a&&a[a.length-1],o=document.createElement("span");o.textContent=r,Reflect.set(o,"parentNodeText",e.parentNode),Reflect.set(o,"parentElementText",e.parentElement),null!=i&&i.tagName&&n[i.tagName.toLowerCase()]&&i&&!i.newRow?a.push(o):t.push([o])}}}]),e}();p()(se,"instance",void 0),p()(se,"getSingleton",(function(){return se.instance||(se.instance=new se),se.instance}));var ce=se,ue=n("3471fb3b60"),de=n("36a8262c2a"),pe=function(){function e(){s()(this,e),p()(this,"element",void 0),p()(this,"isAppended",void 0),p()(this,"refCounter",void 0),this.element=void 0,this.isAppended=!1,this.refCounter=0}return u()(e,[{key:"append",value:function(){this.hasBeenDestroyed()&&this.create(),this.refCounter+=1,!this.isAppended&&document.body&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))}},{key:"create",value:function(){this.element=document.createElement("textarea"),this.element.id="CopyPasteAssist";var e=this.element.style;e.position="fixed",e.top="-10000px",e.left="-10000px",this.element.className="CopyPasteAssist",this.element.tabIndex=-1,this.element.autocomplete="off",this.element.wrap="hard",this.element.value=" "}},{key:"deselect",value:function(){this.element===document.activeElement&&document.activeElement.blur()}},{key:"destroy",value:function(){this.refCounter-=1,this.refCounter=this.refCounter<0?0:this.refCounter,this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.isAppended=!1)}},{key:"getValue",value:function(){return this.element.value}},{key:"hasBeenDestroyed",value:function(){return this.refCounter<1}},{key:"isActive",value:function(){return this.element===document.activeElement}},{key:"select",value:function(){this.element.focus(),this.element.select()}},{key:"setValue",value:function(e){this.element.value=e}}]),e}();p()(pe,"instance",void 0),p()(pe,"getSingleton",(function(){return pe.instance||(pe.instance=new pe),pe.instance.append(),pe.instance}));new pe;var fe=pe,ve=n("3344f1a2e7"),he=n("0d1cecd3de"),ge=n("69084d01d3"),me=n.n(ge),be=n("6d623d55ad"),ye=n.n(be),Se=n("f5c26c1469"),ke=n.n(Se);function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=function(){return k.a.show({message:E.a.t("加载幻灯片中，请稍后再试"),type:"info",autoClose:!0})},Ee=n("f8fc8e0087"),xe=n("e0a005a7aa"),De=n("54a7b7d7a1"),Te=n("ee6bb53310"),Ie=n.n(Te),Me=n("402eb050f3"),Oe=n("ce428b7e85"),Ae=n("2a5f3314a4"),Le=n("1e174780ae"),Ne=n("7c46f42788"),je=n("711a53c9fc"),Re=function e(){s()(this,e)};function Fe(e){var t={p:[],bodyPr:{}},n={egTextRun:[]},r={};r.t=e,r.rPr={},n.egTextRun.push({r:r}),t.p.push(n);var a={nvPr:{}};return a.nvPr.txBox=!0,a.txBody=t,a.type=Ne.a.Shape,a.spPr={prstGeom:{prst:je.gb.rect}},He(a),a}p()(Re,"checkCanAddIframe",void 0),p()(Re,"getCurrentSlideModel",void 0),p()(Re,"getPresentationModel",void 0);var Be=function(e){var t,n,r,a,i=Fe(e);null===(t=Re.getCurrentSlideModel)||void 0===t||null===(n=t.call(Re))||void 0===n||null===(r=n.sdkData)||void 0===r||null===(a=r.api)||void 0===a||a.addShapes([i]),X.c.selectLastAddElement(1)},_e=function(e){var t,n,r,a;if(e){var i=e.nvPr,o=e.txBody,l={};l.txBody=o,l.nvPr=i||{},l.type=Ne.a.Shape,l.spPr={prstGeom:{prst:je.gb.rect}},He(l),null===(t=Re.getCurrentSlideModel)||void 0===t||null===(n=t.call(Re))||void 0===n||null===(r=n.sdkData)||void 0===r||null===(a=r.api)||void 0===a||a.addShapes([l]),X.c.selectLastAddElement(1)}},He=function(e){var t,n;if(Me.b.supportEnterprise(Me.a.ALL))return e.props.xfrm=e.props.xfrm||{},e.props.xfrm.ext=e.props.xfrm.ext||{},e.props.xfrm.ext.cx=e.props.xfrm.ext.cx||5e6,void(e.props.xfrm.ext.cy=e.props.xfrm.ext.cy||5e6);var r=function(e){var t,n=Re.getCurrentSlideModel(),r=((null===(t=Re.getPresentationModel())||void 0===t?void 0:t.props)||{}).slideWidth,a=void 0===r?0:r,i={props:{style:{}},paragraphList:[]};e=Le.a.appendSdkDataInheritProp(e,n),Le.a.convertPartialDataFromSdkToUi(e,i);var o=i.paragraphList,l=a/2,s=Oe.a.convertFromTextModel({paragraphList:o},{noConvertBack:!0}),c=Object(Ae.s)(s,l);return Math.round(c.height)/De.g}(e),a=(null===(t=Re.getPresentationModel())||void 0===t?void 0:t.props.slideWidth)||0,i=(null===(n=Re.getPresentationModel())||void 0===n?void 0:n.props.slideHeight)||0;Ie()(e,"spPr.xfrm.ext.cy",Object(ve.E)(r)),Ie()(e,"spPr.xfrm.ext.cx",Object(ve.E)(a/De.g/2)),Ie()(e,"spPr.xfrm.off.y",Object(ve.E)(i/De.g/2-r/2)),Ie()(e,"spPr.xfrm.off.x",Object(ve.E)(a/De.g/4)),Ie()(e,"txBody.bodyPr.spAutoFit",!0)},Ue=n("5c2b595cb5"),Ge=n("5b326a30b1"),We=n("60b97ecf25"),ze=n("6ba11f23ff"),Ve=n("775b80aea6"),Xe=n("cd1934c1b5"),Ke=n("b86964b011"),$e=n("e0e8dd9366"),qe=n("ec5cae33cb"),Ye=n("5cdbac46e8"),Je=n("e71df909b9"),Qe=(n("22569efd03"),n("74f903c034"),n("929040bf89")),Ze=n("8c101803a8"),et=n("9657b29818"),tt=n("d5c3deb8c7"),nt=n("cab75c9091"),rt=n("9fbcf5162b"),at=n("692b88f5a6"),it=n("63945b6fba"),ot=n.n(it),lt=n("a7888a8b87"),st=n.n(lt),ct=n("a42b29265b"),ut=n("5c59da31dd"),dt=n("7b360969bf"),pt=n("5aaece8309"),ft=n("77c89fc0e0"),vt=n("ab17200d42"),ht=n("6ad6ba1542");function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var bt,yt=function(){function e(t){s()(this,e),p()(this,"slideSdkDataModify",void 0),p()(this,"uiDataService",void 0),p()(this,"selectionService",void 0),p()(this,"masterLayoutEditService",void 0),p()(this,"sectionManager",void 0),p()(this,"addonManager",void 0),this.storeManager=t,this.slideSdkDataModify=new at.a}return u()(e,[{key:"setServiceDelegates",value:function(e){var t,n,r,a,i;this.uiDataService=null!==(t=this.uiDataService)&&void 0!==t?t:e.uiDataService,this.selectionService=null!==(n=this.selectionService)&&void 0!==n?n:e.selectionService,this.masterLayoutEditService=null!==(r=this.masterLayoutEditService)&&void 0!==r?r:e.masterLayoutEditService,this.sectionManager=null!==(a=this.sectionManager)&&void 0!==a?a:e.sectionManager,this.addonManager=null!==(i=this.addonManager)&&void 0!==i?i:e.addonManager,this.slideSdkDataModify.setServiceDelegates(e)}},{key:"pasteSdkDataOmitTable",value:function(e){var t,n=this,r=[],a=[];vt.c?(r=e.data.map((function(e){return e.ownSdkData})),a=(null===(t=e.noteList)||void 0===t?void 0:t.map((function(e){return e.ownSdkData})))||[]):(r=e.data,a=r.filter((function(e){return e.type===Ne.a.Notes})));var i=r.every((function(e){return e.type===Ne.a.SlideLayout})),o=r.filter((function(e){return e.type===Ne.a.Slide})),l=!!o.length,s=r[0].type===Ne.a.Section;if(this.modifyCopySdkModel(e),i)this.pasteSdkModelToAddLayout(r,e),this.storeManager.updateLastMouseDownRegion(qe.a.SLIDELIST);else if(s)this.pasteSdkModelToAddSection(r,e),this.storeManager.updateLastMouseDownRegion(qe.a.SLIDELIST);else if(l){var c;if(null!==(c=this.masterLayoutEditService)&&void 0!==c&&c.isMasterEditType)return;var u={};Object(et.b)((function(){u=n.pasteSdkModelToAddSlide(e),a.length&&!ot()(u)&&a.forEach((function(e){var t,n=null===(t=u)||void 0===t?void 0:t[e.slideId];null==n||n.api.addNoteSlide(mt(mt({},e),{},{slideId:n.id}))}))})),X.c.selectLastAddSlide(this.storeManager.getInsertSlideIndex(),Object.keys(u).length,$e.d.SLIDE),this.storeManager.updateLastMouseDownRegion(qe.a.SLIDELIST)}else this.pasteSdkModelToAddShape(e),this.storeManager.updateLastMouseDownRegion(qe.a.EDITOR)}},{key:"modifyCopySdkModel",value:function(e){vt.c?(e.data.forEach((function(e){[e.inheritedSdkData,e.ownSdkData].forEach((function(e,t){var n="paste_".concat(0===t?"inherited":"owned");Object(ht.a)(e,n,null==e?void 0:e.type)}))})),this.clearInvalidConnectorPoints(e.data.map((function(e){return e.inheritedSdkData}))),this.clearInvalidConnectorPoints(e.data.map((function(e){return e.ownSdkData}))),ut.a.modifyPrstGeomAdjName(e.data.map((function(e){return e.inheritedSdkData}))),ut.a.modifyPrstGeomAdjName(e.data.map((function(e){return e.ownSdkData}))),ut.a.addPrstGeomInPicture(e.data.map((function(e){return e.inheritedSdkData}))),ut.a.addPrstGeomInPicture(e.data.map((function(e){return e.ownSdkData})))):(this.clearInvalidConnectorPoints(e.data),ut.a.modifyPrstGeomAdjName(e.data),ut.a.addPrstGeomInPicture(e.data))}},{key:"clearInvalidConnectorPoints",value:function(e){var t=null==e?void 0:e.map((function(e){return null==e?void 0:e.id})).filter((function(e){return!!e})),n=null==e?void 0:e.filter((function(e){return(null==e?void 0:e.type)===Ne.a.Connector}));null==n||n.forEach((function(e){var n,r,a=null===(n=e.nvPr)||void 0===n?void 0:n.stCxn,i=null===(r=e.nvPr)||void 0===r?void 0:r.endCxn;null!=a&&a.id&&!t.includes(a.id)?delete e.nvPr.stCxn:null!=a&&a.id&&void 0===a.idx&&(a.idx=0),null!=i&&i.id&&!t.includes(i.id)?delete e.nvPr.endCxn:null!=i&&i.id&&void 0===i.idx&&(i.idx=0)}))}},{key:"pasteSdkModelToAddShape",value:function(e){var t,n=this;if(vt.c)this.pasteSpecialSdkModelToAddShape(e);else{var r=e.data;if(r.length){var a=[],i=r.filter(this.isIframeElementFromSdkData).length,o=!(null!==(t=this.addonManager)&&void 0!==t&&t.canAddIframeElement(i));r.forEach((function(e){var t;if(!n.isIframeElementFromSdkData(e)||!o){var r=Object(Qe.a)(e);Ze.a.adjustElementPosition(r,null===(t=n.selectionService)||void 0===t?void 0:t.currentSlide),a.push(r)}})),a.length&&(Ze.a.checkAndAdjustElementPosition(a),Object(tt.w)((function(){var e,t,r;null===(e=n.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t||null===(r=t.sdkData)||void 0===r||r.api.addShapes(a),X.c.selectLastAddElement(a.length)})))}}}},{key:"pasteSpecialSdkModelToAddShape",value:function(e){var t,n,r,i=this,o=e.data;if(o.length){ut.a.removeAttachment(e)&&ft.a.getInstance().show({message:ft.l.t("暂不支持跨文档粘贴附件"),commonTipsType:ft.c.INFO,block:!1,autoClose:!0});var l=[],s=st()(o),c=o.filter(this.isIframeElementFromSdkData).length,u=!(null!==(t=this.addonManager)&&void 0!==t&&t.canAddIframeElement(c)),d=null===(n=this.selectionService)||void 0===n||null===(r=n.currentSlide)||void 0===r?void 0:r.sdkData;s.forEach((function(e){e.ownSdkData=ut.a.updatePlaceHolderData(e.ownSdkData,d),Object.keys(e).forEach((function(t){var n;i.isIframeElementFromSdkData(e[t])&&u||Ze.a.adjustElementPosition(e[t],null===(n=i.selectionService)||void 0===n?void 0:n.currentSlide,t)})),l.push(e.ownSdkData)})),Ze.a.checkAndAdjustElementPosition(l),Object(tt.w)((function(){var t,n,r;ut.a.updateResourceMap({presentation:null===(t=i.uiDataService)||void 0===t||null===(n=t.presentation)||void 0===n?void 0:n.sdkData,resourceMap:e.resourceMap,copiedDocId:e.globalPadId});var o=(null==d||null===(r=d.api)||void 0===r?void 0:r.addShapes(l))||[],s=a()(o,1)[0];X.c.selectLastAddElement(l.length),e.sdkVersion===ct.b.Version3&&dt.a.emit(pt.a.EDIT_PASTE_PANEL,{clipboardData:e,type:ct.c.SHAPE,firstElementDataId:s.id})}))}}},{key:"pasteSdkModelToAddLayout",value:function(e,t){var n=this,r=t.globalPadId,a=t.slideSize,i=this.getNewSlideSdkData(e,{globalPadId:r,slideSize:a}),o=Ne.a.SlideLayout;i.length&&e.every((function(e){return e.type===o}))&&(Object(et.b)((function(){var t,r,a,o,l,s,c,u,d=n.selectionService;if(d){var f=null!==(t=null===(r=n.uiDataService)||void 0===r?void 0:r.presentation)&&void 0!==t?t:{masterList:[],layoutList:[]},v=f.masterList,h=f.layoutList,g=d.currentSlide,m=d.currentSlideType,b=n.getLayoutInsertIndex(),y=null!==(a=(o={},p()(o,$e.d.MASTER,v.findIndex((function(e){return e.id===(null==g?void 0:g.id)}))),p()(o,$e.d.LAYOUT,v.findIndex((function(e){return e.id===(null==g?void 0:g.masterId)}))),o)[m])&&void 0!==a?a:0;i.forEach((function(e){var t,n=null===(t=v[y])||void 0===t?void 0:t.id;n&&(e.masterId=n)})),null===(l=n.uiDataService)||void 0===l||null===(s=l.presentation.sdkData)||void 0===s||null===(c=s.api)||void 0===c||c.addLayouts(i,b);var S=null!==(u=nt.a.getUiIndexFromSdkIndex(nt.a.getUiLayoutList(v),h,b))&&void 0!==u?u:0;n.afterAddSlides(S,e.length)}})),Object(F.c)({opername:B.e.DOC_PPT,module:B.d.MASTER,action:B.b.THUMB_PASTE}))}},{key:"pasteSdkModelToAddSlide",value:function(e){var t,n=this;if(vt.c)return this.pasteSpecialSdkModelToAddSlide(e);var r=e.data,a=e.globalPadId,i=e.slideSize,o=this.getNewSlideSdkData(r,{globalPadId:a,slideSize:i});if(!o.length)return{};var l={},s=this.storeManager.getInsertSlideIndex(),c=this.storeManager.getInsertGapIndex();return Object(et.b)((function(){var e,t,r=o.map((function(e){var t=mt({},e);return delete t.noteSlideId,t})),a=null===(e=n.uiDataService)||void 0===e?void 0:e.presentation.sdkData;null!=a&&null!==(t=a.sectionList)&&void 0!==t&&t.length?null==a||a.api.addSlidesWithSection(r,c):null==a||a.api.addSlides(r,c),l=Object.fromEntries(o.map((function(e,t){var r,a;return[e.id,null===(r=n.uiDataService)||void 0===r||null===(a=r.presentation.sdkData)||void 0===a?void 0:a.slideList[s+t]]})))})),null===(t=this.sectionManager)||void 0===t||t.expandSelectedSection(),l}},{key:"pasteSpecialSdkModelToAddSlide",value:function(e){var t,n,r,a=this;if(!e.data.length)return{};ut.a.removeAttachment(e)&&ft.a.getInstance().show({message:ft.l.t("暂不支持跨文档粘贴附件"),commonTipsType:ft.c.INFO,block:!1,autoClose:!0});var i=null===(t=this.uiDataService)||void 0===t||null===(n=t.presentation)||void 0===n?void 0:n.sdkData,o={},l=this.storeManager.getInsertSlideIndex(),s=this.storeManager.getInsertGapIndex();return Object(et.b)((function(){var t;if(!a.uiDataService)return{};var n=ut.a.reorganizeSlideSdkData({clipboardData:e,insertSlideIndex:l>0?l-1:l,sdkDataV3:i,slideSdkDataModify:a.slideSdkDataModify,uiDataService:a.uiDataService});if(!n)return{};var r=n.map((function(e){return e.ownSdkData}));ut.a.updateResourceMap({presentation:i,resourceMap:e.resourceMap,copiedDocId:e.globalPadId}),null!=i&&null!==(t=i.sectionList)&&void 0!==t&&t.length?null==i||i.api.addSlidesWithSection(r,s):null==i||i.api.addSlides(r,s),Promise.resolve().then((function(){e.sdkVersion===ct.b.Version3&&dt.a.emit(pt.a.SLIDE_PASTE_PANEL,{clipboardData:e,type:ct.c.SLIDE,insertSlideIndex:l,insertGapIndex:s})})),o=Object.fromEntries(n.map((function(e,t){var n,r,i;return[e.ownSdkData.id,null===(n=a.uiDataService)||void 0===n||null===(r=n.presentation)||void 0===r||null===(i=r.sdkData)||void 0===i?void 0:i.slideList[l+t]]})))})),null===(r=this.sectionManager)||void 0===r||r.expandSelectedSection(),o}},{key:"getNewSlideSdkData",value:function(e,t){var n=this,r=t.globalPadId,a=t.slideSize,i=[];return e.forEach((function(t){if(t.type===Ne.a.Slide){var o,l=Object(Qe.a)(t);(null===(o=x.a.DocInfoManager())||void 0===o?void 0:o.globalPadId)!==r&&n.slideSdkDataModify.adjustPageData(l,a),i.push(l)}if(e.every((function(e){return e.type===Ne.a.SlideLayout}))&&t.type===Ne.a.SlideLayout){var s=Object(Qe.a)(t);i.push(s)}})),i}},{key:"pasteSdkModelToAddSection",value:function(e,t){var n,r,i=this,o=(null!==(n=null===(r=this.uiDataService)||void 0===r?void 0:r.presentation)&&void 0!==n?n:{sectionList:[]}).sectionList;if(o&&0!==o.length){var l=a()(e,1)[0],s=this.getNewSlideSdkData(e.slice(1),t);if(l&&s.length){var c=this.storeManager.getInsertSlideIndex(),u=rt.a.calcClearanceIndexFromSlideIndex(c-1,o);Object(et.b)((function(){var e,t,n=null===(e=i.uiDataService)||void 0===e?void 0:e.presentation.sdkData;null!=n&&null!==(t=n.sectionList)&&void 0!==t&&t.length?null==n||n.api.addSlidesWithSection(s,u):null==n||n.api.addSlides(s,u),null==n||n.api.addSection(l.name,u)})),X.c.selectLastAddSlide(c,s.length)}}}},{key:"afterAddSlides",value:function(e,t){var n;if(null!==(n=this.uiDataService)&&void 0!==n&&n.presentation.hasSections()){var r,a=this.uiDataService.presentation.sectionList||[],i=null===(r=this.selectionService)||void 0===r?void 0:r.slideClearanceIndex;if("number"!=typeof i||-1===i){var o,l,s,c,u,d,p=null!==(o=null===(l=this.selectionService)||void 0===l?void 0:l.currentSlideIndex)&&void 0!==o?o:-1,f=null!==(s=null===(c=this.sectionManager)||void 0===c?void 0:c.selectedSectionIndex)&&void 0!==s?s:-1;if(-1!==f)i=rt.a.calcClearanceIndexFromSectionIndex(f,a)+(null!==(u=null===(d=a[f])||void 0===d?void 0:d.numSlides)&&void 0!==u?u:0);else i=-1!==p?rt.a.calcClearanceIndexFromSlideIndex(p,a):rt.a.calcClearanceIndexFromSlideIndex(e,a)}this.uiDataService.presentation.getSectionProperty().insertSlideIntoCorrespondingSection(i,t)}}},{key:"getLayoutInsertIndex",value:function(){var e,t,n,r,a=this.selectionService;if(a){var i=null!==(e=null===(t=this.uiDataService)||void 0===t?void 0:t.presentation)&&void 0!==e?e:{masterList:[],layoutList:[]},o=i.masterList,l=i.layoutList,s=a.currentSlide,c=a.currentSlideType,u=null==s?void 0:s.getRelationMasterModel();return null!==(n=(r={},p()(r,$e.d.MASTER,nt.a.getIndexFromMaster(o,l,s)),p()(r,$e.d.LAYOUT,nt.a.getIndexFromLayout(null==u?void 0:u.layoutList,s)),r)[c])&&void 0!==n?n:0}}},{key:"isIframeElementFromSdkData",value:function(e){var t,n;return e.type===Ne.a.Shape&&Number(null==e||null===(t=e.nvPr)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.displayMode)===(null===je.f||void 0===je.f?void 0:je.f.iframe)}}]),e}(),St=n("e0b2192bab"),kt=n("7a5536c9bf"),Pt=n.n(kt),wt=(n("c9a7ecac4d"),function(){function e(){s()(this,e)}return u()(e,null,[{key:"getCopiedNoteSdkData",value:function(e){var t=[];return e.forEach((function(e){var n;if(e.type===$e.d.SLIDE&&e.noteData){var r=null===(n=e.sdkData)||void 0===n?void 0:n.getNoteSlide();r&&t.push({inheritedSdkData:r.getInheritedData(),ownSdkData:r.getOwnedData()})}})),st()(t)}},{key:"getNeedCopiedMasterList",value:function(e,t){if(!e.length)return[];var n=new Set;return e.forEach((function(e){if(e.type===$e.d.SLIDE){var t=e.getMasterId();n.add(t)}})),t.filter((function(e){return n.has(e.id)}))}},{key:"getCopiedMasterSdkData",value:function(e){return e.map((function(e){return e.copyModelHandler().getCopiedSdkModel({withoutInheritedData:!0})}))}},{key:"getCopiedLayoutSdkData",value:function(e){var t=[];return e.forEach((function(e){var n=e.layoutList.map((function(e){return e.copyModelHandler().getCopiedSdkModel({withoutInheritedData:!0})}));t=[].concat(Pt()(t),Pt()(n))})),t}},{key:"getCopiedThemeSdkData",value:function(e){var t=[],n=[];return e.forEach((function(e){var r=e.getTheme();if(r&&!n.includes(r)){n.push(r);var a=r.copyModelHandler().getCopiedSdkModel({withoutInheritedData:!0});t.push(a)}})),t}}]),e}()),Ct=n("1ce94b3b3e"),Et=n("37091e4240"),xt=n("db50d57b55"),Dt=n("05d181ac40"),Tt=n("c45b58bbe8"),It=n("c9c92622ff");function Mt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ot(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.SLIDE="slide",e.SHAPE="shape",e.PICTURE="pic",e.GROUPSHAPE="groupShape",e.CONNECTOR="cxnSp",e.TABLE="graphFrame_Tbl",e.MASTER="master",e.LAYOUT="layout",e.SECTION="section",e.CHART="chart"}(bt||(bt={}));var Nt=[bt.SLIDE,bt.LAYOUT,bt.SECTION,bt.SHAPE,bt.GROUPSHAPE,bt.PICTURE,bt.CONNECTOR,bt.TABLE,bt.CHART],jt=function(){function e(){var t=this;s()(this,e),p()(this,"pasteSdkHandler",void 0),p()(this,"forceAsyncModel",void 0),p()(this,"textarea",fe.getSingleton()),p()(this,"snackbarOp",void 0),p()(this,"copyElementDataUrl",void 0),p()(this,"isCut",!1),p()(this,"enable",!0),p()(this,"dragStatus",{isDragged:!1,enableDrop:!1}),p()(this,"tableCannotPasteTip",void 0),p()(this,"inTest",!1),p()(this,"isSafariLower15",this.judgeSafariVersion()),p()(this,"clipboardManager",void 0),p()(this,"storeManager",void 0),p()(this,"imageEditManager",void 0),p()(this,"services",void 0),p()(this,"copyPasteInjectable",void 0),p()(this,"savedDropModel",null),p()(this,"clearDraggingState",(function(){t.dragStatus={isDragged:!1,enableDrop:!1},t.snackbarOp&&(t.snackbarOp.close(),t.snackbarOp=null)})),p()(this,"initCPHtml",(function(){Re.checkCanAddIframe=function(){var e,n;return!(null===(e=t.services)||void 0===e||null===(n=e.addonManager)||void 0===n||!n.canAddIframeElement())},Re.getCurrentSlideModel=function(){var e,n;return null===(e=t.services)||void 0===e||null===(n=e.selectionService)||void 0===n?void 0:n.currentSlide},Re.getPresentationModel=function(){var e,n;return null===(e=t.services)||void 0===e||null===(n=e.uiDataService)||void 0===n?void 0:n.presentation}})),p()(this,"insertPageImport",function(){var e=o()(v.a.mark((function e(n){var r,a,i,o,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=t.services)||void 0===r||null===(a=r.importFileSelectManager)||void 0===a?void 0:a.promise();case 2:null==(l=e.sent)||l.setVisible(!1),Object(F.c)({opername:B.e.PAGING_SELECTION,module:B.d.SLIDE_UPLOAD,action:B.b.DRAG_IMPORT}),Object(F.c)({opername:B.e.DOC_PPT,module:B.d.DRAG_FILE,action:B.b.DRAG_FILE_NEW}),null===(i=t.services)||void 0===i||null===(o=i.importFileManager)||void 0===o||o.promise().then((function(e){e.parseAndPreviewSlideFile(n[0])}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.registerEventListener(),this.tableCannotPasteTip=X.c.tableCannotPasteTipFun(),this.storeManager=new de.b,this.imageEditManager=Ue.a.getInstance(),this.pasteSdkHandler=new yt(this.storeManager)}var t,r,i,l,c,d,f,h,S;return u()(e,[{key:"setInject",value:function(e){this.copyPasteInjectable=e,this.clipboardManager=new V(this,e),this.imageEditManager.enableImageRecovery=e.enableImageRecovery}},{key:"copyText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.copyDataToText(g.a.TEXT,e),this.clipboardManager.write()}},{key:"successWrite",value:function(){}},{key:"failWrite",value:function(){}},{key:"finallyWrite",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.removeEleIfIsCut(),t&&this.storeManager.base64UrlTempMap.clear()}},{key:"getUserPermissionToCopyData",value:function(){return new Promise((function(e,t){var n,r,a,i,o,l;n=e,r=t,a=!1,i={verticalAlign:"middle",display:"block"},o=we({position:"relative",top:"2px",width:"15px",height:"15px",background:"url(".concat(ke.a,")")},i),l=k.a.show({className:"copy-snackbar",message:E.a.t("剪贴板已写入"),action:[{text:me.a.createElement("div",{style:we({color:"#1e6fff"},i)},E.a.t("粘贴到其他应用")),onClick:function(){a=!0,l.close(),n()}},{text:me.a.createElement(ye.a,{title:E.a.t("由于浏览器的限制，点击「粘贴到其他应用」按钮，可将复制/剪切的内容带格式粘贴到其他应用。")},me.a.createElement("i",{style:o})),onClick:function(){return l.show()}}],type:"success",autoClose:!0,duration:3e3,closable:!0,onClose:function(){return!a&&r("User actively denied permission")}}),setTimeout((function(){return r("Waiting time is too long and permission is not obtained")}),3e3)}))}},{key:"runTextSelectivePaste",value:function(e){var t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=null===(t=this.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.selectedElements.getCurrentModel();if(Object(It.k)(i)){var o,l;_e(e);var s=null===(o=this.services)||void 0===o||null===(l=o.selectionService)||void 0===l?void 0:l.selectedElements.getCurrentModel().editorInstance;null==s||s.setFocus()}else{var c=a()(this.storeManager.selectedElements,1)[0];if(Object(It.B)(c)||c.type===$e.d.CHART)this.useElementPaste(c,e,r);else if(Object(It.D)(c)){var u=c.getEditingCellModel();u&&this.useElementPaste(u,e,r)}else;}}},{key:"registerEventListener",value:function(){var e,t,r=this;(b.default.isIOS||C.a.isSafariVersionBelow(14))&&(this.textarea.element.addEventListener("copy",(function(e){return r.copy(e)})),this.textarea.element.addEventListener("paste",(function(e){return r.pasteByEvent(e)})),this.textarea.element.addEventListener("cut",(function(e){return r.cut(e)})),document.body.addEventListener("keyup",(function(e){(b.default.isMac?e.metaKey:e.ctrlKey)||!r.textarea.isActive()||document.activeElement.blur()}))),window.addEventListener("copy",(function(e){!r.storeManager.activePointInSideBar&&r.enable&&r.copy(e)}),!0),window.addEventListener("paste",(function(e){!r.storeManager.activePointInSideBar&&r.enable&&r.pasteByEvent(e)}),!0),window.addEventListener("cut",(function(e){!r.storeManager.activePointInSideBar&&r.enable&&r.cut(e)}),!0),window.addEventListener("dragleave",(function(e){if(r.enable){var t=document.documentElement.clientHeight,n=document.documentElement.clientWidth;e&&(e.x>=n||e.x<=0||e.y>=t||e.y<=0)&&r.clearDraggingState()}}),!0),window.addEventListener("drop",(function(e){var t;if(!(null===(t=r.getPlayManager())||void 0===t?void 0:t.isPlaying)&&r.enable){var n;if(r.clearDraggingState(),!e.dataTransfer)return;if(null===(n=e.dataTransfer.files)||void 0===n||!n.length)return;e.preventDefault(),e.stopPropagation(),r.onDrop(e)}}),!1),Et.b.on(Et.a.TRIGGER_COPY_EVENT,(function(e){return e(r.triggerCopyEvent.bind(r))})),null===(e=this.copyPasteInjectable)||void 0===e||null===(t=e.registerCustomCopyPasteListeners)||void 0===t||t.call(e,this),Dt.a.IS_TEST&&(window.ua=b.default,b.default.isMiniProgram&&n.e(0).then(n.t.bind(null,"3d01c75799",7)).then((function(e){return new(0,e.default)})))}},{key:"getImgDragoverSnackbarMessage",value:function(){return E.a.t("拖拽到形状或图片上即可填充")}},{key:"triggerCopyEvent",value:function(e){return!(!this.triggerCopyByTextarea(e)&&!this.triggerDefaultCopyEvent())||(window.log.warn("[CopyPasteManager] trigger copy failed"),!1)}},{key:"triggerDefaultCopyEvent",value:function(){return window.log.info("[CopyPasteManager] try to use execCommand trigger copy"),document.execCommand("copy")}},{key:"triggerCopyByTextarea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ";this.textarea.setValue(e),this.textarea.select();var t=document.getSelection();if(!document.queryCommandEnabled("copy")&&null!=t&&t.isCollapsed){var n=document.createRange();n.selectNodeContents(document.body),null==t||t.addRange(n)}return window.log.info("[CopyPasteManager] try to use textarea trigger copy"),this.triggerDefaultCopyEvent()}},{key:"triggerCutEvent",value:function(){this.isCut=!0,this.triggerCopyEvent()}},{key:"triggerPasteEvent",value:function(){this.pasteByAction()}},{key:"keyEventCtrl",value:function(){this.storeManager.activePointInShape||this.textarea.select()}},{key:"cut",value:function(e){this.storeManager.canEdit&&(this.isCut=!0),this.copy(e)}},{key:"removeEleIfIsCut",value:function(){this.isCut&&(X.c.doCutDelete(),this.resetCutStatus())}},{key:"resetCutStatus",value:function(){this.isCut=!1}},{key:"shouldCopyPasteShortcutKeyActive",value:function(){var e,t,n,r,a,i=null===(e=this.getPlayManager())||void 0===e?void 0:e.isPlaying,o=null===(t=this.getSelectionService())||void 0===t?void 0:t.lastMouseDownRegion;return i?o===qe.a.NOTE&&(null===(a=this.getEditorInstanceService())||void 0===a?void 0:a.checkEditorIsEditing()):null===(n=this.services)||void 0===n||null===(r=n.shortCutKeyManager)||void 0===r||!r.dangerousInstance||this.services.shortCutKeyManager.dangerousInstance.shouldShortcutKeyActive()}},{key:"shouldResponseCopy",value:function(e){var t,n,r,a,i,o,l;return null!=e&&e.copyValueStr?(e.copyValueMethod(),!1):!!this.shouldCopyPasteShortcutKeyActive()&&(!X.c.isSelectedNone()&&(!this.storeManager.selectedSlides.some((function(e){return e.preload}))&&!this.storeManager.selectedElements.some((function(e){var t;return null===(t=e.slideRef)||void 0===t?void 0:t.preload}))&&(null!==(t=this.copyPasteInjectable)&&void 0!==t&&null!==(n=t.disableCopy)&&void 0!==n&&n.call(t,this)?(null===(a=this.services)||void 0===a||null===(i=a.tipsManager)||void 0===i||i.showCannotCopyTips(),!1):this.storeManager.canEditAndCopy?null===(r=this.getUiDataService())||void 0===r||!r.presentation.operation.loading||(Ce(),!1):(null===(o=this.services)||void 0===o||null===(l=o.tipsManager)||void 0===l||l.showCannotCopyTips(),!1))))}},{key:"shouldResponsePaste",value:function(e){var t,n,r,a;return!!this.shouldCopyPasteShortcutKeyActive()&&("input-title"!==(null===(t=document.activeElement)||void 0===t?void 0:t.id)&&(!this.storeManager.selectedSlides.some((function(e){return e.preload}))&&!this.storeManager.selectedElements.some((function(e){var t;return null===(t=e.slideRef)||void 0===t?void 0:t.preload}))&&(this.storeManager.canEdit?null===(n=this.getUiDataService())||void 0===n||!n.presentation.operation.loading||(Ce(),!1):(null===(r=this.services)||void 0===r||null===(a=r.tipsManager)||void 0===a||a.showCannotEditTips(),!1))))}},{key:"getBase64UrlMap",value:function(){return this.storeManager.base64UrlTempMap}},{key:"copy",value:function(e){var t,n=this,r=null==e?void 0:e.target;if(b.default.isTencentDocsApp||"TEXTAREA"===(null==r?void 0:r.tagName)&&r.id!==this.textarea.element.id||A)return!1;var a={copyValueStr:null===(t=this.textarea)||void 0===t?void 0:t.getValue().trim(),copyValueMethod:function(){return setTimeout((function(){return n.textarea.setValue("")}),0)}};this.shouldResponseCopy(a)?(e.preventDefault(),e.stopPropagation(),X.c.getEventType(e)===X.a.ClipboardEvent&&this.clipboardCopyEvent(e)):this.resetCutStatus()}},{key:"clipboardCopyEvent",value:function(e){this.clipboardManager.startCopy(),this.storeManager.isSlideListRegion?this.copySlides():this.storeManager.isEditorRegion?this.storeManager.activePointInShape||this.isSelectContentCopy()?this.copyInEditing():this.copyNoEditing():this.storeManager.isNoteRegion&&this.copyInNote(),this.clipboardManager.write(e),this.focusCachedActiveElement()}},{key:"copyInNote",value:function(){var e,t,n,r=null===(e=this.getSelectionService())||void 0===e||null===(t=e.currentSlide)||void 0===t||null===(n=t.noteData)||void 0===n?void 0:n.noteTextBody;if(null!=r&&r.editorInstance){var a,i,o=this.isCut?null===(a=r.editorInstance)||void 0===a?void 0:a.cut():null===(i=r.editorInstance)||void 0===i?void 0:i.copy();if(o){var l=this.storeManager.getTextSelectedAreaCopyData(o,r);this.copyDataToHTML(m.a.CUSTOM_INHERIT_AND_NO_INHERIT,l),this.copyDataToText(g.a.ELEMENT_INHERIT_AND_NO_INHERIT,l)}this.resetCutStatus()}else{var s;window.log.info("note area text editing editorInstance is null info: isEditing:".concat(null===(s=this.getEditorInstanceService())||void 0===s?void 0:s.checkEditorIsEditing(),"sdkDataType:").concat(null!=r&&r.sdkData?r.sdkData.type:""))}}},{key:"copyNoEditing",value:function(){var e=this.storeManager.selectedElements;this.copyPlaceholderDataToText(),this.copyElementDataToImage(e),1===(null==e?void 0:e.length)?this.copyNoEditingWithSingleElement(e[0]):this.copyDataToHTML(m.a.MULTI_ELEMENT)}},{key:"copyNoEditingWithSingleElement",value:function(e){var t=e.sdkData;e.type===$e.d.IMAGE?(this.copyDataToHTML(m.a.IMAGE),this.isMedia(t)?this.copyDataToText(g.a.TEXT,E.a.t("您粘贴的区域不支持音频插入。")):(!function(e){var t,n;(null!=e&&null!==(t=e.image)&&void 0!==t&&t.chartRelation||null!=e&&null!==(n=e.image)&&void 0!==n&&n.chartStaticFolder)&&k.a.show({message:E.a.t("图表暂不支持复制，将粘贴为图片。"),type:"info",autoClose:!0})}(t),this.copyDataToText(g.a.TEXT,E.a.t("您粘贴的区域不支持图片插入。")))):e.type===$e.d.TABLE?this.copyNoEditingWithSingleTable():(this.isIframeElementFromSdkData(e.sdkData)&&this.copyDataToText(g.a.ELEMENT,[e]),this.copyDataToHTML(m.a.CUSTOM))}},{key:"copyNoEditingWithSingleTable",value:function(){if(this.storeManager.useBase64Copy)this.asyncCopyNoEditingWithSingleTable();else{var e=this.storeManager.getSelectedElementsCopyData();this.copyDataToHTML(m.a.TABLE,e);var t=e.data.map((function(e){return{sdkData:e}}));this.copyDataToText(g.a.ELEMENT,t)}}},{key:"asyncCopyNoEditingWithSingleTable",value:function(){var e=this.storeManager.getSelectedElementsCopyDataToBase64();this.copyDataToHTML(m.a.TABLE,e);var t=this.storeManager.getSelectedElementsCopyData().data.map((function(e){var t=e;return vt.c&&(t=e.inheritedSdkData),{sdkData:t}}));this.copyDataToText(g.a.ELEMENT,t)}},{key:"copyDataToText",value:function(e,t){var n;e===g.a.ELEMENT?n=t instanceof Array?t:[]:e===g.a.ELEMENT_INHERIT_AND_NO_INHERIT?n=t.data:e===g.a.TEXT&&(n="string"==typeof t?t:""),this.clipboardManager.save(p()({},y.a.TEXT,{type:e,data:n}))}},{key:"copyElementDataToImage",value:function(e){}},{key:"copySlideDataToImage",value:function(){}},{key:"getSlideDataToCanvas",value:(S=o()(v.a.mark((function e(t,n,r){var a,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||this.getExportCanvasOptions(n),e.next=3,this.forceConvertSlides(t);case 3:if(0!==(null===(a=this.getUiDataService())||void 0===a?void 0:a.presentation.children.indexOf(t[0]))||b.default.isPC){e.next=7;break}return e.next=7,new Promise((function(e){return setTimeout(e,500)}));case 7:return e.abrupt("return",this.generateSlideCanvas(t,i));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return S.apply(this,arguments)})},{key:"isForceAsyncModel",value:function(){return this.forceAsyncModel}},{key:"getFakeCanvasOptions",value:function(){return{slideWidth:43,slideHeight:27,width:1,height:1,scale:1,resolution:1,cloneNode:!1}}},{key:"getExportCanvasOptions",value:function(e){return this.getExportCanvasOptionsForCanvas(e)}},{key:"getExportCanvasOptionsForCanvas",value:function(e){var t,n,r,a=null!==(t=null===(n=this.getUiDataService())||void 0===n?void 0:n.presentation.props)&&void 0!==t?t:{slideWidth:0,slideHeight:0,slideSizeType:Ge.a.SLIDE_SIZE_4_3},i=a.slideWidth,o=a.slideHeight,l=a.slideSizeType,s=this.getAspectWIdthBySizeType(l);return{slideWidth:s,slideHeight:r=l===Ge.a.SLIDE_SIZE_4_3?s*(3/4):l===Ge.a.SLIDE_SIZE_16_9?s*(9/16):s*(o/i),width:s,height:r,scale:s/i,resolution:e,cloneNode:!1}}},{key:"getCopyCanVasOptions",value:function(){var e,t,n,r,a,i=null!==(e=null===(t=this.getUiDataService())||void 0===t?void 0:t.presentation.props)&&void 0!==e?e:{slideWidth:0,slideHeight:0},o=i.slideWidth,l=i.slideHeight,s=null!==(n=null===(r=this.services)||void 0===r||null===(a=r.editAreaCanvasSizeManager)||void 0===a?void 0:a.getCanvasScale())&&void 0!==n?n:1;return{slideWidth:o,slideHeight:l,width:o*s,height:l*s,scale:s,resolution:.8,cloneNode:!0}}},{key:"setServiceDelegates",value:function(e){this.services?this.services=Lt(Lt({},this.services),e):this.services=e,this.initCPHtml(),this.imageEditManager.setServicesDelegate(this.services),this.clipboardManager.setServicesDelegate(this.services),X.b.setServicesDelegate(this.services),this.storeManager.setServiceDelegates(this.services),this.pasteSdkHandler.setServiceDelegates(this.services)}},{key:"copyDataToHTML",value:function(e,t){var n,r=t;r||(r=this.storeManager.useBase64Copy&&e===m.a.IMAGE?this.storeManager.getSelectedElementsCopyDataToBase64():this.storeManager.getSelectedElementsCopyData()),e===m.a.SLIDE&&this.handleSlideCopyData(r);var a=null===(n=this.storeManager.uiDataService)||void 0===n?void 0:n.presentation.sdkData;r.resourceMap=a.findUsedResourceMap(r),this.clipboardManager.save(p()({},y.a.HTML,{type:e,data:r,outputOptions:{useAsync:this.storeManager.useBase64Copy}}))}},{key:"handleSlideCopyData",value:function(e){var t;if(this.storeManager.uiDataService){var n=this.storeManager.getSelectedArray(),r=wt.getCopiedNoteSdkData(n);e.noteList=r;var a=wt.getNeedCopiedMasterList(n,null===(t=this.storeManager.uiDataService.presentation)||void 0===t?void 0:t.masterList),i={layoutList:wt.getCopiedLayoutSdkData,masterList:wt.getCopiedMasterSdkData,themeList:wt.getCopiedThemeSdkData};Object.keys(i).forEach((function(t){e[t]=i[t](a)}))}}},{key:"copyPlaceholderDataToText",value:function(){}},{key:"copyInEditing",value:function(){var e=this.storeManager.selectedElements,t=a()(e,1)[0],n=this.getSelectedElementModel(t);if(null!=n&&n.editorInstance){var r,i,o=this.isCut?null===(r=n.editorInstance)||void 0===r?void 0:r.cut():null===(i=n.editorInstance)||void 0===i?void 0:i.copy();if(o){var l=this.storeManager.getTextSelectedAreaCopyData(o,n);this.copyDataToHTML(m.a.CUSTOM_INHERIT_AND_NO_INHERIT,l),this.copyDataToText(g.a.ELEMENT_INHERIT_AND_NO_INHERIT,l)}this.resetCutStatus()}else{var s,c;window.log.info("text editing editorInstance is null info: isEditing:".concat(null===(s=this.getEditorInstanceService())||void 0===s?void 0:s.checkEditorIsEditing(),"sdkDataType:").concat(null==t||null===(c=t.sdkData)||void 0===c?void 0:c.type))}}},{key:"getSelectedElementModel",value:function(e){var t=e.sdkData.type,n=Ne.a.Shape,r=Ne.a.GraphicalObjectFrameChart,i=Ne.a.GraphicalObjectFrameTable;if(t===n||t===r)return e;if(t===i&&e.selectedCellRanges.length){var o=a()(e.selectedCellRanges,1)[0];return e.props.items[o.rowStart][o.colStart]}}},{key:"copySlides",value:function(){this.copyDataToHTML(m.a.SLIDE),this.copyPlaceholderDataToText(),this.copySlideDataToImage()}},{key:"isExpandEditing",value:function(e){var t,n,r;return this.storeManager.isEditorRegion&&!this.storeManager.activePointInShape&&(null==e||null===(t=e.editorInstance)||void 0===t||null===(n=t.isExpanded)||void 0===n?void 0:n.call(t))&&!(null!=e&&null!==(r=e.editorInstance)&&void 0!==r&&r.isEditing)}},{key:"isSelectContentCopy",value:function(){var e=this.storeManager.selectedElements;if(1!==(null==e?void 0:e.length))return!1;var t=null,n=e,r=a()(n,1)[0],i=r.selectedCellRanges,o=r.props,l=r.sdkData.type;if(l===Ne.a.Shape)t=r;else if(l===Ne.a.GraphicalObjectFrameTable&&i.length){var s=a()(i,1)[0];t=o.items[s.rowStart][s.colStart]}return this.isExpandEditing(t)}},{key:"onDrop",value:(h=o()(v.a.mark((function e(t){var n,r,i,l,s,c,u,d=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((i=this.getUserPriviledgeService())&&i.pptEditorState>Ye.b.EDITABLE)){e.next=4;break}return null===(l=this.services)||void 0===l||null===(s=l.tipsManager)||void 0===s||s.showCannotEditTips(),e.abrupt("return");case 4:if(!Me.b.supportEnterprise(Me.a.ALL)){e.next=6;break}return e.abrupt("return");case 6:return c=X.c.getEventType(t),e.next=9,null===(n=this.services)||void 0===n||null===(r=n.importFilePipelineManager)||void 0===r?void 0:r.promise();case 9:if(u=e.sent,!(c===X.a.DragEvent||this.isSafariLower15&&c===X.a.MouseEvent)){e.next=13;break}return[function(){return{dragList:d.getDragImgList(t),callback:function(e){var t;null!==(t=d.services)&&void 0!==t&&t.toolbarStateManager&&(d.services.toolbarStateManager.lastInsertButtonClick=3);var n=Ue.a.getInstance(),r=d.savedDropModel;r?(d.savedDropModel=null,Ue.a.getInstance().imageReplaceAction=2,n.bulkReplaceBlobImages(e,r)):n.bulkInsertBlobImages(e),Object(F.c)({opername:B.e.DOC_PPT,module:B.d.PC_EDIT_INSERT,action:B.b.PASTEP_IMG})}}},function(){return{dragList:Object(he.b)(t),callback:(e=o()(v.a.mark((function e(t){var n,r,i,o,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=u&&u.isFree()){e.next=2;break}return e.abrupt("return");case 2:if(1===t.length){e.next=4;break}return e.abrupt("return");case 4:if(We.g){e.next=6;break}return e.abrupt("return");case 6:if(i=a()(t,1),o=i[0],Object(Je.b)(o)){e.next=10;break}return k.a.show({message:E.a.t("仅支持.ppt或者.pptx格式，请重新选择"),duration:3e3}),e.abrupt("return");case 10:if(!Object(Ke.h)()){e.next=13;break}return d.insertPageImport(t),e.abrupt("return");case 13:return e.next=15,null===(n=d.services)||void 0===n||null===(r=n.importFileSelectManager)||void 0===r?void 0:r.promise();case 15:null==(l=e.sent)||l.updateData({type:"slide",importFunction:{newPageImport:function(){return d.newPageImport(t)},insertPageImport:function(){return d.insertPageImport(t)}}}).setVisible(!0);case 17:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})};var e}].find((function(e){var t=e();return!!t.dragList.length&&(t.callback(t.dragList),!0)})),e.abrupt("return");case 13:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"newPageImport",value:(f=o()(v.a.mark((function e(t){var n,r,a,i,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.services)||void 0===n||null===(r=n.importFileSelectManager)||void 0===r?void 0:r.promise();case 2:null==(o=e.sent)||o.setVisible(!1),Object(F.c)({opername:B.e.DOC_PPT,module:B.d.DRAG_FILE,action:B.b.DRAG_FILE_INSERT}),null===(a=this.services)||void 0===a||null===(i=a.importNewFileManager)||void 0===i||i.handleImportFile(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"pasteByEvent",value:(d=o()(v.a.mark((function e(t){var n,r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shouldResponsePaste(t)){e.next=2;break}return e.abrupt("return");case 2:t.preventDefault(),t.stopPropagation(),null===(n=this.services)||void 0===n||null===(r=n.menuManager)||void 0===r||r.hideAllMenu(),a=X.c.getEventType(t),[X.a.ClipboardEvent,X.a.DragEvent].includes(a)&&this.doClipboardPaste(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getClipboardBaseData",value:(c=o()(v.a.mark((function e(t){var n,r,a,i,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clipboardManager.read(t);case 2:return n=e.sent,r=n[y.a.TEXT]||"",a=n[y.a.HTML]||{},i=a.html,o=a.privateData,e.abrupt("return",{textHtml:i,textPlain:r,privateDataString:o});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getImagesFromFileList",value:(l=o()(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clipboardManager.readFile(t);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return n=e.t0,r=[y.a.IMAGE_PNG,y.a.IMAGE_JPEG,y.a.IMAGE_GIF,y.a.IMAGE_BMP,y.a.IMAGE_SVG_XML],e.abrupt("return",n.filter((function(e){return r.includes(e.type)})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"pasteByAction",value:(i=o()(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shouldResponsePaste()){e.next=2;break}return e.abrupt("return");case 2:null===(t=this.services)||void 0===t||null===(n=t.menuManager)||void 0===n||n.hideAllMenu(),this.doClipboardPaste();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"replaceImageToShapeBackground",value:function(e,t,n){Ue.a.getInstance().clipDataWaiting=!1,this.replaceImageToShapeBackgroundWithPrivateData(n)||this.replaceImageToShapeBackgroundWithPublicData(e,t)}},{key:"replaceImageToShapeBackgroundWithPrivateData",value:function(e){var t,n,r,a=null==e?void 0:e.data.find(this.isPicFromSdkData);vt.c&&(a=null===(t=a)||void 0===t?void 0:t.inheritedSdkData);return!(1!==(null==e?void 0:e.data.length)||!a)&&(Object(xe.e)([{src:a.blipFill.blip.embed,width:Object(ve.v)(a.spPr.xfrm.ext.cx)||150,height:Object(ve.v)(a.spPr.xfrm.ext.cy)||150}],null===(n=this.services)||void 0===n||null===(r=n.selectionService)||void 0===r?void 0:r.getSelectedModel()),!0)}},{key:"replaceImageToShapeBackgroundWithPublicData",value:function(e,t){var n,r,a,i=this,o=e;null!==(n=o)&&void 0!==n&&n.length||(o=null===(a=(ce.getSingleton().parseHTML(t)||{}).images)||void 0===a?void 0:a.map((function(e){var t=e.url;return i.clipboardManager.imagePreparePlugin.getImageBlob(t)})));null!==(r=o)&&void 0!==r&&r.length?3===Ue.a.getInstance().imageReplaceAction?Ue.a.getInstance().uploadWithoutQuickLook(o,E.a.t("正在填充图片...")).then((function(e){var t,n;Object(xe.e)(e,null===(t=i.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.getSelectedModel())})):Ue.a.getInstance().bulkReplaceBlobImages(o):k.a.show({message:E.a.t("请复制图片到剪贴板，进行替换"),duration:3e3})}},{key:"focusCachedActiveElement",value:function(){}},{key:"doClipboardPaste",value:(r=o()(v.a.mark((function e(t){var n,r,a,i,o,l,s,c,u,d,p,f,h,g=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getClipboardBaseData(t);case 2:return n=e.sent,r=n.textHtml,a=n.textPlain,i=n.privateDataString,this.focusCachedActiveElement(),e.next=9,this.getPrivateData(i);case 9:return o=e.sent,e.next=12,this.getImagesFromFileList(t);case 12:if(l=e.sent,!Ue.a.getInstance().clipDataWaiting){e.next=16;break}return this.replaceImageToShapeBackground(l,r,o),e.abrupt("return");case 16:if(s=this.getImagesFromPrivateData(o),!this.shouldImgReplacePlaceHolder(null!=l&&l.length?l:s,r)){e.next=20;break}return null!=l&&l.length?(null===(c=window.log)||void 0===c||c.info("paste image file list replace placeholder"),this.imageEditManager.createEditorImages(null!=l?l:[]).then((function(e){var t,n;null===(t=g.services)||void 0===t||null===(n=t.imageUploadService)||void 0===n||n.promise().then((function(t){t.handleImageChange(e).then((function(){}))}))}))):s.length&&(null===(u=window.log)||void 0===u||u.info("paste private data image replace placeholder: ".concat(s)),null===(d=this.services)||void 0===d||null===(p=d.imageUploadService)||void 0===p||p.promise().then((function(e){e.handleImageChange(s).then((function(){}))}))),e.abrupt("return");case 20:f=this.isSingleTable(null==o?void 0:o.data),h=this.storeManager.isNoteRegion&&f,o&&!h?this.pasteFromPrivateData(this.resolvePrivateData(o)):this.pasteFromPublicData(r,l,a);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"resolvePrivateData",value:function(e){if(e.sdkVersion===ct.b.Version3){var t=a()(e.data,1)[0],n=t.sdkDataWithoutInherit,r=t.sdkDataWithInherit;return n||r?Lt(Lt({},e),{},{data:[{inheritedSdkData:n,ownSdkData:r}]}):e}return e.type===de.a.textBodyModel?this.migratePrivateTextData(e):this.migratePrivateModelData(e)}},{key:"migratePrivateTextData",value:function(e){var t=new Ct.a,n=a()(e.data,1)[0],r=n.sdkDataWithoutInherit,i=n.sdkDataWithInherit,o=t.migrateShape(i),l=o.nvPr,s=o.spPr,c=o.txBody,u=t.migrateShape(r),d={nvPr:u.nvPr,spPr:u.spPr,txBody:u.txBody},p={nvPr:l,spPr:s,txBody:c};return Lt(Lt({},e),{},{data:[{inheritedSdkData:d,ownSdkData:p}]})}},{key:"migratePrivateModelData",value:function(e){if(e.data.some((function(e){return!Nt.includes(e.type)})))return this.DataVersionUnMatchTip(),Lt(Lt({},e),{},{data:[],resourceMap:{audios:{},fonts:{},images:{},videos:{}}});var t=new Ct.a;t.ctx.presentation={resource:{imageResource:{resourceMap:{}}}};var n=[],r=[];e.data.forEach((function(e){if(e.type!==bt.SLIDE)if(e.type!==bt.LAYOUT)if(e.type!==bt.SECTION){var a=t.migrateElement(e);n.push({ownSdkData:a,inheritedSdkData:st()(a)})}else{var i={name:e.name,type:Ne.a.Section};n.push({ownSdkData:i,inheritedSdkData:st()(i)})}else{var o=t.migratePage(e,Ne.a.SlideLayout);n.push({ownSdkData:o,inheritedSdkData:st()(o)})}else{var l=t.migratePage(e,Ne.a.Slide);n.push({ownSdkData:l,inheritedSdkData:st()(l)});var s=t.migrateNoteSlide(e);s&&r.push({ownSdkData:s,inheritedSdkData:st()(s)})}})),t.updateConnectionsId();var a=t.ctx.presentation.resource.imageResource.resourceMap;return Lt(Lt({},e),{},{data:n,noteList:r,resourceMap:{audios:{},fonts:{},images:Lt({},a),videos:{}}})}},{key:"getPrivateData",value:(t=o()(v.a.mark((function e(t){var n,r,a,i,o,l,s,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=[],n=JSON.parse(t,(function(e,t){if("string"==typeof t){if("NaN"===t)return NaN;if("Infinity"===t)return 1/0;if("-Infinity"===t)return-1/0}return t})),null!==(r=this.copyPasteInjectable)&&void 0!==r&&null!==(a=r.useSrcImg)&&void 0!==a&&a.call(r,n.sdkVersion)?(l=new Map,null!==(o=n.resourceMap)&&void 0!==o&&o.images&&Object.values(n.resourceMap.images).forEach((function(e){l.set(e.id,e.src)})),(n=this.parseAndChangeResource(t,i,l)).resourceMap.images={}):n=this.parseAndChangeResource(t,i),e.t0=Ue.a.getInstance(),e.next=7,Promise.all(i);case 7:e.t1=e.sent,e.t0.uploadAndUpdateImages.call(e.t0,e.t1),e.next=14;break;case 11:e.prev=11,e.t2=e.catch(0),null===(s=window.log)||void 0===s||null===(c=s.warn)||void 0===c||c.call(s,"[CopyPaste] clipboard does not have private data");case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e){return t.apply(this,arguments)})},{key:"parseAndChangeResource",value:function(e,t,n){var r=this;return JSON.parse(e,(function(e,a){var i,o;if(!ze.a.includes(e))return a;var l=Ve.a.getInstance(),s=l.createResourceId(a);if(Xe.a.isBase64Url(a))return t.push(l.addImageWithBase64Url(a,s)),s;var c=null!==(i=null==n?void 0:n.get(a))&&void 0!==i?i:a;return null!==(o=r.copyPasteInjectable)&&void 0!==o&&o.shouldDownloadToLocal&&(null!=c&&c.startsWith("http")||null!=c&&c.startsWith("tdoc"))?(t.push(l.addImageWithCDNUrl(c,s)),s):a}))}},{key:"uploadImageFromFileList",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(null!=e&&e.length){null!==(t=this.services)&&void 0!==t&&t.toolbarStateManager&&(this.services.toolbarStateManager.lastInsertButtonClick=3);var r=e.slice(-n.length);Ue.a.getInstance().bulkInsertBlobImages(r),Object(F.c)({opername:B.e.DOC_PPT,module:B.d.PC_EDIT_INSERT,action:B.b.PASTEP_IMG})}}},{key:"pasteFromHTMLWithSingleEleInEditor",value:function(e,t,n,r){var a=t.textSdkData,i=t.tableList,o=t.images;if(this.elementIsTableAndFocus(e)){if(null!=i&&i.length&&e.paste(i[0]))return;a&&(this.pasteToTable(e,a,a),this.storeManager.activePointInShape&&vt.c&&dt.a.emit(pt.a.TEXT_PASTE_PANEL,{data:[{ownSdkData:a,inheritedSdkData:a}]}))}else!Object(It.B)(e)||null!=i&&i.length||null!=o&&o.length?this.elementIsChartAndFocus(e)&&a?this.pasteToChart(e,a):r():a?(this.pasteToShape(e,a),this.storeManager.activePointInShape&&vt.c&&dt.a.emit(pt.a.TEXT_PASTE_PANEL,{data:[{ownSdkData:a,inheritedSdkData:a}]})):n()}},{key:"pasteFromPublicData",value:function(e,t,n){var r=this;if(null!=e&&e.length||null!=t&&t.length){this.handlerPublicTextHtml(e,t,(function(){return r.handlerPublicTextPlain(n)}))}else null!=n&&n.length&&this.handlerPublicTextPlain(n)}},{key:"handlerPublicTextHtml",value:function(e,t,n){var r=this,a=ce.getSingleton().parseHTML(e)||{},i=a.dataList,o=a.tableList,l=a.images,s=this.storeManager.selectedElements,c=function(){var e,n=null==i?void 0:i[0];if(_e(n),function(e){if(null!=e&&e.length){var t,n=null===(t=Re.getCurrentSlideModel)||void 0===t?void 0:t.call(Re);e.forEach((function(e){var t,r;null==n||null===(t=n.sdkData)||void 0===t||null===(r=t.api)||void 0===r||r.addShapes([e]),X.c.selectLastAddElement(1)}))}}(o),Object(xe.d)(null===(e=r.getSelectionService())||void 0===e?void 0:e.currentSlide,l),!(n||null!=o&&o.length||null!=l&&l.length)&&r.uploadImageFromFileList(t,l),n&&(null==o||!o.length)&&(null==l||!l.length)&&vt.c){var a,s,c=null===(a=r.services)||void 0===a||null===(s=a.selectionService)||void 0===s?void 0:s.selectedElements.getCurrentModel().editorInstance;null==c||c.setFocus((function(){dt.a.emit(pt.a.TEXT_PASTE_PANEL,{data:[{ownSdkData:n,inheritedSdkData:n}]})}))}},u=function(){n()||r.uploadImageFromFileList(t,l)};if(this.storeManager.isNoteRegion){var d,p,f,v=null===(d=this.getSelectionService())||void 0===d||null===(p=d.currentSlide)||void 0===p||null===(f=p.noteData)||void 0===f?void 0:f.noteTextBody;null!=i&&i.length?this.useElementPaste(v,i[0]):u()}else this.isSingleEleAndFocusInEditor(s)?this.pasteFromHTMLWithSingleEleInEditor(s[0],{textSdkData:null==i?void 0:i[0],tableList:o,images:l},u,c):null!=i&&i.length||null!=o&&o.length||null!=l&&l.length?c():this.uploadImageFromFileList(t,l)}},{key:"handlerPublicTextPlain",value:function(e){return!(null==e||!e.length)&&(this.storeManager.isEditorRegion?this.handlerPublicTextPlainToShape(e):this.storeManager.isNoteRegion?this.handlerPublicTextPlainToNote(e):Be(e),!0)}},{key:"handlerPublicTextPlainToNote",value:function(e){var t,n,r,a=Fe(e),i=null===(t=this.getSelectionService())||void 0===t||null===(n=t.currentSlide)||void 0===n||null===(r=n.noteData)||void 0===r?void 0:r.noteTextBody;this.useElementPaste(i,a,!1)}},{key:"handlerPublicTextPlainToShape",value:function(e){var t=this.storeManager.selectedElements;if(this.isSingleEleAndFocusInEditor(t)){var n=t,r=a()(n,1)[0],i=Fe(e);if(this.elementIsShapeAndFocus(r))return void this.useElementPaste(r,i,!1);if(this.elementIsTableAndFocus(r))return void this.pasteToTable(r,i,i,!1)}Be(e)}},{key:"pasteToShape",value:function(e,t){if(this.storeManager.activePointInShape)this.useElementPaste(e,t);else{var n=this.convertSdkDataToUiDataWithInheritLogic(t,e);e.updateParagraphList(n.paragraphList)}}},{key:"pasteToChart",value:function(e,t){this.storeManager.activePointInShape&&this.useElementPaste(e,t)}},{key:"elementIsTableAndFocus",value:function(e){return Object(It.D)(e)&&(this.storeManager.activePointInShape||e.showSelection)}},{key:"elementIsChartAndFocus",value:function(e){return e.type===$e.d.CHART&&this.storeManager.activePointInShape}},{key:"elementIsShapeAndFocus",value:function(e){return e.type===$e.d.SHAPE&&this.storeManager.activePointInShape}},{key:"isSingleEleAndFocusInEditor",value:function(e){return 1===(null==e?void 0:e.length)&&this.storeManager.isEditorRegion&&!this.isIframeElementFromSdkData(e[0].sdkData)}},{key:"hasPlaceHolderEleAcceptPic",value:function(e){var t;return null==e||null===(t=e.some)||void 0===t?void 0:t.call(e,(function(e){var t,n;return e.isPlaceholder&&!e.isCustomPlaceholder&&((null===(t=e.placeHolder)||void 0===t?void 0:t.type)===xt.a.PIC||void 0===(null===(n=e.placeHolder)||void 0===n?void 0:n.type))}))}},{key:"shouldImgReplacePlaceHolder",value:function(e,t){var n,r=ce.getSingleton().parseHTML(t)||{},a=r.dataList,i=r.tableList,o=!(null!=a&&a.length||null!=i&&i.length),l=this.storeManager.selectedElements;return o&&(null==e?void 0:e.length)&&(null===(n=this.services)||void 0===n?void 0:n.imageUploadService)&&this.hasPlaceHolderEleAcceptPic(l)}},{key:"getImagesFromPrivateData",value:function(e){var t=[],n=(e||{}).data;return Array.isArray(n)&&n.forEach((function(e){var n,r,a,i,o,l=(e||{}).inheritedSdkData;if((null==l?void 0:l.type)===Ne.a.Picture)a=null==l||null===(i=l.blipFill)||void 0===i||null===(o=i.blip)||void 0===o?void 0:o.embed;else if((null==l?void 0:l.type)===Ne.a.Shape){var s,c,u;a=null==l||null===(s=l.spPr)||void 0===s||null===(c=s.blipFill)||void 0===c||null===(u=c.blip)||void 0===u?void 0:u.embed}var d=(null==l||null===(n=l.spPr)||void 0===n||null===(r=n.xfrm)||void 0===r?void 0:r.ext)||{},p=d.cx,f=d.cy;a&&t.push({src:a,imageType:null==l?void 0:l.imageType,prstGeom:{prstGeomType:"rect"},imageName:"",width:Object(ve.s)(p),height:Object(ve.s)(f)})})),t}},{key:"pasteFromPrivateData",value:function(e){if(!(e.sdkVersion===ct.b.Version2&&e.data.length<=0))if(e.type===de.a.sdkModel)this.pasteSdkModel(e);else if(e.type===de.a.textBodyModel){var t,n,r=a()(e.data,1)[0],i=r.ownSdkData,o=r.inheritedSdkData,l=this.storeManager.selectedElements;if(this.isSingleEleAndFocusInEditor(l)){var s=l,c=a()(s,1)[0];return c.type===$e.d.SHAPE?(this.pasteToShape(c,i),void(this.storeManager.activePointInShape&&vt.c&&dt.a.emit(pt.a.TEXT_PASTE_PANEL,e))):this.elementIsChartAndFocus(c)?void this.pasteToChart(c,i):this.elementIsTableAndFocus(c)?(this.pasteToTable(c,o,i),void(this.storeManager.activePointInShape&&vt.c&&dt.a.emit(pt.a.TEXT_PASTE_PANEL,e))):void 0}if(this.storeManager.isNoteRegion){var u,d,p,f=null===(u=this.getSelectionService())||void 0===u||null===(d=u.currentSlide)||void 0===d||null===(p=d.noteData)||void 0===p?void 0:p.noteTextBody;return void this.useElementPaste(f,i)}_e(i);var v=null===(t=this.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.selectedElements.getCurrentModel().editorInstance;null==v||v.setFocus((function(){dt.a.emit(pt.a.TEXT_PASTE_PANEL,e)}))}}},{key:"useElementPaste",value:function(e,t){var n,r,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.convertSdkDataToUiDataWithInheritLogic(t,e);null==e||null===(n=e.editorInstance)||void 0===n||null===(r=n.paste)||void 0===r||r.call(n,i,a)}},{key:"convertSdkDataToUiDataWithInheritLogic",value:function(e,t){var n,r={},a=st()(e),i=e;if(null!==(n=i)&&void 0!==n&&n.txBody&&t.slideRef){var o,l,s,c,u=(null===(o=t.sdkData)||void 0===o?void 0:o.type)!==Ne.a.GroupShape&&(null===(l=t.sdkData)||void 0===l||null===(s=l.props)||void 0===s||null===(c=s.nvPr)||void 0===c?void 0:c.ph);u&&(i.nvPr=i.nvPr||{},i.nvPr.ph=u),i=Le.a.appendSdkDataInheritProp(i,t.slideRef)}return t.type===$e.d.CHART?Tt.a.convertDataSdkToUi(i,r,void 0):Object.getPrototypeOf(t).constructor.convertDataSdkToUi(i,r,t.sdkData),St.a.sdkToUiSignRawTextProps(a.txBody,r),r}},{key:"pasteToTable",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this.storeManager.activePointInShape&&e.selectedCellRanges.length){var a=e.getEditingCellModel();this.useElementPaste(a,n,r)}else e.paste(Lt(Lt({},t),{},{type:Ne.a.Shape}))}},{key:"isPasteInTable",value:function(e){return this.isSingleTable(e)&&this.elementIsTableAndFocus(e[0])&&this.storeManager.isEditorRegion}},{key:"isHasSmartArData",value:function(e){var t=Ne.a.GraphicalObjectFrameSmartArt,n=e.data;if(!Array.isArray(n))return!1;var r,a=Mt(n);try{for(a.s();!(r=a.n()).done;){var i,o,l,s=r.value;if(null!=s&&s.ownSdkData&&s.ownSdkData.type===t)return!0;if(null!=s&&null!==(i=s.ownSdkData)&&void 0!==i&&null!==(o=i.cSld)&&void 0!==o&&null!==(l=o.spTree)&&void 0!==l&&l.shapeList){var c,u=Mt(s.ownSdkData.cSld.spTree.shapeList);try{for(u.s();!(c=u.n()).done;){if(c.value.type===t)return!0}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){a.e(e)}finally{a.f()}return!1}},{key:"pasteSdkModel",value:function(e){var t=this.storeManager.selectedElements;if(Object(Ee.getQuery)("local_edit")&&C.a.isTencentDocDesktopApp&&this.isHasSmartArData(e))k.a.show({message:E.a.t("smartArt暂不支持复制,请转化成组合"),type:"info",autoClose:!0});else if(this.isPasteInTable(t)){var n=t,r=a()(n,1)[0],i=a()(e.data,1)[0].inheritedSdkData;X.c.extractTblRangeData(i),r.paste(i)||this.tableCannotPasteTip()}else{var o=e;this.pasteSdkHandler.pasteSdkDataOmitTable(o)}}},{key:"forceConvertSlides",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(null===(e=this.getUiDataService())||void 0===e||null===(t=e.presentation)||void 0===t?void 0:t.children)||[];return Promise.all(n.map(function(){var e=o()(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!t.childrenConverted,!e.t0){e.next=4;break}return e.next=4,t.startConvertChildrenTask(ue.a.HIGH);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},{key:"isSingleTable",value:function(e){if(1!==(null==e?void 0:e.length))return!1;var t,n,r,a,i=Ne.a.GraphicalObjectFrameTable;vt.c?t=(null===(n=e[0].sdkData)||void 0===n?void 0:n.type)||(null===(r=e[0].ownSdkData)||void 0===r?void 0:r.type):t=(null===(a=e[0].sdkData)||void 0===a?void 0:a.type)||e[0].type;return t===i}},{key:"isPicFromSdkData",value:function(e){var t,n,r=vt.c?e.inheritedSdkData:e;return(null==r?void 0:r.type)===Ne.a.Picture&&(null==r||null===(t=r.blipFill)||void 0===t||null===(n=t.blip)||void 0===n?void 0:n.embed)}},{key:"isIframeElementFromSdkData",value:function(e){var t,n;return e.type===bt.SHAPE&&"iframe"===(null===(t=e.props)||void 0===t||null===(n=t.addon)||void 0===n?void 0:n.displayMode)}},{key:"isMedia",value:function(e){return e.audio||e.video}},{key:"DataVersionUnMatchTip",value:function(){this.snackbarOp&&this.snackbarOp.close(),this.snackbarOp=k.a.show({message:E.a.t("很抱歉，复制的数据不支持粘贴"),duration:3e3,autoClose:!0})}},{key:"getDragImgList",value:function(e){var t=this;return Object(he.a)(e,(function(e){return Array.from(e).filter((function(e){return t.isSupportImageType4ParseCopyImgs(e.type)}))}))}},{key:"judgeSafariVersion",value:function(){if(b.default.isSafari){var e,t=null===(e=navigator.userAgent)||void 0===e?void 0:e.match(/Version\/([\d.]+)/);if(t&&parseFloat(t[1])<15)return!0}return!1}},{key:"isSupportImageType4ParseCopyImgs",value:function(e){return["image/png","image/jpeg","image/gif","image/bmp","image/svg+xml","image/tiff","image/tif"].includes(e)}},{key:"getUiDataService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.uiDataService}},{key:"getSelectionService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.selectionService}},{key:"getPlayManager",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.playManager}},{key:"getUserPriviledgeService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.userPriviledgeService}},{key:"getEditorInstanceService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.editorInstanceService}}]),e}()},e0a005a7aa:function(e,t,n){"use strict";n.d(t,"g",(function(){return I})),n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return O})),n.d(t,"h",(function(){return A})),n.d(t,"e",(function(){return L})),n.d(t,"f",(function(){return N})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return R}));n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var r=n("176815363d"),a=n.n(r),i=n("85d0a7609b"),o=n.n(i),l=n("3ef2352f0b"),s=n.n(l),c=(n("8ee19818c4"),n("8e7cce0ada"),n("c6244f7705"),n("2a6f332b5e"),n("081c8cafea"),n("3bf1976a4f"),n("8a35b54c1d"),n("8aebbf296a"),n("85d48ef22b"),n("780d9b3b59")),u=n("5fac0349d3"),d=n("d9812f1c6f"),p=n("e0e8dd9366"),f=n("145eddafd2"),v=n("0d1cecd3de"),h=n("3cc783627f"),g=n("3316f89d08"),m=n("40008f7811"),b=n("5c2b595cb5"),y=n("ea3a38d9d4"),S=n("382929c8da"),k=n("2ba7871556"),P=n("14c02e2331"),w=n("132ceeffea"),C=n("9657b29818"),E=n("767dcfbe00");function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=void 0,I=function(e){T||(T=e)},M=function(e,t){if(e&&0!==e.length){for(var n=[],r=0;r<e.length;r++){var a=e[r];A(a,r,null==t?void 0:t.presentationRef),n.push(p.d.IMAGE)}t&&t.addElement(n,e)}},O=function(e,t){t&&t.addElement([p.d.IMAGE],[e])},A=function(e,t,n){var r=n.props,a=r.slideWidth,i=r.slideHeight,o=Object(w.c)(e,{slideWidth:a,slideHeight:i}),l=o.nextWidth,s=o.nextHeight,c=(a-l)/2+10*t,u=(i-s)/2+10*t;e.style={position:"absolute",left:c,top:u,width:l,height:s,opacity:1,bgShape:f.b.rect},e.prstGeom={prstGeomType:f.b.rect}},L=function(e,t){var n=b.a.getInstance().imageReplaceAction;return b.a.getInstance().imageReplaceAction=0,t.type===p.d.MULTIPLY?(Object(C.b)((function(){var r;null===(r=t.selectedModels)||void 0===r||r.forEach((function(t){if(t.type!==p.d.GROUP){var r=n;n===E.a.multi&&(r=t.type===p.d.IMAGE?E.a.foreground:E.a.background),N(e,t,r)}}))})),!0):N(e,t,n)},N=function(e,t,n){var r;if((n=null!==(r=n)&&void 0!==r?r:b.a.getInstance().imageReplaceAction)===E.a.foreground&&t.type===p.d.IMAGE)return Object(C.b)((function(){var n;null===(n=t.deleteDescription)||void 0===n||n.call(t),t.handleReplacePicture(e)})),!0;if(n===E.a.background&&t.type!==p.d.CONNECTOR&&e.length>0&&e[0].src){var a,i={};i.src=e[0].src;var l=null===(a=t.getBackgroundFill)||void 0===a?void 0:a.call(t).getFillInfo();return null!=l&&l.image?(l.image.stretch&&(i.stretch=D({},l.image.stretch)),Object(C.b)((function(){var e,n,r;null===(e=t.deleteDescription)||void 0===e||e.call(t),null===(n=t.getImageFillEffect)||void 0===n||null===(r=n.call(t))||void 0===r||r.handleResetPicture(),t.getBackgroundFill().updateCurrentFill({image:i})}))):Object(C.b)((function(){var e;null===(e=t.deleteDescription)||void 0===e||e.call(t),t.getBackgroundFill().updateCurrentFill({image:i})})),!0}if(n===E.a.text){if(e.length>0&&e[0].src&&T){var s,c,u=T.toolbarMenu(),d=u.values,f=u.callback,v=null==d||null===(s=d[P.o])||void 0===s?void 0:s[k.b.ImageFill],h=(c={},o()(c,k.b.NoFill,k.b.NoFill),o()(c,k.b.SolidFill,"color"),o()(c,k.b.GradualFill,k.b.GradualFill),o()(c,k.b.ImageFill,k.b.ImageFill),o()(c,k.b.PattFill,k.b.PattFill),c),g=o()({},h[k.b.ImageFill],D(D({},v),{},{src:e[0].src}));f(y.a.TOOLBAR,S.a.FONT_FILL,g)}return!0}},j=function(e){var t=arguments.length>2?arguments[2]:void 0;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(n,r){var i=n.url;i.length>5&&"https"!==i.substring(0,5)&&"http"===i.substring(0,4)&&(i="https".concat(i.substring(4)));var o="attachment-".concat(new Date,"-").concat(Object(h.l)()),l=function(e,t,n,r){return function(){var i=a()(s.a.mark((function a(i,o,l,c,u){var d,p;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i){a.next=2;break}return a.abrupt("return");case 2:if(d={height:u,width:c,src:o,imageName:i},c||u){a.next=9;break}return a.next=6,m.a.extractUrl(o);case 6:p=a.sent,d.width=p.width,d.height=p.height;case 9:e.addon&&(d.addon=e.addon),r?r([d]):(A(d,t,n.presentationRef),O(d,n));case 11:case"end":return a.stop()}}),a)})));return function(e,t,n,r,a){return i.apply(this,arguments)}}()}(n,r,e,t),p=function(){var e={message:d.a.isMac?u.a.t("图片粘贴不成功。试试单独复制原图用Cmd+V粘贴，或将原图保存到电脑后点击“插入图片”。"):u.a.t("图片粘贴不成功。试试单独复制原图用Ctrl+V粘贴，或将原图保存到电脑后点击“插入图片”。"),commonTipsType:c.b.INFO,block:!1,closable:!0};c.c.getInstance().show(e)};Object(g.c)(i,o,l,p)}))},R=function(e){return Object(v.a)(e,(function(e){return Array.from(e).filter((function(e){return t=e.type,n=!1,"image/png"!==t&&"image/jpeg"!==t&&"image/gif"!==t&&"image/bmp"!==t&&"image/svg+xml"!==t&&"image/tiff"!==t&&"image/tif"!==t||(n=!0),n;var t,n}))}))}},f1242c9f64:function(e,t,n){"use strict";n.r(t),n.d(t,"ImageEditManager",(function(){return r.a})),n.d(t,"setMenuManagerDelegate",(function(){return a.g})),n.d(t,"addImagesInSlide",(function(){return a.b})),n.d(t,"addImageInSlide",(function(){return a.a})),n.d(t,"updateImageStyleInfo",(function(){return a.h})),n.d(t,"replaceImage",(function(){return a.e})),n.d(t,"replaceSingleImage",(function(){return a.f})),n.d(t,"pasteImageData",(function(){return a.d})),n.d(t,"getDragImgList",(function(){return a.c})),n.d(t,"dragBaseLogic",(function(){return i.a})),n.d(t,"preventDefaultIfTypeIsFile",(function(){return i.c})),n.d(t,"getDragPPTList",(function(){return i.b})),n.d(t,"domtoimage",(function(){return G}));var r=n("5c2b595cb5"),a=n("e0a005a7aa"),i=n("0d1cecd3de"),o=n("176815363d"),l=n.n(o),s=n("14502724a6"),c=n.n(s),u=n("3ef2352f0b"),d=n.n(u),p=(n("c6244f7705"),n("081c8cafea"),n("1bab7b5fb7"),n("0aeae65bf4"),n("9d7978d445"),n("8a35b54c1d"),n("8ee19818c4"),n("342844cefa"),n("3bf1976a4f"),n("759492dad9"),n("6e20b6a7d8"),n("b1e2246d82"),n("b8217400dc"),n("e6f68cdf2e"),n("34cd92f77a"),n("2504ad7290"),n("8e7cce0ada"),n("211c9e7008"),n("30078d1bba"),n("9e613e2f57"),n("0ad0839104"),n("87e9aa2426"),n("297a259b22"),n("347f4c5e26"),n("64bb56d585"),n("afeeb24b8e"),n("56ffd0610f"),n("7513a1cdfa"),n("f39debe0f1"),n("044475b26b"),n("e91e206977"),n("aaa7d96b4d"),n("743c905172"),n("240894da07"),n("8d6a7965e9"),n("b3b54ec99d"),n("65981e8631"),n("470d084e5c"),n("09b17a1f21"),n("15086d4e19"),n("474b85968b"),n("963f2eaace"),n("bd80bf2d0f"),n("4bbb5840d5"),n("7eaa8e90a5"),n("433247001a"),n("85d48ef22b"),n("2a6f332b5e"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287"),n("d9812f1c6f"));function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=function(){return{correctDataUriSvg:function(e){var t=null==e?void 0:e.src,n=t;if("string"==typeof n&&n.includes("data:image/svg+xml")&&!n.includes("data:image/svg+xml;base64"))try{n=decodeURIComponent(n),n=(n=decodeURIComponent(n)).replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/{/g,"%7B").replace(/}/g,"%7D").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," "),e.src=encodeURI(n)}catch(n){e.src=t}},escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:t,mimeType:function(e){var n=t(e).toLowerCase();""===n&&(n=function(e,t){var n=e.split("?");if(n.length>1){for(var r,a=n[1].split("&"),i=0;i<a.length;i++)if(null!=(r=a[i].split("="))&&r[0]===t)return r[1];return""}return""}(e,"_type").toLowerCase());return(r="application/font-woff",a="image/jpeg",{woff:r,woff2:r,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:a,jpeg:a,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[n]||"";var r,a},dataAsUrl:function(e,t){return"data:".concat(t,";base64,").concat(e)},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},isDataSvgUrl:function(e){return-1!==e.search(/^(data:image\/svg\+xml)/)},canvasToBlob:function(e){if(e.toBlob)return new Promise((function(t){e.toBlob(t)}));return function(e){return new Promise((function(t){for(var n=window.atob(e.toDataURL().split(",")[1]),r=n.length,a=new Uint8Array(r),i=0;i<r;i++)a[i]=n.charCodeAt(i);t(new Blob([a],{type:"image/png"}))}))}(e)},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var a=n.createElement("a");return n.body.appendChild(a),r.href=t,a.href=e,a.href},getAndEncode:function(e){var t,n=3e4;!S.impl.options.cacheBust||null!==(t=e)&&void 0!==t&&t.startsWith("blob:")||(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());return new Promise((function(t){var r,a=new XMLHttpRequest;if(a.onreadystatechange=o,a.ontimeout=l,a.responseType="blob",a.timeout=n,a.open("GET",e,!0),a.send(),S.impl.options.imagePlaceholder){var i=S.impl.options.imagePlaceholder.split(/,/);null!=i&&i[1]&&(r=i[1])}function o(){if(4===a.readyState)if(200===a.status){var n=new FileReader;n.onloadend=function(){var e=n.result.split(/,/)[1];t(e)},n.readAsDataURL(a.response)}else r?t(r):s("cannot fetch resource: ".concat(e,", status: ").concat(a.status))}function l(){r?t(r):s("timeout of ".concat(n,"ms occured while fetching resource: ").concat(e))}function s(e){console.error(e),t("")}}))},uid:(e=0,function(){var t="u".concat(n()).concat(e);return e+=1,t;function n(){return"0000".concat((Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}),delay:function(e){return function(t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))}},asArray:function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t},escapeXhtml:function(e){return e.replace(/%(\d+)/g,"%25$1").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=function(e){console.error("[dom-to-image]:",e),n(e)},r.src=e}))},width:function(e){var t=n(e,"border-left-width"),r=n(e,"border-right-width");return e.scrollWidth+t+r},height:function(e){var t=n(e,"border-top-width"),r=n(e,"border-bottom-width");return e.scrollHeight+t+r}};var e;function t(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function n(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}}(),g=function(){var e=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(e,a,i){return o()?Promise.resolve(e):Promise.resolve(e).then(n).then((function(t){var n=Promise.resolve(e);return t.forEach((function(e){n=n.then((function(t){return r(t,e,a,i)}))})),n}));function o(){return!t(e)}},shouldProcess:t,impl:{readUrls:n,inline:r}};function t(t){return-1!==t.search(e)}function n(t){for(var n,r=[];null!==(n=e.exec(t));)r.push(n[1]);return r.filter((function(e){return!h.isDataUrl(e)}))}function r(e,t,n,r){return Promise.resolve(t).then((function(e){return n?h.resolveUrl(e,n):e})).then(r||h.getAndEncode).then((function(e){return h.dataAsUrl(e,h.mimeType(t))})).then((function(n){return e.replace(function(e){return new RegExp("(url\\(['\"]?)(".concat(h.escape(e),")(['\"]?\\))"),"g")}(t),"$1".concat(n,"$3"))}))}}(),m=function(){return{resolveAll:function(){return e().then((function(e){return Promise.all(e.map((function(e){return e.resolve()})))})).then((function(e){return e.join("\n")}))},impl:{readAll:e}};function e(){return Promise.resolve(h.asArray(document.styleSheets)).then((function(e){var t=[];return e.forEach((function(e){try{h.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log("Error while reading CSS rules from ".concat(e.href),t.toString())}})),t})).then((function(e){return e.filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).filter((function(e){return console.log(e.style.getPropertyValue("href")),g.shouldProcess(e.style.getPropertyValue("href"))}))})).then((function(t){return t.map(e)}));function e(e){return{resolve:function(){var t,n=null===(t=e.parentStyleSheet)||void 0===t?void 0:t.href;return g.inlineAll(e.cssText,n)},src:function(){return e.style.getPropertyValue("src")}}}}}(),b=function(){return{inlineAll:function t(n){return k(n)?r(n).then((function(){return k(n,"IMG")||k(n,"image")?e(n).inline():Promise.all(h.asArray(n.childNodes).map((function(e){return t(e)})))})):Promise.resolve(n);function r(e){var t=e.style.getPropertyValue("background");return t?g.inlineAll(t).then((function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))})).then((function(){return e})):Promise.resolve(e)}},impl:{newImage:e}};function e(e){return{inline:function(t){var n;n=null==e.src?e.href.animVal:e.src;if(n.includes(".svg")||h.isDataSvgUrl(n))return(r=n,new Promise((function(e){var t=r.match(/viewBox='((\d+\s?)+)'/),n=(null==t?void 0:t[1].split(" "))||[],a=c()(n,4),i=a[2],o=a[3],l=document.createElement("canvas"),s=new Image;s.crossOrigin="Anonymous",s.src=r,s.onload=function(){l.width=i||s.width,l.height=o||s.height;var t=l.getContext("2d");null==t||t.drawImage(s,0,0),e(l.toDataURL())},s.onerror=function(){e("")}}))).then((function(t){e.src=t,e.setAttribute("href",t)}));var r;if(h.isDataUrl(n))return;return Promise.resolve(n).then(t||h.getAndEncode).then((function(e){return h.dataAsUrl(e,h.mimeType(n))})).then((function(t){return new Promise((function(n,r){e.onerror=r,e.src=t,e.setAttribute("href",t),n(void 0)}))}))}}}}(),y={imagePlaceholder:"images/default.png",cacheBust:!0},S={toSvg:P,toPng:function(e,t){return w(e,t).then((function(e){return e.toDataURL()}))},toCanvas:w,toJpeg:function(e,t){return C(e,t=t||{}).then((function(e){return e.toDataURL("image/jpeg",t.quality||1)}))},toBlob:function(e,t){return C(e,t||{}).then(h.canvasToBlob)},toPixelData:function(e,t){return C(e,t||{}).then((function(t){var n;return null===(n=t.getContext("2d"))||void 0===n?void 0:n.getImageData(0,0,h.width(e),h.height(e)).data}))},impl:{fontFaces:m,images:b,util:h,inliner:g,options:{}}};function k(e,t){var n=e.tagName;return!(!n||"string"!=typeof n)&&(!t||"string"!=typeof t||t.toLowerCase()===n.toLowerCase())}function P(e,t){var n;return(t=t||{}).resolution=t.resolution||1,t.cloneNode=null!==(n=t.cloneNode)&&void 0!==n&&n,function(e){void 0===e.imagePlaceholder?S.impl.options.imagePlaceholder=y.imagePlaceholder:S.impl.options.imagePlaceholder=e.imagePlaceholder;void 0===e.cacheBust?S.impl.options.cacheBust=y.cacheBust:S.impl.options.cacheBust=e.cacheBust}(t),Promise.resolve(e).then((function(e){return t.cloneNode?B(e,t.filter,!0):e})).then(H).then(U).then((function(e){t.bgcolor&&(e.style.backgroundColor=t.bgcolor);t.width&&(e.style.width="".concat(t.width,"px"));t.height&&(e.style.height="".concat(t.height,"px"));t.style&&Object.keys(t.style).forEach((function(n){e.style[n]=t.style[n]}));return e})).then((function(n){return function(e,t,n){return Promise.resolve(e).then((function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)})).then(h.escapeXhtml).then((function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'.concat(e,"</foreignObject>")})).then((function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(n,'">').concat(e,"</svg>")})).then((function(e){return"data:image/svg+xml;charset=utf-8,".concat(e)}))}(n,(t.width||h.width(e))*t.resolution,(t.height||h.height(e))*t.resolution)}))}function w(e,t){return C(e,t||{})}function C(e,t){return P(e,t).then(h.makeImage).then((function(n){var r=function(e){var n=document.createElement("canvas");if(n.width=(t.width||h.width(e))*t.resolution,n.height=(t.height||h.height(e))*t.resolution,t.bgcolor){var r=n.getContext("2d");r&&(r.fillStyle=t.bgcolor,r.fillRect(0,0,n.width,n.height))}return n}(e),a=r.getContext("2d");return null==a||a.scale(t.resolution,t.resolution),null==a||a.drawImage(n,0,0),r}))}function E(e){return x.apply(this,arguments)}function x(){return(x=l()(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k(t,"CANVAS")){e.next=2;break}return e.abrupt("return",h.makeImage(t.toDataURL()));case 2:return e.abrupt("return",t.cloneNode(!1));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,n){return T.apply(this,arguments)}function T(){return(T=l()(d.a.mark((function e(t,n,r){var a,i,o,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=f(n),e.prev=1,a.s();case 3:if((i=a.n()).done){e.next=11;break}return o=i.value,e.next=7,B(o,r);case 7:(l=e.sent)&&t.appendChild(l);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})))).apply(this,arguments)}function I(e,t,n){return M.apply(this,arguments)}function M(){return(M=l()(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(a=t.childNodes).length){e.next=3;break}return e.abrupt("return",n);case 3:return e.abrupt("return",D(n,h.asArray(a),r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){var t=e.style,n=t.webkitTextFillColor,r=t.webkitBackgroundClip,a=t.backgroundImage;"SPAN"===(null==e?void 0:e.tagName)&&n&&r&&"border-box"!==r&&a&&"none"!==a&&p.a.isChrome&&("rgba(0, 0, 0, 0)"===n&&(e.style.webkitTextFillColor=""),e.style.webkitBackgroundClip="",e.style.backgroundImage="")}function A(e){var t=e.getPropertyValue("content");return"".concat(e.cssText," content: ").concat(t,";")}function L(e){return"".concat(h.asArray(e).map((function(t){return"".concat(t,": ").concat(e.getPropertyValue(t)).concat(e.getPropertyPriority(t)?" !important":"")})).join("; "),";")}function N(e,t,n){var r=".".concat(e,":").concat(t),a=n.cssText?A(n):L(n);return document.createTextNode("".concat(r,"{").concat(a,"}"))}function j(e,t){[":before",":after"].forEach((function(n){!function(e,t,n){var r=window.getComputedStyle(t,e),a=r.getPropertyValue("content");if(""!==a&&"none"!==a){var i=h.uid();n.className="".concat(n.className," ").concat(i);var o=document.createElement("style");o.appendChild(N(i,e,r)),n.appendChild(o)}}(n,e,t)}))}function R(e,t){k(e,"TEXTAREA")&&(t.innerHTML=e.value),k(e,"INPUT")&&t.setAttribute("value",e.value)}function F(e,t){return k(e)?(function(e,t){var n=window.getComputedStyle(e),r=t.style;n.cssText?r.cssText=n.cssText:h.asArray(n).forEach((function(e){r.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))}))}(e,t),j(e,t),R(e,t),function(e,t){if(k(t,"svg")){t.setAttribute("xmlns","http://www.w3.org/2000/svg"),"path"!==t.tagName&&"image"!==t.tagName||(t.setAttribute("style",null),h.asArray(e.style).forEach((function(n){t.style.setProperty(n,e.style.name)})));var n=e.getAttribute("clip-path");n&&(t.setAttribute("clip-path",n),t.style.clipPath=n,t.style.webkitClipPath=n),k(t,"rect")&&["width","height"].forEach((function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)}))}}(e,t),O(t),t):t}function B(e,t,n){return _.apply(this,arguments)}function _(){return(_=l()(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r||!n||n(t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,E(t);case 4:return a=e.sent,e.next=7,I(t,a,n);case 7:return a=e.sent,e.abrupt("return",F(t,a));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return m.resolveAll().then((function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e}))}function U(e){return b.inlineAll(e).then((function(){return e}))}var G=S}}]);
//# sourceMappingURL=slide-async~43172549-62d933.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([["async~f19eb79b"],{"00032c3677":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,'.styles-para-panel-item-3Dy9J{display:inline-flex;align-items:center}.styles-para-panel-item-title-iWnm6{display:inline-block;width:75px}.styles-para-panel-item-sub-title-1wCjY{width:44px;margin-left:14px}.styles-para-panel-item-content-2mW0s{height:36px}.styles-para-panel-item-select-items-2PxJ7{box-sizing:content-box}.styles-para-panel-item-input-1B7AJ{padding:9px;line-height:16px;font-size:14px}.styles-para-preview-wrapper-3mvxO{margin-top:8px;width:374px;height:102px;border:1px solid #d4d4d4;font-size:16px;overflow:hidden}.styles-para-panel-item-input-wrapper-3koXQ{display:inline-block;position:relative}.styles-para-panel-item-input-content-2g5ws{height:100%;width:100%;font-size:14px;padding:9px;border:1px solid rgba(0,0,0,.16)}.styles-para-panel-item-input-content-2g5ws:hover{border:1px solid rgba(0,0,0,.2)}.styles-para-panel-item-input-content-2g5ws:focus{border:1px solid #0188fb}.styles-para-panel-item-input-content_error-1RgDm{border:1px solid #ef4e2f}.styles-para-panel-item-input-button-wlJk6{position:absolute;right:1px;width:12px;height:17px;background:#f5f5f5}.styles-para-panel-item-input-button-wlJk6:hover{background:rgba(0,0,0,.12)}.styles-para-panel-item-input-button-wlJk6:active{background:rgba(0,0,0,.18)}.styles-para-panel-item-input-inc-1F3Qz{top:1px}.styles-para-panel-item-input-inc-1F3Qz:after{content:"";position:absolute;top:50%;left:50%;border-left:3px solid transparent;border-right:3px solid transparent;border-bottom:4px solid #8c9093;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.styles-para-panel-item-input-desc-2q4Q7{bottom:1px}.styles-para-panel-item-input-desc-2q4Q7:after{content:"";position:absolute;top:50%;left:50%;border-left:3px solid transparent;border-right:3px solid transparent;border-top:4px solid #8c9093;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.styles-para-panel-item-input-error-2QjA7{display:inline-block;position:absolute;top:38px;left:0;font-size:12px;line-height:17px;color:#ef4e2f;text-align:left;width:148px;overflow:hidden;white-space:nowrap}.styles-tabstop-modal-tabstop-list-24ZC8{flex:1 1;border:1px solid rgba(0,0,0,.1);height:200px;overflow-y:scroll;padding:0}.styles-tabstop-modal-container-2a0Gu{display:flex;width:100%}.styles-tabstop-modal-left-column-a4nkL{margin-right:10px;width:180px}.styles-tabstop-modal-right-column-dXe4W{flex:1 1}.styles-tabstop-modal-row-1b4A-{width:300px;display:flex;align-items:center}',""]),t.locals={"para-panel-item":"styles-para-panel-item-3Dy9J","para-panel-item-title":"styles-para-panel-item-title-iWnm6","para-panel-item-sub-title":"styles-para-panel-item-sub-title-1wCjY","para-panel-item-content":"styles-para-panel-item-content-2mW0s","para-panel-item-select-items":"styles-para-panel-item-select-items-2PxJ7","para-panel-item-input":"styles-para-panel-item-input-1B7AJ","para-preview-wrapper":"styles-para-preview-wrapper-3mvxO","para-panel-item-input-wrapper":"styles-para-panel-item-input-wrapper-3koXQ","para-panel-item-input-content":"styles-para-panel-item-input-content-2g5ws","para-panel-item-input-content_error":"styles-para-panel-item-input-content_error-1RgDm","para-panel-item-input-button":"styles-para-panel-item-input-button-wlJk6","para-panel-item-input-inc":"styles-para-panel-item-input-inc-1F3Qz","para-panel-item-input-desc":"styles-para-panel-item-input-desc-2q4Q7","para-panel-item-input-error":"styles-para-panel-item-input-error-2QjA7","tabstop-modal-tabstop-list":"styles-tabstop-modal-tabstop-list-24ZC8","tabstop-modal-container":"styles-tabstop-modal-container-2a0Gu","tabstop-modal-left-column":"styles-tabstop-modal-left-column-a4nkL","tabstop-modal-right-column":"styles-tabstop-modal-right-column-dXe4W","tabstop-modal-row":"styles-tabstop-modal-row-1b4A-"}},"016175442c":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.Multi="multiply",e.Fixed="fixed"}(i||(i={}))},"10637d5e95":function(t,n,i){"use strict";i.d(n,"a",(function(){return P}));i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36");var r=i("176815363d"),a=i.n(r),o=i("9132715560"),c=i.n(o),l=i("6a364eb35c"),s=i.n(l),d=i("85d0a7609b"),u=i.n(d),h=i("3ef2352f0b"),f=i.n(h),v=(i("a2a09da1e3"),i("c6244f7705"),i("081c8cafea"),i("e0e8dd9366")),p=i("d3d31c86eb"),g=i("e5a826a0ff"),b=i("ec5cae33cb"),m=i("f1463e9e23"),y=i("9da6335152"),w=i("14502724a6"),S=i.n(w),E=i("c9c92622ff"),O=function(){function e(){c()(this,e)}return s()(e,[{key:"tabSelectedModelChange",value:function(e,t){var n=t.selectedArray;if(0===t.length)this.setElementSelected(t,e.children[0]);else{var i=null==n?void 0:n.length,r=null==n?void 0:n[(null!=i?i:1)-1];this.setElementSelected(t,this.findNextSelectModel(e,r))}}},{key:"setElementSelected",value:function(e,t){if(t){e.clear(),e.add(t);var n=e.selectedArrayForType(g.a.SLIDE),i=t.rootGroupModel;i&&-1===n.indexOf(i)&&e.add(i)}}},{key:"findNextSelectModel",value:function(e,t){for(var n=e.children,i=n.length,r=null,a=0;a<i;a++){var o=n[a],c=o.key===(null==t?void 0:t.key);if(Object(E.n)(o)?r=this.findNextModelInGroup(c,n,a,null==t?void 0:t.key):c&&(r=this.getSelectModel(n,a)),r)break}a>=i&&(r=S()(n,1)[0]);return r}},{key:"findNextModelInGroup",value:function(e,t,n,i){var r=null,a=t[n];if(e){do{a=a.children[0]}while(Object(E.n)(a));r=a}else{var o=this.findNextModelInChildGroup(a,i),c=o.hasSelected,l=o.nextSelectModel;l?r=l:c&&(r=this.getSelectModel(t,n))}return r}},{key:"findNextModelInChildGroup",value:function(e,t){for(var n=e.children,i=n.length,r={hasSelected:!1,nextSelectModel:null},a=0;a<i;a++){var o=n[a];if(Object(E.n)(o)?(r=this.findNextModelInChildGroup(o,t)).hasSelected&&!r.nextSelectModel&&(r.nextSelectModel=this.getSelectModel(n,a)):o.key===t&&(r.hasSelected=!0,r.nextSelectModel=this.getSelectModel(n,a)),r.hasSelected)break}return r}},{key:"getSelectModel",value:function(e,t){var n=null,i=t+1;return i<e.length&&(n=e[i]),n}}]),e}(),k=i("0a8ecd6412");function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(){function t(e,n){var i=this;c()(this,t),u()(this,"services",void 0),u()(this,"injectable",void 0),u()(this,"elementMoveTimer",null),u()(this,"mouseWheelTimer",null),u()(this,"lastTimeStamp",void 0),u()(this,"outerEditorTimeStamp",void 0),u()(this,"lastHandledTimestamp",void 0),u()(this,"lastDeltaY",void 0),u()(this,"tabActionService",void 0),u()(this,"isPointInCanvasReact",(function(e,t){var n=document.getElementById("canvas");if(!n)return!1;var i=n.getBoundingClientRect(),r=i.top,a=r+i.height,o=i.left,c=o+i.width;return!(e<o||e>c||t<r||t>a)})),u()(this,"isPointInRightBarReact",(function(e,t){var n=!1,i=document.getElementById("rs-bar-container");if(i&&"true"===i.getAttribute("data-display")){var r=i.getBoundingClientRect(),a=r.top,o=a+r.height,c=r.left,l=c+r.width;e<c||e>l||t<a||t>o||(n=!0)}return n})),u()(this,"isUserListShow",(function(){var e=document.getElementsByClassName("otheruserstable-wrapper open");return e&&e.length>0})),u()(this,"needHandleMouseWheelByCurrentState",(function(){var e;return!i.checkIsInAnyEditingState()&&!(!i.canChangeSelectedSlide()||null!==(e=i.menuManager)&&void 0!==e&&e.isDropdownShown)})),u()(this,"needHandleMouseWheelByTimestamp",(function(e){var t=1===e.deltaY||-1===e.deltaY?i.isMagicMouseAction(e):i.isNotMagicMouseAction(e);return void 0===t||t})),u()(this,"handleMouseWheel",(function(e){null!==i.mouseWheelTimer&&clearTimeout(i.mouseWheelTimer),i.mouseWheelTimer=setTimeout((function(){var t,n,r,a;if(i.lastHandledTimestamp=e.timeStamp,i.selectionService)if(e.deltaY<0)i.canChangeSelectedSlide()&&(null===(t=i.selectionService)||void 0===t||t.selectedSlides.clear(),(null===(n=i.selectionService)||void 0===n?void 0:n.currentSlideIndex)>=0&&(null===(r=i.selectionService)||void 0===r?void 0:r.currentSlideIndex)-1>=0?(i.editingStateManager&&(i.editingStateManager.keyFlag4Moving=37),null===(a=i.selectionService)||void 0===a||a.changeCurrentSlideIndexByUserAction(i.selectionService.currentSlideIndex-1),e.preventDefault(),e.stopPropagation()):i.selectionService.needClearSelectedSlideClearanceFlag+=1);else if(i.canChangeSelectedSlide()){var o,c,l,s,d;if(null===(o=i.selectionService)||void 0===o||o.selectedSlides.clear(),(null===(c=i.selectionService)||void 0===c?void 0:c.currentSlideIndex)>=0&&(null===(l=i.selectionService)||void 0===l?void 0:l.currentSlideIndex)+1<(null===(s=i.selectionService)||void 0===s?void 0:s.slides.length))i.editingStateManager&&(i.editingStateManager.keyFlag4Moving=39),null===(d=i.selectionService)||void 0===d||d.changeCurrentSlideIndexByUserAction(i.selectionService.currentSlideIndex+1),e.preventDefault(),e.stopPropagation();else i.selectionService.needClearSelectedSlideClearanceFlag+=1}}),10)})),u()(this,"ignoreWheel",(function(e,t){return e.className.indexOf("hasOverScrollY")>=0||(0===t.deltaY||Math.abs(t.deltaX)>=Math.abs(t.deltaY)||Math.abs(t.deltaY)<3||void 0)})),this.injectable=n,this.setServicesDelegates(e),this.tabActionService=new O,this.lastTimeStamp=0}var n,i,r,o;return s()(t,[{key:"setServicesDelegates",value:function(e){this.services=M(M({},this.services),e)}},{key:"forward",value:function(){var e,t;null===(e=this.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t||t.moveElement(1)}},{key:"backward",value:function(){var e,t;null===(e=this.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t||t.moveElement(-1)}},{key:"front",value:function(){var e,t;null===(e=this.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t||t.setCurrentElementToFrontOrBack(m.a.FRONT)}},{key:"back",value:function(){var e,t;null===(e=this.selectionService)||void 0===e||null===(t=e.currentSlide)||void 0===t||t.setCurrentElementToFrontOrBack(m.a.BACK)}},{key:"copy",value:(o=a()(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.copyPasteManager)||void 0===t?void 0:t.promise();case 2:null==(n=e.sent)||n.triggerCopyEvent();case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"paste",value:(r=a()(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.copyPasteManager)||void 0===t?void 0:t.promise();case 2:null==(n=e.sent)||n.triggerPasteEvent();case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"cut",value:(i=a()(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.copyPasteManager)||void 0===t?void 0:t.promise();case 2:null==(n=e.sent)||n.triggerCutEvent();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"ctrl",value:(n=a()(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.copyPasteManager)||void 0===t?void 0:t.promise();case 2:null==(n=e.sent)||n.keyEventCtrl();case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"selectAll",value:function(e){var t,n,i;if(!this.checkTextEditing()){e.preventDefault(),e.stopPropagation();var r=!1;switch(null===(t=this.selectionService)||void 0===t?void 0:t.lastMouseDownRegion){case b.a.SLIDELIST:null===(n=this.uiDataService)||void 0===n||n.presentation.selectAll();break;case b.a.EDITOR:if(1===(null===(i=this.selectionService)||void 0===i?void 0:i.selectedElements.length)){var a,o,c,l=null===(a=this.selectionService)||void 0===a||null===(o=a.selectedElements)||void 0===o||null===(c=o.selectedArray)||void 0===c?void 0:c[0];l.selectAll&&(r=l.selectAll())}var s,d;if(!r)null===(s=this.selectionService)||void 0===s||null===(d=s.currentSlide)||void 0===d||d.selectAll()}}}},{key:"play",value:function(){var e;if(!this.checkTextEditing()){var t=null===(e=this.playManager)||void 0===e?void 0:e.playAction;t&&(t(),Object(p.c)({opername:y.e.DOC_PPT,module:y.d.PC_LOCAL_PLAY,action:y.b.HOT_KEY}))}}},{key:"up",value:function(e){this.checkIsInAnyEditingState()||this.checkAndMoveSelectedElements(e)||this.pageup(e)}},{key:"down",value:function(e){this.checkIsInAnyEditingState()||this.checkAndMoveSelectedElements(e)||this.pagedown(e)}},{key:"left",value:function(e){this.checkIsInAnyEditingState()||this.checkAndMoveSelectedElements(e)||this.pageup(e)}},{key:"right",value:function(e){this.checkIsInAnyEditingState()||this.checkAndMoveSelectedElements(e)||this.pagedown(e)}},{key:"pageup",value:function(e){this.checkIsInAnyEditingState()||this.canChangeSelectedSlide()&&this.normalPageUp(e)}},{key:"pagedown",value:function(e){this.checkIsInAnyEditingState()||this.canChangeSelectedSlide()&&this.normalPageDown(e)}},{key:"home",value:function(e){this.checkIsInAnyEditingState()||this.canChangeSelectedSlide()&&this.changeSelectedSlide(e,0)}},{key:"end",value:function(e){this.selectionService&&(this.checkIsInAnyEditingState()||this.canChangeSelectedSlide()&&this.changeSelectedSlide(e,this.selectionService.slides.length-1))}},{key:"newSlideEnter",value:function(e){var t;(null===(t=this.selectionService)||void 0===t?void 0:t.lastMouseDownRegion)===b.a.SLIDELIST&&(this.checkIsInAnyEditingState()||this.addSlide(e))}},{key:"newSlideM",value:function(e){var t;(null===(t=this.selectionService)||void 0===t?void 0:t.lastMouseDownRegion)===b.a.SLIDELIST&&(this.checkIsInAnyEditingState()||this.addSlide(e))}},{key:"addGroup",value:function(e){var t,n,i;if((null===(t=this.selectionService)||void 0===t?void 0:t.lastMouseDownRegion)===b.a.EDITOR){var r,a,o=(null===(n=this.selectionService)||void 0===n?void 0:n.selectedElements.selectedArray)||[];if(null!==(i=this.selectionService)&&void 0!==i&&i.currentSlide&&o.length)null===(r=this.selectionService)||void 0===r||null===(a=r.currentSlide)||void 0===a||a.groupElements(o),e.preventDefault(),e.stopPropagation(),Object(p.c)({opername:y.e.DOC_PPT,module:y.d.PPT_PC_EDIT_COMBINATION,action:y.b.COMBINATION_TOTAL_UV})}}},{key:"removeGroup",value:function(e){var t,n,i;if((null===(t=this.selectionService)||void 0===t?void 0:t.lastMouseDownRegion)===b.a.EDITOR){var r,a,o=(null===(n=this.selectionService)||void 0===n?void 0:n.selectedElements.selectedArray)||[];if(null!==(i=this.selectionService)&&void 0!==i&&i.currentSlide&&o.length)null===(r=this.selectionService)||void 0===r||null===(a=r.currentSlide)||void 0===a||a.unGroupElements(o),e.preventDefault(),e.stopPropagation(),Object(p.c)({opername:y.e.DOC_PPT,module:y.d.PPT_PC_EDIT_COMBINATION,action:y.b.REMOVE_COMBINATION_TOTAL_UV})}}},{key:"delete",value:function(e){this.checkTextEditing()||(e&&(e.stopPropagation(),e.preventDefault()),this.deleteInSlideOrEditorRegion())}},{key:"mousewheel",value:function(e){if(this.needHandleMouseWheelByCurrentState()&&!this.isUserListShow()){var t=document.getElementById("canvas");if(t){if(this.ignoreWheel(t,e))return;var n=e.pageX,i=e.pageY;if(this.isPointInCanvasReact(n,i)){if(this.hasFloatContent())return void(this.outerEditorTimeStamp=e.timeStamp);if(this.isPointInRightBarReact(n,i))return void(this.outerEditorTimeStamp=e.timeStamp);if(!this.needHandleMouseWheelByTimestamp(e))return;this.handleMouseWheel(e)}else this.outerEditorTimeStamp=e.timeStamp}}}},{key:"tabAction",value:function(t){var n;if(this.selectionService){var i,r,a=this.selectionService.selectedElements,o=a.selectedArrayForType(g.a.SLIDE);if(null!==(n=this.editorInstanceService)&&void 0!==n&&n.checkEditorIsEditing())1===o.length&&o[0].type===v.d.TABLE&&(null===(i=o[0])||void 0===i||null===(r=i.hotTable)||void 0===r||r.handleTableKeyDown(e));else this.tabActionService.tabSelectedModelChange(this.selectionService.currentSlide,a),t&&(t.preventDefault(),t.stopPropagation())}}},{key:"hasFloatContent",value:function(){for(var e,t,n=null!==(e=null===(t=this.injectable)||void 0===t?void 0:t.floatContentOffset)&&void 0!==e?e:{x:0,y:0},i=document.elementFromPoint(n.x,n.y);i&&i!==document.body;){if(i.id===k.r.WORKBENCH)return!1;i=i.parentElement}return!0}},{key:"addSlide",value:function(e){var t;e.preventDefault(),e.stopPropagation(),null===(t=this.uiDataService)||void 0===t||t.presentation.addDefaultSlide()}},{key:"changeSelectedSlide",value:function(e,t){this.editingStateManager&&(this.editingStateManager.keyFlag4Moving=e.keyCode);var n=this.selectionService;if(n&&!(t<0||t>n.slides.length-1)){e.stopPropagation(),e.preventDefault();var i=n.selectedSlides,r=n.slides;i.clear(),n.changeCurrentSlideIndexByUserAction(t),i.add(r[t]),n.needClearSelectedSlideClearanceFlag+=1}}},{key:"normalPageUp",value:function(e){this.selectionService&&this.changeSelectedSlide(e,this.selectionService.currentSlideIndex-1)}},{key:"normalPageDown",value:function(e){this.selectionService&&this.changeSelectedSlide(e,this.selectionService.currentSlideIndex+1)}},{key:"checkTextEditing",value:function(){var e,t,n;return!!(null!==(e=this.editorInstanceService)&&void 0!==e&&null!==(t=e.checkEditorIsEditing)&&void 0!==t&&t.call(e)||null!==(n=this.editingStateManager)&&void 0!==n&&n.isEditing)}},{key:"deleteInSlideOrEditorRegion",value:function(){var e;switch(null===(e=this.selectionService)||void 0===e?void 0:e.lastMouseDownRegion){case b.a.SLIDELIST:this.deleteSlide();break;case b.a.EDITOR:this.deleteInEditorRegion()}}},{key:"selectionService",get:function(){return this.services.selectionService}},{key:"uiDataService",get:function(){return this.services.uiDataService}},{key:"editorInstanceService",get:function(){return this.services.editorInstanceService}},{key:"menuManager",get:function(){return this.services.menuManager}},{key:"editingStateManager",get:function(){return this.services.editingStateManager}},{key:"userPriviledgeService",get:function(){return this.services.userPriviledgeService}},{key:"moveElementManager",get:function(){return this.services.moveElementManager}},{key:"copyPasteManager",get:function(){return this.services.copyPasteManager}},{key:"playManager",get:function(){return this.services.playManager}},{key:"getToolbarStateManager",value:function(){return this.services.toolbarStateManager}},{key:"checkIsInAnyEditingState",value:function(){var e;return this.checkTextEditing()||(null===(e=this.editingStateManager)||void 0===e?void 0:e.isInAnyEditingState())}},{key:"canChangeSelectedSlide",value:function(){var e,t;return!(null!==(e=this.menuManager)&&void 0!==e&&e.isMenuShown||null!==(t=this.getToolbarStateManager())&&void 0!==t&&t.isToolbarMenuShown)}},{key:"checkAndMoveSelectedElements",value:function(e){var t;return!(null===(t=this.moveElementManager)||void 0===t||!t.checkAndMoveSelectedElementsWithArrow(e.keyCode))&&(e.preventDefault(),e.stopPropagation(),this.updateElementMoveFlag(),!0)}},{key:"updateElementMoveFlag",value:function(){var e=this;this.elementMoveTimer&&clearTimeout(this.elementMoveTimer),this.editingStateManager&&(this.editingStateManager.isMovingWithKeyUpDown=!0),this.elementMoveTimer=setTimeout((function(){e.editingStateManager&&(e.editingStateManager.isMovingWithKeyUpDown=!1)}),400)}},{key:"isMagicMouseAction",value:function(e){if(Math.abs(e.deltaY)<32)return!1;if(e.timeStamp<this.outerEditorTimeStamp+2e3)return!1;if(e.timeStamp>this.lastTimeStamp+2e3)this.lastTimeStamp=e.timeStamp;else{if(!(e.timeStamp>this.lastHandledTimestamp+500))return!1;if(!(Math.abs(e.deltaY)>this.lastDeltaY&&Math.abs(e.deltaY)>32))return this.lastDeltaY=e.deltaY,!1;this.lastTimeStamp=e.timeStamp,this.lastDeltaY=e.deltaY}}},{key:"isNotMagicMouseAction",value:function(e){return!(e.timeStamp<this.outerEditorTimeStamp+500)&&(e.timeStamp>this.lastTimeStamp+500&&void(this.lastTimeStamp=e.timeStamp))}},{key:"deleteSlide",value:function(){var e,t,n,i,r,a;this.selectionService&&(this.selectionService.selectedSlides.selectedArray.length>0?null===(t=this.uiDataService)||void 0===t||null===(n=t.presentation)||void 0===n||n.deleteSlide():null!==(e=this.selectionService)&&void 0!==e&&e.currentSlide&&(null===(i=this.uiDataService)||void 0===i||null===(r=i.presentation)||void 0===r||r.deleteSlide([null===(a=this.selectionService)||void 0===a?void 0:a.currentSlide])))}},{key:"deleteInEditorRegion",value:function(){var e,t,n,i=null===(e=this.selectionService)||void 0===e?void 0:e.selectedElements.selectedArrayForType(g.a.SLIDE);if(i&&1===i.length&&i[0].type===v.d.TABLE&&!0===i[0].clearSelectedCellContent())return;null===(t=this.selectionService)||void 0===t||null===(n=t.currentSlide)||void 0===n||n.deleteElement()}}]),t}()},"1252d99904":function(e,t,n){(e.exports=n("9dddfe0040")(!1)).push([e.i,'@-webkit-keyframes antCheckboxEffect{0%{-webkit-transform:scale(1);transform:scale(1);opacity:.5}to{-webkit-transform:scale(1.6);transform:scale(1.6);opacity:0}}@keyframes antCheckboxEffect{0%{-webkit-transform:scale(1);transform:scale(1);opacity:.5}to{-webkit-transform:scale(1.6);transform:scale(1.6);opacity:0}}.dui-tree-treenode-leaf-last .dui-tree-switcher-leaf-line:before{top:auto!important;bottom:auto!important;height:14px!important}.dui-tree.dui-tree-directory .dui-tree-treenode{position:relative}.dui-tree.dui-tree-directory .dui-tree-treenode:before{position:absolute;top:0;right:0;bottom:4px;left:0;transition:background-color .3s;content:"";pointer-events:none}.dui-tree.dui-tree-directory .dui-tree-treenode:hover:before{background:#f5f5f5}.dui-tree.dui-tree-directory .dui-tree-treenode>*{z-index:1}.dui-tree.dui-tree-directory .dui-tree-treenode .dui-tree-switcher{transition:color .3s}.dui-tree.dui-tree-directory .dui-tree-treenode .dui-tree-node-content-wrapper{border-radius:0;-webkit-user-select:none;-ms-user-select:none;user-select:none}.dui-tree.dui-tree-directory .dui-tree-treenode .dui-tree-node-content-wrapper:hover{background:transparent}.dui-tree.dui-tree-directory .dui-tree-treenode .dui-tree-node-content-wrapper.dui-tree-node-selected{color:#fff;background:transparent}.dui-tree.dui-tree-directory .dui-tree-treenode-selected:before,.dui-tree.dui-tree-directory .dui-tree-treenode-selected:hover:before{background:#1890ff}.dui-tree.dui-tree-directory .dui-tree-treenode-selected .dui-tree-switcher{color:#fff}.dui-tree.dui-tree-directory .dui-tree-treenode-selected .dui-tree-node-content-wrapper{color:#fff;background:transparent}.dui-tree-checkbox{box-sizing:border-box;margin:0;padding:0;color:rgba(0,0,0,.85);font-size:14px;font-variant:tabular-nums;line-height:1.5715;list-style:none;-webkit-font-feature-settings:"tnum","tnum";font-feature-settings:"tnum","tnum";position:relative;top:.2em;line-height:1;white-space:nowrap;outline:none;cursor:pointer}.dui-tree-checkbox-input:focus+.dui-tree-checkbox-inner,.dui-tree-checkbox-wrapper:hover .dui-tree-checkbox-inner,.dui-tree-checkbox:hover .dui-tree-checkbox-inner{border-color:#1890ff}.dui-tree-checkbox-checked:after{position:absolute;top:0;left:0;width:100%;height:100%;border:1px solid #1890ff;border-radius:2px;visibility:hidden;-webkit-animation:antCheckboxEffect .36s ease-in-out;animation:antCheckboxEffect .36s ease-in-out;-webkit-animation-fill-mode:backwards;animation-fill-mode:backwards;content:""}.dui-tree-checkbox-wrapper:hover .dui-tree-checkbox:after,.dui-tree-checkbox:hover:after{visibility:visible}.dui-tree-checkbox-inner{position:relative;top:0;left:0;display:block;width:16px;height:16px;direction:ltr;background-color:#fff;border:1px solid #d9d9d9;border-radius:2px;border-collapse:separate;transition:all .3s}.dui-tree-checkbox-inner:after{position:absolute;top:50%;left:21.5%;display:table;width:5.71428571px;height:9.14285714px;border:2px solid #fff;border-top:0;border-left:0;-webkit-transform:rotate(45deg) scale(0) translate(-50%,-50%);transform:rotate(45deg) scale(0) translate(-50%,-50%);opacity:0;transition:all .1s cubic-bezier(.71,-.46,.88,.6),opacity .1s;content:" "}.dui-tree-checkbox-input{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;width:100%;height:100%;cursor:pointer;opacity:0}.dui-tree-checkbox-checked .dui-tree-checkbox-inner:after{position:absolute;display:table;border:2px solid #fff;border-top:0;border-left:0;-webkit-transform:rotate(45deg) scale(1) translate(-50%,-50%);transform:rotate(45deg) scale(1) translate(-50%,-50%);opacity:1;transition:all .2s cubic-bezier(.12,.4,.29,1.46) .1s;content:" "}.dui-tree-checkbox-checked .dui-tree-checkbox-inner{background-color:#1890ff;border-color:#1890ff}.dui-tree-checkbox-disabled{cursor:not-allowed}.dui-tree-checkbox-disabled.dui-tree-checkbox-checked .dui-tree-checkbox-inner:after{border-color:rgba(0,0,0,.25);-webkit-animation-name:none;animation-name:none}.dui-tree-checkbox-disabled .dui-tree-checkbox-input{cursor:not-allowed}.dui-tree-checkbox-disabled .dui-tree-checkbox-inner{background-color:#f5f5f5;border-color:#d9d9d9!important}.dui-tree-checkbox-disabled .dui-tree-checkbox-inner:after{border-color:#f5f5f5;border-collapse:separate;-webkit-animation-name:none;animation-name:none}.dui-tree-checkbox-disabled+span{color:rgba(0,0,0,.25);cursor:not-allowed}.dui-tree-checkbox-disabled:hover:after,.dui-tree-checkbox-wrapper:hover .dui-tree-checkbox-disabled:after{visibility:hidden}.dui-tree-checkbox-wrapper{box-sizing:border-box;margin:0;padding:0;color:rgba(0,0,0,.85);font-size:14px;font-variant:tabular-nums;line-height:1.5715;list-style:none;-webkit-font-feature-settings:"tnum","tnum";font-feature-settings:"tnum","tnum";display:inline-flex;align-items:baseline;line-height:unset;cursor:pointer}.dui-tree-checkbox-wrapper:after{display:inline-block;width:0;overflow:hidden;content:"\\a0"}.dui-tree-checkbox-wrapper.dui-tree-checkbox-wrapper-disabled{cursor:not-allowed}.dui-tree-checkbox-wrapper+.dui-tree-checkbox-wrapper{margin-left:8px}.dui-tree-checkbox+span{padding-right:8px;padding-left:8px}.dui-tree-checkbox-group{box-sizing:border-box;margin:0;padding:0;color:rgba(0,0,0,.85);font-size:14px;font-variant:tabular-nums;line-height:1.5715;list-style:none;-webkit-font-feature-settings:"tnum","tnum";font-feature-settings:"tnum","tnum";display:inline-block}.dui-tree-checkbox-group-item{margin-right:8px}.dui-tree-checkbox-group-item:last-child{margin-right:0}.dui-tree-checkbox-group-item+.dui-tree-checkbox-group-item{margin-left:0}.dui-tree-checkbox-indeterminate .dui-tree-checkbox-inner{background-color:#fff;border-color:#d9d9d9}.dui-tree-checkbox-indeterminate .dui-tree-checkbox-inner:after{top:50%;left:50%;width:8px;height:8px;background-color:#1890ff;border:0;-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1);opacity:1;content:" "}.dui-tree-checkbox-indeterminate.dui-tree-checkbox-disabled .dui-tree-checkbox-inner:after{background-color:rgba(0,0,0,.25);border-color:rgba(0,0,0,.25)}.dui-tree{box-sizing:border-box;margin:0;padding:0;color:rgba(0,0,0,.85);font-size:14px;font-variant:tabular-nums;line-height:1.5715;list-style:none;-webkit-font-feature-settings:"tnum","tnum";font-feature-settings:"tnum","tnum";background:#fff;border-radius:2px;transition:background-color .3s}.dui-tree-focused:not(:hover):not(.dui-tree-active-focused){background:#e6f7ff}.dui-tree-list-holder-inner{align-items:flex-start}.dui-tree.dui-tree-block-node .dui-tree-list-holder-inner{align-items:stretch}.dui-tree.dui-tree-block-node .dui-tree-list-holder-inner .dui-tree-node-content-wrapper{flex:auto}.dui-tree .dui-tree-treenode{display:flex;align-items:flex-start;padding:0 0 4px;outline:none}.dui-tree .dui-tree-treenode-disabled .dui-tree-node-content-wrapper{color:rgba(0,0,0,.25);cursor:not-allowed}.dui-tree .dui-tree-treenode-disabled .dui-tree-node-content-wrapper:hover{background:transparent}.dui-tree .dui-tree-treenode-active .dui-tree-node-content-wrapper{background:#f5f5f5}.dui-tree .dui-tree-treenode:not(.dui-tree .dui-tree-treenode-disabled).filter-node .dui-tree-title{color:inherit;font-weight:500}.dui-tree-indent{align-self:stretch;white-space:nowrap;-webkit-user-select:none;-ms-user-select:none;user-select:none}.dui-tree-indent-unit{display:inline-block;width:24px}.dui-tree-switcher{position:relative;flex:none;align-self:stretch;width:24px;margin:0;line-height:24px;text-align:center;cursor:pointer;-webkit-user-select:none;-ms-user-select:none;user-select:none}.dui-tree-switcher .dui-select-tree-switcher-icon,.dui-tree-switcher .dui-tree-switcher-icon{display:inline-block;font-size:10px;vertical-align:baseline}.dui-tree-switcher .dui-select-tree-switcher-icon svg,.dui-tree-switcher .dui-tree-switcher-icon svg{transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.dui-tree-switcher-noop{cursor:default}.dui-tree-switcher_close .dui-tree-switcher-icon svg{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.dui-tree-switcher-loading-icon{color:#1890ff}.dui-tree-switcher-leaf-line{position:relative;z-index:1;display:inline-block;width:100%;height:100%}.dui-tree-switcher-leaf-line:before{position:absolute;top:0;bottom:-4px;margin-left:-1px;border-left:1px solid #d9d9d9;content:" "}.dui-tree-switcher-leaf-line:after{position:absolute;width:10px;height:14px;margin-left:-1px;border-bottom:1px solid #d9d9d9;content:" "}.dui-tree-checkbox{top:auto;margin:4px 8px 0 0}.dui-tree .dui-tree-node-content-wrapper{position:relative;z-index:auto;min-height:24px;margin:0;padding:0 4px;color:inherit;line-height:24px;background:transparent;border-radius:2px;cursor:pointer;transition:all .3s,border 0s,line-height 0s,box-shadow 0s}.dui-tree .dui-tree-node-content-wrapper:hover{background-color:#f5f5f5}.dui-tree .dui-tree-node-content-wrapper.dui-tree-node-selected{background-color:#e8e8e8}.dui-tree .dui-tree-node-content-wrapper .dui-tree-iconEle{display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;vertical-align:top}.dui-tree .dui-tree-node-content-wrapper .dui-tree-iconEle:empty{display:none}.dui-tree-unselectable .dui-tree-node-content-wrapper:hover{background-color:transparent}.dui-tree-node-content-wrapper[draggable=true]{line-height:24px;-webkit-user-select:none;-ms-user-select:none;user-select:none}.dui-tree-node-content-wrapper[draggable=true] .dui-tree-drop-indicator{position:absolute;z-index:1;height:2px;background-color:#1890ff;border-radius:1px;pointer-events:none}.dui-tree-node-content-wrapper[draggable=true] .dui-tree-drop-indicator:after{position:absolute;top:-3px;left:-6px;width:8px;height:8px;background-color:transparent;border:2px solid #1890ff;border-radius:50%;content:""}.dui-tree .dui-tree-treenode.drop-container>[draggable]{box-shadow:0 0 0 2px #1890ff}.dui-tree-show-line .dui-tree-indent-unit{position:relative;height:100%}.dui-tree-show-line .dui-tree-indent-unit:before{position:absolute;top:0;right:12px;bottom:-4px;border-right:1px solid #d9d9d9;content:""}.dui-tree-show-line .dui-tree-indent-unit-end:before{display:none}.dui-tree-show-line .dui-tree-switcher{background:#fff}.dui-tree-show-line .dui-tree-switcher-line-icon{vertical-align:-.225em}.dui-tree-rtl{direction:rtl}.dui-tree-rtl .dui-tree-node-content-wrapper[draggable=true] .dui-tree-drop-indicator:after{right:-6px;left:unset}.dui-tree .dui-tree-treenode-rtl{direction:rtl}.dui-tree-rtl .dui-tree-switcher_close .dui-tree-switcher-icon svg{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.dui-tree-rtl.dui-tree-show-line .dui-tree-indent-unit:before{right:auto;left:-13px;border-right:none;border-left:1px solid #d9d9d9}.dui-tree-rtl.dui-tree-checkbox,.dui-tree-select-dropdown-rtl .dui-select-tree-checkbox{margin:4px 0 0 8px}.select-window-tree-global{background-color:#fcfcfc}.select-window-tree-global.dui-tree .dui-tree-treenode{position:relative}.select-window-tree-global.dui-tree .dui-tree-node-content-wrapper{position:static;width:50%}.select-window-tree-global.dui-tree .dui-tree-node-content-wrapper.dui-tree-node-selected .display-icon{background-color:#e8e8e8}.select-window-tree-global.dui-tree .dui-tree-node-content-wrapper:hover,.select-window-tree-global.dui-tree .dui-tree-node-content-wrapper:hover .display-icon{background-color:#f5f5f5}.select-window-tree-global.dui-tree .dui-tree-node-content-wrapper .dui-tree-drop-indicator{right:0!important;bottom:2px!important;left:10%!important}.select-window-tree-global.dui-tree .dui-tree-node-content-wrapper .dui-tree-drop-indicator:after{border-color:transparent}.select-window-tree-global.dui-tree .dui-tree-indent-unit{width:12px}.select-window-tree-global-drawer{background-color:var(--bg-lv3-default);margin-top:-4px}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode{position:relative;height:28px;margin-top:4px;padding-bottom:0}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode:hover{background-color:var(--feedback-hover)}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode:active{background-color:var(--feedback-active)}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-switcher{width:16px;height:16px;line-height:16px;margin:6px -12px 6px 0;z-index:1;cursor:default}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-switcher_close:hover{background-color:var(--feedback-hover)}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-switcher_close:active{background-color:var(--feedback-active)}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-switcher_open:hover{background-color:var(--feedback-hover)}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-switcher_open:active{background-color:var(--feedback-active)}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-node-content-wrapper{position:static;width:50%;cursor:default;padding:0 0 0 16px}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-node-content-wrapper.dui-tree-node-selected,.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-node-content-wrapper.dui-tree-node-selected .display-icon,.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-node-content-wrapper:active,.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-node-content-wrapper:hover{background-color:transparent}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-node-content-wrapper .dui-tree-drop-indicator{bottom:2px!important;left:0!important;background-color:var(--accent-default);border-radius:0}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-node-content-wrapper .dui-tree-drop-indicator:after{width:0;height:0;border:4px solid transparent;border-color:var(--accent-default);left:-3px}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode .dui-tree-indent-unit{width:12px}.select-window-tree-global-drawer.dui-tree .dui-tree-treenode-selected{background-color:var(--feedback-active)!important}',""])},"15fec0187b":function(e,t,n){"use strict";n.r(t);var i,r=n("176815363d"),a=n.n(r),o=n("9132715560"),c=n.n(o),l=n("6a364eb35c"),s=n.n(l),d=n("85d0a7609b"),u=n.n(d),h=n("3ef2352f0b"),f=n.n(h),v=(n("b8217400dc"),n("e6f68cdf2e"),n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("081c8cafea"),n("8ee19818c4"),n("69084d01d3")),p=n.n(v),g=n("d5c3deb8c7"),b=n("e0e8dd9366"),m=n("9da6335152"),y=n("d3d31c86eb"),w=n("6884e1a126"),S=n("432f93125e"),E=n("8ba8926996"),O=n("b724aeb83f"),k=n("ced39f0c87"),x=n("7e3c27b775"),M=n("f27f5f5885"),P=n("2b19c53d8c"),C=n("16d2d744e1"),I=n("b4a31815a1"),R=n("617779fa67"),T=n("dd70e9a7f9"),A=n("281cbdced7"),D=n.n(A),L=n("82f2dc9440"),N=n.n(L),j=n("d9812f1c6f"),B=n("5fac0349d3"),H=n("8bea2d09d9"),_=n("7a5536c9bf"),F=n.n(_),U=(n("3bf1976a4f"),n("a2a09da1e3"),n("b1e2246d82"),n("22569efd03"),n("382929c8da")),z=n("0a8ecd6412"),W=n("f2c368348d"),G=[M.g.FILL,M.g.BORDER,M.g.CELL_SIZE],K=[M.g[U.a.FONT],M.g.PARAGRAPH,M.g.TEXTBOX],V=[M.g.ALIGN,M.g.LEVEL,M.g.SIZE,M.g.ROTATE,M.g.CELL_SIZE],Y=[].concat(G,K,V),Z=(i={},u()(i,b.d.SHAPE,F()(Y)),u()(i,b.d.GROUP,F()(Y)),u()(i,b.d.IMAGE,[].concat(G,[M.g.PICTURE_OPACITY],V)),u()(i,b.d.CONNECTOR,[M.g.BORDER].concat(V)),u()(i,b.d.TABLE,[].concat(G,K,[M.g.LEVEL,M.g.SIZE])),u()(i,b.d.EMPTY,[M.g.LAYOUT,M.g.LAYOUT_CHANGE,M.g.BACKGROUND,M.g.SLIDE_SIZE,M.g.FILL]),i),J=u()({},b.d.TABLE,[M.g.ROTATE]),q=B.a.t("图片"),X=B.a.t("样式"),Q=B.a.t("文字"),$=function(){function e(t,n,i){var r=this;c()(this,e),u()(this,"formService",void 0),u()(this,"fillFeature",void 0),u()(this,"selectionService",void 0),u()(this,"isDefaultSetting",void 0),u()(this,"operatedItems",[]),u()(this,"rightSideBarManager",void 0),u()(this,"rightSideBarService",void 0),u()(this,"formLabel",void 0),u()(this,"formIndex",void 0),u()(this,"handleItemCollapsed",(function(e){var t,n=e.label,i=e.collapsed;r.isDefaultSetting?r.isDefaultSetting=!1:(t=i?r.fillFeature.tdwDrawerConstMap.foldItem:r.fillFeature.tdwDrawerConstMap.unfoldItem,r.fillFeature.tdwDrawerReport(t,{ver5:n}),-1===r.operatedItems.indexOf(n)&&r.operatedItems.push(n))})),u()(this,"handleLabelCollapse",(function(e){var t,n,i=Object(W.d)(r.selectionService.getSelectedModel()),a=[],o=[];1===i.length?(a=Z[i[0]],o=J[i[0]]):a=[].concat(G,V),null===(t=a)||void 0===t||t.forEach((function(t){-1===r.operatedItems.indexOf(t)&&(r.isDefaultSetting=e,r.formService.setCollapsed(t,!1))})),null===(n=o)||void 0===n||n.forEach((function(t){-1===r.operatedItems.indexOf(t)&&(r.isDefaultSetting=e,r.formService.setCollapsed(t,!0))}))})),u()(this,"changeFormToFormat",(function(e,t,n){var i;if(null!==(i=r.rightSideBarManager)&&void 0!==i&&i.isAnimationEditorShown||!e){var a,o;if(null!==(a=r.rightSideBarManager)&&void 0!==a&&a.propertyEditorShowAction&&(null===(o=r.rightSideBarManager)||void 0===o||!o.isPropertyEditorShown))return r.formLabel=t,void(r.formIndex=n);var c=0;if(r.formIndex)c=r.formIndex,r.formIndex=void 0,r.formLabel=void 0;else if(r.formLabel){c=r.getLabelIndex(r.formLabel),r.formLabel=void 0}r.formService.changeForm(M.h.FORMAT,c)}})),u()(this,"setBgWithActionWithEditorShown",(function(){var e;null!==(e=r.rightSideBarManager)&&void 0!==e&&e.isPropertyEditorShown&&r.setBgWithAction()})),u()(this,"setBgWithAction",(function(){var e,t,n=null===(e=r.rightSideBarManager)||void 0===e?void 0:e.propertyEditorShowAction;r.fillFeature.setBgWithAction(n),null===(t=r.rightSideBarManager)||void 0===t||t.setPropertyEditorShowAction(0)})),u()(this,"changePropertyTabDoubleClick",(function(e){var t,n=r.selectionService.getSelectedModel(),i=X;(null==n?void 0:n.type)===b.d.CHART&&(i=void 0,t=1),(null==n?void 0:n.type)===b.d.IMAGE&&(i=q),(null==n?void 0:n.type)===b.d.SHAPE&&n.isTextOrPlaceholder&&(i=Q),r.changeFormToFormat(e,i,t)})),this.rightSideBarManager=t,this.rightSideBarService=i,this.selectionService=n,this.formService=w.e.get(I.f),this.fillFeature=w.e.get(P.FillFeature)}return s()(e,[{key:"toggleWithAction",value:function(e,t,n){var i,r,a,o,c,l=this,s=[{name:z.q.SHADOW_TOGGLE,label:M.g[U.a.SHADOW]},{name:z.q.REFLECTION_TOGGLE,label:M.g[U.a.REFLECTION]},{name:z.q.GLOW_TOGGLE,label:M.g[U.a.GLOW]},{name:z.q.SOFTEDGE_TOGGLE,label:M.g[U.a.SOFTEDGE]}],d=(i={},u()(i,z.q.EFFECT_TOGGLE,(function(){s.forEach((function(e){l.formService.setCollapsed(e.label,!1)})),l.changeFormToFormat(e,X)})),u()(i,z.q.TEXT_ADJUST_TOGGLE,(function(){K.forEach((function(e){l.formService.setCollapsed(e,!1)})),l.changeFormToFormat(e,Q)})),u()(i,z.q.IMAGE_TOGGLE,(function(){l.formService.setCollapsed(M.g.PICTURE_OPACITY,!1),l.changeFormToFormat(e,q)})),u()(i,z.q.SHAPE_TOOGLE,(function(){l.changeFormToFormat(e,X)})),u()(i,z.q.FROM_IMAGE_FILL,(function(){l.setBgWithActionWithEditorShown(),l.formService.setCollapsed(M.g.FILL,!1),l.changeFormToFormat(e,X)})),u()(i,z.q.FROM_GRADUAL_FILL,(function(){l.setBgWithActionWithEditorShown(),l.formService.setCollapsed(M.g.FILL,!1),l.changeFormToFormat(e,X)})),u()(i,z.q.DOUBLE_CLICK_TOOGLE,(function(){l.changePropertyTabDoubleClick(e)})),u()(i,z.q.INSERT_FOOTER,(function(){l.formService.setCollapsed(M.g.FOOTER,!1),l.changeFormToFormat(e,X)})),u()(i,z.q.CHART_TOGGLE,(function(){l.changeFormToFormat(e,void 0,1)})),i);(s.forEach((function(t){d[t.name]=function(){s.forEach((function(e){l.formService.setCollapsed(e.label,e.name!==t.name)})),l.changeFormToFormat(e,X)}})),"number"==typeof n&&(null===(r=d[n])||void 0===r||r.call(d)),e||t)&&(null===(c=this.rightSideBarService)||void 0===c||c.hide());null===(a=this.rightSideBarManager)||void 0===a||a.setIsPropertyEditorShown(!0),null===(o=this.rightSideBarManager)||void 0===o||o.setPropertyEditorShowAction(0)}},{key:"getLabelIndex",value:function(e){var t,n;return null===(t=this.formService.getSchema())||void 0===t||null===(n=t.format)||void 0===n?void 0:n.tabs.findIndex((function(t){return t.label===e}))}}]),e}(),ee=n("5115a93a6a"),te=n("ee23d092f6"),ne=n("2ba7871556"),ie=n("086c96a9ce"),re=n("b55230b666"),ae=n("4ea58bcc32"),oe=n("5ee8f9506b"),ce=n("0ece9de9db"),le=function(){function e(){var t=this;c()(this,e),u()(this,"showFormat",void 0),u()(this,"showAnimation",void 0),u()(this,"drawerService",void 0),u()(this,"formService",void 0),u()(this,"fillFeature",void 0),u()(this,"slideFooterFeature",void 0),u()(this,"sizeFeature",void 0),u()(this,"pictureColorFeature",void 0),u()(this,"selectedModel",void 0),u()(this,"rightReaction",void 0),u()(this,"showReaction",void 0),u()(this,"selectedModelReaction",void 0),u()(this,"chartElementsReaction",void 0),u()(this,"animationReaction",void 0),u()(this,"slideChangeReaction",void 0),u()(this,"formItemlistener",void 0),u()(this,"formNumberInputListener",void 0),u()(this,"formNumberInputFocusListener",void 0),u()(this,"rightDrawerOpenListener",void 0),u()(this,"eventEmitter",void 0),u()(this,"snackbarOp",void 0),u()(this,"fillClipBoardReaction",void 0),u()(this,"menuManager",void 0),u()(this,"rightSideBarManager",void 0),u()(this,"formSwitchManager",void 0),u()(this,"selectionService",void 0),u()(this,"masterLayoutEditService",void 0),u()(this,"copyPasteImageService",void 0),u()(this,"drawerStateManager",void 0),u()(this,"drawerInputManager",void 0),u()(this,"userPriviledgeService",void 0),u()(this,"rightSideBarService",void 0),u()(this,"chartService",void 0),u()(this,"tabElement",void 0),u()(this,"handleGroupMultiChange",D()((function(){var e,n,i;if(null===(e=t.drawerInputManager)||void 0===e||!e.isOnlyChangeUI){t.setSchema(!0);var r=null===(n=t.selectionService.getSelectedModel())||void 0===n?void 0:n.type;r&&[b.d.GROUP,b.d.TABLE,b.d.MULTIPLY].includes(r)&&(null===(i=t.drawerInputManager)||void 0===i||i.executeInitPropsCallback())}}))),u()(this,"setDelegate",(function(e){var n=e.menuManager,i=e.rightSideBarManager,r=e.selectionService,a=e.masterLayoutEditService,o=e.userPriviledgeService,c=e.copyPasteImageService,l=e.rightSideBarService;t.menuManager=n,t.rightSideBarManager=i,t.selectionService=r,t.masterLayoutEditService=a,t.copyPasteImageService=c,t.userPriviledgeService=o,t.rightSideBarService=l})),u()(this,"init",(function(e){var n=e.drawerStateManager,i=e.drawerInputManager;t.drawerStateManager=n,t.drawerInputManager=i,t.drawerService=w.e.get(S.c),t.formService=w.e.get(I.f),t.fillFeature=w.e.get(P.FillFeature),t.slideFooterFeature=w.e.get(ee.SlideFooterFeature),t.eventEmitter=w.e.get(E.a),t.sizeFeature=w.e.get(T.SizeFeature),t.sizeFeature.modelOriginalSizeMap=new Map,t.pictureColorFeature=w.e.get(te.PictureColorFeature),t.formSwitchManager=new $(t.rightSideBarManager,t.selectionService,t.rightSideBarService),t.chartService=Object(ae.a)(oe.a),t.registListener(),H.a.init({menuManager:t.menuManager,userPriviledgeService:t.userPriviledgeService,masterLayoutEditService:t.masterLayoutEditService,rightSideBarManager:t.rightSideBarManager})})),u()(this,"changeToolbarTab",(function(e){var t=w.e.get(O.a).get(k.a.RibbonActiveTab).value,n=ce.a[e||""];if(null!=n&&n.length&&n.includes(t)){var i=w.e.get(x.a);null==i||i.changeRibbonTab(t)}})),u()(this,"close",(function(){var e,n,i;null===(e=t.drawerStateManager)||void 0===e||e.handleDrawerHolderVisiable(!1),t.isOtherDrawerOpen()?t.rightDrawerOpenListener=t.eventEmitter.listen(M.l.RIGHT_DRAWER_CLOSED,(function(){var e;t.showRightDrawer(!1),null===(e=t.rightDrawerOpenListener)||void 0===e||e.unsubscribe()})):(null===(n=t.rightSideBarManager)||void 0===n||n.setIsPropertyEditorShown(!1),null===(i=t.rightSideBarManager)||void 0===i||i.setIsAnimationEditorShown(!1))})),u()(this,"handleShowPropertyDrawer",(function(){var e;if(null===(e=t.rightSideBarManager)||void 0===e?void 0:e.isPropertyEditorShown){var n,i;if(t.setSchema(),t.formSwitchManager.changeFormToFormat(t.showFormat),null===(n=t.rightSideBarManager)||void 0===n||n.setIsAnimationEditorShown(!1),t.formSwitchManager.handleLabelCollapse(),null===(i=t.drawerInputManager)||void 0===i||i.executeInitPropsCallback(),t.showFormat)return void t.closeRightSideBar();t.registPropertyDrawerListener(),t.closeRightSideBarWhenDrawerOpen(),t.reportDrawerOpen(),t.changeShowState(M.h.FORMAT),t.showRightDrawer()}else t.handleCloseDrawer(M.h.FORMAT),t.removePropertyDrawerListener()})),u()(this,"handleShowAnimationDrawer",(function(){var e;if(null===(e=t.rightSideBarManager)||void 0===e?void 0:e.isAnimationEditorShown){var n,i;if(null===(n=t.rightSideBarManager)||void 0===n||n.setIsPropertyEditorShown(!1),null===(i=t.selectionService.currentSlide)||void 0===i||i.convertAnimDataSdkToUi(),t.showAnimation)return void t.closeRightSideBar();t.formService.changeForm(M.h.ANIMATION),t.closeRightSideBarWhenDrawerOpen(),t.changeShowState(M.h.ANIMATION),t.showRightDrawer()}else t.handleCloseDrawer(M.h.ANIMATION)})),u()(this,"handleCloseDrawer",(function(e){var n,i;t.changeShowDetailState(e,!1);var r=null===(n=t.rightSideBarManager)||void 0===n?void 0:n.isAnimationEditorShown;(null===(i=t.rightSideBarManager)||void 0===i?void 0:i.isPropertyEditorShown)||r||window.dispatchEvent(new Event("resize"))})),u()(this,"closeRightSideBarWhenDrawerOpen",(function(){var e;t.closeRightSideBar(),null===(e=t.rightSideBarManager)||void 0===e||e.setIsSelectWindowShown(!1)})),u()(this,"reportDrawerOpen",(function(){var e=t.selectionService.getSelectedModel();t.report(e)})),u()(this,"showRightDrawer",(function(){var e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.drawerService.showRightDrawer({name:M.b.SLIDE_PROPERTY_DRAWER,content:p.a.createElement(C.a,null),showCloseButton:!0,onClose:t.close,style:{height:R.DRAWER_HEIGHT,paddingTop:0}}),null===(e=t.drawerStateManager)||void 0===e||e.handleDrawerHolderVisiable(!0),n&&t.fillFeature.tdwDrawerReport(t.fillFeature.tdwDrawerConstMap.drawerOpen)})),u()(this,"setBgWithActionWithEditorShown",(function(){var e;null!==(e=t.rightSideBarManager)&&void 0!==e&&e.isPropertyEditorShown&&t.setBgWithAction()})),u()(this,"setBgWithAction",(function(){var e,n,i=null===(e=t.rightSideBarManager)||void 0===e?void 0:e.propertyEditorShowAction;t.fillFeature.setBgWithAction(i),null===(n=t.rightSideBarManager)||void 0===n||n.setPropertyEditorShowAction(0)})),u()(this,"closeRightSideBar",(function(){var e;null===(e=t.rightSideBarService)||void 0===e||e.hide()})),u()(this,"registPropertyDrawerListener",(function(){t.getImageBgFromClipBoardReaction().then((function(e){t.fillClipBoardReaction=e})),t.formItemlistener=t.eventEmitter.listen(M.i,t.formSwitchManager.handleItemCollapsed),t.slideChangeReaction=Object(g.r)((function(){return t.selectionService.currentSlide}),(function(){var e;null===(e=t.drawerInputManager)||void 0===e||e.executeInitPropsCallback(M.j.FILL),t.slideFooterFeature.updateInputStateOnChangePage(),t.formService.$forceUpdate()})),t.menuManager.event.on(re.a.REFRESH_MENU_VALUES_VALUES,t.handleGroupMultiChange),t.formNumberInputListener=t.eventEmitter.listen(M.l.FORM_NUMBER_INPUT_BLUR,t.handleFormNumberInputBlur),t.formNumberInputFocusListener=t.eventEmitter.listen(M.l.FORM_NUMBER_INPUT_FOCUS,t.handleFormNumberInputFocus)})),u()(this,"removePropertyDrawerListener",(function(){var e,n,i,r,a,o;null===(e=t.formItemlistener)||void 0===e||e.unsubscribe(),t.formItemlistener=void 0,null===(n=t.fillClipBoardReaction)||void 0===n||n.call(t),null===(i=t.slideChangeReaction)||void 0===i||i.call(t),t.menuManager.event.off(re.a.REFRESH_MENU_VALUES_VALUES,t.handleGroupMultiChange),null===(r=t.formNumberInputListener)||void 0===r||r.unsubscribe(),t.formNumberInputListener=void 0,null===(a=t.formNumberInputFocusListener)||void 0===a||a.unsubscribe(),t.formNumberInputFocusListener=void 0,null===(o=t.rightDrawerOpenListener)||void 0===o||o.unsubscribe(),t.rightDrawerOpenListener=void 0})),u()(this,"handleFormNumberInputBlur",(function(){var e,n;null===(e=t.drawerInputManager)||void 0===e||e.setInputFocus(!1),null===(n=t.tabElement)||void 0===n||n.removeEventListener("keydown",t.handleInputEnter)})),u()(this,"handleFormNumberInputFocus",(function(){var e,n,i=t.selectionService.getSelectedModel();if((null==i?void 0:i.type)===b.d.CHART){var r,a=t.chartService.getSelectedElementModel(i);null===(r=t.drawerInputManager)||void 0===r||r.setInputFocus(!0,a)}else{var o;null===(o=t.drawerInputManager)||void 0===o||o.setInputFocus(!0)}t.tabElement=null===(e=document.getElementsByClassName("dui-tabs-content"))||void 0===e?void 0:e[0],null===(n=t.tabElement)||void 0===n||n.addEventListener("keydown",t.handleInputEnter)})),u()(this,"handleInputEnter",(function(e){var n;13!==e.keyCode&&13!==e.which||"INPUT"!==e.target.tagName||(e.preventDefault(),e.target.select(),null===(n=t.drawerInputManager)||void 0===n||n.forceUpdateInput())})),u()(this,"updateObserverForSelectedModel",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.removeObserverForSelectedModel(t.selectedModel),e&&(t.selectedModel=t.selectionService.getSelectedModel(),t.addObserverForSelectedModel(t.selectedModel))})),u()(this,"changeShowDetailState",(function(e,n){e===M.h.FORMAT?t.showFormat=n:t.showAnimation=n})),u()(this,"initDrawerInputStateAfterModelChanged",(function(e){var n,i;if(null===(n=t.drawerInputManager)||void 0===n||n.updateCurrentModel(e),null!==(i=t.rightSideBarManager)&&void 0!==i&&i.isPropertyEditorShown){var r,a,o=document.activeElement;if(null!=o&&o.className.includes("number-input_number-input__"))null===(r=(a=o).blur)||void 0===r||r.call(a)}})),u()(this,"updateModelOriginSizeMap",(function(e){var n=e.getFrame().getWidth(),i=e.getFrame().getHeight();t.sizeFeature.modelOriginalSizeMap.set(e.key,{width:n,height:i})})),u()(this,"getImageBgFromClipBoardReaction",a()(f.a.mark((function e(){var n,i,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=t.copyPasteImageService)||void 0===n?void 0:n.promise();case 2:return i=e.sent,r=(null!=i?i:{}).ImageEditManager,a=null==r?void 0:r.getInstance(),e.abrupt("return",Object(g.r)((function(){return null==a?void 0:a.clipDataWaiting}),(function(e){t.handleClipDataWaiting(e)})));case 6:case"end":return e.stop()}}),e)})))),u()(this,"isOtherDrawerOpen",(function(){var e;return(null===(e=t.rightSideBarManager)||void 0===e?void 0:e.isPropertyEditorShown)&&!t.drawerService.isRightOpening(M.b.SLIDE_PROPERTY_DRAWER)&&t.drawerService.isRightOpening()})),u()(this,"setSchema",(function(e){var n=t.selectionService.getSelectedModel(),i=!1,r=-1!==t.formSwitchManager.getLabelIndex(q),a=null==n?void 0:n.type;if(a===b.d.SHAPE)i=n.getBackgroundFill().getFillType()===ne.b.ImageFill?!r:r;else if(e&&[b.d.MULTIPLY,b.d.GROUP].includes(a)){i=1===Object(ie.b)(n).length?!r:r}i&&H.a.setFormSchema(n)}))}var t;return s()(e,[{key:"registListener",value:function(){var e=this;this.rightReaction=Object(g.r)((function(){var t;return null===(t=e.rightSideBarManager)||void 0===t?void 0:t.isPropertyEditorShown}),(function(t){var n;(e.updateObserverForSelectedModel(t),t)?H.a.setFormSchema(e.selectionService.getSelectedModel()):null===(n=e.drawerStateManager)||void 0===n||n.closeRightDrawer(M.b.SLIDE_PROPERTY_DRAWER);e.handleShowPropertyDrawer()})),this.animationReaction=Object(g.r)((function(){var t;return null===(t=e.rightSideBarManager)||void 0===t?void 0:t.isAnimationEditorShown}),(function(t){var n,i;t||(null===(i=e.drawerStateManager)||void 0===i||i.closeRightDrawer(M.b.ANIMATION_RIGHT_DRAWER));null===(n=e.drawerStateManager)||void 0===n||n.resetSelectWindowActions(),e.handleShowAnimationDrawer()})),this.showReaction=Object(g.r)((function(){var t;return null===(t=e.rightSideBarManager)||void 0===t?void 0:t.propertyEditorShowAction}),(function(t){0!==t&&(e.isOtherDrawerOpen()?(e.formSwitchManager.toggleWithAction(!1,e.showAnimation,t),e.showRightDrawer(!1)):e.formSwitchManager.toggleWithAction(e.showFormat,e.showAnimation,t))})),this.selectedModelReaction=Object(g.r)((function(){return{selectedModel:e.selectionService.getSelectedModel()}}),(function(t){var n,i,r=t.selectedModel;if(e.changeToolbarTab(null==r?void 0:r.type),e.initDrawerInputStateAfterModelChanged(r),e.pictureColorFeature.clearRecolorCache(),e.initModelOriginalSize(r),null!==(n=e.rightSideBarManager)&&void 0!==n&&n.isPropertyEditorShown||null!=e&&null!==(i=e.masterLayoutEditService)&&void 0!==i&&i.isMasterEditType){var a;if((null==r?void 0:r.type)===b.d.CHART&&null!==(a=r.selectedElement)&&void 0!==a&&a.id)return;e.initDrawerData(),H.a.setFormSchema(r)}})),this.chartElementsReaction=Object(g.r)((function(){return e.selectionService.getSelectedModel().selectedElement}),(function(){var t;if(null!==(t=e.rightSideBarManager)&&void 0!==t&&t.isPropertyEditorShown){var n,i=e.selectionService.getSelectedModel();if((null==i?void 0:i.type)===b.d.CHART)H.a.setFormSchema(i),null!==(n=i.selectedElement)&&void 0!==n&&n.id&&e.initDrawerData()}})),this.selectedModelReaction=Object(g.r)((function(){var t;return{isMasterEditType:null==e||null===(t=e.masterLayoutEditService)||void 0===t?void 0:t.isMasterEditType}}),(function(){var t;H.a.setFormSchema(e.selectionService.getSelectedModel()),null===(t=e.drawerStateManager)||void 0===t||t.closeRightDrawerDirectly([M.b.SLIDE_PROPERTY_DRAWER])}))}},{key:"removeListener",value:function(){var e,t,n,i,r;null===(e=this.rightReaction)||void 0===e||e.call(this),null===(t=this.animationReaction)||void 0===t||t.call(this),null===(n=this.showReaction)||void 0===n||n.call(this),null===(i=this.selectedModelReaction)||void 0===i||i.call(this),null===(r=this.chartElementsReaction)||void 0===r||r.call(this)}},{key:"changeShowState",value:function(e){this.changeShowDetailState(e,!0),window.dispatchEvent(new Event("resize")),this.setBgWithActionWithEditorShown()}},{key:"addObserverForSelectedModel",value:function(e){null!=e&&e.changeSetEngine&&e.changeSetEngine.addChangesetObserver(this.handleShowPropertyDrawer)}},{key:"removeObserverForSelectedModel",value:function(e){null!=e&&e.changeSetEngine&&e.changeSetEngine.removeChangesetObserver(this.handleShowPropertyDrawer)}},{key:"report",value:function(e){var t;switch(e.type){case b.d.EMPTY:t=m.b.BACKGROUD_UPV;break;case b.d.SHAPE:t=m.b.SHAPE_UPV;break;case b.d.IMAGE:t=m.b.PIC_UPV}t&&Object(y.c)({opername:m.e.DOC_PPT,module:m.d.PC_SIDE_BAR,action:t})}},{key:"initDrawerData",value:function(){var e;this.updateObserverForSelectedModel(),null===(e=this.drawerInputManager)||void 0===e||e.executeInitPropsCallback(),this.formSwitchManager.handleLabelCollapse(!0),this.sizeFeature.initBestPlayScale()}},{key:"initModelOriginalSize",value:function(e){var t=this;if((null==e?void 0:e.type)===b.d.MULTIPLY)e.selectedModels.forEach((function(e){t.updateModelOriginSizeMap(e)}));else if((null==e?void 0:e.type)===b.d.GROUP){var n=e;n.isRootGroup&&this.updateModelOriginSizeMap(n),n.children.forEach((function(e){t.updateModelOriginSizeMap(e)}))}else{if("function"!=typeof e.getFrame)return;this.updateModelOriginSizeMap(e)}}},{key:"handleClipDataWaiting",value:(t=a()(f.a.mark((function e(t){var n,i,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.copyPasteImageService)||void 0===n?void 0:n.promise();case 2:if(i=e.sent,r=(null!=i?i:{}).ImageEditManager,1!==(null==(a=null==r?void 0:r.getInstance())?void 0:a.imageReplaceAction)){e.next=7;break}return e.abrupt("return");case 7:t?this.snackbarOp=N.a.show({message:j.a.isMac?B.a.t("请使用 Cmd+V 填充该图片"):B.a.t("请使用 Ctrl+V 填充该图片"),duration:3e3}):this.snackbarOp&&(this.snackbarOp.close(),this.snackbarOp=null);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.default=le},"16635419e4":function(e,t,n){"use strict";n.r(t),n.d(t,"NoteViewMediaSyncManager",(function(){return p}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("8ee19818c4"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("7af4d80efc")),d=n("2c7ea59c19"),u=n("fed003a03b"),h=n("0cbec907c5");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(){function e(t){var n=this;r()(this,e),l()(this,"serviceProxy",void 0),l()(this,"injectable",void 0),l()(this,"initServiceProxy",(function(e){n.serviceProxy=e})),l()(this,"attachMediaEvent",(function(e,t,i){n.injectable.attachMediaEvent(e,t,i)||n.serviceProxy&&Object(u.o)(null==e?void 0:e.on)&&new Map([[s.a.PLAY,h.o.VIDEO_PLAYING],[s.a.PAUSE,h.o.VIDEO_PAUSE],[s.a.SPEED,h.o.VIDEO_RATE_CHANGE]]).forEach((function(i,r){e.on(i,(function(i){var a=i.target,o={cmd:r,mediaId:t,playtime:a.playtime};r===s.a.SPEED&&(o=v(v({},o),{},{speed:a.playbackRate})),e.isPassiveTrigger?e.isPassiveTrigger=!1:n.serviceProxy.syncVideoState(o)}))}))})),l()(this,"syncVideoState",(function(e){var t=d.a.findMediaById(e.mediaId)||{},i=t.mediaInstance,r=t.pictureModelKey;r&&(d.a.updateElementKey(r),n.handleMediaCmd(i,e,r))})),l()(this,"handleMediaCmd",(function(e,t,i){var r;e&&(e.isPassiveTrigger=!0);var a=t.cmd,o=t.playtime,c=t.speed;null===(r=new Map([[s.a.PLAY,function(){return n.playHandler(e,i,o)}],[s.a.PAUSE,function(){return n.pauseHandler(e)}],[s.a.SPEED,function(){return n.speedHandler(e,c)}]]).get(a))||void 0===r||r()})),this.injectable=t}return o()(e,[{key:"destroy",value:function(){var e;null===(e=this.serviceProxy)||void 0===e||e.destory(),this.serviceProxy=null}},{key:"playHandler",value:function(e,t,n){e?(e.seek(null!=n?n:0),e.play()):d.a.playVideo(t)}},{key:"pauseHandler",value:function(e){e&&e.pause()}},{key:"speedHandler",value:function(e,t){e&&(e.playbackRate=null!=t?t:1)}}]),e}()},"17f44be5bb":function(e,t,n){"use strict";n.r(t),n.d(t,"RightMenuManager",(function(){return O}));var i=n("14502724a6"),r=n.n(i),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("8ee19818c4"),n("6e20b6a7d8"),n("963f2eaace"),n("b1e2246d82"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287"),n("69084d01d3")),h=n.n(u),f=n("5163b7a42c"),v=n("7369992cf0"),p=n("382929c8da"),g=n("ea3a38d9d4"),b=n("f7ce27fc96"),m=n("08062910eb"),y=n("e0e8dd9366"),w=n("7fcf08f07a");function S(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw a}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var O=function(){function e(){o()(this,e),d()(this,"menuMap",new Map),d()(this,"disableHide",!1),d()(this,"lastConfig",null),d()(this,"menuManager",void 0),d()(this,"selectionService",void 0)}return l()(e,[{key:"setServicesDelegate",value:function(e){!this.menuManager&&e.menuManager&&(this.menuManager=e.menuManager),!this.selectionService&&e.selectionService&&(this.selectionService=e.selectionService)}},{key:"showMenu",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,a=this.menuMap;this.lastConfig={modelType:e,data:t,disableIds:n,config:i,onMenuItemClickCallBack:r},a.forEach((function(t,n){n!==e&&t.hide()}));var o=a.get(e),c=function(e){r&&r(g.a.POP_MENU,e)};if(!o){var l="right-menu-id-".concat(e);i&&(i.id=l),o=f.a.createMenu(null,i,c),a.set(e,o)}o.updateMenuData(t),o.clearAllDisableState(),n&&n instanceof Array&&o.setDisableWithIds(n.map((function(e){return e.id}))),e===y.d.EMPTY&&(i.selectable=!0),o.show(i,c),this.setCustomElement(o,e),this.setSelectedElement(o)}},{key:"setSelectedElement",value:function(e){var t,n,i,r,a,o,c,l,s,d,u,h,f,v,g,b,m,y,w,S;null!==(t=this.menuManager)&&void 0!==t&&null!==(n=t.guidesManager)&&void 0!==n&&n.displayGuides?null==e||null===(u=e.setSelectedWithId)||void 0===u||u.call(e,p.a.DISPLAY_GUIDES):null==e||null===(h=e.setUnSelectedWithId)||void 0===h||h.call(e,p.a.DISPLAY_GUIDES);null!==(i=this.menuManager)&&void 0!==i&&null!==(r=i.snapLineService)&&void 0!==r&&r.enableState?null==e||null===(f=e.setSelectedWithId)||void 0===f||f.call(e,p.a.TOGGLE_SNAP_LINE):null==e||null===(v=e.setUnSelectedWithId)||void 0===v||v.call(e,p.a.TOGGLE_SNAP_LINE);null!==(a=this.menuManager)&&void 0!==a&&null!==(o=a.textRulerManager)&&void 0!==o&&o.displayRuler?null==e||null===(g=e.setSelectedWithId)||void 0===g||g.call(e,p.a.DISPLAY_TEXT_RULER):null==e||null===(b=e.setUnSelectedWithId)||void 0===b||b.call(e,p.a.DISPLAY_TEXT_RULER);null!==(c=this.menuManager)&&void 0!==c&&null!==(l=c.gridLineManager)&&void 0!==l&&l.displayGridLine?null==e||null===(m=e.setSelectedWithId)||void 0===m||m.call(e,p.a.DISPLAY_GRID_LINE):null==e||null===(y=e.setUnSelectedWithId)||void 0===y||y.call(e,p.a.DISPLAY_GRID_LINE);null!==(s=this.menuManager)&&void 0!==s&&null!==(d=s.gridLineManager)&&void 0!==d&&d.isGridAlign?null==e||null===(w=e.setSelectedWithId)||void 0===w||w.call(e,p.a.GRID_LINE_ALIGN):null==e||null===(S=e.setUnSelectedWithId)||void 0===S||S.call(e,p.a.GRID_LINE_ALIGN)}},{key:"setCustomElement",value:function(e,t){var n=this;e.hasMenuId(p.a.TAILOR_PIC_SELECT_SHAPE)&&e.setCustomElement(p.a.TAILOR_PIC_SELECT_SHAPE,h.a.createElement(v.b,{hideMenu:function(){return n.hideMenu(t)},cropPicker:!0})),e.hasMenuId(p.a.GUIDE_COLOR_PANEL)&&e.setCustomElement(p.a.GUIDE_COLOR_PANEL,h.a.createElement(m.d,{menuManager:this.menuManager})),e.hasMenuId(p.a.MODIFY_CHART_LAYOUT_CONTENT)&&e.setCustomElement(p.a.MODIFY_CHART_LAYOUT_CONTENT,h.a.createElement(b.a,{hideMenu:function(){return n.hideMenu(t)},menuManager:this.menuManager,selectionService:this.selectionService})),this.setTableCustomMenuItem(e)}},{key:"setTableCustomMenuItem",value:function(e){e.hasMenuId(p.a.INSERT_ROW_TOP)&&e.setClickableCustomElement(p.a.INSERT_ROW_TOP,h.a.createElement(w.a,{type:p.a.INSERT_ROW_TOP,menuManager:this.menuManager})),e.hasMenuId(p.a.INSERT_ROW_BOTTOM)&&e.setClickableCustomElement(p.a.INSERT_ROW_BOTTOM,h.a.createElement(w.a,{type:p.a.INSERT_ROW_BOTTOM,menuManager:this.menuManager})),e.hasMenuId(p.a.INSERT_COL_LEFT)&&e.setClickableCustomElement(p.a.INSERT_COL_LEFT,h.a.createElement(w.a,{type:p.a.INSERT_COL_LEFT,menuManager:this.menuManager})),e.hasMenuId(p.a.INSERT_COL_RIGHT)&&e.setClickableCustomElement(p.a.INSERT_COL_RIGHT,h.a.createElement(w.a,{type:p.a.INSERT_COL_RIGHT,menuManager:this.menuManager}))}},{key:"hideMenu",value:function(e){var t=this.menuMap.get(e);t&&t.hide(),this.lastConfig=null}},{key:"hideAllMenu",value:function(){if(this.disableHide)this.disableHide=!1;else{var e,t=S(this.menuMap);try{for(t.s();!(e=t.n()).done;){var n=r()(e.value,2),i=n[0],a=n[1];console.log("key|value=",i,a),a&&a.hide()}}catch(e){t.e(e)}finally{t.f()}this.lastConfig=null}}},{key:"disableHideAll",value:function(){this.disableHide=!0}},{key:"RemoveMenu",value:function(e){var t=this.menuMap.get(e);t&&(this.menuMap.delete(e),t.remove()),this.lastConfig=null}}]),e}()},"24ff1e956b":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var i=n("c92b994f13"),r=i(n("ea2fc588ec")),a=i(n("c938aa3d7f"));t.push([e.i,".index-select-window-1HJ2G{background-color:#fcfcfc;display:flex;overflow:hidden;flex-direction:column;order:5;z-index:20;border-left:1px solid rgba(0,0,0,.06);-webkit-user-select:all;-ms-user-select:all;user-select:all}.index-select-window-1HJ2G .index-select-window-header-1qf4i{display:flex;align-items:center;height:64px;border-bottom:1px solid rgba(0,0,0,.06);padding:22px 20px}.index-select-window-1HJ2G .index-select-window-header-1qf4i .index-select-window-header-title-3mZaA{flex:1 1;font-size:14px;color:rgba(0,0,0,.56);line-height:20px;padding-right:10px}.index-select-window-1HJ2G .index-select-window-header-1qf4i .index-select-window-header-close-2sBd6{width:20px;height:20px;padding:4px;-webkit-user-drag:none}.index-select-window-1HJ2G .index-select-window-header-1qf4i .index-select-window-header-close-2sBd6:hover{background:#f5f5f5}.index-select-window-1HJ2G .index-select-window-toolbar-1hWiQ{padding:10px 20px}.index-select-window-1HJ2G .index-select-window-toolbar-1hWiQ .index-hidden-all-1-9Lv{margin-left:10px}.index-select-window-1HJ2G .index-select-window-content-2FlUu{position:relative;height:100%;overflow-x:hidden;padding:10px 0}.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz{font-size:12px;padding:4px 2px 0 13px}.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-visible-icon-3hAMQ{background-image:url("+r+")}.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-hidden-icon-TRbnE,.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-visible-icon-3hAMQ{position:absolute;right:-1px;top:0;display:inline-block;width:25px;height:24px;padding-right:5px;cursor:default;z-index:99;background-color:#fcfcfc;background-position:left 1px;background-size:20px 20px;background-repeat:no-repeat;transition:background-color .3s}.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-hidden-icon-TRbnE{background-image:url("+a+")}.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-disabled-icon-3ZxIw,.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-disabled-icon-cursor-mlVfI{cursor:default}.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP{padding-right:24px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:default}.index-select-window-1HJ2G .index-select-window-content-2FlUu .index-select-window-tree-1XZHz .index-tree-item-title-disable-3w2be{opacity:.3;cursor:default}.index-select-window-drawer-10zwJ{background-color:var(--bg-lv3-default);height:100%;border:none}.index-select-window-drawer-10zwJ .index-btn-2PprC{width:72px;height:28px;border:1px solid var(--border-strong);background-color:var(--bg-lv3-default);cursor:default;font-size:12px;color:var(--text-ultrastrong);font-family:PingFang SC;font-style:normal;font-weight:400}.index-select-window-drawer-10zwJ .index-btn-2PprC:hover{background-color:var(--feedback-hover)}.index-select-window-drawer-10zwJ .index-btn-2PprC:active{background-color:var(--feedback-active)}.index-select-window-drawer-10zwJ .index-select-window-header-drawer-11u5F{padding:20px 16px}.index-select-window-drawer-10zwJ .index-select-window-header-drawer-11u5F .index-select-window-header-title-3mZaA{font-size:16px;line-height:24px;font-weight:500;font-style:normal;font-family:PingFang SC;color:var(--text-ultrastrong);pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.index-select-window-drawer-10zwJ .index-select-window-header-drawer-11u5F .index-select-window-header-close-2sBd6{width:24px;height:24px;padding:7px;color:var(--icon-strong)}.index-select-window-drawer-10zwJ .index-select-window-header-drawer-11u5F .index-select-window-header-close-2sBd6:hover{background-color:var(--feedback-hover)}.index-select-window-drawer-10zwJ .index-select-window-header-drawer-11u5F .index-select-window-header-close-2sBd6:active{background-color:var(--feedback-active)}.index-select-window-drawer-10zwJ .index-select-window-toolbar-1hWiQ{padding:16px 16px 8px}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb{position:relative;padding:8px 0 0;height:100%;overflow-x:hidden}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz{padding:0 16px}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-right:20px;height:28px;line-height:28px;font-size:12px;color:var(--text-ultrastrong);font-family:PingFang SC;font-style:normal;font-weight:400}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-tree-item-title-ZBX0e{color:var(--text-strong);font-size:12px;color:var(--text-ultrastrong);font-family:PingFang SC;font-style:normal;font-weight:400}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-tree-item-title-text-1SJ4u{-webkit-user-select:none;-ms-user-select:none;user-select:none}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-tree-item-title-text-hidden-3g3c-{opacity:.4;cursor:default}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-visible-icon-3hAMQ{background-image:url("+r+");position:absolute;right:0;top:0;width:20px;height:20px;margin:4px 0;border-radius:2px;background-repeat:no-repeat;background-size:20px 20px;cursor:default}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-visible-icon-3hAMQ:hover{background-color:var(--feedback-hover)}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-visible-icon-3hAMQ:active{background-color:var(--feedback-active)}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-hidden-icon-TRbnE{background-image:url("+a+");position:absolute;right:0;top:0;width:20px;height:20px;margin:4px 0;border-radius:2px;background-repeat:no-repeat;background-size:20px 20px;cursor:default}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-hidden-icon-TRbnE:hover{background-color:var(--feedback-hover)}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-hidden-icon-TRbnE:active{background-color:var(--feedback-active)}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-disabled-icon-3ZxIw,.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-container-1HViP .index-disabled-icon-cursor-mlVfI{cursor:default;pointer-events:none}.index-select-window-drawer-10zwJ .index-select-window-content-drawer-3Egtb .index-select-window-tree-1XZHz .index-tree-item-title-disable-3w2be{opacity:.4;cursor:default}.index-dui-tree-list-zIWbM{background-color:#fff}",""]),t.locals={"select-window":"index-select-window-1HJ2G","select-window-header":"index-select-window-header-1qf4i","select-window-header-title":"index-select-window-header-title-3mZaA","select-window-header-close":"index-select-window-header-close-2sBd6","select-window-toolbar":"index-select-window-toolbar-1hWiQ","hidden-all":"index-hidden-all-1-9Lv","select-window-content":"index-select-window-content-2FlUu","select-window-tree":"index-select-window-tree-1XZHz","visible-icon":"index-visible-icon-3hAMQ","hidden-icon":"index-hidden-icon-TRbnE","disabled-icon":"index-disabled-icon-3ZxIw","disabled-icon-cursor":"index-disabled-icon-cursor-mlVfI","tree-item-title-container":"index-tree-item-title-container-1HViP","tree-item-title-disable":"index-tree-item-title-disable-3w2be","select-window-drawer":"index-select-window-drawer-10zwJ",btn:"index-btn-2PprC","select-window-header-drawer":"index-select-window-header-drawer-11u5F","select-window-content-drawer":"index-select-window-content-drawer-3Egtb","tree-item-title":"index-tree-item-title-ZBX0e","tree-item-title-text":"index-tree-item-title-text-1SJ4u","tree-item-title-text-hidden":"index-tree-item-title-text-hidden-3g3c-","dui-tree-list":"index-dui-tree-list-zIWbM"}},"2c7ea59c19":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=(n("75563bc376"),n("d00a79b9b7")),d=n("e0e8dd9366"),u=n("862b984676"),h=function(){function e(){r()(this,e)}return o()(e,null,[{key:"setMediaManagerDelegate",value:function(t){e.mediaManager||(e.mediaManager=t)}},{key:"setPresentationRefDelegate",value:function(t){e.presentationRef||(e.presentationRef=t)}},{key:"findMediaById",value:function(t){var n=this.getCurrentSlideModel();if(!n)return null;var i=t,r=n.children.find((function(e){return e.id===i&&e.type===d.d.IMAGE}));if(!r)return null;var a=r.key,o=e.mediaManager;return{mediaInstance:null==o?void 0:o.getVideoInstanceByRegion(a,u.a.PLAYER),pictureModelKey:a}}},{key:"updateElementKey",value:function(t){var n=e.mediaManager;null==n||n.updateElementKeyByRegion(t,u.a.PLAYER)}},{key:"playVideo",value:function(t){e.mediaManager.playVideoByRegion(t,u.a.PLAYER)}},{key:"getCurrentSlideModel",value:function(){var t=s.default.getState().control,n=e.presentationRef;return null==n?void 0:n.children[t.currentPage]}}]),e}();l()(h,"presentationRef",void 0),l()(h,"mediaManager",void 0)},"311718eba2":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".unit-unselectable-20RPz{-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.unit-para-panel-item-unit-2SX5T{display:inline-block;margin-left:2px}",""]),t.locals={unselectable:"unit-unselectable-20RPz","para-panel-item-unit":"unit-para-panel-item-unit-2SX5T"}},"32be28cf0d":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".style-statusContainer-3M-LT{padding:7px 12px;font-size:14px;position:fixed;z-index:10000;background-color:rgba(0,0,0,.8);border-radius:6px;color:#fff;width:auto;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}",""]),t.locals={statusContainer:"style-statusContainer-3M-LT"}},"3f2e8617de":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ee}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("547611bd96"),l=n.n(c),s=n("bd29e2df90"),d=n.n(s),u=n("ab5eb40518"),h=n.n(u),f=n("1b4cdd6a36"),v=n.n(f),p=n("85d0a7609b"),g=n.n(p),b=(n("8a35b54c1d"),n("b8217400dc"),n("e6f68cdf2e"),n("9e6e95de85")),m=(n("3bf1976a4f"),n("375d29afab")),y=n("0c08a07256");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var S=function(e){d()(n,e);var t=w(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),g()(l()(e),"finishSave",0),g()(l()(e),"initialBottom",0),g()(l()(e),"isEditing",!1),g()(l()(e),"isKeyBoardOn",!1),g()(l()(e),"isOnline",void 0),g()(l()(e),"keyBoardHeight",0),g()(l()(e),"panelBottom",0),g()(l()(e),"panelTop",0),e}return o()(n,[{key:"initModel",value:function(e,t){var n=(t||{}).isOnline;this.isOnline=navigator.onLine&&n,null!=e&&e.isToolbarKeepAtTop||(this.initialBottom=Object(y.b)())}}]),n}(m.a),E=n("f73791d0a5"),O=n("020899bf26"),k=n("c7530f2183"),x=n("d9812f1c6f"),M=n("f69765df61"),P=n("281cbdced7"),C=n.n(P),I=n("35396118a9"),R=n("b86964b011"),T=n("402eb050f3"),A=n("2a5f3314a4"),D=n("c5cff78be0"),L=n("382929c8da"),N=n("5aa0e40fcc"),j=n("0a8ecd6412"),B=n("7560a8e69a"),H=n("e0e8dd9366"),_=n("3344f1a2e7"),F=n("145eddafd2"),U=n("ec5cae33cb"),z=n("3b886240f1"),W=n("9da6335152"),G=n("d3d31c86eb"),K=n("ea3a38d9d4"),V=n("37091e4240"),Y=n("b55230b666"),Z=n("7264fb5e8f"),J=n("21f6c93a07");function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var $=x.a.isIOS,ee=function(e){d()(n,e);var t=Q(n);function n(e){var i;return r()(this,n),i=t.call(this),g()(l()(i),"services",void 0),g()(l()(i),"softKeyboard",void 0),g()(l()(i),"stopIPadExternalKeyboardChange",void 0),g()(l()(i),"delayUpdateUi",C()((function(){i.updateModel({finishSave:i.model.finishSave+1})}),50,{leading:!1,trailing:!0})),g()(l()(i),"canvasDom",null),g()(l()(i),"canvasDomPreTop","0"),g()(l()(i),"handleImageChange",(function(e){var t,n,r,a,o=null===(t=i.services)||void 0===t?void 0:t.selectionService,c=null===(n=i.services)||void 0===n?void 0:n.uiDataService;if(null!=o&&o.currentSlide){var l=o.currentSlideIndex,s=o.slides,d=(c||{}).presentation;if(e&&0!==e.length){for(var u=[],h=0;h<e.length;h++){var f=e[h],v=Object(_.C)(f.width),p=Object(_.C)(f.height),g=(null==d?void 0:d.props)||{},b=g.slideWidth,m=void 0===b?0:b,y=g.slideHeight,w=void 0===y?0:y,S=v,E=p;if(v>m||p>w){var O=m/v,k=w/p,x=O<k?O:k;S=v*x,E=p*x}var M=(m-S)/2,P=(w-E)/2;f.style={position:"absolute",left:M,top:P,width:S,height:E,bgShape:F.b.rect,opacity:1},u.push(H.d.IMAGE)}var C;if(s[l].addElement(u,e),o.lastMouseDownRegion=U.a.EDITOR,o.selectedSlides.clear(),null!==(r=i.services)&&void 0!==r&&null!==(a=r.mobileToolbarEditManager)&&void 0!==a&&a.editPanelShowState)null===(C=i.services)||void 0===C||C.mobileToolbarEditManager.closeEditPanel();document.getElementById("select_pic_input").value=null}}})),g()(l()(i),"registerEvent",(function(){O.a.SDKDataServices.EventManager.promise().then((function(e){var t=e.socketEvents;t.onChangeToOnline(i.handleOnOffline),t.onChangeToOffline(i.handleOnOffline)})),window.addEventListener("online",i.handleOnOffline),window.addEventListener("offline",i.handleOnOffline)})),g()(l()(i),"removeEvent",(function(){window.removeEventListener("enterEditing",i.handleEnterEditing),window.removeEventListener("exitEditing",i.handleExitEditing),window.removeEventListener("orientationchange",i.handleOrientationchange),window.removeEventListener("online",i.handleOnOffline),window.removeEventListener("offline",i.handleOnOffline),I.b.removeEventListener("scroll",i.handleScroll),I.b.removeEventListener("scroll",i.handleWXScroll)})),g()(l()(i),"handleOnOffline",(function(){i.updateModel({isOnline:navigator.onLine&&i.getSdkOnlineStatus()})})),g()(l()(i),"handleEnterEditing",(function(){var e;if(i.updateModel({isEditing:!0}),null!==(e=i.props)&&void 0!==e&&e.isToolbarKeepAtTop)return i.updateModel({isKeyBoardOn:!0}),void I.b.addEventListener("scroll",i.handleWXScroll);if(x.a.isMobile&&Z.isWebOffice){i.updateModel({isKeyBoardOn:!0,panelTop:j.j});var t,n,r=i.getCanvasDom();if(r)i.canvasDomPreTop=null!==(t=null==r||null===(n=r.style)||void 0===n?void 0:n.top)&&void 0!==t?t:"0",r.style.top="".concat(j.j,"px")}})),g()(l()(i),"handleExitEditing",(function(){var e,t;if(null!==(e=i.services)&&void 0!==e&&null!==(t=e.editorInstanceService)&&void 0!==t&&t.checkEditorIsEditing())i.handleEnterEditing();else if(i.updateModel({isEditing:!1}),x.a.isIOS&&i.handleIOSExit(),x.a.isIPad&&x.a.isSafari&&!Object(R.m)()&&window.scrollTo(0,0),x.a.isIOS&&Z.isWebOffice){i.updateModel({isKeyBoardOn:!1});var n=i.getCanvasDom();n&&(n.style.top=i.canvasDomPreTop)}})),g()(l()(i),"handleScroll",(function(){var e=i.getScrollHeight();i.updateModel({panelBottom:i.model.keyBoardHeight-e})})),g()(l()(i),"handleWXScroll",(function(){var e=i.getScrollHeight();x.a.isIPad&&x.a.isSafari&&!Object(R.m)()&&(e-=63),e<0?e=-1:e>=420&&(e=420),i.model.isEditing||(e=0);var t=e;i.updateModel({panelTop:t})})),g()(l()(i),"handleOrientationchange",(function(){i.updateModel({initialBottom:Object(y.b)()})})),g()(l()(i),"isRealKeyboardEvent",(function(){var e,t;if(null===(e=i.services)||void 0===e||null===(t=e.editorInstanceService)||void 0===t||!t.checkEditorIsEditing())return!1;var n=document.querySelector(".".concat(A.f));return document.activeElement===n})),g()(l()(i),"isNeedRemoveUndoRedo",(function(){return Object(N.c)()&&!x.a.isIPad})),g()(l()(i),"handleTouchStartDefault",(function(e,t){var n;e===L.a.BOLD?n=W.b.M_EDIT_BOLD:e===L.a.ITALIC?n=W.b.M_EDIT_ITALIC:e===L.a.UNDERLINE?n=W.b.M_EDIT_UNDERLINE:e===L.a.DELETELINE?n=W.b.M_EDIT_DELETELINE:e===L.a.FONTSIZE?n=W.b.M_EDIT_FONTSIZE:e===L.a.HORIZONTAL_ALIGN?n=W.b.M_EDIT_HORIZONTAL_ALIGN:e===L.a.ITEMNUMBER?n=W.b.M_EDIT_ITEMNUMBER:e===L.a.DIGITNUMBER&&(n=W.b.M_EDIT_DIGITNUMBER),i.operateTouchStartDefault(e,t,n)})),g()(l()(i),"operateTouchStartDefault",(function(e,t,n){var r,a;n&&Object(G.c)({opername:W.e.DOC_PPT,module:W.d.M_EDIT_FORMAT,action:n});var o=((null===(r=i.services)||void 0===r||null===(a=r.menuManager)||void 0===a?void 0:a.stylePanelMenu())||{}).callback;null==o||o(K.a.TOOLBAR,e,t)})),i.injectable=e,i.softKeyboard=new E.SoftKeyboard,i.stopIPadExternalKeyboardChange=!1,i.registerEvent(),i}return o()(n,[{key:"setViewerServiceDelegates",value:function(e){this.services=X(X({},this.services),e)}},{key:"setEditServiceDelegates",value:function(e){this.services=X(X({},this.services),e)}},{key:"shouldRenderToolBar",value:function(){var e,t,n,i;return(null===(e=this.services)||void 0===e||null===(t=e.noteAreaManager)||void 0===t||!t.isMobileNoteFullScreen)&&!(null!==(n=null===(i=this.injectable)||void 0===i?void 0:i.shouldRenderToolBar())&&void 0!==n&&!n)}},{key:"getToolBarData",value:function(){var e={items:D.a.getGroupListByType(this.model.isKeyBoardOn)},t={items:D.a.getGroupListWithTextEditPanel()},n={items:D.a.getInsertList()},i={items:D.a.getAddonList()};return this.isNeedRemoveUndoRedo()&&(e.items=e.items.filter((function(e){return![L.a.UNDO,L.a.REDO].includes(e.id)}))),{toolbarData:e,editPanelData:t,insertItemData:n,addonItemData:i}}},{key:"getPanelType",value:function(){var e,t=(null===(e=this.services)||void 0===e?void 0:e.mobileToolbarEditManager)||{},n=t.colorPanelType,i=void 0===n?B.a.NONE:n,r=t.editPanelType;return{colorPanelType:i,editPanelType:void 0===r?"":r}}},{key:"getToolbarExtraStyle",value:function(){var e,t=((null===(e=this.services)||void 0===e?void 0:e.mobileToolbarEditManager)||{}).editPanelShowState,n=j.i;t&&(n=Object(B.c)()+j.i+Object(y.c)());var i={height:"".concat(n,"px")};return x.a.isMobile&&Z.isWebOffice&&this.model.isEditing&&(i.top="".concat(this.model.panelTop,"px"),i.bottom="auto"),i}},{key:"getToolbarBottom",value:function(){var e,t,n,i;return i=!this.model.isKeyBoardOn||null!==(e=this.props)&&void 0!==e&&e.isAndroidKeyboardOn?this.model.initialBottom:0===this.model.keyBoardHeight?Object(y.b)():this.model.panelBottom,null!==(t=this.services)&&void 0!==t&&null!==(n=t.mobileToolbarEditManager)&&void 0!==n&&n.editPanelShowState&&(i=0),i>0?i:0}},{key:"setToolbarElement",value:function(e){var t,n;e&&(null===(t=this.services)||void 0===t||null===(n=t.mobileToolbarEditManager)||void 0===n||n.setToolbarElement(e))}},{key:"isInsertPicBtnEnable",value:function(){var e,t,n;if(null===(e=this.services)||void 0===e||null===(t=e.noteAreaManager)||void 0===t?void 0:t.isMobileNoteFullScreen)return!1;var i=null===(n=this.injectable)||void 0===n?void 0:n.isInsertPicBtnEnable();return void 0!==i?i:!!this.model.isOnline}},{key:"getItemSelectedState",value:function(){var e,t;return{note:!(null===(e=this.services)||void 0===e||null===(t=e.noteAreaManager)||void 0===t||!t.show),textEdit:!!this.isEditPanelSelected(B.b.TEXT_EDIT),addEdit:!!this.isEditPanelSelected(B.b.ADD_ADIT),layoutSuggestion:!!this.isEditPanelSelected(B.b.LAYOUT_SUGGESTION)}}},{key:"componentDidMount",value:function(){var e,t,n=this;O.a.SDKDataServices.EventManager.promise().then((function(e){e.mutationEvents.onCommitCommand((function(){return n.delayUpdateUi()}))})),null===(e=this.services)||void 0===e||null===(t=e.menuManager)||void 0===t||t.event.on(Y.a.REFRESH_MENU_VALUES_VALUES,(function(){return n.delayUpdateUi()})),window.addEventListener("enterEditing",this.handleEnterEditing),window.addEventListener("exitEditing",this.handleExitEditing),this.softKeyboard.on("change",(function(e){e.isSupported&&!Z.isWebOffice&&(x.a.isIOS?n.handleIOSKeyboardChange(e):x.a.isAndroid&&(n.isRealKeyboardEvent()&&M.b.setHeight(e.heightOutOfViewport),n.updateModel({keyBoardHeight:e.heightOutOfViewport,panelBottom:0})))})),window.addEventListener("orientationchange",this.handleOrientationchange),Object(G.c)({opername:W.e.DOC_PPT,module:W.d.AUTO_BEAUTIFY,action:W.b.BEAUTIFY_M_VIEW,ver5:1})}},{key:"componentWillReceiveProps",value:function(e){var t=e.isAndroidKeyboardOn;x.a.isAndroid&&this.updateModel({isKeyBoardOn:t})}},{key:"componentWillUnmount",value:function(){this.removeEvent(),this.softKeyboard.dispose()}},{key:"handleMouseDown",value:function(e,t){this.handleTouchStart(e,t)}},{key:"handleTouchStart",value:function(e,t){z.a[e]?z.a[e].call(this):this.handleTouchStartDefault(e,t)}},{key:"createViewModel",value:function(){return new S}},{key:"getInitModelValue",value:function(){return{isOnline:navigator.onLine&&this.getSdkOnlineStatus()}}},{key:"getSdkOnlineStatus",value:function(){var e,t=null===(e=this.injectable)||void 0===e?void 0:e.getSdkOnlineStatus();return void 0!==t?t:k.network.isOnline}},{key:"handleIOSExit",value:function(){var e,t=this;this.stopIPadExternalKeyboardChange&&this.model.keyBoardHeight>0&&(this.stopIPadExternalKeyboardChange=!1,this.handleIOSKeyboardChange({heightInViewport:0})),setTimeout((function(){var e=t.getScrollHeight();window.scrollTo(0,Math.max(e-1,0))}),100),x.a.isIPad||I.b.removeEventListener("scroll",this.handleScroll),null!==(e=this.props)&&void 0!==e&&e.isToolbarKeepAtTop&&I.b.removeEventListener("scroll",this.handleWXScroll)}},{key:"getScrollHeight",value:function(){return I.b.document.documentElement.scrollTop||I.b.document.body.scrollTop||0}},{key:"handleIOSKeyboardChange",value:function(e){var t=this;setTimeout((function(){var n,i,r=t.getScrollHeight(),a=e.heightInViewport||e.heightOutOfViewport;if(M.b.setHeight(a),t.handleIPadExternalKeyboardChange(a),!t.stopIPadExternalKeyboardChange){var o=t.hasScrolled()?a:a-r+Object(y.c)(),c=t.model.isEditing||(null===(n=t.services)||void 0===n||null===(i=n.editorInstanceService)||void 0===i?void 0:i.checkEditorIsEditing());if(c?t.updateModel({isKeyBoardOn:!0,panelBottom:o,keyBoardHeight:a}):t.updateModel({keyBoardHeight:a}),a>0){if(c){var l;V.b.emit(V.a.IOS_KEY_BOARD_SHOW,a);var s=null===(l=t.services)||void 0===l?void 0:l.mobileToolbarEditManager;null!=s&&s.editPanelShowState&&!Object(M.a)()&&s.closeEditPanel()}}else V.b.emit(V.a.IOS_KEY_BOARD_HIDE,a),t.updateModel({panelBottom:0,panelTop:0,isKeyBoardOn:!1})}}),Object(I.a)()?100:0),this.hasScrolled()||I.b.addEventListener("scroll",this.handleScroll)}},{key:"handleIPadExternalKeyboardChange",value:function(e){var t,n;if(T.b.supportEnterprise(T.a.APP_IPAD)&&!(e>69)&&null!==(t=this.services)&&void 0!==t&&null!==(n=t.editorInstanceService)&&void 0!==n&&n.checkEditorIsEditing()){var i=this.getScrollHeight();i>0&&i<=69&&this.handleScroll(),e<69&&(this.stopIPadExternalKeyboardChange=!0)}}},{key:"hasScrolled",value:function(){return!$&&(x.a.isIPad&&!x.a.isTencentDocApp||x.a.isWxMiniProgram||x.a.isQQMiniProgram||x.a.isWeChat||x.a.isWxWork)}},{key:"isEditPanelSelected",value:function(e){var t,n=null===(t=this.services)||void 0===t?void 0:t.mobileToolbarEditManager;return(null==n?void 0:n.editPanelShowState)&&n.editPanelType===e}},{key:"getCanvasDom",value:function(){return this.canvasDom||(this.canvasDom=document.getElementById(J.a.CANVAS)),this.canvasDom}}]),n}(b.a)},"43aebfaa1b":function(e,t,n){"use strict";n.r(t),n.d(t,"MobileFloatStatusManager",(function(){return g}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=n("e792a3169a"),d=n.n(s),u=n("32be28cf0d"),h=n.n(u),f={insert:"head",singleton:!1},v=(d()(h.a,f),h.a.locals||{}),p=10,g=function(){function e(){r()(this,e),l()(this,"statusContainer",void 0)}return o()(e,[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getContainer(),n=e.top,i=void 0===n?0:n,r=e.left,a=void 0===r?0:r,o=e.message,c=void 0===o?"":o,l=e.height,s=void 0===l?34:l,d=e.fixElementSize,u=void 0!==d&&d,h=e.width;t.style.height="".concat(s,"px"),"string"==typeof c?t.innerText=c:t.appendChild(c);var f=t.getBoundingClientRect(),v=f.width,g=f.height,b=u?i-g/2:i,m=u?a-v/2:a;b<p&&(b=p),m<p&&(m=p);var y=document.body.clientWidth;a>y-p-v/2&&(m=y-v-p),t.style.top="".concat(b,"px"),t.style.left="".concat(m,"px"),h&&(t.style.width="".concat(h,"px"))}},{key:"hide",value:function(){this.removeElement()}},{key:"getContainer",value:function(){return this.statusContainer?this.statusContainer:this.createElement()}},{key:"createElement",value:function(){var e=document.createElement("div");return e.className=v.statusContainer,this.statusContainer=e,document.body.appendChild(e),e}},{key:"removeElement",value:function(){this.statusContainer&&(document.body.removeChild(this.statusContainer),this.statusContainer=null)}}]),e}()},"4ede8d4601":function(e,t,n){"use strict";n.r(t),n.d(t,"MobileProduceBackupManager",(function(){return x}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("547611bd96"),o=n.n(a),c=n("bd29e2df90"),l=n.n(c),s=n("ab5eb40518"),d=n.n(s),u=n("1b4cdd6a36"),h=n.n(u),f=n("85d0a7609b"),v=n.n(f),p=(n("3bf1976a4f"),n("a2a09da1e3"),n("1bab7b5fb7"),n("34cd92f77a"),n("4bbb5840d5"),n("8ee19818c4"),n("8bbfaad34f")),g=n("3825cc7c15"),b=n("e1683862d0"),m=n.n(b),y=n("5fac0349d3"),w=n("0e41c725b0"),S=n("020899bf26"),E=n("5ce71228c0"),O=n("915616c11c");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return d()(this,n)}}var x=function(e){l()(n,e);var t=k(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a)),v()(o()(e),"shouldReport",!1),v()(o()(e),"redirectToDoc",(function(e){var t;if(window.isMiniProgram)window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url=".concat(encodeURIComponent(e))});else if("function"==typeof(null===(t=w.e.tdocsUi)||void 0===t?void 0:t.openUrl)){var n;null===(n=w.e.tdocsUi)||void 0===n||n.openUrl({url:e,target:1,needPushReplacement:!1})}else Object(O.a)({url:e,replace:!0,windowName:"_blank"})})),v()(o()(e),"handleCheckBack",(function(){m.a.show({content:y.a.t("已生成并打开副本")});try{var e=Object(g.e)(window.location.href,"newPad"),t=Object(g.e)(e,"newPadType");history.replaceState(null,"",t)}catch(e){var n;null===(n=window.log)||void 0===n||n.err(e)}})),v()(o()(e),"handleCreateDocNew",(function(t){var n=e.getTitle();try{var i;e.setLocalActions("ADD",{domainId:t.doc_id.domain_id,localPadId:t.doc_id.pad_id,padType:null===(i=S.a.DocInfoManager())||void 0===i?void 0:i.padType,title:t.title||y.a.t("副本-{0}",{0:n}),url:t.doc_url,list_item_type:1}),e.singleSnackbar.close()}catch(t){e.singleSnackbar.show({message:y.a.t("生成副本失败，请稍后重试"),type:"error",autoClose:!0})}var r=document.referrer&&-1!==document.referrer.indexOf("//".concat(window.hostname,"/desktop/m/index.html")),a=t.doc_url.replace("/","/");a=a.startsWith("https://")?a:"https:".concat(a),a=Object(g.f)(a,{newPad:1,newPadType:"clone",disableReturnList:r?1:0}),e.redirectToDoc(a)})),v()(o()(e),"setLocalActions",(function(e,t){t.createdDate=+new Date;var n=E.b.getItem(E.a.DOCS_ACTIONS,[]),i={};n.forEach((function(e,t){i["".concat(e.localPadId,"$").concat(e.domainId)]={index:t,value:e}}));var r=i["".concat(t.localPadId,"$").concat(t.domainId)];r?n[r.index]={type:"ADD"===r.value&&"MODIFY"===e?"ADD":e,data:r.value}:n.push({type:"ADD",data:t}),E.b.setItem(E.a.DOCS_ACTIONS,n)})),e}return n}(p.a)},"55ce2a5f80":function(e,t,n){"use strict";n.r(t),n.d(t,"NotifyManager",(function(){return A}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("176815363d"),r=n.n(i),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),h=n.n(u),f=(n("c6244f7705"),n("081c8cafea"),n("b1e2246d82"),n("d9812f1c6f")),v=n("b40469cb12"),p=n("fadf620212"),g=n("d3d31c86eb"),b=n("020899bf26"),m="notify",y="notification-container",w=(n("73b854064b"),n("bd29e2df90")),S=n.n(w),E=n("ab5eb40518"),O=n.n(E),k=n("1b4cdd6a36"),x=n.n(k);function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=x()(e);if(t){var r=x()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return O()(this,n)}}var P=function(e){S()(n,e);var t=M(n);function n(e){var i;return o()(this,n),(i=t.call(this)).notifyManager=e,i}return l()(n,[{key:"name",get:function(){return m}},{key:"show",value:function(){var e=this;this.notifyManager.showNotifyModule(this.DOMNode,(function(){e.showWrapper()}),(function(){e.hideWrapper()}))}}]),n}(n("7faf76450d").a),C=n("37091e4240"),I=n("aba9dcef64");function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(){function e(){var t=this;o()(this,e),d()(this,"notifyNumbers",0),d()(this,"module",null),d()(this,"services",void 0),d()(this,"injectable",void 0);var n=function(e,n){return t.handleNotifyMessage(e,n)};Object(b.b)((function(){return t.getNotifyNumbers()})),b.a.SDKDataServices.EventManager.promise().then((function(e){return e.socketEvents.onReceiveMessage(n)})),document.addEventListener("resetOuterUnreadNumberNoti",(function(e){t.resetNotifyNumbers(e.detail.number)})),C.b.on(C.a.HELP_CENTER_READY_DISPLAY,(function(){var e;null===(e=document.getElementById(y))||void 0===e||e.addEventListener("mousewheel",(function(e){e.stopPropagation()}))})),document.body.addEventListener("click",(function(e){e.target===document.getElementById("notification-dropdown-line")&&(Object(g.c)({opername:"doc_menubar",module:"system_notification_button",action:"click"}),t.show())}))}var t,n,i;return l()(e,[{key:"setServiceDelegates",value:function(e){this.services=T(T({},this.services),e)}},{key:"setInject",value:function(e){this.injectable=e}},{key:"registerRightSideBar",value:function(){this.services.rightSideBarService.registerModule(new P(this))}},{key:"showNotifyModule",value:function(e,t,n){var i,r=this;this.updateNotifyNode(e);var a=null===(i=b.a.ClientVarsService())||void 0===i?void 0:i.getClientVars(),o={from:"slide"};null!=a&&a.isCreator&&(o=T(T({},o),{},{selDocsTab:2})),this.loadNotifyModule((function(){var i;null===(i=r.module)||void 0===i||i.show(T(T({},o),{},{container:e,onCloseCb:function(){null==n||n()}})),null==t||t()}))}},{key:"hideNotifyContainer",value:function(){var e;null===(e=this.module)||void 0===e||e.hide();var t=new CustomEvent("notification-reset-current-edit");document.dispatchEvent(t)}},{key:"show",value:function(){this.services.rightSideBarService.show(m,void 0),this.clearAccountLineNotify()}},{key:"updateNotifyNode",value:function(e){var t;e&&(e.id=y,e.style.width=null!==(t=this.injectable.customNodeStyle.width)&&void 0!==t?t:"325px",e.style.right="0px",e.style.background="white",e.style.overflow="hidden")}},{key:"clearNotifyNumbers",value:function(){this.notifyNumbers=0;var e=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:0}});document.dispatchEvent(e)}},{key:"clearAccountLineNotify",value:function(){var e,t=document.getElementById("notification-dropdown-line"),n=null==t?void 0:t.querySelector(".redPoint"),i=null===(e=b.a.ClientVarsService())||void 0===e?void 0:e.getClientVars(),r=null==i?void 0:i.isCreator;if(n){var a={from:"slide"};r&&(a={from:"slide",domainID:null==i?void 0:i.domainId,localPadID:null==i?void 0:i.padId});var o=new CustomEvent("notification-update-list",a);document.dispatchEvent(o)}r||this.clearNotifyNumbers()}},{key:"getNotifyNumbers",value:(i=r()(h.a.mark((function e(){var t=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.OnlineApiService.promise();case 2:e.sent.getNotifyNumbers().then((function(e){var n=e.data;if(n&&0===n.cgicode&&0===n.retcode)if(n.unread_sum_count){var i=n.unread_sum_count;t.resetNotifyNumbers(i)}else t.clearNotifyNumbers();else console.log("get notify numbers error".concat(n))})).catch((function(e){console.log("get notify numbers error".concat(e))}));case 4:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"updateOuterNotify",value:function(e,t){if(window.AccountAvatar&&window.AccountAvatar.updateRedPoint(t),f.a.isMobile){var n=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:t}});document.dispatchEvent(n)}!e&&this.updateServerNotify()}},{key:"updateServerNotify",value:(n=r()(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.OnlineApiService.promise();case 2:e.sent.clearNotifyNumbers().then((function(e){console.log("notify clear".concat(e))})).catch((function(e){console.log("notify clear error".concat(e))}));case 4:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"updateNotifyNumbers",value:function(e,t){e?this.notifyNumbers+=t:this.notifyNumbers-=t,this.notifyNumbers<=0&&(this.notifyNumbers=0),this.updateOuterNotify(e,this.notifyNumbers);var n=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:this.notifyNumbers}});document.dispatchEvent(n)}},{key:"resetNotifyNumbers",value:function(e){this.notifyNumbers=e,this.updateOuterNotify(!0,this.notifyNumbers)}},{key:"handleNotifyMessage",value:function(e,t){if("COMM_NOTICE"===e&&!this.dataHasNoBodyOrNotice(t)){var n=t.body.notice;if("push_message"===t.body.notice.type&&n&&n.message){var i=JSON.parse(n.message);1===(null==i?void 0:i.msgType)&&(i.clearRedDot&&0!==i.clearRedDot?this.updateNotifyNumbers(!1,i.clearRedDot):i.redDot&&this.updateNotifyNumbers(!0,i.redDot))}}}},{key:"loadNotifyModule",value:(t=r()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.module){e.next=4;break}return e.next=3,v.a.extensionService.getExtension(p.a.name);case 3:this.module=e.sent;case 4:null==t||t();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"dataHasNoBodyOrNotice",value:function(e){var t;return null==e||null===(t=e.body)||void 0===t||!t.notice}}]),e}()},"560506fd63":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Q}));n("73b854064b");var i,r,a,o,c,l,s,d,u,h,f,v,p,g=n("9132715560"),b=n.n(g),m=n("6a364eb35c"),y=n.n(m),w=n("547611bd96"),S=n.n(w),E=n("8eec1e4a03"),O=n.n(E),k=n("bd29e2df90"),x=n.n(k),M=n("ab5eb40518"),P=n.n(M),C=n("1b4cdd6a36"),I=n.n(C),R=n("85d0a7609b"),T=n.n(R),A=n("68394913f2"),D=n("d9812f1c6f"),L=n("6fd214c630"),N=n("b5d9f27607"),j=n("176815363d"),B=n.n(j),H=n("2dc700e1e6"),_=n.n(H),F=n("3ef2352f0b"),U=n.n(F),z=(n("8ee19818c4"),n("c6244f7705"),n("081c8cafea"),n("c554310b5c"),n("9da6335152")),W=n("d3d31c86eb"),G=n("ea3a38d9d4"),K=n("10637d5e95"),V=n("c5cff78be0"),Y=n("a55553ef74"),Z=n("382929c8da");function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return P()(this,n)}}var q=(i=Reflect.metadata("design:type",Function),r=Reflect.metadata("design:paramtypes",[]),a=Reflect.metadata("design:type",Function),o=Reflect.metadata("design:paramtypes",[]),c=Reflect.metadata("design:type",Function),l=Reflect.metadata("design:paramtypes",[]),s=Reflect.metadata("design:type",Function),d=Reflect.metadata("design:paramtypes",[]),u=Reflect.metadata("design:type",Function),h=Reflect.metadata("design:paramtypes",[]),f=Reflect.metadata("design:type",Function),v=Reflect.metadata("design:paramtypes",[]),p=function(e){x()(r,e);var t,n,i=J(r);function r(e,t){var n;return b()(this,r),n=i.call(this,e),T()(S()(n),"services",void 0),T()(S()(n),"injectable",void 0),T()(S()(n),"getMobileToolbarManagerValue",(function(e){var t=null;return V.a.processData().forEach((function(n){n.id===e&&(t=n.value)})),t})),T()(S()(n),"initUndoRedoNativeCall",(function(){Object(A.c)()&&(window.toolbarClick=function(e){"undo"===e?n.undo():"redo"===e?n.redo():window.log.error("ipad native trigger toolbarClick name argument illegal, require undo/redo, but got ".concat(e))})})),n.services=e,n.injectable=t,n.initUndoRedoNativeCall(),n}return y()(r,[{key:"italic",value:function(){if(Object(A.c)()){var e,t;Object(W.c)({opername:z.e.DOC_PPT,module:z.d.M_EDIT_FORMAT,action:z.b.M_EDIT_ITALIC});var n=null===(e=this.menuManager)||void 0===e?void 0:e.stylePanelMenu();null==n||null===(t=n.callback)||void 0===t||t.call(n,G.a.TOOLBAR,"italic",!this.getMobileToolbarManagerValue("italic"))}}},{key:"bold",value:function(){if(Object(A.c)()){var e,t;Object(W.c)({opername:z.e.DOC_PPT,module:z.d.M_EDIT_FORMAT,action:z.b.M_EDIT_ITALIC});var n=null===(e=this.menuManager)||void 0===e?void 0:e.stylePanelMenu();null==n||null===(t=n.callback)||void 0===t||t.call(n,G.a.TOOLBAR,"bold",!this.getMobileToolbarManagerValue("bold"))}}},{key:"underline",value:function(){if(Object(A.c)()){var e,t;Object(W.c)({opername:z.e.DOC_PPT,module:z.d.M_EDIT_FORMAT,action:z.b.M_EDIT_ITALIC});var n=null===(e=this.menuManager)||void 0===e?void 0:e.stylePanelMenu();null==n||null===(t=n.callback)||void 0===t||t.call(n,G.a.TOOLBAR,"underLine",!this.getMobileToolbarManagerValue("underLine"))}}},{key:"delete-line",value:function(){if(Object(A.c)()){var e,t;Object(W.c)({opername:z.e.DOC_PPT,module:z.d.M_EDIT_FORMAT,action:z.b.M_EDIT_ITALIC});var n=null===(e=this.menuManager)||void 0===e?void 0:e.stylePanelMenu();null==n||null===(t=n.callback)||void 0===t||t.call(n,G.a.TOOLBAR,"deleteLine",!this.getMobileToolbarManagerValue("deleteLine"))}}},{key:"undo",value:(n=B()(U.a.mark((function e(){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mobileToolbarDynamicService){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.mobileToolbarDynamicService.promise();case 4:e.sent.handleTouchStart(Z.a.UNDO,"");case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"redo",value:(t=B()(U.a.mark((function e(){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mobileToolbarDynamicService){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.mobileToolbarDynamicService.promise();case 4:e.sent.handleTouchStart(Z.a.REDO,"");case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"mobileToolbarDynamicService",get:function(){return this.services.mobileToolbarDynamicService}}]),r}(K.a),_()(p.prototype,"italic",[Y.c,Y.b,i,r],Object.getOwnPropertyDescriptor(p.prototype,"italic"),p.prototype),_()(p.prototype,"bold",[Y.c,Y.b,a,o],Object.getOwnPropertyDescriptor(p.prototype,"bold"),p.prototype),_()(p.prototype,"underline",[Y.c,Y.b,c,l],Object.getOwnPropertyDescriptor(p.prototype,"underline"),p.prototype),_()(p.prototype,"delete-line",[Y.c,Y.b,s,d],Object.getOwnPropertyDescriptor(p.prototype,"delete-line"),p.prototype),_()(p.prototype,"undo",[Y.c,Y.b,u,h],Object.getOwnPropertyDescriptor(p.prototype,"undo"),p.prototype),_()(p.prototype,"redo",[Y.c,Y.b,f,v],Object.getOwnPropertyDescriptor(p.prototype,"redo"),p.prototype),p);function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return P()(this,n)}}var Q=function(e){x()(n,e);var t=X(n);function n(e,i){var r;return b()(this,n),r=t.call(this,e,i),T()(S()(r),"injectable",void 0),T()(S()(r),"actionsInjectable",void 0),r.injectable=e,r.actionsInjectable=i,r}return y()(n,[{key:"getCtrlKey",value:function(){return D.a.isIPad?"command":"ctrl"}},{key:"getShortcutConfig",value:function(){var e=this.getCtrlKey(),t=O()(I()(n.prototype),"getShortcutConfig",this).call(this);return t["".concat(e,"+i")]=this.handleAction.bind(this,N.a.ITALIC),t["".concat(e,"+b")]=this.handleAction.bind(this,N.a.BOLD),t["".concat(e,"+u")]=this.handleAction.bind(this,N.a.UNDERLINE),t["".concat(e,"+d")]=this.handleAction.bind(this,N.a.DELETE_LINE),Object(A.c)()&&(t["".concat(e,"+c")]=this.handleAction.bind(this,N.a.COPY),t["".concat(e,"+v")]=this.handleAction.bind(this,N.a.PASTE),t["".concat(e,"+x")]=this.handleAction.bind(this,N.a.CUT)),t}},{key:"createShortcutActions",value:function(){return new q(this.services,this.actionsInjectable)}}]),n}(L.a)},"5c6c29d4b1":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var i,r=n("7a5536c9bf"),a=n.n(r),o=n("14502724a6"),c=n.n(o),l=n("9132715560"),s=n.n(l),d=n("6a364eb35c"),u=n.n(d),h=n("85d0a7609b"),f=n.n(h);n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("8ee19818c4"),n("6e20b6a7d8"),n("75563bc376"),n("3bf1976a4f"),n("963f2eaace"),n("026535d8a8"),n("a2a09da1e3"),n("63513d8b56"),n("433247001a"),n("1bab7b5fb7"),n("bd80bf2d0f"),n("0acdc5834b"),n("405b4a5e2b"),n("9d7978d445"),n("34cd92f77a"),n("7eaa8e90a5"),n("759492dad9"),n("826dc923b3");!function(e){e[e.CHINESE=0]="CHINESE",e[e.ARABIC=1]="ARABIC"}(i||(i={}));var v=n("e0e8dd9366"),p=n("aa3cc80657");function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(){function e(){s()(this,e),f()(this,"result",[]),f()(this,"digitMap",new Map([["零",0],["一",1],["壹",1],["贰",2],["二",2],["两",2],["三",3],["叁",3],["肆",4],["四",4],["伍",5],["五",5],["陆",6],["六",6],["柒",7],["七",7],["八",8],["捌",8],["九",9],["玖",9]])),f()(this,"unitMap",new Map([["十",1],["拾",1],["百",2],["佰",2],["千",3],["仟",3],["万",4],["亿",8]])),f()(this,"negative","负"),f()(this,"point","点"),f()(this,"splitChar"," .、。")}return u()(e,[{key:"replaceSensitiveData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.searchNumber(e),this.result.forEach((function(e){e.model.type!==v.d.TABLE?t.replaceShapeData(e,n):t.replaceTableData(e,n)})),this.result=[]}},{key:"searchNumber",value:function(e){var t=this;e.forEach((function(e){e.children.forEach((function(e){t.searchModelNumber(e)}))}))}},{key:"isValidChineseNumber",value:function(e){return!!this.getChineseNumberValue(e)}},{key:"searchModelNumber",value:function(e){var t=this;(null==e?void 0:e.type)!==v.d.GROUP?(e.type===v.d.TABLE&&this.searchTableNumber(e,this.result),this.searchShapeNumber(e,this.result)):e.children.forEach((function(e){t.searchModelNumber(e)}))}},{key:"searchTableNumber",value:function(e,t){var n=this,i=e.tableItems;if(i.length){var r=[];i.forEach((function(e){e.forEach((function(e){n.searchShapeNumber(e,r)}))})),r.length&&t.push({model:e,modelRes:r})}}},{key:"replaceTableData",value:function(e,t){var n=this,i=e.modelRes,r=e.model;i.forEach((function(e){n.replaceShapeData(e,t)})),r.uploadAllCellData()}},{key:"replaceShapeData",value:function(e,t){var n,i=this,r=e.modelRes,a=e.model,o=null===(n=a.paragraphList)||void 0===n?void 0:n.map((function(e,n){var a=r.find((function(e){return e.paraIndex===n}));if(!a)return e;var o=i.getNewTextRuns(e,a,t);return b(b({},e),{},{textRuns:o})}));a.updateParagraphListForUI(o),a.updateParagraphList(o)}},{key:"getNewTextRuns",value:function(e,t,n){var r,a=this,o=[];return null===(r=e.textRuns)||void 0===r||r.forEach((function(e,r){var c=t.paraRes.find((function(e){return e.runIndex===r}));if(c&&e.text){var l=c.runRes,s="",d=0;l.forEach((function(t){if(e.text){var r=t.textIndex,o=t.type,c=t.length;s=s.concat(e.text.slice(d,r));var l=e.text.slice(r,c+r);s=o===i.CHINESE?s.concat(a.getChineseNewText(l,n)):s.concat("*".repeat(c)),d=c+r}})),s=s.concat(e.text.slice(d)),Object(p.e)(s).forEach((function(t){var n,i="*"===t.charAt(0)?"latin":(null===(n=e.styles)||void 0===n?void 0:n.lang)||"",r=e.styles||{};r.lang=i,o.push(b(b({},e),{},{styles:r,text:t}))}))}else o.push(e)})),o}},{key:"getChineseNewText",value:function(e,t){var n="";if(this.isValidChineseNumber(e))if(t){for(var i=this.getMaxUnitIndex(e),r="",a=0;a<e.length;a++)if(!i&&0!==i||a<i)r="".concat(r,"*");else if(a===i){var o=e.charAt(a);r="".concat(r).concat(o)}n=r}else n="*".repeat(e.length);else n=e;return n}},{key:"getMaxUnitIndex",value:function(e){var t,n=1;if(!(e.length<=2&&this.getChineseNumberValue(e)<20)){for(var i=0;i<e.length;i++){var r=e.charAt(i),a=this.unitMap.get(r);a&&a>n&&(n=a,t=i)}return t}}},{key:"searchShapeNumber",value:function(e,t){var n=this,i=e.paragraphList;if(null!=i&&i.length){var r=[];if(i.forEach((function(e,t){var i,a=[];null===(i=e.textRuns)||void 0===i||i.forEach((function(e,t){var i=[];n.getNumberInRun(e,i),i.length&&a.push({runRes:i,runIndex:t})})),a.length&&r.push({paraRes:a,paraIndex:t})})),r.length){this.clearSerialNumber(e,r);var a={model:e,modelRes:r};t.push(a)}}}},{key:"clearSerialNumber",value:function(e,t){var n=this;t.length<=1||t.forEach((function(t){var i,r,a,o;if(0===t.paraRes[0].runIndex&&0===t.paraRes[0].runRes[0].textIndex){var l=null===(i=e.paragraphList)||void 0===i||null===(r=i[t.paraIndex])||void 0===r||null===(a=r.textRuns)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.text;if(l){var s=c()(t.paraRes[0].runRes,1)[0].length,d=n.getNumberValue(l.slice(0,s));if(d&&(d===t.paraIndex||d===t.paraIndex+1)){var u,h,f,v,p,g=l.slice(s,s+1)||(null===(u=e.paragraphList)||void 0===u||null===(h=u[t.paraIndex])||void 0===h||null===(f=h.textRuns)||void 0===f||null===(v=f[1])||void 0===v||null===(p=v.text)||void 0===p?void 0:p.charAt(0));if(!g||-1===n.splitChar.indexOf(g))return;t.paraRes[0].runRes.splice(0,1)}}}}))}},{key:"getNumberInRun",value:function(e,t){var n,r;if(null!==(n=e.text)&&void 0!==n&&n.length)for(var a=null===(r=e.styles)||void 0===r?void 0:r.lang,o=0;o<e.text.length;o++){var c=e.text.charAt(o),l=0,s=i.ARABIC;"ea"===a&&this.isChineseNumber(c)?(l=this.getChineseNumberLength(o,e.text),s=i.CHINESE):"latin"===a&&this.isArabicNumber(c)?l=this.getArabicNumberLength(o,e.text):this.isChineseNumber(c)?(l=this.getChineseNumberLength(o,e.text),s=i.CHINESE):this.isArabicNumber(c)&&(l=this.getArabicNumberLength(o,e.text)),l&&(t.push({textIndex:o,length:l,type:s}),o+=l-1)}}},{key:"getChineseNumberLength",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=t.charAt(e+1);return i.length&&this.isChineseNumber(i)?this.getChineseNumberLength(e+1,t,n+1):n}},{key:"getArabicNumberLength",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=t.charAt(e+1);return i.length&&this.isArabicNumber(i)?this.getArabicNumberLength(e+1,t,n+1):n}},{key:"isArabicNumber",value:function(e){return new RegExp("^\\d$").test(e)}},{key:"isChineseNumber",value:function(e){return-1!=="零一二两三四五六七八九十百千万亿".indexOf(e)}},{key:"centerArray",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.reduce((function(e,t){return e.splice(0,t.length),e.unshift.apply(e,a()(t)),t.length=0,e}),e)}},{key:"unshiftZero",value:function(e,t){t>0&&e.splice.apply(e,[0,0].concat(a()(Array(t).fill(0))))}},{key:"getChineseNumberValue",value:function(e){for(var t=e.split(this.point),n=t[0].replace(this.negative,""),i=c()(t,2)[1],r=0,a=0,o=[],l=[],s=[],d=0;d<n.length;d++){var u=n.charAt(d),h=this.digitMap.get(u),f=this.unitMap.get(u);h?h>0&&s.unshift(h):f&&(r>f?(this.unshiftZero(s,f),this.centerArray(l,s)):f>=a?(0===d&&(s=[1]),this.centerArray(o,l,s),o.length>0&&this.unshiftZero(o,f),a=f):(0===s.length&&"十"===u&&(s=[1]),this.centerArray(l,s),this.unshiftZero(l,f),r=f))}if(this.centerArray(o,l,s).reverse(),0===o.length&&o.push(0),i){o.push(".");for(var v=0;v<i.length;v++){var p=this.digitMap.get(i.charAt(v));if(!p)break;o.push(p)}}return parseFloat(o.join(""))}},{key:"getNumberValue",value:function(e){return this.isArabicNumber(e.charAt(0))?Number(e):this.getChineseNumberValue(e)}}]),e}()},"5eda65902a":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("bd29e2df90"),o=n.n(a),c=n("ab5eb40518"),l=n.n(c),s=n("1b4cdd6a36"),d=n.n(s);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d()(e);if(t){var r=d()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l()(this,n)}}var h=function(e){o()(n,e);var t=u(n);function n(){return r()(this,n),t.apply(this,arguments)}return n}(n("c1808b326d").a)},"64ebbf1e02":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var i=n("c92b994f13"),r=i(n("fc356a1fd0")),a=i(n("c0fee5e13a")),o=i(n("e79a1cfd0d"));t.push([e.i,".style-mask-container-1ZNMh{width:160px;height:160px;position:relative;cursor:pointer}.style-mask-container-1ZNMh .style-mask-bg-18x2A{position:absolute;left:0;right:0;top:0;bottom:0;background:url("+r+") no-repeat;background-size:cover;opacity:.5}.style-mask-container-1ZNMh .style-mask-info-28kCm{width:160px;height:160px;display:flex;align-items:center;justify-content:center;flex-direction:column;position:relative}.style-mask-container-1ZNMh .style-mask-info-28kCm .style-mask-icon-3sGGk{background-position:50%;background-repeat:no-repeat}.style-mask-container-1ZNMh .style-mask-info-28kCm .style-mask-icon-3sGGk.style-error-2Owo5{width:60px;height:60px;background-size:110%;background-image:url("+a+")}.style-mask-container-1ZNMh .style-mask-info-28kCm .style-mask-icon-3sGGk.style-success-3w913{width:60px;height:60px;background-size:80%;background-image:url("+o+")}.style-mask-container-1ZNMh .style-mask-info-28kCm .style-mask-title-2i5H4{font-size:16px;font-weight:700;color:rgba(0,0,0,.88);line-height:2}.style-mask-container-1ZNMh .style-mask-info-28kCm .style-mask-text-9jPBu{font-size:12px;color:rgba(0,0,0,.64)}",""]),t.locals={"mask-container":"style-mask-container-1ZNMh","mask-bg":"style-mask-bg-18x2A","mask-info":"style-mask-info-28kCm","mask-icon":"style-mask-icon-3sGGk",error:"style-error-2Owo5",success:"style-success-3w913","mask-title":"style-mask-title-2i5H4","mask-text":"style-mask-text-9jPBu"}},"6e82698d02":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-rs-bar-container-CybNh{position:absolute;right:0;width:280px;height:100%}.index-rs-bar-wrapper-animating-2KNLU{width:100%;height:100%;-webkit-animation:ease both;animation:ease both;-webkit-animation-duration:.3s;animation-duration:.3s;position:absolute}.index-rs-bar-wrapper-animating-2KNLU.index-enter-UXoDH{-webkit-animation-name:index-rs-bar-anim-enter-5I-2M;animation-name:index-rs-bar-anim-enter-5I-2M}.index-rs-bar-wrapper-animating-2KNLU.index-leave-rkA2Y{-webkit-animation-name:index-rs-bar-anim-leave-2TNEr;animation-name:index-rs-bar-anim-leave-2TNEr}.index-rs-bar-wrapper-hold-1Ihrl{width:100%;height:100%;border-left:1px solid rgba(0,0,0,.06);position:absolute;transition:right .3s ease;box-sizing:content-box}@-webkit-keyframes index-rs-bar-anim-enter-5I-2M{0%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes index-rs-bar-anim-enter-5I-2M{0%{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@-webkit-keyframes index-rs-bar-anim-leave-2TNEr{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}}@keyframes index-rs-bar-anim-leave-2TNEr{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}to{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}}.index-rs-bar-file-info-3nDYJ{background-color:#fff}",""]),t.locals={"rs-bar-container":"index-rs-bar-container-CybNh","rs-bar-wrapper-animating":"index-rs-bar-wrapper-animating-2KNLU",enter:"index-enter-UXoDH","rs-bar-anim-enter":"index-rs-bar-anim-enter-5I-2M",leave:"index-leave-rkA2Y","rs-bar-anim-leave":"index-rs-bar-anim-leave-2TNEr","rs-bar-wrapper-hold":"index-rs-bar-wrapper-hold-1Ihrl","rs-bar-file-info":"index-rs-bar-file-info-3nDYJ"}},"6fd214c630":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=(n("a2a09da1e3"),n("4bbb5840d5"),n("8aebbf296a"),n("85d48ef22b"),n("b8217400dc"),n("e6f68cdf2e"),n("43dffc9bd2")),d=n("d5c3deb8c7"),u=n("5cdbac46e8"),h=n("b5d9f27607"),f=n("cd255d4473");function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(){function e(t,n){var i=this;r()(this,e),l()(this,"services",void 0),l()(this,"injectable",void 0),l()(this,"actionsInjectable",void 0),l()(this,"shortcutConfig",{}),l()(this,"bubblingShortcutConfig",{}),l()(this,"actions",void 0),l()(this,"handleAction",(function(e,t){var n,r,a,o;if((i.shouldShortcutKeyActive()||i.isUndoRedoInChartEditPanel(e))&&!(null!==(n=i.services.editingStateManager)&&void 0!==n&&n.isEditing||null!==(r=i.services.menuManager)&&void 0!==r&&r.isMenuShown))return null===(a=(o=i.actions)[e])||void 0===a?void 0:a.call(o,t)})),this.injectable=t,this.actionsInjectable=n}return o()(e,[{key:"setServicesDelegates",value:function(e){var t;this.services=p(p({},this.services),e),null===(t=this.actions)||void 0===t||t.setServicesDelegates(e)}},{key:"init",value:function(){var e=this;this.actions=this.createShortcutActions(),Object(d.r)((function(){return e.getEditorState()}),(function(t){e.updateShortcutBinding(t)}),{fireImmediately:!0})}},{key:"shouldShortcutKeyActive",value:function(){return!this.isAiSidebarActive()&&(!this.actions.hasFloatContent()&&!(!this.isTextEditorActive()&&this.isEditableDomActive()))}},{key:"getShortcutConfig",value:function(){var e,t=this.getCtrlKey();return e={},l()(e,"".concat(t,"+enter"),this.handleAction.bind(this,h.a.PLAY)),l()(e,"".concat(t,"+a"),this.handleAction.bind(this,h.a.SELECTALL)),l()(e,"".concat(t,"+z"),this.handleAction.bind(this,h.a.UNDO)),l()(e,"".concat(t,"+y"),this.handleAction.bind(this,h.a.REDO)),l()(e,"ctrl+m",this.handleAction.bind(this,h.a.NEWSLIDE_M)),l()(e,"backspace",this.handleAction.bind(this,h.a.DELETE)),l()(e,"delete",this.handleAction.bind(this,h.a.DELETE)),l()(e,"enter",this.handleAction.bind(this,h.a.NEWSLIDE_ENTER)),l()(e,"".concat(t,"+alt+g"),this.handleAction.bind(this,h.a.ADD_GROUP)),l()(e,"".concat(t,"+alt+shift+g"),this.handleAction.bind(this,h.a.REMOVE_GROUP)),l()(e,"tab",this.handleAction.bind(this,h.a.TABACTION)),l()(e,"".concat(t,"+p"),this.handleAction.bind(this,h.a.PRINT)),e}},{key:"getBubblingShortcutConfig",value:function(){return{up:this.handleAction.bind(this,h.a.UP),left:this.handleAction.bind(this,h.a.LEFT),pageup:this.handleAction.bind(this,h.a.PAGEUP),down:this.handleAction.bind(this,h.a.DOWN),right:this.handleAction.bind(this,h.a.RIGHT),pagedown:this.handleAction.bind(this,h.a.PAGEDOWN),home:this.handleAction.bind(this,h.a.HOME),end:this.handleAction.bind(this,h.a.END),wheel:this.handleAction.bind(this,h.a.MOUSEWHEEL)}}},{key:"bindShortcuts",value:function(){this.shortcutConfig=this.getShortcutConfig(),Object(s.b)(this.shortcutConfig)}},{key:"bindBubblingShortcuts",value:function(){this.bubblingShortcutConfig=this.getBubblingShortcutConfig(),Object(s.b)(this.bubblingShortcutConfig,{bubble:!0})}},{key:"bindNonEditableShortcuts",value:function(){var e,t=this.getCtrlKey();this.shortcutConfig=(e={},l()(e,"".concat(t,"+enter"),this.handleAction.bind(this,h.a.PLAY)),l()(e,"".concat(t,"+a"),this.handleAction.bind(this,h.a.SELECTALL)),l()(e,"wheel",this.handleAction.bind(this,h.a.MOUSEWHEEL)),l()(e,"tab",this.handleAction.bind(this,h.a.TABACTION)),l()(e,"".concat(t,"+p"),this.handleAction.bind(this,h.a.PRINT)),e),Object(s.b)(this.shortcutConfig)}},{key:"unBindShortcuts",value:function(){Object(s.d)(this.shortcutConfig),Object(s.d)(this.bubblingShortcutConfig,{bubble:!0})}},{key:"updateShortcutBinding",value:function(e){this.unBindShortcuts(),e===u.b.EDITABLE?this.bindShortcuts():this.bindNonEditableShortcuts(),this.bindBubblingShortcuts()}},{key:"getEditorState",value:function(){return this.services.userPriviledgeService.pptEditorState}},{key:"isTextEditorActive",value:function(){var e=["editor-body","CopyPasteAssist",f.a];if(document.activeElement){var t=document.activeElement.className;if("string"==typeof t&&(-1!==e.indexOf(t)||t.startsWith("style_hidden-editor-input")))return!0}return!1}},{key:"isEditableDomActive",value:function(){if(document.activeElement){var e=document.activeElement;if(-1!==["input","textarea"].indexOf(e.tagName.toLowerCase()))return"input"!==e.tagName.toLowerCase()||"checkbox"!==e.type;if(e.value||e.isContentEditable)return!0}return!1}},{key:"isAiSidebarActive",value:function(){return this.isActiveElementInClassList(["ai-float-window"])}},{key:"isActiveElementInClassList",value:function(e){if(!document.activeElement)return!1;var t=Array.from(document.activeElement.classList);return e.some((function(e){return t.includes(e)}))}},{key:"isUndoRedoInChartEditPanel",value:function(e){var t;return("undo"===e||"redo"===e)&&Boolean(document.activeElement)&&Boolean(null===(t=document.querySelector(".slide-spreadsheet"))||void 0===t?void 0:t.contains(document.activeElement))}}]),e}()},"708d7957d7":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("402eb050f3"),l=function(){function e(){r()(this,e)}return o()(e,[{key:"floatContentOffset",get:function(){return{x:0,y:c.b.supportEnterprise(c.a.ALL)?40:0}}}]),e}()},"77cee6b2ba":function(e,t,n){"use strict";n.r(t),n.d(t,"MobileActionSheetService",(function(){return I}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=n("176815363d"),d=n.n(s),u=n("3ef2352f0b"),h=n.n(u),f=(n("8a35b54c1d"),n("6e20b6a7d8"),n("75563bc376"),n("963f2eaace"),n("8ee19818c4"),n("c6244f7705"),n("081c8cafea"),n("5fac0349d3")),v=n("ec5cae33cb"),p=n("e0e8dd9366"),g=n("798a9cd6f2"),b=n("145eddafd2"),m=n("3344f1a2e7"),y=n("da1384be0f"),w=n.n(y),S=n("b74ee0edd6"),E=n.n(S),O=n("dc3fc3bbc5"),k=n("281cbdced7"),x=n.n(k),M=n("cb5ea60341"),P=x()(w.a.show,1e3,{leading:!0,trailing:!1}),C=function e(t){var n=this;r()(this,e),l()(this,"callActionFromPhotoAlbum",(function(){try{var e=n.services.editorInstanceService.getEditorInstance();null==e||e.triggerBlur(),n.selectLocalImageFile(!1)}catch(e){var t=document.getElementById("select_pic_input");if(!t)return;t.click()}})),l()(this,"callActionFromTencentDocument",(function(){var e,t;null===(e=n.services)||void 0===e||null===(t=e.driveSelectorPanelService.promise())||void 0===t||t.then((function(e){null==e||e.show({serviceList:["attachmentManager"],config:{target:"image"}})}))})),l()(this,"callActionFromLocalFile",(function(){var e;null===(e=document.getElementById("select_pic_input"))||void 0===e||e.click()})),l()(this,"callActionCamera",(function(){try{var e=n.services.editorInstanceService.getEditorInstance();null==e||e.triggerBlur(),n.selectLocalImageFile(!0)}catch(e){var t=document.getElementById("select_pic_input");if(!t)return;t.setAttribute("capture","camera"),t.setAttribute("accept","image/camera"),t.click(),t.removeAttribute("capture"),t.setAttribute("accept","image/*")}})),l()(this,"options",[{id:M.a.FromPhotoAlbum,title:f.a.t("从相册"),callback:this.callActionFromPhotoAlbum},{id:M.a.FromTencentDocument,title:g.f.TENANT_DOC_NAME?"从".concat(g.f.TENANT_DOC_NAME):f.a.t("从腾讯文档"),callback:this.callActionFromTencentDocument},{id:M.a.FromLocalFile,title:f.a.t("从本地文件"),callback:this.callActionFromLocalFile},{id:M.a.Camera,title:f.a.t("拍摄"),callback:this.callActionCamera}]),l()(this,"callActionSheet",(function(e){P({onClickAction:n.onClickAction,options:n.handleOptions(e)})})),l()(this,"callActionDirect",(function(e){n.onClickAction(e)})),l()(this,"handleOptions",(function(e){return e.map((function(e){return n.options.find((function(t){return t.id===e}))})).filter((function(e){return e}))})),l()(this,"onClickAction",(function(e){var t=n.options.find((function(t){return t.id===e}));null==t||t.callback()})),l()(this,"selectLocalImageFile",(function(e){(new O.ImageSelector).selectLocalImageFile({maxCount:e?1:9,callback:function(e){if((null==e?void 0:e.length)>0){var t,i,r=e;return Array.isArray(e)||(r=Array.prototype.slice.call(e,null)),void(null===(t=(i=r).forEach)||void 0===t||t.call(i,(function(e){return e&&n.insertImage([e])})))}},capture:e,errCallback:function(e){var t=e.retcode,n=e.msg;switch(t){case 0:window.log.error(n);break;case 1:E.a.show({message:f.a.t("无相册权限，请在系统设置开启。"),duration:3e3,autoClose:!0});break;case 2:E.a.show({message:f.a.t("图片上传失败，请重试。"),duration:3e3,autoClose:!0})}}})})),l()(this,"insertImage",function(){var e=d()(h.a.mark((function e(t){var i,r,a,o,c,l,s,d,u,f,g,y,w,S,E,O,k,x,M,P,C,I,R,T,A;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(i=n.services)||void 0===i||null===(r=i.copyPasteImageService)||void 0===r?void 0:r.promise();case 2:return a=e.sent,o=null==a?void 0:a.ImageEditManager,c=null==o?void 0:o.getInstance(),e.next=7,null==c?void 0:c.createEditorImages(t);case 7:if(l=e.sent,n.services.selectionService.currentSlide){e.next=10;break}return e.abrupt("return");case 10:if(s=n.services.uiDataService.presentation,d=n.services.selectionService,u=d.currentSlideIndex,f=d.slides,l&&0!==l.length){e.next=14;break}return e.abrupt("return");case 14:for(g=[],y=0;y<l.length;y++)w=l[y],S=Object(m.C)(w.width),E=Object(m.C)(w.height),O=s.props,k=O.slideWidth,x=O.slideHeight,M=S,P=E,(S>k||E>x)&&(M=S*(R=(C=k/S)<(I=x/E)?C:I),P=E*R),T=(k-M)/2,A=(x-P)/2,w.style={position:"absolute",left:T,top:A,width:M,height:P,bgShape:b.b.rect,opacity:1},g.push(p.d.IMAGE);f[u].addElement(g,l),n.services.selectionService.lastMouseDownRegion=v.a.EDITOR,n.services.selectionService.selectedSlides.clear(),window.dispatchEvent(new CustomEvent("resize",{detail:{scrollCenter:!0}}));case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.services=t},I=function(){function e(){r()(this,e),l()(this,"imageActionSheetInstance",void 0),l()(this,"services",void 0)}return o()(e,[{key:"setServiceDelegates",value:function(e){this.services=e}},{key:"imageActionSheet",get:function(){return this.imageActionSheetInstance||(this.imageActionSheetInstance=new C(this.services)),this.imageActionSheetInstance}}]),e}()},"7af4d80efc":function(e,t,n){"use strict";var i,r;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),function(e){e.PLAY="play",e.PAUSE="pause",e.SPEED="speed"}(i||(i={})),function(e){e.DESKTOP="desktop",e.WEB="web"}(r||(r={}))},"7b959b6de1":function(e,t,n){"use strict";n.r(t),n.d(t,"PCProduceBackupManager",(function(){return V}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("14502724a6"),r=n.n(i),a=n("176815363d"),o=n.n(a),c=n("9132715560"),l=n.n(c),s=n("6a364eb35c"),d=n.n(s),u=n("547611bd96"),h=n.n(u),f=n("bd29e2df90"),v=n.n(f),p=n("ab5eb40518"),g=n.n(p),b=n("1b4cdd6a36"),m=n.n(b),y=n("85d0a7609b"),w=n.n(y),S=n("3ef2352f0b"),E=n.n(S),O=(n("3bf1976a4f"),n("c6244f7705"),n("081c8cafea"),n("6e20b6a7d8"),n("8bbfaad34f")),k=n("82f2dc9440"),x=n.n(k),M=n("3825cc7c15"),P=n("5fac0349d3"),C=n("8b13fcae36"),I=n("d9812f1c6f"),R=n("402eb050f3"),T=n("aba9dcef64"),A=n("020899bf26"),D=n("0fbb1a6af6"),L=n("668bd0ac65"),N=n("fdddc95d9b"),j=n("1af4b2dbf4"),B=n("8f58e78419"),H=n.n(B),_=n("2f766f71b0"),F=n.n(_),U=n("3a58133a15"),z=n("915616c11c");function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g()(this,n)}}var V=function(e){v()(i,e);var t,n=K(i);function i(){var e;l()(this,i);for(var t=arguments.length,a=new Array(t),c=0;c<t;c++)a[c]=arguments[c];return e=n.call.apply(n,[this].concat(a)),w()(h()(e),"redirectToDoc",(function(t){t&&(e.hasExternal()?external.openUrl(null,t,null,""):I.a.isPCWechat?Object(C.setNewWindowUrl)(window,t):R.b.supportEnterprise(R.a.ALL)?Object(z.a)({url:t}):Object(C.tencentDocOpenUrl)(t))})),w()(h()(e),"handleCheckBack",(function(){setTimeout((function(){var e,t;null===(e=document.getElementById("input-title"))||void 0===e||e.focus(),null===(t=document.getElementById("input-title"))||void 0===t||t.select()}),100),x.a.show({message:P.a.t("已生成并打开副本"),type:"success",autoClose:!0});try{var e=Object(M.e)(window.location.href,"newPad"),t=Object(C.getMultUrl)(Object(M.e)(e,"newPadType"));history.replaceState(null,"",t)}catch(e){var n;null===(n=window.log)||void 0===n||n.err(e)}})),w()(h()(e),"handleCreateDocNew",(function(t){var n;e.singleSnackbar.close();var i="".concat(t.doc_url,"?newPad=1&newPadType=clone");e.redirectToDoc(i),window.tdwReport&&window.tdwReport({opername:"server_doc",module:"copy",action:"all"}),e.shouldReport&&(null===(n=window.speedReport)||void 0===n||n.markEnd(window.speedReport.reportId.docDuplicate))})),w()(h()(e),"getKeyframeFromOfflineStatus",o()(E.a.mark((function e(){var t,n,i,a,o,c,l,s,d,u,h,f,v,p,g,b,m,y,w,S,O,k;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.DocInfoManager.promise();case 2:return i=e.sent,a=i.globalPadId,o=void 0===a?"":a,c=i.baseRevision,l=void 0===c?0:c,e.next=9,T.a.CollaborationManager.promise();case 9:return s=e.sent,e.next=12,A.a.SDKDataServices.PresentationStoreService.promise();case 12:return d=e.sent,e.next=15,A.a.SDKDataServices.SnapshotManager.promise();case 15:if(u=e.sent,null!=(h=s.getPersistent().getMutationsPacks())&&h.length){e.next=19;break}return e.abrupt("return",d.getSerializedPresentationDataWithPage());case 19:return f=null!==(t=h[0].revision)&&void 0!==t?t:l,e.next=22,null===(n=T.a.OnlineApiService())||void 0===n?void 0:n.getHistorySlide(o,f,-1);case 22:return v=e.sent,p=H()(v,"data.data.initialAttributedText.text"),g=d.createFromCommandData(new L.a(JSON.parse(p)).getCommandData()),e.prev=25,null==g||g.applyCommandData(j.a.fromValidMutationData(F()(h.map((function(e){return e.mutations})))).getCommandData(),N.a.Offline),e.abrupt("return",g.getSerializedPresentationDataWithPage());case 30:return e.prev=30,e.t0=e.catch(25),e.next=34,u.getSnapshotStorage().list();case 34:if(null!=(b=e.sent)&&b.length){e.next=37;break}return e.abrupt("return",d.getSerializedPresentationDataWithPage());case 37:return m=b.reverse(),y=r()(m,1),w=y[0],S=u.getSnapshotStorage(),e.next=41,S.getById(w.id);case 41:return O=e.sent,e.prev=42,e.next=45,Object(U.b)(O,!0);case 45:return k=e.sent,e.abrupt("return",k);case 49:return e.prev=49,e.t1=e.catch(42),e.abrupt("return",d.getSerializedPresentationDataWithPage());case 52:case"end":return e.stop()}}),e,null,[[25,30],[42,49]])})))),w()(h()(e),"createDocBySlideFileData",function(){var t=o()(E.a.mark((function t(n){var i,r,a,o,c,l;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.getTitle(),e.hasExternal()||e.singleSnackbar.show({message:P.a.t("生成副本中，请稍候...")}),t.next=4,T.a.OnlineApiService.promise();case 4:return r=t.sent,t.next=7,A.a.DocInfoManager.promise();case 7:return a=t.sent,t.prev=8,t.next=11,r.createDocByData({title:P.a.t("副本-{0}",{0:i}),atext:JSON.stringify({text:JSON.stringify(G(G({},n),{},{dver:D.b}))}),globalPadId:null!==(o=a.globalPadId)&&void 0!==o?o:""});case 11:return c=t.sent,t.next=14,e.onCreateDocNew(c);case 14:return l=t.sent,t.abrupt("return",l);case 18:t.prev=18,t.t0=t.catch(8),e.onCatchCreateDocNew();case 21:return t.abrupt("return",!1);case 22:case"end":return t.stop()}}),t,null,[[8,18]])})));return function(e){return t.apply(this,arguments)}}()),w()(h()(e),"hasExternal",(function(){return"undefined"!=typeof external&&"function"==typeof external.openUrl})),e}return d()(i,[{key:"createCopyDoc",value:(t=o()(E.a.mark((function e(t){var n,i,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,this.getKeyframeFromOfflineStatus();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,A.a.SDKDataServices.PresentationStoreService.promise().then((function(e){return e.getSerializedPresentationDataWithPage()}));case 8:e.t0=e.sent;case 9:return i=e.t0,e.next=12,null===(n=this.createDocBySlideFileData)||void 0===n?void 0:n.call(this,i);case 12:return(r=e.sent)&&this.services.exportManager.promise().then((function(e){e.showModalToClearUnSendData()})),e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"checkShowProducingSnackbar",value:function(){return!this.hasExternal()}}]),i}(O.a)},"7f492dc6c0":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return R}));n("73b854064b");var i=n("176815363d"),r=n.n(i),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),l=n.n(c),s=n("547611bd96"),d=n.n(s),u=n("8eec1e4a03"),h=n.n(u),f=n("bd29e2df90"),v=n.n(f),p=n("ab5eb40518"),g=n.n(p),b=n("1b4cdd6a36"),m=n.n(b),y=n("85d0a7609b"),w=n.n(y),S=n("3ef2352f0b"),E=n.n(S),O=(n("c6244f7705"),n("081c8cafea"),n("af802ec74b"),n("1bab7b5fb7"),n("9d7978d445"),n("433247001a"),n("bd80bf2d0f"),n("3bf1976a4f"),n("f8fc8e0087")),k=n("1f4b665603"),x=n("144183c5db"),M=n("3d781306f0"),P=n("d818a44ab4"),C=n("cc17a96b7f");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g()(this,n)}}var R=function(e){v()(c,e);var t,n,i,a=I(c);function c(){var e;return o()(this,c),e=a.call(this),w()(d()(e),"moduleName",x.e.RemoteControl),w()(d()(e),"playerStateMgr",void 0),w()(d()(e),"isSocketOpen",!1),w()(d()(e),"isUserActivationActiveOnAutoPlay",!0),w()(d()(e),"initRoomInfoAndEnter",r()(E.a.mark((function t(){var n,i;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(C.a)()){t.next=2;break}return t.abrupt("return");case 2:if(n=e.roomInfo(),i=n.roomid,!e.isSocketOpen||!i){t.next=5;break}return t.abrupt("return");case 5:if(i){t.next=8;break}return t.next=8,e.initRoomInfo();case 8:e.masterEnter(),e.setLiveState(k.LiveState.Pause);case 10:case"end":return t.stop()}}),t)})))),w()(d()(e),"initRoomInfo",r()(E.a.mark((function t(){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getRemoteControlRoomInfo();case 3:return n=t.sent,e._roomInfo=Object.assign({},e._roomInfo,n),t.abrupt("return",e._roomInfo);case 8:throw t.prev=8,t.t0=t.catch(0),e._roomInfo=null,t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))),w()(d()(e),"needReceiveLiveMessage",(function(){return!0})),e.resetLiveInfo(),e}return l()(c,[{key:"docID",get:function(){return this.getDocId()||window.location.pathname.split("/").pop()||""}},{key:"getDocId",value:function(){var e,t;return null!==(e=null===(t=new RegExp("/meetingroom/player/slide/([^/]+?)/?$").exec(location.pathname))||void 0===t?void 0:t[1])&&void 0!==e?e:Object(O.getQuery)("docId")}},{key:"closeAndStopLive",value:function(){var e=this;return new Promise((function(t){if(e.roomInfo().roomid){var n=function n(){t(),e.event.off(k.LiveSocketShutDown,n)};return e.event.on(k.LiveSocketShutDown,n),e.liveEnd(),e.closeShowRoom(),void setTimeout((function(){t(),e.event.off(k.LiveSocketShutDown,n)}),500)}t()}))}},{key:"liveBegin",value:function(e){return this.sendLiveMessage("REVISION"),h()(m()(c.prototype),"liveBegin",this).call(this,e),!0}},{key:"handleSocketOpen",value:function(){h()(m()(c.prototype),"handleSocketOpen",this).call(this),this.isSocketOpen=!0}},{key:"handleSocketReopen",value:function(){h()(m()(c.prototype),"handleSocketReopen",this).call(this),this.isSocketOpen=!0}},{key:"handleSocketShutDown",value:function(e){h()(m()(c.prototype),"handleSocketShutDown",this).call(this,e),this.isSocketOpen=!1,this._roomInfo=null}},{key:"userId",get:function(){var e,t,n,i,r;return null!==(e=(null===(t=window.clientVars)||void 0===t?void 0:t.userId)||(null===(n=window.basicClientVars)||void 0===n||null===(i=n.userInfo)||void 0===i?void 0:i.userId)||(null===(r=window.playerInitData)||void 0===r?void 0:r.userId))&&void 0!==e?e:""}},{key:"serverVars",get:function(){return{padId:void 0,globalPadId:void 0,pver:void 0,gray:void 0,appid:void 0,wmode:void 0,client:{upid:void 0,sid:void 0,tid:void 0,sig:void 0}}}},{key:"getUserInfos",value:(i=r()(E.a.mark((function e(t){var n,i,r,a,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null!==(n=null===(i=window.playerInitData)||void 0===i?void 0:i.globalPadId)&&void 0!==n?n:null===(r=window.clientVars)||void 0===r?void 0:r.globalPadId,e.next=3,Object(M.d)(t,a);case 3:return o=e.sent,e.abrupt("return",null!=o&&o);case 5:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"setMeetingRoomHelper",value:function(e){this.playerStateMgr=e}},{key:"currentPage",get:function(){var e=this.liveInfo.page;return e>1?e-1:0}},{key:"gotoPage",value:function(){var e=this.playerStateMgr.playerState;if(e&&this._role===k.LiveRoleType.Master){console.log("live GotoPage: ".concat(e.currentPage));var t=e.currentPage||0,n=e.currentFragment||0,i=e.iaFragmentInfo||{};this._liveInfo.page=t+1,this._liveInfo.fragment=n+1,this._liveInfo.iaFragmentInfo=i,this._liveInfo.shouldStopMainAnim=e.shouldStopMainAnim,this._liveInfo.isLoadPageBySwitchForward=e.isLoadPageBySwitchForward,this.sendLiveMessage("PAGE")}else console.log("live GotoPage failed")}},{key:"startPCPlay",value:function(){var e,t,n;this.isUserActivationActiveOnAutoPlay=null===(e=null===(t=navigator)||void 0===t||null===(n=t.userActivation)||void 0===n?void 0:n.isActive)||void 0===e||e,this.event.emit(P.b,null),this.liveBegin({})}},{key:"isAutoFullScreenSuccess",get:function(){return this.isUserActivationActiveOnAutoPlay}},{key:"remoteControlUrl",get:function(){var e=this.roomInfo().roomid||0;if(!e)return"";var t=window.location.hostname;return"https://".concat(t,"/meetingroom/player/slide/").concat(this.docID,"?roomId=").concat(e,"&sceneSource=").concat(x.e.RemoteControl)}},{key:"masterEnter",value:function(){this.isSocketOpen||h()(m()(c.prototype),"masterEnter",this).call(this)}},{key:"getRemoteControlRoomInfo",value:(n=r()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getShowInfo();case 2:return t=e.sent,e.next=5,this.getRoomExtraInfo(t.roomid);case 5:if(e.sent.moduleName!==x.e.RemoteControl){e.next=8;break}return e.abrupt("return",t);case 8:throw new Error("current room is not a remote control room");case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"handleLiveMessage",value:function(e){h()(m()(c.prototype),"handleLiveMessage",this).call(this,e),e.type===P.a&&this.event.emit(P.a)}},{key:"mobileJoin",value:function(){this.sendLiveMessage(P.a)}},{key:"getShowInfo",value:function(){return this.getShowRequest(this.docID).then((function(e){var t;if(0===(null==e||null===(t=e.data)||void 0===t?void 0:t.retcode))return e.data.result;throw e.data}))}},{key:"getRoomExtraInfo",value:(t=r()(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getRoomInfo(t);case 3:return n=e.sent,e.abrupt("return",JSON.parse(n.info));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{});case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return t.apply(this,arguments)})}]),c}(k.LiveCore)},"7faf76450d":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=n("2e0796c118"),d=function(){function e(){r()(this,e),l()(this,"wrapper",void 0)}return o()(e,[{key:"name",get:function(){return"base"}},{key:"show",value:function(e){this.showWrapper()}},{key:"hide",value:function(){this.hideWrapper()}},{key:"showWrapper",value:function(){var e;null===(e=this.wrapper)||void 0===e||e.show()}},{key:"hideWrapper",value:function(){var e;null===(e=this.wrapper)||void 0===e||e.hide()}},{key:"wrapperWillShow",value:function(){}},{key:"wrapperDidHide",value:function(){}},{key:"DOMNode",get:function(){return this.wrapper?Object(s.findDOMNode)(this.wrapper):null}}]),e}()},"82bfcfe414":function(e,t,n){"use strict";n.r(t),n.d(t,"RemoteMediaSyncManager",(function(){return x}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var i,r=n("14502724a6"),a=n.n(r),o=n("176815363d"),c=n.n(o),l=n("9132715560"),s=n.n(l),d=n("6a364eb35c"),u=n.n(d),h=n("85d0a7609b"),f=n.n(h),v=n("3ef2352f0b"),p=n.n(v);n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("8ee19818c4"),n("081c8cafea"),n("75563bc376"),n("b8217400dc"),n("e6f68cdf2e");!function(e){e.PLAY="play",e.PAUSE="pause",e.SEEK="seek",e.SPEED="speed"}(i||(i={}));var g=n("edf338cd36"),b=n("144183c5db"),m=n("d00a79b9b7"),y=n("99420ff35e"),w=n("e0e8dd9366"),S=n("862b984676"),E=n("0cbec907c5");function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(){function e(t){var n=this;s()(this,e),f()(this,"sceneSource",b.e.None),f()(this,"mediaManager",void 0),f()(this,"uiDataService",void 0),f()(this,"liveManager",void 0),f()(this,"injectable",void 0),f()(this,"init",(function(e){n.sceneSource=e})),f()(this,"reset",(function(){n.sceneSource=b.e.None})),f()(this,"setServiceDelegates",(function(e){n.mediaManager=e.mediaManager,n.uiDataService=e.uiDataService,e.liveManager.promise().then((function(e){n.liveManager=e}))})),f()(this,"attachMediaEventInPlayer",(function(e,t,r){if(n.injectable.attachMediaEventInPlayer(r)||n.notAttach())return[function(){}];var a=new Map([[i.PLAY,E.o.VIDEO_PLAYING],[i.PAUSE,E.o.VIDEO_PAUSE],[i.SPEED,E.o.VIDEO_RATE_CHANGE]]),o=[];return a.forEach((function(i,r){var a=function(e){var i=e.target;return n.sendPlayerEvent2Room(i,r,t)};e.on(i,a),o.push((function(){return e.off(i,a)}))})),o})),f()(this,"attachRecvPlayerEventInRoom",(function(){return n.isRemotePlay()?g.a.onRecvPlayerEvent(b.f.Media,function(){var e=c()(p.a.mark((function e(t){var i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(i=n.liveManager)||void 0===i||i.sendMediaLiveMsg(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):function(){}})),f()(this,"attachLiveManagerMediaEvent",(function(){if(!n.isRemotePlay())return function(){};var e="MediaStateChanged";return n.liveManager.event.on(e,n.sendMediaChangeToPlayer),function(){return n.liveManager.event.off(e,n.sendMediaChangeToPlayer)}})),f()(this,"attachRecvMediaChangeInPlayer",(function(){return n.isRemotePlay()?g.a.onRecvRoomEvent(b.i.MediaStateChanged,(function(e){return n.syncMediaChange(e)})):function(){}})),f()(this,"sendMediaChangeToPlayer",(function(e){n.liveManager.isAudience&&g.a.sendRoomEvent2Player(b.i.MediaStateChanged,e)})),this.injectable=t}return u()(e,[{key:"sendPlayerEvent2Room",value:function(e,t,n){var r={cmd:t,mediaId:n,playtime:e.playtime};t===i.SPEED&&(r=k(k({},r),{},{speed:e.playbackRate})),g.a.sendPlayerEvent2Room(b.f.Media,r)}},{key:"syncMediaChange",value:function(e){var t,n=this,r=e.mediaId,o=e.cmd,c=e.playtime,l=e.speed,s=this.findMediaById(r)||[],d=a()(s,2),u=d[0],h=d[1];h&&(null===(t=new Map([[i.PLAY,function(){return n.playHandler(u,h,c)}],[i.PAUSE,function(){return n.pauseHandler(u)}],[i.SPEED,function(){return n.speedHandler(u,l)}]]).get(o))||void 0===t||t())}},{key:"findMediaById",value:function(e){var t,n,i;if(null===(t=this.liveManager)||void 0===t||!t.isAudience)return null;var r=e,a=this.getMasterCurrentPage();if(a!==this.getAudienceCurrentPage())return null;var o=null===(n=this.uiDataService.presentation.children[a].children)||void 0===n?void 0:n.find((function(e){return e.id===r&&e.type===w.d.IMAGE}));if(!o)return null;var c,l=o.key,s=null===(i=this.mediaManager)||void 0===i?void 0:i.getVideoInstanceByRegion(l,S.a.PLAYER);s&&(null===(c=this.mediaManager)||void 0===c||c.updateElementKeyByRegion(l,S.a.PLAYER));return[s,l]}},{key:"getMasterCurrentPage",value:function(){return y.a.getInstance().roomState.currentPage}},{key:"getAudienceCurrentPage",value:function(){return m.default.getState().control.currentPage}},{key:"playHandler",value:function(e,t,n){var i;e?e.duration?(e.seek(n),e.play()):e.replay():null===(i=this.mediaManager)||void 0===i||i.playVideoByRegion(t,S.a.PLAYER)}},{key:"pauseHandler",value:function(e){e&&e.pause()}},{key:"seekHandler",value:function(e,t){e&&e.seek(null!=t?t:0)}},{key:"speedHandler",value:function(e,t){e&&(e.playbackRate=null!=t?t:1)}},{key:"isRemotePlay",value:function(){return[b.e.MeetingRoom,b.e.InEditor].includes(this.sceneSource)}},{key:"notAttach",value:function(){var e;return!this.isRemotePlay()||!(null===(e=this.liveManager)||void 0===e||!e.isAudience)}}]),e}()},"84f4552293":function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("547611bd96"),l=n.n(c),s=n("bd29e2df90"),d=n.n(s),u=n("ab5eb40518"),h=n.n(u),f=n("1b4cdd6a36"),v=n.n(f),p=n("85d0a7609b"),g=n.n(p),b=(n("3bf1976a4f"),n("d5c3deb8c7")),m=n("5cdbac46e8"),y=n("9e6e95de85"),w=n("87c53f95ab"),S=n("f54a0d6a89");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var x=function(e){d()(n,e);var t=k(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),g()(l()(e),"hideNote",(function(){var t,n,i,r,a,o,c,l=null===(t=e.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.currentSlide,s=null==l||null===(i=l.noteData)||void 0===i?void 0:i.noteTextBody;null==s||null===(r=s.editorInstance)||void 0===r||null===(a=r.triggerBlur)||void 0===a||a.call(r,{needUpdate:!0}),null===(o=e.services)||void 0===o||null===(c=o.noteAreaManager)||void 0===c||c.setHide()})),g()(l()(e),"getNoteModel",(function(){var t,n,i=null===(t=e.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.currentSlide;return i?i.noteData:null})),g()(l()(e),"getEditable",(function(){var t,n;return(null===(t=e.services)||void 0===t||null===(n=t.userPriviledgeService)||void 0===n?void 0:n.pptEditorState)===m.b.EDITABLE})),g()(l()(e),"getNoteAreaInfo",(function(){return{noteAreaHeight:e.model.noteAreaHeight}})),e}return o()(n,[{key:"setViewerServiceDelegates",value:function(e){this.services=O(O({},this.services),e)}},{key:"componentDidMount",value:function(){var e,t=this;null===(e=this.viewDelegate)||void 0===e||e.disposeOnUnmount(Object(b.r)((function(){var e,n;return null===(e=t.services)||void 0===e||null===(n=e.selectionService)||void 0===n?void 0:n.currentSlideIndex}),(function(){var e;null===(e=t.viewDelegate)||void 0===e||e.forceRender()})))}},{key:"createViewModel",value:function(){return new w.a}},{key:"noteCanvasRef",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById(S.a.NOTE_CANVAS)}},{key:"noteContainerRef",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById(S.a.NOTE_CONTAINER)}},{key:"noteTopDivRef",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById(S.a.NOTE_TOP)}},{key:"noteBottomDivRef",get:function(){var e;return null===(e=this.viewDelegate)||void 0===e?void 0:e.getElementById(S.a.NOTE_BOTTOM)}}]),n}(y.a)},"87c53f95ab":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("547611bd96"),l=n.n(c),s=n("bd29e2df90"),d=n.n(s),u=n("ab5eb40518"),h=n.n(u),f=n("1b4cdd6a36"),v=n.n(f),p=n("85d0a7609b"),g=n.n(p);n("3bf1976a4f");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var m=function(e){d()(n,e);var t=b(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),g()(l()(e),"noteAreaHeight",void 0),e}return o()(n,[{key:"initModel",value:function(e,t){}}]),n}(n("375d29afab").a)},"8bbfaad34f":function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i,r=n("176815363d"),a=n.n(r),o=n("9132715560"),c=n.n(o),l=n("6a364eb35c"),s=n.n(l),d=n("85d0a7609b"),u=n.n(d),h=n("3ef2352f0b"),f=n.n(h),v=(n("c6244f7705"),n("081c8cafea"),n("b1e2246d82"),n("3bf1976a4f"),n("82f2dc9440")),p=n.n(v),g=n("3825cc7c15"),b=n("5fac0349d3"),m=n("7b48385e89"),y=n("52f1976aee"),w=n("570b26a0fa"),S=n("aba9dcef64"),E=n("020899bf26"),O=n("52d461bc51"),k=n.n(O),x=n("16e55f093a"),M=n("b40469cb12"),P=n("4f3b15d017");function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.NO_STATUS=0]="NO_STATUS",e[e.CLOSE=1]="CLOSE",e[e.OPEN=2]="OPEN",e[e.EXPIRED=3]="EXPIRED"}(i||(i={}));var R=function(){function e(){var t=this;c()(this,e),u()(this,"services",void 0),u()(this,"singleSnackbar",void 0),u()(this,"shouldReport",!0),u()(this,"injectable",void 0),u()(this,"onCatchCreateDocNew",(function(){var e;t.singleSnackbar.show({message:b.a.t("生成副本失败，请稍后重试"),type:"error",autoClose:!0}),t.shouldReport&&Object(w.monitor)(33586553),t.shouldReport&&(null===(e=window.speedReport)||void 0===e||e.markEnd(window.speedReport.reportId.docDuplicate))})),u()(this,"showCreateDocNewErrorToast",(function(e,n,i){var r=t.injectable.getCreateDocNewErrorToastInfo(e,n,i);t.singleSnackbar.show({message:r.msg,type:r.type,autoClose:!0})})),u()(this,"redirectToDoc",(function(e){})),u()(this,"produceBackUpCheck",(function(){Object(E.b)((function(){t.checkBack()}))})),u()(this,"checkBack",a()(f.a.mark((function e(){var n,i,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=(null===(n=E.a.ClientVarsService())||void 0===n?void 0:n.getClientVars())||{},r=i.newPad,a=i.newPadType,(null!==Object(g.d)("newPad")||r)&&("clone"!==Object(g.d)("newPadType")&&"clone"!==a||t.handleCheckBack());case 2:case"end":return e.stop()}}),e)})))),u()(this,"handleCheckBack",(function(){})),u()(this,"onCreateDocNew",function(){var e=a()(f.a.mark((function e(n,i){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===(r=n.data).retcode){e.next=8;break}return e.next=4,Object(y.backupShowDialog)(r.retcode,i);case 4:return e.sent?t.singleSnackbar.close():t.showCreateDocNewErrorToast(r),t.shouldReport&&Object(w.monitor)(33586553),e.abrupt("return",!1);case 8:return t.handleCreateDocNew(r),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),u()(this,"handleCreateDocNew",(function(e){})),u()(this,"getTitle",(function(){var e,t=(null!==(e=E.a.SlideTitleManager())&&void 0!==e?e:{}).title,n=void 0===t?"":t;return n.length>125?n.substr(0,125):n})),u()(this,"checkAndHandleNonVipCopyWithVipFonts",a()(f.a.mark((function e(){var n,i,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=t.services)||void 0===n||null===(i=n.fontManager)||void 0===i?void 0:i.collectFontsUsingStatus();case 2:if(null==(r=e.sent)||!r.hasVipFonts||t.isMyselfVip()){e.next=6;break}return k.a.confirm({title:b.a.t("无法生成副本"),content:b.a.t("开通会员，即可生成包含个性字体的文件副本"),okButtonType:"golden",okText:b.a.t("开通会员"),onOk:function(){M.a.extensionService.getExtension(x.a.name).then((function(e){e.show({source:t.getPreventCloneVipAid()})}))}}),e.abrupt("return",!1);case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})))),this.singleSnackbar=new m.a({Snackbar:p.a})}var t;return s()(e,[{key:"setServiceDelegates",value:function(e){this.services=I(I({},this.services),e)}},{key:"setInject",value:function(e){this.injectable=e}},{key:"generateProduceBackup",value:(t=a()(f.a.mark((function e(){var t,n,i,r,a,o,c,l,s,d=this,u=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(u.length>0&&void 0!==u[0]?u[0]:{}).aidOptions,!this.injectable.shouldCheckVipStatus()){e.next=8;break}return e.next=5,this.checkAndHandleNonVipCopyWithVipFonts();case 5:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:if(i=this.getTitle(),this.shouldReport&&(null===(t=window.speedReport)||void 0===t||t.markStart(window.speedReport.reportId.docDuplicate)),this.checkShowProducingSnackbar()&&this.singleSnackbar.show({message:b.a.t("生成副本中，请稍候...")}),this.injectable.produceBackup(i,(function(e){d.redirectToDoc(e),d.singleSnackbar.close()}),this.onCatchCreateDocNew,n)){e.next=21;break}return e.next=15,E.a.DocInfoManager.promise();case 15:a=e.sent,o=a.domainId,c=void 0===o?"":o,l=a.padId,s=void 0===l?"":l,null===(r=S.a.OnlineApiService())||void 0===r||r.generateDuplicateDoc(c,s,b.a.t("副本-{0}",{0:i})).then((function(e){return d.onCreateDocNew(e,n)})).catch(this.onCatchCreateDocNew);case 21:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"checkShowProducingSnackbar",value:function(){return!0}},{key:"isMyselfVip",value:function(){var e,t,n,r,a=null===(e=window.clientVars)||void 0===e?void 0:e.vipInfo;return!!a.isVip||((null===(t=a.vip)||void 0===t?void 0:t.status)===i.OPEN||((null===(n=a.vvip)||void 0===n?void 0:n.status)===i.OPEN||(null===(r=a.svip)||void 0===r?void 0:r.status)===i.OPEN))}},{key:"getPreventCloneVipAid",value:function(){return"txdocs_".concat(this.getAidPlatformShorthand(),"_").concat(this.getAidSystemShorthand(),"_titlebar_typeface_copy_slide")}},{key:"getAidSystemShorthand",value:function(){var e="web";return P.default.isWxMiniProgram?e="wxsp":P.default.isTencentDocsApp?e="app":P.default.isPCTencentDocsClient?e="desk":P.default.isMobile&&(e="h5"),e}},{key:"getAidPlatformShorthand",value:function(){var e="";return P.default.isAndroid?e="an":P.default.isIOS?e="ios":P.default.isWindows?e="wd":P.default.isMac&&(e="mac"),e}}]),e}()},"8bea2d09d9":function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var i,r,a,o=n("9132715560"),c=n.n(o),l=n("6a364eb35c"),s=n.n(l),d=n("85d0a7609b"),u=n.n(d),h=(n("b8217400dc"),n("e6f68cdf2e"),n("8ee19818c4"),n("a2a09da1e3"),n("8a35b54c1d"),n("e0e8dd9366")),f=n("94348c1654"),v=n("7d1df7d0fb"),p=n("d115d284c3"),g=n("ea3a38d9d4"),b=n("b4a31815a1"),m=n("6884e1a126"),y=n("ab5f2ef853"),w=n("f27f5f5885"),S=n("5fac0349d3"),E=n("9da6335152"),O=n("4ea58bcc32"),k=n("d3d31c86eb"),x=n("5ee8f9506b"),M=n("c9c92622ff"),P=n("f216b3624d"),C=n("711a53c9fc"),I=n("a7888a8b87"),R=n.n(I);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D="other-type",L="other-type-effect-layout",N="shape-image",j="layout-image",B=(i={},u()(i,h.d.SHAPE,f.x),u()(i,h.d.GROUP,f.x),u()(i,h.d.IMAGE,f.p),u()(i,h.d.EMPTY,f.s),u()(i,h.d.CONNECTOR,f.e),u()(i,h.d.TABLE,f.v),u()(i,h.d.NOTE,f.n),u()(i,h.d.CHART,f.c),u()(i,h.d.SMART_ART,f.t),u()(i,D,f.i),u()(i,L,f.g),u()(i,N,f.A),u()(i,j,f.k),i),H=(r={},u()(r,h.d.SHAPE,f.y),u()(r,h.d.GROUP,f.y),u()(r,h.d.IMAGE,f.q),u()(r,h.d.EMPTY,f.m),u()(r,h.d.CONNECTOR,f.f),u()(r,h.d.TABLE,f.w),u()(r,h.d.NOTE,f.o),u()(r,h.d.CHART,f.d),u()(r,h.d.SMART_ART,f.u),u()(r,D,f.j),u()(r,L,f.h),u()(r,N,f.z),u()(r,j,f.l),r),_=(a={},u()(a,C.bc.BarChart,f.a),u()(a,C.bc.Bar3DChart,f.a),u()(a,C.bc.PieChart,f.r),u()(a,C.bc.Pie3DChart,f.r),u()(a,C.bc.DoughnutChart,f.r),u()(a,C.bc.BubbleChart,f.b),a),F=function(){function e(){c()(this,e)}return s()(e,null,[{key:"init",value:function(e){var t=e.menuManager,n=e.userPriviledgeService,i=e.masterLayoutEditService,r=e.rightSideBarManager;this.menuManager=t,this.userPriviledgeService=n,this.masterLayoutEditService=i,this.rightSideBarManager=r,this.chartService=Object(O.a)(x.a)}},{key:"setFormSchema",value:function(t){var n=f.x;if(null!=t&&t.type)if([h.d.MULTIPLY,h.d.GROUP].includes(t.type)){var i=Object(v.a)(t);n=e.getMultiModelFormSchema(i)}else{if(t.type===h.d.CHART)return n=this.getChartFormSchema(t),e.formService.setSchema(n),void this.switchToChartForm();var r=e.getNewType(null==t?void 0:t.type,t);n=e.getFormSchema()[r]}e.formService.setSchema(n)}},{key:"getChartFormSchema",value:function(t){var n;if(!t.isActualRenderChart)return this.reportChartForm(t.isActualRenderChart),e.getFormSchema()[D];var i=e.getFormSchema()[h.d.CHART],r=this.chartService.showMarkerPanel(),a=Object(y.a)(t,r);i=this.loadScheamBySubChartType(t,R()(i),a);var o=(n={},u()(n,w.h.FORMAT,A(A({},i[a]),{},{label:S.a.t("格式")})),u()(n,w.h.ANIMATION,i[w.h.ANIMATION]),n);return this.reportChartForm(t.isActualRenderChart,a),o}},{key:"loadScheamBySubChartType",value:function(e,t,n){var i,r,a=null===(i=e.getSelectedSubChartProperty())||void 0===i?void 0:i.getChartOriginType();return a&&_[a]?(null===(r=t[n])||void 0===r||r.tabs.forEach((function(e){(null==e?void 0:e.label)===S.a.t("数据系列")&&(null==e||e.sections.push(_[a]))})),t):t}},{key:"switchToChartForm",value:function(){var t;e.formService.changeForm(w.h.FORMAT,1),null!==(t=this.rightSideBarManager)&&void 0!==t&&t.isAnimationEditorShown&&(this.rightSideBarManager.setIsAnimationEditorShown(!1),this.rightSideBarManager.setIsPropertyEditorShown(!0))}},{key:"getMultiModelFormSchema",value:function(e){var t=this;if(e.some((function(e){return Object(M.F)(e)})))return f.i;var n=[],i=0;e.forEach((function(e){var r=t.getNewType(null==e?void 0:e.type,e);r===N&&(i+=1,r=h.d.SHAPE),r===h.d.IMAGE&&(i+=1),-1===n.indexOf(r)&&n.push(r)}));var r=n.length;if(1===r)return this.getMultiSameTypeSchema(e[0].type,n,i);if(2===r&&2===n.filter((function(e){return e===h.d.IMAGE||e===h.d.SHAPE})).length)return 1===i?this.getFormSchema()[h.d.IMAGE]:this.getFormSchema()[L];return 1===i?this.getFormSchema()[j]:this.getFormSchema()[D]}},{key:"getMultiSameTypeSchema",value:function(e,t,n){switch(e){case h.d.IMAGE:return f.g;case h.d.CHART:return this.getFormSchema()[D];case h.d.SHAPE:return 1===n?this.getFormSchema()[N]:this.getFormSchema()[h.d.SHAPE];default:return this.getFormSchema()[t[0]]}}},{key:"reportChartForm",value:function(e,t){var n=JSON.stringify({isChart:e,formKey:t});Object(k.c)({opername:E.e.DOC_PPT,module:E.d.CHART,action:E.b.CHART_RIGHT_BAR_DISPALY,ver6:n})}}]),e}();u()(F,"formService",m.e.get(b.f)),u()(F,"chartService",void 0),u()(F,"menuManager",void 0),u()(F,"userPriviledgeService",void 0),u()(F,"masterLayoutEditService",void 0),u()(F,"rightSideBarManager",void 0),u()(F,"getNewType",(function(e,t){var n,i;if(e===h.d.NOTE||e===h.d.CHART)return e;var r=F.getTextAddonOrAttachmentType(t);return r||(0===(null===(n=F.menuManager.propertyMenu())||void 0===n||null===(i=n.items)||void 0===i?void 0:i.length)||0===Object(p.b)(g.a.PROPERTY_BAR,t).length?D:Object(P.a)(t)?N:e)})),u()(F,"getTextAddonOrAttachmentType",(function(e){if(Object(M.F)(e))return D;if((null==e?void 0:e.type)===h.d.SHAPE){var t=e;return t.props.addon&&"normal"!==t.props.addon.displayMode?D:void 0}})),u()(F,"getFormSchema",(function(){var e;return(null===(e=F.getMasterLayoutEditService())||void 0===e?void 0:e.isMasterEditType)?H:B})),u()(F,"getMasterLayoutEditService",(function(){if(F.userPriviledgeService.isEditable())return F.masterLayoutEditService}))},"912aeea237":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("bd29e2df90"),o=n.n(a),c=n("ab5eb40518"),l=n.n(c),s=n("1b4cdd6a36"),d=n.n(s);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d()(e);if(t){var r=d()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l()(this,n)}}var h=function(e){o()(n,e);var t=u(n);function n(){return r()(this,n),t.apply(this,arguments)}return n}(n("708d7957d7").a)},"9166ac1402":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("bd29e2df90"),o=n.n(a),c=n("ab5eb40518"),l=n.n(c),s=n("1b4cdd6a36"),d=n.n(s);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d()(e);if(t){var r=d()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l()(this,n)}}var h=function(e){o()(n,e);var t=u(n);function n(){return r()(this,n),t.apply(this,arguments)}return n}(n("708d7957d7").a)},"9464a90cef":function(e,t,n){"use strict";n.r(t),n.d(t,"ShortcutPanelRSBarModule",(function(){return O})),n.d(t,"default",(function(){return k}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("85d0a7609b"),r=n.n(i),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),l=n.n(c),s=n("bd29e2df90"),d=n.n(s),u=n("ab5eb40518"),h=n.n(u),f=n("1b4cdd6a36"),v=n.n(f),p=n("d0054b9d0b"),g=n("5fac0349d3"),b=[{typeName:g.a.t("操作"),keybindings:[{description:g.a.t("复制"),kbOpts:{win:["Ctrl","C"],mac:["⌘","C"]}},{description:g.a.t("粘贴"),kbOpts:{win:["Ctrl","V"],mac:["⌘","V"]}},{description:g.a.t("剪切"),kbOpts:{win:["Ctrl","X"],mac:["⌘","X"]}},{description:g.a.t("撤销"),kbOpts:{win:["Ctrl","Z"],mac:["⌘","Z"]}},{description:g.a.t("重做"),kbOpts:{win:["Ctrl","Y"],mac:["⌘","Y"]}},{description:g.a.t("快速复制选中对象"),kbOpts:{win:["Ctrl",g.a.t("鼠标拖动")],mac:["⌘",g.a.t("鼠标拖动")]}},{description:g.a.t("复制选中对象，并水平移动"),kbOpts:{win:["Ctrl","Shift",g.a.t("鼠标拖动")],mac:["⌘","⇧",g.a.t("鼠标拖动")]}},{description:g.a.t("复制选中对象，并垂直移动"),kbOpts:{win:["Ctrl","Shift",g.a.t("鼠标拖动")],mac:["⌘","⇧",g.a.t("鼠标拖动")]}},{description:g.a.t("显示或隐藏参考线"),kbOpts:{win:["Alt","F9"],mac:["⌃","⌥","⌘","G"]}},{description:g.a.t("显示或隐藏网格线"),kbOpts:{win:["Shift","F9"],mac:["⌘","'"]}}]},{typeName:g.a.t("格式"),keybindings:[{description:g.a.t("加粗"),kbOpts:{win:["Ctrl","B"],mac:["⌘","B"]}},{description:g.a.t("斜体"),kbOpts:{win:["Ctrl","I"],mac:["⌘","I"]}},{description:g.a.t("下划线"),kbOpts:{win:["Ctrl","U"],mac:["⌘","U"]}},{description:g.a.t("删除线"),kbOpts:{win:["Ctrl","D"],mac:["⌘","D"]}}]},{typeName:g.a.t("导航"),keybindings:[{description:g.a.t("移至左一个字符"),kbOpts:{win:["←"],mac:["←"]}},{description:g.a.t("移至右一个字符"),kbOpts:{win:["→"],mac:["→"]}},{description:g.a.t("移至上一行"),kbOpts:{win:["↑"],mac:["↑"]}},{description:g.a.t("移至下一行"),kbOpts:{win:["↓"],mac:["↓"]}},{description:g.a.t("移至左一个词"),kbOpts:{win:["Ctrl","←"],mac:["⌥","←"]}},{description:g.a.t("移至右一个词"),kbOpts:{win:["Ctrl","→"],mac:["⌥","→"]}},{description:g.a.t("移至段首"),kbOpts:{win:["Ctrl","↑"],mac:["⌥","↑"]}},{description:g.a.t("移至段尾"),kbOpts:{win:["Ctrl","↓"],mac:["⌥","↓"]}},{description:g.a.t("移至行首"),kbOpts:{win:["Home"],mac:["⌘","←"]}},{description:g.a.t("移至行尾"),kbOpts:{win:["End"],mac:["⌘","→"]}},{description:g.a.t("移至编辑对象的首"),kbOpts:{win:["Ctrl","Home"],mac:["⌘","↑"]}},{description:g.a.t("移至编辑对象的尾"),kbOpts:{win:["Ctrl","End"],mac:["⌘","↓"]}}]},{typeName:g.a.t("选择"),keybindings:[{description:g.a.t("全选"),kbOpts:{win:["Ctrl","A"],mac:["⌘","A"]}},{description:g.a.t("向左选择一个字符"),kbOpts:{win:["Shift","←"],mac:["⇧","←"]}},{description:g.a.t("向右选择一个字符"),kbOpts:{win:["Shift","→"],mac:["⇧","→"]}},{description:g.a.t("选择光标到上一行"),kbOpts:{win:["Shift","↑"],mac:["⇧","↑"]}},{description:g.a.t("选择光标到下一行"),kbOpts:{win:["Shift","↓"],mac:["⇧","↓"]}},{description:g.a.t("选择文本到行首"),kbOpts:{win:["Shift","Home"],mac:["⇧","⌘","←"]}},{description:g.a.t("选择文本到行尾"),kbOpts:{win:["Shift","End"],mac:["⇧","⌘","→"]}},{description:g.a.t("选择文本，从当前光标到编辑对象的首"),kbOpts:{win:["Ctrl","Shift","Home"],mac:["⇧","⌘","↑"]}},{description:g.a.t("选择文本，从当前光标到编辑对象的尾"),kbOpts:{win:["Ctrl","Shift","End"],mac:["⇧","⌘","↓"]}},{description:g.a.t("选择文本，从当前光标到左一个词"),kbOpts:{win:["Ctrl","Shift","←"],mac:["⇧","⌥","←"]}},{description:g.a.t("选择文本，从当前光标到右一个词"),kbOpts:{win:["Ctrl","Shift","→"],mac:["⇧","⌥","→"]}},{description:g.a.t("选择文本，从当前光标到段首"),kbOpts:{win:["Ctrl","Shift","↑"],mac:["⇧","⌥","↑"]}},{description:g.a.t("选择文本，从当前光标到段尾"),kbOpts:{win:["Ctrl","Shift","↓"],mac:["⇧","⌥","↓"]}}]},{typeName:g.a.t("查看"),keybindings:[{description:g.a.t("放大视图"),kbOpts:{win:["Ctrl",g.a.t("滚轮"),"+"],mac:["⌘",g.a.t("滚轮"),"+"]}},{description:g.a.t("缩小视图"),kbOpts:{win:["Ctrl",g.a.t("滚轮"),"-"],mac:["⌘",g.a.t("滚轮"),"-"]}},{description:g.a.t("回到100%"),kbOpts:{win:["Ctrl","0"],mac:["⌘","0"]}},{description:g.a.t("开始播放"),kbOpts:{win:["Ctrl","Enter"],mac:["⌘","Enter"]}},{description:g.a.t("结束放映"),kbOpts:{win:["Esc"],mac:["Esc"]}},{description:g.a.t("查找"),kbOpts:{win:["Ctrl","F"],mac:["⌘","F"]}},{description:g.a.t("替换"),kbOpts:{win:["Ctrl","H"],mac:["⌘","H"]}},{description:g.a.t("打开快捷键右侧栏"),kbOpts:{win:["Ctrl","/"],mac:["⌘","/"]}}]}],m=n("7faf76450d");function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var E="shortcut-panel",O=function(e){d()(n,e);var t=S(n);function n(e){var i;return o()(this,n),(i=t.call(this)).shortcutPanelManager=e,i}return l()(n,[{key:"name",get:function(){return E}},{key:"show",value:function(){var e=this;this.shortcutPanelManager.showModule(this.DOMNode,(function(){e.showWrapper()}),(function(){e.hideWrapper()}))}},{key:"wrapperDidHide",value:function(){this.shortcutPanelManager.removeModule()}}]),n}(m.a),k=function(){function e(){o()(this,e),r()(this,"module",void 0),r()(this,"services",void 0)}return l()(e,[{key:"setServiceDelegates",value:function(e){this.services=w(w({},this.services),e)}},{key:"registerRightSideBar",value:function(){this.services.rightSideBarService.registerModule(new O(this))}},{key:"showModule",value:function(e,t,n){var i=this;this.loadModule((function(r){var a,o;r&&(null===(o=i.module)||void 0===o||o.init(e,{shortcutKeybindings:b,close:n}));null===(a=i.module)||void 0===a||a.show(),null==t||t()}))}},{key:"switchByShortcut",value:function(){this.services.rightSideBarService.isShown(E)?this.hide():this.show()}},{key:"show",value:function(){this.services.rightSideBarService.show(E,void 0)}},{key:"removeModule",value:function(){}},{key:"hide",value:function(){this.services.rightSideBarService.hide()}},{key:"loadModule",value:function(e){var t=this;this.module?null==e||e():p.a.load("ShortcutPanel",(function(n,i){t.module=n,null==e||e(i)}))}}]),e}()},"96873f9163":function(e,t,n){"use strict";n.r(t);n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var i=n("14502724a6"),r=n.n(i),a=n("7a5536c9bf"),o=n.n(a),c=n("9132715560"),l=n.n(c),s=n("6a364eb35c"),d=n.n(s),u=n("547611bd96"),h=n.n(u),f=n("bd29e2df90"),v=n.n(f),p=n("ab5eb40518"),g=n.n(p),b=n("1b4cdd6a36"),m=n.n(b),y=n("85d0a7609b"),w=n.n(y),S=(n("7eaa8e90a5"),n("826dc923b3"),n("3bf1976a4f"),n("8ee19818c4"),n("3dc760a4d9"),n("963f2eaace"),n("b8217400dc"),n("e6f68cdf2e"),n("69084d01d3")),E=n.n(S),O=n("2e0796c118"),k=n.n(O),x=n("5a5c6d313d"),M=n("f1f2954cff"),P=n.n(M),C=n("52d461bc51"),I=n.n(C),R=n("d436b8c143"),T=n.n(R),A=n("56373a2988"),D=n.n(A),L=n("516fa97df2"),N=n("1068873c4f"),j=n("e792a3169a"),B=n.n(j),H=n("00032c3677"),_=n.n(H),F={insert:"head",singleton:!1},U=(B()(_.a,F),_.a.locals||{}),z=n("016175442c"),W=n("3344f1a2e7"),G=142.24,K=0,V=1584,Y=0,Z=n("5fac0349d3"),J=n("0442e400dc");function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=4;function $(e,t,n){return e<t?t:e>n?n:e}var ee={paragraphProps:{lang:"ea"},textRuns:[{styles:{color:"#C4C4C4",lang:"ea",fontSize:Q},text:Z.a.t("前一段落")}]},te={paragraphProps:{lang:"ea"},textRuns:[{styles:{color:"#C4C4C4",lang:"ea",fontSize:Q},text:Z.a.t("后一段落")}]};function ne(e){var t=e.alignmentType,n=e.lineHeightType,i=e.lineHeight,r=e.marginLeft,a=e.textIndent,o=e.spaceBefore,c=e.spaceAfter,l=e.textIndentType,s={};if(t){var d,u=(d={},w()(d,J.a.HORIZONTAL_LEFT,"left"),w()(d,J.a.HORIZONTAL_CENTER,"center"),w()(d,J.a.HORIZONTAL_RIGHT,"right"),w()(d,J.a.HORIZONTAL_JUSTIFY,"justify"),w()(d,J.a.HORIZONTAL_DISTRIBUTE,"distribute"),d);s.textAlign=u[t]}if(n&&i&&(n===z.a.Multi?(s.PPTLineHeight=i,s.lineHeight=i*W.d,s.lineHeightIs="percent"):n===z.a.Fixed&&(s.lineHeight=i/2,s.lineHeightIs="absolute")),r){var h=$(r,K,G);s.marginLeft=Object(W.m)(h,2)}if(a&&l){var f=$(a,K,G),v="hanging"===l?-f:f;s.textIndent=Object(W.m)(v,2)}if(o){var p=$(o,Y,V);s.paddingTop=p,s.paddingTopIs="absolute"}if(c){var g=$(c,Y,V);s.paddingBottom=g,s.paddingBottomIs="absolute"}return{paragraphProps:X({lang:"ea"},s),textRuns:[{styles:{lang:"ea",fontSize:Q},text:Z.a.t("示例文本")}]}}function ie(){return[ee,ne(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),te]}n("6e20b6a7d8"),n("75563bc376"),n("eb9e932508"),n("1bab7b5fb7"),n("34cd92f77a"),n("b4638a0243");var re=n("7eb0635f44"),ae=n.n(re),oe=n("11246a1392"),ce=n.n(oe),le=n("57b2cc50f9"),se=n.n(le),de=n("b4a31815a1"),ue=(n("759492dad9"),function(e){var t=e.tabstops;return e.isRemovingAll?E.a.createElement("div",null,Z.a.t("全部")):E.a.createElement("div",null,null==t?void 0:t.map((function(e){return e+Z.a.t("厘米")})).join(", "))});ue.propTypes={tabstops:P.a.array,isRemovingAll:P.a.bool};var he=ue,fe=n("311718eba2"),ve=n.n(fe),pe={insert:"head",singleton:!1},ge=(B()(ve.a,pe),ve.a.locals||{}),be=function(e){var t=e.unitStr,n=e.style;return E.a.createElement("span",{style:n,className:"".concat(ge.unselectable," ").concat(ge["para-panel-item-unit"])},t)};be.propTypes={unitStr:P.a.string.isRequired,style:P.a.object};var me=be;function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=function(){return E.a.createElement(me,{unitStr:Z.a.t("厘米")})},Ee=function(){return E.a.createElement("div",{style:{marginBottom:"10px"}})},Oe=function(e){var t=e.isVisible,n=e.setVisible,i=Object(S.useState)("left"),a=r()(i,2),c=a[0],l=a[1],s=Object(S.useState)(null),d=r()(s,2),u=d[0],h=d[1],f=Object(S.useState)([]),v=r()(f,2),p=v[0],g=v[1],b=Object(S.useState)(0),m=r()(b,2),y=m[0],w=m[1],O=Object(S.useState)(void 0),k=r()(O,2),x=k[0],M=k[1],P=Object(S.useState)([]),C=r()(P,2),R=C[0],T=C[1],A=Object(S.useState)(!1),D=r()(A,2),L=D[0],N=D[1],j=function(){e.tabList&&g(e.tabList.map((function(e){return we(we({},e),{},{position:Object(W.D)(e.position,2)})})))},B=function(){e.tabSize&&M(Object(W.D)(e.tabSize,2))};Object(S.useEffect)((function(){j()}),[e.tabList]),Object(S.useEffect)((function(){B()}),[e.tabSize]);return E.a.createElement(I.a,{visible:t,title:Z.a.t("制表位"),onOk:function(t){t&&(n(!1),e.setTabSize(Object(W.m)(x,2)),e.setTabList(p.map((function(e){return we(we({},e),{},{position:Object(W.m)(e.position,2)})}))))},onCancel:function(){n(!1);setTimeout((function(){j(),B(),T([]),w(0),l("left"),h(null),N(!1)}),200)},style:{width:"500px"}},E.a.createElement("div",{className:U["tabstop-modal-container"]},E.a.createElement("div",{className:U["tabstop-modal-left-column"]},E.a.createElement("div",{className:U["tabstop-modal-row"]},E.a.createElement("span",null,"".concat(Z.a.t("制表位位置")).concat(Z.a.t("："))),E.a.createElement(de.g,{step:.1,min:K,max:G,allowDecimal:!0,toFixed:2,style:{width:70},value:String(y),onChange:function(e){var t=parseFloat(e);isNaN(t)||w(t)}}),E.a.createElement(Se,null)),E.a.createElement(Ee,null),E.a.createElement("div",{className:U["tabstop-modal-row"]},E.a.createElement("span",null,"".concat(Z.a.t("默认制表位")).concat(Z.a.t("："))),E.a.createElement(de.g,{step:.1,min:.16,max:G,allowDecimal:!0,toFixed:2,style:{width:70},value:x?String(x):void 0,onChange:function(e){var t=parseFloat(e);isNaN(t)||M(t)}}),E.a.createElement(Se,null)),E.a.createElement(Ee,null),E.a.createElement("div",null,E.a.createElement("div",{style:{marginBottom:"5px"}},"".concat(Z.a.t("对齐")).concat(Z.a.t("："))),E.a.createElement(ae.a.Group,{onChange:function(e){return l(e)},value:c,itemStyle:{paddingBottom:"10px"},style:{marginLeft:"10px "}},E.a.createElement(ae.a,{value:"left"},Z.a.t("向左对齐")),E.a.createElement(ae.a,{value:"center"},Z.a.t("居中对齐")),E.a.createElement(ae.a,{value:"right"},Z.a.t("向右对齐")))),E.a.createElement(Ee,null),E.a.createElement("div",null,"".concat(Z.a.t("要清除的制表位")).concat(Z.a.t("："))),E.a.createElement("div",null,E.a.createElement(he,{tabstops:R,isRemovingAll:L}))),E.a.createElement("div",{className:U["tabstop-modal-right-column"]},E.a.createElement("div",{className:U["tabstop-modal-tabstop-list"]},E.a.createElement(se.a,{style:{border:"none",padding:0},onClick:function(e){var t=p.find((function(t){return t.position===e}));if(t){h(we({},t)),w(t.position);var n="decimal"===t.alignment?"left":t.alignment;l(n)}}},p.map((function(e){return E.a.createElement(se.a.Item,{id:e.position,key:e.position,selected:(null==u?void 0:u.position)===e.position},e.position.toFixed(2).replace(/([0-9]+(\.[0-9]+[1-9])?)(\.?0+$)/,"$1")+Z.a.t("厘米"))})))),E.a.createElement(Ee,null),E.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},E.a.createElement(ce.a,{onClick:function(){var e=o()(p),t=e.find((function(e){return e.position===y}));t?t.alignment!==c&&(t.alignment=c):(e.push({position:y,alignment:c}),e.sort((function(e,t){return e.position-t.position}))),g(e),h({position:y,alignment:c})}},Z.a.t("设置")),E.a.createElement(ce.a,{onClick:function(){if(null!==u){var e=o()(p).filter((function(e){return e.position!==u.position}));if(g(e),!R.find((function(e){return e===u.position}))){var t=o()(R);t.push(u.position),T(t),h(null)}}}},Z.a.t("清除"))),E.a.createElement(Ee,null),E.a.createElement("div",{style:{display:"flex",justifyContent:"right"}},E.a.createElement(ce.a,{onClick:function(){N(!0),g([])},style:{width:"88px"}},Z.a.t("全部清除"))))))};Oe.propTypes={isVisible:P.a.bool.isRequired,setVisible:P.a.func.isRequired,tabList:P.a.array,tabSize:P.a.number,setTabList:P.a.func.isRequired,setTabSize:P.a.func.isRequired};var ke=Oe,xe=n("d3d31c86eb"),Me=n("9da6335152");function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(){return{opername:Me.e.DOC_PPT,module:Me.d.PARAGRAPH_PANEL}}var Re,Te,Ae,De,Le,Ne=n("5cdbac46e8"),je=n("0f25ec4562");function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g()(this,n)}}var Fe={left:0,top:0,width:374,height:102};function Ue(e){return null==e||isNaN(e)}var ze=(Re=Reflect.metadata("design:type",Function),Te=Reflect.metadata("design:paramtypes",[void 0]),Object(x.b)(Ae=Re(Ae=Te((Le=De=function(e){v()(n,e);var t=_e(n);function n(e){var i;l()(this,n),i=t.call(this,e),w()(h()(i),"initMultiVal",void 0),w()(h()(i),"initFixedVal",void 0),w()(h()(i),"previewRef",void 0),w()(h()(i),"previewEditor",void 0),w()(h()(i),"initLineHeightType",void 0),w()(h()(i),"initTabList",void 0),w()(h()(i),"setTabstopModalVisible",(function(e){Object(xe.c)(Ce(Ce({},Ie()),{},{action:Me.b.TABS_CLK})),i.setState({isTabstopModalVisible:e})})),w()(h()(i),"initPreview",(function(){var e=new L.a(new N.c,{native:i.previewRef,interactive:!1});n.previewRendererApplication=e,e.resolution=Math.ceil(window.devicePixelRatio),e.width=374,e.height=102;var t=new je.a({paragraphList:i.state.paragraphList,selectable:!1,editable:!1,modelKey:"paragraph-dialog-preview",textRect:Fe},i.props.editorServices);i.previewEditor=t,e.stage.addChild(t.editorContainer),e.requestRender()})),w()(h()(i),"hideModal",(function(){n.paragraphManager.hideParagraph()})),w()(h()(i),"judgeEditableLock",(function(){var e;return!(i.props.userPriviledgeService.pptEditorState>Ne.b.EDITABLE)||(null===(e=i.props.tipsManager)||void 0===e||e.showCannotEditTips(),!1)})),w()(h()(i),"handleModalOK",(function(e){if(e&&i.judgeEditableLock()){var t={alignmentType:i.state.alignmentType,lineHeight:i.lineHeight,lineHeightType:i.state.lineHeightType,marginLeft:i.state.marginLeft,textIndent:"hanging"===i.state.textIndentType?-i.state.textIndent:i.state.textIndent,spaceBefore:i.state.spaceBefore,spaceAfter:i.state.spaceAfter,tabList:i.state.tabList,tabSize:i.state.tabSize};(function(e){e.alignmentType&&Object(xe.c)(Ce(Ce({},Ie()),{},{action:Me.b.SET_ALIGNMENT,ver5:e.alignmentType})),e.textIndent&&Object(xe.c)(Ce(Ce({},Ie()),{},{action:Me.b.SET_INDENTATION,ver5:e.textIndent})),e.lineHeight&&e.lineHeightType&&Object(xe.c)(Ce(Ce({},Ie()),{},{action:Me.b.SET_SPACING,ver5:3,ver6:e.lineHeight,ver7:e.lineHeightType})),e.spaceBefore&&Object(xe.c)(Ce(Ce({},Ie()),{},{action:Me.b.SET_SPACING,ver5:1,ver6:e.spaceBefore})),e.spaceAfter&&Object(xe.c)(Ce(Ce({},Ie()),{},{action:Me.b.SET_SPACING,ver5:2,ver6:e.spaceAfter})),(e.tabList||e.tabSize)&&Object(xe.c)(Ce(Ce({},Ie()),{},{action:Me.b.ADD_TAB,ver5:JSON.stringify(e.tabList),ver6:e.tabSize}))})(t=i.filterUpdatePropsIfUnchanged(t)),n.paragraphManager.updateUI(t),i.hideModal()}})),w()(h()(i),"handleLineHeightTypeChange",(function(e){i.setState({lineHeightType:e},i.updatePreview)})),w()(h()(i),"handleMarginLeftChange",(function(e){var t=parseFloat(e);isNaN(t)||i.setState({marginLeft:t},i.updatePreview)})),w()(h()(i),"handleTextIndentChange",(function(e){var t=parseFloat(e);isNaN(t)||i.setState({textIndent:t},i.updatePreview)})),w()(h()(i),"handleSpaceBeforeChange",(function(e){e=parseFloat(e),isNaN(e)||i.setState({spaceBefore:e},i.updatePreview)})),w()(h()(i),"handleSpaceAfterChange",(function(e){e=parseFloat(e),isNaN(e)||i.setState({spaceAfter:e},i.updatePreview)})),w()(h()(i),"handleAlignmentTypeChange",(function(e){i.setState({alignmentType:e},i.updatePreview)})),w()(h()(i),"handleLineHeightChange",(function(e){var t=parseFloat(e);isNaN(t)||(i.state.lineHeightType===z.a.Multi?i.setState({multiVal:i.fixLineHeight(t)},i.updatePreview):i.setState({fixedVal:i.fixLineHeight(t)},i.updatePreview))})),w()(h()(i),"fixLineHeight",(function(e){function t(e,t){var n=Number(e);return isNaN(n)?e:Math.floor(n*Math.pow(10,t))/Math.pow(10,t)}if(""===e)return e;var n=e;return i.state.lineHeightType===z.a.Multi?/^\d{1,}(\.\d{0,2})?$/.test(n)||(n=t(n,2)):/^\d{1,}(\.\d{0,1})?$/.test(n)||(n=t(n,1)),n})),w()(h()(i),"updatePreview",(function(){var e,t=ie(He(He({},i.state),{},{lineHeight:i.lineHeight}));null===(e=i.previewEditor)||void 0===e||e.updateEditorProps({paragraphList:t,shouldUpdate:!0,textRect:Fe}),i.setState({paragraphList:t})})),i.initMultiVal=1,i.initFixedVal=1;var r=i.initStatesFromParagraphManager(),a={lineHeightType:"",alignmentType:"",marginLeft:void 0,textIndent:void 0,textIndentType:"",spaceBefore:void 0,spaceAfter:void 0,tabList:void 0,tabSize:void 0};return i.state=He(He(He({multiVal:1,fixedVal:20},a),r),{},{paragraphList:ie(He(He({},a),r)),isTabstopModalVisible:!!e.isTabstopModalVisible}),i.previewRef=null,i.previewEditor=null,i}return d()(n,[{key:"componentDidMount",value:function(){this.initPreview()}},{key:"lineHeight",get:function(){return this.getLineHeight(this.state.lineHeightType,this.state.multiVal,this.state.fixedVal)}},{key:"render",value:function(){var e=this,t=this.state.lineHeightType===z.a.Multi?this.state.multiVal:this.state.fixedVal;return E.a.createElement(E.a.Fragment,null,E.a.createElement(I.a,{className:U["para-panel-wrapper"],maskClosable:!1,title:Z.a.t("段落"),visible:!0,okText:Z.a.t("应用"),cancelText:Z.a.t("取消"),onCancel:this.hideModal.bind(this,{resumeEditorSelection:!0}),onClose:this.hideModal.bind(this,{resumeEditorSelection:!0}),onOk:this.handleModalOK,style:{width:422},action:"".concat(Z.a.t("制表符"),"..."),onClickAction:function(){return e.setTabstopModalVisible(!0)}},E.a.createElement("div",null,E.a.createElement("div",null,E.a.createElement("div",null,"".concat(Z.a.t("常规")).concat(Z.a.t("："))),E.a.createElement("div",{className:U["para-panel-item"]},E.a.createElement("div",{className:U["para-panel-item-title"],style:{marginLeft:"14px"}},"".concat(Z.a.t("对齐")).concat(Z.a.t("："))),E.a.createElement(T.a,{value:this.state.alignmentType,onChange:this.handleAlignmentTypeChange,style:{width:110,height:28}},E.a.createElement(T.a.Option,{value:J.a.HORIZONTAL_LEFT},Z.a.t("向左对齐")),E.a.createElement(T.a.Option,{value:J.a.HORIZONTAL_CENTER},Z.a.t("居中对齐")),E.a.createElement(T.a.Option,{value:J.a.HORIZONTAL_RIGHT},Z.a.t("向右对齐")),E.a.createElement(T.a.Option,{value:J.a.HORIZONTAL_JUSTIFY},Z.a.t("两端对齐")),E.a.createElement(T.a.Option,{value:J.a.HORIZONTAL_DISTRIBUTE},Z.a.t("分散对齐"))))),E.a.createElement(D.a,{style:{margin:"15px 0"}}),E.a.createElement("div",{className:U["para-panel"]},E.a.createElement("div",null,"".concat(Z.a.t("缩进")).concat(Z.a.t("："))),E.a.createElement("div",{className:U["para-panel-item"],style:{marginLeft:"14px"}},E.a.createElement("div",{className:U["para-panel-item-title"]},"".concat(Z.a.t("文本之前")).concat(Z.a.t("："))),E.a.createElement(de.g,{value:this.state.marginLeft,step:.1,defaultValue:0,allowDecimal:!0,max:G,min:K,toFixed:2,onChange:this.handleMarginLeftChange,style:{width:80}}),E.a.createElement(me,{unitStr:Z.a.t("厘米")}))),E.a.createElement("div",{style:{marginTop:"10px",width:"10px"}}),E.a.createElement("div",{className:U["para-panel"]},E.a.createElement("div",{className:U["para-panel-item"],style:{marginLeft:"14px"}},E.a.createElement("div",{className:U["para-panel-item-title"]},"".concat(Z.a.t("特殊格式")).concat(Z.a.t("："))),E.a.createElement(T.a,{onChange:function(t){if(t!==e.state.textIndentType){var n=e.state.textIndent;"none"===t?n=0:"none"===e.state.textIndentType&&(n=1.27),e.setState({textIndentType:t,textIndent:n},e.updatePreview)}},style:{width:110,height:28},value:this.state.textIndentType},E.a.createElement(T.a.Option,{value:"none"},"".concat(Z.a.t("（")).concat(Z.a.t("无")).concat(Z.a.t("）"))),E.a.createElement(T.a.Option,{value:"hanging"},Z.a.t("悬挂")),E.a.createElement(T.a.Option,{value:"first-line"},Z.a.t("第一行"))),E.a.createElement("div",{className:"".concat(U["para-panel-item-title"]," ").concat(U["para-panel-item-sub-title"])},"".concat(Z.a.t("数值")).concat(Z.a.t("："))),E.a.createElement(de.g,{value:this.state.textIndent,defaultValue:0,allowDecimal:!0,disabled:"none"===this.state.textIndentType||""===this.state.textIndentType,step:.1,max:G,min:K,toFixed:2,onChange:this.handleTextIndentChange,style:{width:80}}),E.a.createElement(me,{unitStr:Z.a.t("厘米")}))),E.a.createElement(D.a,{style:{margin:"15px 0"}}),E.a.createElement("div",{className:U["para-panel"]},E.a.createElement("div",null,"".concat(Z.a.t("间距")).concat(Z.a.t("："))),E.a.createElement("div",{className:U["para-panel-item"],style:{marginLeft:"14px"}},E.a.createElement("div",{className:U["para-panel-item-title"]},"".concat(Z.a.t("段前")).concat(Z.a.t("："))),E.a.createElement(de.g,{value:this.state.spaceBefore,defaultValue:0,allowDecimal:!0,step:6,max:V,min:Y,toFixed:2,onChange:this.handleSpaceBeforeChange,style:{width:80}}),E.a.createElement(me,{unitStr:Z.a.t("磅"),style:{marginRight:14}})),E.a.createElement("div",{className:U["para-panel-item"]},E.a.createElement("div",{className:"".concat(U["para-panel-item-title"]," ").concat(U["para-panel-item-sub-title"])},"".concat(Z.a.t("段后")).concat(Z.a.t("："))),E.a.createElement(de.g,{value:this.state.spaceAfter,defaultValue:0,allowDecimal:!0,step:6,max:V,min:Y,toFixed:2,onChange:this.handleSpaceAfterChange,style:{width:80}}),E.a.createElement(me,{unitStr:Z.a.t("磅")}))),E.a.createElement("div",{style:{marginTop:"10px",width:"10px"}}),E.a.createElement("div",{className:U["para-panel"],style:{marginLeft:"14px"}},E.a.createElement("div",{className:U["para-panel-item"]},E.a.createElement("div",{className:U["para-panel-item-title"]},"".concat(Z.a.t("行间距")).concat(Z.a.t("："))),E.a.createElement(T.a,{value:this.state.lineHeightType,onChange:this.handleLineHeightTypeChange,style:{width:110,height:28}},E.a.createElement(T.a.Option,{value:z.a.Multi},Z.a.t("多倍行距")),E.a.createElement(T.a.Option,{value:z.a.Fixed},Z.a.t("固定值")))),E.a.createElement("div",{className:U["para-panel-item"]},E.a.createElement("div",{className:"".concat(U["para-panel-item-title"]," ").concat(U["para-panel-item-sub-title"])},"".concat(Z.a.t("数值")).concat(Z.a.t("："))),E.a.createElement(de.g,{value:""===this.state.lineHeightType?null:t,defaultValue:0,allowDecimal:!0,disabled:""===this.state.lineHeightType,step:this.state.lineHeightType===z.a.Multi?.25:1,max:this.state.lineHeightType===z.a.Multi?9.9:V,min:this.state.lineHeightType===z.a.Multi?.25:.7,toFixed:2,onChange:this.handleLineHeightChange,style:{width:80}}),E.a.createElement(me,{unitStr:this.state.lineHeightType===z.a.Multi&&Z.a.t("倍")||Z.a.t("磅")}))),E.a.createElement("div",{style:{marginTop:26}},E.a.createElement("div",null,Z.a.t("预览")),E.a.createElement("div",{className:U["para-preview-wrapper"]},E.a.createElement("canvas",{ref:function(t){return e.previewRef=t}}))))),E.a.createElement(ke,{isVisible:this.state.isTabstopModalVisible,setVisible:this.setTabstopModalVisible,tabList:this.state.tabList,tabSize:this.state.tabSize,setTabList:function(t){return e.setState({tabList:t})},setTabSize:function(t){return e.setState({tabSize:t})}}))}},{key:"initStatesFromParagraphManager",value:function(){var e={},t=n.paragraphManager.alignmentType;"string"==typeof t&&(e.alignmentType=t);var i=n.paragraphManager,r=i.lineHeight,a=i.lineHeightType;void 0!==a&&(e.lineHeightType=a,this.initLineHeightType=a,void 0!==r&&(e.lineHeight=r,a===z.a.Multi?(e.multiVal=r,this.initMultiVal=r):(e.fixedVal=r,this.initFixedVal=r)));var c=n.paragraphManager.marginLeft;Ue(c)||(e.marginLeft=c);var l=n.paragraphManager.textIndent;if(!Ue(l)){var s="none";l>0?s="first-line":l<0&&(s="hanging"),e.textIndent=Math.abs(l),e.textIndentType=s}var d=n.paragraphManager.spaceBefore;Ue(d)||(e.spaceBefore=d);var u=n.paragraphManager.spaceAfter;Ue(u)||(e.spaceAfter=u);var h=n.paragraphManager.tabList;void 0!==h&&(this.initTabList=o()(h),e.tabList=o()(h));var f=n.paragraphManager.tabSize;return Ue(f)||(e.tabSize=f),e}},{key:"getLineHeight",value:function(e,t,n){return e===z.a.Multi&&t||n}},{key:"filterUpdatePropsIfUnchanged",value:function(e){var t=this,n=He({},e);return Object.entries(e).forEach((function(i){var a=r()(i,2),o=a[0],c=a[1],l="init".concat(o.charAt(0).toUpperCase()).concat(o.slice(1));if("initTabList"===l&&Array.isArray(e[o])){var s=t[l];s.length===e[o].length&&e[o].every((function(e,t){return e.position===s[t].position&&e.alignment===s[t].alignment}))&&delete n[o]}else{if(o.toLowerCase().includes("lineheight"))return;t[l]===c&&delete n[o]}})),this.getLineHeight(this.state.lineHeightType,this.state.multiVal,this.state.fixedVal)===this.getLineHeight(this.initLineHeightType,this.initMultiVal,this.initFixedVal)&&(delete n.lineHeight,delete n.lineHeightType),n}}],[{key:"setParagraphManager",value:function(e){n.paragraphManager=e}},{key:"show",value:function(e){return this.wrapperDiv=document.createElement("div"),k.a.render(E.a.createElement(n,e),this.wrapperDiv)}},{key:"remove",value:function(){var e;null===(e=n.previewRendererApplication)||void 0===e||e.dispose(),n.previewRendererApplication=null,k.a.unmountComponentAtNode(this.wrapperDiv)}}]),n}(S.Component),w()(De,"propTypes",{userPriviledgeService:P.a.object,tipsManager:P.a.object,isTabstopModalVisible:P.a.bool}),w()(De,"wrapperDiv",void 0),w()(De,"previewRendererApplication",null),w()(De,"paragraphManager",void 0),Ae=Le))||Ae)||Ae)||Ae);t.default=ze},"9a76feb8cf":function(e,t,n){"use strict";n.r(t),n.d(t,"MobileRightMenuMananger",(function(){return m}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=(n("b8217400dc"),n("e6f68cdf2e"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("0a8ecd6412")),d=n("b86964b011"),u=n("d9812f1c6f"),h=n("6884e1a126"),f=n("f07c143fa2"),v=n("5cdbac46e8"),p=n("d5c3deb8c7");function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(){function e(){var t=this;r()(this,e),l()(this,"isClickOnElement",!1),l()(this,"showMenuTimeout",void 0),l()(this,"services",void 0),l()(this,"reaction",Object(p.r)((function(){var e,n;return[null===(e=t.getSelectionService())||void 0===e?void 0:e.currentSlide,null===(n=t.getSelectionService())||void 0===n?void 0:n.lastMouseDownRegion]}),(function(){t.showMenuTimeout&&clearTimeout(t.showMenuTimeout)}))),l()(this,"timer",null),l()(this,"removeEvents",(function(){document.body.removeEventListener("touchstart",t.bodyClickHandler,!0),u.a.isIpadAndTencentDocApp&&document.body.removeEventListener("mousedown",t.bodyClickHandler),t.timer&&clearTimeout(t.timer)})),l()(this,"bodyClickHandler",(function(e){(t.isClickOnElement=!1,t.isClickOnElement)||(t.clickOnMenu(e,15)||t.addLaterEvents())})),l()(this,"clickOnMenu",(function(e,t){for(var n=e.target,i=0;n&&i<t;){var r,a,o;if(i++,null!==(r=n=n.parentNode)&&void 0!==r&&null!==(a=r.classList)&&void 0!==a&&null!==(o=a.value)&&void 0!==o&&o.includes("mobile-context-menu_contextmenu-mobile-submenus-list"))return!0}return!1})),l()(this,"addEvents",(function(){document.body.addEventListener("touchstart",t.bodyClickHandler,!0),u.a.isIpadAndTencentDocApp&&(t.timer&&clearTimeout(t.timer),t.timer=setTimeout((function(){document.body.addEventListener("mousedown",t.bodyClickHandler)}),500))})),l()(this,"addLaterEvents",(function(){document.body.addEventListener("touchend",t.touchEndHandler,!0)})),l()(this,"touchEndHandler",(function(){setTimeout((function(){t.hideMenu()}),50),document.body.removeEventListener("touchend",t.touchEndHandler,!0)}))}return o()(e,[{key:"setServiceDelegates",value:function(e){this.services=b(b({},this.services),e)}},{key:"hideMenu",value:function(){h.e.get(f.a).hideContextMenu(),this.removeEvents()}},{key:"showMenu",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;this.showMenuTimeout&&clearTimeout(this.showMenuTimeout),this.services.toolbarStateManager.isMobileToolbarClick?this.services.toolbarStateManager.isMobileToolbarClick=!1:this.showMenuTimeout=setTimeout((function(){t.showMenuLogicCanvas(e)}),n)}},{key:"isContextMenuShow",value:function(){return h.e.get(f.a).isContextMenuShow()}},{key:"showNoteAreaMenu",value:function(e){var t,n={top:e.top,left:(e.left+e.right)/2,bottom:e.bottom},i=e.container;null!=i&&(t=i.getBoundingClientRect(),n.top=n.top-i.scrollTop+e.offsetTop,n.bottom=n.bottom-i.scrollTop+e.offsetTop,n.left-=i.scrollLeft,n.top+=t.top,n.bottom+=t.top,n.left+=t.left,n.bottom>t.height-65&&(n.offsetAfterPostionChanged=t.height/2));var r=document.documentElement.scrollTop||document.body.scrollTop||0,a=t?{boundingRectLeft:0,boundingRectRight:t.right,boundingRectTop:s.j+(u.a.isTencentDocApp?s.j:0),boundingRectBottom:t.bottom+r}:null;n.top+=r,a.offsetAfterPostionChanged=n.offsetAfterPostionChanged||n.bottom-Math.max(n.top,0),h.e.get(f.a).showContextMenu(n.left,n.top,!1,a),this.addEvents()}},{key:"showSlideMenu",value:function(e){var t,n,i=null===(t=e.target)||void 0===t||null===(n=t.getBoundingClientRect)||void 0===n?void 0:n.call(t);if(i){var r=document.getElementById("slide-list-m-container"),a=null==r?void 0:r.getBoundingClientRect(),o=h.e.get(f.a),c=!Object(d.m)()||u.a.isWideScreenDevice;o.showContextMenu(e.left,i.top,!1,a?{boundingRectLeft:0,boundingRectRight:c?document.documentElement.clientWidth:a.right,boundingRectTop:c?a.top:0,offsetAfterPostionChanged:c?Math.abs(i.bottom-i.top):0}:void 0),this.addEvents()}}},{key:"showMenuLogicCanvas",value:function(e){var t;if(!(this.getUserPriviledgeService().pptEditorState>v.b.EDITABLE)){var n=document.getElementById("canvas");if(n){var i,r=n.getBoundingClientRect(),a=(null===(t=document.querySelector("html"))||void 0===t?void 0:t.scrollTop)||0,o=r?{boundingRectLeft:0,boundingRectRight:r.right,boundingRectTop:r.top-a,boundingRectBottom:r.bottom+a}:null;if(!e){var c,l,s=null===(c=this.getSelectionService().selectedElements)||void 0===c||null===(l=c.selectedArray)||void 0===l?void 0:l[0];if(s){var d=document.querySelector("#slide-element-".concat(s.key));i=null==d?void 0:d.getBoundingClientRect()}}var u=e||i||{},p=u.top,g=void 0===p?0:p,b=u.bottom,m=void 0===b?0:b;o.offsetAfterPostionChanged=Math.abs(m)-Math.abs(g);var y=this.getTargetPosition(r,e,i);h.e.get(f.a).showContextMenu(y.left,y.top,!1,o),this.addEvents()}}}},{key:"getTargetPosition",value:function(e,t,n){var i,r,a={left:e.left,top:e.top},o=null===(i=this.getSelectionService().selectedElements)||void 0===i||null===(r=i.selectedArray)||void 0===r?void 0:r[0];if(o&&t){var c=this.services.contentRendererService.canvasSize;a.left+=(t.left+t.right)/2+c.left,a.top+=t.top+c.top}else if(o&&n)a.left=(n.left+n.right)/2,a.top=n.top;else{var l=this.services.contentRendererService.contentSize;a.top+=l.top+l.cTop-5,a.left+=(e.width||0)/2}return a}},{key:"getSelectionService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.selectionService}},{key:"getUserPriviledgeService",value:function(){var e;return null===(e=this.services)||void 0===e?void 0:e.userPriviledgeService}}]),e}()},"9d0dafe5f3":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return L}));var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("85d0a7609b"),l=n.n(c),s=(n("963f2eaace"),n("8ee19818c4"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("73b854064b"),n("547611bd96")),d=n.n(s),u=n("bd29e2df90"),h=n.n(u),f=n("ab5eb40518"),v=n.n(f),p=n("1b4cdd6a36"),g=n.n(p),b=(n("7eaa8e90a5"),n("1bab7b5fb7"),n("9d7978d445"),n("69084d01d3")),m=n.n(b),y=n("2e0796c118"),w=n.n(y),S=n("21f6c93a07");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v()(this,n)}}var x=function(e){h()(n,e);var t=k(n);function n(e,i){var a;return r()(this,n),a=t.call(this,e,i),l()(d()(a),"showToolbar",(function(e){a.state.isShown?a.setState({config:e}):a.setState({isShown:!0,config:e})})),l()(d()(a),"hideMenu",(function(){a.state.isShown&&a.setState({isShown:!1})})),l()(d()(a),"isShown",(function(){return a.state.isShown})),l()(d()(a),"handleContextMenu",(function(){a.hideMenu()})),a.state={isShown:!1,config:{left:a.props.left,top:a.props.top,width:a.props.width,height:a.props.height}},a}return o()(n,[{key:"componentDidMount",value:function(){var e=O({},this.props);this.setState({config:e})}},{key:"render",value:function(){var e=this.props.scale,t=this.props.scrollT,n=this.props.scrollL,i=this.state.isShown?"block":"none",r=this.state.config;return m.a.createElement(m.a.Fragment,null,m.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{left:0,top:0,width:r.width>1?Math.ceil(r.width):1,height:r.height>1?Math.ceil(r.height):1,position:"absolute",overflow:"visible",display:i},pointerEvents:"none"},m.a.createElement("rect",{style:{display:i},x:Math.ceil(r.left-5-n/e)-.5,y:Math.ceil(r.top-5-t/e)-.5,width:Math.ceil(r.width+10)+1,height:Math.ceil(r.height+10)+1,stroke:"#ffffff",strokeOpacity:.32,strokeWidth:1,fillOpacity:0,strokeDasharray:2,pointerEvents:"stroke"}),m.a.createElement("rect",{style:{display:i},x:Math.ceil(r.left-5-n/e)+.5,y:Math.ceil(r.top-5-t/e)+.5,width:Math.ceil(r.width+10)-1,height:Math.ceil(r.height+10)-1,stroke:"#000000",strokeOpacity:.32,strokeWidth:1,fillOpacity:0,strokeDasharray:2,pointerEvents:"stroke"})))}}],[{key:"createMenu",value:function(e){var t,i=document.getElementById(S.a.MULTI_SELECTED_DASH_OUTER),r=null===(t=document.defaultView)||void 0===t?void 0:t.getComputedStyle(i).transform,a=parseFloat(r.substring(7).split(",")[0]),o=document.getElementById(S.a.CANVAS),c=(null==o?void 0:o.scrollTop)||(null==o?void 0:o.pageYOffset)||(null==o?void 0:o.scrollTop),l=(null==o?void 0:o.scrollLeft)||(null==o?void 0:o.pageXOffset)||(null==o?void 0:o.scrollLeft),s=O(O({},e),{},{scrollT:c,scrollL:l,scale:a}),d=w.a.render(m.a.createElement(n,s),i);return{show:function(e){s=O(O({},e),{},{scrollT:c,scrollL:l,scale:a}),d&&d.showToolbar(s)},isShown:function(){return!!d&&d.isShown()},hide:function(){if(d)return d.hideMenu()}}}}]),n}(b.Component),M=n("d5c3deb8c7"),P=n("281cbdced7"),C=n.n(P),I=n("7b0ebf3e1a"),R=n("e0e8dd9366"),T=n("7d52e7e74a");function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(){function e(t,n){var i=this;r()(this,e),l()(this,"changeFloatState",C()((function(){var e=i.selectionService.selectedElements.selectedArray;e&&e.length>1?i.showOuter():i.hideOuter()}),5,{maxWait:10})),l()(this,"menuOper",void 0),l()(this,"selectedArray",void 0),l()(this,"delayShowTimer",void 0),this.selectionService=t,this.editingStateManager=n,this.menuOper=null,Object(M.r)((function(){var e,t;return{selectedLength:i.selectionService.selectedElements.length,curSlideChildrenLength:null===(e=i.selectionService.currentSlide)||void 0===e||null===(t=e.children)||void 0===t?void 0:t.length}}),(function(){i.changeFloatState(),i.removeObserverForModels(i.selectedArray);var e=i.selectionService.selectedElements.selectedArray;i.selectedArray=e?e.slice(0,e.length):null,i.addObserverForModels(i.selectedArray)})),Object(M.r)((function(){return i.editingStateManager.isInAnyEditingState()}),(function(e){e?i.hideOuter():i.changeFloatState()}))}return o()(e,[{key:"addObserverForModels",value:function(e){var t=this;e&&e.forEach((function(e){e.changeSetEngine.addObserveForChangeAtPath("spPr.xfrm",t.changeFloatState)}))}},{key:"removeObserverForModels",value:function(e){var t=this;e&&e.forEach((function(e){e.changeSetEngine.removeObserveForChangeAtPath("spPr.xfrm",t.changeFloatState)}))}},{key:"calculateFrame",value:function(e){var t=this.getRealFrame(e[0]),n=Object(I.j)(t,t.rotate),i=n.left,r=n.top,a=i+n.width,o=r+n.height;return e.slice(1).forEach((function(e){var t=e.getFrame().outerFrameOnSlide();i=Math.min(i,t.left),r=Math.min(r,t.top),a=Math.max(a,t.left+t.width),o=Math.max(o,t.top+t.height)})),{left:i,top:r,width:a-i,height:o-r}}},{key:"getRealFrame",value:function(e){var t,n=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).frameOnSlide();return e.type===R.d.GROUP?D(D({},n),{},{left:n.left-T.a,top:n.top-T.a,width:n.width+2*T.a,height:n.height+2*T.a}):n}},{key:"showOuter",value:function(){var e=this,t=this.selectionService.selectedElements.selectedArray;null!=t&&t.length&&(null==t?void 0:t.length)>1&&(this.delayShowTimer&&clearTimeout(this.delayShowTimer),this.delayShowTimer=setTimeout((function(){if(null!=t&&t.length&&(null==t?void 0:t.length)>1){var n=e.calculateFrame(t);e.menuOper=x.createMenu(n),e.menuOper.show(n)}else clearTimeout(e.delayShowTimer)})))}},{key:"hideOuter",value:function(){this.delayShowTimer&&clearTimeout(this.delayShowTimer),this.menuOper&&this.menuOper.hide()}}]),e}()},a55553ef74:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));n("3bf1976a4f");var i=n("4aef4ce634"),r=n.n(i);function a(e,t,n){var i=n.value;return n.value=function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return i.call.apply(i,[this,e].concat(r))},n}function o(e,t,n){var i=n.value;return n.value=function(e){var t;null==e||null===(t=e.preventDefault)||void 0===t||t.call(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return i.call.apply(i,[this,e].concat(r))},n}function c(e){return function(t,n,i){var a=i.value;return i.value=r()(a,e),i}}},a8236551f7:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.NOTIFY="notify",e.SHORTCUT="shortcut_panel",e.READ_RECORD="read-record",e.HISTORY="history"}(i||(i={}))},abfb7d799d:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return L}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("547611bd96"),l=n.n(c),s=n("bd29e2df90"),d=n.n(s),u=n("ab5eb40518"),h=n.n(u),f=n("1b4cdd6a36"),v=n.n(f),p=n("85d0a7609b"),g=n.n(p),b=(n("3bf1976a4f"),n("6e20b6a7d8"),n("b1e2246d82"),n("69084d01d3")),m=n.n(b),y=n("1748118723"),w=n.n(y),S=n("e792a3169a"),E=n.n(S),O=n("6e82698d02"),k=n.n(O),x={insert:"head",singleton:!1},M=(E()(k.a,x),k.a.locals||{}),P=n("d9812f1c6f"),C=n("6b5202729c");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var R=function(e){d()(n,e);var t=I(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),g()(l()(e),"state",{visible:!1,animating:!1}),e}return o()(n,[{key:"show",value:function(){var e,t;null===(e=(t=this.props).willShow)||void 0===e||e.call(t,this),this.setState({visible:!0,animating:!0})}},{key:"hide",value:function(){this.displaying&&this.setState({visible:!1,animating:!0})}},{key:"animationEnd",value:function(){var e,t;(this.setState({animating:!1}),this.state.visible)||(null===(e=(t=this.props).didHide)||void 0===e||e.call(t,this))}},{key:"displaying",get:function(){return this.state.animating||this.state.visible}},{key:"render",value:function(){var e=this.props,t=e.id,n=void 0===t?"base":t,i=e.width;return m.a.createElement("div",{id:"rs-bar-".concat(n),className:w()(M[this.state.animating?"rs-bar-wrapper-animating":"rs-bar-wrapper-hold"],this.state.visible?M.enter:M.leave,M["rs-bar-".concat(n)]),onAnimationEnd:this.animationEnd.bind(this),style:{display:this.displaying?"block":"none",width:i?"".concat(i,"px"):""}})}}]),n}(b.Component);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h()(this,n)}}var L=function(e){d()(n,e);var t=D(n);function n(e){var i;return r()(this,n),i=t.call(this,e),g()(l()(i),"service",void 0),i.service=e.getRightSideBarService(),i.service.setViewDelegate(new C.a(l()(i))),i}return o()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.zIndex,i=void 0===n?1:n,r=t.top,a=void 0===r?0:r,o=t.bottom,c=void 0===o?32:o,l=this.getState(),s={width:l.width,left:"calc(100vw - 280px)"};return m.a.createElement("div",{className:w()(M["rs-bar-container"],{"rs-bar-container-pad":P.a.isPad}),id:"rs-bar-container","data-display":l.visible,style:A({display:l.visible?"block":"none",zIndex:i,top:"".concat(a,"px"),height:"calc(100% - ".concat(a,"px - ").concat(c,"px)")},s)}," ",this.service.getModules().map((function(t){return m.a.createElement(R,{id:t.name,key:t.name,ref:function(e){return t.wrapper=e},willShow:function(){return e.service.onModuleWillShow(t)},didHide:function(){return e.service.onModuleDidHide(t)}})})))}},{key:"getState",value:function(){return this.service.getModel()}}]),n}(b.Component)},b24d0bdd83:function(e,t,n){"use strict";n.r(t),n.d(t,"OcrMobileService",(function(){return O}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("176815363d"),r=n.n(i),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),h=n.n(u),f=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("081c8cafea"),n("5aa0e40fcc")),v=n("d3d31c86eb"),p=n("9da6335152"),g=n("cd1934c1b5"),b=n("775b80aea6"),m=n("3f38f7f582"),y=n("dab925d4ad"),w=n("d9812f1c6f");function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(){function e(){o()(this,e),d()(this,"eventListenMap",new Map),d()(this,"nativeTitlebarManager",void 0),d()(this,"services",void 0)}var t;return l()(e,[{key:"setServiceDelegates",value:function(e){this.services=E(E({},this.services),e)}},{key:"showOcrRightBar",value:(t=r()(h.a.mark((function e(t,n){var i,r,a,o,c,l,s=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.a)();case 2:if(i=e.sent,w.a.isTencentDocApp&&Object(f.c)()&&!w.a.isIPad&&this.nativeTitlebarManager&&(this.nativeTitlebarManager.visible=!1),r=n||t.props.src,a=t.key,!g.a.isBlobUrl(r)){e.next=18;break}if(o=b.a.getInstance().getResourceByUrl(r),!(c=null==o?void 0:o.getCdnUrl())){e.next=13;break}r=c,e.next=18;break;case 13:if(!this.eventListenMap.get(a)){e.next=15;break}return e.abrupt("return");case 15:return this.eventListenMap.set(a,!0),null==o||o.onDidUpload((function(e){s.eventListenMap.delete(a),s.showOcrRightBar(t,e.getCdnUrl())})),e.abrupt("return");case 18:l={ver5:"slide",ver6:1},i.show({imageUrls:[r],source:Object(m.getAidForReport)({feature:"slideocr",position:m.POSITIONS.PICTOOLBAR}),onClose:function(){i.hide(),w.a.isTencentDocApp&&Object(f.c)()&&!w.a.isIPad&&s.nativeTitlebarManager&&(s.nativeTitlebarManager.visible=!0)},tdwParams:l}),Object(v.c)({opername:p.e.OCR,module:p.d.OCR_PICTURE,action:p.b.OCR_ENTRANCE,eventcode:p.a.OCR_DOC_PICTURE_ENTRANCE,ver5:p.j.MOBILE_TOOLBAR_OCR}),Object(v.c)(E({opername:p.e.OCR_COMPONENTS,module:p.d.EXTRACT_TEXT,action:p.b.OCR_ENTRANCE},l));case 22:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"setNativeTitlebarManager",value:function(e){this.nativeTitlebarManager=e}}]),e}()},b5d9f27607:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={UNDO:"undo",REDO:"redo",FORWARD:"forward",BACKWARD:"backward",FRONT:"front",BACK:"back",CUT:"cut",COPY:"copy",PASTE:"paste",CTRL:"ctrl",DELETE:"delete",SELECTALL:"selectAll",PLAY:"play",UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",PAGEUP:"pageup",PAGEDOWN:"pagedown",HOME:"home",END:"end",ESC:"esc",NEWSLIDE_ENTER:"newSlideEnter",NEWSLIDE_M:"newSlideM",ITALIC:"italic",BOLD:"bold",DELETE_LINE:"delete-line",UNDERLINE:"underline",MOUSEWHEEL:"mousewheel",TABACTION:"tabAction",BLOCKCTRL_S:"blockCtrlS",ADD_GROUP:"addGroup",REMOVE_GROUP:"removeGroup",SEARCH:"search",REPLACE:"replace",ACCESSIBILITY:"accessibility",SHORTCUTPANEL:"shortcutPanel",LINK:"link",HIDE_SHOW_TOP_BAR:"hideShowTopBar",DISPLAY_GUIDES:"displayGuides",DISPLAY_GRID_LINE:"displayGridLine",PRINT:"print"}},b7099b52f5:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("bd29e2df90"),l=n.n(c),s=n("ab5eb40518"),d=n.n(s),u=n("1b4cdd6a36"),h=n.n(u),f=n("05d181ac40"),v=n("d9812f1c6f"),p=n("b5d9f27607");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return d()(this,n)}}var b=function(e){l()(n,e);var t=g(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"getExtraBubbleKeyConfig",value:function(){if(!f.a.IS_PC_LOCAL_EDIT){var e=v.a.isMac||v.a.isIPad?"command":"ctrl";return[{key:"".concat(e,"+s"),actionKey:p.a.BLOCKCTRL_S}]}return null}}]),n}(n("c1808b326d").a)},b80fcbab2f:function(e,t,n){"use strict";n.r(t),n.d(t,"MobileNoteAreaService",(function(){return H}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("547611bd96"),l=n.n(c),s=n("8eec1e4a03"),d=n.n(s),u=n("bd29e2df90"),h=n.n(u),f=n("ab5eb40518"),v=n.n(f),p=n("1b4cdd6a36"),g=n.n(p),b=n("85d0a7609b"),m=n.n(b),y=(n("3bf1976a4f"),n("8ee19818c4"),n("d5c3deb8c7")),w=n("68dfd6e92f"),S=n("570b26a0fa"),E=n("9da6335152"),O=n("1e07095161"),k=n("ec5cae33cb"),x=n("5aa0e40fcc"),M=n("6b65de7e72"),P=n("0a8ecd6412"),C=n("d9812f1c6f"),I=n("f73791d0a5"),R=n("5a0c794c87"),T=n("6a9e93341e"),A=n("84f4552293");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v()(this,n)}}var L=function(e){h()(n,e);var t=D(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),m()(l()(e),"mobileNoteShow",void 0),m()(l()(e),"editMode",void 0),m()(l()(e),"tempClose",void 0),m()(l()(e),"iosKeyboardHeight",void 0),e}return o()(n,[{key:"initModel",value:function(e,t){d()(g()(n.prototype),"initModel",this).call(this,e,t),this.noteAreaHeight=T.p,this.mobileNoteShow=!1,this.editMode=!1,this.tempClose=!1,this.iosKeyboardHeight=0}}]),n}(n("87c53f95ab").a),N=n("37091e4240");function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v()(this,n)}}var B=Math.max(document.body.clientHeight,document.body.clientWidth)+100,H=function(e){h()(n,e);var t=j(n);function n(){var e;r()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),m()(l()(e),"noteLayer",void 0),m()(l()(e),"keyboardHeightTimer",void 0),m()(l()(e),"leaveMobileFullScreenPending",void 0),m()(l()(e),"softKeyboard",void 0),m()(l()(e),"androidKeyBoardShow",void 0),m()(l()(e),"scrollPending",void 0),m()(l()(e),"cachedScrollTop",void 0),m()(l()(e),"topBlankDivHeight",void 0),m()(l()(e),"bottomBlankDivHeight",void 0),m()(l()(e),"touchStartY",void 0),m()(l()(e),"fixedLowIOSContainerStyleFlag",void 0),m()(l()(e),"preventBodyScrollFlag",void 0),m()(l()(e),"lastIsKeyBoardShow",void 0),m()(l()(e),"closeTimer",void 0),m()(l()(e),"getNoteAreaInfo",(function(){return{noteAreaHeight:e.model.noteAreaHeight,mobileNoteShow:e.model.mobileNoteShow}})),m()(l()(e),"handleMobileNoteEnterEditing",(function(){var t;null!==(t=e.services)&&void 0!==t&&t.selectionService&&(e.services.selectionService.lastMouseDownRegion=k.a.NOTE),window.dispatchEvent(new Event("enterEditing"))})),m()(l()(e),"handleMobileNoteExitEditing",(function(){window.dispatchEvent(new Event("exitEditing"))})),m()(l()(e),"enterEditMode",(function(){var t,n;null===(t=e.services)||void 0===t||null===(n=t.noteAreaManager)||void 0===n||n.enterMobileFullScreen()})),m()(l()(e),"handleButtonClick",(function(){C.a.isAndroid&&e.leaveMobileFullScreenPending||e.handleMobileNoteLeaveFullScreen()})),m()(l()(e),"handleButtonTouchEnd",(function(){var t,n,i,r;(null===(t=e.services)||void 0===t||null===(n=t.editorInstanceService)||void 0===n?void 0:n.checkEditorIsEditing())&&C.a.isAndroid&&(null===(i=document.activeElement)||void 0===i||null===(r=i.blur)||void 0===r||r.call(i),e.leaveMobileFullScreenPending=!0,e.closeTimer||(e.closeTimer=setTimeout((function(){e.leaveMobileFullScreenPending=!1,e.handleMobileNoteLeaveFullScreen()}),300)))})),m()(l()(e),"getPopupStyle",(function(){if(!e.model.editMode)return{position:"absolute",bottom:0,top:0,width:"100%",overflow:"hidden"};var t=Object(x.c)();return{position:"fixed",top:t?"".concat(P.j,"px"):"0",bottom:0,left:0,right:0,zIndex:4,backgroundColor:"#fff",overflow:"hidden",height:t?"calc(100% - ${MOBILE_HEAD_HEIGHT}px)":"100%"}})),m()(l()(e),"getContainerStyle",(function(){var t=e.model,n=t.editMode,i=t.mobileNoteShow,r=t.iosKeyboardHeight,a=t.noteAreaHeight;if(!n)return{position:"absolute",top:0,bottom:0,left:0,right:"38px",backgroundColor:M.a.FFFFFF,overflowY:i?"auto":"hidden",overflowX:"hidden",WebkitOverflowScrolling:"touch",height:a};var o=Object(x.c)();return{position:"absolute",top:"".concat(P.j,"px"),bottom:"".concat(r+40,"px"),left:0,right:0,backgroundColor:M.a.FFFFFF,overflowY:i?"auto":"hidden",overflowX:"hidden",WebkitOverflowScrolling:"touch",height:"calc(100% - 74px - ".concat(r+(o?P.j:0),"px)")}})),m()(l()(e),"addFullScreenModeEvent",(function(){N.b.on(N.a.IOS_KEY_BOARD_SHOW,e.onKeyBoardShow),N.b.on(N.a.IOS_KEY_BOARD_HIDE,e.onKeyBoardHide)})),m()(l()(e),"onDoubleTap",(function(){if(!e.model.editMode&&e.slideExistence()){var t,n,i=null===(t=e.noteLayer)||void 0===t?void 0:t.isShowPlaceHolder();e.enterEditMode(),i&&(null===(n=e.noteLayer)||void 0===n||n.setFocus()),Object(S.tdw)({module:E.d.SLIDE_MOBILE_NOTE,action:E.b.SLIDE_NOTE_MOBILE_ENTER_EDITING})}})),m()(l()(e),"onKeyboardChange",(function(t){t.isSupported&&((t.heightInViewport||t.heightOutOfViewport)>0?(e.androidKeyBoardShow=!0,e.onKeyBoardShow()):(e.androidKeyBoardShow=!1,e.onKeyBoardHide()))})),m()(l()(e),"onKeyBoardShow",(function(t){if(e.model.editMode&&"number"==typeof t)if(0===t){if(e.keyboardHeightTimer)return;e.keyboardHeightTimer=setTimeout((function(){e.updateModel({iosKeyboardHeight:0})}),50)}else e.keyboardHeightTimer&&clearTimeout(e.keyboardHeightTimer),e.keyboardHeightTimer=null,e.updateModel({iosKeyboardHeight:t});e.model.editMode||e.updateModel({tempClose:!0})})),m()(l()(e),"onKeyBoardHide",(function(){(e.model.iosKeyboardHeight||e.model.tempClose)&&e.updateModel({iosKeyboardHeight:0,tempClose:!1})})),m()(l()(e),"handleNoteScroll",(function(){var t;if(!e.scrollPending&&e.noteLayer.isLargeNote&&e.model.mobileNoteShow&&e.noteContainerRef){var n=e.noteContainerRef,i=n.scrollTop,r=e.cachedScrollTop<i,a=(null===(t=e.noteLayer)||void 0===t?void 0:t.getTextAreaHeightSync())||0;r?e.updateCanvasRenderOffsetScrollDown(n,a):e.updateCanvasRenderOffsetScrollUp(n,a),e.cachedScrollTop=i}})),m()(l()(e),"updateCanvasRenderOffsetScrollDown",(function(t,n){var i=t.scrollTop,r=t.clientHeight;B-(i-e.offsetTop+r)>R.b||0!==n-e.offsetTop-B&&(e.noteLayer.setOffsetTop(Math.min(i-R.a,n-B)),e.scrollPending=!0,e.noteLayer.updateTextEditorProps(),requestAnimationFrame((function(){e.scrollPending=!1,e.topBlankDivHeight=e.offsetTop,e.bottomBlankDivHeight=Math.ceil(n-e.offsetTop-B),e.setBlankDivHeight(e.topBlankDivHeight,e.bottomBlankDivHeight),e.noteContainerRef&&(e.noteContainerRef.scrollTop=i),e.noteLayer.updateCacheSelectionRect()})))})),m()(l()(e),"updateCanvasRenderOffsetScrollUp",(function(t,n){var i=t.scrollTop;0!==e.offsetTop&&(i-e.offsetTop>R.b||(e.noteLayer.setOffsetTop(Math.max(i-R.a,0)),e.scrollPending=!0,e.noteLayer.updateTextEditorProps(),requestAnimationFrame((function(){e.scrollPending=!1,e.topBlankDivHeight=e.offsetTop,e.bottomBlankDivHeight=n-e.offsetTop-B,e.setBlankDivHeight(e.topBlankDivHeight,e.bottomBlankDivHeight),e.noteContainerRef&&(e.noteContainerRef.scrollTop=i),e.noteLayer.updateCacheSelectionRect()}))))})),m()(l()(e),"setBlankDivHeight",(function(t,n){e.noteTopDivRef&&e.noteBottomDivRef&&(e.noteTopDivRef.style.height===t&&e.noteBottomDivRef.style.height===n||(e.noteTopDivRef.style.height="".concat(t||e.topBlankDivHeight,"px"),e.noteBottomDivRef.style.height="".concat(n||e.bottomBlankDivHeight,"px")))})),m()(l()(e),"updateBlankDivHeight",(function(t,n){var i;if(t<=B){var r;null!==(r=e.noteLayer)&&void 0!==r&&r.isLargeNote&&e.resetBlankDiv()}else{var a=(null===(i=e.noteContainerRef)||void 0===i?void 0:i.scrollTop)||0,o=a,c=Math.max(t-n-a,0);e.setBlankDivHeight(o,c)}})),m()(l()(e),"resetBlankDiv",(function(){e.topBlankDivHeight=0,e.bottomBlankDivHeight=0,e.setBlankDivHeight(0,0),e.noteLayer.setOffsetTop(0)})),m()(l()(e),"resetContainerScroll",(function(){var t;null!==(t=e.noteContainerRef)&&void 0!==t&&t.scrollTop&&e.noteContainerRef.scrollTo(0,0)})),m()(l()(e),"resetScroll",(function(){e.resetBlankDiv(),e.resetContainerScroll()})),m()(l()(e),"getTextAreaElemHeight",(function(){var t,n;return e.topBlankDivHeight+e.bottomBlankDivHeight+(null!==(t=null===(n=e.noteContainerRef)||void 0===n?void 0:n.clientHeight)&&void 0!==t?t:0)})),m()(l()(e),"updateNoteAreaByKeyboardChange",(function(t){var n,i,r=e.lastIsKeyBoardShow&&!t;!e.lastIsKeyBoardShow&&t&&C.a.isIOS&&(null===(n=e.noteLayer)||void 0===n||n.scrollToView());r&&(null===(i=e.noteLayer)||void 0===i||i.renderNoteFromKayBoardChange());e.lastIsKeyBoardShow=t})),m()(l()(e),"handleMobileNoteLeaveFullScreen",(function(){var t,n,i,r,a,o;(null===(t=e.services)||void 0===t||null===(n=t.editorInstanceService)||void 0===n?void 0:n.checkEditorIsEditing())&&(null===(a=document.activeElement)||void 0===a||null===(o=a.blur)||void 0===o||o.call(a));null===(i=e.services)||void 0===i||null===(r=i.noteAreaManager)||void 0===r||r.leaveMobileFullScreen(),e.closeTimer&&(clearTimeout(e.closeTimer),e.closeTimer=null)})),m()(l()(e),"leaveMobileFullScreenDelay",(function(){var t,n;e.leaveMobileFullScreenPending&&(null===(t=e.services)||void 0===t||null===(n=t.noteAreaManager)||void 0===n||n.leaveMobileFullScreen(),e.leaveMobileFullScreenPending=!1)})),m()(l()(e),"fixIOSNativeAction",(function(t){C.a.isIOS&&(t?(e.setPreventBodyScroll(),e.fixLowIOSContainerStyle()):(e.clearPreventBodyScroll(),e.clearFixLowIOSContainerStyle()))})),m()(l()(e),"setPreventBodyScroll",(function(){!e.preventBodyScrollFlag&&C.a.isIOS&&(document.body.addEventListener("touchstart",e.saveTouchStartPosition),document.body.addEventListener("touchmove",e.preventBodyScroll,{passive:!1}),e.preventBodyScrollFlag=!0)})),m()(l()(e),"clearPreventBodyScroll",(function(){e.preventBodyScrollFlag&&(document.body.removeEventListener("touchstart",e.saveTouchStartPosition),document.body.removeEventListener("touchmove",e.preventBodyScroll),e.preventBodyScrollFlag=!1)})),m()(l()(e),"preventBodyScroll",(function(t){t.touches[0].clientY<e.touchStartY&&e.isCanvasInBottom()&&t.preventDefault()})),m()(l()(e),"fixLowIOSContainerStyle",(function(){if(!e.fixedLowIOSContainerStyleFlag){var t=document.getElementById("mobile-container");t&&(t.style.overflow="visible",e.fixedLowIOSContainerStyleFlag=!0)}})),m()(l()(e),"clearFixLowIOSContainerStyle",(function(){var t=document.getElementById("mobile-container");t&&(t.style.overflow="auto",e.fixedLowIOSContainerStyleFlag=!1)})),m()(l()(e),"saveTouchStartPosition",(function(t){e.touchStartY=t.touches[0].clientY})),m()(l()(e),"isCanvasInBottom",(function(){var t,n,i,r;return Math.round((null===(t=e.noteCanvasRef)||void 0===t||null===(n=t.getBoundingClientRect())||void 0===n?void 0:n.bottom)||0)<=Math.round((null===(i=e.noteContainerRef)||void 0===i||null===(r=i.getBoundingClientRect())||void 0===r?void 0:r.bottom)||0)})),m()(l()(e),"slideExistence",(function(){var t,n;return-1!==(null===(t=e.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.currentSlideIndex)})),m()(l()(e),"reportNoteSize",(function(){var t,n,i,r,a=0,o=null===(t=e.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.slides.length;null===(i=e.services)||void 0===i||null===(r=i.selectionService)||void 0===r||r.slides.forEach((function(e){var t,n,i=Object(O.b)(null===(t=e.noteData)||void 0===t||null===(n=t.noteTextBody)||void 0===n?void 0:n.paragraphList);a=Math.max(a,i)})),Object(S.tdw)({module:E.d.SLIDE_MOBILE_NOTE,action:E.b.SLIDE_NOTE_SIZE,ver6:a,ver7:o})})),e}return o()(n,[{key:"componentDidMount",value:function(){var e,t,i,r,a=this;d()(g()(n.prototype),"componentDidMount",this).call(this),this.androidKeyBoardShow=!1,this.lastIsKeyBoardShow=!1,this.cachedScrollTop=0,this.topBlankDivHeight=0,this.bottomBlankDivHeight=0,this.renderCanvasNote(),null===(e=this.viewDelegate)||void 0===e||e.disposeOnUnmount(Object(y.r)((function(){var e,t;return null===(e=a.services)||void 0===e||null===(t=e.noteAreaManager)||void 0===t?void 0:t.show}),(function(e){if(e){if(a.model.mobileNoteShow)return}else if(a.handleMobileNoteExitEditing(),!a.model.mobileNoteShow)return;a.updateModel({mobileNoteShow:e})}))),null===(t=this.viewDelegate)||void 0===t||t.disposeOnUnmount(Object(y.r)((function(){var e,t;return null===(e=a.services)||void 0===e||null===(t=e.selectionService)||void 0===t?void 0:t.currentSlide}),(function(){a.updateModel({})}))),null===(i=this.viewDelegate)||void 0===i||i.disposeOnUnmount(Object(y.r)((function(){var e,t;return null===(e=a.services)||void 0===e||null===(t=e.noteAreaManager)||void 0===t?void 0:t.isMobileNoteFullScreen}),(function(e){a.updateModel({editMode:!!e})}))),null===(r=this.noteContainerRef)||void 0===r||r.addEventListener("scroll",this.handleNoteScroll),window.addEventListener("resize",this.leaveMobileFullScreenDelay),this.softKeyboard=new I.SoftKeyboard,C.a.isAndroid&&this.softKeyboard.on("change",(function(e){return a.onKeyboardChange(e)})),this.addFullScreenModeEvent(),this.reportNoteSize()}},{key:"componentDidUpdate",value:function(){this.renderCanvasNote()}},{key:"componentWillUnmount",value:function(){var e;window.removeEventListener("resize",this.leaveMobileFullScreenDelay),N.b.off(N.a.IOS_KEY_BOARD_SHOW,this.onKeyBoardShow),N.b.off(N.a.IOS_KEY_BOARD_HIDE,this.onKeyBoardHide),null===(e=this.noteContainerRef)||void 0===e||e.removeEventListener("scroll",this.handleNoteScroll)}},{key:"createViewModel",value:function(){return new L}},{key:"renderCanvasNote",value:function(){var e;if(this.noteCanvasRef&&null!==(e=this.props)&&void 0!==e&&e.mobileEditMode()){var t,n,i,r=(null===(t=this.noteContainerRef)||void 0===t||null===(n=t.getBoundingClientRect)||void 0===n||null===(i=n.call(t))||void 0===i?void 0:i.width)||0,a=this.model.noteAreaHeight,o=this.model,c=o.editMode,l=o.iosKeyboardHeight,s=o.mobileNoteShow;if(s){if(c){var d,u,h;a=(null===(d=this.noteContainerRef)||void 0===d||null===(u=d.getBoundingClientRect)||void 0===u||null===(h=u.call(d))||void 0===h?void 0:h.height)||a}}else a=T.r;!this.noteLayer&&this.noteContainerRef?this.noteLayer=new w.a({canvasElement:this.noteCanvasRef,containerElement:this.noteContainerRef,width:r,height:a,onExitEditing:this.handleMobileNoteExitEditing,onEnterEditing:this.handleMobileNoteEnterEditing,onDoubleTap:this.onDoubleTap,handleCurrentSlideChangeStart:this.resetBlankDiv,handleCurrentSlideChangeEnd:this.resetContainerScroll,resetScroll:this.resetScroll,editMode:c,handleNoteHeightUpdated:this.updateBlankDivHeight,getTextAreaElemHeight:this.getTextAreaElemHeight,isScrollMode:!0}):(this.noteLayer.updateWithData(r,a,c,s),this.updateNoteAreaByKeyboardChange(l||this.androidKeyBoardShow),this.fixIOSNativeAction(c))}}},{key:"offsetTop",get:function(){return this.noteLayer.getOffsetTop()}}]),n}(A.a)},bc58ec9496:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Be}));n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var i,r,a,o,c,l,s,d,u,h,f,v,p,g,b,m,y,w,S,E,O,k,x,M,P,C,I,R,T,A,D,L,N,j,B,H,_,F,U,z,W,G,K=n("9132715560"),V=n.n(K),Y=n("6a364eb35c"),Z=n.n(Y),J=n("547611bd96"),q=n.n(J),X=n("8eec1e4a03"),Q=n.n(X),$=n("bd29e2df90"),ee=n.n($),te=n("ab5eb40518"),ne=n.n(te),ie=n("1b4cdd6a36"),re=n.n(ie),ae=n("85d0a7609b"),oe=n.n(ae),ce=(n("8ee19818c4"),n("d9812f1c6f")),le=n("6fd214c630"),se=n("b5d9f27607"),de=n("176815363d"),ue=n.n(de),he=n("2dc700e1e6"),fe=n.n(he),ve=n("3ef2352f0b"),pe=n.n(ve),ge=(n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("5d557fc3ce"),n("b19fa21abe"),n("22569efd03"),n("82f2dc9440")),be=n.n(ge),me=n("5fac0349d3"),ye=n("ea3a38d9d4"),we=n("10637d5e95"),Se=n("a55553ef74"),Ee=n("b7b86f256a"),Oe=n("5cdbac46e8"),ke=n("ec5cae33cb"),xe=n("e0e8dd9366"),Me=n("6884e1a126"),Pe=n("c9c92622ff"),Ce=n("d5c3deb8c7"),Ie=n("382929c8da"),Re=n("d3d31c86eb"),Te=n("9da6335152");function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=re()(e);if(t){var r=re()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ne()(this,n)}}var De=(i=Reflect.metadata("design:type",Function),r=Reflect.metadata("design:paramtypes",[]),a=Reflect.metadata("design:type",Function),o=Reflect.metadata("design:paramtypes",[]),c=Reflect.metadata("design:type",Function),l=Reflect.metadata("design:paramtypes",[]),s=Reflect.metadata("design:type",Function),d=Reflect.metadata("design:paramtypes",[]),u=Reflect.metadata("design:type",Function),h=Reflect.metadata("design:paramtypes",[]),f=Reflect.metadata("design:type",Function),v=Reflect.metadata("design:paramtypes",[]),p=Reflect.metadata("design:type",Function),g=Reflect.metadata("design:paramtypes",[]),b=Reflect.metadata("design:type",Function),m=Reflect.metadata("design:paramtypes",[]),y=Reflect.metadata("design:type",Function),w=Reflect.metadata("design:paramtypes",[]),S=Reflect.metadata("design:type",Function),E=Reflect.metadata("design:paramtypes",[]),O=Reflect.metadata("design:type",Function),k=Reflect.metadata("design:paramtypes",[]),x=Object(Se.a)(300),M=Reflect.metadata("design:type",Function),P=Reflect.metadata("design:paramtypes",[]),C=Object(Se.a)(300),I=Reflect.metadata("design:type",Function),R=Reflect.metadata("design:paramtypes",[]),T=Object(Se.a)(300),A=Reflect.metadata("design:type",Function),D=Reflect.metadata("design:paramtypes",[]),L=Reflect.metadata("design:type",Function),N=Reflect.metadata("design:paramtypes",[]),j=Reflect.metadata("design:type",Function),B=Reflect.metadata("design:paramtypes",[]),H=Reflect.metadata("design:type",Function),_=Reflect.metadata("design:paramtypes",["undefined"==typeof KeyboardEvent?Object:KeyboardEvent]),F=Reflect.metadata("design:type",Function),U=Reflect.metadata("design:paramtypes",["undefined"==typeof KeyboardEvent?Object:KeyboardEvent]),z=Reflect.metadata("design:type",Function),W=Reflect.metadata("design:paramtypes",["undefined"==typeof KeyboardEvent?Object:KeyboardEvent]),G=function(e){ee()(a,e);var t,i,r=Ae(a);function a(e,t){var i;return V()(this,a),i=r.call(this,e),oe()(q()(i),"injectable",void 0),oe()(q()(i),"services",void 0),oe()(q()(i),"toggleFeature",void 0),i.services=e,i.injectable=t,Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519")]).then(n.bind(null,"a5cf7f5851")).then((function(e){var t=e.ToggleFeature;i.toggleFeature=t})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})),i}return Z()(a,[{key:"italic",value:function(){var e,t,n,i=null===(e=this.menuManager)||void 0===e?void 0:e.toolbarMenu();i&&(null===(t=i.callback)||void 0===t||t.call(i,ye.a.TOOLBAR,"italic",!(null!==(n=i.values)&&void 0!==n&&n.italic)))}},{key:"bold",value:function(){var e,t,n,i=null===(e=this.menuManager)||void 0===e?void 0:e.toolbarMenu();i&&(null===(t=i.callback)||void 0===t||t.call(i,ye.a.TOOLBAR,"bold",!(null!==(n=i.values)&&void 0!==n&&n.bold)))}},{key:"underline",value:function(){var e,t,n,i=null===(e=this.menuManager)||void 0===e?void 0:e.toolbarMenu();i&&(null===(t=i.callback)||void 0===t||t.call(i,ye.a.TOOLBAR,"underLine",!(null!==(n=i.values)&&void 0!==n&&n.underLine)))}},{key:"delete-line",value:function(){var e,t,n,i=null===(e=this.menuManager)||void 0===e?void 0:e.toolbarMenu();i&&(null===(t=i.callback)||void 0===t||t.call(i,ye.a.TOOLBAR,"deleteLine",!(null!==(n=i.values)&&void 0!==n&&n.deleteLine)))}},{key:"search",value:(i=ue()(pe.a.mark((function e(){var t,n,i;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.searchReplaceManager){e.next=2;break}return e.abrupt("return");case 2:if(null===(t=this.historyManager)||void 0===t||!t.isShown()){e.next=4;break}return e.abrupt("return");case 4:if(!this.checkLoadingState()){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.searchReplaceManager.promise();case 8:n=e.sent,i=n.searchReplaceType,n.dialogOpenFlag&&i===Ee.c.Search||n.openDialog(Ee.c.Search);case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"replace",value:(t=ue()(pe.a.mark((function e(){var t,n,i;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.searchReplaceManager){e.next=2;break}return e.abrupt("return");case 2:if(null===(t=this.historyManager)||void 0===t||!t.isShown()){e.next=4;break}return e.abrupt("return");case 4:if(!this.checkLoadingState()){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.searchReplaceManager.promise();case 8:n=e.sent,i=n.searchReplaceType,n.dialogOpenFlag&&i===Ee.c.Replace||n.openDialog(Ee.c.Replace);case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"undo",value:function(){var e,t=null===(e=this.menuManager)||void 0===e?void 0:e.toolbarMenu();null==t||t.callback(ye.a.TOOLBAR,Ie.a.UNDO)}},{key:"redo",value:function(){var e,t=null===(e=this.menuManager)||void 0===e?void 0:e.toolbarMenu();null==t||t.callback(ye.a.TOOLBAR,Ie.a.REDO)}},{key:"delete",value:function(e){if(!this.checkTextEditing()&&(e&&(e.stopPropagation(),e.preventDefault()),!this.checkEditorState()&&!this.checkLoadingState())){var t=this.selectedAnims,n=this.selectionService,i=null==n?void 0:n.currentSlide;if(i&&null!=t&&t.length)return t.selectedArray.forEach((function(e){i.removeAnimation(e)})),void t.clear();this.deleteInSlideOrEditorRegion()}}},{key:"pageup",value:function(e){var t=this;this.checkIsInAnyEditingState()||this.canChangeSelectedSlide()&&Object(Ce.w)((function(){var n;if(t.selectionService){var i=t.selectionService.currentSlideIndex;null!==(n=t.masterLayoutEditService)&&void 0!==n&&n.isMasterEditType&&i>=0?(t.selectionService.selectedSlides.clear(),t.pageUpInMasterEditType(e)):t.normalPageUp(e)}}))}},{key:"pagedown",value:function(e){var t=this;this.checkIsInAnyEditingState()||this.canChangeSelectedSlide()&&Object(Ce.w)((function(){var n;if(t.selectionService){var i=t.selectionService,r=i.currentSlideIndex,a=i.selectedSlides;null!==(n=t.masterLayoutEditService)&&void 0!==n&&n.isMasterEditType&&r>=0?(a.clear(),t.pageDownInMasterEditType(e)):t.normalPageDown(e)}}))}},{key:"esc",value:function(){var e,t,n,i,r;(null!==(e=this.editingStateManager)&&void 0!==e&&e.isCroping&&this.editingStateManager.updateElementCropState(!1),null!==(null===(t=this.editingStateManager)||void 0===t?void 0:t.insertState.type))&&(null===(r=this.editingStateManager)||void 0===r||r.clearInsertState());null===(n=this.formatBrushManager)||void 0===n||n.onCancelBrush(),null===(i=this.animBrushManager)||void 0===i||i.onCancelBrush()}},{key:"newSlideEnter",value:function(e){var t;null!==(t=this.masterLayoutEditService)&&void 0!==t&&t.isMasterEditType||this.checkLoadingState()||Q()(re()(a.prototype),"newSlideEnter",this).call(this,e)}},{key:"newSlideM",value:function(e){var t;null!==(t=this.masterLayoutEditService)&&void 0!==t&&t.isMasterEditType||this.checkLoadingState()||Q()(re()(a.prototype),"newSlideEnter",this).call(this,e)}},{key:"accessibility",value:function(){var e;null===(e=this.accessibilityManager)||void 0===e||e.promise().then((function(e){e.showAccessibilityModal(!0)}))}},{key:"shortcutPanel",value:function(){var e;null===(e=this.services.shortcutPanelManager)||void 0===e||e.promise().then((function(e){var t;null==e||null===(t=e.switchByShortcut)||void 0===t||t.call(e)}))}},{key:"displayGuides",value:function(){var e,t;null===(e=this.menuManager)||void 0===e||null===(t=e.guidesManager)||void 0===t||t.changeDisplayGuides()}},{key:"displayGridLine",value:function(){var e,t;null===(e=this.menuManager)||void 0===e||null===(t=e.gridLineManager)||void 0===t||t.changeDisplayGridLine()}},{key:"hideShowTopBar",value:function(){var e;if(this.toggleFeature){var t=Me.e.get(this.toggleFeature);null!==(e=this.getToolbarStateManager())&&void 0!==e&&e.isHeaderFold?t.showMenu():t.hideMenu()}}},{key:"link",value:function(){var e,t,n,i=null===(e=this.selectionService)||void 0===e?void 0:e.getSelectedModel();if(i)switch(i.type){case xe.d.SHAPE:this.insertLinkByIsEditing();break;case xe.d.IMAGE:this.menuManager._actionLink();break;case xe.d.TABLE:(n=i.getEditingElement())&&n.setTextLink();break;case xe.d.EMPTY:null===(t=this.services.linkManager)||void 0===t||t.insertTextWithLink();break;default:return}}},{key:"blockCtrlS",value:function(){}},{key:"print",value:function(e){var t;null===(t=this.services.printService)||void 0===t||t.handlePrint(),Object(Re.c)({opername:Te.e.PRINT_PPT,module:Te.d.SHORTCUT,action:Te.b.PRINT_ENTRANCE_CLICK})}},{key:"normalPageUp",value:function(e){var t=this.services.sectionManager;t&&(t.selectedSectionIndex=-1),Q()(re()(a.prototype),"normalPageUp",this).call(this,e)}},{key:"normalPageDown",value:function(e){var t=this.services.sectionManager;if(t){var n,i,r=t.selectedSectionIndex,o=null===(n=this.uiDataService)||void 0===n||null===(i=n.presentation.sectionList)||void 0===i?void 0:i[r];if(t.selectedSectionIndex=-1,0===(null==o?void 0:o.numSlides))return}Q()(re()(a.prototype),"normalPageDown",this).call(this,e)}},{key:"deleteInSlideOrEditorRegion",value:function(){var e;if((null===(e=this.selectionService)||void 0===e?void 0:e.lastMouseDownRegion)===ke.a.SLIDELIST){var t=this.sectionManager;if(void 0!==(null==t?void 0:t.selectedSectionIndex)&&-1!==(null==t?void 0:t.selectedSectionIndex)){var n,i=null===(n=this.uiDataService)||void 0===n?void 0:n.presentation.getSectionProperty();return null==i||i.deleteSection(t.selectedSectionIndex,!0),void t.deleteSectionStateAt(t.selectedSectionIndex)}}Q()(re()(a.prototype),"deleteInSlideOrEditorRegion",this).call(this)}},{key:"canChangeSelectedSlide",value:function(){var e,t;return Q()(re()(a.prototype),"canChangeSelectedSlide",this).call(this)&&!(null!==(e=this.services.drawerStateManager)&&void 0!==e&&null!==(t=e.dangerousInstance)&&void 0!==t&&t.isDrawerMenuShown)}},{key:"masterLayoutEditService",get:function(){return this.services.masterLayoutEditService}},{key:"formatBrushManager",get:function(){return this.services.formatBrushManager}},{key:"animBrushManager",get:function(){return this.services.animBrushManager}},{key:"searchReplaceManager",get:function(){return this.services.searchReplaceManager}},{key:"selectedAnims",get:function(){return this.services.selectedAnims}},{key:"accessibilityManager",get:function(){return this.services.accessibilityManager}},{key:"tipsManager",get:function(){return this.services.tipsManager}},{key:"sectionManager",get:function(){return this.services.sectionManager}},{key:"historyManager",get:function(){return this.services.historyManager}},{key:"insertLinkByIsEditing",value:function(){var e,t,n=null===(e=this.selectionService)||void 0===e?void 0:e.getSelectedModel();if(null!==(t=this.editorInstanceService)&&void 0!==t&&t.checkEditorIsEditing())null==n||n.editorInstance.setTextLink();else{if(Object(Pe.o)(n))return;this.menuManager._actionLink()}}},{key:"checkEditorState",value:function(){var e,t;return!!(this.userPriviledgeService&&(null===(e=this.userPriviledgeService)||void 0===e?void 0:e.pptEditorState)>Oe.b.EDITABLE)&&(null===(t=this.tipsManager)||void 0===t||t.showCannotEditTips(),!0)}},{key:"checkLoadingState",value:function(){var e;return!(null===(e=this.uiDataService)||void 0===e||!e.presentation.operation.loading)&&(be.a.show({message:me.a.t("正在加载幻灯片，请稍后再试"),type:"info",autoClose:!0}),!0)}},{key:"pageUpInMasterEditType",value:function(e){var t,n,i,r,a,o=null===(t=this.selectionService)||void 0===t?void 0:t.currentSlide,c=null===(n=this.selectionService)||void 0===n||null===(i=n.currentSlide)||void 0===i?void 0:i.getRelationMasterModel(),l=c.layoutList,s=this.uiDataService&&this.uiDataService.masterModelList.findIndex((function(e){return c===e}))>0;(null===(r=this.selectionService)||void 0===r?void 0:r.currentSlideType)===xe.d.LAYOUT?this.pageUpCurrentIsLayout(l,o,c,e):(null===(a=this.selectionService)||void 0===a?void 0:a.currentSlideType)===xe.d.MASTER&&s&&this.pageUpCurrentIsMaster(e)}},{key:"pageUpCurrentIsMaster",value:function(e){var t;if(this.selectionService&&this.uiDataService){var n=(null===(t=this.selectionService)||void 0===t?void 0:t.currentSlideIndex)-1,i=this.uiDataService.masterModelList[n],r=(null==i?void 0:i.layoutList)||[];if(r.length){var a,o,c,l,s=r[r.length-1],d=null===(a=this.uiDataService)||void 0===a?void 0:a.layoutModelList.findIndex((function(e){return e===s}));null===(o=this.selectionService)||void 0===o||o.changeCurrentSlideIndexByUserAction(d),null===(c=this.selectionService)||void 0===c||c.updateCurrentSlideType(xe.d.LAYOUT),null===(l=this.selectionService)||void 0===l||l.selectedSlides.add(s),this.editingStateManager&&(this.editingStateManager.keyFlag4Moving=e.keyCode),e.preventDefault(),e.stopPropagation()}else this.normalPageUp(e)}}},{key:"pageUpCurrentIsLayout",value:function(e,t,n,i){if(e.findIndex((function(e){return e===t}))>0)this.normalPageUp(i);else if(this.uiDataService&&this.selectionService){var r=this.uiDataService.masterModelList.findIndex((function(e){return n===e}));this.selectionService.changeCurrentSlideIndexByUserAction(r),this.selectionService.updateCurrentSlideType(xe.d.MASTER),this.selectionService.selectedSlides.add(n),this.editingStateManager&&(this.editingStateManager.keyFlag4Moving=i.keyCode),i.preventDefault(),i.stopPropagation()}}},{key:"pageDownInMasterEditType",value:function(e){var t,n;if((null===(t=this.selectionService)||void 0===t?void 0:t.currentSlideType)===xe.d.MASTER){var i,r,a=null===(i=this.selectionService)||void 0===i||null===(r=i.currentSlide)||void 0===r?void 0:r.layoutList;this.pageDownCurrentIsMaster(a,e)}else(null===(n=this.selectionService)||void 0===n?void 0:n.currentSlideType)===xe.d.LAYOUT&&this.pageDownCurrentIsLayout(e)}},{key:"pageDownCurrentIsLayout",value:function(e){var t,n=null===(t=this.selectionService)||void 0===t?void 0:t.currentSlide,i=null==n?void 0:n.getRelationMasterModel();if(i.layoutList.findIndex((function(e){return n===e}))<i.layoutList.length-1)this.normalPageDown(e);else if(this.uiDataService&&this.selectionService){var r=this.uiDataService.masterModelList.findIndex((function(e){return i===e})),a=r+1;r<this.uiDataService.masterModelList.length-1&&(this.selectionService.changeCurrentSlideIndexByUserAction(a),this.selectionService.updateCurrentSlideType(xe.d.MASTER),this.selectionService.selectedSlides.add(this.uiDataService.masterModelList[a]),this.editingStateManager&&(this.editingStateManager.keyFlag4Moving=e.keyCode),e.preventDefault(),e.stopPropagation())}}},{key:"pageDownCurrentIsMaster",value:function(e,t){if(e.length){if(this.uiDataService&&this.selectionService){var n=this.uiDataService.layoutModelList.findIndex((function(t){return t===e[0]}));this.selectionService.changeCurrentSlideIndexByUserAction(n),this.selectionService.updateCurrentSlideType(xe.d.LAYOUT),this.selectionService.selectedSlides.add(e[0]),this.editingStateManager&&(this.editingStateManager.keyFlag4Moving=t.keyCode),t.preventDefault(),t.stopPropagation()}}else this.normalPageDown(t)}}]),a}(we.a),fe()(G.prototype,"italic",[Se.c,Se.b,i,r],Object.getOwnPropertyDescriptor(G.prototype,"italic"),G.prototype),fe()(G.prototype,"bold",[Se.c,Se.b,a,o],Object.getOwnPropertyDescriptor(G.prototype,"bold"),G.prototype),fe()(G.prototype,"underline",[Se.c,Se.b,c,l],Object.getOwnPropertyDescriptor(G.prototype,"underline"),G.prototype),fe()(G.prototype,"delete-line",[Se.c,Se.b,s,d],Object.getOwnPropertyDescriptor(G.prototype,"delete-line"),G.prototype),fe()(G.prototype,"search",[Se.c,Se.b,u,h],Object.getOwnPropertyDescriptor(G.prototype,"search"),G.prototype),fe()(G.prototype,"replace",[Se.c,Se.b,f,v],Object.getOwnPropertyDescriptor(G.prototype,"replace"),G.prototype),fe()(G.prototype,"undo",[Se.c,Se.b,p,g],Object.getOwnPropertyDescriptor(G.prototype,"undo"),G.prototype),fe()(G.prototype,"redo",[Se.c,Se.b,b,m],Object.getOwnPropertyDescriptor(G.prototype,"redo"),G.prototype),fe()(G.prototype,"esc",[Se.c,Se.b,y,w],Object.getOwnPropertyDescriptor(G.prototype,"esc"),G.prototype),fe()(G.prototype,"accessibility",[Se.c,Se.b,S,E],Object.getOwnPropertyDescriptor(G.prototype,"accessibility"),G.prototype),fe()(G.prototype,"shortcutPanel",[Se.c,Se.b,O,k],Object.getOwnPropertyDescriptor(G.prototype,"shortcutPanel"),G.prototype),fe()(G.prototype,"displayGuides",[x,Se.c,Se.b,M,P],Object.getOwnPropertyDescriptor(G.prototype,"displayGuides"),G.prototype),fe()(G.prototype,"displayGridLine",[C,Se.c,Se.b,I,R],Object.getOwnPropertyDescriptor(G.prototype,"displayGridLine"),G.prototype),fe()(G.prototype,"hideShowTopBar",[T,A,D],Object.getOwnPropertyDescriptor(G.prototype,"hideShowTopBar"),G.prototype),fe()(G.prototype,"link",[Se.c,Se.b,L,N],Object.getOwnPropertyDescriptor(G.prototype,"link"),G.prototype),fe()(G.prototype,"blockCtrlS",[Se.c,Se.b,j,B],Object.getOwnPropertyDescriptor(G.prototype,"blockCtrlS"),G.prototype),fe()(G.prototype,"print",[Se.c,Se.b,H,_],Object.getOwnPropertyDescriptor(G.prototype,"print"),G.prototype),fe()(G.prototype,"normalPageUp",[Se.c,Se.b,F,U],Object.getOwnPropertyDescriptor(G.prototype,"normalPageUp"),G.prototype),fe()(G.prototype,"normalPageDown",[Se.c,Se.b,z,W],Object.getOwnPropertyDescriptor(G.prototype,"normalPageDown"),G.prototype),G);function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=re()(e);if(t){var r=re()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ne()(this,n)}}var Be=function(e){ee()(n,e);var t=je(n);function n(e,i){var r;return V()(this,n),r=t.call(this,e,i),oe()(q()(r),"injectable",void 0),oe()(q()(r),"actionsInjectable",void 0),r.injectable=e,r.actionsInjectable=i,r}return Z()(n,[{key:"getCtrlKey",value:function(){return ce.a.isMac?"command":"ctrl"}},{key:"getShortcutConfig",value:function(){var e,t=this.getCtrlKey(),i=Ne(Ne({},Q()(re()(n.prototype),"getShortcutConfig",this).call(this)),{},(e={},oe()(e,"".concat(t,"+i"),this.handleAction.bind(this,se.a.ITALIC)),oe()(e,"".concat(t,"+b"),this.handleAction.bind(this,se.a.BOLD)),oe()(e,"".concat(t,"+u"),this.handleAction.bind(this,se.a.UNDERLINE)),oe()(e,"".concat(t,"+d"),this.handleAction.bind(this,se.a.DELETE_LINE)),oe()(e,"".concat(t,"+f"),this.handleAction.bind(this,se.a.SEARCH)),oe()(e,"".concat(t,"+h"),this.handleAction.bind(this,se.a.REPLACE)),oe()(e,"".concat(t,"+k"),this.handleAction.bind(this,se.a.LINK)),oe()(e,"".concat(t,"+f1"),this.handleAction.bind(this,se.a.HIDE_SHOW_TOP_BAR)),oe()(e,"alt+f9",this.handleAction.bind(this,se.a.DISPLAY_GUIDES)),oe()(e,"shift+f9",this.handleAction.bind(this,se.a.DISPLAY_GRID_LINE)),oe()(e,"ctrl+`",this.handleAction.bind(this,se.a.ACCESSIBILITY)),e));return ce.a.isSafari&&ce.a.isSafariVersionBelow(14)&&(i["".concat(t,"+c")]=this.handleAction.bind(this,se.a.COPY),i["".concat(t,"+x")]=this.handleAction.bind(this,se.a.CUT),i["".concat(t)]=this.handleAction.bind(this,se.a.CTRL)),ce.a.isMac&&(i["ctrl+option+command+g"]=this.handleAction.bind(this,se.a.DISPLAY_GUIDES),i["command+'"]=this.handleAction.bind(this,se.a.DISPLAY_GRID_LINE),i["alt+f9"]=function(){},i["shift+f9"]=function(){}),i}},{key:"getBubblingShortcutConfig",value:function(){var e,t=this.getCtrlKey();return Ne(Ne({},Q()(re()(n.prototype),"getBubblingShortcutConfig",this).call(this)),{},(e={esc:this.handleAction.bind(this,se.a.ESC)},oe()(e,"".concat(t,"+f"),this.handleAction.bind(this,se.a.SEARCH)),oe()(e,"".concat(t,"+/"),this.handleAction.bind(this,se.a.SHORTCUTPANEL)),e),this.handleExtraBubbleKeyConfig())}},{key:"createShortcutActions",value:function(){return new De(this.services,this.actionsInjectable)}},{key:"handleExtraBubbleKeyConfig",value:function(){var e,t=this,n=null===(e=this.injectable)||void 0===e?void 0:e.getExtraBubbleKeyConfig();if(n){var i={};return n.forEach((function(e){i[e.key]=t.handleAction.bind(t,e.actionKey)})),i}return null}}]),n}(le.a)},c0fee5e13a:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAACYBAMAAADq7D0SAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAhUExURUdwTEdOW0pQXUhPXEdNWkdOW0ZNW0dOW1FbaEdOW0ZNWuzvuioAAAAKdFJOUwB5IDnLnuZWCq/Zl4IiAAACfklEQVRo3u1ZPUskQRBtdz13NJI7NTBSQUGjlT38ihRBYSPNZCIVQdhIUBQuOhETIzkzI2ddHe1fafd86Ko7ta97KrigXrRMT7+prn5V3VWrlEAgEAgEAoFAwIZgZuYvD9PV+JY2ONpdKU1VHdPv2JgqxzXd0l14/lmGa1V/wR0jl9abvlzzugf++XENZP7q7F40GsvjzYxt1Ierks7u/EqlpoLF9MGrz54uJVMPuqZWJpJHxx6LTCZuf46EM8+Fhj2NOLdPn1y5fthZ0beIDCbt81tHsnvr+3qP8Gq6m5YYttdr5NqO7Nhfs3WQzK4moocuWyBZzX7+hBirq1pLg4KbM+/HRYN/zOBhxTgVTJjNYsNS0zpWObhgI9qhNrthZAv5hhFbDZMZf3QIhwRZCsDyvnnzkRi/1A5kg3Qw17I89wqRrRl/FK+ymmfJJ9RlcXHODLULWcW8uE6ZnSFCVXYCWAaRDZEu+2CLQcmSH83ZYjD9tBXA9ghG+boC2NrIZQw4fxK2NhhMfXOoZXsBldE/7Rm2B+wsQUI4CPexMIcCJRjFNBspLoyAcoRwA8oRPQCEzH0D4v9TGqyiHfS4tJYNdPwKxEYGJUe4hvatjzwPFAdMYmcFhjVOoQ3BN8zSFxfXqlVz7sA9Z6jT11BHDHPKtqo5k22fosINc3S54660iDPW+XRLFq+uHZcrqqx2dgBZ8LtqkGxFOJsWFjVJWh57M1zQvgl92jdUYynyEq7W259t8215pUYwNeM+2oS5cWXahNlCbQPztNG4yBuYz55hxtlaVer3dy7OFvJdmfTB2Sg3e9rdwi9/02L8cyGNSLa/PQQCgUAgEAgEAos3l5bV5V9UlyoAAAAASUVORK5CYII="},c1808b326d:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("9132715560"),r=n.n(i),a=function e(){r()(this,e)}},c871a97d39:function(e,t,n){"use strict";n.r(t),n.d(t,"SelectWindowManager",(function(){return fe}));var i=n("176815363d"),r=n.n(i),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),h=n.n(u),f=(n("c6244f7705"),n("081c8cafea"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("69084d01d3")),v=n.n(f),p=n("d5c3deb8c7"),g=n("6884e1a126"),b=n("432f93125e"),m=n("6a9e93341e"),y=n("0a8ecd6412"),w=n("617779fa67"),S=n("f27f5f5885"),E=(n("73b854064b"),n("7a5536c9bf")),O=n.n(E),k=n("547611bd96"),x=n.n(k),M=n("bd29e2df90"),P=n.n(M),C=n("ab5eb40518"),I=n.n(C),R=n("1b4cdd6a36"),T=n.n(R),A=(n("6e20b6a7d8"),n("75563bc376"),n("1bab7b5fb7"),n("9d7978d445"),n("b1e2246d82"),n("a2a09da1e3"),n("3bf1976a4f"),n("34cd92f77a"),n("963f2eaace"),n("b8217400dc"),n("e6f68cdf2e"),n("8e7cce0ada"),n("c9a7ecac4d"),n("85d48ef22b"),n("2a6f332b5e"),n("e792a3169a")),D=n.n(A),L=n("1252d99904"),N=n.n(L),j={injectType:"singletonStyleTag",attributes:{id:"ppt-editor-global-id"},insert:"head",singleton:!0},B=(D()(N.a,j),N.a.locals,n("e0e8dd9366")),H=n("c177e55ba5"),_=n.n(H),F=n("9be7889667"),U=n.n(F),z=n("82f2dc9440"),W=n.n(z),G=n("24ff1e956b"),K=n.n(G),V={insert:"head",singleton:!1},Y=(D()(K.a,V),K.a.locals||{}),Z=n("8ff7b94415"),J=n("1748118723"),q=n.n(J),X=n("ff948b66a1"),Q=n("5fac0349d3"),$=n("9da6335152"),ee=n("d3d31c86eb");function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie={opername:$.e.DOC_PPT,module:$.d.SELECT_PANEL},re={open:ne(ne({},ie),{},{action:$.b.SELECT_OPEN,eventcode:$.a.DOC_PPT_SELECT_PANEL_OPEN}),showAll:ne(ne({},ie),{},{action:$.b.SHOW_ALL,eventcode:$.a.DOC_PPT_SELECT_PANEL_SHOW_ALL}),hideAll:ne(ne({},ie),{},{action:$.b.HIDE_ALL,eventcode:$.a.DOC_PPT_SELECT_PANEL_HIDE_ALL}),hideOne:ne(ne({},ie),{},{action:$.b.HIDE_ONE,eventcode:$.a.DOC_PPT_SELECT_PANEL_HIDE_ONE}),showOne:ne(ne({},ie),{},{action:$.b.SHOW_ONE,eventcode:$.a.DOC_PPT_SELECT_PANEL_SHOW_ONE}),unFoldGroup:ne(ne({},ie),{},{action:$.b.UNFOLD_GROUP,eventcode:$.a.DOC_PPT_SELECT_PANEL_UNFOLD_GROUP}),foldGroup:ne(ne({},ie),{},{action:$.b.FOLD_GROUP,eventcode:$.a.DOC_PPT_SELECT_PANEL_FOLD_GROUP}),drag:ne(ne({},ie),{},{action:$.b.SELECT_DRAG,eventcode:$.a.DOC_PPT_SELECT_PANEL_DRAG}),setWidth:ne(ne({},ie),{},{action:$.b.SET_WIDTH,eventcode:$.a.DOC_PPT_SELECT_PANEL_SET_WIDTH})},ae=function(e){Object(ee.c)(e)},oe=n("9657b29818");function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=T()(e);if(t){var r=T()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return I()(this,n)}}var de=function(e){P()(n,e);var t=se(n);function n(e){var i,r,a;o()(this,n),a=t.call(this,e),d()(x()(a),"shapeListReaction",void 0),d()(x()(a),"showSelectWindowReaction",void 0),d()(x()(a),"selectedElementReaction",void 0),d()(x()(a),"slideReaction",void 0),d()(x()(a),"dragNode",void 0),d()(x()(a),"dragDom",void 0),d()(x()(a),"slideChildNum",1),d()(x()(a),"slideChildrenMap",{}),d()(x()(a),"services",void 0),d()(x()(a),"renderTree",(function(){var e;return v.a.createElement("div",{className:q()(Y["select-window-content-drawer"])},v.a.createElement(Z.a,{className:q()((e={},d()(e,Y["select-window-tree"],!0),d()(e,"select-window-tree-global-drawer",!0),e)),prefixCls:"dui-tree",treeData:a.state.shapeList,selectedKeys:a.state.selectedShapeItems.map((function(e){return e.key})),multiple:!0,blockNode:!0,draggable:!0,allowDrop:function(e){return a.handlerAllowDrop(e)},onDrop:function(e){return a.handlerOnDrop(e)},onDragStart:function(e){return a.handlerOnDragStart(e)},onDragEnd:function(){return a.handleDragDomStyle()},onExpand:a.handleExpand}))})),d()(x()(a),"updateShapeList",(function(){var e,t=null===(e=a.currentSlide)||void 0===e?void 0:e.children;a.setState({shapeList:a.getShapeList(t)})})),d()(x()(a),"needStopTitleMouseEvent",(function(e){var t;return!!e&&void 0!==(null===(t=a.state)||void 0===t?void 0:t.selectedShapeItems.find((function(t){var n;return t===e||e.model===(null===(n=t.model)||void 0===n?void 0:n.rootGroupModel)})))})),d()(x()(a),"handleTitleMouseEnter",(function(e){a.needStopTitleMouseEvent(e)||a.handleHighlight(e.model.id)})),d()(x()(a),"handleTitleMouseLeave",(function(){a.needStopTitleMouseEvent()||a.handleHighlight(null)})),d()(x()(a),"handleHighlight",(function(e){a.currentSlide&&(a.currentSlide.highlightModelId=e)})),d()(x()(a),"handlerOnDrop",(function(e){var t,n,i=e.node,r=e.dropPosition,o=e.dropToGap,c=i.pos.split("-"),l=r-c[c.length-1],s=a.state.selectedShapeItems.filter((function(e){return e.parentKey===a.dragNode.parentKey})).map((function(e){return e.key})),d=a.findShapeItem(s).map((function(e){return e.shapeItem.model})),u=a.findShapeItem(i.key);if(d.length&&u){var h,f=u.parentShapeList,v=u.index,p=u.shapeItem;if(o)if(-1===l){var g;null===(g=a.currentSlide)||void 0===g||g.moveElement(f.length-v,d,!0)}else{var b;null===(b=a.currentSlide)||void 0===b||b.moveElement(f.length-v-1,d,!0)}else null===(h=a.currentSlide)||void 0===h||h.moveElement(p.children.length,d,!0);null===(t=a.selectedManager)||void 0===t||t.clear(),ae(le(le({},re.drag),{},{ver6:null===(n=a.slideChildren)||void 0===n?void 0:n.length}))}})),d()(x()(a),"handlerShowAll",(function(){ae(re.showAll),Object(oe.b)((function(){a.loop(a.state.shapeList,(function(e){if(e.model.hidden){var t;null===(t=e.model.sdkData)||void 0===t||t.api.updateProps({nvPr:{hidden:!1}})}}))}))})),d()(x()(a),"handlerHideAll",(function(){var e;ae(re.hideAll),null===(e=a.selectedManager)||void 0===e||e.clear(),Object(oe.b)((function(){a.state.shapeList.forEach((function(e){if(!e.model.hidden){var t;null===(t=e.model.sdkData)||void 0===t||t.api.updateProps({nvPr:{hidden:!0}})}}))}))})),d()(x()(a),"handleDragDomStyle",(function(e){if(e)a.dragDom=e,a.dragDom.style.opacity=.24;else{if(!a.dragDom)return;a.dragDom.style.opacity="",a.dragDom=null}})),d()(x()(a),"handleExpand",(function(e,t){var n,i=t.expanded;ae(le(le({},i?re.unFoldGroup:re.foldGroup),{},{ver6:null===(n=a.slideChildren)||void 0===n?void 0:n.length}))})),d()(x()(a),"getTitleText",(function(e){var t,n,i,r,o=Object(X.a)({elementModel:e.model}).name,c=o.indexOf(":"),l=null!==(t=null===(n=a.slideChildrenMap[(null===(i=a.currentSlide)||void 0===i?void 0:i.id)||""])||void 0===n?void 0:n[null!==(r=e.model.id)&&void 0!==r?r:e.model.key])&&void 0!==t?t:1,s=/\x20\d+$/;return-1===c?"".concat(o.replace(s,"")," ").concat(l):"".concat(o.slice(0,c).replace(s,"")," ").concat(l).concat(o.slice(c))})),d()(x()(a),"updateSlideChildrenNum",(function(e){null==e||e.forEach((function(e){var t,n,i,r=null===(t=a.slideChildrenMap[a.currentSlide.id||""])||void 0===t?void 0:t[null!==(n=e.id)&&void 0!==n?n:e.key];void 0!==r&&(a.slideChildNum=Math.max(a.slideChildNum,r+1)),(null===(i=e.children)||void 0===i?void 0:i.length)>0&&a.updateSlideChildrenNum(e.children),a.updateModelIndex(e)}))})),d()(x()(a),"updateModelIndex",(function(e){var t;a.slideChildrenMap[a.currentSlide.id||""]||(a.slideChildrenMap[a.currentSlide.id||""]={});var n=a.slideChildrenMap[a.currentSlide.id||""],i=null!==(t=e.id)&&void 0!==t?t:e.key;n[i]||(n[i]=a.slideChildNum,a.slideChildNum+=1)})),d()(x()(a),"getRightSideBarManager",(function(){return a.services.rightSideBarManager})),d()(x()(a),"getSelectionService",(function(){return a.services.selectionService})),d()(x()(a),"getRightSideBarService",(function(){return a.services.rightSideBarService})),a.services=e.services;var c=null===(i=a.currentSlide)||void 0===i?void 0:i.children,l=a.getShapeList(c);return a.state={showSelectWindow:null===(r=a.getRightSideBarManager())||void 0===r?void 0:r.isSelectWindowShown,shapeList:l,selectedShapeItems:[]},a}return l()(n,[{key:"componentDidMount",value:function(){var e=this;this.showSelectWindowReaction=Object(p.r)((function(){var t;return null===(t=e.getRightSideBarManager())||void 0===t?void 0:t.isSelectWindowShown}),(function(t){var n,i,r,a,o,c=e.getRightSideBarManager();t&&c&&(null===(n=e.getRightSideBarService())||void 0===n||n.hide(),null===(i=e.getRightSideBarManager())||void 0===i||i.setIsPropertyEditorShown(!1),null===(r=e.getRightSideBarManager())||void 0===r||r.setIsAnimationEditorShown(!1),c.isSlideRatingShown=!1,ae(le(le({},re.open),{},{ver5:(null===(a=e.getRightSideBarManager())||void 0===a?void 0:a.selectWindowShowAction)===y.t.FROM_FORMAT?2:1,ver6:null===(o=e.slideChildren)||void 0===o?void 0:o.length})));e.setState({showSelectWindow:t||!1})}),{fireImmediately:!0});var t=function(t){var n,i=null===(n=e.selectedManager)||void 0===n?void 0:n.selectedArray,r=[];return i instanceof Array&&e.loop(t,(function(e){i.includes(e.model)&&r.push(e)})),r};this.shapeListReaction=Object(p.r)((function(){var t;return e.getObserve(null===(t=e.currentSlide)||void 0===t?void 0:t.children)}),(function(){var n,i;e.unWatchTextRunChange(),e.updateSlideChildrenNum(null===(n=e.currentSlide)||void 0===n?void 0:n.children);var r=e.getShapeList(null===(i=e.currentSlide)||void 0===i?void 0:i.children);e.setState({selectedShapeItems:t(r)},(function(){return e.setState({shapeList:r},(function(){e.watchTextRunChange()}))}))}),{fireImmediately:!0}),this.selectedElementReaction=Object(p.r)((function(){var t,n;return null===(t=e.getSelectionService().selectedElements)||void 0===t||null===(n=t.selectedArray)||void 0===n?void 0:n.map((function(e){return e.id}))}),(function(){e.setState({selectedShapeItems:t(e.state.shapeList)})}),{fireImmediately:!0}),this.slideReaction=Object(p.r)((function(){return e.getSelectionService().currentSlideIndex}),(function(){e.slideChildNum=1}))}},{key:"componentWillUnmount",value:function(){var e;this.showSelectWindowReaction(),this.shapeListReaction(),this.selectedElementReaction(),this.unWatchTextRunChange(),null===(e=this.slideReaction)||void 0===e||e.call(this)}},{key:"render",value:function(){var e=this;return this.state.showSelectWindow?v.a.createElement("div",{className:q()(Y["select-window"],[Y["select-window-drawer"]])},v.a.createElement("div",{className:q()(Y["select-window-header"],Y["select-window-header-drawer"])},v.a.createElement("div",{className:Y["select-window-header-title"]},Q.a.t("全部图层")),v.a.createElement("img",{className:Y["select-window-header-close"],src:U.a,onClick:function(){return e.closeSelectWindow()}})),v.a.createElement("div",{className:Y["select-window-toolbar"]},v.a.createElement(_.a,{type:"plain",onClick:this.handlerShowAll,className:Y.btn},Q.a.t("全部显示")),v.a.createElement(_.a,{type:"plain",onClick:this.handlerHideAll,className:Y.btn,style:{marginLeft:"12px"}},Q.a.t("全部隐藏"))),this.renderTree()):null}},{key:"watchTextRunChange",value:function(){var e=this;this.loop(this.state.shapeList,(function(t){t.model.changeSetEngine.addObserveForChangeAtPath("txBody",e.updateShapeList)}))}},{key:"unWatchTextRunChange",value:function(){var e=this;this.loop(this.state.shapeList,(function(t){t.model.changeSetEngine.removeObserveForChangeAtPath("txBody",e.updateShapeList)}))}},{key:"findRootGroupShape",value:function(e){for(var t=e;![B.d.SLIDE,B.d.LAYOUT,B.d.MASTER].includes(null===(n=t)||void 0===n||null===(i=n.parent)||void 0===i?void 0:i.type);){var n,i;t=t.parent}return t}},{key:"applySelectedManager",value:function(e){for(var t,n,i=this,r=[],a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];o.forEach((function(e){r.push(e),r.push(i.findRootGroupShape(e))})),null===(t=(n=this.selectedManager)[e])||void 0===t||t.call.apply(t,[n].concat(r))}},{key:"selectedManager",get:function(){return this.getSelectionService().selectedElements}},{key:"toggleDisplay",value:function(e,t){var n,i=this;e.stopPropagation();var r=t.model,a=t.parentKey,o=t.depth,c=t.key,l=+!r.hidden;l?(this.state.selectedShapeItems.forEach((function(e){(e.depth>o||e.key===c)&&i.selectedManager.remove(e.model)})),this.handleHighlight(null),ae(re.hideOne)):(this.handleHighlight(r.id),ae(re.showOne)),Promise.resolve().then((function(){i.state.selectedShapeItems.find((function(e){return e.parentKey===a&&e.key!==c}))||i.selectedManager.remove(i.findRootGroupShape(r))}));var s={hidden:!!l};null===(n=r.sdkData)||void 0===n||n.api.updateProps({nvPr:s})}},{key:"renderDisplayIcon",value:function(e){var t,n=this,i=e.model,r=e.isParentDisableSelect;return v.a.createElement("i",{className:q()((t={"display-icon":!0},d()(t,Y["visible-icon"],!i.hidden),d()(t,Y["hidden-icon"],i.hidden),d()(t,Y["disabled-icon"],r),t)),onClick:function(t){return!r&&n.toggleDisplay(t,e)}})}},{key:"renderTreeItemTitle",value:function(e){var t,n,i=this,r=e.disableSelect&&0!==e.depth,a=(null==e||null===(t=e.children)||void 0===t?void 0:t.length)&&0!==e.depth,o=q()((n={},d()(n,Y["tree-item-title-container"],!0),d()(n,Y["tree-item-title-disable"],r),n)),c=q()(Y["tree-item-title-text"],d()({},Y["tree-item-title-text-hidden"],e.model.hidden));return v.a.createElement("div",{className:o,onClick:function(t){r||a||(i.handlerTitleClick(t,e),i.handleHighlight(null))},onMouseEnter:function(){return i.handleTitleMouseEnter(e)},onMouseLeave:function(){return i.handleTitleMouseLeave()},onMouseDown:function(){return i.handleTitleMouseLeave()}},v.a.createElement("span",{className:c},this.getTitleText(e)),this.renderDisplayIcon(e))}},{key:"handlerTitleClick",value:function(e,t){e.stopPropagation(),this.displayShapeItem(t),e.ctrlKey||e.metaKey?this.handlerClickWithControl(t):this.handlerClickWithOutControl(t)}},{key:"displayShapeItem",value:function(e){if(0!==e.model.hidden){var t;null===(t=e.model.sdkData)||void 0===t||t.api.updateProps({nvPr:{hidden:!1}})}}},{key:"getShapeList",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e?e.slice().reverse().map((function(e,r){var a,o="".concat(n,"-").concat(r),c=i||!!e.hidden,l=n.split("-").length-1,s=null!==(a=e.children)&&void 0!==a&&a.length?t.getShapeList(e.children,"".concat(n,"-").concat(r),c):[],d={key:o,parentKey:n,children:s,title:v.a.createElement("div",null),model:e,isParentDisableSelect:i,disableSelect:c,depth:l};return d.title=t.renderTreeItemTitle(d),d})):[]}},{key:"loop",value:function(e,t){var n=this;e.forEach((function(i,r){var a;null!==(a=i.children)&&void 0!==a&&a.length&&n.loop(i.children,t),t(i,r,e)}))}},{key:"getObserve",value:function(e){var t=this;return null==e?void 0:e.map((function(e){var n;return{id:e.id,hidden:e.hidden,children:null!==(n=e.children)&&void 0!==n&&n.length?t.getObserve(e.children):[]}}))}},{key:"closeSelectWindow",value:function(){var e;null===(e=this.getRightSideBarManager())||void 0===e||e.setIsSelectWindowShown(!1)}},{key:"handlerOnDragStart",value:function(e){var t,n=e.node,i=e.event;this.dragNode=n,this.handleDragDomStyle(null==i||null===(t=i.target)||void 0===t?void 0:t.parentNode),this.applySelectedManager("add",n.model)}},{key:"handlerAllowDrop",value:function(e){var t=e.dropNode,n=e.dropPosition,i=0!==n&&t.parentKey===this.dragNode.parentKey,r=0===n&&t.key===this.dragNode.parentKey;return!(!i&&!r)}},{key:"findShapeItem",value:function(e){var t,n=e instanceof Array,i=[];return this.loop(this.state.shapeList,(function(r,a,o){n&&e.includes(r.key)?i.push({shapeItem:r,index:a,parentShapeList:o}):n||r.key!==e||(t={shapeItem:r,index:a,parentShapeList:o})})),n?i:t}},{key:"handlerClickWithControl",value:function(e){new Set([].concat(O()(this.state.selectedShapeItems.map((function(e){return e.parentKey}))),[e.parentKey])).size>1?W.a.show({message:Q.a.t("暂不支持跨级多选"),autoClose:!0,closable:!0}):this.toggleSelectShapeItem(e)}},{key:"handlerClickWithOutControl",value:function(e){var t,n=this.state.selectedShapeItems;null===(t=this.selectedManager)||void 0===t||t.clear(),1===n.length&&n.includes(e)||this.applySelectedManager("add",e.model)}},{key:"toggleSelectShapeItem",value:function(e){var t,n=this,i=this.state.selectedShapeItems,r=i.includes(e)?i.filter((function(t){return t!==e})):[].concat(O()(i),[e]);null===(t=this.selectedManager)||void 0===t||t.clear(),r.forEach((function(e){return n.applySelectedManager("add",e.model)}))}},{key:"slideChildren",get:function(){var e;return null===(e=this.currentSlide)||void 0===e?void 0:e.children}},{key:"currentSlide",get:function(){return this.getSelectionService().currentSlide}}]),n}(f.Component);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=function(){function e(){var t=this;o()(this,e),d()(this,"drawerService",void 0),d()(this,"selectWindowWidth",m.d),d()(this,"services",void 0),d()(this,"drawerStateManager",void 0),d()(this,"init",(function(e){t.drawerStateManager=e,t.drawerService=g.e.get(b.c),Object(p.r)((function(){var e;return null===(e=t.services.rightSideBarManager)||void 0===e?void 0:e.isSelectWindowShown}),(function(e){if(e)t.showSelectWindow();else{var n;null===(n=t.drawerStateManager)||void 0===n||n.closeRightDrawer(S.b.SELECT_WINDOW_RIGHT_DRAWER);var i=t.services.rightSideBarManager;if((null==i?void 0:i.selectWindowShowAction)===y.t.FROM_FORMAT)return null==i||i.setSelectWindowShowAction(y.t.NONE),void(null==i||i.setIsPropertyEditorShown(!0))}window.dispatchEvent(new Event("resize"))}))})),d()(this,"showSelectWindow",(function(){var e;t.drawerService.showRightDrawer({name:S.b.SELECT_WINDOW_RIGHT_DRAWER,content:v.a.createElement(de,{zIndex:1,services:t.services}),style:{height:w.DRAWER_HEIGHT,borderBottom:"1px solid #e4e4e4",padding:"0px",backgroundColor:"#fcfcfc",width:t.selectWindowWidth},onClose:t.closeSelectWindow,edgeDraggable:{maxWidth:500,onDragEnd:t.handleSelectWindowDragEnd}}),null===(e=t.drawerStateManager)||void 0===e||e.handleDrawerHolderVisiable(!0)})),d()(this,"closeSelectWindow",(function(){var e,n;null===(e=t.drawerStateManager)||void 0===e||e.closeRightDrawer(S.b.SELECT_WINDOW_RIGHT_DRAWER),null===(n=t.services.rightSideBarManager)||void 0===n||n.setIsSelectWindowShown(!1)})),d()(this,"handleSelectWindowDragEnd",function(){var e=r()(h.a.mark((function e(n){var i,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.selectWindowWidth=n,null===(i=t.services.rightSideBarManager)||void 0===i||i.setSelectWindowWidth(n),null===(r=t.drawerStateManager)||void 0===r||r.updateDrawerHolderStyle(),window.dispatchEvent(new Event("resize")),ae(he(he({},re.setWidth),{},{ver5:n}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}return l()(e,[{key:"setServiceDelegates",value:function(e){this.services=he(he({},this.services),e)}}]),e}()},c8ef76e304:function(e,t,n){"use strict";n.r(t),n.d(t,"OcrService",(function(){return S}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var i=n("176815363d"),r=n.n(i),a=n("9132715560"),o=n.n(a),c=n("6a364eb35c"),l=n.n(c),s=n("85d0a7609b"),d=n.n(s),u=n("3ef2352f0b"),h=n.n(u),f=(n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("081c8cafea"),n("9da6335152")),v=n("d3d31c86eb"),p=n("775b80aea6"),g=n("cd1934c1b5"),b=n("3f38f7f582"),m=n("dab925d4ad");function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(){function e(){o()(this,e),d()(this,"eventListenMap",void 0),d()(this,"services",void 0),this.eventListenMap=new Map}var t;return l()(e,[{key:"setServiceDelegates",value:function(e){this.services=w(w({},this.services),e)}},{key:"showOcrRightBar",value:(t=r()(h.a.mark((function e(t,n,i){var r,a,o,c,l,s,d,u,y,S,E=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)();case 2:if(o=e.sent,c=Object(b.getAidForReport)({feature:"slideocr",position:i?b.POSITIONS.PICRIGHTMENU:b.POSITIONS.PICTOOLBAR}),l=n||t.props.src||(null===(r=t.props.style.fillBackground)||void 0===r||null===(a=r.image)||void 0===a?void 0:a.src),s=t.key,!g.a.isBlobUrl(l)){e.next=18;break}if(d=p.a.getInstance().getResourceByUrl(l),!(u=null==d?void 0:d.getCdnUrl())){e.next=13;break}l=u,e.next=18;break;case 13:if(!this.eventListenMap.get(s)){e.next=15;break}return e.abrupt("return");case 15:return this.eventListenMap.set(s,!0),null==d||d.onDidUpload((function(e){E.eventListenMap.delete(s),E.showOcrRightBar(t,i,e.getCdnUrl())})),e.abrupt("return");case 18:this.services.ocrSideBarManager.show(),y=document.getElementById("rs-bar-ocr-sidebar"),S={ver5:"slide",ver6:i?2:1},o.show({container:y,source:c,imageUrls:[l],tdwParams:S,onClose:this.services.ocrSideBarManager.hide}),Object(v.c)({opername:f.e.OCR,module:f.d.OCR_PICTURE,action:f.b.OCR_ENTRANCE,ver5:i?1:0}),Object(v.c)(w({opername:f.e.OCR_COMPONENTS,module:f.d.EXTRACT_TEXT,action:f.b.OCR_ENTRANCE},S));case 24:case"end":return e.stop()}}),e,this)}))),function(e,n,i){return t.apply(this,arguments)})}]),e}()},c938aa3d7f:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+55S75p2/PC90aXRsZT4KICAgIDxnIGlkPSLnlLvmnb8iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM4MTg2OEYiPgogICAgICAgICAgICA8cGF0aCBkPSJNMTcuNTk5ODI0NCw5IEwxOSwxMC40NDQzNDI3IEMxOC40NDY1OCwxMC45NjgwODI0IDE3LjgzOTM2MTgsMTEuNDI0OTk5NyAxNy4xOTAxNzg5LDExLjgwODggTDE4LjQ0MzA4OTksMTMuOTUzODMwOSBMMTYuNjkwMDcxNiwxNC45NTM4MzA5IEwxNS4zNTAwMzU0LDEyLjY2MDcyMjggQzE0LjYwMDcwNDEsMTIuOTIwMTU0MyAxMy44MTY5Mzg1LDEzLjA5MzA2NTggMTMuMDEyMzYyMSwxMy4xNzIyMTAyIEwxMy4wMTIxMDU2LDE1LjcyMTc4MDEgTDEwLjk4Nzg5NDQsMTUuNzIxNzgwMSBMMTAuOTg3NDgyNiwxMy4xNzIxOTQ5IEMxMC4xODI5MDUxLDEzLjA5MzAzODEgOS4zOTkxMzk1LDEyLjkyMDExMzcgOC42NDk4MDk0NywxMi42NjA2NjkgTDcuMzA5OTI4NCwxNC45NTM4MzA5IEw1LjU1NjkxMDA5LDEzLjk1MzgzMDkgTDYuODA5ODg4ODIsMTEuODA4ODQgQzYuMjI1MjI4NzYsMTEuNDYzMTkyMSA1LjY3NDYwNTUyLDExLjA1ODIzOTYgNS4xNjY2NjMwNiwxMC41OTg1ODA1IEw1LDEwLjQ0NDM0MjcgTDYuNDAwMTc1NTgsOSBDNy44OTc5NDA4NiwxMC40MTc0Mzg5IDkuODgzNjU2NTcsMTEuMjIxNzgwMSAxMiwxMS4yMjE3ODAxIEMxNC4wNDU3OTg3LDExLjIyMTc4MDEgMTUuOTY5NTMzLDEwLjQ3MDE2NzkgMTcuNDQ4NDM0Niw5LjEzOTY5MzE1IEwxNy41OTk4MjQ0LDkgWiI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},cb5ea60341:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.FromPhotoAlbum="FROM_PHOTO_ALBUM",e.FromTencentDocument="FROM_TENCENT_DOCUMENT",e.FromLocalFile="FROM_LOCAL_FILE",e.Camera="CAMERA"}(i||(i={}))},cbed327f38:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ie}));var i,r,a=n("176815363d"),o=n.n(a),c=n("9132715560"),l=n.n(c),s=n("6a364eb35c"),d=n.n(s),u=n("85d0a7609b"),h=n.n(u),f=n("3ef2352f0b"),v=n.n(f),p=(n("c6244f7705"),n("081c8cafea"),n("3dc8f33382"),n("3bf1976a4f"),n("69084d01d3")),g=n.n(p),b=n("52d461bc51"),m=n.n(b),y=n("8b13fcae36"),w=n("14502724a6"),S=n.n(w),E=n("3404d6c52c"),O=n.n(E),k=n("e792a3169a"),x=n.n(k),M=n("e8e5384bef"),P=n.n(M),C={insert:"head",singleton:!1},I=(x()(P.a,C),P.a.locals||{}),R=n("5fac0349d3"),T=n("61b512a558"),A=n.n(T),D=n("11246a1392"),L=n.n(D),N=(n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("9d0daf5c3f"),n("a52ab4297c")),j=n.n(N),B=n("f4e4ed5c17"),H=n("020899bf26"),_=n("db0c73f5df"),F=function(){function e(t){l()(this,e),h()(this,"cachedUrl",null),h()(this,"cachedQRCode",null),h()(this,"createQRCodeFn",void 0),this.createQRCodeFn=t}var t;return d()(e,[{key:"clearCache",value:function(){this.cachedUrl=null,this.cachedQRCode=null}},{key:"createQRCode",value:(t=o()(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cachedUrl!==t){e.next=2;break}return e.abrupt("return",this.cachedQRCode);case 2:return e.prev=2,e.next=5,this.createQRCodeFn(t);case 5:return n=e.sent,this.cachedUrl=t,this.cachedQRCode=n,e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(2),this.clearCache(),e.t0;case 15:case"end":return e.stop()}}),e,this,[[2,11]])}))),function(e){return t.apply(this,arguments)})}]),e}(),U=new F((function(e){return new Promise((function(t,n){var i;e||n();var r=null!==(i=H.a.DocInfoManager())&&void 0!==i?i:{},a=r.domainId,o=void 0===a?"":a,c=r.padId,l=void 0===c?"":c;B.a.get("/cgi-bin/online_docs/wxqrcode?".concat(j.a.stringify({dataType:0,domainId:o,padId:l,page:"pages/detail/detail",ac:"mini_app_share",param:JSON.stringify({url:e}),width:200,xsrf:Object(_.b)()})),{responseType:"blob"}).then((function(e){200===e.status&&t(URL.createObjectURL(e.data)),n()})).catch(n)}))})),z=new F((function(e){return new Promise((function(t,n){var i;e||n();var r=null!==(i=H.a.DocInfoManager())&&void 0!==i?i:{},a=r.domainId,o=void 0===a?"":a,c=r.padId,l=void 0===c?"":c;B.a.get("/api/share/gen_qrcode?".concat(j.a.stringify({domainId:o,padId:l,codeType:8,platform:2,page:"pages/detail/detail",param:JSON.stringify({url:e}),ac:"share",width:200,xsrf:Object(_.b)()}))).then((function(e){200===e.status&&0===e.data.retcode&&t("data:image/png;base64,".concat(e.data.result.image)),n()})).catch(n)}))})),W=n("64ebbf1e02"),G=n.n(W),K={insert:"head",singleton:!1},V=(x()(G.a,K),G.a.locals||{}),Y=function(e){var t=e.onClick,n=e.type,i=e.title,r=e.text;return g.a.createElement("div",{className:V["mask-container"],onClick:t},g.a.createElement("span",{className:V["mask-bg"]}),g.a.createElement("div",{className:V["mask-info"]},g.a.createElement("span",{className:"".concat(V["mask-icon"]," ").concat(V[n])}),g.a.createElement("span",{className:V["mask-title"]},i),g.a.createElement("span",{className:V["mask-text"]},r)))};!function(e){e.qq="qq",e.wx="wx"}(i||(i={})),function(e){e.success="success",e.error="error",e.loading="loading"}(r||(r={}));var Z=function(e){var t=Object(p.useState)({url:"",state:r.loading}),n=S()(t,2),a=n[0],o=n[1],c=e.url,l=e.qrCodeType,s=e.scanCompleted,d=void 0!==s&&s,u=e.onPlay,h=e.onCreateRoom,f=e.onCloseRoom,v=e.onClose,b=!!c;Object(p.useEffect)((function(){y()}),[c]);var m=l===i.qq?z:U,y=function(){c?(a.state===r.error&&o({url:"",state:r.loading}),m.createQRCode(c).then((function(e){o({url:e,state:r.success})})).catch((function(){o({url:"",state:r.error})}))):o({url:"",state:r.loading})};return g.a.createElement("div",{className:I["mobile-control-dialog"]},g.a.createElement("span",{className:I["dialog-close"],onClick:v}),g.a.createElement("div",{className:I["dialog-content"]},g.a.createElement("div",{className:I["dialog-title"]},R.a.t("欢迎使用手机遥控提词")),b?g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:I["dialog-info-text"]},l===i.qq?R.a.t("使用手机 QQ 扫描下方小程序码"):R.a.t("使用手机微信扫描下方小程序码")),d?g.a.createElement("div",{className:I.qrcode},g.a.createElement(Y,{onClick:u,type:"success",title:R.a.t("扫描成功"),text:R.a.t("点击开始演示")})):g.a.createElement(O.a,{visible:a.state===r.loading,tip:R.a.t("小程序码生成中")},g.a.createElement("div",{className:I.qrcode},a.state===r.error&&g.a.createElement(Y,{onClick:y,type:"error",title:R.a.t("小程序码生成失败"),text:R.a.t("请点击重试")}),a.state===r.success&&g.a.createElement("img",{src:a.url,alt:R.a.t("手机遥控提词"),onError:function(){m.clearCache(),o({url:"",state:r.error})}}))),g.a.createElement("div",{className:I["dialog-info-text"]},R.a.t("手机电脑同步控制，查看备注更加高效")),d?g.a.createElement(L.a,{className:I["blue-button"],type:"primary",size:"large",onClick:u},R.a.t("开始演示")):g.a.createElement(L.a,{className:I["white-button"],type:"default",size:"large",onClick:f},R.a.t("关闭提词器"))):g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:I["dialog-info-text"]},R.a.t("手机电脑同步控制，查看备注更加高效")),g.a.createElement("div",{className:I.qrcode},g.a.createElement("img",{src:A.a,alt:R.a.t("手机遥控提词")})),g.a.createElement(L.a,{className:I["blue-button"],type:"primary",size:"large",onClick:h},R.a.t("打开提词器")))))},J=n("ad922c423b"),q=n("82f2dc9440"),X=n.n(q),Q=n("646a4e8f32"),$=n("6884e1a126"),ee=n("d3d31c86eb"),te=n("9da6335152"),ne=n("d818a44ab4"),ie=function(){function e(){var t=this;l()(this,e),h()(this,"dropdown",void 0),h()(this,"scanCompleted",!1),h()(this,"services",void 0),h()(this,"open",o()(v.a.mark((function e(){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.services.remoteControlManager.promise();case 2:(n=e.sent).initRoomInfoAndEnter().catch((function(){})).finally((function(){t.dropdown||(t.dropdown=J.a.create({belongID:"mobile-control-btn",scrollable:!1,center:"center",hasShadow:!1,isTransparent:!0,zIndex:"var(--z-index-modal-negative)"})),window.log.info("mobileRemoteControlLog-dropdown: open"),t.updateDropContent(),t.dropdown.show()})),n.event.on(ne.a,t.handleMobileJoin);case 5:case"end":return e.stop()}}),e)})))),h()(this,"handleClose",o()(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.scanCompleted=!1,t.dropdown&&t.dropdown.close(),t.dropdown=null,e.next=5,t.services.remoteControlManager.promise();case 5:e.sent.event.off(ne.a,t.handleMobileJoin);case 7:case"end":return e.stop()}}),e)})))),h()(this,"updateDropContent",(function(){t.dropdown&&t.dropdown.updateDropContent(t.getDropContent())})),h()(this,"getDropContent",(function(){var e,n,r,a=(null===(e=t.services.extensionService.getDocInfo())||void 0===e?void 0:e.userInfo)||{},o=a.loginType,c=a.wxOpenid,l=1!==o||c?i.wx:i.qq;return window.log.info("mobileRemoteControlLog-dropdown: url=".concat(null===(n=t.services.remoteControlManager.dangerousInstance)||void 0===n?void 0:n.remoteControlUrl,", qrCodeType=").concat(l)),g.a.createElement(Z,{scanCompleted:t.scanCompleted,url:(null===(r=t.services.remoteControlManager.dangerousInstance)||void 0===r?void 0:r.remoteControlUrl)||"",onCreateRoom:t.handleCreateRoom,onCloseRoom:t.handleCloseRoom,onClose:t.handleClose,onPlay:t.handlePlay,qrCodeType:l})})),h()(this,"handleCreateRoom",o()(v.a.mark((function e(){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.closeMeetingRoom();case 2:return e.next=4,t.services.remoteControlManager.promise();case 4:(n=e.sent).createShow((function(e){e.error?m.a.confirm({content:R.a.t("信息未成功拉取，请刷新后重试"),onOk:function(){Object(y.tencentDocOpenUrlReload)()},okText:R.a.t("立即刷新"),cancelText:null}):(n.initRoomInfoAndEnter(),window.log.info("mobileRemoteControlLog-dropdown: createRoom roomid=".concat(n.roomInfo().roomid)),t.updateDropContent())}));case 6:case"end":return e.stop()}}),e)})))),h()(this,"handleCloseRoom",o()(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.services.remoteControlManager.promise();case 2:e.sent.closeAndStopLive(),window.log.info("mobileRemoteControlLog-dropdown: manual closeRoom"),t.handleClose();case 6:case"end":return e.stop()}}),e)})))),h()(this,"handlePlay",(function(){Object(ee.c)({opername:te.e.DOC_PPT,module:te.d.MOBILE_CONTROLLER,action:te.b.MOBILE_CONTROLLER_PAIR_SUCCESS}),t.handleClose(),t.services.slideRenderStateManager.isAllSlideConvertComplete?(window.log.info("mobileRemoteControlLog-dropdown: play"),setTimeout(o()(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.services.remoteControlManager.promise();case 2:e.sent.startPCPlay();case 4:case"end":return e.stop()}}),e)}))),1)):X.a.show({message:R.a.t("加载幻灯片中，请稍后再试"),duration:3e3})})),h()(this,"handleMobileJoin",(function(){t.scanCompleted=!0,window.log.info("mobileRemoteControlLog-dropdown: mobileJoin"),t.updateDropContent()}))}var t;return d()(e,[{key:"setServiceDelegates",value:function(e){this.services=e}},{key:"closeMeetingRoom",value:(t=o()(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $.e.get(Q.b).event.emit(Q.a.PLAY_ACTION_ACTIVE_CHANGE,!1),e.next=3,this.services.liveManager.promise();case 3:return t=e.sent,e.next=6,t.closeAndStopLive();case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()},d818a44ab4:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i="startPCPlay",r="mobileJoin"},e88a0c4eb1:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return we}));n("b1e2246d82"),n("a84962d637"),n("f45588a8ad"),n("de37db1287"),n("342844cefa"),n("c554310b5c"),n("bcb5d93d36");var i,r,a,o,c,l=n("14502724a6"),s=n.n(l),d=n("1f925d7f50"),u=n.n(d),h=n("9132715560"),f=n.n(h),v=n("6a364eb35c"),p=n.n(v),g=n("85d0a7609b"),b=n.n(g),m=n("2dc700e1e6"),y=n.n(m),w=(n("f1054791f4"),n("8aebbf296a"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("75563bc376"),n("8ee19818c4"),n("1bab7b5fb7"),n("2504ad7290"),n("3bf1976a4f"),n("963f2eaace"),n("c6244f7705"),n("081c8cafea"),n("0acdc5834b"),n("eb9e932508"),n("6e20b6a7d8"),n("8a35b54c1d"),n("22569efd03"),n("a2a09da1e3"),n("d5c3deb8c7")),S=n("9657b29818"),E=n("52d461bc51"),O=n.n(E),k=n("82f2dc9440"),x=n.n(k),M=n("d3d31c86eb"),P=n("9da6335152"),C=n("2c0f58c21b"),I=n("efc1955963"),R=n("c45b58bbe8"),T=n("5fac0349d3"),A=n("176815363d"),D=n.n(A),L=n("3ef2352f0b"),N=n.n(L),j=(n("34cd92f77a"),n("0a8ecd6412")),B=n("8f790bec02"),H=n.n(B),_=n("5cdbac46e8"),F=n("b7b86f256a"),U=n("7c46f42788");!function(e){e[e.BASIC_SEARCH=0]="BASIC_SEARCH",e[e.ADVANCED_SEARCH=1]="ADVANCED_SEARCH"}(c||(c={}));var z,W,G,K,V,Y,Z,J,q,X,Q,$,ee,te,ne="blur",ie="focus",re="mousedown",ae=T.a.t("查找结果在备注内"),oe="search-input",ce="161px",le=(i={},b()(i,j.v.SINGLE_TOOLBAR,{top:"103px"}),b()(i,j.v.DOUBLE_TOOLBAR,{top:ce}),i),se=(r=function(){function e(){var t=this;f()(this,e),b()(this,"searchReplacePanel",void 0),b()(this,"searchReplaceManager",void 0),b()(this,"canEdit",void 0),b()(this,"isFocus",!1),b()(this,"showPanel",!1),b()(this,"searchText",""),b()(this,"dialog",void 0),b()(this,"currentSlideIndex",-1),b()(this,"slideCount",1),b()(this,"searchReplaceBuilder",void 0),b()(this,"selectionService",void 0),b()(this,"uiDataService",void 0),b()(this,"userPriviledgeService",void 0),b()(this,"masterLayoutEditService",void 0),b()(this,"toolbarStateManager",void 0),u()(this,"showToast",a,this),u()(this,"updateCount",o,this),b()(this,"init",(function(e){var n=e.selectionService,i=e.uiDataService,r=e.userPriviledgeService,a=e.masterLayoutEditService,o=e.searchReplaceManager,c=e.toolbarStateManager;t.searchReplaceManager=o,t.selectionService=n,t.uiDataService=i,t.userPriviledgeService=r,t.masterLayoutEditService=a,t.toolbarStateManager=c,Object(w.r)((function(){var e;return{dialogOpenFlag:null===(e=t.searchReplaceManager)||void 0===e?void 0:e.dialogOpenFlag}}),t.handlePanelShowOrHide),Object(w.r)((function(){var e;return{changePageFlag:null===(e=t.searchReplaceManager)||void 0===e?void 0:e.changePageFlag,currentSlideIndex:t.selectionService.currentSlideIndex,slideCount:t.uiDataService.presentation.slideCount}}),t.handleSlideChange),Object(w.r)((function(){var e,n;return{isSearchingFlag:null===(e=t.searchReplaceManager)||void 0===e?void 0:e.isSearchingFlag,keywordCount:null===(n=t.searchReplaceManager)||void 0===n?void 0:n.keywordCount,updateCount:t.updateCount}}),t.updatePanel),Object(w.r)((function(){return{pptEditorState:t.userPriviledgeService.pptEditorState}}),t.lockChange),Object(w.r)((function(){return{toolbarMode:t.toolbarStateManager.getToolbarMode()}}),t.updatePanelStyle),Object(w.r)((function(){var e,n;return null!==(e=null===(n=t.masterLayoutEditService)||void 0===n?void 0:n.isMasterEditType)&&void 0!==e&&e}),(function(e){return e&&t.hidePanel()}))})),b()(this,"createSearchReplacePanel",(function(){return t.searchReplaceBuilder=new H.a(t.canEdit),t.searchReplaceBuilder.setSearch({handleSearch:t.handleSearch,handleInputChange:function(e){return t.handleValueChange(e)},handleNext:function(){return t.handleHighlight(F.b.Next)},handlePrev:function(){return t.handleHighlight(F.b.Last)},handleClose:t.handleClose}),t.canEdit&&t.searchReplaceBuilder.setReplace({handleReplace:function(e){return t.handleReplace(e)},handleReplaceAll:function(e){return t.handleReplaceAll(e)}}),t.searchReplaceBuilder.build()})),b()(this,"handlePanelShowOrHide",(function(){var e;if(t.searchReplacePanel||t.lockChange(),(null===(e=t.searchReplaceManager)||void 0===e?void 0:e.dialogOpenFlag)||!1){var n,i;t.showPanel=!0;var r=(null===(n=t.searchReplaceManager)||void 0===n?void 0:n.searchReplaceType)===F.c.Replace?c.ADVANCED_SEARCH:c.BASIC_SEARCH;null===(i=t.searchReplacePanel)||void 0===i||i.show(r,document.body,t.getPanelStyle()),t.dialog=document.getElementsByClassName("search-replace-component-dialog")[0],t.mountEvent()}else t.hidePanel()})),b()(this,"hidePanel",(function(){t.closePanel(),t.unmountEvent(),t.dialog=null})),b()(this,"handleSlideChange",(function(){var e,n,i,r=t.selectionService.currentSlideIndex;r===t.currentSlideIndex||null===(e=t.searchReplaceManager)||void 0===e||!e.isSearchingFlag||null!==(n=t.searchReplaceManager)&&void 0!==n&&n.changePageFlag||(null===(i=t.searchReplaceManager)||void 0===i||i.exitSearching());t.currentSlideIndex=r;var a=t.uiDataService.presentation.slideCount;a!==t.slideCount&&(t.slideCount=a,t.handleDialogFocus())})),b()(this,"updatePanel",(function(){if(0!==t.updateCount)return t.updatePanelStyle()})),b()(this,"updatePanelStyle",(function(){var e,n=t.getSearchResult();return null===(e=t.searchReplacePanel)||void 0===e||e.update(n,t.getPanelStyle()),n})),b()(this,"lockChange",(function(){var e,n,i;(t.canEdit=t.userPriviledgeService.pptEditorState===_.b.EDITABLE,t.searchReplacePanel)&&(null===(e=t.searchReplaceManager)||void 0===e||e.closeDialog(),null===(n=t.searchReplacePanel)||void 0===n||n.close(),null===(i=t.searchReplacePanel)||void 0===i||i.destroy());t.searchReplacePanel=t.createSearchReplacePanel()})),b()(this,"handleDialogFocus",(function(){var e;t.isFocus||(t.isFocus=!0,null===(e=t.selectionService.selectedElements)||void 0===e||e.clear(),t.research())})),b()(this,"handleDialogBlur",(function(){t.isFocus&&(t.isFocus=!1)})),b()(this,"handleDialogMouseDown",(function(e){var n;!t.searchReplaceManager.modal&&t.dialog&&(null!==(n=t.dialog)&&void 0!==n&&n.contains(e.target)?t.handleDialogFocus():(t.handleDialogBlur(),t.exitSearching()))})),b()(this,"research",(function(){var e,n;!t.searchText||null!==(e=t.searchReplaceManager)&&void 0!==e&&e.isSearchingFlag||(null===(n=t.searchReplaceManager)||void 0===n||n.search(t.searchText))})),b()(this,"getSearchResult",(function(){return{current:t.getCurrentIndex(),total:t.keywordCount,canSingleReplace:t.keywordCount>0,canReplaceAll:t.keywordCount>0,message:t.showToast?T.a.t(ae):""}})),b()(this,"getCurrentIndex",(function(){var e,n=(null===(e=t.searchReplaceManager)||void 0===e?void 0:e.currentIndex)||0;return 0!==t.keywordCount&&n>t.keywordCount-1&&(n=t.keywordCount-1),n})),b()(this,"handleValueChange",function(){var e=D()(N.a.mark((function e(n){var i,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.searchText=n,t.searchText||(null===(r=t.searchReplaceManager)||void 0===r||r.clear(),t.clearToast()),null===(i=t.searchReplaceManager)||void 0===i||i.search(t.searchText),t.updateCount+=1;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),b()(this,"handleHighlight",function(){var e=D()(N.a.mark((function e(n){var i,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.clearToast(),!t.shouldStopSearch()){e.next=4;break}return t.updatePanel(),e.abrupt("return");case 4:null!==(i=t.searchReplaceManager)&&void 0!==i&&i.isSearchingFlag||null===(r=t.searchReplaceManager)||void 0===r||r.search(t.searchText),t.checkNoteArea(n),t.handleDialogFocus(),t.updateCount+=1;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),b()(this,"handleSearch",D()(N.a.mark((function e(){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=t.searchReplaceManager)||void 0===n||!n.modal){e.next=2;break}return e.abrupt("return");case 2:if(!t.shouldStopSearch()){e.next=5;break}return t.updatePanel(),e.abrupt("return");case 5:t.handleHighlight(F.b.Next);case 6:case"end":return e.stop()}}),e)})))),b()(this,"shouldStopSearch",(function(){var e;return(null===(e=t.searchReplaceManager)||void 0===e?void 0:e.isSearchingFlag)&&0===t.keywordCount||""===t.searchText})),b()(this,"handleReplace",function(){var e=D()(N.a.mark((function e(n){var i,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.clearToast(),null!==(i=t.searchReplaceManager)&&void 0!==i&&i.lastHighlightPosition){e.next=5;break}t.handleHighlight(F.b.Next),e.next=7;break;case 5:return e.next=7,null===(r=t.searchReplaceManager)||void 0===r?void 0:r.replace(n);case 7:t.handleDialogFocus();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),b()(this,"handleReplaceAll",function(){var e=D()(N.a.mark((function e(n){var i,r,a,o;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(i=t.searchReplaceManager)||void 0===i||!i.modal){e.next=2;break}return e.abrupt("return");case 2:t.clearToast(),null!==(r=t.searchReplaceManager)&&void 0!==r&&r.isSearchingFlag||null===(o=t.searchReplaceManager)||void 0===o||o.search(t.searchText),null===(a=t.searchReplaceManager)||void 0===a||a.replaceAll(n),t.handleDialogFocus();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),b()(this,"handleClose",(function(){var e;null===(e=t.searchReplaceManager)||void 0===e||e.closeDialog()})),b()(this,"closePanel",(function(){var e;t.showPanel&&(null===(e=t.searchReplacePanel)||void 0===e||e.close(),t.showPanel=!1,t.searchText="",t.updateCount=0,t.clearToast(),t.exitSearching())})),b()(this,"clearToast",(function(){t.showToast=!1})),b()(this,"getPanelStyle",(function(){var e=le[t.toolbarStateManager.getToolbarMode()];return e||{top:ce}}))}return p()(e,[{key:"mountEvent",value:function(){var e=document.getElementById(oe);null==e||e.addEventListener(ie,this.handleDialogFocus,!0),null==e||e.addEventListener(ne,this.handleDialogBlur,!0),window.addEventListener(re,this.handleDialogMouseDown,!0)}},{key:"unmountEvent",value:function(){var e=document.getElementById(oe);null==e||e.removeEventListener(ie,this.handleDialogFocus,!0),null==e||e.removeEventListener(ne,this.handleDialogBlur,!0),window.removeEventListener(re,this.handleDialogMouseDown,!0)}},{key:"checkNoteArea",value:function(e){var t,n=null===(t=this.searchReplaceManager)||void 0===t?void 0:t.searchHighlight(e);if(n){var i=n.component;(null==i?void 0:i.getPage().type)===U.a.Notes&&(this.showToast=!0)}}},{key:"exitSearching",value:function(){var e,t;!(null===(e=this.searchReplaceManager)||void 0===e?void 0:e.isSearchingFlag)&&1||(null===(t=this.searchReplaceManager)||void 0===t||t.exitSearching())}},{key:"keywordCount",get:function(){var e;return(null===(e=this.searchReplaceManager)||void 0===e?void 0:e.keywordCount)||0}}]),e}(),a=y()(r.prototype,"showToast",[w.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=y()(r.prototype,"updateCount",[w.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r),de=n("c9c92622ff"),ue=n("fdddc95d9b"),he=n("02918f4580"),fe=n("0815464a4d"),ve=n("020899bf26");function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw a}}}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ye=500,we=(z=w.q,W=w.q,G=w.q,K=w.q,V=w.q,Y=w.q,Z=Reflect.metadata("design:type",void 0===F.c?Object:F.c),J=function(){function e(){var t=this;f()(this,e),u()(this,"currentIndex",q,this),u()(this,"dialogOpenFlag",X,this),u()(this,"isHighlighting",Q,this),u()(this,"isSearchingFlag",$,this),u()(this,"keywordCount",ee,this),u()(this,"searchReplaceType",te,this),b()(this,"changePageFlag",!1),b()(this,"currentPageResult",void 0),b()(this,"keyword",void 0),b()(this,"lastHighlightPosition",void 0),b()(this,"modal",!1),b()(this,"rawSearchResult",void 0),b()(this,"searchResult",void 0),b()(this,"userPriviledgeService",void 0),b()(this,"masterLayoutEditService",void 0),b()(this,"uiDataService",void 0),b()(this,"editorInstanceService",void 0),b()(this,"selectionService",void 0),b()(this,"toolbarStateManager",void 0),b()(this,"inlineNodeKeywordCount",0),this.isSearchingFlag=!1,ve.a.SDKDataServices.EventManager.promise().then((function(e){e.mutationEvents.onCommitCommand((function(e){e!==ue.a.UndoRedo?e===ue.a.Collaborator&&t.handleChangeset():t.exitSearching()}))})),window.addEventListener("enterEditing",this.exitSearching)}return p()(e,[{key:"setServiceDelegates",value:function(e){var t=e.userPriviledgeService,n=e.uiDataService,i=e.editorInstanceService,r=e.selectionService,a=e.masterLayoutEditService,o=e.toolbarStateManager;this.userPriviledgeService=t,this.uiDataService=n,this.editorInstanceService=i,this.selectionService=r,this.masterLayoutEditService=a,this.toolbarStateManager=o}},{key:"init",value:function(){(new se).init({selectionService:this.selectionService,userPriviledgeService:this.userPriviledgeService,searchReplaceManager:this,uiDataService:this.uiDataService,masterLayoutEditService:this.masterLayoutEditService,toolbarStateManager:this.toolbarStateManager})}},{key:"getUIModelBySDKComponent",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Array.from((null===(t=this.selectionService.currentSlide)||void 0===t?void 0:t.children)||[]),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(n=this.selectionService.currentSlide)||void 0===n?void 0:n.noteData;if(r&&e.getPage().type===U.a.Notes&&(null==r?void 0:r.sdkData)===e.getPage())return r.noteTextBody;var a,o=be(i);try{for(o.s();!(a=o.n()).done;){var c=a.value;if(c instanceof C.a){var l=this.getUIModelBySDKComponent(e,c.children);if(l)return l}else if(c.sdkData&&c.sdkData===e)return c}}catch(e){o.e(e)}finally{o.f()}}},{key:"openDialog",value:function(e){var t,n;null!==(t=this.masterLayoutEditService)&&void 0!==t&&t.isMasterEditType||(Object(M.c)({opername:P.e.DOC_PPT,module:P.d.PC_SEARCH,action:e===F.c.Search&&(P.b.PC_SEARCH_SIDE_BAR||P.b.PC_SEARCH_REP_SIDE_BAR)}),null===(n=this.editorInstanceService.getEditorInstance())||void 0===n||n.triggerBlur(),this.searchReplaceType=e,this.dialogOpenFlag=!0)}},{key:"closeDialog",value:function(){this.dialogOpenFlag=!1,this.clear(),this.isSearchingFlag=!1}},{key:"changeSearchReplaceType",value:function(e){this.searchReplaceType=e}},{key:"search",value:function(e){var t=this;w.w((function(){return t.isHighlighting=!1,t.uiDataService.presentation.operation.loading?(x.a.show({message:T.a.t("正在加载幻灯片，请稍后再试"),type:"info",autoClose:!0}),!1):(t.selectionService.selectedSlides.clear(),(e!==t.keyword||!t.isSearchingFlag)&&(t.isSearchingFlag=!0,t.currentPageResult&&t.unMarkResult(t.currentPageResult),t.lastHighlightPosition&&t.cancelHighlight(t.lastHighlightPosition,t.currentPageResult.find((function(e){return e.component===t.lastHighlightPosition.component}))),t.keyword=e,t.updateRawSearchResult(t.keyword),t.updateSearchResult(t.rawSearchResult),t.searchResult&&t.searchResult.length?(t.currentPageResult=t.getIndexPageResult(t.searchResult,t.selectionService.currentSlideIndex),t.currentPageResult.length&&t.updateSearchResultUI(t.currentPageResult),!0):(t.currentPageResult=[],!0)))}))}},{key:"searchHighlight",value:function(e){var t;return t=this.searchReplaceType===F.c.Search?e===F.b.Last?P.b.PC_SEARCH_LAST:P.b.PC_SEARCH_NEXT:e===F.b.Last?P.b.PC_SEARCH_REP_LAST:P.b.PC_SEARCH_REP_NEXT,Object(M.c)({action:t,opername:P.e.DOC_PPT,module:P.d.PC_SEARCH}),this.isHighlighting=!0,this.lastHighlightPosition?this.currentIndex=this.getNextCurrentIndex(this.currentIndex,e,this.keywordCount):this.currentIndex=this.getFirstCurrentIndex(this.searchResult,this.selectionService.currentSlideIndex,e),this.renderHighlight(),this.getResultByIndex(this.searchResult,this.currentIndex).position}},{key:"replace",value:function(e){var t=this;w.w((function(){Object(M.c)({opername:P.e.DOC_PPT,module:P.d.PC_SEARCH,action:P.b.PC_SEARCH_REP_RESULT});var n=t.lastHighlightPosition,i=n.component,r=t.searchResult.find((function(e){return e.component===n.component}));r&&t.unMarkResult(t.currentPageResult).then((function(){if(i instanceof he.a){var a,o,c,l,s=r.result[n.offset].cell;if(!s)return;var d=[r.result[n.offset]],u=null===(a=i.store)||void 0===a||null===(o=a.data.graphic)||void 0===o||null===(c=o.graphicData)||void 0===c||null===(l=c.tbl)||void 0===l?void 0:l.tr;if(!u)return;var h=u[s.row].tc[s.col].txBody.p;h=t.replacePositionedTextInParagraphList(h,d,t.keyword,e),i.api.transaction((function(){u.forEach((function(e,t){e.tc.forEach((function(e,n){t===s.row&&n===s.col&&i.api.updateParagraphList(h,n,t)}))}))}))}else if(i instanceof fe.a){var f=[r.result[n.offset]],v=t.getParagraph(i);v=t.replacePositionedTextInParagraphList(v,f,t.keyword,e),i.api.updateParagraphList(v)}var p=t.getStringTimes(e,t.keyword);t.keywordCount&&!t.inlineNodeKeywordCount&&(t.keywordCount=t.keywordCount-1+p),t.keywordCount?(t.currentIndex+=t.inlineNodeKeywordCount,t.inlineNodeKeywordCount=0,t.currentIndex+=p,t.currentIndex>t.keywordCount-1&&(t.currentIndex=0),t.nextTick((function(){t.isSearchingFlag=!1,t.search(t.keyword),t.searchResult.length&&t.renderHighlight()}))):t.inlineNodeKeywordCount=0}))}))}},{key:"replaceAll",value:function(e){var t=this;Object(M.c)({opername:P.e.DOC_PPT,module:P.d.PC_SEARCH,action:P.b.PC_SEARCH_REP_ALL});var n=this.keywordCount,i=this.keyword,r=i.length>ye?"".concat(i.slice(0,496),"...").concat(i.slice(-1)):i,a=e.length>ye?"".concat(e.slice(0,496),"...").concat(e.slice(-1)):e;this.modal=!0,O.a.confirm({title:T.a.t("提示"),content:T.a.t("确定将此文档内的{0}处 “{1}” 全部替换为 “{2}” 吗？",{0:n,1:r,2:a}),onOk:function(){t.modal=!1,Object(M.c)({opername:P.e.DOC_PPT,module:P.d.PC_SEARCH,action:P.b.PC_SEARCH_REP_ALL_SUC}),t.exitSearching().then((function(){Object(S.b)((function(){t.searchResult.forEach((function(n){var r=n.component;if(r instanceof he.a){t.fixTableResult(n.result).forEach((function(n){var a,o,c,l,s=n.cell,d=n.textPositions,u=null===(a=r.store)||void 0===a||null===(o=a.data.graphic)||void 0===o||null===(c=o.graphicData)||void 0===c||null===(l=c.tbl)||void 0===l?void 0:l.tr;if(u){var h=u[s.row].tc[s.col].txBody.p;h=t.replacePositionedTextInParagraphList(h,d,i,e),r.api.transaction((function(){u.forEach((function(e,t){e.tc.forEach((function(e,n){t===s.row&&n===s.col&&r.api.updateParagraphList(h,n,t)}))}))}))}}))}else{var a=n.result,o=t.getParagraph(r);o=t.replacePositionedTextInParagraphList(o,a,i,e),r.api.updateParagraphList(o)}})),t.isSearchingFlag=!1,t.nextTick((function(){t.search(t.keyword),t.modal=!0,O.a.confirm({title:T.a.t("提示"),content:T.a.t("共完成{0}处替换",{0:n-t.inlineNodeKeywordCount}),onOk:function(){t.modal=!1},onClose:function(){t.modal=!1},cancelText:null}),t.inlineNodeKeywordCount=0}))}))}))},onCancel:function(){t.modal=!1},onClose:function(){t.modal=!1}})}},{key:"clear",value:function(){var e=this;this.currentPageResult&&this.unMarkResult(this.currentPageResult),this.lastHighlightPosition&&this.cancelHighlight(this.lastHighlightPosition,this.currentPageResult.find((function(t){return t.component===e.lastHighlightPosition.component}))),this.currentIndex=0,this.keywordCount=0,this.inlineNodeKeywordCount=0,this.keyword="",this.isSearchingFlag=!1,this.isHighlighting=!1,this.lastHighlightPosition=null}},{key:"exitSearching",value:function(){var e=this;if(!this.isSearchingFlag)return Promise.resolve();var t=[];return this.currentPageResult&&t.push(this.unMarkResult(this.currentPageResult)),this.lastHighlightPosition&&t.push(this.cancelHighlight(this.lastHighlightPosition,this.currentPageResult.find((function(t){return t.component===e.lastHighlightPosition.component})))),this.isSearchingFlag=!1,this.isHighlighting=!1,this.lastHighlightPosition=null,Promise.all(t)}},{key:"fixTableResult",value:function(e){return e.reduce((function(e,t){var n={cell:t.cell,textPositions:[{offset:t.offset,paragraph:t.paragraph}]};if(!e.length)return e.concat(n);var i=e[e.length-1];return i.cell.row===n.cell.row&&i.cell.col===n.cell.col?(e[e.length-1].textPositions.push(n.textPositions[0]),e):e.concat(n)}),[])}},{key:"handleChangeset",value:function(){var e,t=this;if(this.isSearchingFlag){var n=null===(e=ve.a.SDKDataServices.SearchManager())||void 0===e?void 0:e.replaceSearchResultFromMutation(this.keyword,this.rawSearchResult),i=this.keyword;if(n){this.updateSearchResult(this.rawSearchResult);var r=this.getIndexPageResult(this.searchResult,this.selectionService.currentSlideIndex);this.compareResult(this.currentPageResult,r)||(this.modal=!0,O.a.confirm({title:T.a.t("提示"),content:T.a.t("文档内容发生改变，请重新查找"),onOk:function(){t.modal=!1,t.clear(),t.search(i)},onCancel:function(){t.modal=!1,t.clear()},onClose:function(){t.modal=!1}}))}}}},{key:"compareResult",value:function(e,t){if(e.length!==t.length)return!1;for(var n=e.length,i=0;i<n;i++){var r=e[i],a=t[i];if(r.component!==a.component)return!1;if(r.result.length!==a.result.length)return!1;for(var o=0;o<r.result.length;o++){var c=r.result[o],l=a.result[o];if(c.offset!==l.offset)return!1;if(c.paragraph!==l.paragraph)return!1;if(c.cell&&l.cell){if(c.cell.col!==l.cell.col)return!1;if(c.cell.row!==l.cell.row)return!1}}}return!0}},{key:"fixSearchResult",value:function(e){var t=this;return e.filter((function(e){var t=e.component;return!Object(de.A)(t)})).map((function(e){var n=e.component.getPage();if(n.type===U.a.Notes){var i=n.getSlide();n=i||n}return ge({slideIndex:t.selectionService.slides.findIndex((function(e){return e.sdkData===n}))},e)})).sort((function(e,t){return e.slideIndex-t.slideIndex}))}},{key:"updateRawSearchResult",value:function(e){var t;""===e?this.rawSearchResult=[]:this.rawSearchResult=(null===(t=ve.a.SDKDataServices.SearchManager())||void 0===t?void 0:t.searchText(e))||[]}},{key:"updateSearchResult",value:function(e){this.searchResult=this.fixSearchResult(e),this.keywordCount=this.searchResult.reduce((function(e,t){return e+t.result.length}),0)}},{key:"getFirstCurrentIndex",value:function(e,t,n){var i,r=0,a=e.length,o=0;if(n===F.b.Last){for(i=e[a-1],r=a-1;r>=0;r--)if(e[r].slideIndex<=t){i=e[r];break}o=i.result.length-1}else{for(i=s()(e,1)[0],r=0;r<a;r++)if(e[r].slideIndex>=t){i=e[r];break}i===e[0]&&(r=0)}return o+e.slice(0,r).reduce((function(e,t){return e+t.result.length}),0)}},{key:"getNextCurrentIndex",value:function(e,t,n){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3])return 0;var i=e;return t===F.b.Last?(i-=1)<0&&(i=n-1):(i+=1)>=n&&(i=0),i}},{key:"getResultByIndex",value:function(e,t){for(var n=new F.a,i=0,r=0;r<e.length;r++){var a=e[r],o=a.result.length;if(!(i+o<=t)){n.component=a.component,n.pageIndex=a.slideIndex,n.offset=t-i;break}i+=o}return{position:n,pageResult:this.searchResult.filter((function(e){var t=e.slideIndex;return n.pageIndex===t}))}}},{key:"jumpToPage",value:function(e){return this.changePageFlag=!0,this.selectionService.changeCurrentSlideIndexByUserAction(e),Promise.resolve()}},{key:"markResult",value:function(e){var t=this;e.forEach((function(e){var n=e.component,i=e.result,r=t.getUIModelBySDKComponent(n);if(r)if(r instanceof I.a){t.fixTableResult(i).forEach((function(e){var n=e.cell,i=e.textPositions,a=r;(a=a.tableItems[n.row][n.col]).editorInstance&&a.editorInstance.addSearchMark(i,t.keyword)}))}else{var a=r;a.editorInstance&&a.editorInstance.addSearchMark(i,t.keyword)}}))}},{key:"unMarkResult",value:function(e){var t=this;return Promise.all(e.map((function(e){var n=e.component,i=e.result,r=t.getUIModelBySDKComponent(n);if(!r)return Promise.resolve();if(r instanceof I.a){var a;if(!(null===(a=t.selectionService.currentSlide)||void 0===a?void 0:a.children.find((function(e){return e.sdkData&&e.sdkData===n}))))return Promise.resolve();var o=t.fixTableResult(i);return Promise.all(o.map((function(e){var t=e.cell,n=r;return(n=n.tableItems[t.row][t.col]).editorInstance&&n.editorInstance.removeSearchMark()||Promise.resolve()})))}var c=r;return c.editorInstance&&c.editorInstance.removeSearchMark()||Promise.resolve()})))}},{key:"highlightPosition",value:function(e,t){var n=e.component,i=this.getUIModelBySDKComponent(n);if(i)if(i instanceof I.a){var r=null==t?void 0:t.result[e.offset],a=null==r?void 0:r.cell;if(!a)return;var o=i;(o=o.tableItems[a.row][a.col]).editorInstance&&o.editorInstance.addHighlight([r],this.keyword)}else{var c=i;c.editorInstance&&c.editorInstance.addHighlight([t.result[e.offset]],this.keyword)}}},{key:"cancelHighlight",value:function(e,t){if(!t)return Promise.resolve();var n=e.component,i=this.getUIModelBySDKComponent(n);if(!i)return Promise.resolve();if(i instanceof I.a){var r=null==t?void 0:t.result[e.offset],a=null==r?void 0:r.cell;if(!a)return Promise.resolve();var o=i;return(o=o.tableItems[a.row][a.col]).editorInstance&&o.editorInstance.removeHighlight()||Promise.resolve()}var c=i;return c.editorInstance&&c.editorInstance.removeHighlight()||Promise.resolve()}},{key:"getIndex",value:function(e,t){for(var n=0,i=0;i<t.length;i++){var r=t[i];if(r.component===e.component){n+=e.offset;break}n+=r.result.length}return n}},{key:"getIndexPageResult",value:function(e,t){return e.filter((function(e){var n=e.slideIndex;return t===n}))}},{key:"updateSearchResultUI",value:function(e){var t=this;this.lastHighlightPosition&&this.cancelHighlight(this.lastHighlightPosition,e.find((function(e){return e.component===t.lastHighlightPosition.component}))),this.markResult(e)}},{key:"updateHighlightUI",value:function(e){var t=this;if(this.lastHighlightPosition=e.position,this.currentIndex=this.getIndex(this.lastHighlightPosition,this.searchResult),this.currentPageResult!==e.pageResult)this.currentPageResult=e.pageResult,this.jumpToPage(this.lastHighlightPosition.pageIndex).then((function(){t.changePageFlag=!1,t.markResult(t.currentPageResult);var n=e.pageResult.find((function(e){return e.component===t.lastHighlightPosition.component}));n&&t.highlightPosition(t.lastHighlightPosition,n)}));else{this.markResult(this.currentPageResult);var n=e.pageResult.find((function(e){return e.component===t.lastHighlightPosition.component}));n&&this.highlightPosition(this.lastHighlightPosition,n)}}},{key:"renderHighlight",value:function(){var e=this;w.w((function(){e.isHighlighting=!0;var t=e.getResultByIndex(e.searchResult,e.currentIndex);e.lastHighlightPosition&&e.cancelHighlight(e.lastHighlightPosition,e.currentPageResult.find((function(t){return t.component===e.lastHighlightPosition.component}))),e.currentPageResult!==t.pageResult?(e.currentPageResult&&e.unMarkResult(e.currentPageResult),e.currentPageResult=t.pageResult,e.jumpToPage(t.position.pageIndex).then((function(){e.changePageFlag=!1,e.markResult(e.currentPageResult),e.updateHighlightUI(t)}))):e.updateHighlightUI(t)}))}},{key:"replacePositionedTextInParagraph",value:function(e,t,n,i){var r=this;var a=0,o=JSON.parse(JSON.stringify(e.egTextRun));return o=o.map((function(e){var o,c,l=e.r,s=function(e,t,n){var i=[],r=e.t.length,a=n.length;return t.forEach((function(e){if(!(e+a<0||e>=r)){var t={needReplace:!0};e<0&&(t.needReplace=!1),t.start=Math.max(0,e),t.end=Math.min(r,e+a),i.push(t)}})),i}(l,t.map((function(e){return e-a})),n);if(null!=l&&null!==(o=l.rPr)&&void 0!==o&&null!==(c=o.hlinkClick)&&void 0!==c&&c.iconMode)return a+=l.t.length,r.inlineNodeKeywordCount+=s.length,{r:l};if(a+=l.t.length,s.length){for(var d,u=0,h="",f=0;f<s.length;f++)d=s[f].start,h+=l.t.slice(u,d),s[f].needReplace&&(h+=i),u=s[f].end;h+=l.t.slice(u),l.t=h}return e})).filter((function(e){return e.r.t})),ge(ge({},e),{},{egTextRun:o})}},{key:"replacePositionedTextInParagraphList",value:function(e,t,n,i){var r=this;return e.map((function(e,a){return r.replacePositionedTextInParagraph(e,t.filter((function(e){return e.paragraph===a})).map((function(e){return e.offset})),n,i)}))}},{key:"getStringTimes",value:function(e,t){var n=-1,i=t.length;if(!i)return 0;var r=-1*i,a=e,o=t;e!==t&&e.toLowerCase()===t.toLowerCase()&&(a=e.toLowerCase(),o=t.toLowerCase());do{n+=1,r=a.indexOf(o,r+i)}while(r>-1);return n}},{key:"getParagraph",value:function(e){var t,n,i,r,a,o,c,l,s,d,u,h=null===(t=this.selectionService.currentSlide)||void 0===t?void 0:t.children.find((function(t){return t.sdkData===e}));if(!h)return null===(n=e.store)||void 0===n||null===(i=n.data)||void 0===i||null===(r=i.txBody)||void 0===r?void 0:r.p;var f=null==h||null===(a=h.editorInstance)||void 0===a?void 0:a.getData();if(!f)return null===(o=e.store)||void 0===o||null===(c=o.data)||void 0===c||null===(l=c.txBody)||void 0===l?void 0:l.p;var v={};return R.a.convertDataUiToSdk(f,v,e),v.txBody&&(v.txBody.p||(null===(s=e.store)||void 0===s||null===(d=s.data)||void 0===d||null===(u=d.txBody)||void 0===u?void 0:u.p))}},{key:"nextTick",value:function(e){for(var t=this,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];Promise.resolve().then((function(){e.apply(t,i)}))}}]),e}(),q=y()(J.prototype,"currentIndex",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),X=y()(J.prototype,"dialogOpenFlag",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Q=y()(J.prototype,"isHighlighting",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),$=y()(J.prototype,"isSearchingFlag",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ee=y()(J.prototype,"keywordCount",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),te=y()(J.prototype,"searchReplaceType",[Y,Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.c.Search}}),J)},e8e5384bef:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,'.style-mobile-control-dialog-3BEGC{width:320px;height:auto;background:#fff;border:1px solid #e3e3e3;box-shadow:0 2px 6px 0 rgba(0,0,0,.12);border-radius:4px;position:relative;padding:40px}.style-mobile-control-dialog-3BEGC .style-dialog-close-Heoq_{position:absolute;right:16px;top:16px;z-index:10;cursor:pointer;transition:color .3s ease;width:22px;height:22px;background-size:12px 12px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiI+PHBhdGggZmlsbD0iIzY2NiIgZD0iTTE2LjAyOCAxNC4xNDJMMS44ODYgMCAwIDEuODg2bDE0LjE0MiAxNC4xNDJMMCAzMC4xN2wxLjg4NiAxLjg4NiAxNC4xNDItMTQuMTQyTDMwLjE3IDMyLjA1NmwxLjg4Ni0xLjg4Ni0xNC4xNDItMTQuMTQyTDMyLjA1NiAxLjg4NiAzMC4xNyAwIDE2LjAyOCAxNC4xNDJ6Ii8+PC9zdmc+")}.style-mobile-control-dialog-3BEGC .style-dialog-content-3XQbt{text-align:center}.style-mobile-control-dialog-3BEGC .style-dialog-content-3XQbt .style-dialog-title-9kH5_{font-size:18px;font-weight:700;margin-bottom:6px}.style-mobile-control-dialog-3BEGC .style-dialog-content-3XQbt .style-dialog-info-text-3heEK{font-size:12px;color:#999}.style-mobile-control-dialog-3BEGC .style-dialog-content-3XQbt .style-qrcode-2mcJm{width:160px;height:160px;margin:10px auto;display:flex;align-items:center;background:#fff;justify-content:center}.style-mobile-control-dialog-3BEGC .style-dialog-content-3XQbt .style-qrcode-2mcJm img{width:100%;height:100%}.style-blue-button-1GCSo{background:#0188fb;border-radius:2px;color:#fff;border:0}.style-blue-button-1GCSo,.style-white-button-3KH13{width:240px;height:38px;margin:14px auto 0;display:block!important;font-size:14px}.style-white-button-3KH13{background:#fff;border-radius:2px;color:#333;border:1px solid rgba(0,0,0,.12)}',""]),t.locals={"mobile-control-dialog":"style-mobile-control-dialog-3BEGC","dialog-close":"style-dialog-close-Heoq_","dialog-content":"style-dialog-content-3XQbt","dialog-title":"style-dialog-title-9kH5_","dialog-info-text":"style-dialog-info-text-3heEK",qrcode:"style-qrcode-2mcJm","blue-button":"style-blue-button-1GCSo","white-button":"style-white-button-3KH13"}},ea2fc588ec:function(e,t){e.exports="//docs.gtimg.com/slide/img/slide/application/service/select-window/core/component/images/visible-245599.svg"},eca255582a:function(e,t,n){"use strict";n.r(t),n.d(t,"PcNoteAreaService",(function(){return j}));n("73b854064b");var i=n("9132715560"),r=n.n(i),a=n("6a364eb35c"),o=n.n(a),c=n("547611bd96"),l=n.n(c),s=n("8eec1e4a03"),d=n.n(s),u=n("bd29e2df90"),h=n.n(u),f=n("ab5eb40518"),v=n.n(f),p=n("1b4cdd6a36"),g=n.n(p),b=n("85d0a7609b"),m=n.n(b),y=(n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("8ee19818c4"),n("d5c3deb8c7")),w=n("5fac0349d3"),S=n("6a9e93341e"),E=n("4aef4ce634"),O=n.n(E),k=n("570b26a0fa"),x=n("9da6335152"),M=n("1e07095161"),P=n("84f4552293");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v()(this,n)}}var I=function(e){h()(n,e);var t=C(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"initModel",value:function(e,t){d()(g()(n.prototype),"initModel",this).call(this,e,t),this.noteAreaHeight=S.s}}]),n}(n("87c53f95ab").a),R=n("71d0c20804"),T=n("4130eb9b7d"),A=n("281cbdced7"),D=n.n(A);function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v()(this,n)}}var N=167,j=function(e){h()(i,e);var t=L(i);function i(){var e;return r()(this,i),e=t.call(this),m()(l()(e),"resistNoteAreaHeight",void 0),m()(l()(e),"noteAreaHeight",void 0),m()(l()(e),"rawNoteAreaHeight",void 0),m()(l()(e),"noteLayer",void 0),m()(l()(e),"fixNoteHeightByResize",(function(){var t,n,i=e.getWrapperHeight(),r=Object(T.a)(i,e.model.noteAreaHeight);r>=N||(r=i-N,r=e.fixNoteHeight(r),e.noteAreaHeight!==r&&e.setNoteAreaHeight(r),r<=S.r?e.hideNote():(e.resistNoteAreaHeight=e.noteAreaHeight,null===(t=e.services)||void 0===t||null===(n=t.noteAreaManager)||void 0===n||n.setShow()))})),m()(l()(e),"noteAreaShowFlag",(function(){return e.noteAreaHeight!==S.r})),m()(l()(e),"handleSplitLineBeforeDrag",(function(){var t,n;(e.rawNoteAreaHeight=e.model.noteAreaHeight,e.judgeNoteAreaCanShow())||(null===(t=e.services)||void 0===t||null===(n=t.tipsManager)||void 0===n||n.showMsg(w.a.t("请拉高页面后，再查看备注。")))})),m()(l()(e),"handleSplitLineOnDrag",O()((function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).offsetY;if(e.judgeNoteAreaCanShow()){var i=e.rawNoteAreaHeight-(n||0);(i=e.fixNoteHeight(i))!==e.model.noteAreaHeight&&e.setNoteAreaHeight(i)}}))),m()(l()(e),"handleSplitLineAfterDrag",(function(){var t,n;e.noteAreaShowFlag()?(null===(t=e.services)||void 0===t||null===(n=t.noteAreaManager)||void 0===n||n.setShow(),e.resistNoteAreaHeight=e.noteAreaHeight):(e.hideNote(),e.resistNoteAreaHeight=S.u)})),m()(l()(e),"renderNoteDebounce",D()((function(){e.renderCanvasNote()}),200)),m()(l()(e),"fixNoteHeight",(function(t){var n=t,i=e.getWrapperHeight();return(n=Math.min(n,S.t,i-N))<S.v?n=S.r:n<S.u&&(n=S.u),n})),m()(l()(e),"judgeNoteAreaCanShow",(function(){return e.getWrapperHeight()>=N+S.u})),m()(l()(e),"setNoteAreaHeight",(function(t){e.noteAreaHeight=t,e.updateModel({noteAreaHeight:t},(function(){var t,n;null===(t=e.services)||void 0===t||null===(n=t.canvasService)||void 0===n||n.resize(null,null,{noteHeightChange:!1})}))})),m()(l()(e),"quickSettingUpdateRect",(function(){Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~service")]).then(n.bind(null,"7f21889145")).then((function(e){e.default.getInstance().updateAnchorRect()})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))})),m()(l()(e),"reportNoteSize",(function(){var t,n,i,r,a=0,o=null===(t=e.services)||void 0===t||null===(n=t.selectionService)||void 0===n?void 0:n.slides.length;null===(i=e.services)||void 0===i||null===(r=i.selectionService)||void 0===r||r.slides.forEach((function(e){var t,n,i=Object(M.b)(null===(t=e.noteData)||void 0===t||null===(n=t.noteTextBody)||void 0===n?void 0:n.paragraphList);a=Math.max(a,i)})),Object(k.tdw)({module:x.d.SLIDE_PC_NOTE,action:x.b.SLIDE_NOTE_SIZE,ver6:a,ver7:o})})),e.noteAreaHeight=S.s,e.resistNoteAreaHeight=S.s,e}return o()(i,[{key:"componentDidMount",value:function(){var e,t,n=this;this.renderCanvasNote(),d()(g()(i.prototype),"componentDidMount",this).call(this),null===(e=this.viewDelegate)||void 0===e||e.disposeOnUnmount(Object(y.r)((function(){var e,t;return null===(e=n.services)||void 0===e||null===(t=e.noteAreaManager)||void 0===t?void 0:t.show}),(function(e){if(e){if(n.noteAreaShowFlag())return;var t,i,r,a;if(!n.judgeNoteAreaCanShow())null===(t=n.services)||void 0===t||null===(i=t.tipsManager)||void 0===i||i.showMsg(w.a.t("请拉高页面后，再查看备注。")),null===(r=n.services)||void 0===r||null===(a=r.noteAreaManager)||void 0===a||a.setHide();var o=n.fixNoteHeight(n.resistNoteAreaHeight);n.setNoteAreaHeight(o)}else{if(!n.noteAreaShowFlag())return;n.setNoteAreaHeight(S.r),n.hideNote()}n.quickSettingUpdateRect()}))),null===(t=this.viewDelegate)||void 0===t||t.disposeOnUnmount(Object(y.r)((function(){var e,t;return null===(e=n.services)||void 0===e||null===(t=e.selectionService)||void 0===t?void 0:t.currentSlide}),(function(){n.updateModel({})}))),this.reportNoteSize()}},{key:"componentDidUpdate",value:function(){this.renderNoteDebounce()}},{key:"createViewModel",value:function(){return new I}},{key:"renderCanvasNote",value:function(){var e=this;if(this.noteCanvasRef){var t,n,i,r,a,o=(null===(t=this.noteContainerRef)||void 0===t||null===(n=t.getBoundingClientRect)||void 0===n||null===(i=n.call(t))||void 0===i?void 0:i.width)||0;if(this.noteLayer)this.noteLayer.updateWithData(o,this.model.noteAreaHeight);else this.noteLayer=new R.a({canvasElement:this.noteCanvasRef,width:o,height:this.model.noteAreaHeight,topBlankDiv:this.noteTopDivRef,bottomBlankDiv:this.noteBottomDivRef,getDisplayStatus:function(){var t,n;return!(null!==(t=e.services)&&void 0!==t&&null!==(n=t.playManager)&&void 0!==n&&n.isPlaying)},uncommonFontLogic:null===(r=this.services)||void 0===r||null===(a=r.fontManager)||void 0===a?void 0:a.uncommonFontLogic})}}},{key:"getWrapperHeight",value:function(){var e,t,n;return null!==(e=null===(t=this.services)||void 0===t||null===(n=t.canvasService)||void 0===n?void 0:n.getCanvasSizeHandler().getWrapperHeightAndWidth().offsetHeight)&&void 0!==e?e:0}}]),i}(P.a)},fc356a1fd0:function(e,t){e.exports="//docs.gtimg.com/slide/img/slide/application/service/mobile-remote-control-dropdown/core/qrcode-mask/login-bg-applet-8c67de.png"}}]);
//# sourceMappingURL=slide-async~f19eb79b-d2a570.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([["async~95108331"],{"01f4863914":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".theme-preview-example-theme-preview-example-container-YrIxN{border-radius:4px;border:1px solid rgba(0,0,0,.12);width:210px;height:378px}.theme-preview-example-theme-preview-example-image-wrapper-sTgVZ{width:208px;height:188px;position:relative;padding:10px 53px 18px;display:flex;flex-direction:column;justify-content:space-between}.theme-preview-example-theme-preview-example-text-3fN3H{height:24px;width:100%;font-family:PingFang SC;font-size:18px;font-style:normal;font-weight:600;line-height:24px;text-align:center}.theme-preview-example-theme-preview-example-shape-2mGH2{height:44px;width:100%;position:relative}.theme-preview-example-theme-preview-example-accent-wrapper-17odC{height:60px;width:100%;position:relative;display:flex;align-items:flex-end}.theme-preview-example-theme-preview-example-accent-1cqgp{width:17px;position:relative}.theme-preview-example-theme-preview-example-shape-circle-2UydU{width:44px;height:44px;border-radius:50%;position:absolute;left:0;z-index:2}.theme-preview-example-theme-preview-example-shape-rect-17ufk{width:64px;height:44px;position:absolute;right:0;z-index:1}",""]),t.locals={"theme-preview-example-container":"theme-preview-example-theme-preview-example-container-YrIxN","theme-preview-example-image-wrapper":"theme-preview-example-theme-preview-example-image-wrapper-sTgVZ","theme-preview-example-text":"theme-preview-example-theme-preview-example-text-3fN3H","theme-preview-example-shape":"theme-preview-example-theme-preview-example-shape-2mGH2","theme-preview-example-accent-wrapper":"theme-preview-example-theme-preview-example-accent-wrapper-17odC","theme-preview-example-accent":"theme-preview-example-theme-preview-example-accent-1cqgp","theme-preview-example-shape-circle":"theme-preview-example-theme-preview-example-shape-circle-2UydU","theme-preview-example-shape-rect":"theme-preview-example-theme-preview-example-shape-rect-17ufk"}},"024406998c":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".start-rating-1n4YL{display:flex;overflow:hidden;background-color:hsla(0,0%,100%,.08);flex-direction:column;order:5;z-index:20}.start-rating-1n4YL .start-rating-header-23aNM{display:flex;align-items:center;height:56px;padding:17px 16px}.start-rating-1n4YL .start-rating-header-23aNM .start-rating-header-title-2xvNq{color:rgba(0,0,0,.88);font-family:PingFang SC;font-size:16px;font-style:normal;font-weight:600;line-height:22px;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;flex:1 1}.start-rating-1n4YL .start-rating-header-23aNM .start-rating-header-close-1VYg_{width:20px;height:20px;padding:4px;-webkit-user-drag:none}.start-rating-1n4YL .start-rating-header-23aNM .start-rating-header-close-1VYg_:hover{background:#f5f5f5}.start-rating-1n4YL .start-rating-content-wrapper-3Aw15{margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}.start-rating-1n4YL .start-blank-search-2N_Vf{width:240px;height:240px;margin-left:10px}.start-rating-1n4YL .start-rating-content-title-1LeIr{position:relative;margin-top:16px;color:rgba(0,0,0,.88);text-align:center;font-family:PingFang SC;font-size:16px;font-style:normal;font-weight:600;line-height:22px;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.start-rating-1n4YL .start-rating-text-row-1YPrU{position:relative;display:flex;margin-top:6px}.start-rating-1n4YL .start-rating-text-row-1YPrU .start-rating-text-img-1PSrh{margin-top:2px;width:16px;height:16px;margin-right:8px}.start-rating-1n4YL .start-rating-text-row-1YPrU .start-rating-name-3-Rc9{color:rgba(0,0,0,.88);font-family:PingFang SC;font-size:14px;font-style:normal;font-weight:400;line-height:20px;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.start-rating-1n4YL .start-rating-confirm-3AOow{position:relative;margin-top:31px;width:120px}",""]),t.locals={rating:"start-rating-1n4YL","rating-header":"start-rating-header-23aNM","rating-header-title":"start-rating-header-title-2xvNq","rating-header-close":"start-rating-header-close-1VYg_","rating-content-wrapper":"start-rating-content-wrapper-3Aw15","blank-search":"start-blank-search-2N_Vf","rating-content-title":"start-rating-content-title-1LeIr","rating-text-row":"start-rating-text-row-1YPrU","rating-text-img":"start-rating-text-img-1PSrh","rating-name":"start-rating-name-3-Rc9","rating-confirm":"start-rating-confirm-3AOow"}},"094f7a70d5":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36");var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),l=n("85d0a7609b"),c=n.n(l),s=n("3ef2352f0b"),u=n.n(s),d=(n("c6244f7705"),n("081c8cafea"),n("8ee19818c4"),n("b1e2246d82"),n("8a35b54c1d"),n("6e20b6a7d8"),n("4bbb5840d5"),n("8ed98eb6ea")),p=n("f2b6d66c40"),h=n("99f931ad4f"),f=n("86753a9dc2"),m=n("f57c18cbbf"),v=n("a7888a8b87"),g=n.n(v);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function e(){var t=this;o()(this,e),c()(this,"topicList",[]),c()(this,"detailList",[]),c()(this,"services",void 0),c()(this,"checkTemplateWithStandard",function(){var e=i()(u.a.mark((function e(n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},e.next=3,t.services.templateContentAnalyzer.promise().then(function(){var e=i()(u.a.mark((function e(i){var a,o,l,c,s,d,p,h,f,m,v;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.services.templateFormatService,e.next=3,i.createTemplateUiDataService(n);case 3:return o=e.sent,l=o.presentation,e.next=7,i.analyzerNonStandardTemplate({templatePresentation:l});case 7:c=e.sent,s=t.checkTemplateHasCover(c),d=t.checkTemplateHasCtrTitleInCover(c),p=t.checkHasCtrPlaceholderTitleInCover(c),h=t.checkIsSingleMaster(o),f=t.checkIsSingleTheme(o),m=a.checkTemplateTheme(l.themeList[0]),v=i.getPresentationColorInfo(l),r.hasCover=s,r.hasCtrTitleInCover=d,r.hasCtrPlaceholderTitleInCover=p,r.hasCustomThemeColor=!m,r.isSingleMaster=h,r.isSingleTheme=f,r.hasMatchingTheme=v.themeColorNumber>=v.customColorNumber,r.hasMatchingTheme=v.themeColorNumber>=v.customColorNumber,r.hasBaseBackground=t.checkHasTemplateBackground(c);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c()(this,"setDelegate",(function(e){t.services=e})),c()(this,"checkIsSingleTheme",(function(e){return 1===e.presentation.themeList.length})),c()(this,"checkIsSingleMaster",(function(e){return 1===(e.masterModelList.length||0)})),c()(this,"checkHasTemplateBackground",(function(e){var t,n,r,i=e.templateContentBackResult,a=i.fillBackground,o=i.firstElement,l=i.secondElement,c=i.thirdElement,s=!(null==a||!a.solidFill||"#ffffff"===(null===(t=a.solidFill.color)||void 0===t?void 0:t.srgb_color)),u=((null==a||null===(n=a.gradFill)||void 0===n||null===(r=n.gsList)||void 0===r?void 0:r.length)||0)>=2,d=!(null==a||!a.image);return s||!!o||!!l||!!c||u||d})),c()(this,"checkTemplateHasCover",(function(e){return!!e.templateCoverResult})),c()(this,"checkTemplateHasCtrTitleInCover",(function(e){return!!e.templateCoverResult.ctrTitleLeaf})),c()(this,"checkHasCtrPlaceholderTitleInCover",(function(e){var t,n,r,i,a;return!(null===(t=e.templateCoverResult.ctrTitleLeaf)||void 0===t||null===(n=t.contentBlock.visualBlocks)||void 0===n||null===(r=n[0])||void 0===r||null===(i=r.info)||void 0===i||null===(a=i.element)||void 0===a||!a.isCtrTitlePl)})),c()(this,"checkTemplateHasContents",(function(e){return!!e.templateContentsResult})),c()(this,"checkTemplateHasSection",(function(e){return!!e.templateSectionResult})),c()(this,"checkTemplateHasCoverBack",(function(e){return!!e.templateBackCoverResult})),c()(this,"checkTemplateHasStandardLayout",(function(e){var t=e.templateContentBackResult.pageModel.parent,n=!1,r=!1,i=!1,a=!1;return t.layoutList.forEach((function(e){"标题幻灯片"===e.name&&(n=!0),"目录幻灯片"===e.name&&(r=!0),"节标题"===e.name&&(i=!0),"末尾幻灯片"===e.name&&(a=!0)})),{hasCoverLayout:n,hasContentsLayout:r,hasSectionLayout:i,hasCoverBackLayout:a}})),c()(this,"checkAllTemplate",i()(u.a.mark((function e(){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTopicList();case 2:return n=e.sent,e.next=5,t.getDetailList(n);case 5:return r=e.sent,a=[],e.next=9,r.forEach((function(e){e.items.forEach(function(){var e=i()(u.a.mark((function e(n){var r,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTemplatePresentationData(n.id);case 2:return r=e.sent,e.next=5,t.checkTemplateWithStandard(r);case 5:i=e.sent,a.push(y(y({},i),{},{id:n.id,name:n.name}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))),c()(this,"getTopicList",i()(u.a.mark((function e(){var n,r,i,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.topicList.length){e.next=2;break}return e.abrupt("return",t.topicList);case 2:return e.next=4,Object(d.c)();case 4:if(n=e.sent,null==(r=null==n?void 0:n[0])||!r.length){e.next=11;break}return(a=null===(i=r.filter)||void 0===i?void 0:i.call(r,(function(e){var t;return e.topicId&&(null===(t=e.style)||void 0===t?void 0:t.desc)}))).unshift({topicId:"",style:{desc:p.default.t("全部")}}),t.topicList=a,e.abrupt("return",a);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})))),c()(this,"getDetailList",function(){var e=i()(u.a.mark((function e(n){var r,i,a,o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.detailList.length){e.next=2;break}return e.abrupt("return",t.detailList);case 2:return i=(null==n||null===(r=n.filter)||void 0===r?void 0:r.call(n,(function(e){return!!e.topicId})))||[],a=i.map((function(e){return e.topicId})),e.next=6,Object(d.d)(a);case 6:return o=e.sent,l={},o.forEach((function(e){var n=e.items.filter((function(e){var n=e.id;if(l[n])return!1;if(h.a[n])return!1;var r=t.getCoverSrc(t.getValidMeta(e.metaOfEachType));return!(null==r||!r.startsWith("http"))&&(l[n]=!0,!0)}));e.items=n})),t.detailList=o,e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c()(this,"getTemplatePresentationData",function(){var e=i()(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.b)(t);case 2:return n=e.sent,(r=Object(m.a)(g()(n))).noteSlideMap={},e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c()(this,"getCoverSrc",(function(e){var t,n,r;return(null==e||null===(t=e.images)||void 0===t?void 0:t.pc_thumb_2x.url)||(null==e||null===(n=e.images)||void 0===n?void 0:n.pc_preview.url)||(null==e||null===(r=e.images)||void 0===r?void 0:r.mobile_thumb_2x.url)})),c()(this,"getValidMeta",(function(e){try{return e?JSON.parse(e):{}}catch(e){return window.log.error("getValidMeta err",e),{}}}))}},"0c4290554b":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01IDExSDdWMTNINVYxMVpNMTEgMTFIMTNWMTNIMTFWMTFaTTE5IDExSDE3VjEzSDE5VjExWiIgZmlsbD0iI0YwRjBGMCIvPgo8L3N2Zz4="},"137793e5df":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-transition-preview-WWSR1{position:relative}",""]),t.locals={"transition-preview":"index-transition-preview-WWSR1"}},"14f9f3f014":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".result-rating-result-title-pUGRC{color:rgba(0,0,0,.88);font-family:PingFang SC;font-size:16px;font-style:normal;font-weight:600;line-height:22px}.result-rating-result-title-description-1pjOe{margin-top:8px;color:rgba(0,0,0,.64);font-family:PingFang SC;font-size:14px;font-style:normal;font-weight:400;line-height:20px}.result-rating-result-item-img-true--_yUd{position:relative;top:0;width:16px;height:16px;margin:2px}.result-rating-result-item-img-false-2ecPQ{position:relative;top:2px;left:2px;width:12px;height:12px;margin:2px}.result-rating-result-item-title-8RXqP{color:rgba(0,0,0,.88);font-family:PingFang SC;font-size:14px;font-style:normal;font-weight:400;line-height:20px}.result-rating-result-item-description-7kRRY{top:4px;color:rgba(0,0,0,.48)}.result-rating-result-item-description-7kRRY,.result-rating-result-item-handle-3BwGf{position:relative;font-family:PingFang SC;font-size:12px;font-style:normal;font-weight:400;line-height:16px}.result-rating-result-item-handle-3BwGf{background-color:transparent;border:transparent;top:6px;color:#175ceb}.result-rating-result-list-item-description-3LXqw{position:relative;color:rgba(0,0,0,.8);font-family:PingFang SC;font-size:12px;font-style:normal;font-weight:400;line-height:18px}.result-rating-result-list-item-description-3LXqw:hover{background-color:rgba(51,77,102,.06)}.result-rating-result-list-item-handle-QZdJi{position:relative;margin-left:5px;background-color:transparent;border:transparent;color:#175ceb;font-family:PingFang SC;font-size:12px;font-style:normal;font-weight:400;line-height:16px}",""]),t.locals={"rating-result-title":"result-rating-result-title-pUGRC","rating-result-title-description":"result-rating-result-title-description-1pjOe","rating-result-item-img-true":"result-rating-result-item-img-true--_yUd","rating-result-item-img-false":"result-rating-result-item-img-false-2ecPQ","rating-result-item-title":"result-rating-result-item-title-8RXqP","rating-result-item-description":"result-rating-result-item-description-7kRRY","rating-result-item-handle":"result-rating-result-item-handle-3BwGf","rating-result-list-item-description":"result-rating-result-list-item-description-3LXqw","rating-result-list-item-handle":"result-rating-result-list-item-handle-QZdJi"}},"1a00d79b5b":function(e,t,n){"use strict";var r=n("69084d01d3"),i=n.n(r),a=n("e792a3169a"),o=n.n(a),l=n("a076190a61"),c=n.n(l),s={insert:"head",singleton:!1},u=(o()(c.a,s),c.a.locals||{}),d=n("d0ab5c54b5"),p=n.n(d),h=n("77fdbf9d0f"),f=n.n(h);t.a=function(e){var t=e.title,n=e.onBack,r=e.onClose,a=e.showBack;return i.a.createElement("div",{className:u.header},i.a.createElement("button",{className:u["icon-button"],onClick:a?n:void 0},a&&i.a.createElement("img",{src:p.a})),i.a.createElement("h1",{className:u.title},t),i.a.createElement("button",{className:u["icon-button"],onClick:r},i.a.createElement("img",{src:f.a})))}},"1d76b2769d":function(e,t){e.exports="//docs.gtimg.com/slide/img/slide/application/service/slide-rating-and-improve/view/mobile/start/mobile-blank-search-530529.svg"},"22616d8256":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var r=n("c92b994f13"),i=r(n("7dcfb5f141")),a=r(n("0f2367b803")),o=r(n("8c8260e27c"));t.push([e.i,'@-webkit-keyframes replace-image-dialog-loading-rotate-1WSDc{0%{rotate:0}to{rotate:1turn}}@keyframes replace-image-dialog-loading-rotate-1WSDc{0%{rotate:0}to{rotate:1turn}}.replace-image-dialog-dialog-content-2MCGG{display:flex;justify-content:space-between;margin-bottom:54px}.replace-image-dialog-content-subtitle-Z-lLU{position:relative;width:91.42%;padding:4px 0;margin:24px 0 8px;text-align:center;font-size:14px;line-height:20px;color:rgba(0,0,0,.64);font-weight:600}.replace-image-dialog-content-left-3Nfr0{width:50%;padding:0 12px 0 0;display:flex;flex-direction:column;align-items:end}.replace-image-dialog-current-image-container-2-yDC{position:relative;width:91.42%;height:0;padding-top:56.4%;margin:6px 0 12px;border-radius:4px;overflow:hidden;outline:1px solid rgba(0,0,0,.08)}.replace-image-dialog-current-image-3w8M1{object-fit:cover}.replace-image-dialog-current-image-3w8M1,.replace-image-dialog-current-image-loading-1OFNh{position:absolute;top:0;width:100%;height:100%}.replace-image-dialog-current-image-loading-1OFNh{background-color:rgba(0,0,0,.16)}.replace-image-dialog-current-image-loading-1OFNh:after{content:"";position:absolute;top:calc(50% - 16px);left:calc(50% - 16px);width:32px;height:32px;border:2px solid #cdcdb1;border-top-color:#979797;border-radius:32px;box-sizing:border-box;-webkit-animation-name:replace-image-dialog-loading-rotate-1WSDc;animation-name:replace-image-dialog-loading-rotate-1WSDc;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-duration:.8s;animation-duration:.8s;-webkit-animation-timing-function:linear;animation-timing-function:linear}.replace-image-dialog-arrow-icon-_vQ92{background-color:rgba(0,0,0,.12);width:24px;height:24px;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);border-radius:2px;cursor:pointer}.replace-image-dialog-arrow-icon-svg-2ekSt{width:100%;-webkit-filter:brightness(10);filter:brightness(10)}.replace-image-dialog-arrow-icon-before-1NTSa{left:8px}.replace-image-dialog-arrow-icon-after-2vVBj,.replace-image-dialog-arrow-icon-before-1NTSa{position:absolute;top:calc(50% - 12px)}.replace-image-dialog-arrow-icon-after-2vVBj{rotate:180deg;right:8px}.replace-image-dialog-content-right-1Plpq{width:50%;padding:0 0 0 6px;display:flex;flex-direction:column;align-items:flex-start;overflow-y:scroll}.replace-image-dialog-info-icon-33r0J{background:url('+i+");background-size:contain;width:20px;height:20px}.replace-image-dialog-refresh-3oXGW{display:flex;position:absolute;right:0;top:0;padding:4px;cursor:pointer}.replace-image-dialog-refresh-3oXGW:hover{background-color:rgba(51,77,102,.06)}.replace-image-dialog-refresh-icon-17ae5{background:url("+a+');background-size:contain;width:20px;height:20px}.replace-image-dialog-list-images-2Cs3V{width:100%;display:flex;flex-wrap:wrap;justify-content:flex-start}.replace-image-dialog-list-images-item-container-xonzZ{position:relative;width:28.6%;padding-top:17.3%;height:0;margin:6px;border-radius:4px;overflow:hidden;cursor:pointer;outline:1px solid rgba(0,0,0,.08)}.replace-image-dialog-list-images-container-active-102As{outline:1px solid #1e6fff}.replace-image-dialog-list-images-container-active-102As:after{content:"";position:absolute;top:4px;right:4px;width:16px;height:16px;background-image:url('+o+");background-position:50%;border:none;border-radius:8px;overflow:hidden;z-index:1}.replace-image-dialog-current-image-pointer-3uEwA{position:absolute;bottom:1px;right:1px;opacity:0;transition:all .3s}.replace-image-dialog-list-images-item-container-xonzZ:hover .replace-image-dialog-current-image-pointer-3uEwA{opacity:1}.replace-image-dialog-list-images-item-2PE15{position:absolute;top:0;width:100%;height:100%;object-fit:cover;pointer-events:none}",""]),t.locals={"dialog-content":"replace-image-dialog-dialog-content-2MCGG","content-subtitle":"replace-image-dialog-content-subtitle-Z-lLU","content-left":"replace-image-dialog-content-left-3Nfr0","current-image-container":"replace-image-dialog-current-image-container-2-yDC","current-image":"replace-image-dialog-current-image-3w8M1","current-image-loading":"replace-image-dialog-current-image-loading-1OFNh","loading-rotate":"replace-image-dialog-loading-rotate-1WSDc","arrow-icon":"replace-image-dialog-arrow-icon-_vQ92","arrow-icon-svg":"replace-image-dialog-arrow-icon-svg-2ekSt","arrow-icon-before":"replace-image-dialog-arrow-icon-before-1NTSa","arrow-icon-after":"replace-image-dialog-arrow-icon-after-2vVBj","content-right":"replace-image-dialog-content-right-1Plpq","info-icon":"replace-image-dialog-info-icon-33r0J",refresh:"replace-image-dialog-refresh-3oXGW","refresh-icon":"replace-image-dialog-refresh-icon-17ae5","list-images":"replace-image-dialog-list-images-2Cs3V","list-images-item-container":"replace-image-dialog-list-images-item-container-xonzZ","list-images-container-active":"replace-image-dialog-list-images-container-active-102As","current-image-pointer":"replace-image-dialog-current-image-pointer-3uEwA","list-images-item":"replace-image-dialog-list-images-item-2PE15"}},"27c9dbeb2e":function(e,t,n){"use strict";n.r(t);n("73b854064b");var r,i,a,o=n("176815363d"),l=n.n(o),c=n("9132715560"),s=n.n(c),u=n("6a364eb35c"),d=n.n(u),p=n("547611bd96"),h=n.n(p),f=n("bd29e2df90"),m=n.n(f),v=n("ab5eb40518"),g=n.n(v),b=n("1b4cdd6a36"),y=n.n(b),x=n("85d0a7609b"),w=n.n(x),S=n("3ef2352f0b"),k=n.n(S),C=(n("c6244f7705"),n("081c8cafea"),n("69084d01d3")),E=n.n(C),I=n("f881ae5df0"),T=n("5a5c6d313d");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var M=(r=Reflect.metadata("design:type",Function),i=Reflect.metadata("design:paramtypes",["undefined"==typeof WatermarkMaskProps?Object:WatermarkMaskProps,Object]),Object(T.b)(a=r(a=i(a=function(e){m()(r,e);var t,n=R(r);function r(e,t){var i;return s()(this,r),i=n.call(this,e,t),w()(h()(i),"watermarkManager",void 0),w()(h()(i),"playerSVGInfo",void 0),i.playerSVGInfo=null,i}return d()(r,[{key:"componentDidMount",value:(t=l()(k.a.mark((function e(){var t,n=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,this.watermarkManager=this.props.watermarkManager,void 0===this.props.isUseStaticData){e.next=6;break}this.watermarkManager.getPlayerSVGInfo().then((function(e){n.playerSVGInfo=e,t.forceUpdate()})),e.next=8;break;case 6:return e.next=8,this.watermarkManager.generateWatermarkSVG();case 8:this.forceUpdate();case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e,t=I.WatermarkGenerate;if(void 0!==this.props.isUseStaticData)return this.playerSVGInfo?E.a.createElement(t,{key:"player-tdocs-watermark-generate",base64Data:this.playerSVGInfo.base64Data,base64NickData:this.playerSVGInfo.base64NickData,canvasHeight:this.playerSVGInfo.canvasHeight,lineHeight:this.playerSVGInfo.lineHeight}):null;var n=null===(e=this.watermarkManager)||void 0===e?void 0:e.watermarkSVGInfo;return null!=n?E.a.createElement(t,{key:"tdocs-watermark-generate",base64Data:n.base64Data,base64NickData:n.base64NickData,canvasHeight:n.canvasHeight,lineHeight:n.lineHeight}):null}}]),r}(C.Component))||a)||a)||a);t.default=M},"2d2aae0381":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNi4yMjQyIDQuOTU2OTVMMTcuOTkyIDYuNzI0NzJMOS43NDM0NiAxNC45NzI3TDkuNzQ0OTMgMTQuOTc0MUw5LjM5MDU2IDE1LjMyNTVMNy45NzQyOCAxNi43NDE3TDcuOTY4MzkgMTYuNzM1OEw3Ljk2ODM3IDE2LjczNThMMi4wODMyNSAxMC44NTA3TDMuODUyMzcgOS4wODE1N0w3Ljk3NTk5IDEzLjIwNTJMMTYuMjI0MiA0Ljk1Njk1WiIgZmlsbD0iIzFFNkZGRiIgc3R5bGU9ImZpbGw6IzFFNkZGRjtmaWxsOmNvbG9yKGRpc3BsYXktcDMgMC4xMTc2IDAuNDM1MyAxLjAwMDApO2ZpbGwtb3BhY2l0eToxOyIvPgo8L3N2Zz4K"},"2dc6fb6ec4":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".slide-swiper-swiper-container-3x6kj{height:100%;position:relative;max-width:100%;overflow:hidden}.slide-swiper-swiper-wrapper-3Jjlk{transition:-webkit-transform .5s ease-in-out;transition:transform .5s ease-in-out;transition:transform .5s ease-in-out,-webkit-transform .5s ease-in-out}.slide-swiper-swiper-wrapper-3Jjlk,.slide-swiper-swiper-wrapper-overlay-38-WM{height:100%;display:grid;grid-gap:12px;gap:12px}.slide-swiper-swiper-wrapper-overlay-38-WM{position:absolute;left:0;top:0}.slide-swiper-swiper-wrapper-overlay-left-3N9cu{background:linear-gradient(270deg,hsla(0,0%,100%,.3) 0,#fff)}.slide-swiper-swiper-wrapper-overlay-right-1y2Z2{background:linear-gradient(90deg,hsla(0,0%,100%,.3) 0,#fff)}.slide-swiper-swiper-slide-3dB-K{height:100%;padding:1px;transition:opacity .5s ease-in-out;border:.85px solid rgba(0,0,0,.08);display:flex;justify-content:center;align-items:center}.slide-swiper-active-slide-1xPFC{opacity:1}.slide-swiper-next-slide-1qSLK,.slide-swiper-prev-slide-1rWee{opacity:.5}",""]),t.locals={"swiper-container":"slide-swiper-swiper-container-3x6kj","swiper-wrapper":"slide-swiper-swiper-wrapper-3Jjlk","swiper-wrapper-overlay":"slide-swiper-swiper-wrapper-overlay-38-WM","swiper-wrapper-overlay-left":"slide-swiper-swiper-wrapper-overlay-left-3N9cu","swiper-wrapper-overlay-right":"slide-swiper-swiper-wrapper-overlay-right-1y2Z2","swiper-slide":"slide-swiper-swiper-slide-3dB-K","active-slide":"slide-swiper-active-slide-1xPFC","next-slide":"slide-swiper-next-slide-1qSLK","prev-slide":"slide-swiper-prev-slide-1rWee"}},"33fe73feec":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".slide-size-config-dialog-slide-size-config-dialog-content-1WKAC{width:352px}.slide-size-config-dialog-slide-size-config-dialog-content-row-c5e_w{height:36px;line-height:36px;margin-bottom:16px;display:flex;justify-content:flex-start}.slide-size-config-dialog-slide-size-config-dialog-content-row-label-1oVE2{text-align:left;width:70px;margin-right:12px;height:36px;line-height:36px;font-family:PingFang SC,serif;font-size:14px;font-style:normal;font-weight:400;color:rgba(0,0,0,.48);flex-shrink:0}.slide-size-config-dialog-slide-size-config-dialog-content-row-form-3kE0X{width:262px}.slide-size-config-dialog-slide-size-config-dialog-content-row-form-3kE0X [class^=number-input_number-input]{height:36px;font-size:14px}.slide-size-config-dialog-slide-size-config-dialog-content-row-form-3kE0X [class^=number-input_number-input] [class^=number-input_number-input-buttons]{height:34px}.slide-size-config-dialog-slide-size-config-dialog-content-row-form-3kE0X [class^=number-input_number-input] [class^=number-input_number-input-buttons] [class^=number-input_down-button],.slide-size-config-dialog-slide-size-config-dialog-content-row-form-3kE0X [class^=number-input_number-input] [class^=number-input_number-input-buttons] [class^=number-input_up-button]{height:17px}",""]),t.locals={"slide-size-config-dialog-content":"slide-size-config-dialog-slide-size-config-dialog-content-1WKAC","slide-size-config-dialog-content-row":"slide-size-config-dialog-slide-size-config-dialog-content-row-c5e_w","slide-size-config-dialog-content-row-label":"slide-size-config-dialog-slide-size-config-dialog-content-row-label-1oVE2","slide-size-config-dialog-content-row-form":"slide-size-config-dialog-slide-size-config-dialog-content-row-form-3kE0X"}},"3a624849bf":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".tab-tab-container-2QiZP{display:flex;background-color:rgba(51,77,102,.08);border-radius:8px;margin:0 16px;overflow:hidden;padding:4px}.tab-tab-1jA90{flex:1 1;text-align:center;padding:4px 16px;cursor:pointer;font-family:PingFang SC;font-weight:600;font-size:14px;line-height:20px;color:rgba(0,0,0,.64)}.tab-tab-active-3vmPE{background-color:#fff;color:rgba(0,0,0,.88);border-radius:6px}",""]),t.locals={"tab-container":"tab-tab-container-2QiZP",tab:"tab-tab-1jA90","tab-active":"tab-tab-active-3vmPE"}},"3f4d6d8daf":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".theme-color-config-theme-color-config-container-3FHCd{width:200px;height:376px}.theme-color-config-theme-color-item-2GHAy{width:100%;height:24px;margin-bottom:8px;display:flex;justify-content:space-between}.theme-color-config-theme-color-item-label-3w2ts{color:rgba(0,0,0,.88);font-family:PingFang SC;font-size:12px;font-style:normal;font-weight:400;line-height:24px}",""]),t.locals={"theme-color-config-container":"theme-color-config-theme-color-config-container-3FHCd","theme-color-item":"theme-color-config-theme-color-item-2GHAy","theme-color-item-label":"theme-color-config-theme-color-item-label-3w2ts"}},"44cf80cf4d":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR"}(r||(r={}))},"49f87be925":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return he}));var r,i=n("176815363d"),a=n.n(i),o=n("730477bb20"),l=n.n(o),c=n("1f925d7f50"),s=n.n(c),u=n("9132715560"),d=n.n(u),p=n("85d0a7609b"),h=n.n(p),f=n("2dc700e1e6"),m=n.n(f),v=(n("f1054791f4"),n("3ef2352f0b")),g=n.n(v),b=(n("c6244f7705"),n("081c8cafea"),n("69084d01d3")),y=n.n(b),x=(n("73b854064b"),n("6a364eb35c")),w=n.n(x),S=n("547611bd96"),k=n.n(S),C=n("bd29e2df90"),E=n.n(C),I=n("ab5eb40518"),T=n.n(I),R=n("1b4cdd6a36"),M=n.n(R),O=(n("826dc923b3"),n("b4638a0243"),n("1bab7b5fb7"),n("34cd92f77a"),n("bd80bf2d0f"),n("52d461bc51")),N=n.n(O),L=n("cd2a2f393a"),z=n.n(L),j=n("d436b8c143"),P=n.n(j),D=n("5fac0349d3"),A=n("d5c3deb8c7"),B=n("e792a3169a"),F=n.n(B),H=n("33fe73feec"),W=n.n(H),U={insert:"head",singleton:!1},G=(F()(W.a,U),W.a.locals||{}),V=n("b4a31815a1"),Z=n("711a53c9fc"),_=33.87,Y=19.05,X=n("3344f1a2e7"),K=n("11246a1392"),J=n.n(K),Q=n("d3d31c86eb"),q=n("9da6335152");function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var i=M()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T()(this,n)}}!function(e){e[e.enlarge=0]="enlarge",e[e.shrink=1]="shrink",e[e.enlargeOrShrink=2]="enlargeOrShrink"}(r||(r={}));var ee=function(e){E()(n,e);var t=$(n);function n(e){var i;return d()(this,n),i=t.call(this,e),h()(k()(i),"reaction",void 0),h()(k()(i),"renderConfirmFooter",(function(){var e=i.getScaleType();return y.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:40}},y.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",width:"100%"}},e===r.enlargeOrShrink?y.a.createElement(b.Fragment,null,y.a.createElement(J.a,{style:{marginRight:16},type:"primary",onClick:function(){var e,t;i.handleEnlargeOrReduceCommit(!1),null===(e=(t=i.props).onSuccess)||void 0===e||e.call(t)}},D.a.t("缩小")),y.a.createElement(J.a,{onClick:function(){var e,t;i.handleEnlargeOrReduceCommit(!0),null===(e=(t=i.props).onSuccess)||void 0===e||e.call(t)}},D.a.t("放大"))):y.a.createElement(b.Fragment,null,y.a.createElement(J.a,{style:{marginRight:16},onClick:function(){var e,t;i.handleNoScale(),null===(e=(t=i.props).onSuccess)||void 0===e||e.call(t)}},D.a.t("不缩放")),y.a.createElement(J.a,{type:"primary",onClick:function(){var e,t;i.handleScaleCommit(),null===(e=(t=i.props).onSuccess)||void 0===e||e.call(t)}},D.a.t("缩放")))))})),h()(k()(i),"getScale",(function(){var e=i.props.uiDataService.presentation.props,t=e.slideWidth,n=e.slideHeight,r=Math.round(Object(X.n)(i.props.slideWidth)),a=Math.round(Object(X.n)(i.props.slideHeight)),o=r/Math.round(t),l=a/Math.round(n);return Math.abs(o-1)>Math.abs(l-1)?o:l})),h()(k()(i),"getEnlargeOrReduceScale",(function(e){var t=i.props.uiDataService.presentation.props,n=t.slideWidth,r=t.slideHeight,a=Math.round(Object(X.n)(i.props.slideWidth)),o=Math.round(Object(X.n)(i.props.slideHeight)),l=a/Math.round(n),c=o/Math.round(r);return e?Math.max(l,c):Math.min(l,c)})),h()(k()(i),"handleNoScale",(function(){var e=i.props.uiDataService.presentation,t=Object(X.k)(i.props.slideWidth),n=Object(X.k)(i.props.slideHeight);e.updateCustomSlideSizeWithNoScale(t,n,i.props.slideSizeType),i.props.slideSizeService.hideDialog(),i.report(t,n)})),h()(k()(i),"handleEnlargeOrReduceCommit",(function(e){var t=i.props.uiDataService.presentation,n=(i.getEnlargeOrReduceScale(e),Object(X.k)(i.props.slideWidth)),r=Object(X.k)(i.props.slideHeight);t.updateCustomSlideSizeWithEnlargeOrReduce(n,r,e,i.props.slideSizeType),i.props.slideSizeService.hideDialog(),i.report(n,r)})),h()(k()(i),"handleScaleCommit",(function(){var e=i.props.uiDataService.presentation,t=i.getScale(),n=Object(X.k)(i.props.slideWidth),r=Object(X.k)(i.props.slideHeight);e.updateCustomSlideSize(n,r,t,i.props.slideSizeType),i.props.slideSizeService.hideDialog(),i.report(n,r)})),h()(k()(i),"getScaleType",(function(){var e=i.props.uiDataService.presentation.props,t=e.slideWidth,n=e.slideHeight,a=Math.round(Object(X.n)(i.props.slideWidth)),o=Math.round(Object(X.n)(i.props.slideHeight));return a>=Math.round(t)&&o>=Math.round(n)?r.enlarge:a<=Math.round(t)&&o<=Math.round(n)?r.shrink:r.enlargeOrShrink})),h()(k()(i),"getConfirmText",(function(e){switch(e){case r.enlarge:return D.a.t("将转换为更大的幻灯片。是否放大内容");case r.shrink:return D.a.t("将转换为更小的幻灯片。是否缩小内容");default:return D.a.t("是否放大或缩小内容")}})),h()(k()(i),"initReaction",(function(){i.reaction=Object(A.r)((function(){return i.props.slideSizeService.confirmVisible}),(function(e){i.setState({visible:e})}))})),h()(k()(i),"report",(function(e,t){Object(Q.c)({opername:q.e.DOC_PPT,module:q.d.BEAUTIFY_TAB,action:q.b.BEAUTIFY_SLIDE_CUSTOM_SIZE,ver5:e/t})})),i.state={visible:i.props.slideSizeService.confirmVisible},i.initReaction(),i}return w()(n,[{key:"componentWillUnmount",value:function(){var e;null===(e=this.reaction)||void 0===e||e.call(this)}},{key:"render",value:function(){var e=this;return y.a.createElement(N.a,{zIndex:9999,visible:this.state.visible,title:D.a.t("确认"),onCancel:function(){var t,n;e.props.slideSizeService.confirmVisible=!1,null===(t=(n=e.props).onCancel)||void 0===t||t.call(n)},footer:this.renderConfirmFooter()},this.getConfirmText(this.getScaleType()))}}]),n}(y.a.PureComponent);function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M()(e);if(t){var i=M()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T()(this,n)}}var ne,re,ie=3,ae=130,oe=.1;!function(e){e[e.enlarge=0]="enlarge",e[e.shrink=1]="shrink",e[e.enlargeOrShrink=2]="enlargeOrShrink"}(ne||(ne={})),function(e){e.horz="1",e.vert="2"}(re||(re={}));var le,ce,se,ue=function(e){E()(n,e);var t=te(n);function n(e){var r;d()(this,n),r=t.call(this,e),h()(k()(r),"reaction",void 0),h()(k()(r),"handleDirectionClick",(function(e,t){var n,i,a=Math.max(r.state.slideWidth,r.state.slideHeight),o=Math.min(r.state.slideWidth,r.state.slideHeight);t===re.horz?(n=a,i=o):(n=o,i=a),r.setState({direction:t,slideWidth:n,slideHeight:i})})),h()(k()(r),"handleSizeChangeOnDirection",(function(e,t){e>=t?r.setState({direction:re.horz}):r.setState({direction:re.vert})})),h()(k()(r),"handleWidthChange",(function(e){""===e&&(e="0");var t=Number(Number(e.replace(D.a.t("厘米"),"")).toFixed(2));t>ae&&(t=ae),t<ie&&(t=ie),r.handleSizeChangeOnDirection(t,r.state.slideHeight),r.setState({slideWidth:t,slideSizeType:Z.jb.custom})})),h()(k()(r),"handleHeightChange",(function(e){""===e&&(e="0");var t=Number(Number(e.replace(D.a.t("厘米"),"")).toFixed(2));t>ae&&(t=ae),t<ie&&(t=ie),r.handleSizeChangeOnDirection(r.state.slideWidth,t),r.setState({slideHeight:t,slideSizeType:Z.jb.custom})})),h()(k()(r),"handleScaleChange",(function(e){switch(e){case Z.jb.screen4x3:r.setState({slideWidth:25.4,slideHeight:19.05,slideSizeType:Z.jb.screen4x3,direction:re.horz});break;case Z.jb.screen16x9:r.setState({slideWidth:_,slideHeight:Y,slideSizeType:Z.jb.screen16x9,direction:re.horz});break;case Z.jb.custom:r.setState({slideSizeType:Z.jb.custom})}})),h()(k()(r),"handleOk",(function(e){if(e){var t=r.props.uiDataService.presentation.props,n=t.slideWidth,i=t.slideHeight,a=Math.round(Object(X.n)(r.state.slideWidth)),o=Math.round(Object(X.n)(r.state.slideHeight));a!==Math.round(n)||o!==Math.round(i)?r.props.slideSizeService.confirmVisible=!0:r.props.slideSizeService.hideDialog()}})),h()(k()(r),"initReaction",(function(){r.reaction=Object(A.r)((function(){return r.props.slideSizeService.dialogVisible}),(function(e){r.setState({visible:e})}))}));var i=r.props.uiDataService.presentation.props,a=i.slideWidth,o=i.slideHeight,l=i.type;return r.state={visible:!0,slideSizeType:l||Z.jb.screen16x9,slideWidth:Object(X.o)(a),slideHeight:Object(X.o)(o),direction:a>=o?re.horz:re.vert},r.initReaction(),r}return w()(n,[{key:"componentWillUnmount",value:function(){var e;null===(e=this.reaction)||void 0===e||e.call(this)}},{key:"render",value:function(){var e=this;return y.a.createElement(N.a,{visible:this.props.slideSizeService.dialogVisible,onCancel:function(){e.props.slideSizeService.hideDialog()},onOk:this.handleOk,title:D.a.t("自定义比例")},y.a.createElement("div",{className:G["slide-size-config-dialog-content"]},y.a.createElement("div",{className:G["slide-size-config-dialog-content-row"]},y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-label"]},D.a.t("幻灯片大小")),y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-form"]},y.a.createElement(P.a,{onChange:this.handleScaleChange,value:this.state.slideSizeType,style:{width:240,height:36}},y.a.createElement(P.a.Option,{value:Z.jb.screen4x3},D.a.t("标准（4：3）")),y.a.createElement(P.a.Option,{value:Z.jb.screen16x9},D.a.t("宽屏（16：9）")),y.a.createElement(P.a.Option,{value:Z.jb.custom},D.a.t("自定义"))))),y.a.createElement("div",{className:G["slide-size-config-dialog-content-row"]},y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-label"]},D.a.t("宽度")),y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-form"]},y.a.createElement(V.g,{min:ie,max:ae,allowDecimal:!0,toFixed:2,value:this.state.slideWidth.toString(),step:oe,suffix:D.a.t("厘米"),style:{width:140},onChange:this.handleWidthChange}))),y.a.createElement("div",{className:G["slide-size-config-dialog-content-row"]},y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-label"]},D.a.t("高度")),y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-form"]},y.a.createElement(V.g,{min:ie,max:ae,allowDecimal:!0,toFixed:2,value:this.state.slideHeight.toString(),step:oe,suffix:D.a.t("厘米"),style:{width:140},onChange:this.handleHeightChange}))),y.a.createElement("div",{className:G["slide-size-config-dialog-content-row"],style:{marginBottom:0}},y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-label"]},D.a.t("幻灯片方向")),y.a.createElement("div",{className:G["slide-size-config-dialog-content-row-form"]},y.a.createElement(z.a,{style:{margin:"4px 0",width:160},onClick:this.handleDirectionClick,activeId:this.state.direction},y.a.createElement(z.a.Segment,{id:re.horz},D.a.t("横向")),y.a.createElement(z.a.Segment,{id:re.vert},D.a.t("纵向")))))),y.a.createElement(ee,{uiDataService:this.props.uiDataService,slideSizeService:this.props.slideSizeService,slideWidth:this.state.slideWidth,slideHeight:this.state.slideHeight,slideSizeType:this.state.slideSizeType}))}}]),n}(y.a.PureComponent),de=n("2e0796c118"),pe=n.n(de),he=(le=function e(){var t=this;d()(this,e),s()(this,"dialogVisible",ce,this),s()(this,"confirmVisible",se,this),h()(this,"dialogContainer",document.createElement("div")),h()(this,"slideSizeServiceDelegate",void 0),h()(this,"setDelegate",(function(e){t.slideSizeServiceDelegate=e})),h()(this,"showSlideSizeDialog",(function(e){t.dialogVisible=!0,pe.a.render(y.a.createElement(ue,l()({},e,{slideSizeService:t,uiDataService:t.slideSizeServiceDelegate.uiDataService})),t.dialogContainer)})),h()(this,"showSlideSizeConfirmDialog",function(){var e=a()(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.confirmVisible=!0;var r=t.getDefaultSize(n),i=r.slideWidth,a=r.slideHeight,o=r.slideSizeType;pe.a.render(y.a.createElement(ee,{uiDataService:t.slideSizeServiceDelegate.uiDataService,slideSizeService:t,slideWidth:i,slideHeight:a,slideSizeType:o,onSuccess:function(){return e(!0)},onCancel:function(){return e(!1)}}),t.dialogContainer)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(this,"hideDialog",(function(){t.dialogVisible=!1,t.confirmVisible=!1,pe.a.unmountComponentAtNode(t.dialogContainer)})),h()(this,"getDefaultSize",(function(e){switch(e){case Z.jb.screen4x3:return{slideWidth:25.4,slideHeight:19.05,slideSizeType:Z.jb.screen4x3};case Z.jb.screen16x9:default:return{slideWidth:_,slideHeight:Y,slideSizeType:Z.jb.screen16x9}}}))},ce=m()(le.prototype,"dialogVisible",[A.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),se=m()(le.prototype,"confirmVisible",[A.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),le)},"4a5508af74":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return M}));n("73b854064b");var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),l=n("547611bd96"),c=n.n(l),s=n("bd29e2df90"),u=n.n(s),d=n("ab5eb40518"),p=n.n(d),h=n("1b4cdd6a36"),f=n.n(h),m=n("85d0a7609b"),v=n.n(m),g=n("69084d01d3"),b=n.n(g),y=n("c9d2ac2763"),x=n("e792a3169a"),w=n.n(x),S=n("c92b53bd0d"),k=n.n(S),C={insert:"head",singleton:!1},E=(w()(k.a,C),k.a.locals||{}),I=n("e0e8dd9366"),T=n("ec5cae33cb");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var M=function(e){u()(n,e);var t=R(n);function n(e){var r,a;return i()(this,n),a=t.call(this,e),v()(c()(a),"textRulerManager",void 0),v()(c()(a),"paragraphManager",void 0),v()(c()(a),"updateComponentWhenIsEditing",(function(){var e;(null===(e=a.textRulerManager)||void 0===e?void 0:e.editorInstanceService.checkEditorIsEditing())&&a.forceUpdate()})),a.textRulerManager=e.textRulerManager,a.paragraphManager=null===(r=e.textRulerManager)||void 0===r?void 0:r.paragraphManager,a}return o()(n,[{key:"componentDidMount",value:function(){var e,t=this;null===(e=this.textRulerManager)||void 0===e||e.componentDidMount({callback:function(){t.forceUpdate()}})}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.textRulerManager)||void 0===e||e.componentWillUnmount()}},{key:"render",value:function(){var e,t,n,r,i,a,o,l,c,s,u,d,p,h,f=this;this.resetRulerSize();var m=!(null===(e=this.textRulerManager)||void 0===e||!e.editorInstanceService.checkEditorIsEditing()),v=(null===(t=this.textRulerManager)||void 0===t?void 0:t.selectionService)||{},x=v.selectedElements,w=v.lastMouseDownRegion,S=null==x?void 0:x.getCurrentModel();S.type===I.d.CHART&&(m=!1),S.type!==I.d.NOTE&&w!==T.a.NOTE&&S.type!==I.d.EMPTY||(m=!1);var k=2*this.props.scale;return this.initAndFormatRulerSizeWithRealScale({slideLeft:this.props.slideLeft,slideWidth:this.props.slideWidth,slideTop:this.props.slideTop,slideHeight:this.props.slideHeight,scale:this.props.scale}),m&&this.computeEditingRulerSize(S,this.props.scale),(null===(n=this.textRulerManager)||void 0===n?void 0:n.displayRuler)&&b.a.createElement(g.Fragment,null,b.a.createElement("div",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},className:E.horizontalTextRulerContainer},b.a.createElement("div",{className:E.horizontalTextRulerInnerContainer,onDoubleClick:function(e){e.preventDefault(),e.stopPropagation()},style:{width:this.props.containerWidth}},b.a.createElement(y.a,{useGuide:!0,isRevert:this.textRulerManager.isRevert,showIndentControl:this.textRulerManager.isControlInHori,indentLeft:this.textRulerManager.indentLeft,marginLeft:this.textRulerManager.marginLeft,rulerWidth:this.textRulerManager.rulerWidth,rulerLeft:this.textRulerManager.rulerLeft,scale:k,isEditing:m,editingRenderLeft:this.textRulerManager.editAreaLeft,editingRenderWidth:this.textRulerManager.editAreaWidth,tabList:this.textRulerManager.tabList,defaultAlignment:null===(r=this.textRulerManager)||void 0===r?void 0:r.defaultAlignment,isOpenIndentRight:!1,isLimitEditArea:!0,minIndentSpace:1.5,defaultTabs:this.textRulerManager.defaultTabs,useTab:!0,onIndentLeftChangeEnd:null===(i=this.textRulerManager)||void 0===i?void 0:i.updateIndentLeft,onMarginLeftChangeEnd:null===(a=this.textRulerManager)||void 0===a?void 0:a.updateMarginLeft,onMarginLeftAndIndentLeftChangeEnd:null===(o=this.textRulerManager)||void 0===o?void 0:o.updateMarginLeftAndIndentLeft,onTabChangeEnd:null===(l=this.textRulerManager)||void 0===l?void 0:l.updateTabList,onTabDoubleClick:function(){var e;null===(e=f.paragraphManager)||void 0===e||e.showParagraph({isTabstopModalVisible:!0})},onIndentDoubleClick:function(){var e;return null===(e=f.paragraphManager)||void 0===e?void 0:e.showParagraph()}}))),b.a.createElement("div",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},className:E.verticalTextRulerContainer},b.a.createElement("div",{className:E.verticalTextRulerInnerContainer,onDoubleClick:function(e){e.preventDefault(),e.stopPropagation()},style:{height:this.props.containerHeight}},b.a.createElement(y.c,{useGuide:!0,isRevert:this.textRulerManager.isRevert,showIndentControl:!this.textRulerManager.isControlInHori,indentLeft:this.textRulerManager.indentLeft,marginLeft:this.textRulerManager.marginLeft,rulerHeight:this.textRulerManager.rulerHeight,rulerTop:this.textRulerManager.rulerTop,scale:k,isEditing:m,editingRenderTop:this.textRulerManager.editAreaTop,editingRenderHeight:this.textRulerManager.editAreaHeight,tabList:this.textRulerManager.tabList,defaultAlignment:null===(c=this.textRulerManager)||void 0===c?void 0:c.defaultAlignment,isOpenIndentRight:!1,isLimitEditArea:!0,minIndentSpace:1.5,defaultTabs:this.textRulerManager.defaultTabs,useTab:!0,onIndentLeftChangeEnd:null===(s=this.textRulerManager)||void 0===s?void 0:s.updateIndentLeft,onMarginLeftChangeEnd:null===(u=this.textRulerManager)||void 0===u?void 0:u.updateMarginLeft,onMarginLeftAndIndentLeftChangeEnd:null===(d=this.textRulerManager)||void 0===d?void 0:d.updateMarginLeftAndIndentLeft,onTabChangeEnd:null===(p=this.textRulerManager)||void 0===p?void 0:p.updateTabList,onTabDoubleClick:function(){var e;null===(e=f.paragraphManager)||void 0===e||e.showParagraph({isTabstopModalVisible:!0})},onIndentDoubleClick:function(){var e;return null===(e=f.paragraphManager)||void 0===e?void 0:e.showParagraph()}}))),b.a.createElement("div",{className:E.changeTabButtonContainer},b.a.createElement(y.b,{isEditing:m,onChangeDefaultTab:null===(h=this.textRulerManager)||void 0===h?void 0:h.updateDefaultAlignment})))}},{key:"computeEditingRulerSize",value:function(e,t){var n;null===(n=this.textRulerManager)||void 0===n||n.computeEditingRulerSize(e,t)}},{key:"initAndFormatRulerSizeWithRealScale",value:function(e){var t;null===(t=this.textRulerManager)||void 0===t||t.initAndFormatRulerSizeWithRealScale(e)}},{key:"resetRulerSize",value:function(){var e;null===(e=this.textRulerManager)||void 0===e||e.resetRulerSize()}}]),n}(b.a.Component)},"4a9af106b1":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".title-alignment-preview-tab-content-3e-yY{height:calc(100% - 36px);justify-content:space-between}.title-alignment-preview-slide-content-wrapper-2IlDy,.title-alignment-preview-tab-content-3e-yY{display:flex;flex-direction:column;align-items:center}.title-alignment-preview-slide-content-wrapper-2IlDy{width:100%;height:100%}.title-alignment-preview-slide-content-number-wrapper-1UmIR{margin-top:13px;width:100%;height:20px;display:flex;flex-direction:row;align-items:baseline;justify-content:center}.title-alignment-preview-slide-content-number-current-2dfxv{font-family:PingFang SC;font-size:14px;font-weight:600;line-height:20px;color:rgba(0,0,0,.88)}.title-alignment-preview-slide-content-number-total-295Zh{font-family:PingFang SC;font-size:10px;line-height:13px;font-weight:500;color:rgba(0,0,0,.88)}.title-alignment-preview-confirm-button-1JFUh{position:relative;margin-top:20px;font-size:17px;width:200px;height:44px}",""]),t.locals={"tab-content":"title-alignment-preview-tab-content-3e-yY","slide-content-wrapper":"title-alignment-preview-slide-content-wrapper-2IlDy","slide-content-number-wrapper":"title-alignment-preview-slide-content-number-wrapper-1UmIR","slide-content-number-current":"title-alignment-preview-slide-content-number-current-2dfxv","slide-content-number-total":"title-alignment-preview-slide-content-number-total-295Zh","confirm-button":"title-alignment-preview-confirm-button-1JFUh"}},"4e66cc7ee6":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".score-score-svg-ufGja{stroke-linecap:round;position:relative;width:84px;height:84px}.score-score-text-40Rr6{-webkit-transform-origin:50% 50%;transform-origin:50% 50%;dominant-baseline:middle;text-anchor:middle;font-family:DIN Alternate;text-align:center;font-size:36px;font-style:normal;font-weight:700;line-height:32px}@-webkit-keyframes score-play-score-3Q6LZ{0%{stroke-dasharray:0 282.6}}@keyframes score-play-score-3Q6LZ{0%{stroke-dasharray:0 282.6}}",""]),t.locals={"score-svg":"score-score-svg-ufGja","score-text":"score-score-text-40Rr6","play-score":"score-play-score-3Q6LZ"}},"51619f2820":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("85d0a7609b"),i=n.n(r),a=n("69084d01d3"),o=n.n(a),l=n("e792a3169a"),c=n.n(l),s=n("4e66cc7ee6"),u=n.n(s),d={insert:"head",singleton:!1},p=(c()(u.a,d),u.a.locals||{}),h=n("1748118723"),f=n.n(h),m=[{textColor:"#007A41",circleColor:"#A3F0D4"},{textColor:"#E07800",circleColor:"#FFF2A3"},{textColor:"#EB4825",circleColor:"#FFD7BF"}],v=function(e){var t=function(e){return e>=90?0:e>=60?1:2}(e.score),n=m[t];return o.a.createElement("svg",{className:f()(i()({},p["score-svg"],!0)),viewBox:"0 0 84 84"},o.a.createElement("circle",{r:"42",cx:"42",cy:"42",fill:n.circleColor}),o.a.createElement("text",{className:f()(i()({},p["score-text"],!0)),x:42,y:45,fill:n.textColor},e.score))}},"53df874fd3":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iNy41IiBmaWxsPSIjRkY0NzQ3IiBzdHlsZT0iZmlsbDojRkY0NzQ3O2ZpbGw6Y29sb3IoZGlzcGxheS1wMyAxLjAwMDAgMC4yNzg0IDAuMjc4NCk7ZmlsbC1vcGFjaXR5OjE7Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTMuMjUgNy40MTY2OUgxMC43NUwxMS4xNjY3IDEzLjI1SDEyLjgzMzNMMTMuMjUgNy40MTY2OVpNMTIgMTYuNTgzM0MxMi42OTA0IDE2LjU4MzMgMTMuMjUgMTYuMDIzNyAxMy4yNSAxNS4zMzMzQzEzLjI1IDE0LjY0MyAxMi42OTA0IDE0LjA4MzMgMTIgMTQuMDgzM0MxMS4zMDk2IDE0LjA4MzMgMTAuNzUgMTQuNjQzIDEwLjc1IDE1LjMzMzNDMTAuNzUgMTYuMDIzNyAxMS4zMDk2IDE2LjU4MzMgMTIgMTYuNTgzM1oiIGZpbGw9IndoaXRlIiBzdHlsZT0iZmlsbDp3aGl0ZTtmaWxsLW9wYWNpdHk6MTsiLz4KPC9zdmc+Cg=="},"5ce24c2660":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));n("73b854064b");var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),l=n("bd29e2df90"),c=n.n(l),s=n("ab5eb40518"),u=n.n(s),d=n("1b4cdd6a36"),p=n.n(d),h=n("c287259219"),f=n("32ac5459b8");function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var v=function(e){c()(n,e);var t=m(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"load",value:function(e,t){f.a.load(e,t)}}]),n}(h.a)},"61a7f1b6d3":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var r=n("c92b994f13")(n("28fda7dcd6"));t.push([e.i,".replace-card-container-8UX4_{width:100%;padding:12px 8px;background-color:#f3f5f7;cursor:move}.replace-card-message-OGCg-{margin:0 0 8px 4px}.replace-card-image-galley-1GE7h{display:flex;flex-wrap:wrap;cursor:default}.replace-card-card-image-2WeKC{position:relative;width:148px;height:148px;margin:4px;border-radius:4px;background-size:cover;background-position:50%;background-repeat:no-repeat;outline:1px solid rgba(0,0,0,.08);outline-offset:-1px;cursor:pointer}.replace-card-card-image-loading-3kUPe{background-size:24px 24px;background-image:url("+r+")}.replace-card-card-image-active-2CyDn{outline:2px solid #1e6fff;outline-offset:-2px}.replace-card-footer-GyZUV{justify-content:space-between;margin:8px 4px 0;cursor:default}.replace-card-footer-GyZUV,.replace-card-footer-GyZUV .replace-card-footer-right-1xbEw{display:flex}.replace-card-footer-GyZUV button{cursor:pointer}.replace-card-footer-GyZUV button:hover{-webkit-filter:brightness(.9);filter:brightness(.9)}.replace-card-footer-GyZUV .replace-card-ai-button-primary-1z-lV{background:linear-gradient(257deg,#db94ff,#5179ff 45.66%,#5ab0ff);color:#fff;border:0}.replace-card-footer-GyZUV .replace-card-ai-button-normal-3uIun{margin-right:8px;border:1px solid rgba(0,0,0,.08);background:#fff;color:rgba(0,0,0,.88)}.replace-card-footer-GyZUV .replace-card-ai-button-disabled-xDBvE{opacity:.24;cursor:none;pointer-events:none}",""]),t.locals={container:"replace-card-container-8UX4_",message:"replace-card-message-OGCg-","image-galley":"replace-card-image-galley-1GE7h","card-image":"replace-card-card-image-2WeKC","card-image-loading":"replace-card-card-image-loading-3kUPe","card-image-active":"replace-card-card-image-active-2CyDn",footer:"replace-card-footer-GyZUV","footer-right":"replace-card-footer-right-1xbEw","ai-button-primary":"replace-card-ai-button-primary-1z-lV","ai-button-normal":"replace-card-ai-button-normal-3uIun","ai-button-disabled":"replace-card-ai-button-disabled-xDBvE"}},"652fb74822":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,'@-webkit-keyframes replace-image-drawer-loading-rotate-3ipgM{0%{rotate:0}to{rotate:1turn}}@keyframes replace-image-drawer-loading-rotate-3ipgM{0%{rotate:0}to{rotate:1turn}}.replace-image-drawer-image-higher-2stRN{padding-top:83.33%}.replace-image-drawer-image-shorter-2fJ5L{padding-top:56.67%}.replace-image-drawer-drawer-mask-3Jz4R{height:100%}.replace-image-drawer-drawer-mask-processing-29z5C{cursor:wait}.replace-image-drawer-drawer-content-processing-1V2pm{pointer-events:none}.replace-image-drawer-drawer-content-22jhH{display:flex;flex-direction:column;height:100%}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-input-2HJuk{height:36px;margin:8px 16px 16px}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-galley-loading-3nJP_:after{content:"";position:absolute;top:calc(50% - 16px);left:calc(50% - 16px);width:32px;height:32px;border:2px solid #cdcdb1;border-top-color:#979797;border-radius:32px;box-sizing:border-box;-webkit-animation-name:replace-image-drawer-loading-rotate-3ipgM;animation-name:replace-image-drawer-loading-rotate-3ipgM;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-duration:.8s;animation-duration:.8s;-webkit-animation-timing-function:linear;animation-timing-function:linear}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly{display:flex;flex-grow:1;align-items:flex-start;position:relative;width:100%;overflow-y:scroll}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS:first-child{margin:0 4px 0 15px}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS:nth-child(2){margin:0 12px 0 4px}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS{display:flex;flex-direction:column;width:50%}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS .replace-image-drawer-drawer-image-Ha22x{position:relative;width:100%;height:0;margin:4px 0;flex-shrink:0;border-radius:4px;outline:1px solid rgba(0,0,0,.08);outline-offset:-1px;cursor:pointer;overflow:hidden}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS .replace-image-drawer-drawer-image-Ha22x img{position:absolute;top:0;width:100%;height:100%;object-fit:cover;vertical-align:bottom;pointer-events:none}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS .replace-image-drawer-drawer-image-Ha22x .replace-image-drawer-image-more-info-31Qzp{position:absolute;bottom:1px;right:1px;opacity:0;transition:all .3s}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS .replace-image-drawer-drawer-image-Ha22x:hover .replace-image-drawer-image-more-info-31Qzp{opacity:1}.replace-image-drawer-drawer-content-22jhH .replace-image-drawer-drawer-galley-Iqvly .replace-image-drawer-images-col-3HfpS .replace-image-drawer-drawer-image-active-HXcX9{outline:3px solid #1e6fff}.replace-image-drawer-drawer-confirm-3DIbx{flex-shrink:0;height:36px;margin:16px 16px 16px 15px}',""]),t.locals={"image-higher":"replace-image-drawer-image-higher-2stRN","image-shorter":"replace-image-drawer-image-shorter-2fJ5L","drawer-mask":"replace-image-drawer-drawer-mask-3Jz4R","drawer-mask-processing":"replace-image-drawer-drawer-mask-processing-29z5C","drawer-content-processing":"replace-image-drawer-drawer-content-processing-1V2pm","drawer-content":"replace-image-drawer-drawer-content-22jhH","drawer-input":"replace-image-drawer-drawer-input-2HJuk","galley-loading":"replace-image-drawer-galley-loading-3nJP_","loading-rotate":"replace-image-drawer-loading-rotate-3ipgM","drawer-galley":"replace-image-drawer-drawer-galley-Iqvly","images-col":"replace-image-drawer-images-col-3HfpS","drawer-image":"replace-image-drawer-drawer-image-Ha22x","image-more-info":"replace-image-drawer-image-more-info-31Qzp","drawer-image-active":"replace-image-drawer-drawer-image-active-HXcX9","drawer-confirm":"replace-image-drawer-drawer-confirm-3DIbx"}},"65eb29f3e3":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiBmaWxsPSJub25lIj4KICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuOTc5NCAzLjk2NTUzTDE0LjM5MzcgNS4zNzk3NEw3Ljc5NDgzIDExLjk3ODFMNy43OTYgMTEuOTc5M0w3LjUxMzMyIDEyLjI1OTZMNi4zNzk0OSAxMy4zOTMzTDYuMzc0NzcgMTMuMzg4Nkw2LjM3NDc1IDEzLjM4ODZMMS42NjY2NiA4LjY4MDUyTDMuMDgxOTYgNy4yNjUyMkw2LjM4MDg1IDEwLjU2NDFMMTIuOTc5NCAzLjk2NTUzWiIgZmlsbD0iIzBENjFGMiIgc3R5bGU9ImZpbGw6IzBENjFGMjtmaWxsOmNvbG9yKGRpc3BsYXktcDMgMC4wNTAwIDAuMzgwMCAwLjk1MDApO2ZpbGwtb3BhY2l0eToxOyIvPgo8L3N2Zz4K"},"699a7c7362":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".start-rating-MZ567{overflow:hidden;background-color:hsla(0,0%,100%,.08);flex-direction:column}.start-rating-MZ567 .start-rating-content-wrapper-mU3mz{height:100%;display:flex;flex-direction:column;align-items:center}.start-rating-MZ567 .start-rating-content-title-2Xrya{position:relative;color:rgba(0,0,0,.88);text-align:center;font-family:PingFang SC;font-size:16px;font-style:normal;font-weight:600;line-height:22px;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.start-rating-MZ567 .start-rating-text-wrapper-_Q6X5{display:flex;flex-direction:column;justify-content:center}.start-rating-MZ567 .start-rating-text-row-3GSsL{position:relative;display:flex;padding:6px 0}.start-rating-MZ567 .start-rating-text-row-3GSsL .start-rating-text-img-34GUo{width:20px;height:20px;margin-right:8px}.start-rating-MZ567 .start-rating-text-row-3GSsL .start-rating-name-3EOY-{color:rgba(0,0,0,.64);font-family:PingFang SC;font-size:16px;font-style:normal;font-weight:400;line-height:22px;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.start-rating-MZ567 .start-rating-confirm-3UWUK{position:relative;font-size:17px;width:200px;height:44px}",""]),t.locals={rating:"start-rating-MZ567","rating-content-wrapper":"start-rating-content-wrapper-mU3mz","rating-content-title":"start-rating-content-title-2Xrya","rating-text-wrapper":"start-rating-text-wrapper-_Q6X5","rating-text-row":"start-rating-text-row-3GSsL","rating-text-img":"start-rating-text-img-34GUo","rating-name":"start-rating-name-3EOY-","rating-confirm":"start-rating-confirm-3UWUK"}},"69a59851de":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".theme-item-theme-item-wrapper-1aUR8{width:100%;height:40px;margin-bottom:12px}.theme-item-theme-item-title-1GEi_{width:100%;height:16px;line-height:16px;margin-bottom:4px;font-weight:400;font-size:12px;display:flex;align-items:center}.theme-item-theme-item-color-group-7XDVL{width:181px;height:20px;display:flex;justify-content:space-between;position:relative}.theme-item-color-item-wrapper-3II5t{width:20px;height:20px;border:.5px solid rgba(0,0,0,.08);box-sizing:border-box}.theme-item-theme-item-color-selected-2UGse{border:2px solid #1e6fff;border-radius:2px}.theme-item-theme-item-color-hover-LiozS,.theme-item-theme-item-color-selected-2UGse{position:absolute;box-sizing:border-box;width:189px;height:28px;top:-4px;left:-4px}.theme-item-theme-item-color-hover-LiozS{border-radius:2px;opacity:.4}:hover.theme-item-theme-item-color-hover-LiozS{background:rgba(51,77,102,.18)}",""]),t.locals={"theme-item-wrapper":"theme-item-theme-item-wrapper-1aUR8","theme-item-title":"theme-item-theme-item-title-1GEi_","theme-item-color-group":"theme-item-theme-item-color-group-7XDVL","color-item-wrapper":"theme-item-color-item-wrapper-3II5t","theme-item-color-selected":"theme-item-theme-item-color-selected-2UGse","theme-item-color-hover":"theme-item-theme-item-color-hover-LiozS"}},"74b3712a62":function(e,t,n){"use strict";n.d(t,"a",(function(){return ve}));n("73b854064b");var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),l=n("bd29e2df90"),c=n.n(l),s=n("ab5eb40518"),u=n.n(s),d=n("1b4cdd6a36"),p=n.n(d),h=(n("8ee19818c4"),n("6e20b6a7d8"),n("69084d01d3")),f=n.n(h),m=n("5a5c6d313d"),v=(n("342844cefa"),n("a84962d637"),n("c554310b5c"),n("bcb5d93d36"),n("730477bb20")),g=n.n(v),b=n("85d0a7609b"),y=n.n(b),x=n("7a5536c9bf"),w=n.n(x),S=n("14502724a6"),k=n.n(S),C=(n("8a35b54c1d"),n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("3bf1976a4f"),n("759492dad9"),n("b4638a0243"),n("8aebbf296a"),n("75563bc376"),n("5fdb99520e")),E=n("ec99168144"),I=n("57db36e15c"),T=n("18695a8c86"),R=n("547611bd96"),M=n.n(R),O=n("ff46ef6411"),N=n.n(O),L=n("1748118723"),z=n.n(L),j=n("e792a3169a"),P=n.n(j),D=n("cb6124fa19"),A=n.n(D),B={insert:"head",singleton:!1},F=(P()(A.a,B),A.a.locals||{});function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var W=function(e){c()(n,e);var t=H(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){var e=this.props.arrowSize,t=e.width,n=e.height,r=this.props.lineRect,i=r.top,a=r.left,o=r.height,l=r.width,c=this.props,s=c.scale,u=c.strokeDash,d=this.props.orient===I.d.HORIZONTAL,p=t/s.graphicScale,h=n/s.graphicScale,m=u/s.graphicScale,v={top:i,left:a,width:d?l*s.frameScale:p,height:d?p:o*s.frameScale},g=d?{x1:0,y1:p/2,x2:l*s.frameScale,y2:p/2}:{x1:p/2,y1:0,x2:p/2,y2:o*s.frameScale},b={top:v.top*s.frameScale,left:v.left*s.frameScale,width:v.width,height:v.height},x=d?{x1:g.x1,y1:g.y1,x2:g.x1+p,y2:g.y1}:{x1:g.x1,y1:g.y1,x2:g.x1,y2:g.y1+p},w=d?{x1:g.x2-p,y1:g.y2,x2:g.x2,y2:g.y2}:{x1:g.x2,y1:g.y2-p,x2:g.x2,y2:g.y2},S={x1:x.x2,y1:x.y2,x2:w.x1,y2:w.y1},k=this.props.orient===I.d.HORIZONTAL?o:l;return f.a.createElement("svg",{style:b,className:z()(y()({},F["snap-line-double-arrow-line"],!0)),xmlns:"http://www.w3.org/2000/svg"},f.a.createElement("defs",null,f.a.createElement("marker",{id:"arrowhead-start",markerWidth:p,markerHeight:h,refX:"1",refY:h/2,orient:"auto"},f.a.createElement("polygon",{fill:this.props.color,points:"".concat(p," 0, 0 ").concat(h/2,", ").concat(p," ").concat(h)})),f.a.createElement("marker",{id:"arrowhead-end",markerWidth:p,markerHeight:h,refX:p,refY:h/2,orient:"auto"},f.a.createElement("polygon",{fill:this.props.color,points:"0 0, ".concat(p," ").concat(h/2,", 0 ").concat(h)}))),f.a.createElement("polyline",{points:"".concat(x.x1," ").concat(x.y1," ").concat(x.x2," ").concat(x.y2),stroke:this.props.color,strokeWidth:1,fill:"none",strokeDasharray:"".concat(m,", ").concat(m),markerStart:"url(#arrowhead-start)"}),f.a.createElement("polyline",{points:"".concat(S.x1," ").concat(S.y1," ").concat(S.x2," ").concat(S.y2),stroke:this.props.color,strokeWidth:k/s.graphicScale,fill:"none",strokeDasharray:"".concat(m,", ").concat(m)}),f.a.createElement("polyline",{points:"".concat(w.x1," ").concat(w.y1," ").concat(w.x2," ").concat(w.y2),stroke:this.props.color,strokeWidth:1,fill:"none",strokeDasharray:"".concat(m,", ").concat(m),markerEnd:"url(#arrowhead-end)"}))}}]),n}(h.Component);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}y()(W,"defaultProps",{color:"#d08a7c"});var G=function(e){c()(n,e);var t=U(n);function n(){var e;i()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(M()(e),"defaultColor","#fe6671"),e}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.range,n=e.position,r=e.orient,i=e.scale,a=e.strokeWidth,o=N()(t),l=o[1]-o[0],c=r===I.d.HORIZONTAL?{width:l,height:a,left:o[0],top:n-a/2}:{width:a,height:l,left:n-a/2,top:o[0]};return f.a.createElement(W,{arrowSize:this.props.arrowSize,lineRect:c,orient:r,color:this.defaultColor,scale:i,strokeDash:this.props.strokeDash,strokeWidth:a})}}]),n}(h.Component),V=n("cfcad8f674"),Z=n.n(V),_={insert:"head",singleton:!1},Y=(P()(Z.a,_),Z.a.locals||{});function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var Q=function(e){c()(n,e);var t=J(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){var e=this.props.rect,t=e.top,n=e.left,r=e.height,i=e.width,a=this.props,o=a.scale,l=a.strokeDash,c={top:t,left:n,width:i,height:r},s={top:c.top*o.frameScale,left:c.left*o.frameScale,width:c.width,height:c.height},u=(this.props.orient===I.d.HORIZONTAL?r:i)/o.graphicScale;this.props.orient===I.d.HORIZONTAL?(c.top-=u/2,s.width*=o.frameScale,s.height/=o.graphicScale):(c.left-=u/2,s.height*=o.frameScale,s.width/=o.graphicScale);var d=this.props.orient===I.d.HORIZONTAL?{x1:0,y1:u/2,x2:"100%",y2:u/2}:{x1:u/2,y1:0,x2:u/2,y2:"100%"},p=l/o.graphicScale;return f.a.createElement("svg",{style:s,className:z()(K(y()({},Y["snap-line-dot-line"],!0),this.props.classnames))},f.a.createElement("line",{x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,stroke:this.props.color,strokeWidth:u,strokeDasharray:"".concat(p,", ").concat(p)}))}}]),n}(h.Component);function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}y()(Q,"defaultProps",{color:"#d08a7c"});var $=function(e){c()(n,e);var t=q(n);function n(){var e;i()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(M()(e),"extendLineColor","#b2b2b2"),e}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.range,n=e.position,r=e.orient,i=t[1]-t[0],a=r===I.d.HORIZONTAL?{width:i,height:this.props.strokeWidth,left:t[0],top:n}:{width:this.props.strokeWidth,height:i,left:n,top:t[0]};return f.a.createElement(Q,{rect:a,orient:r,color:this.extendLineColor,scale:this.props.scale,strokeDash:this.props.strokeDash})}}]),n}(h.Component),ee=n("2f766f71b0"),te=n.n(ee);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var ae=function(e){c()(n,e);var t=ie(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){var e=this,t=this.props.snapLines,n=t.filter((function(t){return e.isSlideSymmetrySnapLines(t)})),r=t.filter((function(t){return!e.isSlideSymmetrySnapLines(t)}));return f.a.createElement(f.a.Fragment,null,this.renderSlideSymmetrySnapLines(n),this.renderMarginSnapLines(r))}},{key:"displayPadding",get:function(){return this.props.displayPadding}},{key:"renderSlideSymmetrySnapLines",value:function(e){var t=this;return e.map((function(e,n){var r=t.getSlideSymmetryMarginSnapLineFrames(e),i=t.getSlideSymmetryMarginSnapLineGroupProps(r,e),a=i.arrowLines,o=i.extendLines;return f.a.createElement(oe,{key:n,arrowLines:a,extendLines:o})}))}},{key:"renderMarginSnapLines",value:function(e){var t=this,n=te()(e.map((function(e){return t.getElementMarginSnapLineGroupFrames(e).map((function(n){return t.getElementMarginSnapLineGroupProps(n,e)}))}))),r=this.filterOverlappedMarginSnapLineGroup(n);return f.a.createElement(f.a.Fragment,null,r.map((function(e,t){var n=e.arrowLines,r=e.extendLines;return f.a.createElement(oe,{key:t,arrowLines:n,extendLines:r})})))}},{key:"filterOverlappedMarginSnapLineGroup",value:function(e){var t=new Map;return e.forEach((function(e){var n,r=k()(e.arrowLines,1)[0],i="".concat(r.orient,"-").concat(r.range.map((function(e){return e.toFixed(2)})).join("-")),a=null===(n=t.get(i))||void 0===n?void 0:n.arrowLines[0].position;(!t.has(i)||a&&a<r.position)&&t.set(i,e)})),Array.from(t.values())}},{key:"isSlideSymmetrySnapLines",value:function(e){return e.source===T.a.SLIDE}},{key:"getElementMarginSnapLineGroupFrames",value:function(e){return e.marginType===E.b.BETWEEN?this.getBetweenReferMarginSnapLineGroupedFrames(e):this.getExtendMarginSnapLineGroupedFrames(e)}},{key:"getExtendMarginSnapLineGroupedFrames",value:function(e){var t=e.equalMarginRefGroup.map((function(e){return e.map((function(e){return e.outerFrameOnSlide}))}));return t.push(this.getOperationElementMarginGroup(e)),t}},{key:"getBetweenReferMarginSnapLineGroupedFrames",value:function(e){var t=e.refElements,n=k()(t,2),r=n[0],i=n[1],a=r.outerFrameOnSlide,o=i.outerFrameOnSlide,l=this.getOperationElementFrame(e);return[[a,l],[l,o]]}},{key:"getSlideSymmetryMarginSnapLineFrames",value:function(e){var t=e.equalMarginRefGroup.map((function(e){return e.outerFrameOnSlide}));return t.push(this.getOperationElementFrame(e)),t}},{key:"getElementMarginSnapLineGroupProps",value:function(e,t){var n=this,r=t.orient,i=this.isVertical(r),a=Math.max.apply(Math,w()(e.map((function(e){return i?n.getFrameBottom(e):n.getFrameRight(e)}))))+this.displayPadding,o=this.orderFramesWithOrient(e,r).map((function(e,t){var o;return o=i?0===t?n.getFrameRight(e):e.left:0===t?n.getFrameBottom(e):e.top,re({orient:r,range:[n.isVertical(r)?e.top:e.left,a],position:o},n.extendLineStyleProps)})),l=[re({orient:Object(C.f)(r),range:N()(o.map((function(e){return e.position}))),position:a},this.arrowLineStyleSheetProps)];return{extendLines:o,arrowLines:l}}},{key:"getSlideSymmetryMarginSnapLineGroupProps",value:function(e,t){var n=this,r=t.orient,i=t.refElements.find((function(e){return e.source===T.a.SLIDE}));if(!i)return{extendLines:[],arrowLines:[]};var a=i.outerFrameOnSlide,o=[],l=[];return e.map((function(e){var t=n.getRefFrame(e);if(n.isVertical(r)){var i=t.right<a.left,c=re({orient:r,range:[t.top,t.bottom+n.displayPadding],position:i?t.right:t.left},n.extendLineStyleProps);o.push(c),l.push(re({orient:Object(C.f)(r),range:[c.position,a.left],position:c.range[1]},n.arrowLineStyleSheetProps))}else{var s=t.bottom<a.top,u=re({orient:r,range:[t.left,t.right+n.displayPadding],position:s?t.bottom:t.top},n.extendLineStyleProps);o.push(u),l.push(re({orient:Object(C.f)(r),range:[u.position,a.top],position:u.range[1]},n.arrowLineStyleSheetProps))}})),o.push(re({orient:r,range:this.isVertical(r)?[a.top,this.getFrameBottom(a)]:[a.left,this.getFrameRight(a)],position:this.isVertical(r)?a.left:a.top},this.extendLineStyleProps)),{extendLines:o,arrowLines:l}}},{key:"extendLineStyleProps",get:function(){return{scale:this.props.scale,strokeWidth:this.props.strokeWidth,strokeDash:this.props.strokeDash}}},{key:"arrowLineStyleSheetProps",get:function(){return{scale:this.props.scale,strokeWidth:this.props.strokeWidth,arrowSize:this.props.arrowSize,strokeDash:this.props.strokeDash}}},{key:"orderFramesWithOrient",value:function(e,t){return N()(e,[function(e){return t===I.d.HORIZONTAL?e.top||0:e.left||0}])}},{key:"getOperationElementMarginGroup",value:function(e){var t=e.refElements,n=e.orient,r=e.adsorbEdge,i=(e.frame,e.position,k()(t,2)),a=i[0],o=i[1];return this.isVertical(n)?r===I.a.LEFT?[o.outerFrameOnSlide,this.getOperationElementFrame(e)]:[this.getOperationElementFrame(e),a.outerFrameOnSlide]:r===I.a.TOP?[o.outerFrameOnSlide,this.getOperationElementFrame(e)]:[this.getOperationElementFrame(e),a.outerFrameOnSlide]}},{key:"getOperationElementFrame",value:function(e){return e.frameOnSlide}},{key:"isVertical",value:function(e){return e===I.d.VERTICAL}},{key:"getRefFrame",value:function(e){return re(re({},e),{},{right:e.left+e.width,bottom:e.top+e.height})}},{key:"getFrameBottom",value:function(e){return e.top+e.height}},{key:"getFrameRight",value:function(e){return e.left+e.width}}]),n}(h.Component),oe=function(e){c()(n,e);var t=ie(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){return f.a.createElement("div",{className:"margin-snap-line"},this.props.extendLines.map((function(e,t){return f.a.createElement($,g()({},e,{key:t}))})),this.props.arrowLines.map((function(e,t){return f.a.createElement(G,g()({},e,{key:t}))})))}}]),n}(h.Component);function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var ce=function(e){c()(n,e);var t=le(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){var e=this;return f.a.createElement(f.a.Fragment,null,this.props.snapLines.map((function(t,n){var r=t.orient,i=t.refElements,a=k()(i,1)[0];return a?f.a.createElement(Q,{key:n,classnames:{"edge-snap-line":!0},rect:e.getLineRect(a,t),orient:r,color:e.props.color,scale:e.props.scale,strokeDash:e.props.strokeDash}):f.a.createElement(f.a.Fragment,null)})))}},{key:"displayPadding",get:function(){return this.props.displayPadding}},{key:"strokeWidth",get:function(){return this.props.strokeWidth}},{key:"getLineRect",value:function(e,t){var n=t.position,r=t.frame,i=e.outerFrameOnSlide;if(this.isHorizontal(t)){var a=Math.min(i.left,r.left)-this.displayPadding;return{width:Math.max(i.left+i.width,r.left+r.width)+this.displayPadding-a,height:this.strokeWidth,left:a,top:n}}var o=Math.min(i.top,r.top)-this.displayPadding,l=Math.max(i.top+i.height,r.top+r.height)+this.displayPadding-o;return{width:this.strokeWidth,height:l,left:n,top:o}}},{key:"isHorizontal",value:function(e){return e.orient===I.d.HORIZONTAL}}]),n}(h.Component);function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var ue,de,pe,he=function(e){c()(n,e);var t=se(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.snapLines,r=t.scale;return f.a.createElement(f.a.Fragment,null,n.map((function(t){var n=t.orient,i=t.refElements.map((function(e){return e.outerFrameOnSlide}));return f.a.createElement(f.a.Fragment,null,i.map((function(t,i){var a={orient:Object(C.f)(n),range:n===I.d.VERTICAL?[t.left,t.left+t.width]:[t.top,t.top+t.height],position:n===I.d.VERTICAL?t.top+t.height/2:t.left+t.width/2,scale:r,strokeWidth:e.props.strokeWidth,arrowSize:e.props.arrowSize,strokeDash:e.props.strokeDash};return f.a.createElement(G,g()({},a,{key:i}))})))})))}}]),n}(h.Component),fe=n("89ec4be862");function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var ve=(ue=Reflect.metadata("design:type",Function),de=Reflect.metadata("design:paramtypes",["undefined"==typeof SnapLinesProps?Object:SnapLinesProps]),Object(m.b)(pe=ue(pe=de(pe=function(e){c()(n,e);var t=me(n);function n(e){return i()(this,n),t.call(this,e)}return o()(n,[{key:"render",value:function(){return f.a.createElement(f.a.Fragment,null,this.renderActiveSnapLines(),this.renderDevDebugContent())}},{key:"renderActiveSnapLines",value:function(){var e,t=this,n=(null===(e=this.props.snapLineService)||void 0===e?void 0:e.getActiveSnapLines())||[],r=[],i=[],a=[];return n.forEach((function(e){t.isMarginSnapLine(e)?r.push(e):t.isRectSnapLine(e)?i.push(e):a.push(e)})),f.a.createElement(f.a.Fragment,null,f.a.createElement(ae,{snapLines:r,scale:this.props.scale,strokeWidth:this.props.styleSheet.strokeWidth,displayPadding:this.props.styleSheet.margin.displayPadding,arrowSize:this.props.styleSheet.margin.arrowSize,strokeDash:this.props.styleSheet.strokeDash}),f.a.createElement(he,{snapLines:i,scale:this.props.scale,strokeWidth:this.props.styleSheet.strokeWidth,arrowSize:this.props.styleSheet.margin.arrowSize,strokeDash:this.props.styleSheet.strokeDash}),f.a.createElement(ce,{snapLines:a,scale:this.props.scale,strokeWidth:this.props.styleSheet.strokeWidth,displayPadding:this.props.styleSheet.edge.displayPadding,strokeDash:this.props.styleSheet.strokeDash}))}},{key:"isMarginSnapLine",value:function(e){return e.type===E.a.MARGIN}},{key:"isRectSnapLine",value:function(e){return e.type===E.a.RECT}},{key:"renderDevDebugContent",value:function(){var e=this;if(Object(fe.a)()){var t=this.props.snapLineService,n=(null==t?void 0:t.context.elementGrids)||[],r=(null==t?void 0:t.context.detectGrids)||[],i=(null==t?void 0:t.context.adsorbPoints)||[],a=(null==t?void 0:t.context.beforeAdsorbPoints)||[];return f.a.createElement(f.a.Fragment,null,n.map((function(t,n){return f.a.createElement(ge,{key:n,snapLine:t,scale:e.props.scale,color:"green"})})),r.map((function(t,n){return f.a.createElement(ge,{key:n,snapLine:t,scale:e.props.scale,color:"red"})})),i.map((function(e,t){return f.a.createElement("div",{className:"adsorbPoints",key:t,style:{position:"absolute",width:10,height:10,borderRadius:"50%",background:"#000",left:e.x,top:e.y}})})),a.map((function(e,t){return f.a.createElement("div",{className:"beforeAdsorbPoints",key:t,style:{position:"absolute",width:10,height:10,borderRadius:"50%",background:"red",left:e.x,top:e.y}})})))}}}]),n}(h.Component))||pe)||pe)||pe);function ge(e){var t=e.snapLine,n=e.scale,r=e.color,i=t.orient,a=t.position,o=i===I.d.HORIZONTAL?{width:3e3,height:1.5,left:0,top:a}:{width:1.5,height:3e3,left:a,top:0};return f.a.createElement(Q,{rect:o,orient:i,color:r,scale:n,strokeDash:7})}},"77fdbf9d0f":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzI4XzYwOTApIj4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfYl8yOF82MDkwKSI+CjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEyIiBmaWxsPSIjMzM0RDY2IiBmaWxsLW9wYWNpdHk9IjAuMDgiIHN0eWxlPSJmaWxsOiMzMzRENjY7ZmlsbDpjb2xvcihkaXNwbGF5LXAzIDAuMjAwMCAwLjMwMjAgMC40MDAwKTtmaWxsLW9wYWNpdHk6MC4wODsiLz4KPC9nPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE3IDguMzA0MzVMMTMuMzA0MyAxMkwxNyAxNS42OTU3TDE1LjY5NTcgMTdMMTIgMTMuMzA0M0w4LjMwNDM1IDE3TDcgMTUuNjk1N0wxMC42OTU3IDEyTDcgOC4zMDQzNUw4LjMwNDM1IDdMMTIgMTAuNjk1N0wxNS42OTU3IDdMMTcgOC4zMDQzNVoiIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjAuNDgiIHN0eWxlPSJmaWxsOmJsYWNrO2ZpbGwtb3BhY2l0eTowLjQ4OyIvPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2JfMjhfNjA5MCIgeD0iLTI0IiB5PSItMjQiIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVHYXVzc2lhbkJsdXIgaW49IkJhY2tncm91bmRJbWFnZUZpeCIgc3RkRGV2aWF0aW9uPSIxMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJTb3VyY2VBbHBoYSIgb3BlcmF0b3I9ImluIiByZXN1bHQ9ImVmZmVjdDFfYmFja2dyb3VuZEJsdXJfMjhfNjA5MCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfYmFja2dyb3VuZEJsdXJfMjhfNjA5MCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPGNsaXBQYXRoIGlkPSJjbGlwMF8yOF82MDkwIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSJ3aGl0ZSIgc3R5bGU9ImZpbGw6d2hpdGU7ZmlsbC1vcGFjaXR5OjE7Ii8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg=="},"7a304b4bd6":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return it})),n.d(t,"ModalTitle",(function(){return at})),n.d(t,"ModalFooter",(function(){return ot}));n("73b854064b");var r,i=n("176815363d"),a=n.n(i),o=n("9132715560"),l=n.n(o),c=n("6a364eb35c"),s=n.n(c),u=n("547611bd96"),d=n.n(u),p=n("bd29e2df90"),h=n.n(p),f=n("ab5eb40518"),m=n.n(f),v=n("1b4cdd6a36"),g=n.n(v),b=n("85d0a7609b"),y=n.n(b),x=n("3ef2352f0b"),w=n.n(x),S=(n("c6244f7705"),n("081c8cafea"),n("8ee19818c4"),n("69084d01d3")),k=n.n(S),C=n("52d461bc51"),E=n.n(C),I=n("11246a1392"),T=n.n(I),R=n("82f2dc9440"),M=n.n(R),O=n("e792a3169a"),N=n.n(O),L=n("88863666a6"),z=n.n(L),j={insert:"head",singleton:!1},P=(N()(z.a,j),z.a.locals||{}),D=n("d5c3deb8c7"),A=n("5fac0349d3"),B=n("835b8f6e94"),F=n.n(B),H={insert:"head",singleton:!1},W=(N()(F.a,H),F.a.locals||{}),U=n("211dd594e1"),G=n("acd95c6ea5"),V=n.n(G),Z={insert:"head",singleton:!1},_=(N()(V.a,Z),V.a.locals||{}),Y=n("1748118723"),X=n.n(Y);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}!function(e){e[e.BIG=0]="BIG",e[e.SMALL=1]="SMALL"}(r||(r={}));k.a.Component;function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var Q=function(e){h()(n,e);var t=J(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).state={selectedScaleList:[],scaleType:r.BIG,colNumber:1},i}return s()(n,[{key:"render",value:function(){var e,t=this.props,n=t.cloneUiDataService,r=t.slideWidth,i=t.slideHeight;return k.a.createElement("div",{className:W["theme-preview-container"]},k.a.createElement("div",{className:W["theme-preview-list-container"]},k.a.createElement(U.a,{originSlideWidth:r,originSlideHeight:i,showBorder:!0,colNumber:this.state.colNumber,slideList:(null==n||null===(e=n.presentation)||void 0===e?void 0:e.children)||[]})))}}]),n}(k.a.Component),q=n("bc0b51de4b"),$=n.n(q),ee={insert:"head",singleton:!1},te=(N()($.a,ee),$.a.locals||{}),ne=(n("6e20b6a7d8"),n("7e6f356806")),re=n("03f607044f");function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var ae=function(e){h()(n,e);var t=ie(n);function n(e){return l()(this,n),t.call(this,e)}return s()(n,[{key:"render",value:function(){var e=this;return k.a.createElement(S.Fragment,null,k.a.createElement(re.a,{defaultActiveId:this.props.themeType,tabBarStyle:{height:36},tabBarSize:"small",alignment:"left",indicatorWidth:"small",onChange:function(t){e.props.onThemeTypeChange(t)}},ne.f.map((function(e){var t=e.key,n=e.title;return k.a.createElement(re.a.TabPane,{tab:n,id:t,key:t})}))))}}]),n}(k.a.Component),oe=(n("22569efd03"),n("eb9e932508"),n("0ad329aafc")),le=n("930678ba2e"),ce=n.n(le),se=n("69a59851de"),ue=n.n(se),de={insert:"head",singleton:!1},pe=(N()(ue.a,de),ue.a.locals||{}),he=n("6d623d55ad"),fe=n.n(he);function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var ve=function(e){h()(n,e);var t=me(n);function n(e){var r,i;return l()(this,n),i=t.call(this,e),y()(d()(i),"rightMenuManager",void 0),y()(d()(i),"showRightMenu",(function(e){e.preventDefault(),e.stopPropagation();var t=i.props||{},n=t.themeColorManager,r=t.menuManager;if(r){var a=e.nativeEvent;if(n){var o=r.getRightMenuFromTheme(n.currentThemeModel);r.hideAllMenu(),i.handleShowRightMenu(o.type,o.items,[],{top:a.clientY,left:a.clientX+8,minWidth:200,subMinWidth:200,zIndex:10005,onSubMenuVisibleChange:function(){}},(function(e,t,n){o.callback(e,t,{object:n})}))}}})),y()(d()(i),"handleShowRightMenu",(function(e,t,n,r,a){i.rightMenuManager&&i.rightMenuManager.showMenu(e,t,n,r,(function(){i.rightMenuManager.hideMenu(e),a.apply(void 0,arguments)}))})),null===(r=i.props.rightMenuManager)||void 0===r||r.promise().then((function(e){i.rightMenuManager=e})),i}return s()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.selected,r=t.themeItem,i=r.title,a=r.colorSchema,o=(r.isVip,r.id),l=r.subTitle,c=this.props.themeColorManager,s=i;return l&&(s+=" ".concat(l)),k.a.createElement("div",{onClick:this.props.onClick,className:pe["theme-item-wrapper"]},k.a.createElement("div",{className:pe["theme-item-title"]},k.a.createElement("div",{style:{width:"max-content"}},s)),k.a.createElement(fe.a,{title:s,trigger:"hover",placement:"bottom"},k.a.createElement("div",{onContextMenu:function(t){e.props.canEdit&&(null==c||c.setCurrentEditKey(o),e.showRightMenu(t))},className:pe["theme-item-color-group"]},!n&&k.a.createElement("div",{className:pe["theme-item-color-hover"]}),k.a.createElement(ge,{color:a.dk2.color,key:a.dk2.val+a.dk2.color}),k.a.createElement(ge,{color:a.lt2.color,key:a.lt2.val+a.lt2.color}),k.a.createElement(ge,{color:a.accent1.color,key:a.accent1.val+a.accent1.color}),k.a.createElement(ge,{color:a.accent2.color,key:a.accent2.val+a.accent2.color}),k.a.createElement(ge,{color:a.accent3.color,key:a.accent3.val+a.accent3.color}),k.a.createElement(ge,{color:a.accent4.color,key:a.accent4.val+a.accent4.color}),k.a.createElement(ge,{color:a.accent5.color,key:a.accent5.val+a.accent5.color}),k.a.createElement(ge,{color:a.accent6.color,key:a.accent6.val+a.accent6.color}),n&&k.a.createElement("div",{className:pe["theme-item-color-selected"]}))))}}]),n}(k.a.Component),ge=(k.a.Component,function(e){h()(n,e);var t=me(n);function n(){return l()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){return k.a.createElement("div",{className:pe["color-item-wrapper"],style:{background:"#".concat(this.props.color)}})}}]),n}(k.a.Component)),be=(n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("2c4d03fe19"),n("f000f89fa1")),ye=n.n(be),xe=n("f2b6d66c40"),we=n("c6ab6fafd7"),Se=n.n(we),ke={insert:"head",singleton:!1},Ce=(N()(Se.a,ke),Se.a.locals||{}),Ee=n("01f4863914"),Ie=n.n(Ee),Te={insert:"head",singleton:!1},Re=(N()(Ie.a,Te),Ie.a.locals||{});function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var Oe=function(e){h()(n,e);var t=Me(n);function n(){return l()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props.themeConfig;return k.a.createElement("div",{className:Re["theme-preview-example-container"]},k.a.createElement(Ne,{themeConfig:e,mode:"white"}),k.a.createElement(Ne,{themeConfig:e,mode:"dark"}))}}]),n}(k.a.Component),Ne=function(e){h()(n,e);var t=Me(n);function n(){return l()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.themeConfig,n=e.mode,r=t.colorSchema,i="dark"===n,a=r.dk1,o=r.dk2,l=r.lt1,c=r.lt2,s=r.accent1,u=r.accent2,d=r.accent3,p=r.accent4,h=r.accent5,f=r.accent6,m=i?o:c,v=i?l:a,g="1px solid #".concat(v.color);return r?k.a.createElement("div",{className:Re["theme-preview-example-image-wrapper"],style:{background:"#".concat(m.color)}},k.a.createElement("div",{className:Re["theme-preview-example-text"],style:{color:"#".concat(v.color)}},xe.default.t("文字")),k.a.createElement("div",{className:Re["theme-preview-example-shape"]},k.a.createElement("div",{className:Re["theme-preview-example-shape-circle"],style:{border:g,background:"#".concat(l.color)}},k.a.createElement("svg",{style:{position:"relative",right:1},xmlns:"http://www.w3.org/2000/svg",width:"42",height:"42",viewBox:"0 0 42 42",fill:"none"},k.a.createElement("path",{d:"M35.2499 23.1097L33.9177 21.4443L32.5855 23.1097L31.2532 21.4443L29.921 23.1097L28.5888 21.4443L27.2566 23.1097L25.9244 21.4443L24.5922 23.1097L23.26 21.4443L21.9278 23.1097L20.5955 21.4443L19.2633 23.1097L17.9311 21.4443L16.5989 23.1097L15.2667 21.4443L13.9345 23.1097L12.6023 21.4443L11.2701 23.1097L9.93785 21.4443L8.60564 23.1097",stroke:"#".concat(s.color)}))),k.a.createElement("div",{className:Re["theme-preview-example-shape-rect"],style:{border:g,background:"linear-gradient(90deg, white, #".concat(s.color,")")}})),k.a.createElement("div",{className:Re["theme-preview-example-accent-wrapper"]},k.a.createElement("div",{className:Re["theme-preview-example-accent"],style:{height:16,background:"#".concat(s.color),border:g,borderRight:"none"}}),k.a.createElement("div",{className:Re["theme-preview-example-accent"],style:{height:36,background:"#".concat(u.color),border:g,borderRight:"none"}}),k.a.createElement("div",{className:Re["theme-preview-example-accent"],style:{height:60,background:"#".concat(d.color),border:g}}),k.a.createElement("div",{className:Re["theme-preview-example-accent"],style:{height:48,background:"#".concat(p.color),border:g,borderLeft:"none"}}),k.a.createElement("div",{className:Re["theme-preview-example-accent"],style:{height:16,background:"#".concat(h.color),border:g,borderLeft:"none",borderRight:"none"}}),k.a.createElement("div",{className:Re["theme-preview-example-accent"],style:{height:24,background:"#".concat(f.color),border:g}}))):null}}]),n}(k.a.Component),Le=(n("1bab7b5fb7"),n("34cd92f77a"),n("3f4d6d8daf")),ze=n.n(Le),je={insert:"head",singleton:!1},Pe=(N()(ze.a,je),ze.a.locals||{}),De=n("084f2b6059"),Ae=n("75f19a1449");function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var Fe={dk1:xe.default.t("文字/背景 - 深色 1"),lt1:xe.default.t("文字/背景 - 浅色 1"),dk2:xe.default.t("文字/背景 - 深色 2"),lt2:xe.default.t("文字/背景 - 浅色 2"),accent1:xe.default.t("着色1"),accent2:xe.default.t("着色2"),accent3:xe.default.t("着色3"),accent4:xe.default.t("着色4"),accent5:xe.default.t("着色5"),accent6:xe.default.t("着色6"),hlink:xe.default.t("超链接"),folHlink:xe.default.t("访问过的超链接")},He=function(e){h()(n,e);var t=Be(n);function n(){return l()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this,t=this.props.themeConfig.colorSchema,n=Object.keys(t);return k.a.createElement("div",{className:Pe["theme-color-config-container"]},n.map((function(n){var r=t[n].color;return k.a.createElement("div",{key:n,className:Pe["theme-color-item"]},k.a.createElement("div",{className:Pe["theme-color-item-label"]},Fe[n]),k.a.createElement("div",{className:Pe["theme-color-item-button"]},k.a.createElement(De.a,{onColorChange:function(t){e.props.handleColorChange({key:n,color:t.getColorWithNoAlpha().replace("#","")})},isStandardColorPicker:!0,value:new Ae.a({rgbaStr:r}),paletteButtonsStyle:{width:64,height:24},colorBoxStyle:{width:39,height:22},iconWrapperStyle:{width:23,height:23,padding:0},iconStyle:{width:15,height:15,position:"absolute",left:5,top:4}})))})))}}]),n}(k.a.Component),We=n("a7888a8b87"),Ue=n.n(We);function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var _e=function(e){h()(n,e);var t=Ze(n);function n(e){var r;return l()(this,n),r=t.call(this,e),y()(d()(r),"handleColorChange",(function(e){var t=e.key,n=e.color,i=Ue()(r.props.themeItem);i.colorSchema[t].color=n,r.props.updateThemeItem(i)})),e.isCreateTheme?r.state={title:void 0}:r.state={title:e.themeItem.title},r}return s()(n,[{key:"render",value:function(){var e=this;return k.a.createElement(E.a,{destroyOnClose:!0,className:Ce["custom-theme-modal-container"],visible:this.props.visible,zIndex:9999,mask:!0,maskStyle:{background:"transparent"},onCancel:this.props.onCancel,title:k.a.createElement(at,{title:xe.default.t("创建自定义颜色")}),footer:k.a.createElement(ot,{disabledOk:!1,onCancel:this.props.onCancel,onOk:function(){if(e.props.themeItem){var t,n=null===(t=e.state.title)||void 0===t?void 0:t.trim(),r=Ve(Ve({},e.props.themeItem),{},{title:n||"自定义"});e.props.onOk(r)}}})},k.a.createElement("div",{className:Ce["custom-theme-dialog-content-container"]},k.a.createElement("div",{className:Ce["custom-theme-dialog-title-wrapper"]},k.a.createElement("div",{className:Ce["custom-theme-dialog-title-label"]},xe.default.t("名称")),k.a.createElement(ye.a,{maxLength:10,value:this.state.title,placeholder:xe.default.t("自定义"),onChange:function(t){e.setState({title:t})},inputClassName:Ce["custom-theme-dialog-title-input"],style:{width:"100%"}})),k.a.createElement("div",{className:Ce["custom-theme-dialog-content-wrapper"]},k.a.createElement(Oe,{themeConfig:this.props.themeItem}),k.a.createElement(He,{themeConfig:this.props.themeItem,handleColorChange:this.handleColorChange}))))}}]),n}(k.a.Component),Ye=n("71b8848e13");function Xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var Ke={14:1,15:2,16:3,17:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12},Je=function(e){h()(n,e);var t=Xe(n);function n(e){var r;return l()(this,n),r=t.call(this,e),y()(d()(r),"reactionDispose",void 0),y()(d()(r),"showCustomThemeDialog",(function(e){var t=r.getThemeColorManager();requestAnimationFrame((function(){r.setState({isCreateTheme:e}),null==t||t.updateThemeColorCustomDialogVisible(!0)}))})),y()(d()(r),"handleOk",(function(e){var t=r.getThemeColorManager();r.state.isCreateTheme?null==t||t.addCustomTheme(e):(null==t||t.updateCustomTheme(e),(null==t?void 0:t.currentEditThemeKey)===e.id&&r.props.handleThemeSelect(e)),r.setState({isCreateTheme:!1}),null==t||t.updateThemeColorCustomDialogVisible(!1)})),y()(d()(r),"handleCancel",(function(){var e=r.getThemeColorManager();null==e||e.updateThemeColorCustomDialogVisible(!1),r.setState({isCreateTheme:!1})})),y()(d()(r),"handleThemeClick",(function(e,t){r.props.handleThemeSelect(t,e)})),y()(d()(r),"getThemeColorManager",(function(){return r.props.themeColorManager})),y()(d()(r),"initEvent",(function(){var e=r.getThemeColorManager();r.reactionDispose=Object(D.r)((function(){return[null==e?void 0:e.themeColorCustomDialogVisible,null==e?void 0:e.customColorList,null==e?void 0:e.customColorList.length]}),(function(){var e,t=r.state.isCreateTheme,n=r.getThemeColorManager(),i=(n||{}).currentEditThemeKey;e=t&&r.props.selectedKey?r.getCreateThemeConfig():i&&(null==n?void 0:n.getCustomThemeById(i))||ne.e,r.setState({editThemeItem:e}),-1===(null==n?void 0:n.customColorList.findIndex((function(e){return e.id===r.props.selectedKey})))&&r.props.themeType===ne.d&&r.props.handleThemeSelect(void 0,""),r.updateComponent()}))})),y()(d()(r),"getCreateThemeConfig",(function(){var e,t,n=null===(e=r.getThemeColorManager())||void 0===e||null===(t=e.cloneUiDataService)||void 0===t?void 0:t.presentation.themeList[0],i=(null==n?void 0:n.getAllThemeColorList())||[],a={};return null==i||i.sort((function(e,t){return Ke[e.themeKey]-Ke[t.themeKey]})).forEach((function(e){var t=Ye.a[e.val];a[t]={val:e.val,color:e.color}})),{isVip:!1,colorSchema:a}})),y()(d()(r),"updateComponent",(function(){r.forceUpdate()})),r.state={editThemeItem:ne.e,isCreateTheme:!1},r.initEvent(),r}return s()(n,[{key:"componentWillUnmount",value:function(){var e;null===(e=this.reactionDispose)||void 0===e||e.call(this)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.selectedKey,i=n.isCustom,a=this.getThemeColorManager();return e=i?(null==a?void 0:a.customColorList)||[]:ne.g[this.props.themeType]||[],k.a.createElement(S.Fragment,null,i&&k.a.createElement("div",{style:{height:30,marginBottom:12}},k.a.createElement(oe.a,{disabled:e.length>=100,onClick:function(){t.showCustomThemeDialog(!0)},type:"plain",icon:ce.a,style:{height:30,width:"100%",borderRadius:4,border:"1px solid rgba(0, 0, 0, 0.12)",fontSize:12,fontWeight:400,color:"rgba(0, 0, 0, 0.88)"}},A.a.t("创建自定义颜色"))),e.map((function(e){var n="".concat(e.id);return k.a.createElement(ve,{rightMenuManager:t.props.rightMenuManager,themeColorManager:t.props.themeColorManager,menuManager:t.props.menuManager,canEdit:t.props.themeType===ne.d,selected:n===r,key:n,themeItem:e,onClick:function(){t.handleThemeClick(n,e)}})})),(null==a?void 0:a.themeColorCustomDialogVisible)&&k.a.createElement(_e,{isCreateTheme:this.state.isCreateTheme,themeItem:this.state.editThemeItem,onOk:this.handleOk,onCancel:this.handleCancel,updateThemeItem:function(e){t.setState({editThemeItem:e})},visible:!(null==a||!a.themeColorCustomDialogVisible)}))}}]),n}(k.a.Component);function Qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var qe=function(e){h()(n,e);var t=Qe(n);function n(e){var r,i;return l()(this,n),i=t.call(this,e),y()(d()(i),"listContainerRef",void 0),y()(d()(i),"handleThemeListChange",(function(){var e;null!==(e=i.listContainerRef)&&void 0!==e&&e.scrollTop&&(i.listContainerRef.scrollTop=0)})),i.state={themeType:null!=e&&null!==(r=e.themeColorManager)&&void 0!==r&&r.isOpenCustomPanel?ne.d:ne.a},i}return s()(n,[{key:"render",value:function(){var e=this;return k.a.createElement("div",{className:te["theme-color-container"]},k.a.createElement("div",{className:te["theme-color-list-container"]},k.a.createElement("div",{className:te["theme-tab-button-container"]},k.a.createElement(ae,{themeType:this.state.themeType,onThemeTypeChange:function(t){e.setState({themeType:t}),e.handleThemeListChange()}})),k.a.createElement("div",{ref:function(t){e.listContainerRef=t},className:te["theme-tab-content-container"]},k.a.createElement(Je,{themeColorManager:this.props.themeColorManager,rightMenuManager:this.props.rightMenuManager,menuManager:this.props.menuManager,isCustom:this.state.themeType===ne.d,selectedKey:this.props.selectedKey,handleThemeSelect:this.props.handleThemeSelect,themeType:this.state.themeType}))))}}]),n}(k.a.Component),$e=n("9657b29818"),et=n("d3d31c86eb"),tt=n("9da6335152"),nt=n("77c89fc0e0");function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var it=function(e){h()(n,e);var t=rt(n);function n(e){var r;return l()(this,n),r=t.call(this,e),y()(d()(r),"reactionDispose",void 0),y()(d()(r),"isSnackbarClose",!0),y()(d()(r),"loadingBar",void 0),y()(d()(r),"onCancel",(function(){var e,t;r.closeModal(),r.setState({selectedKey:"",currentSelectedTheme:void 0}),null===(e=r.props.themeColorManager)||void 0===e||null===(t=e.onCancel)||void 0===t||t.call(e)})),y()(d()(r),"getCloneUiDataService",(function(){var e;return null===(e=r.props.themeColorManager)||void 0===e?void 0:e.cloneUiDataService})),y()(d()(r),"updateComponent",(function(){r.forceUpdate()})),y()(d()(r),"onSelect",(function(e){r.setState({selectedScaleList:e})})),y()(d()(r),"closeModal",(function(){var e=r.props.themeColorManager;null==e||e.updateThemeColorDialogVisible(!1)})),y()(d()(r),"handleThemeSelect",function(){var e=a()(w.a.mark((function e(t,n){var i,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.state.currentSelectedTheme!==t){e.next=2;break}return e.abrupt("return");case 2:if(t&&n){e.next=5;break}return r.setState({currentSelectedTheme:void 0,selectedKey:""}),e.abrupt("return");case 5:return i=r.getCloneUiDataService(),o=r.props.themeColorManager,r.handleSnackbar(),r.setState({currentSelectedTheme:t,selectedKey:n||r.state.selectedKey}),e.next=11,null==i?void 0:i.forceConvertSlides(i.presentation.children);case 11:requestAnimationFrame((function(){Object($e.b)(a()(w.a.mark((function e(){var n,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==o?void 0:o.convertCustomColorToTheme(!0);case 2:null==i||null===(n=i.presentation)||void 0===n||null===(a=n.themeList)||void 0===a||a.forEach((function(e){e.updateTheme(t)})),r.handleSnackbar();case 4:case"end":return e.stop()}}),e)}))))}));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),y()(d()(r),"handleOk",a()(w.a.mark((function e(){var t,n,i,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.props.userPrivilegeService.pptEditorState===nt.f.EDITABLE){e.next=3;break}return r.props.tipsManager.showCannotEditTips(),e.abrupt("return");case 3:return r.handleSnackbar(),n=r.props.themeColorManager,i=r.props.uiDataService,e.next=8,null==i?void 0:i.forceConvertSlides(i.presentation.children);case 8:r.state.currentSelectedTheme&&requestAnimationFrame((function(){Object($e.b)((function(){var e;null==n||n.convertCustomColorToTheme(!1),(null===(e=r.state.currentSelectedTheme)||void 0===e?void 0:e.id)&&(null==n||n.applyThemeColor(r.state.currentSelectedTheme.id)),r.handleSnackbar(),r.setState({selectedKey:"",currentSelectedTheme:void 0}),r.closeModal()}))})),null!==(t=r.state.currentSelectedTheme)&&void 0!==t&&t.id&&(null==n||null===(a=n.onSelect)||void 0===a||a.call(n,r.state.currentSelectedTheme.id),Object(et.c)({opername:tt.e.DOC_PPT,module:tt.d.COLOR_SWITCH,action:tt.b.THEME_SUCCESS,ver5:r.state.currentSelectedTheme.id}));case 10:case"end":return e.stop()}}),e)})))),y()(d()(r),"handleSnackbar",(function(){r.isSnackbarClose?(r.loadingBar=M.a.show({autoClose:!1,type:"loading",message:"".concat(A.a.t("正在切换中"),"...")}),r.isSnackbarClose=!1):(r.loadingBar.close(),r.isSnackbarClose=!0)})),y()(d()(r),"initEvent",(function(){r.reactionDispose=Object(D.r)((function(){var e;return[null===(e=r.props.themeColorManager)||void 0===e?void 0:e.themeColorDialogVisible]}),(function(){r.updateComponent()}))})),r.state={selectedScaleList:[],canUndo:!1,selectedKey:""},r.initEvent(),r}return s()(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.reactionDispose)||void 0===e||e.call(this)}},{key:"render",value:function(){var e,t,n,r=this,i=this.props,a=i.slideWidth,o=i.slideHeight,l=this.getCloneUiDataService();return null==l||null===(e=l.presentation)||void 0===e||null===(t=e.children)||void 0===t||t.forEach((function(e){e.startConvertChildrenTask()})),k.a.createElement(E.a,{zIndex:9999,destroyOnClose:!0,className:P["theme-modal-container"],title:k.a.createElement(at,{title:A.a.t("一键换色")}),onCancel:this.onCancel,footer:k.a.createElement(ot,{disabledOk:!this.state.selectedKey,onOk:function(){r.handleOk()},onCancel:this.onCancel}),style:{padding:0},visible:null===(n=this.props.themeColorManager)||void 0===n?void 0:n.themeColorDialogVisible},k.a.createElement("div",{onContextMenu:function(e){e.preventDefault()},className:P["theme-dialog-container"]},k.a.createElement(Q,{slideWidth:a,slideHeight:o,canRevert:!!this.state.selectedKey,cloneUiDataService:l,onSelect:function(){}}),k.a.createElement(qe,{themeColorManager:this.props.themeColorManager,rightMenuManager:this.props.rightMenuManager,menuManager:this.props.menuManager,selectedKey:this.state.selectedKey,handleThemeSelect:this.handleThemeSelect})))}}]),n}(k.a.Component),at=function(e){h()(n,e);var t=rt(n);function n(){return l()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){return k.a.createElement("div",{className:P["modal-title-container"]},k.a.createElement("div",{className:P["modal-title-wrapper"]},this.props.title))}}]),n}(k.a.Component),ot=function(e){h()(n,e);var t=rt(n);function n(){return l()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){return k.a.createElement("div",{className:P["modal-footer-container"]},k.a.createElement("div",{className:P["modal-footer-button-container"]},k.a.createElement(T.a,{onClick:this.props.onCancel,style:{marginLeft:16}},A.a.t("取消")),k.a.createElement(T.a,{disabled:this.props.disabledOk,onClick:this.props.onOk,type:"primary",style:{marginLeft:16}},A.a.t("确定"))))}}]),n}(k.a.Component)},"7afcef1d02":function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return s}));var r=452,i=56,a=36,o=16,l=13,c=116,s=42},"7e4bea7b44":function(e,t,n){"use strict";n.r(t),n.d(t,"Snackbars",(function(){return U})),n.d(t,"default",(function(){return V}));var r,i,a=n("176815363d"),o=n.n(a),l=n("730477bb20"),c=n.n(l),s=n("1f925d7f50"),u=n.n(s),d=n("9132715560"),p=n.n(d),h=n("6a364eb35c"),f=n.n(h),m=n("85d0a7609b"),v=n.n(m),g=n("2dc700e1e6"),b=n.n(g),y=(n("f1054791f4"),n("3ef2352f0b")),x=n.n(y),w=(n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("bd80bf2d0f"),n("b0c77d1072")),S=n.n(w),k=n("d9812f1c6f"),C=n("b86964b011"),E=n("b74ee0edd6"),I=n.n(E),T=n("82f2dc9440"),R=n.n(T),M=n("4f3b15d017"),O=n("c73625d763"),N=n.n(O),L=n("8f58e78419"),z=n.n(L),j=n("5fac0349d3"),P=n("d5c3deb8c7"),D=n("020899bf26"),A=n("69084d01d3"),B=n.n(A),F=n("b479a84af5"),H=n("db0c73f5df"),W=n("f881ae5df0"),U=M.default.isMobile?I.a:R.a,G={1:"large",2:"small"},V=(r=function(){function e(){var t,r=this;(p()(this,e),u()(this,"watermarkSVGInfo",i,this),v()(this,"watermarkInfo",void 0),v()(this,"nickName",void 0),v()(this,"isNicknameUndefined",void 0),v()(this,"playerSVGInfo",void 0),v()(this,"pageWidth",void 0),v()(this,"pageHeight",void 0),v()(this,"clientVarsWaterMark",void 0),v()(this,"scWatermark",void 0),v()(this,"LazyWatermarkMask",Object(A.lazy)((function(){return Object(D.d)((function(){return Promise.all([n.e("commonAsync~9b1fde68"),n.e("commonAsync~27f19aac"),n.e("commonAsync~205ac551"),n.e("commonAsync~0c3a6025"),n.e("commonAsync~32e631b8"),n.e("commonAsync~08369118"),n.e("commonAsync~50db4bb8"),n.e("commonAsync~86c92fed"),n.e("commonAsync~a95f944a"),n.e("commonAsync~6e568190"),n.e("commonAsync~b174e5ca"),n.e("commonAsync~54a68610"),n.e("commonAsync~61b3c105"),n.e("commonAsync~f7b3ac00"),n.e("commonAsync~cece21d6"),n.e("commonAsync~ecbf7682"),n.e("commonAsync~6c5dfa7c"),n.e("commonAsync~90483627"),n.e("commonAsync~d2c096c2"),n.e("commonAsync~1285a477"),n.e("commonAsync~31ded9a0"),n.e("commonAsync~ecdbff9b"),n.e("commonAsync~c2cc425c"),n.e("commonAsync~4fb44df2"),n.e("commonAsync~d06fe423"),n.e("commonAsync~0519277e"),n.e("commonAsync~6df2b9ea"),n.e("commonAsync~b5c4f9e4"),n.e("commonAsync~ffdf5190"),n.e("commonAsync~127b6cf7"),n.e("commonAsync~b3c4a2ff"),n.e("commonAsync~19bb5a55"),n.e("async~493df0b3"),n.e("async~c5b24172"),n.e("async~0d51b00e"),n.e("async~beecf843"),n.e("async~2e2c6527"),n.e("async~da8db81f"),n.e("async~e10030d6"),n.e("async~098dcb65"),n.e("async~d0c14fe8"),n.e("async~7f8bedbf"),n.e("async~f40490b4"),n.e("async~2158e36e"),n.e("async~76acd586"),n.e("async~37d786cf"),n.e("async~30ccc425"),n.e("async~0c7d7381"),n.e("async~907e9098"),n.e("async~43172549"),n.e("async~f19eb79b"),n.e("async~95108331"),n.e("async~718865d2"),n.e("async~89b7a519"),n.e("vendors~lazyComponents")]).then(n.bind(null,"27c9dbeb2e"))}))}))),v()(this,"getLazyWatermarkMask",(function(e){var t=r.LazyWatermarkMask;return B.a.createElement(F.a,null,B.a.createElement(t,c()({},e,{watermarkManager:r})))})),v()(this,"getPlayerSVGInfo",(function(){return new Promise((function(e){var t,n,i,a,o={selfHide:!1};null!==(t=window.clientVars)&&void 0!==t&&t.watermark&&(o=JSON.parse(window.clientVars.watermark));var l=window.clientVars.isOwner,c=o.selfHide;if(l&&c&&e(null),(null!==(n=r.playerSVGInfo)&&void 0!==n&&n.base64Data||null!==(i=r.playerSVGInfo)&&void 0!==i&&i.base64NickData)&&r.clientVarsWaterMark===(null===(a=window.clientVars)||void 0===a?void 0:a.watermark))e(r.playerSVGInfo);else{var s;r.clientVarsWaterMark=null===(s=window.clientVars)||void 0===s?void 0:s.watermark;var u=screen,d=u.width,p=u.height;if(Object(C.k)()&&!window.clientVars.userName){var h="//".concat(window.hostname,"/cgi-bin/online_docs/user_info?get_vip_info=1");S.a.ajax({url:h,xhrFields:{withCredentials:!0},ajaxType:"get",param:{domain_id:window.clientVars.domainId,pad_id:window.clientVars.padId,xsrf:Object(H.b)()},success:function(t){0===t.retcode&&(window.clientVars.userName=t.nick,r.generateWatermarkSVGWithSize(d,p).then((function(t){r.playerSVGInfo=t,e(r.playerSVGInfo)})))},error:function(){window.log.error("[watermark] get_vip_info failed")}})}else r.generateWatermarkSVGWithSize(d,p).then((function(t){r.playerSVGInfo=t,e(r.playerSVGInfo)}))}}))})),v()(this,"initWithStore",(function(){var e;null===(e=window.SLR)||void 0===e||e.listen("SHOW_WATERMARK_FROM_ADVPER",(function(e){r.showDialog(e)}))})),v()(this,"generateWatermarkSVG",function(){var e=o()(x.a.mark((function e(t){var n,i,a,o,l,c,s,u,d;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window,a=i.clientVars){e.next=4;break}return window.log.error("[watermark] generateWatermarkSVG no_clientVars"),e.abrupt("return",null);case 4:if(o=a.watermark,void 0!==t){e.next=10;break}if(!r.watermarkSVGInfo){e.next=8;break}return e.abrupt("return",r.watermarkSVGInfo);case 8:e.next=11;break;case 10:o=t;case 11:if(o){e.next=13;break}return e.abrupt("return",null);case 13:if(e.prev=13,l=JSON.parse(o),c=!1,N()(l,"s.private")&&(c=1===l.s.private),r.nickName=a.userName||z()(a,"userInfo.nick"),!r.nickName){e.next=22;break}r.isNicknameUndefined=!1,e.next=24;break;case 22:if(!c){e.next=24;break}return e.abrupt("return",null);case 24:e.next=30;break;case 26:return e.prev=26,e.t0=e.catch(13),window.log.error("[watermark] generateWatermarkSVG wrong watermark ".concat(e.t0.toString())),e.abrupt("return",null);case 30:return r.updatePageParam(),s={width:r.pageWidth,height:r.pageHeight},u={isAuthor:a.isOwner,userName:r.nickName,userDomain:a.userDomain},d=r.getWatermarkFontStyle(),r.watermarkSVGInfo=null===W.GenerateSVG||void 0===W.GenerateSVG||null===(n=W.GenerateSVG.watermarkGetSVG)||void 0===n?void 0:n.call(W.GenerateSVG,o,s,u,d),e.abrupt("return",r.watermarkSVGInfo);case 36:case"end":return e.stop()}}),e,null,[[13,26]])})));return function(t){return e.apply(this,arguments)}}()),v()(this,"showDialog",(function(e){var t,n={text:"",marginType:2,selfHide:0,s:{private:0},show:1};void 0!==window.clientVars.watermark&&(n=JSON.parse(window.clientVars.watermark));var i=null===(t=D.a.DocInfoManager())||void 0===t?void 0:t.globalPadId,a=r.getShowDialogInfo(e);W.WatermarkDialogManager?W.WatermarkDialogManager.showDialog(a,JSON.stringify(n),i):U.show({message:j.a.t("请求失败，请稍后重试。"),autoClose:!0,type:"error"})})),v()(this,"setWatermarkToServer",(function(e){var t;S.a.ajax({url:"https://".concat(window.hostname,"/dop-api/setmark"),type:"POST",xhrFields:{withCredentials:!0},param:{padId:null===(t=D.a.DocInfoManager())||void 0===t?void 0:t.globalPadId,mark:JSON.stringify(e),xsrf:Object(H.b)()}})})),v()(this,"updatePageParam",(function(){if(!k.a.isMobile){var e=document.getElementById("select-view");if(null!==e){var t=e.getBoundingClientRect();t.width>0&&(r.pageWidth=t.width),t.height>0&&(r.pageHeight=t.height)}}})),v()(this,"generateWatermarkSVGWithSize",function(){var e=o()(x.a.mark((function e(t,n){var i,a,o,l,c,s,u;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=window,o=a.clientVars){e.next=3;break}return e.abrupt("return");case 3:if(l=o.watermark){e.next=6;break}return e.abrupt("return",null);case 6:return c={width:t,height:n},r.nickName=o.userName||z()(o,"userInfo.nick"),void 0!==r.nickName&&(r.isNicknameUndefined=!1),s={isAuthor:o.isOwner,userName:r.nickName,userDomain:o.userDomain},u=r.getWatermarkFontStyle(),e.abrupt("return",null===W.GenerateSVG||void 0===W.GenerateSVG||null===(i=W.GenerateSVG.watermarkGetSVG)||void 0===i?void 0:i.call(W.GenerateSVG,l,c,s,u));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),v()(this,"updateWatermark",function(){var e=o()(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t.selfHide){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.generateWatermarkSVG(t);case 4:r.watermarkSVGInfo=e.sent;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),v()(this,"getWatermarkFontStyle",(function(){return{watermarkFontColor:"#999999",watermarkFontFamily:"微软雅黑, TdocsUncommon"}})),v()(this,"getShowDialogInfo",(function(e){var t,n;switch(void 0!==e?e.detail.invokeFrom:"TitleBar"){case"Share":(n=document.querySelector(".main-share")).style.visibility="hidden",t={invokeFrom:"Share",onClose:function(){n.style.visibility="visible"}};break;case"Cooperation":(n=document.querySelector(".cooperationv2-ad-container")).style.visibility="hidden",t={invokeFrom:"Cooperation",onClose:function(){n.style.visibility="visible"}};break;case"TitleBar":(n=document.querySelector("#avd-container"))&&(n.style.visibility="hidden"),t={invokeFrom:"TitleBar",onClose:function(){n&&(n.style.visibility="visible")}};break;default:t={invokeFrom:""}}return t})),this.isNicknameUndefined=!0,this.watermarkSVGInfo=null,this.playerSVGInfo=null,this.pageWidth=700,this.pageHeight=700,window.clientVars)?this.updateWaterMarkInfo(null===(t=window.clientVars)||void 0===t?void 0:t.watermark):Object(D.b)((function(){var e;return r.updateWaterMarkInfo(null===(e=window.clientVars)||void 0===e?void 0:e.watermark)}));var a=D.a.SDKDataServices.EventManager();null==a||a.socketEvents.onWaterMarkChange((function(e){r.onWaterMarkChange(e.watermark)})),this.initWithStore()}return f()(e,[{key:"isShowGuestWaterMark",value:function(){var e;return void 0!==(null===(e=this.watermarkInfo.s)||void 0===e?void 0:e.private)&&1===this.watermarkInfo.s.private}},{key:"getWaterMarkSizeForExportImage",value:function(){return G[this.watermarkInfo.marginType||1]}},{key:"onWaterMarkChange",value:function(e){e&&(window.clientVars.watermark=e,this.updateWaterMarkInfo(e),this.updateWatermark(e))}},{key:"updateWaterMarkInfo",value:function(e){this.watermarkInfo="string"==typeof e?JSON.parse(e):{}}}]),e}(),i=b()(r.prototype,"watermarkSVGInfo",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)},"7e6f356806":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return b}));var r,i=n("85d0a7609b"),a=n.n(i),o=n("5fac0349d3"),l=n("711a53c9fc"),c="classic",s="custom",u=[{title:o.a.t("经典"),key:c},{title:o.a.t("自定义"),key:s}],d=(o.a.t("白"),o.a.t("浅灰1"),o.a.t("浅灰2"),o.a.t("浅灰3"),o.a.t("浅灰4"),o.a.t("浅灰5"),o.a.t("黑"),o.a.t("深灰1"),o.a.t("深灰2"),o.a.t("深灰3"),o.a.t("深灰4"),o.a.t("深灰5"),o.a.t("蓝灰"),o.a.t("浅蓝灰1"),o.a.t("浅蓝灰2"),o.a.t("浅蓝灰3"),o.a.t("深蓝灰1"),o.a.t("深蓝灰2"),o.a.t("蓝"),o.a.t("浅蓝1"),o.a.t("浅蓝2"),o.a.t("浅蓝3"),o.a.t("深蓝1"),o.a.t("深蓝2"),o.a.t("天蓝"),o.a.t("浅天蓝1"),o.a.t("浅天蓝2"),o.a.t("浅天蓝3"),o.a.t("深天蓝1"),o.a.t("深天蓝2"),o.a.t("绿"),o.a.t("浅绿1"),o.a.t("浅绿2"),o.a.t("浅绿3"),o.a.t("深绿1"),o.a.t("深绿2"),o.a.t("红"),o.a.t("浅红1"),o.a.t("浅红2"),o.a.t("浅红3"),o.a.t("深红1"),o.a.t("深红2"),o.a.t("橙"),o.a.t("浅橙1"),o.a.t("浅橙2"),o.a.t("浅橙3"),o.a.t("深橙1"),o.a.t("深橙2"),o.a.t("黄"),o.a.t("浅黄1"),o.a.t("浅黄2"),o.a.t("浅黄3"),o.a.t("深黄1"),o.a.t("深黄2"),o.a.t("紫"),o.a.t("浅紫1"),o.a.t("浅紫2"),o.a.t("浅紫3"),o.a.t("深紫1"),o.a.t("深紫2"),{val:l.eb.dk1,color:"000000"}),p={val:l.eb.lt1,color:"ffffff"},h={val:l.eb.hlink,color:"175CEB"},f={val:l.eb.folHlink,color:"81868F"},m={id:"Office",title:"Office",isVip:!1,colorSchema:{dk1:d,lt1:p,dk2:{val:l.eb.dk2,color:"44546A"},lt2:{val:l.eb.lt2,color:"E7E6E6"},accent1:{val:l.eb.accent1,color:"4472C4"},accent2:{val:l.eb.accent2,color:"ED7D31"},accent3:{val:l.eb.accent3,color:"A5A5A5"},accent4:{val:l.eb.accent4,color:"FFC000"},accent5:{val:l.eb.accent5,color:"5B9BD5"},accent6:{val:l.eb.accent6,color:"70AD47"},hlink:{val:l.eb.hlink,color:"0563C1"},folHlink:{val:l.eb.folHlink,color:"954F72"}}},v=[{id:"Tencent",title:o.a.t("腾讯文档"),isVip:!1,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"485368"},lt2:{val:l.eb.lt2,color:"2972F4"},accent1:{val:l.eb.accent1,color:"00A3F5"},accent2:{val:l.eb.accent2,color:"319B62"},accent3:{val:l.eb.accent3,color:"DE3C36"},accent4:{val:l.eb.accent4,color:"F88825"},accent5:{val:l.eb.accent5,color:"F5C400"},accent6:{val:l.eb.accent6,color:"9A38D7"}}},m,{id:"theme_vip_1",title:o.a.t("空境蓝调"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"1C2645"},lt2:{val:l.eb.lt2,color:"D5E3EC"},accent1:{val:l.eb.accent1,color:"246CB8"},accent2:{val:l.eb.accent2,color:"BFE5FA"},accent3:{val:l.eb.accent3,color:"8CBADE"},accent4:{val:l.eb.accent4,color:"4D749F"},accent5:{val:l.eb.accent5,color:"6C97DF"},accent6:{val:l.eb.accent6,color:"0847B1"}}},{id:"theme_vip_2",title:o.a.t("向阳橘黄"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"503719"},lt2:{val:l.eb.lt2,color:"F5F3E9"},accent1:{val:l.eb.accent1,color:"E4943D"},accent2:{val:l.eb.accent2,color:"F8D7A3"},accent3:{val:l.eb.accent3,color:"E3B566"},accent4:{val:l.eb.accent4,color:"DD944B"},accent5:{val:l.eb.accent5,color:"9E9C8E"},accent6:{val:l.eb.accent6,color:"66645A"}}},{id:"theme_vip_3",title:o.a.t("石雾迷灰"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"2b3550"},lt2:{val:l.eb.lt2,color:"e9ebf5"},accent1:{val:l.eb.accent1,color:"727b97"},accent2:{val:l.eb.accent2,color:"c2cfee"},accent3:{val:l.eb.accent3,color:"7c8ebb"},accent4:{val:l.eb.accent4,color:"455682"},accent5:{val:l.eb.accent5,color:"868ba6"},accent6:{val:l.eb.accent6,color:"5e658a"}}},{id:"theme_vip_4",title:o.a.t("翡冷翠绿"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"01383b"},lt2:{val:l.eb.lt2,color:"ecffff"},accent1:{val:l.eb.accent1,color:"317b84"},accent2:{val:l.eb.accent2,color:"8deae7"},accent3:{val:l.eb.accent3,color:"35c5c2"},accent4:{val:l.eb.accent4,color:"108a89"},accent5:{val:l.eb.accent5,color:"0ac487"},accent6:{val:l.eb.accent6,color:"1E7054"}}},{id:"theme_vip_5",title:o.a.t("故宫风韵"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"171616"},lt2:{val:l.eb.lt2,color:"f2e7e7"},accent1:{val:l.eb.accent1,color:"ca3d1f"},accent2:{val:l.eb.accent2,color:"f7dfb7"},accent3:{val:l.eb.accent3,color:"caa267"},accent4:{val:l.eb.accent4,color:"b9752a"},accent5:{val:l.eb.accent5,color:"8f3c1a"},accent6:{val:l.eb.accent6,color:"3c281d"}}},{id:"theme_vip_6",title:o.a.t("敦煌梦境"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"1e282d"},lt2:{val:l.eb.lt2,color:"f5e9d4"},accent1:{val:l.eb.accent1,color:"236a78"},accent2:{val:l.eb.accent2,color:"8edeed"},accent3:{val:l.eb.accent3,color:"4190b6"},accent4:{val:l.eb.accent4,color:"284b5c"},accent5:{val:l.eb.accent5,color:"ef6c45"},accent6:{val:l.eb.accent6,color:"a64326"}}},{id:"theme_vip_7",title:o.a.t("普罗旺斯"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"2f2958"},lt2:{val:l.eb.lt2,color:"f5e6f6"},accent1:{val:l.eb.accent1,color:"793ec7"},accent2:{val:l.eb.accent2,color:"e5bffe"},accent3:{val:l.eb.accent3,color:"db7eec"},accent4:{val:l.eb.accent4,color:"763582"},accent5:{val:l.eb.accent5,color:"4f6755"},accent6:{val:l.eb.accent6,color:"1d381e"}}},{id:"theme_vip_8",title:o.a.t("开罗之光"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"382b26"},lt2:{val:l.eb.lt2,color:"fdf6e1"},accent1:{val:l.eb.accent1,color:"ad714d"},accent2:{val:l.eb.accent2,color:"e2ccba"},accent3:{val:l.eb.accent3,color:"ac7f67"},accent4:{val:l.eb.accent4,color:"9c421f"},accent5:{val:l.eb.accent5,color:"948b82"},accent6:{val:l.eb.accent6,color:"58524c"}}},{id:"theme_vip_9",title:o.a.t("只此青绿"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"1c2e29"},lt2:{val:l.eb.lt2,color:"ecf9f5"},accent1:{val:l.eb.accent1,color:"30867f"},accent2:{val:l.eb.accent2,color:"afe5c8"},accent3:{val:l.eb.accent3,color:"589a76"},accent4:{val:l.eb.accent4,color:"3e6f53"},accent5:{val:l.eb.accent5,color:"dbbb69"},accent6:{val:l.eb.accent6,color:"8c7338"}}},{id:"theme_vip_10",title:o.a.t("日出印象"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"271016"},lt2:{val:l.eb.lt2,color:"ece9f9"},accent1:{val:l.eb.accent1,color:"7c7891"},accent2:{val:l.eb.accent2,color:"ddd1e0"},accent3:{val:l.eb.accent3,color:"bca0b8"},accent4:{val:l.eb.accent4,color:"7c7891"},accent5:{val:l.eb.accent5,color:"ecbda7"},accent6:{val:l.eb.accent6,color:"866753"}}},{id:"theme_vip_11",title:o.a.t("星空之夜"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"102443"},lt2:{val:l.eb.lt2,color:"f3edc1"},accent1:{val:l.eb.accent1,color:"114799"},accent2:{val:l.eb.accent2,color:"fecf56"},accent3:{val:l.eb.accent3,color:"68a8ca"},accent4:{val:l.eb.accent4,color:"3882b5"},accent5:{val:l.eb.accent5,color:"1b5789"},accent6:{val:l.eb.accent6,color:"afccc7"}}},{id:"theme_vip_12",title:o.a.t("叠翠流金"),isVip:!0,colorSchema:{dk1:d,lt1:p,hlink:h,folHlink:f,dk2:{val:l.eb.dk2,color:"3f3b34"},lt2:{val:l.eb.lt2,color:"f8f2e8"},accent1:{val:l.eb.accent1,color:"c09c5d"},accent2:{val:l.eb.accent2,color:"f0e0ca"},accent3:{val:l.eb.accent3,color:"DABD8E"},accent4:{val:l.eb.accent4,color:"b59465"},accent5:{val:l.eb.accent5,color:"c3b7a3"},accent6:{val:l.eb.accent6,color:"737664"}}}],g=(r={},a()(r,c,v),a()(r,s,[]),r),b=[[{hsl:{H:0,S:0,L:255},key:l.eb.lt1},{hsl:{H:0,S:0,L:242},lumMod:95e3,tips:"5%",key:l.eb.lt1},{hsl:{H:0,S:0,L:216},lumMod:85e3,tips:"15%",key:l.eb.lt1},{hsl:{H:0,S:0,L:191},lumMod:75e3,tips:"25%",key:l.eb.lt1},{hsl:{H:0,S:0,L:165},lumMod:65e3,tips:"35%",key:l.eb.lt1},{hsl:{H:0,S:0,L:147},lumMod:5e4,tips:"50%",key:l.eb.lt1}],[{hsl:{H:0,S:0,L:0},key:l.eb.dk1},{hsl:{H:0,S:0,L:127},lumMod:5e4,lumOff:5e4,tips:"50%",key:l.eb.dk1},{hsl:{H:0,S:0,L:89},lumMod:65e3,lumOff:35e3,tips:"35%",key:l.eb.dk1},{hsl:{H:0,S:0,L:63},lumMod:75e3,lumOff:25e3,tips:"25%",key:l.eb.dk1},{hsl:{H:0,S:0,L:38},lumMod:85e3,lumOff:15e3,tips:"15%",key:l.eb.dk1},{hsl:{H:0,S:0,L:13},lumMod:95e3,lumOff:5e3,tips:"5%",key:l.eb.dk1}],[{hsl:{H:219.37499999999997,S:46.36363636363637,L:88},key:l.eb.lt2},{hsl:{H:209.99999999999974,S:51.00000000000021,L:244.99999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.lt2},{hsl:{H:218.57142857142858,S:34.99999999999994,L:204},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.lt2},{hsl:{H:217.99999999999997,S:34.15178571428572,L:143},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.lt2},{hsl:{H:217.49999999999994,S:33.44262295081966,L:60.99999999999999},lumMod:75e3,tips:"25%",key:l.eb.lt2},{hsl:{H:221.99999999999994,S:31.09756097560976,L:40.99999999999999},lumMod:5e4,tips:"50%",key:l.eb.lt2}],[{hsl:{H:218.42364532019707,S:230.06666666666672,L:142.5},key:l.eb.dk2},{hsl:{H:216.9230769230769,S:255,L:242},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.dk2},{hsl:{H:217.49999999999994,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.dk2},{hsl:{H:218.23529411764704,S:255,L:204},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.dk2},{hsl:{H:218.0487804878049,S:204.99999999999997,L:102},lumMod:75e3,tips:"25%",key:l.eb.dk2},{hsl:{H:217.9591836734693,S:204.8360655737705,L:61},lumMod:5e4,tips:"50%",key:l.eb.dk2}],[{hsl:{H:200.08163265306112,S:255,L:122.5},key:l.eb.accent1},{hsl:{H:200.7692307692308,S:255,L:242},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent1},{hsl:{H:200.35714285714278,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent1},{hsl:{H:200.00000000000006,S:255,L:204},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent1},{hsl:{H:200.00000000000006,S:204.83606557377053,L:91.5},lumMod:75e3,tips:"25%",key:l.eb.accent1},{hsl:{H:199.75609756097555,S:204.99999999999997,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent1}],[{hsl:{H:147.7358490566038,S:132.5,L:101.99999999999999},key:l.eb.accent2},{hsl:{H:146.25,S:156.92307692307696,L:242},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent2},{hsl:{H:147.69230769230774,S:122.77777777777771,L:214.49999999999997},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent2},{hsl:{H:148.57142857142856,S:112.34265734265738,L:183.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent2},{hsl:{H:148.23529411764704,S:132.9754601226994,L:81.5},lumMod:75e3,tips:"25%",key:l.eb.accent2},{hsl:{H:148.88888888888886,S:135,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent2}],[{hsl:{H:2.1428571428571352,S:183.07692307692307,L:138},key:l.eb.accent3},{hsl:{H:2.6086956521738847,S:255,L:243.49999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent3},{hsl:{H:2.1428571428571352,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent3},{hsl:{H:1.764705882352935,S:255,L:204},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent3},{hsl:{H:1.8181818181818699,S:182.93478260869568,L:92},lumMod:75e3,tips:"25%",key:l.eb.accent3},{hsl:{H:2.4324324324324076,S:184.99999999999997,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent3}],[{hsl:{H:28.151658767772503,S:239.13333333333335,L:142.5},key:l.eb.accent4},{hsl:{H:23.999999999999993,S:255,L:244.99999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent4},{hsl:{H:24.406779661016962,S:255,L:225.5},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent4},{hsl:{H:26.34146341463413,S:255,L:193.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent4},{hsl:{H:27.8048780487805,S:204.99999999999997,L:102},lumMod:75e3,tips:"25%",key:l.eb.accent4},{hsl:{H:27.8048780487805,S:204.99999999999997,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent4}],[{hsl:{H:48.00000000000003,S:255,L:122.5},key:l.eb.accent5},{hsl:{H:47.142857142857096,S:255,L:241},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent5},{hsl:{H:47.56097560975613,S:255,L:214},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent5},{hsl:{H:47.83216783216781,S:255,L:183.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent5},{hsl:{H:47.85276073619637,S:255,L:81.5},lumMod:75e3,tips:"25%",key:l.eb.accent5},{hsl:{H:48.235294117647044,S:255,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent5}],[{hsl:{H:276.98113207547175,S:169.64435146443518,L:135.5},key:l.eb.accent6},{hsl:{H:294,S:255,L:244.99999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent6},{hsl:{H:286.0714285714286,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent6},{hsl:{H:277.69911504424783,S:255,L:198.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent6},{hsl:{H:277.89473684210526,S:148.6196319018405,L:81.5},lumMod:75e3,tips:"25%",key:l.eb.accent6},{hsl:{H:278,S:150,L:50.99999999999999},lumMod:5e4,tips:"50%",key:l.eb.accent6}]]},"835b8f6e94":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-theme-preview-container-2uTH7{width:627px;height:412px;position:relative;background:#f1f4f6}.index-theme-preview-title-container-17LTc{width:100%;height:28px;font-size:12px;font-weight:400;margin-bottom:8px;color:rgba(0,0,0,.88);display:flex;justify-content:space-between}.index-theme-preview-title-content-2G0KJ{height:28px;line-height:28px}.index-theme-preview-select-container-1I0P2{width:627px;height:20px;position:relative}.index-theme-select-all-wrapper-1S_YG{position:absolute;left:0;height:20px}.index-theme-revert-wrapper-2evpH{position:absolute;right:0;height:20px}.index-theme-preview-list-container-3KVVe{width:627px;height:100%;overflow-y:hidden}:hover.index-theme-selected-scale-1sV9-{border:1px solid #000}.index-theme-check-wrapper-2SsmT{position:absolute;margin:5px;right:0;bottom:0;height:16px;width:16px}.index-theme-preview-button-container-3OGiq{height:28px;width:100%;position:relative;margin-bottom:8px;display:flex;justify-content:space-between}.index-theme-preview-select-all-6UQWV{height:28px}.index-theme-preview-select-undo-Gc3RH{height:28px;line-height:28px;padding-right:10px;font-size:12px;color:rgba(0,0,0,.88);position:relative;cursor:pointer}.index-theme-preview-select-undo-disable-3OUzp{opacity:.4;cursor:not-allowed}.index-theme-preview-select-undo-icon-2K5VN{width:20px;height:20px;position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:-26px}.index-theme-preview-right-button-wrapper-1ZoGK{height:28px}.index-theme-preview-item-3dfk_{width:160px;height:90px;position:relative;border:1px solid grey;margin:5px;padding:5px;box-sizing:content-box}",""]),t.locals={"theme-preview-container":"index-theme-preview-container-2uTH7","theme-preview-title-container":"index-theme-preview-title-container-17LTc","theme-preview-title-content":"index-theme-preview-title-content-2G0KJ","theme-preview-select-container":"index-theme-preview-select-container-1I0P2","theme-select-all-wrapper":"index-theme-select-all-wrapper-1S_YG","theme-revert-wrapper":"index-theme-revert-wrapper-2evpH","theme-preview-list-container":"index-theme-preview-list-container-3KVVe","theme-selected-scale":"index-theme-selected-scale-1sV9-","theme-check-wrapper":"index-theme-check-wrapper-2SsmT","theme-preview-button-container":"index-theme-preview-button-container-3OGiq","theme-preview-select-all":"index-theme-preview-select-all-6UQWV","theme-preview-select-undo":"index-theme-preview-select-undo-Gc3RH","theme-preview-select-undo-disable":"index-theme-preview-select-undo-disable-3OUzp","theme-preview-select-undo-icon":"index-theme-preview-select-undo-icon-2K5VN","theme-preview-right-button-wrapper":"index-theme-preview-right-button-wrapper-1ZoGK","theme-preview-item":"index-theme-preview-item-3dfk_"}},"83a2fe5ac5":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiBmaWxsPSJub25lIj4KICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIuOTc5NSAzLjk2NTU3TDE0LjM5MzcgNS4zNzk3OEw3Ljc5NDkxIDExLjk3ODFMNy43OTYwNyAxMS45NzkzTDcuNTE1NzggMTIuMjU3Mkw2LjM3OTU2IDEzLjM5MzRMNi4zNzQ4MyAxMy4zODg2TDYuMzc0ODMgMTMuMzg4NkwxLjY2NjczIDguNjgwNTRMMy4wODIwMyA3LjI2NTI0TDYuMzgwOTMgMTAuNTY0MUwxMi45Nzk1IDMuOTY1NTdaIiBmaWxsPSIjMDBBQTVCIiBzdHlsZT0iZmlsbDojMDBBQTVCO2ZpbGw6Y29sb3IoZGlzcGxheS1wMyAwLjAwMDAgMC42NjY3IDAuMzU2OSk7ZmlsbC1vcGFjaXR5OjE7Ii8+Cjwvc3ZnPgo="},"844f02e987":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),c=n.n(l),s=n("85d0a7609b"),u=n.n(s),d=n("3ef2352f0b"),p=n.n(d),h=(n("c6244f7705"),n("081c8cafea"),n("f4e4ed5c17")),f=n("db0c73f5df"),m=n("7e61746219"),v="//".concat(window.location.hostname,"/cgi-bin/online_docs/browser_list"),g=function(){function t(){o()(this,t),u()(this,"cacheKey",void 0)}var n,r,a;return c()(t,[{key:"checkIfAutoShow",value:(a=i()(p.a.mark((function t(){var n,r,i,a,o,l,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.log.info("AutoShowEntryStrategy","checkIfAutoShow"),9!==(null===(n=e.basicClientVars)||void 0===n||null===(r=n.docInfo)||void 0===r?void 0:r.createSource)&&!Object(m.e)()||null===(i=e.basicClientVars)||void 0===i||null===(a=i.docInfo)||void 0===a||!a.isCreator||null===(o=e.basicClientVars)||void 0===o||null===(l=o.docInfo)||void 0===l||!l.isOwner){t.next=17;break}return window.log.info("AutoShowEntryStrategy","if"),t.next=5,this.checkIfEditedOrLongTime();case 5:if(c=t.sent,window.log.info("AutoShowEntryStrategy","isEdited:",c),!c){t.next=10;break}return this.clearLocalStorage(),t.abrupt("return",!1);case 10:return t.next=12,this.checkIfRecentViewer();case 12:if(t.sent){t.next=16;break}return this.clearLocalStorage(),t.abrupt("return",!1);case 16:return t.abrupt("return",this.checkIfFirstTime());case 17:return t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"recordShow",value:function(){this.storeFirstTimeRecord()}},{key:"checkIfFirstTime",value:function(){try{return!localStorage.getItem(this.getCacheKey())}catch(e){return!0}}},{key:"checkIfEditedOrLongTime",value:(r=i()(p.a.mark((function t(){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.basicClientVars.docInfo,r=1e3*n.createInfo.createTime,n.lastModifyTime===r){t.next=4;break}return t.abrupt("return",!0);case 4:if(!((performance.timing.navigationStart-r)/1e3>604800)){t.next=7;break}return t.abrupt("return",!0);case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"clearLocalStorage",value:function(){try{localStorage.removeItem(this.getCacheKey())}catch(e){window.log.error("localStorage error ",e)}}},{key:"storeFirstTimeRecord",value:function(){try{localStorage.setItem(this.getCacheKey(),"1")}catch(e){window.log.error("localStorage error ",e)}}},{key:"checkIfRecentViewer",value:(n=i()(p.a.mark((function t(){var n,r,i,a,o,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=null===(n=e.basicClientVars)||void 0===n||null===(r=n.docInfo)||void 0===r?void 0:r.padInfo,(a=new FormData).append("domain_id",(null==i?void 0:i.domainId)||""),a.append("pad_id",(null==i?void 0:i.padId)||""),a.append("start","0"),a.append("limit","10"),a.append("xsrf",Object(f.b)()),a.append("t",String((new Date).getTime())),t.next=11,h.a.post(v,a);case 11:if(o=t.sent,0!==(l=o.data).retcode){t.next=15;break}return t.abrupt("return",l.total<=1);case 15:t.next=21;break;case 17:return t.prev=17,t.t0=t.catch(0),window.log.error(t.t0),t.abrupt("return",!1);case 21:return t.abrupt("return",!1);case 22:case"end":return t.stop()}}),t,null,[[0,17]])}))),function(){return n.apply(this,arguments)})},{key:"getCacheKey",value:function(){var t,n;if(this.cacheKey)return this.cacheKey;var r=(null===(t=e.basicClientVars)||void 0===t||null===(n=t.docInfo)||void 0===n?void 0:n.padInfo.padId)||{};return this.cacheKey="".concat("rating_first_show_").concat(r),this.cacheKey}}]),t}()}).call(this,n("5ef37df1a0"))},"88863666a6":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-theme-dialog-container-V_Ry6{width:100%;height:412px;box-sizing:content-box;position:relative;display:flex;justify-content:space-between;border-top:1px solid #e8e8e8;border-bottom:1px solid #e8e8e8;-webkit-user-select:none;-ms-user-select:none;user-select:none}.index-theme-modal-container-1Isl0{width:840px;height:560px}.index-modal-title-container-1Yejb{padding:21px 24px 1px;font-family:PingFang SC;font-size:16px;font-style:normal;font-weight:600;line-height:22px;display:flex;align-items:center}.index-modal-title-wrapper-25kcM{margin-right:8px}.index-modal-icon-3Omgu{display:block;width:12px;height:12px;margin:0 4px}.index-modal-vip-tips-1Xkuj{font-size:12px;font-weight:400;color:rgba(0,0,0,.64);margin-right:4px}.index-modal-vip-button-Oa24v{font-size:12px;font-weight:600;color:#e59837;margin:0 4px;cursor:pointer}.index-modal-footer-container-1YF4p{padding:24px;font-family:PingFang SC;position:relative;height:84px}.index-modal-footer-button-container-2AHpF{position:absolute;right:24px;width:208px;display:flex;justify-content:space-between}",""]),t.locals={"theme-dialog-container":"index-theme-dialog-container-V_Ry6","theme-modal-container":"index-theme-modal-container-1Isl0","modal-title-container":"index-modal-title-container-1Yejb","modal-title-wrapper":"index-modal-title-wrapper-25kcM","modal-icon":"index-modal-icon-3Omgu","modal-vip-tips":"index-modal-vip-tips-1Xkuj","modal-vip-button":"index-modal-vip-button-Oa24v","modal-footer-container":"index-modal-footer-container-1YF4p","modal-footer-button-container":"index-modal-footer-button-container-2AHpF"}},"88b379c91b":function(e,t,n){t=e.exports=n("9dddfe0040")(!1);var r=n("c92b994f13")(n("0c4290554b"));t.push([e.i,".image-more-info-info-box-mZEs4{line-height:12px}.image-more-info-container-qtizD{width:28px;height:14px;background-image:url("+r+");background-color:rgba(0,0,0,.5);background-position:50%;background-size:cover;border-radius:3px}.image-more-info-container-qtizD:hover{background-color:#000}",""]),t.locals={"info-box":"image-more-info-info-box-mZEs4",container:"image-more-info-container-qtizD"}},"8e6e14785a":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".rating-result-rating-result-title-7oJKq{font-size:16px;line-height:22px;font-weight:600;color:rgba(0,0,0,.88)}.rating-result-rating-result-title-description-2RiDl{font-size:12px;line-height:16px;font-weight:400;color:rgba(0,0,0,.48)}.rating-result-rating-result-to-optimize-3tUl3{position:relative;font-size:17px;width:200px;height:44px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.rating-result-collapse-icon-ZEx7n{margin-top:-2px;margin-right:8px}.rating-result-collapse-text-p5CgS{display:flex;flex-direction:column}.rating-result-collapse-title-text-2-X-N{font-weight:400;font-family:PingFang SC;font-size:16px;line-height:22px;color:rgba(0,0,0,.88)}.rating-result-collapse-description-text-1TE_X{font-weight:400;font-family:PingFang SC;font-size:12px;line-height:16px;color:rgba(0,0,0,.48)}.rating-result-collapse-handle-button-3231R{background-color:transparent;border:transparent;color:#175ceb;font-size:14px;font-style:normal;line-height:20px}.rating-result-collapse-handle-button-3231R,.rating-result-rating-result-suggestion-3qU6N{position:relative;font-family:PingFang SC;font-weight:400;text-align:center}.rating-result-rating-result-suggestion-3qU6N{padding:32px 0;font-size:12px;color:rgba(0,0,0,.48)}.rating-result-rating-result-item-handle-button-u1477{width:50px;margin-left:auto;background-color:transparent;border:transparent;color:#175ceb;font-family:PingFang SC;font-size:14px;font-style:normal;font-weight:400;line-height:20px;text-align:center}",""]),t.locals={"rating-result-title":"rating-result-rating-result-title-7oJKq","rating-result-title-description":"rating-result-rating-result-title-description-2RiDl","rating-result-to-optimize":"rating-result-rating-result-to-optimize-3tUl3","collapse-icon":"rating-result-collapse-icon-ZEx7n","collapse-text":"rating-result-collapse-text-p5CgS","collapse-title-text":"rating-result-collapse-title-text-2-X-N","collapse-description-text":"rating-result-collapse-description-text-1TE_X","collapse-handle-button":"rating-result-collapse-handle-button-3231R","rating-result-suggestion":"rating-result-rating-result-suggestion-3qU6N","rating-result-item-handle-button":"rating-result-rating-result-item-handle-button-u1477"}},"92f68f3af7":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return H}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("963f2eaace"),n("b1e2246d82"),n("8aebbf296a"),n("f45588a8ad"),n("de37db1287");var r=n("14502724a6"),i=n.n(r),a=n("176815363d"),o=n.n(a),l=n("9132715560"),c=n.n(l),s=n("6a364eb35c"),u=n.n(s),d=n("85d0a7609b"),p=n.n(d),h=n("3ef2352f0b"),f=n.n(h),m=(n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("1068873c4f")),v=n("516fa97df2"),g=(n("826dc923b3"),n("b4638a0243"),n("e0e8dd9366")),b=n("c9c92622ff"),y=n("c45b58bbe8"),x=(n("ffc220634f"),n("3344f1a2e7"));function w(e,t){e.forEach((function(e){var n,r=e.wrapperInstance,i=null==r||null===(n=r.factoryOptions)||void 0===n?void 0:n.model;if((null==i?void 0:i.type)!==g.d.GROUP){var a,o;if((null==i?void 0:i.type)===g.d.IMAGE)null===(a=r.children)||void 0===a||null===(o=a[0])||void 0===o||o.foregroundComponent.dealVisibleStatus(t);if(Object(b.d)(i)&&r.dealVisibleStatus(t),null!=i&&i.isPlaceholder&&Object(y.b)(i.paragraphList)&&(null==i?void 0:i.type)===g.d.SHAPE){var l,c,s=null===(l=r.children)||void 0===l||null===(c=l[0])||void 0===c?void 0:c.placeHolderComponent;s&&(s.visible=!t)}}else{var u,d=null===(u=r.children)||void 0===u?void 0:u[0];null!=d&&d.children&&w(d.children,t)}}))}function S(e,t,n){return{left:Number(Object(x.J)(e.x-t).toFixed(2)),top:Number(Object(x.J)(e.y-n).toFixed(2)),width:Number(Object(x.J)(e.width).toFixed(2)),height:Number(Object(x.J)(e.height).toFixed(2))}}var k=n("2a5f3314a4");function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var E=function(){function e(t,n){c()(this,e),p()(this,"slideLeft",void 0),p()(this,"slideTop",void 0),p()(this,"renderComponents",void 0),p()(this,"services",void 0),this.services=t,this.renderComponents=n;var r=this.services.editAreaCanvasSizeManager.getCanvasSize(),i=r.slideLeft,a=r.slideTop;this.slideLeft=i,this.slideTop=a}return u()(e,[{key:"collectData",value:function(){var e,t,n,r=function(e){var t=1.5;return{left:Number(Object(x.J)(e.left/t).toFixed(2)),top:Number(Object(x.J)(e.top/t).toFixed(2)),width:Number(Object(x.J)(e.width/t).toFixed(2)),height:Number(Object(x.J)(e.height/t).toFixed(2))}}(((null===(e=this.renderComponents.wrapperInstance)||void 0===e||null===(t=e.children)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.baseComponent)||this.renderComponents).factoryOptions.model.props.style);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:this.type,textRange:this.textRange,table:this.table},r)}},{key:"collectImage",value:function(){return{image:this.export()}}},{key:"type",get:function(){return this.renderComponents.factoryOptions.model.type}},{key:"textRange",get:function(){if(this.hasText){var e=this.renderComponents.wrapperInstance.children[0].textEditor;return S(Object(k.p)(null==e?void 0:e.editor),this.slideLeft,this.slideTop)}}},{key:"table",get:function(){var e=this;if(this.hasTable){var t=[],n=this.renderComponents.wrapperInstance.children[0].tableCells,r=this.renderComponents.factoryOptions.model,i=r.tableItems.length,a=r.tableItems[0].length;return r.tableItems.forEach((function(r,i){r.forEach((function(r,o){var l=null==n?void 0:n.getTableCellWrapper(r.key);l?t.push(S(l.worldBounds,e.slideLeft,e.slideTop)):r.hMerge?t.push(t[i*a+(o-1)]):r.vMerge?t.push(t[(i-1)*a+o]):t.push(void 0)}))})),{rowCount:i,columnCount:a,cells:t}}}},{key:"hasText",get:function(){var e,t,n=this.renderComponents.factoryOptions.model.paragraphList;return!(!n||n.length<1||1===n.length&&0===(null===(e=n[0])||void 0===e||null===(t=e.textRuns)||void 0===t?void 0:t.length))}},{key:"hasTable",get:function(){return this.renderComponents.factoryOptions.model.type===g.d.TABLE}},{key:"export",value:function(e){var t=document.createElement("canvas"),n=new v.c,r=new m.a({native:t,bindEvents:!1});n.addBounds(this.renderComponents.filterWorldBounds),r.width=Math.round(n.width),r.height=Math.round(n.height);var i=this.renderComponents.x,a=this.renderComponents.y,o=this.services.editAreaCanvasSizeManager.getCanvasSize().scale;return this.renderComponents.x+=-n.x/o,this.renderComponents.y+=-n.y/o,w([this.renderComponents],!0),this.renderComponents.render(r),this.renderComponents.x=i,this.renderComponents.y=a,w([this.renderComponents],!0),r.toDataUrl(e)}}]),e}(),I=(n("73b854064b"),n("bd29e2df90")),T=n.n(I),R=n("ab5eb40518"),M=n.n(R),O=n("1b4cdd6a36"),N=n.n(O);function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=N()(e);if(t){var i=N()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return M()(this,n)}}var z=function(e){T()(n,e);var t=L(n);function n(e,r,i,a){var o;return c()(this,n),(o=t.call(this,e,r)).slideLeft=i,o.slideTop=a,o}return n}(E),j=function(){function e(t,n){c()(this,e),p()(this,"slideEditor",void 0),p()(this,"services",void 0),this.services=t,this.slideEditor=n}var t,n,r,i,a;return u()(e,[{key:"collectData",value:(a=o()(f.a.mark((function e(){var t,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateSlideEditorSize();case 2:return t=[],this.shapeRendererCollection.forEach((function(e){t.push(e.collectData())})),n=[],this.masterShapeRendererCollection.forEach((function(e){n.push(e.collectData())})),r=[],this.layoutShapeRendererCollection.forEach((function(e){r.push(e.collectData())})),e.abrupt("return",{slideShapes:t,masterShapes:n,layoutShapes:r,count:t.length+n.length+r.length});case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"collectImage",value:(i=o()(f.a.mark((function e(t){var n,r,i,a,o,l,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.needSlideImg,r=void 0===n||n,i=t.needShapeImg,a=void 0===i||i,e.next=3,this.updateSlideEditorSize();case 3:if(o=[],l=[],c=[],!r){e.next=10;break}return e.next=9,this.export();case 9:s=e.sent;case 10:return a&&(this.shapeRendererCollection.forEach((function(e){o.push(e.collectImage())})),this.masterShapeRendererCollection.forEach((function(e){l.push(e.collectImage())})),this.layoutShapeRendererCollection.forEach((function(e){c.push(e.collectImage())}))),e.abrupt("return",{image:s,slideShapes:o,masterShapes:l,layoutShapes:c});case 12:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"export",value:(r=o()(f.a.mark((function e(t){var n,r,i,a,o,l,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.createElement("canvas"),r=new m.a({native:n,bindEvents:!1}),i=this.services.uiDataService.presentation.props,a=i.slideWidth,o=i.slideHeight,l=this.services.editAreaCanvasSizeManager.getCanvasSize(),c=l.scale,r.width=Math.round(a*c),r.height=Math.round(o*c),e.next=8,this.renderStableLayer(r);case 8:return e.next=10,this.renderSlideComponent(r);case 10:return e.abrupt("return",r.toDataUrl(t));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"shapeRendererCollection",get:function(){var e=this,t=this.slideEditor.slideComponent.elementsLayer.children,n=[];return t.forEach((function(t){var r=new E(e.services,t);n.push(r)})),n}},{key:"masterShapeRendererCollection",get:function(){var e,t,n,r,i=this,a=null===(e=this.slideEditor.getMasterAppService())||void 0===e?void 0:e.getComponent().children,o=null===(t=this.slideEditor.slide)||void 0===t||null===(n=t.getRelationLayoutModel())||void 0===n?void 0:n.showMasterSp,l=null===(r=this.slideEditor.slide)||void 0===r?void 0:r.showMasterSp;if(!a||!o||!l)return[];var c=[];return a.forEach((function(e){var t,n=(null===(t=i.slideEditor.getStableLayerService())||void 0===t?void 0:t.container)||{},r=n.x,a=void 0===r?0:r,o=n.y,l=void 0===o?0:o,s=i.services.editAreaCanvasSizeManager.getCanvasSize().scale,u=a*s,d=l*s,p=new z(i.services,e,u,d);c.push(p)})),c}},{key:"layoutShapeRendererCollection",get:function(){var e,t,n=this,r=null===(e=this.slideEditor.getLayoutAppService())||void 0===e?void 0:e.getComponent().children,i=null===(t=this.slideEditor.slide)||void 0===t?void 0:t.showMasterSp;if(!r||!i)return[];var a=[];return r.forEach((function(e){var t,r=(null===(t=n.slideEditor.getStableLayerService())||void 0===t?void 0:t.container)||{},i=r.x,o=void 0===i?0:i,l=r.y,c=void 0===l?0:l,s=n.services.editAreaCanvasSizeManager.getCanvasSize().scale,u=o*s,d=c*s,p=new z(n.services,e,u,d);a.push(p)})),a}},{key:"updateSlideEditorSize",value:function(){var e,t,n,r,i,a,o,l,c,s,u,d,p=this.services.uiDataService.presentation.props,h=p.slideWidth,f=p.slideHeight,m=this.services.editAreaCanvasSizeManager.getCanvasSize().scale;this.slideEditor.updateInfo(m,{width:h,height:f},{width:h,height:f}),null===(e=this.slideEditor.getBackgroundAppService())||void 0===e||null===(t=e.updateWithData)||void 0===t||t.call(e,m),null===(n=this.slideEditor.getMasterAppService())||void 0===n||null===(r=n.updateWithData)||void 0===r||r.call(n,m),null===(i=this.slideEditor.getLayoutAppService())||void 0===i||null===(a=i.updateWithData)||void 0===a||a.call(i,m),null===(o=(l=this.slideEditor).getStableLayerService)||void 0===o||null===(c=o.call(l))||void 0===c||c.updateInfo(m),null===(s=(u=this.slideEditor).getStableLayerService)||void 0===s||null===(d=s.call(u))||void 0===d||d.render({slideModel:this.slideEditor.slide,masterModel:this.slideEditor.slide.getRelationMasterModel(),layoutModel:this.slideEditor.slide.getRelationLayoutModel()}),this.slideEditor.mountSlide()}},{key:"renderStableLayer",value:(n=o()(f.a.mark((function e(t){var n,r,i,a,o,l,c,s,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.slideEditor.getBackgroundAppService())||void 0===n?void 0:n.ensureRenderComplete();case 2:return e.next=4,null===(r=this.slideEditor.getMasterAppService())||void 0===r?void 0:r.ensureRenderComplete();case 4:return e.next=6,null===(i=this.slideEditor.getLayoutAppService())||void 0===i?void 0:i.ensureRenderComplete();case 6:null==(a=this.slideEditor.getStableLayerService())||a.render({slideModel:this.slideEditor.slide,masterModel:this.slideEditor.slide.getRelationMasterModel(),layoutModel:this.slideEditor.slide.getRelationLayoutModel()}),(o=null==a?void 0:a.getApplication().view)&&t.drawCanvas(o,-(null!==(l=null==a||null===(c=a.container)||void 0===c?void 0:c.x)&&void 0!==l?l:0),-(null!==(s=null==a||null===(u=a.container)||void 0===u?void 0:u.y)&&void 0!==s?s:0));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"renderSlideComponent",value:(t=o()(f.a.mark((function e(t){var n,r,i,a,o,l,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.services.editAreaCanvasSizeManager.getCanvasSize(),o=a.slideLeft,l=a.slideTop,c=null===(n=this.slideEditor)||void 0===n?void 0:n.slideComponent){e.next=4;break}return e.abrupt("return");case 4:return w((null==c||null===(r=c.elementsLayer)||void 0===r?void 0:r.children)||[],!0),e.next=7,c.ensureRenderComplete();case 7:t.drawCanvas(this.slideEditor.application.view,-o,-l),w((null==c||null===(i=c.elementsLayer)||void 0===i?void 0:i.children)||[]),this.slideEditor.application.requestRender();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),P=n("37091e4240");function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(){function e(){var t=this;c()(this,e),p()(this,"services",void 0),p()(this,"serviceReadyResolve",void 0),p()(this,"servicesReady",new Promise((function(e){return t.serviceReadyResolve=e}))),p()(this,"setServiceDelegates",(function(e){t.services=F(F({},t.services),e),t.serviceReadyResolve()}))}var t,n,r,a;return u()(e,[{key:"ensurePageReady",value:(a=o()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.servicesReady;case 2:return e.next=4,this.services.slideRenderStateManager.getVisiblePageDisplayPromise();case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"collectData",value:(r=o()(f.a.mark((function e(t){var n,r,i,a,o,l,c,s,u,d,p,h;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.pageSetUp,r=n.slideWidth,i=n.slideHeight,a=[],e.next=4,this.getSlideRendererCollection();case 4:o=e.sent,l=D(o),e.prev=6,l.s();case 8:if((c=l.n()).done){e.next=17;break}return s=c.value,e.t0=a,e.next=13,s.collectData();case 13:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(6),l.e(e.t2);case 22:return e.prev=22,l.f(),e.finish(22);case 25:u=[],d=D(o),e.prev=27,d.s();case 29:if((p=d.n()).done){e.next=38;break}return h=p.value,e.t3=u,e.next=34,h.collectImage(t);case 34:e.t4=e.sent,e.t3.push.call(e.t3,e.t4);case 36:e.next=29;break;case 38:e.next=43;break;case 40:e.prev=40,e.t5=e.catch(27),d.e(e.t5);case 43:return e.prev=43,d.f(),e.finish(43);case 46:return e.abrupt("return",{presentation:{slideWidth:Object(x.J)(r),slideHeight:Object(x.J)(i),count:a.length},slides:a,images:u});case 47:case"end":return e.stop()}}),e,this,[[6,19,22,25],[27,40,43,46]])}))),function(e){return r.apply(this,arguments)})},{key:"pageSetUp",get:function(){var e,t=i()(this.services.uiDataService.presentation.children,1)[0],n=this.services.uiDataService.presentation.props,r=n.slideWidth,a=n.slideHeight,o=this.services.editAreaCanvasSizeManager.getCanvasSize().scale,l={slideWidth:Math.round(r*o),slideHeight:Math.round(a*o)};if(!t)return l;var c=null===(e=this.services.pcEditorAreaService.forceBuildSlideSync(t).getBackgroundAppService())||void 0===e?void 0:e.getComponent();return c?{slideWidth:Math.round(c.worldBounds.width),slideHeight:Math.round(c.worldBounds.height)}:l}},{key:"slides",get:function(){return this.services.uiDataService.presentation.children}},{key:"getSlideRendererCollection",value:(n=o()(f.a.mark((function e(){var t,n,r,i,a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.services.slideRenderStateManager.isAllSlideConvertComplete){e.next=3;break}return e.next=3,this.allSlideDataConvert();case 3:t=[],n=D(this.slides),e.prev=5,i=f.a.mark((function e(){var n,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.value,e.next=3,new Promise((function(e){n.sdkData.waitForLoading((function(){return e(!0)}))}));case 3:if(n.childrenConverted){e.next=6;break}return e.next=6,n.startConvertChildrenTask(1/0);case 6:if(n.getRelationMasterModel().childrenConverted){e.next=9;break}return e.next=9,n.getRelationMasterModel().startConvertChildrenTask(1/0);case 9:if(n.getRelationLayoutModel().childrenConverted){e.next=12;break}return e.next=12,n.getRelationLayoutModel().startConvertChildrenTask(1/0);case 12:i=a.services.pcEditorAreaService.forceBuildSlideSync(n),o=new j(a.services,i),t.push(o);case 15:case"end":return e.stop()}}),e)})),n.s();case 8:if((r=n.n()).done){e.next=12;break}return e.delegateYield(i(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5),n.e(e.t1);case 17:return e.prev=17,n.f(),e.finish(17);case 20:return e.abrupt("return",t);case 21:case"end":return e.stop()}}),e,this,[[5,14,17,20]])}))),function(){return n.apply(this,arguments)})},{key:"setPageScale",value:(t=o()(f.a.mark((function e(){var t,n=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,this.services.editAreaCanvasSizeManager.setCanvasScaleAndIsAutoAdapter(Object(x.j)(t),!1),window.dispatchEvent(new CustomEvent("resize",{detail:{countSizeAgain:!0}})),e.next=5,new Promise((function(e){return setTimeout(e)}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"allSlideDataConvert",value:function(){return new Promise((function(e){P.b.once(P.a.ALL_SLIDE_DATA_CONVERT,(function(){e(!0)}))}))}}]),e}()},"94447f525f":function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnPgogICAgICAgIDxjaXJjbGUgY3g9IjYiIGN5PSI2IiByPSI2IiBmaWxsPSIjRkY0NzQ3IiBzdHlsZT0iZmlsbDojRkY0NzQ3O2ZpbGw6Y29sb3IoZGlzcGxheS1wMyAxLjAwMDAgMC4yNzg0IDAuMjc4NCk7ZmlsbC1vcGFjaXR5OjE7Ii8+CiAgICAgICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDIuMzMzMzFINUw1LjMzMzMzIDYuOTk5OThINi42NjY2N0w3IDIuMzMzMzFaTTYgOS42NjY2N0M2LjU1MjI4IDkuNjY2NjcgNyA5LjIxODk1IDcgOC42NjY2N0M3IDguMTE0MzggNi41NTIyOCA3LjY2NjY3IDYgNy42NjY2N0M1LjQ0NzcyIDcuNjY2NjcgNSA4LjExNDM4IDUgOC42NjY2N0M1IDkuMjE4OTUgNS40NDc3MiA5LjY2NjY3IDYgOS42NjY2N1oiIGZpbGw9IndoaXRlIiBzdHlsZT0iZmlsbDp3aGl0ZTtmaWxsLW9wYWNpdHk6MTsiLz4KICAgIDwvZz4KPC9zdmc+Cg=="},"960b6aae64":function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var r,i=n("176815363d"),a=n.n(i),o=n("9132715560"),l=n.n(o),c=n("6a364eb35c"),s=n.n(c),u=n("85d0a7609b"),d=n.n(u),p=n("3ef2352f0b"),h=n.n(p),f=(n("c6244f7705"),n("081c8cafea"),n("826dc923b3"),n("8ee19818c4"),n("1bab7b5fb7"),n("9d7978d445"),n("85d48ef22b"),n("8e7cce0ada"),n("2a6f332b5e"),n("963f2eaace"),n("b1e2246d82"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287"),n("2a5f3314a4")),m=n("3344f1a2e7"),v=n("44cf80cf4d"),g=(n("63513d8b56"),n("75d6c5598b")),b=n("9657b29818"),y=n("8400f5339c"),x=n("f2b6d66c40"),w=n("d3d31c86eb"),S=n("9da6335152");!function(e){e[e.Title=0]="Title",e[e.SubTitle=1]="SubTitle"}(r||(r={}));var k=function(){function e(t,n,i,a){var o=this;l()(this,e),d()(this,"analyzerName",void 0),d()(this,"description",void 0),d()(this,"resultInfo",void 0),d()(this,"resultType",void 0),d()(this,"minSize",void 0),d()(this,"simplifyResultInfo",[]),d()(this,"showResult",[]),d()(this,"handleItemClick",(function(e){var t,n,i=o.simplifyResultInfo[e];if(null!==(t=o.showResult[e].selectSlide)&&void 0!==t&&t.sdkData&&null!==(n=o.showResult[e].selectElement)&&void 0!==n&&n.sdkData){Object(b.b)((function(){for(var e=[],t=i.startIndex;t<=i.endIndex;t++){var n=o.resultInfo[t],r=o.prepareParagraphListPath(n);r&&e.push(r)}var a=o.resultInfo[i.startIndex].element;if(null!=a&&a.paragraphList){var l=Object(g.c)(a.paragraphList,{fontSize:o.minSize},e);l.length>0&&a.updateParagraphList(l)}}));var a=S.b.BEAUTIFY_TITLE_SIZE;o.type===r.SubTitle&&(a=S.b.BEAUTIFY_SUBTITLE_SIZA),Object(w.c)({opername:S.e.DOC_PPT,module:S.d.AUTO_BEAUTIFY,action:a})}o.removeOneResult(e)})),this.type=a,this.analyzerName=t,this.description=n,this.reset(),this.minSize=i}return s()(e,[{key:"reset",value:function(){this.resultType=v.a.SUCCESS,this.resultInfo=[],this.simplifyResultInfo=[],this.showResult=[]}},{key:"onPresentationEnd",value:function(){this.simplifyResult()}},{key:"getShowResult",value:function(){return this.showResult}},{key:"getDescriptionWithSelect",value:function(){if(this.resultType!==v.a.SUCCESS){if(this.showResult.length>0)return this.showResult;for(var e=[],t=0;t<this.simplifyResultInfo.length;t++){var n=this.simplifyResultInfo[t],r=this.resultInfo[n.startIndex],i=x.default.t("第{0}页的 '{1}' 字号小于{2}",{0:r.slideNode.slideIndex+1,1:n.text,2:this.minSize});e.push({description:i,selectable:!0,selectSlide:r.slideNode.slide,selectElement:r.element,handleProblem:this.handleItemClick})}return this.showResult=e,e}}},{key:"simplifyResult",value:function(){var e=this,t=[],n=void 0,r=0,i="",a=-1;this.resultInfo.forEach((function(o,l){n&&n.textBox.parentBox===o.textBox.parentBox&&n.textBox.nextSibling===o.textBox?(n=o,i+=o.textBox.text,l===e.resultInfo.length-1&&t.push({text:i,startIndex:r,endIndex:l})):(l>0&&n&&t.push({text:i,startIndex:r,endIndex:l-1}),(Object(y.b)(o.textBox.text)||-1===a)&&(a=l),-1!==a&&(r=l,n=o,i=o.textBox.text,l===e.resultInfo.length-1&&t.push({text:i,startIndex:r,endIndex:l})))})),this.simplifyResultInfo=t,0===t.length&&(this.resultType=v.a.SUCCESS)}},{key:"removeOneResult",value:function(e){this.simplifyResultInfo.splice(e,1),this.showResult.splice(e,1),0===this.showResult.length&&(this.resultType=v.a.SUCCESS)}},{key:"prepareParagraphListPath",value:function(e){var t,n;return null===(t=e.textBox.textStyle)||void 0===t||null===(n=t.getCustomizeProp)||void 0===n?void 0:n.call(t,"slatePath")}}]),e}(),C=(n("c9a7ecac4d"),n("5fac0349d3")),E=function(){function e(t,n,r){l()(this,e),d()(this,"analyzerName",void 0),d()(this,"description",void 0),d()(this,"resultInfo",void 0),d()(this,"resultType",void 0),d()(this,"eaFontSet",new Set),d()(this,"latinFontSet",new Set),this.showUniformFontUI=r,this.analyzerName=t,this.description=n,this.resultType=v.a.SUCCESS}return s()(e,[{key:"reset",value:function(){this.resultType=v.a.SUCCESS,this.eaFontSet.clear(),this.latinFontSet.clear()}},{key:"getDescriptionWithSelect",value:function(){if(this.resultType!==v.a.SUCCESS)return[{description:C.a.t("共使用了{0}种字体，建议不超过4种",{0:this.resultInfo}),selectable:!1}]}},{key:"handleProblem",value:function(e,t){this.showUniformFontUI(e,t)}}]),e}(),I=function(){function e(t,n,r){var i=this;l()(this,e),d()(this,"analyzerName",void 0),d()(this,"description",void 0),d()(this,"resultInfo",void 0),d()(this,"resultType",void 0),d()(this,"lineAnalyzerLastParaBox",void 0),d()(this,"lastLineLength",void 0),d()(this,"lastLineFont",0),d()(this,"minSize",void 0),d()(this,"showResult",[]),d()(this,"handleItemClick",(function(e){var t,n;if(null!==(t=i.showResult[e].selectSlide)&&void 0!==t&&t.sdkData&&null!==(n=i.showResult[e].selectElement)&&void 0!==n&&n.sdkData){var r=i.resultInfo[e],a=i.prepareParagraphList(r);r.element.updateParagraphList(a),Object(w.c)({opername:S.e.DOC_PPT,module:S.d.AUTO_BEAUTIFY,action:S.b.BEAUTIFY_LINE_SPACE})}i.removeOneResult(e)})),this.analyzerName=t,this.description=n,this.reset(),this.minSize=r}return s()(e,[{key:"reset",value:function(){this.resultType=v.a.SUCCESS,this.resultInfo=[],this.showResult=[],this.lastLineLength=0,this.lineAnalyzerLastParaBox=void 0}},{key:"getDescriptionWithSelect",value:function(){if(this.resultType!==v.a.SUCCESS){if(this.showResult.length>0)return this.showResult;for(var e=[],t=0;t<this.resultInfo.length;t++){for(var n,r=this.resultInfo[t],i="",a=0;a<r.paraBox.children[0].children.length;a++){var o,l=null===(o=r.paraBox.children[0].children[a])||void 0===o?void 0:o.text;if(Object(y.b)(l)&&(i+=l).length>2)break}var c=C.a.t("第{0}页'{1}'开头的文字段落行间距小于1.2倍",{0:r.slideNode.slideIndex+1,1:null===(n=i)||void 0===n?void 0:n.substring(0,5)});e.push({description:c,selectable:!0,selectSlide:r.slideNode.slide,selectElement:r.element,handleProblem:this.handleItemClick})}return this.showResult=e,e}}},{key:"removeOneResult",value:function(e){this.resultInfo.splice(e,1),this.showResult.splice(e,1),0===this.showResult.length&&(this.resultType=v.a.SUCCESS)}},{key:"prepareParagraphList",value:function(e){var t=e.element;if(!t.paragraphList)return[];var n=this.getParagraphIndexFromBox(e.paraBox);return Object(g.a)(t.paragraphList,{PPTLineHeight:this.minSize,lineHeight:this.minSize*m.d,lineHeightIs:"percent"},[n])}},{key:"getParagraphIndexFromBox",value:function(e){for(var t,n,r=e;r.children&&r.children.length>0&&(r=r.lastChild).kind!==f.b.Text;);var i=null===(t=r.textStyle)||void 0===t||null===(n=t.getCustomizeProp)||void 0===n?void 0:n.call(t,"slatePath");return(null==i?void 0:i[0])||0}}]),e}(),T=(n("342844cefa"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36"),n("29f8c5f672"),n("eb9e932508"),n("7256a710c8")),R=n("43a52c98ef"),M=n("e0e8dd9366"),O=n("7b0ebf3e1a");function N(e,t){var n=e.x,r=e.y,i=e.width,a=e.height,o=t.x,l=t.y,c=t.width,s=t.height;return n-(o+c)<1e-4&&n+i-o>1e-4&&r-(l+s)<1e-4&&r+a-l>1e-4}var L=n("2ba7871556"),z=n("c9c92622ff"),j=n("780d9b3b59");function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(){function e(t,n){var r=this;l()(this,e),d()(this,"resultInfo",void 0),d()(this,"resultType",void 0),d()(this,"analyzerName",void 0),d()(this,"description",void 0),d()(this,"textQuadtree",void 0),d()(this,"currentSlideIndex",void 0),d()(this,"presentation",void 0),d()(this,"changedElementMap",void 0),d()(this,"showResult",[]),d()(this,"handleItemClick",(function(e){var t,n;if(null!==(t=r.showResult[e].selectSlide)&&void 0!==t&&t.sdkData&&null!==(n=r.showResult[e].selectElement)&&void 0!==n&&n.sdkData){var i=r.resultInfo[e],a=i.textNodeRect.data.element;if(r.changedElementMap.get(a))return j.c.getInstance().show({message:C.a.t("元素位置已被调整，可重新检测验证调整结果"),commonTipsType:j.b.INFO,block:!1,autoClose:!0}),void r.removeOneResult(e);var o=r.getToUpdateFrame(i);Object(b.b)((function(){Object(z.j)(a)&&(a.getFrame().updateFrame({frame:o}),r.changedElementMap.set(a,!0))})),Object(w.c)({opername:S.e.DOC_PPT,module:S.d.AUTO_BEAUTIFY,action:S.b.BEAUTIFY_TEXT_OVERLAP})}r.removeOneResult(e)})),this.analyzerName=t,this.description=n,this.reset()}return s()(e,[{key:"resetWithPresentation",value:function(e){this.reset(),this.presentation=e,this.textQuadtree=new T.a({width:this.presentation.props.slideWidth,height:this.presentation.props.slideHeight})}},{key:"onSlideEnd",value:function(e){var t;null===(t=this.textQuadtree)||void 0===t||t.clear()}},{key:"getDescriptionWithSelect",value:function(){if(this.resultType!==v.a.SUCCESS){if(this.showResult.length>0)return this.showResult;for(var e=[],t=0;t<this.resultInfo.length;t++){var n=this.resultInfo[t].textNodeRect.data,r=n.textBox,i=n.slideNode.slideIndex,a=C.a.t("第{0}页'{1}'存在和其他文本重叠情况",{0:i+1,1:r.text});e.push({description:a,selectable:!0,selectSlide:n.slideNode.slide,selectElement:n.element,handleProblem:this.handleItemClick})}return this.showResult=e,e}}},{key:"reset",value:function(){var e;this.resultInfo=[],this.showResult=[],this.resultType=v.a.SUCCESS,null===(e=this.textQuadtree)||void 0===e||e.clear(),this.changedElementMap=new Map}},{key:"checkNewElement",value:function(e){var t=e.element,n=t.getFrame().frameOnSlide(),r=n;void 0!==n.rotate&&0!==n.rotate&&(!0,r=Object(O.j)(n,n.rotate));var i=new R.a({x:r.left,y:r.top,width:r.width,height:r.height});if(t.type===M.d.SHAPE){var a=t.getBackgroundFill().getShownFillType();if(void 0===a||a===L.b.NoFill)return;this.checkToDeleteTextRects(i)}else t.type!==M.d.IMAGE&&t.type!==M.d.TABLE&&t.type!==M.d.CHART||this.checkToDeleteTextRects(i)}},{key:"checkNewTextElementBoxNode",value:function(e){var t,n,r;e.slideNode.slideIndex!==this.currentSlideIndex&&(this.currentSlideIndex=e.slideNode.slideIndex,null===(r=this.textQuadtree)||void 0===r||r.clear());if(!this.checkNeedFilter(e)){var i=this.getActualRectFromTextBox(e.textBox),a=Object(y.a)(e.textBox),o=e.element.getFrame().frameOnSlide();if(void 0===o.rotate||0===o.rotate){var l={left:Object(f.u)(a.x)+i.x+o.left,top:Object(f.u)(a.y)+i.y+o.top,width:i.width,height:i.height},c=new R.a({x:l.left,y:l.top,width:Math.floor(l.width),height:Math.floor(l.height)}),s=null===(t=this.textQuadtree)||void 0===t?void 0:t.retrieve(c),u=new R.a(D(D({},c),{},{data:e}));this.checkTextAndBackRects(u,s),null===(n=this.textQuadtree)||void 0===n||n.insert(u)}}}},{key:"checkTextAndBackRects",value:function(e,t){for(var n=t.sort((function(e,t){for(var n=e.data.path,r=t.data.path,i=r.length,a=0;a<n.length;a++){if(i<a)return 1;if(n[a]!==r[a])return r[a]-n[a]}for(var o=e.data.textBoxPath,l=t.data.textBoxPath,c=l.length,s=0;s<o.length;s++){if(c<s)return 1;if(o[s]!==l[s])return l[s]-o[s]}return 0})),r=0;r<n.length;r++)if(e.data.element!==n[r].data.element&&N(e,n[r]))return this.resultType=v.a.ERROR,this.resultInfo.push({textNodeRect:e,backNodeRect:n[r],sortedRects:n}),!0;return!1}},{key:"checkNeedFilter",value:function(e){var t,n;if(e.element.type===M.d.CHART)return!0;if(!Object(y.b)(e.textBox.text))return!0;if("transparent"!==e.textBox.textStyle.textBackground)return!0;var r=e.element.getBackgroundFill(),i=null==r?void 0:r.getShownFillType();if(i!==L.b.NoFill&&void 0!==i)return!0;var a=null===(t=e.textBox.textStyle)||void 0===t||null===(n=t.getCustomizeProp)||void 0===n?void 0:n.call(t,"slatePath");if(a){var o=e.textDocumentElement.children[a[0]].children[a[1]];if(o.noFill&&!o.border)return!0}return!1}},{key:"getActualRectFromTextBox",value:function(e){var t=e.rect,n=e.glyphs,r=new R.a({x:0,y:0,width:0,height:0}),i=!0;if(n)for(var a=0;a<n.length;a++){var o=n[a].textMetrics;if(void 0===(null==o?void 0:o.actualBoundingBoxAscent)){i=!1;break}var l=Object(f.u)(null==n?void 0:n[a].ascent)-o.actualBoundingBoxAscent,c=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent;a===n.length-1?r.width+=o.actualBoundingBoxRight:r.width+=o.width,0===a?(r.y=l,r.height=c,r.x=-o.actualBoundingBoxLeft,r.width-=r.x):(r.y=Math.min(r.y,l),r.height=Math.max(r.height,c))}var s=e.rotate;return void 0!==s&&(r=this.getRectAfterRotate(r,s,t)),i||(90===s||270===s?(r.x=Object(f.u)(.1*t.width),r.width=Object(f.u)(.8*t.width),r.height=Object(f.u)(t.height)):(r.y=Object(f.u)(.1*t.height),r.width=Object(f.u)(t.width),r.height=Object(f.u)(.8*t.height))),r}},{key:"getRectAfterRotate",value:function(e,t,n){return 90===t?new R.a({x:Object(f.u)(n.width)-e.y-e.height,y:e.x,width:e.height,height:e.width}):270===t?new R.a({x:e.y,y:Object(f.u)(n.height)-e.x-e.width,width:e.height,height:e.width}):e}},{key:"removeOneResult",value:function(e){this.resultInfo.splice(e,1),this.showResult.splice(e,1),0===this.showResult.length&&(this.resultType=v.a.SUCCESS)}},{key:"getToUpdateFrame",value:function(e){var t,n=e.textNodeRect,r=e.backNodeRect,i=r.data.element.getFrame().frameOnSlide(),a={x:0,y:0},o=Math.ceil(r.x+Math.max(r.width,i.width)-n.x);if(o>-1&&o+n.width+n.x<=this.presentation.props.slideWidth+1&&(a.x=o),0===a.x){var l=Math.ceil(r.y+Math.max(r.height,i.height)-n.y);l>-1&&l+n.height+n.y<=this.presentation.props.slideHeight+1&&(a.y=l)}0===a.x&&0===a.y&&(a.x=o);var c=e.textNodeRect.data.element,s=c.getFrame().getFrameInfo();if((null===(t=c.parent)||void 0===t?void 0:t.type)===M.d.GROUP){var u=c.parent.getFrame().getScaleRelativeToSlide();return{left:s.left+a.x*u.scaleX,top:s.top+a.y*u.scaleY}}return{left:s.left+a.x,top:s.top+a.y}}},{key:"checkToDeleteTextRects",value:function(e){var t,n=this,r=null===(t=this.textQuadtree)||void 0===t?void 0:t.retrieve(e);null==r||r.forEach((function(t){var r;N(e,t)&&(null===(r=n.textQuadtree)||void 0===r||r.remove(t))}))}}]),e}(),B=n("14c02e2331");function F(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var W,U=function(){function e(t,n){l()(this,e),d()(this,"titleFontSizeResult",void 0),d()(this,"subTitleFontSizeResult",void 0),d()(this,"lineSpacingResult",void 0),d()(this,"fontUseNumberResult",void 0),d()(this,"textOverlapResult",void 0),d()(this,"presentation",void 0),this.titleFontSizeResult=new k(C.a.t("标题字号检测"),C.a.t("建议不小于24号"),24,r.Title),this.subTitleFontSizeResult=new k(C.a.t("副标题字号检测"),C.a.t("建议不小于20号"),20,r.SubTitle),this.lineSpacingResult=new I(C.a.t("行间距检测"),C.a.t("建议不小于1.2倍"),1.2),t||(this.fontUseNumberResult=new E(C.a.t("使用字体数量检测"),C.a.t("建议不超过4个"),n)),this.textOverlapResult=new A(C.a.t("文字重叠检测"),C.a.t("建议文字之间没有重叠区域"))}return s()(e,[{key:"onEnumeratePresentationEnd",value:function(){this.titleFontSizeResult.onPresentationEnd(),this.subTitleFontSizeResult.onPresentationEnd()}},{key:"onSlideEnd",value:function(e){this.textOverlapResult.onSlideEnd(e)}},{key:"analysisFontSize",value:function(e){var t=e.element,n=e.textBox;if(!!!n.isListMark){var r,i=n.textStyle,a=Object(f.u)(i.fontSize)/B.p;if(t.isPlaceholder)if(t.isCtrTitlePl){if(a<this.titleFontSizeResult.minSize)this.titleFontSizeResult.resultType=v.a.ERROR,null===(r=this.titleFontSizeResult.resultInfo)||void 0===r||r.push(e)}else if(t.isTitleOrCtrTitlePl||t.isSubTitlePl){var o;if(a<this.subTitleFontSizeResult.minSize)this.subTitleFontSizeResult.resultType=v.a.ERROR,null===(o=this.subTitleFontSizeResult.resultInfo)||void 0===o||o.push(e)}}}},{key:"analysisTextOverlapOfElement",value:function(e){this.textOverlapResult.checkNewElement(e)}},{key:"analysisTextOverlapOfTextBox",value:function(e){this.textOverlapResult.checkNewTextElementBoxNode(e)}},{key:"analysisLineSpacing",value:function(e){var t=e.textBoxPath[e.textBoxPath.length-1],n=e.paraBox,r=e.textDocumentElement;if(this.checkParagraphLineContent(n,t,e)){var i,a=r.children[t];if(void 0===a.lineSpacingRule||a.lineSpacingRule===f.i.Multiple)if(Number(a.lineSpacing)/m.d<this.lineSpacingResult.minSize)this.lineSpacingResult.resultType=v.a.ERROR,null===(i=this.lineSpacingResult.resultInfo)||void 0===i||i.push(e)}}},{key:"analysisTextDocument",value:function(e){var t=this;e.children.forEach((function(e){e.children.forEach((function(e){var n,r=null===(n=e.fontFamily)||void 0===n?void 0:n.split(",")[0];if(r){var i,a,o,l,c,s,u;if(o='"微软雅黑"'===r||'"Microsoft YaHei"'===r?"微软雅黑":'"宋体"'===r||'"SimSun"'===r||'"Songti SC"'===r?"宋体":'"SimHei"'===r||'"Heiti SC"'===r?"SimHei":'"KaiTi"'===r||'"KaiTi SC"'===r?"KaiTi":r,!e.lang||"ea"===e.lang.toLowerCase())null===(l=t.fontUseNumberResult)||void 0===l||l.eaFontSet.add(o);if(!e.lang||"latin"===e.lang.toLowerCase())null===(c=t.fontUseNumberResult)||void 0===c||c.latinFontSet.add(o);if(t.fontUseNumberResult&&((null===(i=t.fontUseNumberResult)||void 0===i?void 0:i.eaFontSet.size)>4||(null===(a=t.fontUseNumberResult)||void 0===a?void 0:a.latinFontSet.size)>4))t.fontUseNumberResult.resultType=v.a.ERROR,t.fontUseNumberResult.resultInfo=Math.max(null===(s=t.fontUseNumberResult)||void 0===s?void 0:s.eaFontSet.size,null===(u=t.fontUseNumberResult)||void 0===u?void 0:u.latinFontSet.size)}}))}))}},{key:"resetWithPresentation",value:function(e){var t;this.presentation=e,this.titleFontSizeResult.reset(),this.subTitleFontSizeResult.reset(),this.lineSpacingResult.reset(),null===(t=this.fontUseNumberResult)||void 0===t||t.reset(),this.textOverlapResult.resetWithPresentation(e)}},{key:"checkParagraphLineContent",value:function(e,t,n){var r;(null===(r=this.lineSpacingResult.lineAnalyzerLastParaBox)||void 0===r?void 0:r.parentBox)!==e.parentBox&&(this.lineSpacingResult.lastLineLength=0),this.lineSpacingResult.lineAnalyzerLastParaBox=e;var i,a=F(e.children);try{for(a.s();!(i=a.n()).done;){var o,l=i.value,c=0,s=0,u=F(l.children);try{for(u.s();!(o=u.n()).done;){var d=o.value;if(c+=d.text.length,!!d.isListMark)c=0;else{var p=d.textStyle,h=Object(f.u)(p.fontSize)/B.p;if(0===s?s=h:s!==h&&(s=-1),h>30)return c=0,!1}}}catch(e){u.e(e)}finally{u.f()}if(this.lineSpacingResult.lastLineLength>3&&c>3&&this.lineSpacingResult.lastLineFont===s&&-1!==s&&0!==s)return!0;this.lineSpacingResult.lastLineLength=c,this.lineSpacingResult.lastLineFont=s}}catch(e){a.e(e)}finally{a.f()}return!1}}]),e}();n("f84436e584");!function(e){e[e.SLIDE_BACKGROUND=0]="SLIDE_BACKGROUND",e[e.ELEMENT=1]="ELEMENT",e[e.TEXT_BACK=2]="TEXT_BACK"}(W||(W={}));var G,V="UNKNOWN_COLOR";!function(e){e[e.small=0]="small",e[e.normal=1]="normal",e[e.larger=2]="larger",e[e.largest=3]="largest"}(G||(G={}));var Z=n("5e80ef0880"),_=n.n(Z),Y=(n("a2a09da1e3"),n("75f19a1449")),X=n("1d0dc9eef2"),K=function(){function e(t,n){var r=this;l()(this,e),d()(this,"analyzerName",void 0),d()(this,"description",void 0),d()(this,"resultInfo",void 0),d()(this,"resultType",void 0),d()(this,"showResult",[]),d()(this,"handleItemClick",(function(e){var t,n;if(null!==(t=r.showResult[e].selectSlide)&&void 0!==t&&t.sdkData&&null!==(n=r.showResult[e].selectElement)&&void 0!==n&&n.sdkData){var i=r.showResult[e].contrastInfo,a=i.textColor,o=i.textBack.color;if(o===V)return;var l,c=r.getCompareRatioOfRule(i.contrastRule),s=a.hsl().array(),u=s[2],d=o.hsl().array(),p=d[2],h=i.contrast;u>p?(l=(u||1)*c/h)/p<c&&(l=p*c):p/(l=(u||1)*h/c)<c&&(l=p/c);var f=new _.a([s[0],s[1],l],"hsl").rgb(),m=r.getColorsContrast(f,o);if(p<10&&m<c&&(f=new _.a([255,255,255]),m=r.getColorsContrast(f,o)),l<=100&&l>=0&&m>=c){var v=r.prepareTextColorParagraphList(i,new Y.a({rgbaStr:f.string()}),e);if(v.length<=0)return;i.boxNode.element.updateParagraphList(v)}else{var g;if(u>p?u/(g=(p||1)*h/c)<c&&(g=u/c):(g=(p||1)*c/h)/u<c&&(g=u*c),g<0||g>100)return;var b=new _.a([d[0],d[1],g],"hsl").rgb();r.updateTextBackColor(i,b,e)}Object(w.c)({opername:S.e.DOC_PPT,module:S.d.AUTO_BEAUTIFY,action:S.b.BEAUTIFY_CONTRAST})}r.removeOneResult(e)})),this.analyzerName=t,this.description=n,this.reset()}return s()(e,[{key:"getShowResult",value:function(){return this.showResult}},{key:"reset",value:function(){this.resultType=v.a.SUCCESS,this.resultInfo=[],this.showResult=[]}},{key:"getCompareRatioAndRule",value:function(e){var t=2.8,n=G.normal;return e<18?(t=3.5,n=G.small):e<50?(t=2.8,n=G.normal):e<100?(t=2,n=G.larger):(t=1.5,n=G.largest),{ratio:t,rule:n}}},{key:"getCompareRatioOfRule",value:function(e){switch(e){case G.normal:return 2.8;case G.small:return 3.5;case G.larger:return 2;case G.largest:return 1.5;default:return 2.8}}},{key:"getColorsContrast",value:function(e,t){var n=this.getColorRelativeLuminance(e),r=this.getColorRelativeLuminance(t);return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)}},{key:"getColorRelativeLuminance",value:function(e){var t,n,r;return t=e.red()/255,n=e.green()/255,r=e.blue()/255,.2126*(t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}},{key:"getDescriptionWithSelect",value:function(){if(this.resultType!==v.a.SUCCESS){if(this.showResult.length>0)return this.showResult;for(var e,t,n=[],r=-1,i=-1,a=-1,o="",l=void 0,c=0,s=0;s<this.resultInfo.length;s++){var u=this.resultInfo[s],d=u.boxNode.textBox,p=u.boxNode.slideNode.slideIndex,h=-1,f=d.parentBox;f&&(h=f.children.indexOf(d));var m,g,b=null==f?void 0:f.parentBox,x=-1;if(f&&b&&(x=b.children.indexOf(f)),0===s)o=d.text,l=u,c=0;else(f===e&&r+1===h||t===b&&i+1===x&&0===h&&r===e.children.length-1)&&l&&l.textBack.type===u.textBack.type&&(null===(m=l.textBack.color)||void 0===m?void 0:m.string())===(null===(g=u.textBack.color)||void 0===g?void 0:g.string())&&l.textColor.string()===u.textColor.string()?(o+=d.text,l=u):(o.length>0&&Object(y.b)(o)&&l&&n.push({description:this.getDescription(a+1,o),selectable:!0,selectSlide:l.boxNode.slideNode.slide,selectElement:l.boxNode.element,handleProblem:this.handleItemClick,contrastInfo:l,startIndex:c,endIndex:s-1}),c=s,o=d.text,l=u);a=p,r=h,e=f,t=b,i=x}return o.length>0&&Object(y.b)(o)&&l&&n.push({description:this.getDescription(a+1,o),selectSlide:l.boxNode.slideNode.slide,selectElement:l.boxNode.element,handleProblem:this.handleItemClick,contrastInfo:l,startIndex:c,selectable:!0,endIndex:this.resultInfo.length-1}),this.showResult=n,n}}},{key:"removeOneResult",value:function(e){this.showResult.splice(e,1),0===this.showResult.length&&(this.resultType=v.a.SUCCESS)}},{key:"updateTextBackColor",value:function(e,t,n){var r=new Y.a({rgbaStr:t.string()});if(e.textBack.type===W.SLIDE_BACKGROUND)e.boxNode.slideNode.slide.getBackgroundFill().updateCurrentFill({solidFill:new X.a(r)});else if(e.textBack.type===W.ELEMENT){e.textBack.elementNode.element.getBackgroundFill().updateCurrentFill({solidFill:new X.a(r)})}else if(e.textBack.type===W.TEXT_BACK){var i=this.prepareTextBackColorParagraphList(e,t,n);if(i.length<=0)return;e.boxNode.element.updateParagraphList(i)}}},{key:"getDescription",value:function(e,t){return C.a.t("第{0}页'{1}'和背景颜色对比度较低",{0:e,1:t})}},{key:"prepareTextColorParagraphList",value:function(e,t,n){var r=e.boxNode.element;if(!r.paragraphList)return[];for(var i=this.showResult[n],a=i.startIndex,o=i.endIndex,l=[],c=a;c<=o;c++){var s,u,d=null===(s=this.resultInfo[c].boxNode.textBox.textStyle)||void 0===s||null===(u=s.getCustomizeProp)||void 0===u?void 0:u.call(s,"slatePath");d&&l.push(d)}return l.length>0?Object(g.c)(r.paragraphList,{tdColor:t},l):[]}},{key:"prepareTextBackColorParagraphList",value:function(e,t,n){var r=e.boxNode.element;if(!r.paragraphList)return[];for(var i=this.showResult[n],a=i.startIndex,o=i.endIndex,l=[],c=a;c<=o;c++){var s,u,d=null===(s=this.resultInfo[c].boxNode.textBox.textStyle)||void 0===s||null===(u=s.getCustomizeProp)||void 0===u?void 0:u.call(s,"slatePath");d&&l.push(d)}return l.length>0?Object(g.c)(r.paragraphList,{backgroundColor:t.string()},l):[]}}]),e}(),J=function(){function e(){l()(this,e),d()(this,"textColorContrastResult",void 0),d()(this,"presentation",void 0),d()(this,"colorQuadtree",void 0),d()(this,"currentSlideIndex",void 0)}return s()(e,[{key:"resetWithPresentation",value:function(e){this.textColorContrastResult=new K(C.a.t("文字颜色对比度检测"),C.a.t("建议文字和背景颜色对比度更大些")),this.colorQuadtree=void 0,this.presentation=e}},{key:"analysisNewSlide",value:function(e,t){this.currentSlideIndex=t,this.initSlideQuadTree(e)}},{key:"analysisElement",value:function(e){var t=e.element,n=t.getFrame().frameOnSlide(),r=n,i=!1;void 0!==n.rotate&&0!==n.rotate&&(i=!0,r=Object(O.j)(n,n.rotate));var a={type:W.ELEMENT,elementNode:e,color:V},o=new R.a({x:r.left,y:r.top,width:r.width,height:r.height,data:a});if(t.type===M.d.SHAPE){var l,c=this.getColorFromFill(t.getBackgroundFill());if(c)i&&(c=V),a.color=c,null===(l=this.colorQuadtree)||void 0===l||l.insert(o)}else if(t.type===M.d.IMAGE||t.type===M.d.TABLE||t.type===M.d.CHART){var s;null===(s=this.colorQuadtree)||void 0===s||s.insert(o)}}},{key:"analysisTextElementBox",value:function(e){if(Object(y.b)(e.textBox.text)){var t=new _.a(e.textBox.textStyle.textColor);if(!(e.element.isDatePl||e.element.isFooterPl||e.element.isSlideNumPl||e.element.type===M.d.TABLE||e.element.type===M.d.CHART)&&t){var n=e.textBox.textStyle.textBackground;if(n&&"transparent"!==n){var r=new _.a(n),i={type:W.TEXT_BACK,textElementNode:e,color:r};this.checkColorContrast(t,new _.a(n),e,i)}else if(e.element.type===M.d.SHAPE)if(e.element.getBackgroundFill().getShownFillType()===L.b.SolidFill){var a=this.getColorFromFill(e.element.getBackgroundFill()),o={type:W.ELEMENT,elementNode:e,color:a};this.checkColorContrast(t,a,e,o)}else{var l,c=e.textBox.rect,s=Object(y.a)(e.textBox),u=e.element.getFrame().frameOnSlide(),d={left:Object(f.u)(s.x)+u.left,top:Object(f.u)(s.y)+u.top,width:Object(f.u)(c.width),height:Object(f.u)(c.height)};if(void 0!==u.rotate&&0!==u.rotate){var p={x:u.left+u.width/2,y:u.top+u.height/2};d=Object(O.w)(d,p,u.rotate)}var h=new R.a({x:d.left,y:d.top,width:d.width,height:d.height}),m=null===(l=this.colorQuadtree)||void 0===l?void 0:l.retrieve(h);this.checkTextAndBackRects(h,t,m,e)}}}}},{key:"checkTextAndBackRects",value:function(e,t,n,r){for(var i=n.sort((function(e,t){var n=e.data,r=t.data;if(n.type===r.type){if(n.type===W.ELEMENT)for(var i=n.elementNode.path,a=r.elementNode.path,o=a.length,l=0;l<i.length;l++){if(o<l)return 1;if(i[l]!==a[l])return a[l]-i[l]}return r.type-n.type}return r.type-n.type})),a=0;a<i.length;a++)if(N(e,i[a])){var o=Math.max(e.x,i[a].x),l=Math.max(e.y,i[a].y),c=Math.min(e.x+e.width,i[a].x+i[a].width),s=Math.min(e.y+e.height,i[a].y+i[a].height);if(o<c&&l<s){var u=s-l;if(c-o<e.width/r.textBox.text.length)continue;if(u<e.height/10)continue}var d=i[a].data;d.color&&d.color!==V&&this.checkColorContrast(t,d.color,r,d);break}}},{key:"checkColorContrast",value:function(e,t,n,r){if(e!==V&&t!==V){var i=this.textColorContrastResult.getColorsContrast(e,t),a=window.screen.width/(this.presentation.props.slideWidth/window.devicePixelRatio),o=n.textBox.textStyle.fontSize/30*a,l=this.textColorContrastResult.getCompareRatioAndRule(o),c=l.rule;i<l.ratio&&i>1.1&&(this.textColorContrastResult.resultType=v.a.ERROR,this.textColorContrastResult.resultInfo.push({boxNode:n,textColor:e,textFontSize:o,textBack:r,contrastRule:c,contrast:i}))}}},{key:"initSlideQuadTree",value:function(e){var t={x:0,y:0,width:this.presentation.props.slideWidth,height:this.presentation.props.slideHeight};this.colorQuadtree=new T.a(t);var n=this.getColorFromFill(e.getBackgroundFill());if(n){var r={type:W.SLIDE_BACKGROUND,slideModel:e,color:n},i=new R.a({x:0,y:0,width:this.presentation.props.slideWidth,height:this.presentation.props.slideHeight,data:r});this.colorQuadtree.insert(i)}}},{key:"getColorFromFill",value:function(e){var t=e.getShownFillType();if(void 0!==t&&t!==L.b.NoFill){if(t===L.b.SolidFill){var n,r,i=null===(n=e.getCurrentFill())||void 0===n?void 0:n.fillInfo.color;return void 0!==(null==i?void 0:i.alpha)&&i.alpha<.8?V:new _.a(null===(r=e.getCurrentFill())||void 0===r?void 0:r.fillInfo.color.srgb_color)}return V}}}]),e}(),Q=n("7a5536c9bf"),q=n.n(Q),$=(n("6e20b6a7d8"),n("3bf1976a4f"),n("10b1eb7899")),ee=n("743ef67b0e"),te=n("c021ec9870");function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie=function(){function e(t,n,r){l()(this,e),d()(this,"analyzerName",void 0),d()(this,"description",void 0),d()(this,"resultType",void 0),d()(this,"titleResult",void 0),d()(this,"vTitleTemplateErrorResult",new Map),d()(this,"toUpdateFrame",new Map),d()(this,"presentation",void 0),this.showContentChangeUIFunc=r,this.analyzerName=t,this.description=n,this.reset()}return s()(e,[{key:"setShowContentChangeUI",value:function(e){this.showContentChangeUIFunc=e}},{key:"getDescriptionWithSelect",value:function(){if(this.resultType!==v.a.SUCCESS){var e=[],t="";return this.titleResult.titleTemplateSimilarMap.forEach((function(e){e.forEach((function(e){t.length>0?t+=", ".concat(e+1):t+="".concat(e+1)}))})),e.push({selectable:!1,description:C.a.t("以下页面的标题未对齐：{0}",{0:t})}),e}}},{key:"reset",value:function(){this.resultType=v.a.SUCCESS,this.toUpdateFrame=new Map}},{key:"generateResult",value:function(e,t){var n=this;this.presentation=e,this.titleResult=t,this.vTitleTemplateErrorResult=new Map,this.titleResult.titleTemplateMap.forEach((function(e,t){var r=e.map((function(e){return e.slideIndex})),i=n.titleResult.titleTemplateSimilarMap.get(t);if(i){n.resultType=v.a.ERROR;var a=q()(r);(a=a.concat(i)).sort((function(e,t){return e-t})),n.vTitleTemplateErrorResult.set(t,a)}}))}},{key:"handleProblem",value:function(e,t){var n,r,i,a;if(this.presentation){var o=new ee.a,l=this.presentation.clone();o.presentation=l,l.selectionService=new te.a(o);var c=null===(n=this.presentation)||void 0===n?void 0:n.children,s=null==c?void 0:c.map((function(e,t){var n=e.clone();return n.parent=l,n}));if(!c||!s)return null;l.children=s,this.changeCloneSlidesFrame(s);var u=this.getToChangeSlideIndexArray(),d=u.map((function(e){return c[e]})),p=u.map((function(e){return s[e]})),h=this.getPreviewRects(u);null===(r=this.showContentChangeUIFunc)||void 0===r||r.call(this,{originSlideList:d,toChangeSlideList:p,toChangeSlideIndexArray:u,slideWidth:(null===(i=this.presentation)||void 0===i?void 0:i.props.slideWidth)||960,slideHeight:(null===(a=this.presentation)||void 0===a?void 0:a.props.slideHeight)||540,toChangeElementRects:h,onConfirmModify:this.onConfirmModify.bind(this,e),onCancel:t})}}},{key:"getToChangeSlideIndexArray",value:function(){var e=[];return this.toUpdateFrame.forEach((function(t,n){var r=n.slideNode.slideIndex;e.push(r)})),e.sort((function(e,t){return e-t}))}},{key:"onConfirmModify",value:function(e){var t=this;Object(b.b)((function(){t.toUpdateFrame.forEach((function(e,t){Object(z.j)(t.element)&&t.element.getFrame().updateFrameOnSlide({frame:e})}))})),Object(w.c)({opername:S.e.DOC_PPT,module:S.d.AUTO_BEAUTIFY,action:S.b.BEAUTIFY_TITLE_ALIGNMENT_SUCCESS}),e()}},{key:"getPreviewRects",value:function(e){var t=new Map,n=new Map;return e.forEach((function(e,t){n.set(e,t)})),this.toUpdateFrame.forEach((function(e,r){var i,a=r.slideNode.slideIndex,o=re(re({},r.element.getFrame().frameOnSlide()),e),l=n.get(a);void 0!==l&&(t.has(l)?null===(i=t.get(l))||void 0===i||i.push(o):t.set(l,[o]))})),t}},{key:"changeCloneSlidesFrame",value:function(e){var t=this;this.titleResult.titleTemplateMap.forEach((function(n,r){var i=t.titleResult.titleTemplateSimilarMap.get(r);null==i||i.forEach((function(n){var i,a=e[n],o=null===(i=r.templateArea.node)||void 0===i?void 0:i.visualBlocks,l=t.titleResult.titleTemplateSimilarBlocksMap.get(n);l&&(null==o||o.forEach((function(e,n){var i,o=l[n].similarBlock;if(o.info){var c=null===(i=o.info)||void 0===i?void 0:i.element,s=o.getFrame(),u=e.rect,d=o.rect;if(s){var p=t.getToUpdateLeftTopOffset(r,u,d),h={};void 0!==p.x&&Math.abs(p.x)>.001&&(h.left=s.left+p.x),void 0!==p.y&&Math.abs(p.y-s.top)>.001&&(h.top=s.top+p.y);var f=null==c?void 0:c.getFrame().convertFrameOnSlideToSelf(re(re({},s),h)),m=o.info.path,v=t.getElementByPath(a,m);v&&(v.props.style.left=null==f?void 0:f.left,v.props.style.top=null==f?void 0:f.top,v.props.style.width=null==f?void 0:f.width,v.props.style.height=null==f?void 0:f.height,v.props.style.flipH=null==f?void 0:f.flipH,v.props.style.flipV=null==f?void 0:f.flipV,v.props.style.rotate=null==f?void 0:f.rotate,v.previewChange+=1),t.toUpdateFrame.set(o.info,h)}}})))}))}))}},{key:"getToUpdateLeftTopOffset",value:function(e,t,n){var r={},i=this.getLeftOffset(e,t,n),a=this.getTopOffset(e,t,n);return 0!==i&&(r.x=i),0!==a&&(r.y=a),r}},{key:"getLeftOffset",value:function(e,t,n){if(e.horAlignType===$.a.Same){var r=t.left-n.left,i=t.left+t.width/2-n.width/2-n.left,a=t.left+t.width-n.width-n.left,o=Math.abs(r),l=Math.abs(i),c=Math.abs(a),s=Math.min(Math.abs(r),Math.abs(i),Math.abs(a));if(o===s)return r;if(l===s)return i;if(c===s)return a}else{if(e.horAlignType===$.a.Left)return t.left-n.left;if(e.horAlignType===$.a.Center)return t.left+t.width/2-n.width/2-n.left;if(e.horAlignType===$.a.Right)return t.left+t.width-n.width-n.left}return 0}},{key:"getTopOffset",value:function(e,t,n){if(e.verAlignType===$.b.Same){var r=t.top-n.top,i=t.top+t.height/2-n.height/2-n.top,a=t.top+t.height-n.height-n.top,o=Math.abs(r),l=Math.abs(i),c=Math.abs(a),s=Math.min(Math.abs(r),Math.abs(i),Math.abs(a));if(o===s)return r;if(l===s)return i;if(c===s)return a}else{if(e.verAlignType===$.b.Top)return t.top-n.top;if(e.verAlignType===$.b.Center)return t.top+t.height/2-n.height/2-n.top;if(e.verAlignType===$.b.Bottom)return t.top+t.height-n.height-n.top}return 0}},{key:"getElementByPath",value:function(e,t){var n=e;if(t.forEach((function(e){n.children&&n.children.length>e&&(n=n.children[e])})),n!==e)return n}}]),e}(),ae=function(){function e(t,n,r,i,a,o){l()(this,e),d()(this,"textAnalyzer",void 0),d()(this,"colorAnalyzer",void 0),d()(this,"score",void 0),d()(this,"titleAlignmentResult",void 0),this.uiDataService=n,this.slideContentEnumerator=r,this.contentLayoutAnalyzer=i,this.score=100,this.textAnalyzer=new U(t.forbidFontUseNumber,a),this.colorAnalyzer=new J,this.titleAlignmentResult=new ie(C.a.t("标题对齐检测"),C.a.t("建议不同页面间标题对齐"),o)}var t;return s()(e,[{key:"setShowContentChangeUI",value:function(e){this.titleAlignmentResult.setShowContentChangeUI(e)}},{key:"analysis",value:(t=a()(h.a.mark((function e(){var t,n=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={onStartEnumerate:function(){n.textAnalyzer.resetWithPresentation(n.uiDataService.presentation),n.colorAnalyzer.resetWithPresentation(n.uiDataService.presentation),n.titleAlignmentResult.reset()},slideStartCallback:function(e){n.colorAnalyzer.analysisNewSlide(e.slide,e.slideIndex)},slideEndCallback:function(e){n.textAnalyzer.onSlideEnd(e)},elementCallback:function(e){n.colorAnalyzer.analysisElement(e),n.textAnalyzer.analysisTextOverlapOfElement(e)},textBlockParentBoxCallback:function(e){n.textAnalyzer.analysisTextDocument(e.textDocumentElement)},textParagraphParentBoxCallback:function(e){n.textAnalyzer.analysisLineSpacing(e)},textElementBoxCallback:function(e){n.textAnalyzer.analysisFontSize(e),n.textAnalyzer.analysisTextOverlapOfTextBox(e),n.colorAnalyzer.analysisTextElementBox(e)},presentationEndCallback:function(){n.textAnalyzer.onEnumeratePresentationEnd()}},this.contentLayoutAnalyzer.analysisWithTextResultWhenEnumerateContent(this.uiDataService.presentation,t,(function(e,t,r){n.titleAlignmentResult.generateResult(n.uiDataService.presentation,r),n.calculateScore()})),e.next=12,this.slideContentEnumerator.enumerateWithCallback(t,{stopEnumerateHiddenElement:!0});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"calculateScore",value:function(){var e,t=50,n=50;this.textAnalyzer.lineSpacingResult.resultType===v.a.ERROR&&(t-=5,this.textAnalyzer.lineSpacingResult.resultInfo.length>5&&(t-=5)),this.textAnalyzer.titleFontSizeResult.resultType===v.a.ERROR&&(t-=2,this.textAnalyzer.titleFontSizeResult.resultInfo.length>2&&(t-=3)),this.textAnalyzer.subTitleFontSizeResult.resultType===v.a.ERROR&&(t-=2,this.textAnalyzer.subTitleFontSizeResult.resultInfo.length>2&&(t-=3)),(null===(e=this.textAnalyzer.fontUseNumberResult)||void 0===e?void 0:e.resultType)===v.a.ERROR&&(n-=5,this.textAnalyzer.fontUseNumberResult.eaFontSet.size>8&&(n-=5)),this.colorAnalyzer.textColorContrastResult.resultType===v.a.ERROR&&(n-=5,this.colorAnalyzer.textColorContrastResult.resultInfo.length>5&&(n-=5)),this.textAnalyzer.textOverlapResult.resultType===v.a.ERROR&&(n-=2,this.textAnalyzer.textOverlapResult.resultInfo.length>10&&(n-=3)),this.titleAlignmentResult.resultType===v.a.ERROR&&(t-=10),this.score=t+n}}]),e}()},"96718968a5":function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-transition-preview-exit-wrapper-lYJmE{pointer-events:none}.index-transition-preview-enter-wrapper-15SJH,.index-transition-preview-exit-wrapper-lYJmE{position:absolute;left:0;top:0;width:100%;height:100%}",""]),t.locals={"transition-preview-exit-wrapper":"index-transition-preview-exit-wrapper-lYJmE","transition-preview-enter-wrapper":"index-transition-preview-enter-wrapper-15SJH"}},"99b1044559":function(e,t,n){"use strict";n.r(t),n.d(t,"SmartReplaceImageService",(function(){return Ze}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36");var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),c=n.n(l),s=n("85d0a7609b"),u=n.n(s),d=n("3ef2352f0b"),p=n.n(d),h=(n("c6244f7705"),n("081c8cafea"),n("b8217400dc"),n("e6f68cdf2e"),n("22569efd03"),n("0acdc5834b"),n("b1e2246d82"),n("69084d01d3")),f=n.n(h),m=n("d5c3deb8c7"),v=n("52d461bc51"),g=n.n(v),b=n("82f2dc9440"),y=n.n(b),x=n("5fac0349d3"),w=n("6884e1a126"),S=n("432f93125e"),k=n("8ba8926996"),C=n("f27f5f5885"),E=n("14502724a6"),I=n.n(E),T=(n("6e20b6a7d8"),n("8aebbf296a"),n("85d48ef22b"),n("4780632d19")),R=n("020899bf26"),M=n("11246a1392"),O=n.n(M),N=(n("8e7cce0ada"),n("2a6f332b5e"),n("9d0daf5c3f"),n("3bf1976a4f"),n("3d0fb6aab7")),L=n.n(N),z=n("e792a3169a"),j=n.n(z),P=n("22616d8256"),D=n.n(P),A={insert:"head",singleton:!1},B=(j()(D.a,A),D.a.locals||{}),F="https://docimg4.docs.qq.com/image/AgAABTW7Ya4hnqF4u2VHSZIAGp6G2s8F.png",H=function(e){var t=e.image,n=e.currentIndex,r=e.totalImagesCount,i=e.changeCurrentImage,a=Object(h.useState)(""),o=I()(a,2),l=o[0],c=o[1],s=Object(h.useState)(!0),u=I()(s,2),d=u[0],p=u[1];Object(h.useEffect)((function(){c(t),p(!0)}),[t]);return f.a.createElement("div",{className:B["content-left"]},f.a.createElement("div",{className:B["content-subtitle"]},r>0?"".concat(x.a.t("正在使用的图片"),"  （").concat(n+1,"/").concat(r,"）"):x.a.t("没有智能生成的图片")),f.a.createElement("div",{className:B["current-image-container"],hidden:0===r},f.a.createElement("img",{className:B["current-image"],src:function(e){try{var t=new URL(e);return"".concat(t.protocol,"//").concat(t.hostname).concat(t.pathname,"?imageView2/2/w/400/h/400")}catch(e){return F}}(l),onLoad:function(){return p(!1)},onError:function(){p(!1),c(F)}}),f.a.createElement("div",{className:B["current-image-loading"],hidden:!d}),f.a.createElement("div",{className:"".concat(B["arrow-icon"]," ").concat(B["arrow-icon-before"]),hidden:0===n,onClick:function(){return i(n-1)}},f.a.createElement("img",{className:"".concat(B["arrow-icon-svg"]),src:L.a})),f.a.createElement("div",{className:"".concat(B["arrow-icon"]," ").concat(B["arrow-icon-after"]),hidden:n+1>=r,onClick:function(){return i(n+1)}},f.a.createElement("img",{className:"".concat(B["arrow-icon-svg"]),src:L.a}))))},W=n("1748118723"),U=n.n(W),G=n("6d623d55ad"),V=n.n(G),Z=n("5fb8342fc4"),_=n.n(Z),Y=n("8b13fcae36"),X=n("b438b29dcd"),K=n.n(X),J=n("57b2cc50f9"),Q=n.n(J),q=n("88b379c91b"),$=n.n(q),ee={insert:"head",singleton:!1},te=(j()($.a,ee),$.a.locals||{}),ne=function(e){var t,n=e.sourceUrl,r=e.onPreViewClick,i=e.className,a=void 0===i?"":i;return f.a.createElement("div",{className:U()((t={},u()(t,te["info-box"],!0),u()(t,a,!!a),t)),onClick:function(e){return e.stopPropagation()}},f.a.createElement(K.a,{alignment:"right",dropContent:f.a.createElement(Q.a,{itemStyle:{paddingLeft:16}},f.a.createElement(Q.a.Item,{onClick:function(){return r()}},x.a.t("预览图片")),f.a.createElement(Q.a.Item,{disabled:!n,onClick:function(){return Object(Y.openNewBlankWindow)(null!=n?n:"")}},x.a.t("查看图片来源")))},f.a.createElement("div",{className:te.container})))},re=function(e){var t=e.displayImages,n=e.selectedIndex,r=e.selectImage,i=e.updateDisplayImages;return f.a.createElement("div",{className:B["content-right"]},f.a.createElement("div",{className:B["content-subtitle"]},f.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},"".concat(x.a.t("联网搜索的新图片")),f.a.createElement(V.a,{title:x.a.t("如需商用请自行获取授权"),placement:"top"},f.a.createElement("div",{className:B["info-icon"]}))),f.a.createElement("div",{className:B.refresh,onClick:function(){return i()}},f.a.createElement("div",{className:B["refresh-icon"]}),"".concat(x.a.t("换一换")))),f.a.createElement("div",{className:B["list-images"]},t.map((function(e,i){return f.a.createElement(ie,{selected:i===n,key:"".concat(e).concat(i),src:e.src,sourceUrl:e.sourceUrl,selectImage:function(){return r(i)},showPreview:function(){return function(e){_.a.show({disableDownload:!0,initialIndex:e,images:t.map((function(e){return{url:e.src}}))})}(i)}})}))))},ie=function(e){var t,n=e.selected,r=e.key,i=e.src,a=e.selectImage,o=e.showPreview,l=e.sourceUrl;return f.a.createElement("div",{className:U()((t={},u()(t,B["list-images-item-container"],!0),u()(t,B["list-images-container-active"],n),u()(t,B["list-images-container-idle"],!n),t)),key:r,onClick:function(){return a()}},f.a.createElement("img",{className:B["list-images-item"],src:i}),f.a.createElement("div",{className:B["current-image-loading"],style:{backgroundColor:"#ffffff"},hidden:!!i}),f.a.createElement(ne,{className:B["current-image-pointer"],onPreViewClick:function(){return o()},sourceUrl:l}))},ae=n("b1f388d5a8"),oe=function(e){var t,n=e.imagesToReplace,r=e.pageIndex,a=e.close,o=e.getPictureModelById,l=Object(h.useState)([]),c=I()(l,2),s=c[0],d=c[1],m=Object(h.useState)([]),v=I()(m,2),g=v[0],b=v[1],y=Object(h.useState)(),w=I()(y,2),S=w[0],k=w[1],C=Object(h.useState)(0),E=I()(C,2),M=E[0],N=E[1],L=Object(h.useRef)({}),z=Object(h.useRef)(u()({},r,n)),j=Object(h.useRef)(r);Object(h.useEffect)((function(){d(n.map((function(e){return{src:e.thumb_url,sourceUrl:e.source_url}}))),b(P())}),[]);var P=function(){var e;return null!==(e=ae.a.getAllAiPictures().filter((function(e){return!!e.url})))&&void 0!==e?e:[]},D=function(e){k(L.current[e]),N(e)},A=function(){return g.length===M+1};return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{style:{width:"100%",minHeight:120,backgroundColor:"#E9EBED",borderTop:"1px solid rgba(0,0,0,.04)",borderBottom:"1px solid rgba(0,0,0,.04)"}},f.a.createElement("div",{className:B["dialog-content"]},f.a.createElement(H,{image:null===(t=g[M])||void 0===t?void 0:t.url,currentIndex:M,totalImagesCount:g.length,changeCurrentImage:D}),f.a.createElement(re,{displayImages:s,selectedIndex:(null==S?void 0:S.page)===j.current?S.index:void 0,selectImage:function(e){k({page:j.current,index:e})},updateDisplayImages:function(){var e,t,n;j.current=(j.current+1)%3;var r=j.current;if((null===(e=z.current[r])||void 0===e?void 0:e.length)>0){var i=z.current[r];d(i.map((function(e){return{src:e.thumb_url,sourceUrl:e.source_url}})))}else{d(Array.from({length:9},(function(){return{src:"",sourceUrl:""}})));var a=null!==(t=null===(n=R.a.SlideTitleManager())||void 0===n?void 0:n.title)&&void 0!==t?t:"";Object(T.c)({keyword:a,num:9,page:r}).then((function(e){var t,n=null!==(t=null==e?void 0:e.search_image.images)&&void 0!==t?t:[];d(n.map((function(e){return{src:e.thumb_url,sourceUrl:e.source_url}}))),z.current[r]=n}))}}}))),f.a.createElement("div",{style:{paddingRight:24,margin:"18px 0 18px 0",alignSelf:"end"}},f.a.createElement(O.a,{onClick:function(){A()?a():D(M+1)}},A()?x.a.t("跳过并退出"):x.a.t("跳过本图")),f.a.createElement(O.a,{style:{marginLeft:16},type:"primary",disabled:void 0===S||g.length<=0,onClick:i()(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=2;break}return e.abrupt("return");case 2:if(t=o(g[M].slideId,g[M].shapeId)){e.next=5;break}return e.abrupt("return");case 5:if(n=z.current[S.page][S.index],ae.a.replaceImagesWithSearchInfo([t],n,!1),L.current[M]=S,!A()){e.next=11;break}return a(),e.abrupt("return");case 11:D(M+1);case 12:case"end":return e.stop()}}),e)})))},A()?x.a.t("替换并退出"):x.a.t("替换"))))},le=n("e0e8dd9366"),ce=(n("ef51bf4fed"),n("826dc923b3"),n("f000f89fa1")),se=n.n(ce),ue=n("652fb74822"),de=n.n(ue),pe={insert:"head",singleton:!1},he=(j()(de.a,pe),de.a.locals||{}),fe=n("7cda620e53"),me=n.n(fe),ve=n("2ba7871556"),ge=function(e){var t,n,r,a=e.selectionService,o=e.eventEmitter,l=e.defaultKeyword,c=void 0===l?"":l,s=Object(h.useState)(),d=I()(s,2),v=d[0],g=d[1],b=Object(h.useState)([]),y=I()(b,2),w=y[0],S=y[1],k=Object(h.useState)([]),C=I()(k,2),E=C[0],M=C[1],N=Object(h.useState)(c),L=I()(N,2),z=L[0],j=L[1],P=Object(h.useState)(),D=I()(P,2),A=D[0],B=D[1],F=Object(h.useState)(0),H=I()(F,2),W=H[0],G=H[1],V=Object(h.useState)(!1),Z=I()(V,2),Y=Z[0],X=Z[1],K=Object(h.useState)(!1),J=I()(K,2),Q=J[0],q=J[1],$=Object(h.useRef)(null),ee=Object(h.useRef)(null),te=Object(h.useRef)(null),ne=Object(h.useRef)(null),re=Object(h.useRef)([]),ie=Object(h.useRef)(0),oe=Object(h.useRef)(0);Object(h.useEffect)((function(){var e=Object(m.r)((function(){return a.getSelectedModel()}),(function(e){return g(null!=e?e:void 0)}),{fireImmediately:!0}),t=o.listen("slide-replace-image-keyword-change",(function(e){j(e),ce({keyword:e,clear:!0})}));return function(){e(),t.unsubscribe()}}),[]),Object(h.useEffect)((function(){var e,t,n,r,i,a,o=null!==(e=null===(t=ee.current)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:0,l=null!==(n=null===(r=te.current)||void 0===r?void 0:r.clientHeight)&&void 0!==n?n:0,c=null!==(i=null===(a=ne.current)||void 0===a?void 0:a.clientHeight)&&void 0!==i?i:0;l<o&&c<o&&ce({keyword:z})}),[w,E]),Object(h.useEffect)((function(){var e=re.current.map((function(e,t){return{src:e.thumb_url,width:e.thumb_width,height:e.thumb_height,sourceUrl:e.source_url,id:t}})),t=[],n=[];ie.current=0,oe.current=0,e.forEach((function(e){ie.current<=oe.current?(ie.current+=e.height/e.width,t.push(e)):(oe.current+=e.height/e.width,n.push(e))})),S(t),M(n)}),[Y,W]);function ce(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.keyword,r=void 0===n?"":n,i=t.clear,a=void 0!==i&&i,o=a?0:W,l=r||(null===(e=R.a.SlideTitleManager())||void 0===e?void 0:e.title);!l||o>=3||Y||(a&&(re.current=[],S([]),M([])),X(!0),Object(T.c)({keyword:l,num:20,page:o}).then((function(e){var t,n=null!==(t=null==e?void 0:e.search_image.images)&&void 0!==t?t:[];re.current=re.current.concat(n),X(!1),G(o+1)})))}function ue(){return de.apply(this,arguments)}function de(){return(de=i()(p.a.mark((function e(){var t,n,r,i,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==A){e.next=2;break}return e.abrupt("return");case 2:if(n=re.current[A]){e.next=5;break}return e.abrupt("return");case 5:if(q(!0),(null==v?void 0:v.type)!==le.d.IMAGE&&(null==v?void 0:v.type)!==le.d.SHAPE){e.next=10;break}return r=[v],ae.a.replaceImagesWithSearchInfo(r,n,!1).then((function(){return q(!1)})),e.abrupt("return");case 10:i=null!==(t=v)&&void 0!==t?t:{},a=i.selectedModels,ae.a.replaceImagesWithSearchInfo(a,n,!1).then((function(){return q(!1)}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e){_.a.show({disableDownload:!0,initialIndex:null!=e?e:0,images:re.current.map((function(e){return{url:e.thumb_url}}))})}var fe=f.a.createElement("div",{className:U()((t={},u()(t,he["drawer-content-processing"],Q),u()(t,he["drawer-content"],!0),t))},f.a.createElement(se.a,{className:he["drawer-input"],value:z,inputRef:$,showClear:!0,placeholder:x.a.t("请输入搜索关键词"),leftIcon:me.a,onChange:function(e){return j(e)},onClickLeftIcon:function(){z&&ce({keyword:z,clear:!0})},onKeyPress:function(e){"Enter"===e.key&&z&&ce({keyword:z,clear:!0})}}),f.a.createElement("div",{className:U()((n={},u()(n,he["drawer-galley"],!0),u()(n,he["galley-loading"],Y&&w.length<=0),n)),ref:ee,onScroll:function(){return t=null!==(e=ee.current)&&void 0!==e?e:{},n=t.scrollTop,r=void 0===n?0:n,i=t.scrollHeight,a=void 0===i?0:i,o=t.clientHeight,void(r+(void 0===o?Number.MAX_SAFE_INTEGER:o)>=a-10&&ce({keyword:z}));var e,t,n,r,i,a,o}},f.a.createElement(be,{myRef:te,images:w,checkedId:A,onImageClick:function(e){return B(e)},onDoubleClick:function(){return ue()},onPreViewClick:function(e){return pe(e)}}),f.a.createElement(be,{myRef:ne,images:E,checkedId:A,onImageClick:function(e){return B(e)},onDoubleClick:function(){return ue()},onPreViewClick:function(e){return pe(e)}})),f.a.createElement(O.a,{type:"primary",className:he["drawer-confirm"],disabled:!function(){if(null!=v&&v.selectedModels)return!0;if((null==v?void 0:v.type)===le.d.IMAGE)return!0;var e;if((null==v?void 0:v.type)===le.d.SHAPE&&(null===(e=v.getBackgroundFill)||void 0===e?void 0:e.call(v).getFillType())===ve.b.ImageFill)return!0;return!1}()||void 0===A,onClick:function(){return ue()}},x.a.t("替换选中的图片")));return f.a.createElement("div",{className:U()((r={},u()(r,he["drawer-mask"],!0),u()(r,he["drawer-mask-processing"],Q),r))},fe)},be=function(e){var t=e.myRef,n=e.images,r=e.checkedId,i=e.onImageClick,a=e.onPreViewClick,o=e.onDoubleClick;return f.a.createElement("div",{ref:t,className:he["images-col"]},n.map((function(e,t){return f.a.createElement(ye,{key:"".concat(e.src).concat(t),image:e,checked:r===e.id,onClick:i,onDoubleClick:o,onPreViewClick:a})})))},ye=function(e){var t,n=e.image,r=e.checked,i=e.onClick,a=e.onPreViewClick,o=e.onDoubleClick;return f.a.createElement("div",{className:U()((t={},u()(t,he["drawer-image"],!0),u()(t,he["drawer-image-active"],r),t)),onClick:function(){return null==i?void 0:i(null==n?void 0:n.id)},onDoubleClick:function(){return null==o?void 0:o()},style:{paddingTop:"calc(100% / ".concat(null==n?void 0:n.width," * ").concat(null==n?void 0:n.height,")")}},f.a.createElement("img",{src:null==n?void 0:n.src}),f.a.createElement(ne,{className:he["image-more-info"],sourceUrl:null==n?void 0:n.sourceUrl,onPreViewClick:function(){return null==a?void 0:a(null==n?void 0:n.id)}}))},xe=function(){return f.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"baseline",color:"rgba(0,0,0,0.88)"}},f.a.createElement("div",null,x.a.t("联网搜图")),f.a.createElement("div",{style:{marginLeft:4,fontSize:12,color:"rgba(0,0,0,0.24)"}},x.a.t("如需商用请自行获取授权")))},we=n("7a5536c9bf"),Se=n.n(we),ke=n("d997a5726d"),Ce=n.n(ke),Ee=n("245ecca45e"),Ie=n.n(Ee),Te=n("652598cb0a"),Re=n.n(Te),Me=n("0f2367b803"),Oe=n.n(Me),Ne=n("841a0d4c51"),Le=n.n(Ne),ze=n("a0388d3b54"),je=n("61a7f1b6d3"),Pe=n.n(je),De={insert:"head",singleton:!1},Ae=(j()(Pe.a,De),Pe.a.locals||{});function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function e(){o()(this,e)};u()(He,"store",{});var We=function(e){var t,n,r=e.count,a=void 0===r?4:r,o=e.maxPage,l=void 0===o?3:o,c=e.selectedModel,s=e.onClose,d=Object(h.useState)(""),m=I()(d,2),v=m[0],g=m[1],b=Object(h.useState)(0),y=I()(b,2),w=y[0],S=y[1],k=Object(h.useState)(),C=I()(k,2),E=C[0],T=C[1],M=Object(h.useState)([]),N=I()(M,2),L=N[0],z=N[1],j=Object(h.useState)("loading"),P=I()(j,2),D=P[0],A=P[1],B=Object(h.useRef)({}),F=Object(h.useRef)([]);Object(h.useEffect)((function(){var e,t,n,r,i,a=null!==(e=null===(t=R.a.SlideTitleManager())||void 0===t?void 0:t.title)&&void 0!==e?e:"",o=null!==(n=ae.a.getPageTitle(null!==(r=null==c?void 0:c.slideRef)&&void 0!==r?r:void 0))&&void 0!==n?n:"",l=ae.a.getPageTitleList(null!==(i=null==c?void 0:c.slideRef)&&void 0!==i?i:void 0);F.current=[a,o].concat(Se()(l)),G()}),[w]),Object(h.useEffect)((function(){var e={success:x.a.t("已经为你重新生成了下列图片："),loading:x.a.t("正在重新智能配图，请稍候..."),fail:x.a.t("很抱歉，配图生成失败")}[D];g(e)}),[D]);var H=function(){B.current[w].every((function(e){return e.fail}))?A("fail"):A("success")},W=function(){var e;if(E){var t=E.page,n=E.index;return null===(e=B.current[t])||void 0===e?void 0:e[n]}},G=function(){var e=i()(p.a.mark((function e(){var t,n,r,i,o,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=c&&c.id){e.next=2;break}return e.abrupt("return");case 2:if(!((null==(i=null===(t=He.store[c.id])||void 0===t?void 0:t[w])?void 0:i.length)>0)){e.next=8;break}return B.current[w]=i,z(i.map((function(e){return{url:e.url}}))),H(),e.abrupt("return");case 8:if(A("loading"),o=Object(ze.a)(c.props.style),l=null!==(n=null===(r=c.sdkData)||void 0===r?void 0:r.props.nvPr.name)&&void 0!==n?n:"",null!=c&&c.slideRef){e.next=13;break}return e.abrupt("return");case 13:s=Array.from({length:a},(function(e,t){var n=F.current[(w*a+t)%F.current.length];return{needGenerate:!0,generateDetail:{width:o.width,height:o.height,title:n,keyword:l}}})),z(s);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return f.a.createElement("div",{className:Ae.container},f.a.createElement("div",{className:Ae.message},v),f.a.createElement("div",{className:Ae["image-galley"]},Array.from({length:a},(function(e,t){return f.a.createElement(Ue,{key:"".concat(t),generateInfo:L[t],checked:w===(null==E?void 0:E.page)&&t===(null==E?void 0:E.index),onClick:function(){return T({page:w,index:t})},onGenerateEnd:function(e){return function(e,t){var n=e.url,r=e.fail;B.current[w]||(B.current[w]=[]);var i=B.current[w];if(i[t]={url:n,fail:r},i.map((function(e){return e})).filter(Boolean).length>=a&&(H(),null!=c&&c.id)){var o=He.store[c.id];He.store[c.id]=Fe(Fe({},o),{},u()({},w,B.current[w]))}}(e,t)}})}))),f.a.createElement("div",{className:Ae.footer},f.a.createElement("div",{className:Ae["footer-left"]},"loading"===D?f.a.createElement(O.a,{size:"small",className:Ae["ai-button-normal"],icon:Ce.a,onClick:function(){return s()}},x.a.t("取消")):f.a.createElement(f.a.Fragment,null,f.a.createElement(O.a,{size:"small",className:Ae["ai-button-normal"],icon:Re.a,onClick:function(){return s()}},x.a.t("退出")),f.a.createElement(O.a,{size:"small",className:Ae["ai-button-normal"],icon:Oe.a,onClick:function(){return S((w+1)%l)}},x.a.t("换一批")))),f.a.createElement("div",{className:Ae["footer-right"]},f.a.createElement(O.a,{size:"small",className:U()((n={},u()(n,Ae["ai-button-primary"],!0),u()(n,Ae["ai-button-disabled"],!(null!==(t=W())&&void 0!==t&&t.url)||(null==E?void 0:E.page)!==w),n)),icon:Ie.a,onClick:function(){!function(){var e,t,n=W();if(null!=n&&n.url){var r=null===(e=L[null!==(t=null==E?void 0:E.index)&&void 0!==t?t:0])||void 0===e?void 0:e.generateDetail,i=null!=r?r:{},a=i.width,o=void 0===a?0:a,l=i.height,s=void 0===l?0:l;ae.a.replaceImagesWithSearchInfo([c],{url:n.url,width:o,height:s,title:"",source_url:"",thumb_url:n.url,thumb_width:o,thumb_height:s},!0)}}(),s()}},x.a.t("替换图片")))))},Ue=function(e){var t,n=e.generateInfo,r=e.checked,i=e.onClick,a=e.onGenerateEnd,o=Object(h.useState)(),l=I()(o,2),c=l[0],s=l[1],d=Object(h.useState)(!1),p=I()(d,2),m=p[0],v=p[1];Object(h.useEffect)((function(){if(n){var e=n.url,t=n.needGenerate,r=n.generateDetail;if(t&&r){var i=r.keyword,o=r.width,l=r.height,c=r.title;v(!0),s(void 0),Object(T.a)({keyword:i,width:o,height:l,title:c,upload:!1}).then((function(e){if(null!=e&&e.generate_image.url){var t=null==e?void 0:e.generate_image.url;s(t),v(!1),null==a||a({url:t})}else s(Le.a),v(!1),null==a||a({fail:!0})}))}else s(e||Le.a)}}),[n]);return f.a.createElement("div",{className:U()((t={},u()(t,Ae["card-image"],!0),u()(t,Ae["card-image-loading"],m),u()(t,Ae["card-image-active"],r),t)),onClick:function(){return null==i?void 0:i()},style:function(){if(c)return{backgroundImage:"url(".concat(c,")")}}()})},Ge=n("d08a5b894d");function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ze=function(){function e(){var t=this;o()(this,e),u()(this,"drawerService",void 0),u()(this,"eventEmitter",void 0),u()(this,"drawerStateManager",void 0),u()(this,"services",void 0),u()(this,"generateCardInstance",void 0),u()(this,"closeCardUnSubscribe",void 0),u()(this,"getPictureModelById",(function(e,n){var r,i=t.services.uiDataService,a=null==i?void 0:i.presentation.findElementWithId(e,n);if((null==a?void 0:a.type)===le.d.IMAGE)return null!==(r=a.slideRef)&&void 0!==r&&r.slideIndex&&(t.services.selectionService.clearAll(),t.services.selectionService.currentSlideIndex=a.slideRef.slideIndex),a})),this.drawerService=w.e.get(S.c),this.eventEmitter=w.e.get(k.a)}var t;return c()(e,[{key:"setDelegateService",value:function(e){var t=this;this.services=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),Object(m.r)((function(){return t.services.rightSideBarManager.isReplaceImageShown}),(function(e){var n;e?(t.showReplaceImageDrawer(),null===(n=t.services.aiService.dangerousInstance)||void 0===n||n.hideSideBar()):t.closeReplaceImageDrawer();window.dispatchEvent(new Event("resize"))}))}},{key:"loadDrawerManager",value:function(e){this.drawerStateManager=e}},{key:"showBulkReplaceDialog",value:(t=i()(p.a.mark((function e(t){var n,r,i=this,a=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&void 0!==a[1]?a[1]:0,!((null!==(n=ae.a.getAllAiPictures().length)&&void 0!==n?n:0)<=0)){e.next=4;break}return y.a.show({message:x.a.t("很抱歉，文档中没有可替换的AI图片"),autoClose:!0,type:"warning"}),e.abrupt("return");case 4:return e.abrupt("return",new Promise((function(e){var n=g.a.confirm({title:f.a.createElement("div",{style:{margin:"21px 0 21px 0",paddingLeft:24,lineHeight:"22px"}},x.a.t("批量图片替换")),style:{padding:0,width:1e3},content:f.a.createElement(oe,{imagesToReplace:t,pageIndex:r,close:function(){e(),n()},getPictureModelById:i.getPictureModelById}),footer:null,onClose:function(){return e()}}).close})));case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"showGenerateCard",value:function(e,t){var n,r,i,a=this;if(e&&t){var o=document.getElementById(e),l=null==o?void 0:o.getBoundingClientRect(),c=this.getGenerateCardPosition(t),s=c.x,u=c.y,d={position:"absolute",top:null!=u?u:12+(null!==(n=null==l?void 0:l.bottom)&&void 0!==n?n:0),left:null!==(r=null!=s?s:null==l?void 0:l.left)&&void 0!==r?r:0,width:328,padding:0,borderRadius:4,overflow:"hidden"};this.closeGenerateCard(),this.generateCardInstance=g.a.confirm({mask:!1,draggable:!0,style:d,closable:!1,title:null,content:f.a.createElement(We,{selectedModel:t,onClose:function(){var e,t;return null===(e=a.generateCardInstance)||void 0===e||null===(t=e.close)||void 0===t?void 0:t.call(e)}}),footer:null}),this.closeCardUnSubscribe=null===(i=t.sdkData)||void 0===i?void 0:i.subscribe((function(e){var t,n,r;void 0!==(null==e||null===(t=e.diffs)||void 0===t||null===(n=t.data)||void 0===n||null===(r=n.nvPr)||void 0===r?void 0:r.descr)&&a.closeGenerateCard()})),Object(m.y)((function(){var e,n;return[a.services.selectionService.currentSlide!==t.slideRef,(null!==(e=null===(n=t.parent)||void 0===n?void 0:n.children.findIndex((function(e){return e.id===t.id})))&&void 0!==e?e:-1)<0].includes(!0)}),(function(){return a.closeGenerateCard()}))}else{var p;null===(p=window.logger)||void 0===p||p.error("no quick-setting dom or selected-model")}}},{key:"closeGenerateCard",value:function(){var e,t,n;null===(e=this.generateCardInstance)||void 0===e||null===(t=e.close)||void 0===t||t.call(e),null===(n=this.closeCardUnSubscribe)||void 0===n||n.call(this)}},{key:"showReplaceDrawer",value:function(){this.services.rightSideBarManager.setReplaceImageShown(!0),this.eventEmitter.emit("slide-replace-image-keyword-change",this.getSearchKeyword())}},{key:"showReplaceImageDrawer",value:function(){var e,t=this;this.drawerService.showRightDrawer({name:C.b.REPLACE_IMAGE,title:f.a.createElement(xe,null),content:f.a.createElement(ge,{selectionService:this.services.selectionService,eventEmitter:this.eventEmitter,defaultKeyword:this.getSearchKeyword()}),style:{display:"flex",flexDirection:"column"},onClose:function(){return t.services.rightSideBarManager.setReplaceImageShown(!1)}}),null===(e=this.drawerStateManager)||void 0===e||e.handleDrawerHolderVisiable(!0)}},{key:"closeReplaceImageDrawer",value:function(){var e;null===(e=this.drawerStateManager)||void 0===e||e.handleDrawerHolderVisiable(!1)}},{key:"getSearchKeyword",value:function(){var e,t,n,r,i,a,o,l,c,s,u,d,p,h=this.services.selectionService.getSelectedModel(),f=ae.a.getPageTitleList(null!==(e=null==h?void 0:h.slideRef)&&void 0!==e?e:void 0).reverse().reduce((function(e,t){return e||t}),"");return null==h||null===(t=h.sdkData)||void 0===t||null===(n=t.props)||void 0===n||null===(r=n.nvPr)||void 0===r||!r.descr||null!==(i=h.sdkData)&&void 0!==i&&null!==(a=i.props)&&void 0!==a&&null!==(o=a.nvPr)&&void 0!==o&&null!==(l=o.descr)&&void 0!==l&&l.includes("sourceUrl")?"":null!==(c=null===(s=this.services.selectionService.getSelectedModel())||void 0===s||null===(u=s.sdkData)||void 0===u||null===(d=u.props)||void 0===d||null===(p=d.nvPr)||void 0===p?void 0:p.name)&&void 0!==c?c:f}},{key:"getGenerateCardPosition",value:function(e){var t=document.body.clientWidth,n=this.services.editAreaCanvasSizeManager.getCanvasScale(),r=Object(Ge.a)(e,n,!1),i=null!=r?r:{},a=i.x,o=void 0===a?0:a,l=i.y,c=void 0===l?0:l,s=i.width,u=o+(void 0===s?0:s)+8;return u+328>t&&(u=o-328-8),u<0&&(u=void 0),{x:u,y:c}}}]),e}()},a076190a61:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".layout-header-header-2mDDL{display:flex;align-items:center;justify-content:space-between;width:100%;height:56px}.layout-header-icon-button-Ln90X{background:none;border:none;cursor:pointer;width:24px;height:24px;margin:16px;border-radius:50%}.layout-header-icon-button-Ln90X:hover{background-color:#f0f0f0}.layout-header-title-3f-fP{flex-grow:1;text-align:center;font-size:17px;font-weight:700;margin:0}",""]),t.locals={header:"layout-header-header-2mDDL","icon-button":"layout-header-icon-button-Ln90X",title:"layout-header-title-3f-fP"}},a3df3b9d4e:function(e,t,n){"use strict";n.r(t),n.d(t,"SlideContentPreviewService",(function(){return L}));var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),c=n.n(l),s=n("69084d01d3"),u=n.n(s),d=n("3404d6c52c"),p=n.n(d),h=n("5fac0349d3"),f=n("52d461bc51"),m=n.n(f),v=(n("73b854064b"),n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("8ee19818c4"),n("bcb5d93d36"),n("547611bd96")),g=n.n(v),b=n("bd29e2df90"),y=n.n(b),x=n("ab5eb40518"),w=n.n(x),S=n("1b4cdd6a36"),k=n.n(S),C=(n("6e20b6a7d8"),n("11246a1392")),E=n.n(C),I=n("1d3b3ecf9c"),T=n("0a8ecd6412");function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return w()(this,n)}}var N=function(e){y()(n,e);var t=O(n);function n(e){var r;return i()(this,n),r=t.call(this,e),c()(g()(r),"cellHeight",void 0),r}return o()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.originList,r=t.previewList,i=t.slideIndexArray,a=t.originRects,o=t.previewRects,l=t.slideWidth,c=t.slideHeight;if(!n||!r)return null;var s=480;this.cellHeight=s/l*c;var d=480/l;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",width:"100%",height:"22px"}},u.a.createElement("div",{style:{position:"relative",width:"970px"}},u.a.createElement("div",{style:{position:"absolute",fontSize:"14px",fontWeight:500,left:0}},h.a.t("调整前")),u.a.createElement("div",{style:{position:"absolute",left:"485px",fontWeight:500,fontSize:"14px"}},h.a.t("调整后")))),u.a.createElement("div",{style:{width:"100%",height:"450px",display:"flex",justifyContent:"space-between"}},u.a.createElement("div",{style:{flex:1,textAlign:"center"}},u.a.createElement("div",{style:{width:"100%",height:"100%",overflowY:"scroll",overflowX:"hidden"}},u.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"}},null==n?void 0:n.map((function(t,n){var l,c;return u.a.createElement("div",{key:t.key,style:{position:"relative",width:"964px",minHeight:"".concat(e.cellHeight+10,"px")}},u.a.createElement("div",{style:{position:"relative"}},u.a.createElement(I.a,{width:s,height:e.cellHeight,isShown:!0,slideModel:t,buildRenderTreeAsync:!1,shouldUpdate:!0,fromScale:0,region:T.s.PAGINGSELECTION,isTemplate:!1}),e.renderSlideNumber(i[n]),null==a||null===(l=a.get(n))||void 0===l?void 0:l.map((function(t){return e.renderRect(t,d)}))),u.a.createElement("div",{style:{position:"relative",left:"".concat(485,"px")}},u.a.createElement(I.a,{width:s,height:e.cellHeight,isShown:!0,slideModel:r[n],buildRenderTreeAsync:!1,shouldUpdate:!0,fromScale:0,region:T.s.PAGINGSELECTION,isTemplate:!1}),e.renderSlideNumber(i[n]),null==o||null===(c=o.get(n))||void 0===c?void 0:c.map((function(t){return e.renderRect(t,d)}))))})))))),u.a.createElement(E.a,{type:"primary",size:"small",style:{position:"absolute",bottom:"20px",right:"40px"},onClick:this.props.onConfirmButtonClick},h.a.t("确认调整")))}},{key:"renderRect",value:function(e,t){var n={left:e.left*t,top:e.top*t,width:e.width*t,height:e.height*t};return u.a.createElement("div",{style:M(M({position:"absolute"},n),{},{borderStyle:"solid",borderWidth:"1px",borderColor:"red"})})}},{key:"renderSlideNumber",value:function(e){return u.a.createElement("div",{style:{position:"absolute",left:"2px",top:"2px",height:"16px",fontSize:"12px",lineHeight:"16px",textAlign:"center",zIndex:1,borderRadius:"2px",color:"white",borderColor:"white",borderStyle:"solid",borderWidth:"1px",backgroundColor:"rgba(0,0,0,.5)",minWidth:"24px"}},e+1)}}]),n}(u.a.Component),L=function(){function e(){i()(this,e),c()(this,"modal",void 0)}return o()(e,[{key:"show",value:function(e){var t=this,n=p.a.show({tip:h.a.t("正在生成预览结果..."),zIndex:11001});setTimeout((function(){t.modal=m.a.confirm({title:e.title||h.a.t("预览"),style:{width:1060,height:600},onCancel:e.onCancel,content:u.a.createElement(N,{originList:e.originList,previewList:e.previewList,slideWidth:e.slideWidth,slideHeight:e.slideHeight,originRects:e.originRects,previewRects:e.previewRects,slideIndexArray:e.slideIndexArray,onConfirmButtonClick:function(n){var r,i;null===(r=t.modal)||void 0===r||r.close(),null===(i=e.onConfirmButtonClick)||void 0===i||i.call(e,n)}}),footer:function(){}}),n.close()}),0)}},{key:"close",value:function(){this.modal.close()}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}();c()(L,"instance",void 0)},acd95c6ea5:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".change-preview-slide-scale-button-group-container-3XxH0{width:116px;height:28px;border-radius:4px;background:rgba(51,77,102,.08);display:flex;justify-content:space-around;align-items:center;padding:2px}.change-preview-slide-scale-button-container-1A14n{width:56px;height:24px;border-radius:2px;line-height:24px;text-align:center;transition:background-color .3s;color:rgba(0,0,0,.64)}.change-preview-slide-scale-button-selected-2pKBt{background-color:#fff;box-shadow:rgba(0,0,0,.08);color:rgba(0,0,0,.88)}",""]),t.locals={"button-group-container":"change-preview-slide-scale-button-group-container-3XxH0","button-container":"change-preview-slide-scale-button-container-1A14n","button-selected":"change-preview-slide-scale-button-selected-2pKBt"}},b1f388d5a8:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var r=n("85d0a7609b"),i=n.n(r),a=n("176815363d"),o=n.n(a),l=n("9132715560"),c=n.n(l),s=n("6a364eb35c"),u=n.n(s),d=n("3ef2352f0b"),p=n.n(d),h=(n("c6244f7705"),n("081c8cafea"),n("8e7cce0ada"),n("85d48ef22b"),n("2a6f332b5e"),n("6e20b6a7d8"),n("8ee19818c4"),n("9d0daf5c3f"),n("3bf1976a4f"),n("88e773b09a")),f=n.n(h),m=n("4780632d19"),v=n("9dbd7f12a7"),g=n("a1d9765e8a"),b=n("7c46f42788"),y=n("e0a005a7aa"),x=n("767dcfbe00"),w=n("e0e8dd9366"),S=n("9657b29818"),k=n("020899bf26");function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(){function e(){c()(this,e)}var t,n,r;return u()(e,null,[{key:"replaceImagesWithSearchInfo",value:(r=o()(p.a.mark((function e(t,n,r,i){var a,o,l,c=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)(E({},n));case 2:if(e.t1=a=e.sent,e.t0=null===e.t1,e.t0){e.next=6;break}e.t0=void 0===a;case 6:if(!e.t0){e.next=10;break}e.t2=void 0,e.next=11;break;case 10:e.t2=a.upload_image;case 11:if(o=e.t2){e.next=15;break}return null==i||i(),e.abrupt("return");case 15:return e.next=17,Promise.all(t.map((function(e){var t=e;return c.getUploadImageInfo(t,o,!r)}))).catch((function(){null==i||i()}));case 17:l=e.sent,Object(S.b)((function(){t.forEach((function(e,t){(null==e?void 0:e.type)!==w.d.IMAGE&&(null==e?void 0:e.type)!==w.d.SHAPE||c.replaceSingleImageWithSearchInfo(e,n,l[t],r)}))}));case 19:case"end":return e.stop()}}),e)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"getPageTitle",value:function(e){var t,n,r,i=null==e||null===(t=e.sdkData)||void 0===t||null===(n=t.shapeTree)||void 0===n?void 0:n.getWritableOwnedData().shapeList;if(i){var a=Object(v.c)(i).idMap;if(a.title){var o=null==e||null===(r=e.sdkData)||void 0===r?void 0:r.getShapeById(a.title);if((null==o?void 0:o.type)===b.a.Shape)return Object(g.c)(o)}}}},{key:"getPageTitleList",value:function(e){var t,n,r,i=null==e||null===(t=e.sdkData)||void 0===t||null===(n=t.shapeTree)||void 0===n?void 0:n.getWritableOwnedData().shapeList;if(!i)return[];var a=Object(v.c)(i).idMap,o=[];return null===(r=a.list)||void 0===r||r.forEach((function(t){var n;if(t.title){var r=null==e||null===(n=e.sdkData)||void 0===n?void 0:n.getShapeById(t.title);(null==r?void 0:r.type)===b.a.Shape&&o.push(Object(g.c)(r))}})),o}},{key:"getAllAiPictures",value:function(){var e,t=[];return null===(e=k.a.SDKDataServices.PresentationStoreService())||void 0===e||e.getPresentation().slideList.forEach((function(e){e.forEachDescendant((function(n){if(n.type===b.a.Picture){var r,i,a,o=n.getDescription();if("image"===(null==o?void 0:o.type))t.push({slideId:e.id,shapeId:n.id,url:null!==(r=null===(i=n.props.blipFill)||void 0===i||null===(a=i.blip)||void 0===a?void 0:a.embed)&&void 0!==r?r:""})}else if(n.type===b.a.Shape){var l,c,s,u=n.getDescription();if("image"===(null==u?void 0:u.type))t.push({slideId:e.id,shapeId:n.id,url:null!==(l=null===(c=n.props.spPr.blipFill)||void 0===c||null===(s=c.blip)||void 0===s?void 0:s.embed)&&void 0!==l?l:""})}}))})),t}},{key:"replaceSingleImageWithSearchInfo",value:(n=o()(p.a.mark((function e(t,n,r,i){var a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=null===(a=t.sdkData)||void 0===a?void 0:a.getDescription(),Object(S.b)((function(){var e=t.type===w.d.IMAGE?x.a.foreground:x.a.background;Object(y.f)([r],t,e);var a=i?E({},o):E(E({},o),{},{sourceUrl:n.source_url});t.updateDescription(a)}));case 2:case"end":return e.stop()}}),e)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"getUploadImageInfo",value:(t=o()(p.a.mark((function e(t,n,r){var i,a,l,c,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.url,a=n.width,l=n.height,!r){e.next=7;break}return c=new Image,s=new URL(n.url),c.src="".concat(s.protocol,"//").concat(s.hostname).concat(s.pathname,"?imageView2/2/w/400/h/400"),c.crossOrigin="Anonymous",e.abrupt("return",new Promise((function(e){c.onload=o()(p.a.mark((function n(){var r,o,s,u,d;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.props.style,o=r.width,s=r.height,n.next=3,f.a.crop(c,{width:o,height:s});case 3:return u=n.sent,d=u.topCrop,n.abrupt("return",e({src:i,width:a,height:l,srcRect:{l:d.x/c.width,r:(c.width-d.width-d.x)/c.width,t:d.y/c.height,b:(c.height-d.height-d.y)/c.height}}));case 6:case"end":return n.stop()}}),n)})))})));case 7:return e.abrupt("return",{src:i,width:a,height:l});case 8:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}()},bc0b51de4b:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-theme-color-title-2LZzp{width:100%;height:28px}.index-theme-color-container-3VkyG{width:213px;position:relative;height:414px}.index-theme-color-list-container-1ROV4{width:213px;height:412px}.index-theme-preview-title-container-3jUuS{width:100%;height:28px;line-height:28px;font-size:12px;font-weight:400;margin-bottom:8px;color:rgba(0,0,0,.88)}.index-theme-tab-button-container-151Li{width:212px;height:36px;display:flex;overflow-y:auto;padding:0;font-weight:600;overflow-x:auto;border-bottom:1px solid rgba(0,0,0,.04)}.index-theme-tab-content-container-3qgRE{box-sizing:content-box;width:193px;padding:16px 10px;height:344px;overflow-y:auto}",""]),t.locals={"theme-color-title":"index-theme-color-title-2LZzp","theme-color-container":"index-theme-color-container-3VkyG","theme-color-list-container":"index-theme-color-list-container-1ROV4","theme-preview-title-container":"index-theme-preview-title-container-3jUuS","theme-tab-button-container":"index-theme-tab-button-container-151Li","theme-tab-content-container":"index-theme-tab-content-container-3qgRE"}},c287259219:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),c=n.n(l),s=n("85d0a7609b"),u=n.n(s),d=n("3ef2352f0b"),p=n.n(d),h=(n("c6244f7705"),n("081c8cafea"),function(){function e(){o()(this,e),u()(this,"inject",void 0)}var t;return c()(e,[{key:"loadWorkBench",value:function(e){var t=this,n=this.getWorkbenchLoader();n&&n.then((function(n){t.load(n,e)}))}},{key:"setWorkbenchInject",value:function(e){this.inject=e}},{key:"load",value:function(e,t){}},{key:"getWorkbenchLoader",value:(t=i()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.inject.getWorkbenchLoader();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}())},c6ab6fafd7:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".theme-edit-custom-dialog-custom-theme-modal-container-3tQLN{width:480px;height:600px;padding:0}.theme-edit-custom-dialog-custom-theme-dialog-content-container-2NQ7O{width:100%;box-sizing:border-box;position:relative;justify-content:space-between;border-top:1px solid #e8e8e8}.theme-edit-custom-dialog-custom-theme-dialog-title-wrapper-1GtUW{width:100%;height:60px;padding:16px 24px;display:flex}.theme-edit-custom-dialog-custom-theme-dialog-content-wrapper-1fYxj{width:100%;height:392px;padding:8px 24px;display:flex;justify-content:space-between;-webkit-user-select:none;-ms-user-select:none;user-select:none}.theme-edit-custom-dialog-custom-theme-dialog-title-label-3aouU{width:-webkit-max-content;width:max-content;flex-shrink:0;line-height:28px;margin-right:16px;-webkit-user-select:none;-ms-user-select:none;user-select:none}.theme-edit-custom-dialog-custom-theme-dialog-title-input-fRAHT,.theme-edit-custom-dialog-custom-theme-dialog-title-label-3aouU{height:28px;font-family:PingFang SC;font-size:12px;font-style:normal;font-weight:400}.theme-edit-custom-dialog-custom-theme-dialog-title-input-fRAHT{line-height:16px;width:100%}",""]),t.locals={"custom-theme-modal-container":"theme-edit-custom-dialog-custom-theme-modal-container-3tQLN","custom-theme-dialog-content-container":"theme-edit-custom-dialog-custom-theme-dialog-content-container-2NQ7O","custom-theme-dialog-title-wrapper":"theme-edit-custom-dialog-custom-theme-dialog-title-wrapper-1GtUW","custom-theme-dialog-content-wrapper":"theme-edit-custom-dialog-custom-theme-dialog-content-wrapper-1fYxj","custom-theme-dialog-title-label":"theme-edit-custom-dialog-custom-theme-dialog-title-label-3aouU","custom-theme-dialog-title-input":"theme-edit-custom-dialog-custom-theme-dialog-title-input-fRAHT"}},c76eaa6cfc:function(e,t,n){"use strict";n.r(t),n.d(t,"SlideRatingService",(function(){return Se}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),l=n("6a364eb35c"),c=n.n(l),s=n("85d0a7609b"),u=n.n(s),d=n("3ef2352f0b"),p=n.n(d),h=(n("c6244f7705"),n("081c8cafea"),n("960b6aae64")),f=n("69084d01d3"),m=n.n(f),v=n("6884e1a126"),g=n("432f93125e"),b=n("f27f5f5885"),y=n("617779fa67"),x=(n("73b854064b"),n("547611bd96")),w=n.n(x),S=n("bd29e2df90"),k=n.n(S),C=n("ab5eb40518"),E=n.n(C),I=n("1b4cdd6a36"),T=n.n(I),R=(n("826dc923b3"),n("1748118723")),M=n.n(R),O=n("e792a3169a"),N=n.n(O),L=n("024406998c"),z=n.n(L),j={insert:"head",singleton:!1},P=(N()(z.a,j),z.a.locals||{}),D=n("5fac0349d3"),A=n("9be7889667"),B=n.n(A),F=n("65eb29f3e3"),H=n.n(F),W=n("f3eee4d92d"),U=n.n(W),G=n("11246a1392"),V=n.n(G),Z=(n("3bf1976a4f"),n("6e20b6a7d8"),n("a84962d637"),n("f45588a8ad"),n("51619f2820")),_=n("44cf80cf4d"),Y=n("153d52ecaa"),X=n("b0a63a7ae8"),K=(n("183cd0b9a0"),n("14f9f3f014")),J=n.n(K),Q={insert:"head",singleton:!1},q=(N()(J.a,Q),J.a.locals||{}),$=n("83a2fe5ac5"),ee=n.n($),te=n("94447f525f"),ne=n.n(te),re=n("915616c11c"),ie=n("cc17a96b7f"),ae=n("e0a67dc3fe");function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return E()(this,n)}}var le=Y.a.Panel,ce=X.a.ListItem,se=function(e){k()(n,e);var t=oe(n);function n(){var e;o()(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),u()(w()(e),"renderCollapseItem",(function(t,n){return t.resultType===_.a.SUCCESS?m.a.createElement(le,{style:{borderBottom:"1px solid rgba(0, 0, 0, 0.08)"},value:"success-".concat(n),header:e.renderItemHeader(t),disabled:!0}):m.a.createElement(le,{style:{borderBottom:"1px solid rgba(0, 0, 0, 0.08)"},value:"fail-".concat(n),header:e.renderItemHeader(t)},e.renderFailDescription(t))})),u()(w()(e),"refresh",(function(t){t.resultType===_.a.SUCCESS&&e.props.analyzer.calculateScore(),e.setState({})})),e}return c()(n,[{key:"render",value:function(){var e=this,t=this.getDataSource();return m.a.createElement("div",{style:{width:"100%",height:"100%"}},m.a.createElement("div",{style:{display:"flex",flexDirection:"row",margin:"0px 16px",padding:"16px",borderRadius:"4px",background:"#F9FAFB"}},m.a.createElement("div",{style:{width:"112px"}},m.a.createElement("div",{className:q["rating-result-title"]},D.a.t("最后得分")),m.a.createElement("div",{className:q["rating-result-title-description"]},this.renderScoreDescription())),m.a.createElement("div",{style:{position:"relative",left:"20px"}},m.a.createElement(Z.a,{score:this.props.analyzer.score}))),m.a.createElement("div",{style:{height:"100%",marginTop:"20px",position:"relative",marginRight:"16px",marginLeft:"16px"}},m.a.createElement("div",{style:{position:"relative",inset:0,overflowY:"auto",overflowX:"hidden"}},m.a.createElement(Y.a,{expandMutex:!0,borderless:!0,expandIcon:!1},t.map((function(t,n){return e.renderCollapseItem(t,n)}))))),this.showRatingAndImprove()&&m.a.createElement("div",{style:{height:"50px",position:"relative",paddingTop:"32px",fontSize:"12px",textAlign:"center",color:"rgba(0, 0, 0, 0.48)"}},D.a.t("评分不准？"),m.a.createElement("span",{style:{color:"#175ceb",cursor:"pointer",textDecoration:"underline"},onClick:function(){Object(re.a)({url:"https://docs.qq.com/form/page/DZU50akpzWENrbW5w",replace:!1,windowName:"_blank"})}},D.a.t("帮助我们提升"))))}},{key:"renderItemHeader",value:function(e){var t=e.resultType===_.a.SUCCESS;return m.a.createElement("div",{style:{position:"relative",left:"-16px",display:"flex",flexDirection:"row"}},m.a.createElement("div",null,this.renderItemAvatar(e)),m.a.createElement("div",{style:{position:"relative",left:"10px"}},m.a.createElement("div",{className:q["rating-result-item-title"]},e.analyzerName),m.a.createElement("div",{className:q["rating-result-item-description"]},e.description),!t&&e.handleProblem&&!this.hideSsvEntrance()&&m.a.createElement("button",{className:q["rating-result-item-handle"],onClick:this.onCollapseItemClick.bind(this,e)},D.a.t("去优化"))))}},{key:"renderItemAvatar",value:function(e){return e.resultType===_.a.SUCCESS?m.a.createElement("div",{style:{height:"100%"}},m.a.createElement("img",{className:q["rating-result-item-img-true"],src:ee.a})):m.a.createElement("div",{style:{height:"100%"}},m.a.createElement("img",{className:q["rating-result-item-img-false"],src:ne.a}))}},{key:"renderFailDescription",value:function(e){var t,n=this;return m.a.createElement(X.a,{size:"small",style:{position:"relative",width:"calc(100% + 30px)",left:"-15px",top:"-15px",marginBottom:"-18px"}},null===(t=e.getDescriptionWithSelect())||void 0===t?void 0:t.map((function(t,r){return m.a.createElement(ce,{style:{paddingLeft:"0px",paddingRight:"0px"},action:t.selectElement&&m.a.createElement("button",{className:q["rating-result-list-item-handle"],onClick:function(){var i,a;if(null!==(i=t.selectSlide)&&void 0!==i&&i.sdkData&&null!==(a=t.selectElement)&&void 0!==a&&a.sdkData){var o;n.props.selectionService.selectedSlides.clear();var l=null===(o=t.selectSlide.presentationRef)||void 0===o?void 0:o.indexOfSlide(t.selectSlide);void 0!==l&&-1!==l&&(n.props.selectionService.currentSlideIndex=l,n.props.selectionService.selectedElements.clear(),n.props.selectionService.selectedElements.add(t.selectElement))}if(t.handleProblem)return t.handleProblem(r),void n.refresh(e)}},D.a.t("去处理")),key:r},m.a.createElement("div",{className:q["rating-result-list-item-description"],style:{cursor:t.selectable?"pointer":"default"},onClick:function(){if(t.selectSlide&&t.selectElement){var e;n.props.selectionService.selectedSlides.clear();var r=null===(e=t.selectSlide.presentationRef)||void 0===e?void 0:e.indexOfSlide(t.selectSlide);void 0!==r&&-1!==r&&(n.props.selectionService.currentSlideIndex=r,n.props.selectionService.selectedElements.clear(),n.props.selectionService.selectedElements.add(t.selectElement))}}},t.description))})))}},{key:"onCollapseItemClick",value:function(e,t){var n,r,i,a=this;null==t||null===(n=t.preventDefault)||void 0===n||n.call(t),null==t||null===(r=t.stopPropagation)||void 0===r||r.call(t),null===(i=e.handleProblem)||void 0===i||i.call(e,(function(){e.resultType=_.a.SUCCESS,a.refresh(e)}))}},{key:"getDataSource",value:function(){var e=this.props.analyzer.textAnalyzer.fontUseNumberResult;return e?[this.props.analyzer.textAnalyzer.titleFontSizeResult,this.props.analyzer.textAnalyzer.subTitleFontSizeResult,this.props.analyzer.textAnalyzer.lineSpacingResult,e,this.props.analyzer.textAnalyzer.textOverlapResult,this.props.analyzer.colorAnalyzer.textColorContrastResult,this.props.analyzer.titleAlignmentResult]:[]}},{key:"renderScoreDescription",value:function(){var e=this.props.analyzer.score;return e>=90?D.a.t("检测到你的幻灯片非常棒！"):e>=60?D.a.t("检测到你的幻灯片有点小问题"):D.a.t("检测到你的幻灯片有些问题")}},{key:"showRatingAndImprove",value:function(){return!Object(ie.a)()}},{key:"hideSsvEntrance",value:function(){return Object(ae.b)("custom.common.hideSsv",!1)}}]),n}(m.a.Component),ue=n("3404d6c52c"),de=n.n(ue),pe=n("d3d31c86eb"),he=n("9da6335152");function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return E()(this,n)}}var me=function(e){k()(n,e);var t=fe(n);function n(e){var r;return o()(this,n),r=t.call(this,e),u()(w()(r),"onConfirmClick",(function(){var e=de.a.show({tip:D.a.t("正在进行分析..."),zIndex:11001});setTimeout(i()(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.props.analyzer.analysis();case 2:e.close(),r.setState({isConfirm:!0}),n=r.getObjFromResult(),Object(pe.c)({opername:he.e.DOC_PPT,module:he.d.AUTO_BEAUTIFY,action:he.b.BEAUTIFY_SUCCESS,ver5:r.props.analyzer.score,ver6:JSON.stringify(n)});case 6:case"end":return t.stop()}}),t)}))),0)})),r.state={isConfirm:!1},r}return c()(n,[{key:"render",value:function(){return m.a.createElement("div",{className:M()(P.rating,[P["rating-drawer"]])},m.a.createElement("div",{className:M()(P["rating-header"])},m.a.createElement("div",{className:P["rating-header-title"]},D.a.t("排版检查和建议")),m.a.createElement("img",{className:P["rating-header-close"],src:B.a,onClick:this.props.onCloseClick})),this.state.isConfirm?this.renderResult():this.renderGuide())}},{key:"renderGuide",value:function(){return m.a.createElement("div",{className:P["rating-content-wrapper"]},m.a.createElement("img",{className:P["blank-search"],src:U.a}),m.a.createElement("div",{className:P["rating-content-title"]},D.a.t("检查和建议")),m.a.createElement("div",{className:P["rating-text-wrapper"]},m.a.createElement("div",{className:M()(P["rating-text-row"]),style:{marginTop:"19px"}},m.a.createElement("img",{className:P["rating-text-img"],src:H.a}),m.a.createElement("div",{className:P["rating-name"]},D.a.t("检测排版常见问题"))),m.a.createElement("div",{className:M()(P["rating-text-row"])},m.a.createElement("img",{className:P["rating-text-img"],src:H.a}),m.a.createElement("div",{className:P["rating-name"]},D.a.t("检测排版对齐问题"))),m.a.createElement("div",{className:M()(P["rating-text-row"])},m.a.createElement("img",{className:P["rating-text-img"],src:H.a}),m.a.createElement("div",{className:P["rating-name"]},D.a.t("检测色彩可视对比度")))),m.a.createElement(V.a,{type:"primary",className:P["rating-confirm"],onClick:this.onConfirmClick},D.a.t("立即检查")))}},{key:"renderResult",value:function(){return m.a.createElement(se,{analyzer:this.props.analyzer,selectionService:this.props.selectionService})}},{key:"getObjFromResult",value:function(){var e={},t=this.props.analyzer.textAnalyzer.titleFontSizeResult.getShowResult().length,n=this.props.analyzer.textAnalyzer.subTitleFontSizeResult.getShowResult().length,r=this.props.analyzer.textAnalyzer.lineSpacingResult.resultInfo.length,i=this.props.analyzer.textAnalyzer.fontUseNumberResult,a=null==i?void 0:i.resultInfo,o=this.props.analyzer.textAnalyzer.textOverlapResult.resultInfo.length,l=this.props.analyzer.colorAnalyzer.textColorContrastResult.getShowResult().length,c=this.props.analyzer.titleAlignmentResult.resultType;return t>0&&(e.titleFont=t),n>0&&(e.subTitleFont=n),r>0&&(e.lineSpacing=r),i&&Number(a)>0&&(e.fontNum=a),o>0&&(e.textOverlap=o),l>0&&(e.contrast=l),c===_.a.ERROR&&(e.titleAlign=1),e}}]),n}(m.a.Component),ve=n("d5c3deb8c7"),ge=n("844f02e987"),be=n("bb66f259e0"),ye=n("afaa9e9ffa"),xe=n("05d181ac40"),we=n("4f3b15d017"),Se=function(){function e(t,n,r,i,a,l,c,s,d){var p=this;o()(this,e),u()(this,"analyzer",void 0),u()(this,"selectionService",void 0),u()(this,"drawerService",void 0),u()(this,"autoShowStrategy",void 0),u()(this,"close",(function(){p.drawerStateManager.promise().then((function(e){p.rightSideBarManager.isSlideRatingShown=!1,e.closeRightDrawer(b.b.SLIDE_RATING_DRAWER),window.dispatchEvent(new Event("resize"))}))})),u()(this,"showUniformFontUI",(function(e,t){var n=we.default.isMac?"PingFang SC":"Microsoft YaHei",r={titleFontEa:n,titleFontLatin:n,contentFontEa:n,contentFontLatin:n};p.quickTookDialogManager.promise().then((function(n){n.showUniformFontDialog(void 0,e,t,r)})),Object(pe.c)({opername:he.e.DOC_PPT,module:he.d.AUTO_BEAUTIFY,action:he.b.BEAUTIFY_FONT_QUANTITY})})),u()(this,"showContentChangeUI",(function(e){p.slideContentPreviewService.promise().then((function(t){t.show({title:D.a.t("标题对齐预览"),originList:e.originSlideList,previewList:e.toChangeSlideList,slideIndexArray:e.toChangeSlideIndexArray,slideWidth:e.slideWidth,slideHeight:e.slideHeight,previewRects:e.toChangeElementRects,onConfirmButtonClick:e.onConfirmModify,onCancel:e.onCancel})})),Object(pe.c)({opername:he.e.DOC_PPT,module:he.d.AUTO_BEAUTIFY,action:he.b.BEAUTIFY_TITLE_ALIGNMENT_VIEW})})),this.quickTookDialogManager=a,this.rightSideBarService=l,this.slideContentPreviewService=c,this.drawerStateManager=s,this.rightSideBarManager=d,this.selectionService=n,this.rightSideBarService=l,this.analyzer=new h.a({forbidFontUseNumber:!1},t,r,i,this.showUniformFontUI,this.showContentChangeUI),this.drawerService=v.e.get(g.c),this.autoShowStrategy=new ge.a,Object(ve.r)((function(){return p.rightSideBarManager.isSlideRatingShown}),(function(e){e&&(p.rightSideBarService.hide(),p.rightSideBarManager.setIsPropertyEditorShown(!1),p.rightSideBarManager.setIsAnimationEditorShown(!1),p.rightSideBarManager.setIsSelectWindowShown(!1))}),{fireImmediately:!0})}var t;return c()(e,[{key:"autoShow",value:(t=i()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be.a.getKeyValueFromMap(ye.b.SLIDE_AUTO_LAYOUT_CHECK_ENTRY)){e.next=2;break}return e.abrupt("return");case 2:if(!xe.a.IS_LOCAL_EDIT){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.autoShowStrategy.checkIfAutoShow();case 6:e.sent&&(this.showDrawer(!0),this.autoShowStrategy.recordShow());case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"showDrawer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rightSideBarManager.isSlideRatingShown=!0,this.drawerService.showRightDrawer({name:b.b.SLIDE_RATING_DRAWER,content:m.a.createElement(me,{onCloseClick:function(){e.close()},analyzer:this.analyzer,selectionService:this.selectionService}),onClose:this.close,showCloseButton:!1,style:{height:y.DRAWER_HEIGHT,paddingTop:0}}),this.drawerStateManager.promise().then((function(e){e.handleDrawerHolderVisiable(!0),window.dispatchEvent(new Event("resize"))})),Object(pe.c)({opername:he.e.DOC_PPT,module:he.d.AUTO_BEAUTIFY,action:he.b.BEAUTIFY_FUNCTION_VIEW,ver5:t?1:0})}},{key:"hideDrawer",value:function(){}},{key:"onEntryClick",value:function(){this.showDrawer()}}]),e}()},c92b53bd0d:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".index-horizontalTextRulerContainer-3c9HU{position:sticky;top:0;z-index:3;width:0;height:0}.index-horizontalTextRulerInnerContainer-GZT43{background-color:#fff;box-sizing:content-box;height:14px;min-width:100%;position:absolute;top:0;left:14px}.index-changeTabButtonContainer-1TXOY{background-color:#fff;top:0}.index-changeTabButtonContainer-1TXOY,.index-verticalTextRulerContainer-cmxfP{position:sticky;left:0;width:0;height:0;z-index:3}.index-verticalTextRulerInnerContainer-3ijo7{background-color:#fff;box-sizing:content-box;width:14px;min-height:100%;position:absolute;top:14px;left:0}",""]),t.locals={horizontalTextRulerContainer:"index-horizontalTextRulerContainer-3c9HU",horizontalTextRulerInnerContainer:"index-horizontalTextRulerInnerContainer-GZT43",changeTabButtonContainer:"index-changeTabButtonContainer-1TXOY",verticalTextRulerContainer:"index-verticalTextRulerContainer-cmxfP",verticalTextRulerInnerContainer:"index-verticalTextRulerInnerContainer-3ijo7"}},cb6124fa19:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".double-arrow-line-snap-line-double-arrow-line-2diy7{position:absolute;pointer-events:none}",""]),t.locals={"snap-line-double-arrow-line":"double-arrow-line-snap-line-double-arrow-line-2diy7"}},cfcad8f674:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".dot-line-snap-line-dot-line-DeeLp{position:absolute;pointer-events:none}",""]),t.locals={"snap-line-dot-line":"dot-line-snap-line-dot-line-DeeLp"}},d0ab5c54b5:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUwOTYgN0wxOSA4LjQ5OTc0TDExLjU0NDcgMTYuMDAxMUwxOC45OTYzIDIzLjUwMDNMMTcuNTA1OSAyNUw5LjMwODY3IDE2Ljc1MTRDOC44OTcxMSAxNi4zMzczIDguODk3MTEgMTUuNjY1OCA5LjMwODY3IDE1LjI1MTdMMTcuNTA5NiA3WiIgZmlsbD0iIzQ1NEQ1QSIgc3R5bGU9ImZpbGw6IzQ1NEQ1QTtmaWxsOmNvbG9yKGRpc3BsYXktcDMgMC4yNzA2IDAuMzAyMCAwLjM1MjkpO2ZpbGwtb3BhY2l0eToxOyIvPgo8L3N2Zz4K"},d276997441:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));n("73b854064b");var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),l=n("bd29e2df90"),c=n.n(l),s=n("ab5eb40518"),u=n.n(s),d=n("1b4cdd6a36"),p=n.n(d),h=n("c287259219"),f=n("9623a26d49");function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var v=function(e){c()(n,e);var t=m(n);function n(){return i()(this,n),t.apply(this,arguments)}return o()(n,[{key:"load",value:function(e,t){f.a.load(e,t)}}]),n}(h.a)},dc62871a42:function(e,t,n){"use strict";n.d(t,"b",(function(){return je})),n.d(t,"a",(function(){return Ge}));n("73b854064b");var r,i=n("9132715560"),a=n.n(i),o=n("6a364eb35c"),l=n.n(o),c=n("547611bd96"),s=n.n(c),u=n("bd29e2df90"),d=n.n(u),p=n("ab5eb40518"),h=n.n(p),f=n("1b4cdd6a36"),m=n.n(f),v=n("85d0a7609b"),g=n.n(v),b=n("69084d01d3"),y=n.n(b),x=n("176815363d"),w=n.n(x),S=n("3ef2352f0b"),k=n.n(S),C=(n("c6244f7705"),n("081c8cafea"),n("1748118723")),E=n.n(C),I=n("5fac0349d3"),T=n("c177e55ba5"),R=n.n(T),M=n("d0e9d6a0df"),O=n.n(M),N=n("d3d31c86eb"),L=n("9da6335152"),z=n("44cf80cf4d"),j=n("e792a3169a"),P=n.n(j),D=n("699a7c7362"),A=n.n(D),B={insert:"head",singleton:!1},F=(P()(A.a,B),A.a.locals||{}),H=n("1d76b2769d"),W=n.n(H),U=n("2d2aae0381"),G=n.n(U),V=(n("3bf1976a4f"),n("6e20b6a7d8"),n("a84962d637"),n("f45588a8ad"),n("51619f2820")),Z=n("8b13fcae36"),_=n("8e6e14785a"),Y=n.n(_),X={insert:"head",singleton:!1},K=(P()(Y.a,X),Y.a.locals||{}),J=n("14502724a6"),Q=n.n(J),q=n("e30289fafa"),$=n.n(q),ee={insert:"head",singleton:!1},te=(P()($.a,ee),$.a.locals||{}),ne=function(e){var t=e.title,n=e.content,r=e.isOpen,i=e.collapsible,a=e.onClick,o=Object(b.useRef)(null),l=Object(b.useState)(0),c=Q()(l,2),s=c[0],u=c[1];return Object(b.useEffect)((function(){var e;r?u((null===(e=o.current)||void 0===e?void 0:e.scrollHeight)||"auto"):u(0)}),[r]),Object(b.useEffect)((function(){var e;r&&u((null===(e=o.current)||void 0===e?void 0:e.scrollHeight)||"auto")})),y.a.createElement("div",{className:te["collapse-item"]},y.a.createElement("div",{className:te["collapse-title"],onClick:i?a:void 0},t),i&&y.a.createElement("div",{className:te["collapse-content"],style:{height:s}},y.a.createElement("div",{ref:o,className:te["collapse-content-inner"]},n)))},re=function(e){var t=e.items,n=Object(b.useState)(null),r=Q()(n,2),i=r[0],a=r[1];return y.a.createElement("div",{className:te["collapse-container"]},t.map((function(e,t){return y.a.createElement(ne,{key:t,title:e.title,content:e.content,isOpen:i===t,collapsible:e.collapsible,onClick:function(){return function(e){a(i===e?null:e)}(t)}})})))},ie=n("e7bdeb75b3"),ae=n.n(ie),oe=n("53df874fd3"),le=n.n(oe);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}!function(e){e[e.Preview=0]="Preview",e[e.Edit=1]="Edit"}(r||(r={}));var se,ue=function(e){d()(n,e);var t=ce(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),g()(s()(e),"refresh",(function(t){t.resultType===z.a.SUCCESS&&e.props.analyzer.calculateScore(),e.setState({})})),e}return l()(n,[{key:"render",value:function(){var e=this.getDataSource();return y.a.createElement("div",{style:{width:"100%",height:"100%",overflowY:"scroll"}},y.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"}},y.a.createElement("div",{style:{marginTop:"24px"}},y.a.createElement(V.a,{score:this.props.analyzer.score})),y.a.createElement("span",{style:{marginTop:"10px"},className:K["rating-result-title"]},I.a.t("最后得分")),y.a.createElement("div",{style:{marginTop:"4px",marginBottom:"24px"},className:K["rating-result-title-description"]},this.renderScoreDescription())),y.a.createElement("div",{style:{position:"relative",marginRight:"16px",marginLeft:"16px"}},y.a.createElement("div",{style:{position:"relative",inset:0,overflowY:"auto",overflowX:"hidden"}},y.a.createElement(re,{items:this.getResultItems(e)}))),this.props.mode===r.Preview&&this.props.analyzer.score<100&&y.a.createElement(R.a,{type:"primary",className:K["rating-result-to-optimize"],onClick:this.props.handleToOptimizeOnPreviewMode},I.a.t("去优化")),y.a.createElement("div",{className:K["rating-result-suggestion"]},I.a.t("评分不准？"),y.a.createElement("span",{style:{color:"#175ceb",cursor:"pointer"},onClick:function(){Object(Z.tencentDocOpenUrlForAll)({url:"https://docs.qq.com/form/page/DZU50akpzWENrbW5w",replace:!1,windowName:"_blank"})}},I.a.t("帮助我们提升"))))}},{key:"getResultItems",value:function(e){var t=this;return e.map((function(e,n){return{title:t.renderItemTitle(e),content:t.renderItemContent(e),collapsible:e.resultType!==z.a.SUCCESS}}))}},{key:"renderItemTitle",value:function(e){var t=e.resultType===z.a.SUCCESS,n=t?ae.a:le.a;return y.a.createElement(y.a.Fragment,null,y.a.createElement("div",null,y.a.createElement("img",{className:K["collapse-icon"],src:n})),y.a.createElement("div",{className:K["collapse-text"]},y.a.createElement("div",{className:K["collapse-title-text"]},e.analyzerName),y.a.createElement("div",{className:K["collapse-description-text"],style:{marginTop:"4px"}},e.description)),y.a.createElement("div",{style:{marginLeft:"auto",display:"flex"}},!t&&this.props.mode!==r.Preview&&e.handleProblem&&y.a.createElement("button",{style:{marginRight:"8px"},className:K["collapse-handle-button"],onClick:this.onCollapseItemClick.bind(this,e)},I.a.t("去优化"))))}},{key:"renderItemContent",value:function(e){var t,n=this;if(!(e.resultType===z.a.SUCCESS))return y.a.createElement("div",null,null===(t=e.getDescriptionWithSelect())||void 0===t?void 0:t.map((function(t,i){return y.a.createElement("div",{key:i,style:{display:"flex",justifyContent:"space-between",paddingBottom:"10px"},onClick:n.handleItemClick.bind(n,t)},y.a.createElement("span",{style:{width:"calc(100% - 50px)"}}," ",t.description),n.props.mode===r.Edit&&t.selectElement&&y.a.createElement("button",{className:K["rating-result-item-handle-button"],onClick:n.handleItemButtonClick.bind(n,e,t,i)}," ",I.a.t("去处理")))})))}},{key:"handleItemClick",value:function(e){if(e.selectSlide&&e.selectElement){var t,n;null===(t=this.props.selectionService)||void 0===t||t.selectedSlides.clear();var r=null===(n=e.selectSlide.presentationRef)||void 0===n?void 0:n.indexOfSlide(e.selectSlide);void 0!==r&&-1!==r&&this.props.selectionService&&(this.props.selectionService.currentSlideIndex=r,this.props.selectionService.selectedElements.clear(),this.props.selectionService.selectedElements.add(e.selectElement))}}},{key:"handleItemButtonClick",value:function(e,t,n){var r,i;if(null!==(r=t.selectSlide)&&void 0!==r&&r.sdkData&&null!==(i=t.selectElement)&&void 0!==i&&i.sdkData){var a,o;null===(a=this.props.selectionService)||void 0===a||a.selectedSlides.clear();var l=null===(o=t.selectSlide.presentationRef)||void 0===o?void 0:o.indexOfSlide(t.selectSlide);void 0!==l&&-1!==l&&this.props.selectionService&&(this.props.selectionService.currentSlideIndex=l,this.props.selectionService.selectedElements.clear(),this.props.selectionService.selectedElements.add(t.selectElement))}if(t.handleProblem)return t.handleProblem(n),void this.refresh(e)}},{key:"onCollapseItemClick",value:function(e,t){var n,r,i=this;null==t||null===(n=t.stopPropagation)||void 0===n||n.call(t),null===(r=e.handleProblem)||void 0===r||r.call(e,(function(){e.resultType=z.a.SUCCESS,i.refresh(e)}))}},{key:"getDataSource",value:function(){return[this.props.analyzer.textAnalyzer.titleFontSizeResult,this.props.analyzer.textAnalyzer.subTitleFontSizeResult,this.props.analyzer.textAnalyzer.lineSpacingResult,this.props.analyzer.textAnalyzer.textOverlapResult,this.props.analyzer.colorAnalyzer.textColorContrastResult,this.props.analyzer.titleAlignmentResult]}},{key:"renderScoreDescription",value:function(){var e=this.props.analyzer.score;return e>=90?I.a.t("检测到你的幻灯片非常棒！"):e>=60?I.a.t("检测到你的幻灯片有点小问题"):I.a.t("检测到你的幻灯片有些问题")}}]),n}(y.a.Component);function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}!function(e){e[e.Guide=0]="Guide",e[e.Result=1]="Result"}(se||(se={}));var pe,he=function(e){d()(n,e);var t=de(n);function n(e){var r;return a()(this,n),r=t.call(this,e),g()(s()(r),"onConfirmClick",(function(){var e=O.a.show({tip:I.a.t("正在进行分析..."),zIndex:11001});setTimeout(w()(k.a.mark((function t(){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.props.analyzer.analysis();case 2:e.close(),r.setState({isConfirm:!0}),n=r.getObjFromResult(),Object(N.c)({opername:L.e.DOC_PPT,module:L.d.AUTO_BEAUTIFY,action:L.b.BEAUTIFY_SUCCESS,ver5:r.props.analyzer.score,ver6:JSON.stringify(n)});case 6:case"end":return t.stop()}}),t)}))),0)})),r.state={isConfirm:!1},r}return l()(n,[{key:"render",value:function(){return y.a.createElement("div",{className:F.rating,style:{display:this.props.hidden?"none":"flex",width:"100%",height:"100%"}},this.state.isConfirm||this.props.enterType!==se.Guide?this.renderResult():this.renderGuide(this.props.resultMode))}},{key:"renderGuide",value:function(e){return e===r.Preview?y.a.createElement("div",{className:F["rating-content-wrapper"]},y.a.createElement("img",{style:{width:"160px",height:"160px"},src:W.a}),y.a.createElement("div",{className:F["rating-text-wrapper"]},y.a.createElement("div",{className:E()(F["rating-text-row"])},y.a.createElement("img",{className:F["rating-text-img"],src:G.a}),y.a.createElement("div",{className:F["rating-name"]},I.a.t("检测排版常见问题"))),y.a.createElement("div",{className:E()(F["rating-text-row"])},y.a.createElement("img",{className:F["rating-text-img"],src:G.a}),y.a.createElement("div",{className:F["rating-name"]},I.a.t("检测排版对齐问题"))),y.a.createElement("div",{className:E()(F["rating-text-row"])},y.a.createElement("img",{className:F["rating-text-img"],src:G.a}),y.a.createElement("div",{className:F["rating-name"]},I.a.t("检测色彩可视对比度")))),y.a.createElement(R.a,{type:"primary",className:F["rating-confirm"],style:{marginTop:"24px",marginBottom:"24px"},onClick:this.onConfirmClick},I.a.t("立即检查"))):y.a.createElement("div",{className:F["rating-content-wrapper"],style:{justifyContent:"space-evenly",padding:"24px 0"}},y.a.createElement("div",{style:{display:"flex"}},y.a.createElement("img",{style:{width:"120px",height:"120px"},src:W.a}),y.a.createElement("div",{className:F["rating-text-wrapper"]},y.a.createElement("div",{className:E()(F["rating-text-row"])},y.a.createElement("img",{className:F["rating-text-img"],src:G.a}),y.a.createElement("div",{className:F["rating-name"]},I.a.t("检测排版常见问题"))),y.a.createElement("div",{className:E()(F["rating-text-row"])},y.a.createElement("img",{className:F["rating-text-img"],src:G.a}),y.a.createElement("div",{className:F["rating-name"]},I.a.t("检测排版对齐问题"))),y.a.createElement("div",{className:E()(F["rating-text-row"])},y.a.createElement("img",{className:F["rating-text-img"],src:G.a}),y.a.createElement("div",{className:F["rating-name"]},I.a.t("检测色彩可视对比度"))))),y.a.createElement(R.a,{type:"primary",className:F["rating-confirm"],onClick:this.onConfirmClick},I.a.t("立即检查")))}},{key:"renderResult",value:function(){return y.a.createElement(ue,{mode:this.props.resultMode,analyzer:this.props.analyzer,selectionService:this.props.selectionService,handleToOptimizeOnPreviewMode:this.props.handleToOptimize})}},{key:"getObjFromResult",value:function(){var e={},t=this.props.analyzer.textAnalyzer.titleFontSizeResult.getShowResult().length,n=this.props.analyzer.textAnalyzer.subTitleFontSizeResult.getShowResult().length,r=this.props.analyzer.textAnalyzer.lineSpacingResult.resultInfo.length,i=this.props.analyzer.textAnalyzer.textOverlapResult.resultInfo.length,a=this.props.analyzer.colorAnalyzer.textColorContrastResult.getShowResult().length,o=this.props.analyzer.titleAlignmentResult.resultType;return t>0&&(e.titleFont=t),n>0&&(e.subTitleFont=n),r>0&&(e.lineSpacing=r),i>0&&(e.textOverlap=i),a>0&&(e.contrast=a),o===z.a.ERROR&&(e.titleAlign=1),e}}]),n}(y.a.Component),fe=n("1a00d79b5b"),me=n("3a624849bf"),ve=n.n(me),ge={insert:"head",singleton:!1},be=(P()(ve.a,ge),ve.a.locals||{});!function(e){e.Before="before",e.Adjusted="adjusted"}(pe||(pe={}));var ye=function(e){var t,n,r=e.onTabChange,i=Object(b.useState)("adjusted"),a=Q()(i,2),o=a[0],l=a[1],c=function(e){l(e),r(e)};return y.a.createElement("div",{className:be["tab-container"]},y.a.createElement("div",{className:E()((t={},g()(t,be.tab,!0),g()(t,be["tab-active"],o===pe.Adjusted),t)),onClick:function(){return c(pe.Adjusted)}},I.a.t("调整后")),y.a.createElement("div",{className:E()((n={},g()(n,be.tab,!0),g()(n,be["tab-active"],o===pe.Before),n)),onClick:function(){return c(pe.Before)}},I.a.t("调整前")))},xe=n("4a9af106b1"),we=n.n(xe),Se={insert:"head",singleton:!1},ke=(P()(we.a,Se),we.a.locals||{}),Ce=n("2dc6fb6ec4"),Ee=n.n(Ce),Ie={insert:"head",singleton:!1},Te=(P()(Ee.a,Ie),Ee.a.locals||{}),Re=n("1d3b3ecf9c"),Me=n("0a8ecd6412");function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var Ne=function(e){d()(n,e);var t=Oe(n);function n(e){var r;return a()(this,n),r=t.call(this,e),g()(s()(r),"length",void 0),g()(s()(r),"startX",void 0),g()(s()(r),"endX",void 0),g()(s()(r),"nextSlide",(function(){var e,t;r.props.currentIndex+1<r.length&&(null===(e=(t=r.props).onChangeIndex)||void 0===e||e.call(t,r.props.currentIndex+1))})),g()(s()(r),"prevSlide",(function(){var e,t;r.props.currentIndex-1>=0&&(null===(e=(t=r.props).onChangeIndex)||void 0===e||e.call(t,r.props.currentIndex-1))})),g()(s()(r),"handleTouchStart",(function(e){r.startX=e.touches[0].clientX,r.endX=e.touches[0].clientX})),g()(s()(r),"handleTouchMove",(function(e){r.endX=e.touches[0].clientX})),g()(s()(r),"handleTouchEnd",(function(){r.startX-r.endX>30?r.nextSlide():r.endX-r.startX>30&&r.prevSlide()})),r.length=e.slideArray.length,r.startX=0,r.endX=0,r}return l()(n,[{key:"render",value:function(){var e,t,n,r=this.props.currentIndex,i=0===r?this.length-1:r-1,a=r===this.length-1?0:r+1,o=this.props.slideArray,l=this.props.contentSize,c=!1,s=!1;0===r&&(s=!0),r===o.length-1&&(c=!0);var u=this.props.slideWidth,d=this.props.slideHeight,p=this.getScale(l.width-2,l.height-2);return y.a.createElement("div",{className:Te["swiper-container"]},y.a.createElement("div",{className:Te["swiper-wrapper"],onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,style:this.getContentWrapperLayoutStyle(s,c)},!s&&y.a.createElement("div",{className:E()((e={},g()(e,Te["swiper-slide"],!0),g()(e,Te["prev-slide"],!0),e)),style:{width:"".concat(l.width,"px"),marginLeft:"".concat(-l.width+(c?28:16),"px")},key:i},y.a.createElement(Re.a,{width:l.width-2,height:l.height-2,isShown:!0,slideModel:o[i],buildRenderTreeAsync:!1,shouldUpdate:!0,fromScale:0,region:Me.s.PAGINGSELECTION,isTemplate:!1,styles:{scaleSlideStyle:{width:"".concat(u*p,"px"),height:"".concat(d*p,"px")}}}),y.a.createElement("div",null)),y.a.createElement("div",{className:E()((t={},g()(t,Te["swiper-slide"],!0),g()(t,Te["active-slide"],!0),t)),style:{width:"".concat(l.width,"px")},key:r},y.a.createElement(Re.a,{width:l.width-2,height:l.height-2,isShown:!0,slideModel:o[r],buildRenderTreeAsync:!1,shouldUpdate:!0,fromScale:0,region:Me.s.PAGINGSELECTION,isTemplate:!1,styles:{scaleSlideStyle:{width:"".concat(u*p,"px"),height:"".concat(d*p,"px")}}}),y.a.createElement("div",null)),!c&&y.a.createElement("div",{className:E()((n={},g()(n,Te["swiper-slide"],!0),g()(n,Te["next-slide"],!0),n)),style:{width:"".concat(l.width,"px")},key:a},y.a.createElement(Re.a,{width:l.width-2,height:l.height-2,isShown:!0,slideModel:o[a],buildRenderTreeAsync:!1,shouldUpdate:!0,fromScale:0,region:Me.s.PAGINGSELECTION,isTemplate:!1,styles:{scaleSlideStyle:{width:"".concat(u*p,"px"),height:"".concat(d*p,"px")}}}),y.a.createElement("div",null))),y.a.createElement("div",{className:Te["swiper-wrapper-overlay"],onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,style:this.getContentWrapperLayoutStyle(s,c)},!s&&y.a.createElement("div",{className:Te["swiper-wrapper-overlay-left"]}),y.a.createElement("div",null),!c&&y.a.createElement("div",{className:Te["swiper-wrapper-overlay-right"]})))}},{key:"getGridTemplateColumns",value:function(e,t){var n=this.props.contentSize.width;return e&&t?"100%":t?"28px ".concat(n,"px"):e?"".concat(n,"px 28px"):"16px ".concat(n,"px 16px")}},{key:"getContentWrapperLayoutStyle",value:function(e,t){var n=this.getGridTemplateColumns(e,t);return e&&t?{gridTemplateColumns:n,margin:"0 28px"}:t?{gridTemplateColumns:n,marginRight:"16px"}:e?{gridTemplateColumns:n,marginLeft:"16px"}:{gridTemplateColumns:n}}},{key:"getScale",value:function(e,t){var n=this.props.slideWidth,r=this.props.slideHeight;return e/n<t/r?e/n:t/r}}]),n}(b.Component);function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var ze,je,Pe=function(e){d()(n,e);var t=Le(n);function n(e){var r;return a()(this,n),r=t.call(this,e),g()(s()(r),"onChangeIndex",(function(e){r.setState({currentShowIndex:e})})),r.state={tabType:pe.Adjusted,currentShowIndex:0},r}return l()(n,[{key:"render",value:function(){var e=this.props.options;return y.a.createElement("div",{style:{height:"100%"}},y.a.createElement(ye,{onTabChange:this.changeTab.bind(this)}),y.a.createElement("div",{className:ke["tab-content"]},y.a.createElement("div",{className:ke["slide-content-wrapper"]},y.a.createElement("div",{style:{width:"100%",height:"".concat(this.props.contentSize.height,"px"),marginTop:"16px",display:this.state.tabType===pe.Adjusted?"block":"none"}},y.a.createElement(Ne,{slideWidth:e.slideWidth,slideHeight:e.slideHeight,contentSize:this.props.contentSize,slideArray:e.toChangeSlideList,currentIndex:this.state.currentShowIndex,onChangeIndex:this.onChangeIndex})),y.a.createElement("div",{style:{width:"100%",height:"".concat(this.props.contentSize.height,"px"),marginTop:"16px",display:this.state.tabType===pe.Before?"block":"none"}},y.a.createElement(Ne,{slideWidth:e.slideWidth,slideHeight:e.slideHeight,contentSize:this.props.contentSize,slideArray:e.originSlideList,currentIndex:this.state.currentShowIndex,onChangeIndex:this.onChangeIndex})),y.a.createElement("div",{className:ke["slide-content-number-wrapper"]},y.a.createElement("div",{className:ke["slide-content-number-current"]},this.state.currentShowIndex+1),y.a.createElement("div",{className:ke["slide-content-number-total"]},"/".concat(e.toChangeSlideList.length))),y.a.createElement(R.a,{type:"primary",className:ke["confirm-button"],onClick:this.props.onConfirm},I.a.t("确认调整")))))}},{key:"componentDidMount",value:function(){Object(N.c)({opername:L.e.DOC_PPT,module:L.d.AUTO_BEAUTIFY,action:L.b.BEAUTIFY_TITLE_ALIGNMENT_VIEW})}},{key:"changeTab",value:function(e){this.setState({tabType:e})}}]),n}(y.a.Component),De=n("7afcef1d02"),Ae=n("0c08a07256"),Be=n("a531710d11"),Fe=n.n(Be),He=n("d5c3deb8c7"),We=n("f986b6f97c");function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}!function(e){e[e.StartAndResult=0]="StartAndResult",e[e.TitleAlignment=1]="TitleAlignment"}(ze||(ze={})),function(e){e[e.Preview=0]="Preview",e[e.Edit=1]="Edit"}(je||(je={}));var Ge=function(e){d()(n,e);var t=Ue(n);function n(e){var r;return a()(this,n),r=t.call(this,e),g()(s()(r),"titleAlignmentInfo",void 0),g()(s()(r),"enterType",void 0),g()(s()(r),"showContentChangeUI",(function(e){var t,n,i=r.calculateContentSize(e),a=null===(t=(n=r.props).getPanelFunc)||void 0===t?void 0:t.call(n);if(r.titleAlignmentInfo={options:e,contentSize:i},a)null==a||a.update({panelHeight:i.panelHeight,showHeaderBorder:!1,header:y.a.createElement(fe.a,{showBack:!0,onBack:function(){r.backToResultUI()},onClose:r.props.handleOnClose||function(){},title:I.a.t("标题对齐预览")})}),r.setState({viewType:ze.TitleAlignment});else{var o=Fe.a.show({pullable:!1,panelHeight:i.panelHeight,headerStyle:{height:"".concat(De.d,"px"),padding:"0 0"},showHeaderBorder:!1,header:y.a.createElement(fe.a,{onClose:function(){null==o||o.close()},title:I.a.t("排版检查和建议")}),content:y.a.createElement(Pe,{options:r.titleAlignmentInfo.options,contentSize:r.titleAlignmentInfo.contentSize,onConfirm:function(){var e,t;null==o||o.close(),null===(e=(t=r.titleAlignmentInfo.options).onConfirmModify)||void 0===e||e.call(t)}})}),l=Object(He.r)((function(){return We.a.isEditing}),(function(e){e||(null==o||o.close(),null==l||l())}));window.addEventListener("orientationchange",(function(){null==o||o.close()}))}})),g()(s()(r),"onConfirmChangeTitle",(function(e){var t;null===(t=e.onConfirmModify)||void 0===t||t.call(e),r.backToResultUI()})),r.state={viewType:ze.StartAndResult},r.enterType=r.props.mobileRatingService.isWaitingForShowInEdit?se.Result:se.Guide,r.props.analyzer.setShowContentChangeUI(r.showContentChangeUI),r}return l()(n,[{key:"render",value:function(){var e=this.props.scene===je.Preview?r.Preview:r.Edit;return y.a.createElement(y.a.Fragment,null,y.a.createElement(he,{enterType:this.enterType,resultMode:e,hidden:this.state.viewType!==ze.StartAndResult,analyzer:this.props.analyzer,handleToOptimize:this.props.handleToOptimize,selectionService:this.props.selectionService}),this.state.viewType===ze.TitleAlignment&&y.a.createElement(Pe,{options:this.titleAlignmentInfo.options,contentSize:this.titleAlignmentInfo.contentSize,onConfirm:this.onConfirmChangeTitle.bind(this,this.titleAlignmentInfo.options)}))}},{key:"componentDidMount",value:function(){this.props.mobileRatingService.isWaitingForShowInEdit||Object(N.c)({opername:L.e.DOC_PPT,module:L.d.AUTO_BEAUTIFY,action:L.b.BEAUTIFY_FUNCTION_VIEW}),this.props.mobileRatingService.isWaitingForShowInEdit&&(this.props.mobileRatingService.isWaitingForShowInEdit=!1)}},{key:"backToResultUI",value:function(){var e,t,n=null===(e=(t=this.props).getPanelFunc)||void 0===e?void 0:e.call(t);null==n||n.update({panelHeight:De.f,showHeaderBorder:!0,header:y.a.createElement(fe.a,{onClose:this.props.handleOnClose||function(){},title:I.a.t("排版检查和建议")})}),this.setState({viewType:ze.StartAndResult})}},{key:"calculateContentSize",value:function(e){var t=De.d+De.g+De.b+De.a+De.c,n=Object(Ae.a)()?De.e:0,r=window.innerHeight-24-t-n,i=Math.ceil(window.innerWidth-56),a=Math.ceil(i/e.slideWidth*e.slideHeight);return a<=r?{width:i,height:a,panelHeight:t+n+a}:{width:i,height:r,panelHeight:t+n+r}}}]),n}(y.a.Component)},e0a21ce4a0:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ve}));n("342844cefa"),n("a84962d637"),n("8a35b54c1d"),n("c554310b5c"),n("bcb5d93d36");var r,i=n("7a5536c9bf"),a=n.n(i),o=n("1f925d7f50"),l=n.n(o),c=n("9132715560"),s=n.n(c),u=n("6a364eb35c"),d=n.n(u),p=n("85d0a7609b"),h=n.n(p),f=n("2dc700e1e6"),m=n.n(f),v=(n("f1054791f4"),n("8ee19818c4"),n("8e7cce0ada"),n("c6244f7705"),n("081c8cafea"),n("85d48ef22b"),n("2a6f332b5e"),n("3bf1976a4f"),n("69084d01d3")),g=n.n(v),b=n("e792a3169a"),y=n.n(b),x=n("137793e5df"),w=n.n(x),S={insert:"head",singleton:!1},k=(y()(w.a,S),w.a.locals||{});!function(e){e[e.DISABLE=0]="DISABLE",e[e.ENABLE=1]="ENABLE"}(r||(r={}));var C,E=n("4abf199b59"),I=n("2c10893182"),T=n("b4973f25e8"),R=n("3c737a9d8e"),M=n("a798266a1e"),O=n("fee505096a"),N={direction:new I.a(T.c.UP),duration:1e3},L={direction:new R.a(T.d.RIGHT),duration:1250},z={direction:new M.a(T.a.RIGHT),duration:750},j={direction:new M.a(T.a.LEFT),duration:1e3},P={direction:new O.a(T.b.IN),duration:900},D={direction:new R.a(T.d.LEFT),duration:1250},A={direction:new R.a(T.d.LEFT),duration:1600},B={direction:new I.a(T.c.LEFT),duration:1200},F=(C={},h()(C,E.i.EMPTY,{}),h()(C,E.i.FADE,{duration:700}),h()(C,E.i.PUSH,N),h()(C,E.i.SWITCH,L),h()(C,E.i.CUT,{duration:100}),h()(C,E.i.PULL,z),h()(C,E.i.COVER,j),h()(C,E.i.WARP,P),h()(C,E.i.FLIP,D),h()(C,E.i.GALLERY,A),h()(C,E.i.PRISM,B),h()(C,E.i.FLASH,{duration:1e3}),h()(C,E.i.NEWSFLASH,{duration:1500}),C),H=n("9657b29818"),W=n("3c18de0668"),U=n("0a8ecd6412"),G=(n("73b854064b"),n("547611bd96")),V=n.n(G),Z=n("bd29e2df90"),_=n.n(Z),Y=n("ab5eb40518"),X=n.n(Y),K=n("1b4cdd6a36"),J=n.n(K),Q=n("96718968a5"),q=n.n(Q),$={insert:"head",singleton:!1},ee=(y()(q.a,$),q.a.locals||{}),te=n("cfcfbe15b7");n("31b2c7b457");function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J()(e);if(t){var i=J()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return X()(this,n)}}var ae,oe,le,ce={opacity:1,zIndex:0},se=function(e){_()(n,e);var t=ie(n);function n(e){var r;return s()(this,n),r=t.call(this,e),h()(V()(r),"enterRef",void 0),h()(V()(r),"exitRef",void 0),h()(V()(r),"transitionHandler",void 0),h()(V()(r),"timer",void 0),h()(V()(r),"enterCanvas",void 0),h()(V()(r),"exitCanvas",void 0),h()(V()(r),"blackPlaceHolder",void 0),h()(V()(r),"renderWithTransition",(function(){var e=r.state,t=e.enterStyle,n=e.exitStyle,i=r.isPreserve3D()?{transformStyle:"preserve-3d",backfaceVisibility:"hidden"}:void 0;return g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:ee["transition-preview-enter-wrapper"],ref:function(e){r.enterRef=e},style:re({opacity:t.opacity,zIndex:t.zIndex,transform:t.transform,transformOrigin:t.transformOrigin},i)}),g.a.createElement("div",{className:ee["transition-preview-exit-wrapper"],ref:function(e){r.exitRef=e},style:re({opacity:n.opacity,zIndex:n.zIndex,transform:n.transform,transformOrigin:n.transformOrigin},i)}))})),h()(V()(r),"updateElementState",(function(e){var t=e.target,n=e.style,i=n.translateX,a=void 0===i?0:i,o=n.translateY,l=void 0===o?0:o,c=n.translateZ,s=void 0===c?0:c,u=n.rotate,d=void 0===u?0:u,p=n.rotateX,h=void 0===p?0:p,f=n.rotateY,m=void 0===f?0:f,v=n.scale,g=void 0===v?1:v,b=n.originX,y=void 0===b?.5:b,x=n.originY,w=void 0===x?.5:x,S=n.opacity,k=void 0===S?1:S,C=n.zIndex,I=void 0===C?0:C,T=r.props.contentSize,R=T.width,M=T.height,O="perspective(1500px) rotate(".concat(d,"deg) rotateX(").concat(h,"deg) rotateY(").concat(m,"deg) translate(").concat(a*R,"px, ").concat(l*M,"px) translateZ(").concat(s,"px) scale(").concat(g,")"),N="".concat(100*y,"% ").concat(100*w,"%");t===E.h.ENTER?r.setState({enterStyle:{opacity:k,zIndex:I,transform:O,transformOrigin:N}}):r.setState({exitStyle:{opacity:k,zIndex:I,transform:O,transformOrigin:N}})})),h()(V()(r),"startTransition",(function(){r.transitionHandler.startTransition()})),h()(V()(r),"handleAfterAnimation",(function(e){var t,n;e||r.removeExitElement(),null===(t=(n=r.props).onTransitionStop)||void 0===t||t.call(n)})),h()(V()(r),"handleBeforeAnimation",(function(e){var t,n;null===(t=(n=r.props).onTransitionStart)||void 0===t||t.call(n),e||r.exitRef.appendChild(r.getExitElement())})),h()(V()(r),"removeExitElement",(function(){var e;(null===(e=r.exitRef.childNodes)||void 0===e?void 0:e.length)>0&&r.exitRef.removeChild(r.exitRef.childNodes[0]),r.setState({enterStyle:{opacity:ce.opacity,zIndex:ce.zIndex,transform:void 0,transformOrigin:void 0},exitStyle:{opacity:ce.opacity,zIndex:ce.zIndex,transform:void 0,transformOrigin:void 0}})})),h()(V()(r),"isPreserve3D",(function(){var e;return(null===(e=r.props.enterSlideModel.transition)||void 0===e?void 0:e.getImplementationType())===E.c.PRESERVE_3D})),r.state={exitStyle:ce,enterStyle:ce},r.enterCanvas=e.enterCanvas,r.exitCanvas=e.exitCanvas,r.transitionHandler=new te.a({slideModel:r.props.enterSlideModel,getPrevSlideModel:function(){return r.props.exitSlideModel},isSwitchForward:function(){return!1},beforeAnimation:r.handleBeforeAnimation,renderAnimationFrame:function(e,t){t||r.updateElementState(e)},afterAnimation:r.handleAfterAnimation,enterCanvas:r.props.enterBrowserCanvas,exitCanvas:r.props.exitBrowserCanvas,getEnterWrapper:function(){return r.enterRef},getExitWrapper:function(){return r.exitRef}}),r}return d()(n,[{key:"componentDidMount",value:function(){this.attachCanvasRef(),this.startTransition()}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){this.transitionHandler.dispose(),this.timer&&clearTimeout(this.timer)}},{key:"render",value:function(){return this.renderWithTransition()}},{key:"attachCanvasRef",value:function(){this.enterRef.appendChild(this.enterCanvas)}},{key:"getExitElement",value:function(){return this.exitCanvas?this.exitCanvas:this.createBlackPlaceHolder()}},{key:"createBlackPlaceHolder",value:function(){return this.blackPlaceHolder||(this.blackPlaceHolder=document.createElement("div"),this.blackPlaceHolder.style.backgroundColor="#000"),this.blackPlaceHolder.style.width="100%",this.blackPlaceHolder.style.height="100%",this.blackPlaceHolder}}]),n}(g.a.Component),ue=n("2e0796c118"),de=n.n(ue),pe=n("d5c3deb8c7"),he=n("5ce71228c0");function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=(ae=Reflect.metadata("design:type",Boolean),oe=function(){function e(t,n,i,a,o,c){var u=this;s()(this,e),l()(this,"autoPreviewState",le,this),h()(this,"transitionPreviewLayer",void 0),h()(this,"transitionPreviewContainer",void 0),h()(this,"layerRenderQueue",[]),h()(this,"renderContext",void 0),h()(this,"enterCanvas",void 0),h()(this,"exitCanvas",void 0),h()(this,"enterSlideRenderLayer",void 0),h()(this,"exitSlideRenderLayer",void 0),h()(this,"isPreviewing",void 0),h()(this,"onTransitionStart",(function(){u.setTransitionPreviewLayerVisible(!0)})),h()(this,"onTransitionStop",(function(){u.resetPreview(),u.resetRenderLayer()})),this.uiDataService=t,this.selectionService=n,this.mediaManager=i,this.editableServiceLayer=a,this.viewableServiceLayer=o,this.infrastructure=c;var d=he.b.getItem(he.a.TRANSITION_AUTO_PREVIEW,r.ENABLE);this.autoPreviewState=d===r.ENABLE}return d()(e,[{key:"initPreviewLayer",value:function(e){this.initLayerStyle(e),this.updateLayerStyle(e)}},{key:"updatePreviewLayer",value:function(e){this.transitionPreviewLayer&&(this.stopPreview(),this.updateLayerStyle(e),this.updateRenderContext(e))}},{key:"getCurrentSlideTransition",value:function(){var e;return null===(e=this.currentSlide)||void 0===e?void 0:e.transition}},{key:"updateTransitionType",value:function(e){var t,n,r=this,i=null===(t=this.currentSlide)||void 0===t||null===(n=t.transition)||void 0===n?void 0:n.type;e!==i&&Object(H.b)((function(){if(e===E.i.EMPTY)return r.updateTransition(null),void r.updateTransition({});i&&r.updateTransition(null);var t=me({type:e},F[e]);r.updateTransition(t)}))}},{key:"updateTransitionEffect",value:function(e){var t,n,r=this,i=null===(t=this.currentSlide)||void 0===t||null===(n=t.transition)||void 0===n?void 0:n.type;i&&Object(H.b)((function(){var t=me({type:i},e);r.updateTransition(t)}))}},{key:"updateTransition",value:function(e){var t;null===(t=this.getTransitionProperty(this.currentSlide))||void 0===t||t.updateProps(e)}},{key:"applyTransitionToAll",value:function(){var e=this,t=this.getCurrentSlideTransition();Object(H.b)((function(){e.getAllModelList().forEach((function(n){var r,i;null===(r=e.getTransitionProperty(n))||void 0===r||r.removeTransition(),null===(i=e.getTransitionProperty(n))||void 0===i||i.updateProps(t)}))}))}},{key:"currentSlide",get:function(){return this.selectionService.currentSlide}},{key:"getPreviewState",value:function(){return!!this.isPreviewing}},{key:"preview",value:function(){var e,t,n=this;this.currentSlide&&(this.stopPreview(),null!==(e=this.currentSlide.transition)&&void 0!==e&&e.type&&(null===(t=this.currentSlide.transition)||void 0===t?void 0:t.type)!==E.i.EMPTY&&(this.setPreviewingState(!0),this.enterCanvas=this.createCanvasElement(),this.enterSlideRenderLayer=this.createSlideRenderLayer(this.enterCanvas,this.currentSlide),this.exitSlideModel&&(this.exitCanvas=this.createCanvasElement(),this.exitSlideRenderLayer=this.createSlideRenderLayer(this.exitCanvas,this.exitSlideModel)),Promise.all(this.layerRenderQueue).then((function(){n.isPreviewing&&n.mountPreviewContainer()}))))}},{key:"stopPreview",value:function(){this.onTransitionStop()}},{key:"toggleAutoPreview",value:function(){this.autoPreviewState=!this.autoPreviewState,he.b.setItem(he.a.TRANSITION_AUTO_PREVIEW,this.autoPreviewState?r.ENABLE:r.DISABLE)}},{key:"createCanvasElement",value:function(){return document.createElement("canvas")}},{key:"createSlideRenderLayer",value:function(e,t){var n,r,i=new Promise((function(e){return r=e}));return this.layerRenderQueue.push(i),new W.a(t,e,null===(n=this.renderContext)||void 0===n?void 0:n.scale,null,U.s.TRANSITION_PREVIEW,!1,!1,this.infrastructure,this.uiDataService,this.mediaManager,(function(){r(void 0)}),this.selectionService,this.viewableServiceLayer,this.editableServiceLayer)}},{key:"mountPreviewContainer",value:function(){var e,t,n=this.createTransitionPreviewContainer();de.a.render(g.a.createElement(se,{contentSize:this.renderContentSize,enterSlideModel:this.currentSlide,exitSlideModel:this.exitSlideModel,enterCanvas:this.enterCanvas,exitCanvas:this.exitCanvas,enterBrowserCanvas:null===(e=this.enterSlideRenderLayer)||void 0===e?void 0:e.getApplication().view,exitBrowserCanvas:null===(t=this.exitSlideRenderLayer)||void 0===t?void 0:t.getApplication().view,onTransitionStart:this.onTransitionStart,onTransitionStop:this.onTransitionStop}),n),this.transitionPreviewContainer=n,this.transitionPreviewLayer.appendChild(n)}},{key:"createTransitionPreviewContainer",value:function(){var e=document.createElement("div"),t=this.renderContentSize,n=t.height,r=t.width,i=t.top,a=t.left,o=this.renderContext||{},l=o.currentScrollY,c=void 0===l?0:l,s=o.currentScrollX,u=void 0===s?0:s;return e.style.width="".concat(r,"px"),e.style.height="".concat(n,"px"),e.style.top="".concat(i+c,"px"),e.style.left="".concat(a+u,"px"),e.style.background="#000",e.style.overflow="hidden",e.className=k["transition-preview"],e}},{key:"renderContentSize",get:function(){var e,t,n=(null===(e=this.enterSlideRenderLayer)||void 0===e?void 0:e.getApplication())||{},r=n.height,i=void 0===r?0:r,a=n.width,o=void 0===a?0:a,l=(null===(t=this.renderContext)||void 0===t?void 0:t.contentSize)||{},c=l.left,s=void 0===c?0:c,u=l.top;return{width:o,height:i,left:s,top:void 0===u?0:u}}},{key:"getAllModelList",value:function(){var e=this.uiDataService,t=e.slideModelList,n=e.layoutModelList,r=e.masterModelList;return[].concat(a()(r),a()(n),a()(t))}},{key:"initLayerStyle",value:function(e){var t=e.width,n=e.height,r=e.ref;this.transitionPreviewLayer=r,this.transitionPreviewLayer.style.width="".concat(t,"px"),this.transitionPreviewLayer.style.height="".concat(n,"px"),this.setTransitionPreviewLayerVisible(!1)}},{key:"updateLayerStyle",value:function(e){var t=e.width,n=e.height,r=e.renderRectConfig,i=r.currentScrollX,a=void 0===i?0:i,o=r.currentScrollY,l=void 0===o?0:o;this.transitionPreviewLayer.style.width="".concat(t,"px"),this.transitionPreviewLayer.style.height="".concat(n,"px"),this.transitionPreviewLayer.style.transform="translate(".concat(-a,"px, ").concat(-l,"px)")}},{key:"updateRenderContext",value:function(e){var t=e.width,n=e.height,r=e.scale,i=e.renderRectConfig;this.renderContext=me({width:t,height:n,scale:r},i)}},{key:"resetPreview",value:function(){this.setPreviewingState(!1),this.setTransitionPreviewLayerVisible(!1)}},{key:"setTransitionPreviewLayerVisible",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.transitionPreviewLayer.style.display=e?"block":"none"}},{key:"resetRenderLayer",value:function(){this.enterCanvas=void 0,this.exitCanvas=void 0,this.enterSlideRenderLayer=void 0,this.exitSlideRenderLayer=void 0,this.layerRenderQueue=[],this.disposeWrapper()}},{key:"disposeWrapper",value:function(){this.transitionPreviewContainer&&(de.a.unmountComponentAtNode(this.transitionPreviewContainer),this.transitionPreviewContainer=void 0),this.transitionPreviewLayer.innerHTML=""}},{key:"exitSlideModel",get:function(){var e,t,n=null===(e=this.currentSlide)||void 0===e||null===(t=e.presentationRef)||void 0===t?void 0:t.indexOfSlide(this.currentSlide);if(n&&n>0){var r,i,a,o;if(!(null===(r=this.currentSlide)||void 0===r||null===(i=r.getMasterLayoutEditService())||void 0===i?void 0:i.isMasterEditType))return this.uiDataService.slideModelList[n-1];if(null!==(a=this.currentSlide)&&void 0!==a&&a.isLayout)return this.uiDataService.layoutModelList[n-1];if(null!==(o=this.currentSlide)&&void 0!==o&&o.isMaster)return this.uiDataService.masterModelList[n-1]}}},{key:"setPreviewingState",value:function(e){this.isPreviewing=e}},{key:"getTransitionProperty",value:function(e){return null==e?void 0:e.getTransitionProperty()}}]),e}(),le=m()(oe.prototype,"autoPreviewState",[pe.q,ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe)},e30289fafa:function(e,t,n){(t=e.exports=n("9dddfe0040")(!1)).push([e.i,".mobile-collapse-collapse-container-2WX1C{width:100%;margin:0 auto;overflow:hidden}.mobile-collapse-collapse-item-OdE-x{margin-bottom:16px;border:1px solid rgba(0,0,0,.08);border-radius:4px}.mobile-collapse-collapse-title-2fppN{display:flex;padding:12px 8px;cursor:pointer}.mobile-collapse-collapse-title-2fppN[disabled]{cursor:default}.mobile-collapse-collapse-content-3Zvd5{overflow:hidden;transition:height .3s ease}.mobile-collapse-collapse-content-inner-5zMve{padding:0 15px;font-size:14px}.mobile-collapse-collapse-content-enter-mcUVZ{height:0}.mobile-collapse-collapse-content-enter-active-7vReA,.mobile-collapse-collapse-content-exit-aSuHT{height:auto}.mobile-collapse-collapse-content-exit-active-2kg-Y{height:0}",""]),t.locals={"collapse-container":"mobile-collapse-collapse-container-2WX1C","collapse-item":"mobile-collapse-collapse-item-OdE-x","collapse-title":"mobile-collapse-collapse-title-2fppN","collapse-content":"mobile-collapse-collapse-content-3Zvd5","collapse-content-inner":"mobile-collapse-collapse-content-inner-5zMve","collapse-content-enter":"mobile-collapse-collapse-content-enter-mcUVZ","collapse-content-enter-active":"mobile-collapse-collapse-content-enter-active-7vReA","collapse-content-exit":"mobile-collapse-collapse-content-exit-aSuHT","collapse-content-exit-active":"mobile-collapse-collapse-content-exit-active-2kg-Y"}},e7bdeb75b3:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xOS40NjkxIDUuOTQ4MzRMMjEuNTkwNCA4LjA2OTY2TDExLjY5MjIgMTcuOTY3MkwxMS42OTM5IDE3Ljk2ODlMMTEuMjc0IDE4LjM4NTNMOS41NjkxNiAyMC4wOUw5LjU2MjA2IDIwLjA4MjlMNy40NDgyOCAxNy45NjkyTDIuNDk5OTEgMTMuMDIwOEw0LjYyMjg2IDEwLjg5NzhMOS41NzEyMiAxNS44NDYyTDE5LjQ2OTEgNS45NDgzNFoiIGZpbGw9IiMwMEFBNUIiIHN0eWxlPSJmaWxsOiMwMEFBNUI7ZmlsbDpjb2xvcihkaXNwbGF5LXAzIDAuMDAwMCAwLjY2NjcgMC4zNTY5KTtmaWxsLW9wYWNpdHk6MTsiLz4KPC9zdmc+Cg=="},e826e38305:function(e,t,n){"use strict";n.r(t),n.d(t,"TemplateContentAnalyzerService",(function(){return L}));n("963f2eaace"),n("b1e2246d82"),n("8aebbf296a"),n("a84962d637"),n("f45588a8ad"),n("de37db1287"),n("c554310b5c"),n("bcb5d93d36");var r,i,a=n("14502724a6"),o=n.n(a),l=n("176815363d"),c=n.n(l),s=n("9132715560"),u=n.n(s),d=n("6a364eb35c"),p=n.n(d),h=n("85d0a7609b"),f=n.n(h),m=n("3ef2352f0b"),v=n.n(m);n("8e7cce0ada"),n("29f8c5f672"),n("c6244f7705"),n("85d48ef22b"),n("2a6f332b5e"),n("8ee19818c4"),n("081c8cafea"),n("8a35b54c1d"),n("b8217400dc"),n("e6f68cdf2e"),n("22569efd03"),n("342844cefa"),n("75563bc376"),n("1bab7b5fb7"),n("34cd92f77a"),n("3823a0b5bb"),n("826dc923b3");!function(e){e[e.cover=0]="cover",e[e.twoContents=1]="twoContents",e[e.threeContents=2]="threeContents",e[e.fourContents=3]="fourContents",e[e.fiveContents=4]="fiveContents",e[e.sixContents=5]="sixContents",e[e.section=6]="section"}(r||(r={})),function(e){e[e.cover=0]="cover",e[e.fourContents=1]="fourContents",e[e.section=2]="section"}(i||(i={}));var g,b=n("12b829499b"),y=n("e0e8dd9366"),x=n("9657b29818"),w=n("020899bf26"),S=n("7e4a465ef4"),k=n("743ef67b0e"),C=n("86753a9dc2"),E=n("f57c18cbbf"),I=n("a7888a8b87"),T=n.n(I);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e[e.number=0]="number",e[e.simple=1]="simple",e[e.tradition=2]="tradition",e[e.english=3]="english"}(g||(g={}));var L=function(){function e(){var t=this;u()(this,e),f()(this,"service",void 0),f()(this,"contentsTitleCached",[]),f()(this,"sectionCached",new Map),f()(this,"firstSectionIndex",""),f()(this,"checkSimilarHsl",(function(e,t){var n=Math.abs(e.L-t.L);if(n<20)return!0;if(n<50){var r=Math.abs(e.H-t.H);if(r<30)return!0;if(Math.abs(r-255)<30)return!0}return!1})),f()(this,"checkRectOverLap",(function(e,t){var n=e.left,r=e.left+e.width,i=e.top,a=e.top+e.height,o=t.left,l=t.left+t.width,c=t.top;return!(i>t.top+t.height)&&(!(r<o)&&(!(a<c)&&!(n>l)))})),f()(this,"hasFillLowerFill",(function(e,n,r){var i=!1,a=t.getRect(e),o=t.getFillColor(e);return n.forEach((function(e,n){var r,o,l,c,s=e.rect,u=(e.fillColor,e.element);t.checkRectOverLap(s,a)&&((null!==(r=u.props.style.fillBackground)&&void 0!==r&&r.solidFill||null!==(o=u.props.style.fillBackground)&&void 0!==o&&o.gradFill||null!==(l=u.props.style.fillBackground)&&void 0!==l&&l.image||null!==(c=u.props.style.fillBackground)&&void 0!==c&&c.pattFill)&&(i=!0))})),a&&o&&n.set(e,{rect:a,fillColor:o,element:e}),i})),f()(this,"getFillColor",(function(e){var t,n=e.props.style.fillBackground;return null==n||null===(t=n.solidFill)||void 0===t?void 0:t.color})),f()(this,"getRect",(function(e){var t=e.props.style;return{left:t.left,top:t.top,width:t.width,height:t.height}})),f()(this,"createTemplateUiDataService",function(){var e=c()(v.a.mark((function e(n){var r,i,a,o,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null===(r=w.a.SDKDataServices.PresentationStoreService())||void 0===r?void 0:r.createFromData(n),a=null==i?void 0:i.presentation,o=new S.a({}),(l=new k.a).presentation=o,l.presentation.asyncConvertChildren=!1,l.presentation.asyncConvertSlideChildren=!1,l.setSlideRenderStateManagerDelegate(t.service.slideRenderStateManager),e.next=10,o.bindSDK(a);case 10:return e.next=12,null==l?void 0:l.forceConvertSlides(l.presentation.children);case 12:return e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),f()(this,"initTemplateData",function(){var e=c()(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.b)(t);case 2:return n=e.sent,(r=Object(E.a)(T()(n))).noteSlideMap={},e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),f()(this,"verifyTemplateCoverType",(function(e){var n,r,i,a,l,c=0,s=0,u=O(e);try{for(u.s();!(l=u.n()).done;){var d=o()(l.value,2),p=d[0],h=d[1];if(p>c){var f=h.filter((function(e){return!t.isIgnoreText(e)})),m=f[0];m&&(c=p,n=m,s=m.level)}}}catch(e){u.e(e)}finally{u.f()}var v,g=O(e);try{for(g.s();!(v=g.n()).done;){var b,y=o()(v.value,2),x=(y[0],y[1]);(null===(b=x[0])||void 0===b?void 0:b.level)===s+1&&(t.isIgnoreText(x[0])||(r=x[0]))}}catch(e){g.e(e)}finally{g.f()}var w,S=O(e);try{for(S.s();!(w=S.n()).done;){var k=o()(w.value,2),C=(k[0],k[1]),E=t.getIndexAndSubIndexInfo(C,i,a);i=E.indexLeaf,a=E.subIndexLeaf}}catch(e){S.e(e)}finally{S.f()}return{ctrTitleLeaf:n,subTitleLeaf:r,indexLeaf:i,subIndexLeaf:a}})),f()(this,"verifyUserCoverType",(function(e){var n,r,i,a,l,c=0,s=0,u=O(e);try{for(u.s();!(l=u.n()).done;){var d=o()(l.value,2),p=d[0],h=d[1];if(p>c){var f=h.filter((function(e){return!t.isIgnoreText(e)})),m=f[0];m&&(c=p,n=m,s=m.level)}}}catch(e){u.e(e)}finally{u.f()}var v,g=O(e);try{for(g.s();!(v=g.n()).done;){var b,y=o()(v.value,2),x=(y[0],y[1]);(null===(b=x[0])||void 0===b?void 0:b.level)===s+1&&(t.isIgnoreText(x[0])||(r=x[0]))}}catch(e){g.e(e)}finally{g.f()}var w,S=O(e);try{for(S.s();!(w=S.n()).done;){var k=o()(w.value,2),C=(k[0],k[1]),E=t.checkCoverTitle(C,i,a);i=E.indexLeaf,a=E.subIndexLeaf}}catch(e){S.e(e)}finally{S.f()}return{ctrTitleLeaf:n,subTitleLeaf:r,indexLeaf:i,subIndexLeaf:a}})),f()(this,"analyzerTemplateContents",(function(e,n){var r=(e||{}).texts,i=void 0===r?[]:r,a=t.verifyContentByFontInfo(i);return M(M({},t.verifyTemplateContentsType(a,n)),{},{pageModel:e.pageModel})})),f()(this,"analyzerTemplateContentsUnKnow",(function(e){var n=(e||{}).texts,r=void 0===n?[]:n,i=t.verifyContentByFontInfo(r);return M(M({},t.verifyUserContentsType(i)),{},{pageModel:e.pageModel})})),f()(this,"verifyUserContentsType",(function(e){var n,r,i,a,l=0,c=0,s=0,u=O(e);try{for(u.s();!(a=u.n()).done;){var d=o()(a.value,2),p=d[0],h=d[1];t.isIgnoreTextList(h)||1===h.length&&p>l&&(l=p,n=h[0])}}catch(e){u.e(e)}finally{u.f()}e.delete(l);var f,m=O(e);try{var v=function(){var e=o()(f.value,2),n=e[0],i=e[1].filter((function(e){return!t.isIgnoreText(e)})),a=new Map;if((i=i.filter((function(e){var n,r,i,o,l=null===(n=e.contentBlock)||void 0===n||null===(r=n.visualBlocks)||void 0===r||null===(i=r[0])||void 0===i||null===(o=i.info)||void 0===o?void 0:o.element;return!!l&&(t.isIgnoreText(e)?void 0:!a.has(l)&&(a.set(l,e),!0))}))).length<2)return"continue";a.size>0&&(s=i.length,c=n,r=i)};for(m.s();!(f=m.n()).done;)v()}catch(e){m.e(e)}finally{m.f()}e.delete(c);var g,b=O(e);try{for(b.s();!(g=b.n()).done;){var y=o()(g.value,2),x=(y[0],y[1]);t.isIgnoreTextList(x)||x.length===s&&(i=x)}}catch(e){b.e(e)}finally{b.f()}return{ctrTitleLeaf:n,titleLeafList:r,subTitleLeafList:i}})),f()(this,"verifyTemplateContentsType",(function(e,n){var r,i,a,l,c=0,s=0,u=O(e);try{for(u.s();!(l=u.n()).done;){var d=o()(l.value,2),p=d[0],h=d[1];t.isIgnoreTextList(h)||1===h.length&&p>c&&(c=p,r=h[0])}}catch(e){u.e(e)}finally{u.f()}e.delete(c);var f,m=O(e);try{var v=function(){var e=o()(f.value,2),r=e[0],a=e[1].filter((function(e){return!t.isIgnoreText(e)})),l=new Map;(a=a.filter((function(e){var t,n,r,i,a=null===(t=e.contentBlock)||void 0===t||null===(n=t.visualBlocks)||void 0===n||null===(r=n[0])||void 0===r||null===(i=r.info)||void 0===i?void 0:i.element;return!!a&&(!l.has(a)&&(l.set(a,e),!0))}))).length===n&&r>s&&(a.length,s=r,i=a)};for(m.s();!(f=m.n()).done;)v()}catch(e){m.e(e)}finally{m.f()}e.delete(s);var g,b=O(e);try{for(b.s();!(g=b.n()).done;){var y=o()(g.value,2),x=(y[0],y[1]);t.isIgnoreTextList(x)||x.length===n&&(a=x)}}catch(e){b.e(e)}finally{b.f()}return{ctrTitleLeaf:r,titleLeafList:i,subTitleLeafList:a}})),f()(this,"verifyContentByFontInfo",(function(e){var t=new Map;return e.forEach((function(e){var n,r,i=null===(n=e.contentBlock.visualBlocks[0])||void 0===n?void 0:n.getFirstFontSize();null===(r=e.contentBlock.visualBlocks[0])||void 0===r||r.getFirstFontStyle();if(i){var a=t.get(i);a||(a=[],t.set(i,a)),a.push(e)}})),t})),f()(this,"isIgnoreTextList",(function(e){var n=!1;return e.forEach((function(e){t.isIgnoreText(e)&&(n=!0)})),n})),f()(this,"isIgnoreText",(function(e){var t,n=!1;if(null!=e&&null!==(t=e.text)&&void 0!==t&&t.length&&e.text.length<2)return!0;return null==e||!e.text||(!(!e.text.toLowerCase().includes("contents")||!e.text.replaceAll(" ","").includes("目录"))||(e&&/^[0-9a-zA-Z.,。，、\s]+$/.test(e.text)&&e.text.length<=10&&!e.text.toLowerCase().includes("thank")&&!e.text.includes("感谢")&&!e.text.includes("谢谢")&&(n=!0),n))}))}var t,n,a,l,s;return p()(e,[{key:"setDelegateService",value:function(e){this.service=e}},{key:"clearCached",value:function(){this.contentsTitleCached=[],this.sectionCached=new Map,this.firstSectionIndex=""}},{key:"analyzerContentBackground",value:function(e){var t,n,r,i=this;this.clearCached();var a,o={fillBackground:void 0,firstElement:void 0,secondElement:void 0,thirdElement:void 0,pageModel:e[0].pageModel,relationLayoutIndex:void 0},l={},c=0,s=0,u=null===(t=e[0])||void 0===t||null===(n=t.pageModel)||void 0===n?void 0:n.parent;if(!u)return{slideBack:o,mainFontColor:void 0};var d=e[0].pageModel,p=d.getRelationLayoutModel();if((null===(r=d.parent)||void 0===r?void 0:r.type)===y.d.PRESENTATION){var h=d.parent;o.relationLayoutIndex=h.layoutList.findIndex((function(e){return p===e}))}e.forEach((function(e,t){if(!(t>3)&&e){var n=e.pageModel,r=e.texts,a=new Map;null==r||r.forEach((function(e){var t,n,r,o,u=null===(t=e.contentBlock)||void 0===t||null===(n=t.visualBlocks)||void 0===n||null===(r=n[0])||void 0===r||null===(o=r.info)||void 0===o?void 0:o.element;if(u){var d=u,p=d.paragraphList;d.props;null==p||p.forEach((function(e){var t=e.textRuns;null==t||t.forEach((function(e){if(e.styles){var t=e.styles.tdColor;if(t&&i.hasFillLowerFill(u,a,t))return;if(t){var n=t.hsl.L>120;l[t.srgb_color]?l[t.srgb_color].number=l[t.srgb_color].number+1:l[t.srgb_color]={number:1,tdColor:t,isUpperLum:n},n?s+=1:c+=1}}}))}))}})),i.getSlideBack(o,n,t,u)}}));var f=0;Object.keys(l).filter((function(e){return l[e].isUpperLum===s>c})).forEach((function(e){var t=l[e];t.number>f&&(f=t.number,a=t.tdColor)}));var m=o.firstElement;m&&Object(x.b)((function(){p.addElementWithNoSelect([m.type],[m.props])}));var v=o.secondElement;v&&Object(x.b)((function(){p.addElementWithNoSelect([v.type],[v.props])}));var g=o.thirdElement;return g&&Object(x.b)((function(){p.addElementWithNoSelect([g.type],[g.props])})),e.forEach((function(e,t){if(!(t>3)&&e){var n=e.pageModel;if(!o.firstElement){var r=n.getRelationLayoutModel();i.getSlideBack(o,r,t,u)}}})),e.forEach((function(e,t){if(!(t>3)&&e){var n=e.pageModel;if(!o.firstElement){var r=n.getRelationMasterModel();i.getSlideBack(o,r,t,u)}}})),{slideBack:o,mainFontColor:a}}},{key:"getSlideBack",value:function(e,t,n,r){var i,a,o;e.fillBackground?(null===(i=e.fillBackground)||void 0===i?void 0:i.color)!==(null===(a=t.props.style.fillBackground)||void 0===a?void 0:a.color)&&(e.fillBackground=void 0):1!==(null===(o=t.props.style.fillBackground)||void 0===o?void 0:o.noFill)&&(e.fillBackground=t.props.style.fillBackground);var l=t.children[0];l&&this.isBackgroundElement({element:l,slide:t,isStrict:!1,presentation:r})?e.firstElement?this.compareSameElement(e.firstElement,l)||(e.firstElement=void 0):0===n&&(e.firstElement=l):e.firstElement=void 0;var c=t.children[1];c&&this.isBackgroundElement({element:c,slide:t,isStrict:!1,presentation:r})?e.secondElement?this.compareSameElement(e.secondElement,c)||(e.secondElement=void 0):0===n&&(e.secondElement=c):e.secondElement=void 0;var s=t.children[2];s&&this.isBackgroundElement({element:s,slide:t,isStrict:!1,presentation:r})?e.thirdElement?this.compareSameElement(e.thirdElement,s)||(e.thirdElement=void 0):0===n&&(e.thirdElement=s):e.thirdElement=void 0}},{key:"isBackgroundElement",value:function(e){var t=e.element,n=(e.slide,e.isStrict),r=e.presentation;if(!t)return!1;if(t.type===y.d.GROUP)return!1;var i=!0,a=r.props,o=a.slideWidth,l=a.slideHeight,c=t.props.style||{},s=c.width,u=void 0===s?0:s,d=c.height,p=void 0===d?0:d,h=n?.8:.02;if(t.type===y.d.IMAGE&&u*p>o*l*h)return!0;if(t.type===y.d.SHAPE){if(u*p>o*l*h){var f=t.paragraphList;return null==f||f.forEach((function(e){var t=e.textRuns;null==t||t.forEach((function(e){e.text&&(i=!1)}))})),i}return!1}return!1}},{key:"compareSameElement",value:function(e,t){var n,r,i=e.props.style||{},a=i.width,o=i.height,l=t.props.style||{},c=l.width,s=l.height,u=(e||{}).type,d=(t||{}).type,p=null===(n=e.props.style.fillBackground)||void 0===n?void 0:n.color,h=null===(r=t.props.style.fillBackground)||void 0===r?void 0:r.color,f=e.children.length,m=t.children.length;return a>.9*c&&a<1.1*c&&o>.9*s&&o<1.1*s&&p===h&&u===d&&f===m}},{key:"analyzerElementBackground",value:function(e){e.forEach((function(e,t){e.children.forEach((function(e,t){t>=3||e.isPlaceholder}))}))}},{key:"analyzerUserDocs",value:(s=c()(v.a.mark((function e(t){var n,r,i,a,o,l,c,s=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.clearCached(),n=t.templatePresentation,e.next=4,this.service.contentLayoutAnalyzer.analysisTextResult(n);case 4:return r=e.sent,o=[],c=[],r.forEach((function(e,t){switch(0===t&&e&&(e.pageType=b.b.CoverPage),e.pageType){case b.b.CoverPage:i=s.analyzerTemplateCover(e);break;case b.b.TableOfContents:var n;(a=s.analyzerTemplateContentsUnKnow(e))&&(null===(n=a.titleLeafList)||void 0===n||n.forEach((function(e){s.contentsTitleCached.push({text:e.text,isMapped:!1})})));break;case b.b.Content||b.b.SectionDivider:var r,u=s.analyzerUserSection(e);if((null===(r=e.texts)||void 0===r?void 0:r.length)<=3){var d=s.contentsTitleCached.find(s.getPredicate(u));if(d&&!d.isMapped)o.push(u),e.pageType=b.b.SectionDivider,d.isMapped=!0;else if(u.indexLeaf){var p=u.indexLeaf.text,h=s.getIndexType(p),f=s.getIndexType(s.firstSectionIndex);0===s.sectionCached.size?(s.firstSectionIndex=p,s.sectionCached.set(p,{model:e,type:h})):h===f&&p!==s.firstSectionIndex&&s.sectionCached.set(p,{model:e,type:h})}else c.push(e)}else c.push(e);break;case b.b.Acknowledgments:l=s.analyzerTemplateBackCover(e)}})),0===o.length&&this.sectionCached.size>0&&this.sectionCached.forEach((function(e){var t=e.model;t.pageType=b.b.SectionDivider;var n=s.analyzerUserSection(t);o.push(n)})),e.abrupt("return",{userDocCoverResult:i,userDocContentsResult:a,userDocSectionResult:o,userDocBackCoverResult:l,userDocContentResult:c});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getIsFirst",value:function(e){var t,n,r,i;e=e.toLowerCase().replace(".","").replace(" ","").replace("no","").replace("章节","").replace("part","");var a=null===(t=/0?1$/.exec(e))||void 0===t?void 0:t[0],o=null===(n=/一/.exec(e))||void 0===n?void 0:n[0],l=null===(r=/壹/.exec(e))||void 0===r?void 0:r[0],c=null===(i=/one/.exec(e))||void 0===i?void 0:i[0];return((null==a?void 0:a.length)||0)>0||((null==o?void 0:o.length)||0)>0||((null==l?void 0:l.length)||0)>0||((null==c?void 0:c.length)||0)>0}},{key:"getIndexType",value:function(e){var t,n,r,i,a=null===(t=/0?[\d]$/.exec(e))||void 0===t?void 0:t[0],o=null===(n=/一/.exec(e))||void 0===n?void 0:n[0],l=null===(r=/壹/.exec(e))||void 0===r?void 0:r[0],c=null===(i=/one/.exec(e))||void 0===i?void 0:i[0];return((null==a?void 0:a.length)||0)>0?g.number:((null==o?void 0:o.length)||0)>0?g.simple:((null==l?void 0:l.length)||0)>0?g.tradition:((null==c?void 0:c.length)||0)>0?g.english:g.number}},{key:"analyzerTemplate",value:(l=c()(v.a.mark((function e(t,n){var i,a,o,l,c,s,u,d,p,h,f,m,g;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.templatePresentation,e.next=3,this.service.contentLayoutAnalyzer.analysisTextResult(i);case 3:return a=e.sent,o=a[r.cover],l=a[r.section],c=a[a.length-1],s=this.analyzerTemplateCover(o),u=this.analyzerTemplateContents(a[n.contentsNumber-1],n.contentsNumber),d=this.analyzerTemplateSection(l),p=this.analyzerTemplateBackCover(c),h=[a[3],a[4],a[5]],f=this.analyzerContentBackground(h),m=f.slideBack,g=f.mainFontColor,e.abrupt("return",{templateCoverResult:s,templateContentsResult:u,templateSectionResult:d,templateBackCoverResult:p,templateContentBackResult:m,mainFontColor:g});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"analyzerNonStandardTemplate",value:(a=c()(v.a.mark((function e(t){var n,r,a,o,l,c,s,u,d,p,h,f,m,g,b,y=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.templatePresentation,e.next=3,this.service.contentLayoutAnalyzer.analysisTextResult(n);case 3:return r=e.sent,a=r[i.cover],o=r[i.section],l=r[r.length-1],c=this.analyzerTemplateCover(a),s=r[i.fourContents],(u=this.analyzerTemplateContentsUnKnow(s))&&(null===(d=u.titleLeafList)||void 0===d||d.forEach((function(e){y.contentsTitleCached.push({text:e.text,isMapped:!1})}))),p=this.analyzerTemplateSection(o),h=this.analyzerTemplateBackCover(l),f=[r[3],r[4],r[5]],m=this.analyzerContentBackground(f),g=m.slideBack,b=m.mainFontColor,e.abrupt("return",{templateCoverResult:c,templateContentsResult:u,templateSectionResult:p,templateBackCoverResult:h,templateContentBackResult:g,mainFontColor:b});case 16:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getPresentationColorInfo",value:function(e){var t=this,n={customColorNumber:0,themeColorNumber:0};return e.children.forEach((function(e){t.getElementListColorInfo(e.children,n)})),n}},{key:"getElementListColorInfo",value:function(e,t){var n=this;return e.forEach((function(e){e.type!==y.d.SHAPE&&e.type!==y.d.CONNECTOR||n.getElementColorInfo(e,t),e.type===y.d.GROUP&&n.getElementListColorInfo(e.children,t)})),t}},{key:"getElementColorInfo",value:function(e,t){var n,r,i,a,o,l,c,s,u=this,d=e.props,p=null===(n=e.getBorder().getBorderInfo())||void 0===n||null===(r=n.tdColor)||void 0===r?void 0:r.colorValue;this.setColorInfo(p,t);var h=null===(i=d.style.fillBackground)||void 0===i||null===(a=i.solidFill)||void 0===a?void 0:a.color.colorValue;this.setColorInfo(h,t);var f=null===(o=e.getBorder().getBorderInfo())||void 0===o||null===(l=o.gradFill)||void 0===l?void 0:l.gsList;null==f||f.forEach((function(e){var n,r=null===(n=e.color)||void 0===n?void 0:n.colorValue;u.setColorInfo(r,t)}));var m=null===(c=d.style.fillBackground)||void 0===c||null===(s=c.gradFill)||void 0===s?void 0:s.gsList;return null==m||m.forEach((function(e){var n,r=null===(n=e.color)||void 0===n?void 0:n.colorValue;u.setColorInfo(r,t)})),t}},{key:"setColorInfo",value:function(e,t){Number.isSafeInteger(e)?t.themeColorNumber=t.themeColorNumber+1:e&&(t.customColorNumber=t.customColorNumber+1)}},{key:"analyzerNonStandardTemplateByPresentationModel",value:(n=c()(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createTemplateUiDataService(t);case 2:return n=e.sent,e.abrupt("return",this.analyzerNonStandardTemplate({templatePresentation:n.presentation}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"analyzerNonStandardTemplateByTemplateId",value:(t=c()(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initTemplateData(t);case 2:return n=e.sent,e.abrupt("return",this.analyzerNonStandardTemplateByPresentationModel(n));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"analyzerTemplateCover",value:function(e){var t=e.texts,n=void 0===t?[]:t,r=this.verifyContentByFontInfo(n);return M(M({},this.verifyTemplateCoverType(r)),{},{pageModel:e.pageModel})}},{key:"getIndexAndSubIndexInfo",value:function(e,t,n){var r=this;return e.forEach((function(e){r.isIgnoreText(e)&&r.getIsFirst(null==e?void 0:e.text)&&(t?n||(n=e):t=e)})),{indexLeaf:t,subIndexLeaf:n}}},{key:"checkCoverTitle",value:function(e,t,n){var r=this;return e.forEach((function(e){r.isIgnoreText(e)&&r.getIsFirst(null==e?void 0:e.text)&&(t?n||(n=e):t=e)})),{indexLeaf:t,subIndexLeaf:n}}},{key:"analyzerTemplateSection",value:function(e){var t=(e||{}).texts,n=void 0===t?[]:t,r=this.verifyContentByFontInfo(n);return M(M({},this.verifyTemplateCoverType(r)),{},{pageModel:e.pageModel})}},{key:"analyzerUserSection",value:function(e){var t=(e||{}).texts,n=void 0===t?[]:t,r=this.verifyContentByFontInfo(n);return M(M({},this.verifyUserCoverType(r)),{},{pageModel:e.pageModel})}},{key:"analyzerTemplateBackCover",value:function(e){var t=e.texts,n=void 0===t?[]:t,r=this.verifyContentByFontInfo(n);return M(M({},this.verifyTemplateCoverType(r)),{},{pageModel:e.pageModel})}},{key:"getPredicate",value:function(e){return function(t){var n,r;return t.text.toLowerCase().replaceAll(" ","")===(null===(n=e.ctrTitleLeaf)||void 0===n||null===(r=n.text)||void 0===r?void 0:r.toLowerCase().replaceAll(" ",""))}}}]),e}()},f3eee4d92d:function(e,t){e.exports="//docs.gtimg.com/slide/img/slide/application/service/slide-rating-and-improve/view/pc/start/blankpage_search-a2dabb.svg"},f645f3a43b:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),c=n.n(l),s=n("382929c8da"),u=n("839ab07130"),d=n("3825cc7c15"),p=n("020899bf26"),h={authPanel:s.a.PERMISSION_SETTING,advanceAuth:s.a.ADVANCED_PERMISSION,waterMark:s.a.SET_WATER_MARK,transfer:s.a.TRANSFER_OWNERSHIP,browseRecord:s.a.BROWSE_RECORD},f=[s.a.PERMISSION_SETTING,s.a.ADVANCED_PERMISSION,s.a.SET_WATER_MARK,s.a.TRANSFER_OWNERSHIP,s.a.TRANSFER_OWNERSHIP_WEWORK,s.a.BROWSE_RECORD],m=["version","history"],v=["share"],g=function(){function e(){i()(this,e),c()(this,"extensionService",void 0),c()(this,"historyManager",void 0)}return o()(e,[{key:"init",value:function(e){var t=this;p.a.SlideAppService.promise().then((function(n){n.onReady((function(){var n=Object(d.d)("actionType");n&&t.openPanelByUrlParam(n,e)}))}))}},{key:"setServiceDelegates",value:function(e){this.extensionService=e.extensionService,this.historyManager=e.historyManager}},{key:"openPanelByUrlParam",value:function(e,t){var n,r=(this.extensionService.getDocInfo()||{}).privilegeAttribute,i=h[e]||e;if(i){null!==(n=p.a.DocInfoManager())&&void 0!==n&&n.isOwner&&f.some((function(e){return e===i}))&&Object(u.a)(i,t,{}),r.can_edit&&m.some((function(e){return e===i}))&&this.paramAction(i),r.can_read&&v.some((function(e){return e===i}))&&this.paramAction(i);var a=window.location.href,o=Object(d.e)(a,"actionType");history.replaceState(null,"",o)}}},{key:"paramAction",value:function(e){var t;if("version"===e||"history"===e)null===(t=this.historyManager)||void 0===t||t.show({activeId:e});else if("share"===e){var n,r;null===(n=this.extensionService.getCallBackAdapter())||void 0===n||null===(r=n.showShareModule)||void 0===r||r.call(n)}}}]),e}()},f93500c28e:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=!1;function i(){return r}},faafd2f4cf:function(e,t,n){"use strict";n.r(t),n.d(t,"MobileRatingService",(function(){return w}));var r=n("9132715560"),i=n.n(r),a=n("6a364eb35c"),o=n.n(a),l=n("85d0a7609b"),c=n.n(l),s=n("69084d01d3"),u=n.n(s),d=n("5fac0349d3"),p=n("960b6aae64"),h=n("a531710d11"),f=n.n(h),m=n("1a00d79b5b"),v=n("dc62871a42"),g=n("7afcef1d02"),b=n("7560a8e69a"),y=n("d3d31c86eb"),x=n("9da6335152"),w=function(){function e(t,n,r,a,o,l){var s=this;i()(this,e),c()(this,"isWaitingForShowInEdit",void 0),c()(this,"analyzer",void 0),c()(this,"isShow",void 0),c()(this,"panel",void 0),c()(this,"editStateDisposer",void 0),c()(this,"handleOnClose",(function(){s.panel.close(),s.isShow=!1,s.panel=null})),c()(this,"showUniformFontUI",(function(e,t){})),c()(this,"handleOnToOptimizeInPreview",(function(){s.handleOnClose(),s.isWaitingForShowInEdit=!0,s.showInEdit(),Object(y.c)({opername:x.e.DOC_PPT,module:x.d.AUTO_BEAUTIFY,action:x.b.BEAUTIFY_VIEW_TO_EDIT})})),this.selectionService=n,this.mobileEntryStateService=r,this.mobileToolbarEditManager=a,this.analyzer=new p.a({forbidFontUseNumber:!0},t,o,l,this.showUniformFontUI)}return o()(e,[{key:"getAnalyser",value:function(){return this.analyzer}},{key:"showInPreview",value:function(){var e=this;if(!this.isShow){this.isShow=!0;var t=f.a.show({pullable:!1,panelHeight:"".concat(g.f,"px"),headerStyle:{height:"".concat(g.d,"px"),padding:"0 0"},header:u.a.createElement(m.a,{onClose:this.handleOnClose,title:d.a.t("排版检查和建议")}),content:u.a.createElement(v.a,{scene:v.b.Preview,analyzer:this.analyzer,mobileRatingService:this,selectionService:this.selectionService,getPanelFunc:function(){return e.panel},handleToOptimize:this.handleOnToOptimizeInPreview,handleOnClose:this.handleOnClose})});this.panel=t}}},{key:"showInEdit",value:function(){var e,t,n,r,i=this;null!==(e=(t=this.mobileEntryStateService).checkIfEditMode)&&void 0!==e&&e.call(t)||(null===(n=(r=this.mobileEntryStateService).enterEditMode)||void 0===n||n.call(r));setTimeout((function(){i.mobileToolbarEditManager.openEditPanel(null,b.b.LAYOUT_SUGGESTION)}),10)}},{key:"updateEditState",value:function(e){this.panel=e}},{key:"getSelectionService",value:function(){return this.selectionService}}]),e}()},fb1b2fc56a:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var r=n("176815363d"),i=n.n(r),a=n("9132715560"),o=n.n(a),l=n("85d0a7609b"),c=n.n(l),s=n("3ef2352f0b"),u=n.n(s),d=(n("c6244f7705"),n("081c8cafea"),n("1bab7b5fb7"),n("34cd92f77a"),n("b1e2246d82"),n("b40469cb12")),p=n("594d399aaf"),h="transfer-auth-container",f=function e(){var t=this;o()(this,e),c()(this,"showTransferAuth",i()(u.a.mark((function e(){var n,r,i,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.getContainer()).style.display="block",i=null===(n=window.clientVars)||void 0===n?void 0:n.userId.replace(/^p\./,""),e.next=5,d.a.extensionService.getExtension(p.a.name);case 5:null==(a=e.sent)||a.show({container:r,userId:i,weWorkDisabled:!0,onClose:function(){r.style.display="none"}});case 7:case"end":return e.stop()}}),e)})))),c()(this,"getContainer",(function(){var e=document.getElementById(h);return e||((e=document.createElement("div")).id=h),e}))}},ffcade8893:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={strokeWidth:1,strokeDash:3.5,margin:{arrowSize:{width:7,height:7},displayPadding:15},edge:{displayPadding:10},rect:{}},i={strokeWidth:1.25,strokeDash:3,margin:{arrowSize:{width:5,height:5},displayPadding:15},edge:{displayPadding:10},rect:{}}}}]);
//# sourceMappingURL=slide-async~95108331-ccbf6f.js.map
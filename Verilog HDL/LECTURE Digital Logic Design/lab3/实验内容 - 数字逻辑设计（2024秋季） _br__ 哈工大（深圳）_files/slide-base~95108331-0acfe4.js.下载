(this.webpackJsonp=this.webpackJsonp||[]).push([["base~95108331"],{"0ab82edd20":function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n,r,o,a=i("7a5536c9bf"),l=i.n(a),c=i("9132715560"),s=i.n(c),u=i("6a364eb35c"),d=i.n(u),h=i("85d0a7609b"),f=i.n(h),v=(i("8ee19818c4"),i("1bab7b5fb7"),i("34cd92f77a"),i("342844cefa"),i("af802ec74b"),i("8e7cce0ada"),i("29f8c5f672"),i("c6244f7705"),i("85d48ef22b"),i("2a6f332b5e"),i("eb9e932508"),i("6e20b6a7d8"),i("711a53c9fc")),p=i("7e6f356806"),m=(n={},f()(n,v.eb.dk1,"000000"),f()(n,v.eb.lt1,"FFFFFF"),f()(n,v.eb.dk2,"44546A"),f()(n,v.eb.lt2,"E7E6E6"),f()(n,v.eb.accent1,"4472C4"),f()(n,v.eb.accent2,"ED7D31"),f()(n,v.eb.accent3,"A5A5A5"),f()(n,v.eb.accent4,"FFC000"),f()(n,v.eb.accent5,"5B9BD5"),f()(n,v.eb.accent6,"70AD47"),f()(n,v.eb.hlink,"0563C1"),f()(n,v.eb.folHlink,"954F72"),n),b=(r={},f()(r,v.eb.dk1,""),f()(r,v.eb.lt1,""),f()(r,v.eb.dk2,""),f()(r,v.eb.lt2,""),f()(r,v.eb.accent1,""),f()(r,v.eb.accent2,""),f()(r,v.eb.accent3,""),f()(r,v.eb.accent4,""),f()(r,v.eb.accent5,""),f()(r,v.eb.accent6,""),f()(r,v.eb.hlink,""),f()(r,v.eb.folHlink,""),o={},f()(o,v.eb.dk1,""),f()(o,v.eb.lt1,""),f()(o,v.eb.dk2,""),f()(o,v.eb.lt2,""),f()(o,v.eb.accent1,""),f()(o,v.eb.accent2,""),f()(o,v.eb.accent3,""),f()(o,v.eb.accent4,""),f()(o,v.eb.accent5,""),f()(o,v.eb.accent6,""),f()(o,v.eb.hlink,""),f()(o,v.eb.folHlink,""),o);Object.keys(p.b[0].colorSchema).forEach((function(e){var t=p.b[0].colorSchema[e],i=t.val,n=t.color;b[i]=n})),Object.keys(p.b[1].colorSchema).forEach((function(e){var t=p.b[1].colorSchema[e],i=t.val,n=t.color;m[i]=n}));var y=i("e0e8dd9366"),g=i("75f19a1449"),S=360,T=function(){function e(){var t=this;s()(this,e),f()(this,"formatTemplateStandard",(function(e){var i=e.presentation.themeList,n=!0;if(i.forEach((function(e){var i=t.checkTemplateTheme(e);i||(n=i)})),n){var r=t.collectMainThemeColor(e.presentation),o=t.classifyColor(r),a={};o.forEach((function(e,t){a["accent".concat(t+1)]={val:v.eb["accent".concat(t+1)],color:e.getColorWithNoAlpha().replace("#","")}})),t.updateThemeWithNewColor(e,a)}})),f()(this,"checkTemplateTheme",(function(e){var t=e.clrScheme,i=!0;return Object.keys(t).forEach((function(e){var n,r,o,a,l=Object.assign({},m);(null===(n=(r=t[e]).toLowerCase)||void 0===n?void 0:n.call(r))!==(null===(o=(a=l[e]).toLowerCase)||void 0===o?void 0:o.call(a))&&(i=!1)})),i})),f()(this,"collectMainThemeColor",(function(e){var i=new Map;return e.children.forEach((function(e){e.children.forEach((function(e){switch(e.type){case y.d.SHAPE:t.collectShape(e,i);break;case y.d.GROUP:t.collectGroup(e,i)}}))})),i})),f()(this,"classifyColor",(function(e){var i,n,r=0,o=!1,a=[];if(e.size>6){var l=[];e.forEach((function(e,t){l.push(e.color)})),l.sort((function(e,t){return e.hsl.H-t.hsl.H}));for(var c=l[0],s=1;s<l.length;s++){var u=l[s];u.hsl.H-c.hsl.H>r&&(i=c,n=u,r=u.hsl.H-c.hsl.H),c=u,s===l.length-1&&S-u.hsl.H+l[0].hsl.H>r&&(n=c,i=l[0],o=!0)}if(!n||!i)return a;t.fillThemeColorWithSharingDue(o,n,i,a)}else t.fillThemeColorWithLessColor(e,a);return a})),f()(this,"collectGroup",(function(e,i){e.children.forEach((function(e){e.type===y.d.GROUP?t.collectGroup(e,i):e.type===y.d.SHAPE&&t.collectShape(e,i)}))})),f()(this,"collectShape",(function(e,i){var n=e.props.style.fillBackground;if(n){var r=n.solidFill,o=n.gradFill,a=null==r?void 0:r.color;a&&t.computeColor(a,i),null!=o&&o.gsList&&o.gsList.forEach((function(e){var n=e.color;n&&t.computeColor(n,i)}))}}))}return d()(e,[{key:"fillThemeColorWithSharingDue",value:function(e,t,i,n){if(e)for(var r=(t.hsl.H-i.hsl.H)/6,o=0;o<6;o++){var a=Object.assign({},i.hsl);a.H=a.H+o*r,a.H>S&&(a.H=a.H-S);var l=g.a.rgb2RgbString(g.a.hsl2Rgb(a)),c=new g.a({rgbaStr:l});n.push(c)}else for(var s=(S-t.hsl.H+i.hsl.H)/6,u=0;u<6;u++){var d=Object.assign({},t.hsl);d.H=d.H+u*s,d.H>S&&(d.H=d.H-S);var h=g.a.rgb2RgbString(g.a.hsl2Rgb(d)),f=new g.a({rgbaStr:h});n.push(f)}}},{key:"fillThemeColorWithLessColor",value:function(e,t){var i=[];e.forEach((function(e,t){i.push(e)})),i.sort((function(e,t){return t.colorNumber-e.colorNumber})),t.push.apply(t,l()(i.map((function(e){return e.color}))))}},{key:"computeColor",value:function(e,t){if(e.hsl.S>50&&e.hsl.L<200&&e.hsl.L>40){var i=e.srgb_color,n=t.get(i);n?n.colorNumber=n.colorNumber+1:t.set(i,{color:e,colorNumber:1})}}},{key:"updateThemeWithNewColor",value:function(e,t){e.presentation.themeList.forEach((function(e){var i=e.id,n=e.clrScheme,r={dk1:{val:v.eb.dk1,color:n[v.eb.dk1]},dk2:{val:v.eb.dk2,color:n[v.eb.dk2]},lt1:{val:v.eb.lt1,color:n[v.eb.lt1]},lt2:{val:v.eb.lt2,color:n[v.eb.lt2]},accent1:{val:v.eb.accent1,color:n[v.eb.accent1]},accent2:{val:v.eb.accent2,color:n[v.eb.accent2]},accent3:{val:v.eb.accent3,color:n[v.eb.accent3]},accent4:{val:v.eb.accent4,color:n[v.eb.accent4]},accent5:{val:v.eb.accent5,color:n[v.eb.accent5]},accent6:{val:v.eb.accent6,color:n[v.eb.accent6]},hlink:{val:v.eb.hlink,color:n[v.eb.hlink]},folHlink:{val:v.eb.folHlink,color:n[v.eb.folHlink]}},o={id:i||"",colorSchema:Object.assign(r,t)};e.updateTheme(o)}))}}]),e}()},"0ef902d941":function(e,t,i){"use strict";i.d(t,"a",(function(){return ne}));i("342844cefa"),i("a84962d637"),i("bcb5d93d36");var n,r,o,a,l,c,s,u,d,h,f=i("7a5536c9bf"),v=i.n(f),p=i("730477bb20"),m=i.n(p),b=i("1f925d7f50"),y=i.n(b),g=i("9132715560"),S=i.n(g),T=i("6a364eb35c"),k=i.n(T),O=i("85d0a7609b"),E=i.n(O),C=i("2dc700e1e6"),A=i.n(C),R=(i("f1054791f4"),i("8e7cce0ada"),i("c6244f7705"),i("081c8cafea"),i("85d48ef22b"),i("2a6f332b5e"),i("3bf1976a4f"),i("8ee19818c4"),i("8a35b54c1d"),i("22569efd03"),i("63513d8b56"),i("75563bc376"),i("963f2eaace"),i("c554310b5c"),i("69084d01d3")),w=i.n(R),L=i("55b49a95fc"),x=i("ee6bb53310"),M=i.n(x),I=i("7e4a465ef4"),P=i("743ef67b0e"),B=i("d5c3deb8c7"),D=i("ac007171af"),F=i("7e6f356806"),_=i("e0e8dd9366"),N=i("9657b29818"),j=i("1d0dc9eef2"),G=i("711a53c9fc"),H=i("75f19a1449"),z=i("a7888a8b87"),V=i.n(z),W=i("9b36746bc7"),U=i("65843d4926"),q=i("e0b2192bab"),K=i("efc1955963"),Y=i("d3d31c86eb"),Z=i("9da6335152"),J=i("b479a84af5"),X=i("020899bf26"),$=i("fe82ecf3fc"),Q=i("5fac0349d3"),ee=i("5ce71228c0");function te(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ie(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?te(Object(i),!0).forEach((function(t){E()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):te(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ne=(n=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),r=Reflect.metadata("design:type",void 0===D.IThemeModel?Object:D.IThemeModel),o=Reflect.metadata("design:type",Function),a=Reflect.metadata("design:paramtypes",[]),l=function(){function e(t){var n=this;S()(this,e),y()(this,"themeColorDialogVisible",c,this),y()(this,"themeColorCustomDialogVisible",s,this),y()(this,"originCustomColorList",u,this),y()(this,"currentThemeModel",d,this),y()(this,"isDark",h,this),E()(this,"isOpenCustomPanel",!1),E()(this,"currentEditThemeKey",void 0),E()(this,"onSelect",void 0),E()(this,"onCancel",void 0),E()(this,"newPresentationStoreService",void 0),E()(this,"cloneUiDataService",void 0),E()(this,"uiDataService",void 0),E()(this,"isConvert",void 0),E()(this,"selectionService",void 0),E()(this,"presentation",void 0),E()(this,"slideRenderStateManager",void 0),E()(this,"slideContentEnumeratorService",void 0),E()(this,"reaction",void 0),E()(this,"LazyImportDialogComponent",Object(R.lazy)((function(){return Object(X.d)((function(){return Promise.all([i.e("commonAsync~9b1fde68"),i.e("commonAsync~27f19aac"),i.e("commonAsync~205ac551"),i.e("commonAsync~0c3a6025"),i.e("commonAsync~32e631b8"),i.e("commonAsync~08369118"),i.e("commonAsync~50db4bb8"),i.e("commonAsync~86c92fed"),i.e("commonAsync~a95f944a"),i.e("commonAsync~6e568190"),i.e("commonAsync~b174e5ca"),i.e("commonAsync~54a68610"),i.e("commonAsync~61b3c105"),i.e("commonAsync~f7b3ac00"),i.e("commonAsync~cece21d6"),i.e("commonAsync~ecbf7682"),i.e("commonAsync~6c5dfa7c"),i.e("commonAsync~90483627"),i.e("commonAsync~d2c096c2"),i.e("commonAsync~1285a477"),i.e("commonAsync~31ded9a0"),i.e("commonAsync~ecdbff9b"),i.e("commonAsync~c2cc425c"),i.e("commonAsync~4fb44df2"),i.e("commonAsync~d06fe423"),i.e("commonAsync~0519277e"),i.e("commonAsync~6df2b9ea"),i.e("commonAsync~b5c4f9e4"),i.e("commonAsync~ffdf5190"),i.e("commonAsync~127b6cf7"),i.e("commonAsync~b3c4a2ff"),i.e("commonAsync~19bb5a55"),i.e("async~493df0b3"),i.e("async~c5b24172"),i.e("async~0d51b00e"),i.e("async~beecf843"),i.e("async~2e2c6527"),i.e("async~da8db81f"),i.e("async~e10030d6"),i.e("async~098dcb65"),i.e("async~d0c14fe8"),i.e("async~7f8bedbf"),i.e("async~f40490b4"),i.e("async~2158e36e"),i.e("async~76acd586"),i.e("async~37d786cf"),i.e("async~30ccc425"),i.e("async~0c7d7381"),i.e("async~907e9098"),i.e("async~43172549"),i.e("async~f19eb79b"),i.e("async~95108331"),i.e("async~718865d2"),i.e("async~89b7a519"),i.e("vendors~lazyComponents")]).then(i.bind(null,"7a304b4bd6"))}))}))),E()(this,"getLazyComponent",(function(e){var t=n.LazyImportDialogComponent;return w.a.createElement(J.a,null,w.a.createElement(t,m()({},e,{themeColorManager:n})))})),E()(this,"setSlideContentEnumeratorService",(function(e){n.slideContentEnumeratorService=e})),E()(this,"copyPresentation",(function(){var e,t;n.presentation=n.uiDataService.presentation.sdkData,n.newPresentationStoreService=null===(e=X.a.SDKDataServices.PresentationStoreService())||void 0===e?void 0:e.createFromData(n.presentation.getCloneData());var i=null===(t=n.newPresentationStoreService)||void 0===t?void 0:t.presentation,r=new I.a({selectionService:n.selectionService});r.bindSDK(i),n.cloneUiDataService=new P.a,n.cloneUiDataService.presentation=r,requestAnimationFrame((function(){n.updateThemeColorDialogVisible(!0)}))})),E()(this,"applyThemeColor",(function(e){var t;[].concat(v()(F.b),v()(n.customColorList)).forEach((function(i){i.id===e&&(t=i)})),t&&Object(N.b)((function(){var e;null===(e=n.uiDataService.presentation.themeList)||void 0===e||e.forEach((function(e){t&&e.updateTheme(t)}))}))})),E()(this,"destroyCopySlideApp",(function(){n.presentation=null,n.newPresentationStoreService=null,n.cloneUiDataService=null})),E()(this,"addUndoEventCallBack",(function(e){var t;null===(t=n.newPresentationStoreService)||void 0===t||t.getEventManager().commandEvents.onUndoRedoChange((function(t){var i=t.canUndo;e(i)}))})),E()(this,"removeCustomThemeById",(function(e){var t=n.customColorList.concat().filter((function(t){return t.id!==e}));ee.b.setItem(ee.a.LOCAL_SLIDE_CUSTOM_THEME,t),n.customColorList=t})),E()(this,"removeCustomThemeByCurrentEditKey",(function(){n.currentEditThemeKey&&n.removeCustomThemeById(n.currentEditThemeKey)})),E()(this,"setCurrentEditKey",(function(e){n.currentEditThemeKey=e})),E()(this,"updateCustomTheme",(function(e){var t=n.customColorList.concat(),i=t.filter((function(t){return t.title===e.title&&t.id!==e.id})),r=t.findIndex((function(t){return t.id===e.id}));if(null!=i&&i.length){if(!e.subTitle){var o=1,a={};for(i.forEach((function(e){e.subTitle&&(a[e.subTitle]=!0)}));a[o];)o+=1;e.subTitle=o}}else e.subTitle=void 0;t.splice(r,1,e),n.customColorList=t})),E()(this,"addCustomTheme",(function(e){var t=n.customColorList.concat(),i="".concat("local_slide_custom_theme_id","_").concat(Date.now()),r=t.filter((function(t){return t.title===e.title}));if(null!=r&&r.length){if(!e.subTitle){var o=1,a={};for(r.forEach((function(e){e.subTitle&&(a[e.subTitle]=!0)}));a[o];)o+=1;e.subTitle=o}}else e.subTitle=void 0;var l=ie(ie({},e),{},{id:i});return t.push(l),n.customColorList=t,l})),E()(this,"getCustomThemeById",(function(e){return n.customColorList.find((function(t){return t.id===e}))})),E()(this,"getAllCustomTheme",(function(){var e=ee.b.getItem(ee.a.LOCAL_SLIDE_CUSTOM_THEME),t=[];return null!=e&&e.length&&t.push.apply(t,v()(e)),t})),E()(this,"convertCustomColorToTheme",(function(e,t){if(!n.isConvert||!e){var i,r=!(null==t||!t.ignorePlaceholder);i=e&&n.cloneUiDataService?n.cloneUiDataService:n.uiDataService,n.handleSlideModelConvert(i),n.slideContentEnumeratorService&&(n.slideContentEnumeratorService.enumerateWithCallbackSync({elementCallback:function(e){var i=e.element;r&&i.isPlaceholder||n.handleElementConvert(i,t)},tableCellCallback:function(e){var t=e.element,i=e.cell,r=e.row,o=e.col;n.handleTableModelConvert(t,i,r,o)}},{stopTextBlockParentBoxCallback:!0,customUiDataService:i}),n.isConvert=!0)}})),E()(this,"handleElementConvert",(function(e,t){e.type===_.d.SHAPE&&n.handleShapeModelConvert(e,t),e.type===_.d.GROUP&&n.handleGroupModelConvert(e,t)})),E()(this,"handleGroupModelConvert",(function(e,t){e.children.forEach((function(e){e.type===_.d.GROUP&&n.handleGroupModelConvert(e),e.type===_.d.SHAPE&&n.handleShapeModelConvert(e,t)}))})),E()(this,"updateCurrentThemeModel",(function(){var e,t,i=null===(e=n.selectionService.currentSlide)||void 0===e?void 0:e.getRelationMasterModel();n.currentThemeModel=null==i?void 0:i.getTheme(),n.isDark=(null==i||null===(t=i.clrMap)||void 0===t?void 0:t.tx1)===G.p.lt1})),E()(this,"initReaction",(function(){var e;n.reaction=Object(B.r)((function(){return[n.selectionService.currentSlide]}),(function(){n.updateCurrentThemeModel()})),null===(e=X.a.SDKDataServices.EventManager())||void 0===e||e.commandEvents.onUndoRedoChange((function(e){e.source!==$.b.Undo&&e.source!==$.b.Redo||n.updateCurrentThemeModel()}))})),E()(this,"handleTableModelConvert",(function(e,t,i,r){var o,a=e.sdkData,l=(null===(o=t.props.style)||void 0===o?void 0:o.fillBackground)||{},c=l.solidFill,s=l.gradFill,u={};if(c){var d=n.handleSolidFill(c);d&&M()(u,"props.style.fillBackground",{solidFill:d})}if(s){var h=n.handleGradFill(s);h&&M()(u,"props.style.fillBackground",{gradFill:h})}if(u.props){var f={};W.a.convertPartialDataFromUiToSdk(u,f);var v={startRowIndex:i,startColIndex:r,rowSpan:1,colSpan:1};f.tcPr&&(Object(U.a)(f.tcPr),a.api.updateTableCellProperties(f.tcPr,v))}var p={paragraphList:n.handleTextColorToTheme(t)},m={};q.a.convertPartialDataFromUiToSdk(p,m),K.a.sdkV3UpdateCellParagraphList(a,m,r,i)})),E()(this,"handleSlideModelConvert",(function(e){var t=e.slideModelList;null==t||t.forEach((function(e){var t=e.props.style.fillBackground||{},i=t.solidFill,r=t.gradFill;if(i){var o=n.handleSolidFill(i);o&&e.getBackgroundFill().updateCurrentFillForCurrentModel({solidFill:o})}if(r){var a=n.handleGradFill(r);a&&e.getBackgroundFill().updateCurrentFillForCurrentModel({gradFill:a})}}))})),E()(this,"handleShapeModelConvert",(function(e,t){n.handleShapeBackgroundFill(e),n.handleShapeBorderConvert(e);var i=n.handleTextColorToTheme(e,t);e.updateParagraphList(i)})),E()(this,"handleShapeBorderConvert",(function(e){var t,i=null===(t=e.getBorder())||void 0===t?void 0:t.getBorderInfo();if(null!=i&&i.tdColor&&!G.eb[i.tdColor.colorValue]){var r,o,a=n.getTdColorWithTheme(i.tdColor);i.tdColor=a,i.color=a.srgb_color,null===(r=e.getBorder)||void 0===r||null===(o=r.call(e))||void 0===o||o.updateCurrentBorder(i,!1,!1)}}));var r=t.uiDataService,o=t.selectionService,a=t.slideRenderStateManager;this.uiDataService=r,this.selectionService=o,this.slideRenderStateManager=a,this.customColorList=this.getAllCustomTheme(),this.initReaction()}return k()(e,[{key:"showThemeTips",value:function(){var e=this;L.a.show({message:Q.a.t("图表配色可基于主题色更新"),type:"info",duration:6e3,action:Q.a.t("去切换"),onClickAction:function(){return e.showThemeModal()}})}},{key:"showThemeModal",value:function(e){null!=e&&e.onSelect&&(this.onSelect=e.onSelect),null!=e&&e.onCancel&&(this.onCancel=e.onCancel),null!=e&&e.source&&Object(Y.c)({opername:Z.e.DOC_PPT,module:Z.d.COLOR_SWITCH,action:Z.b.THEME_VIEW,ver5:e.source}),this.isOpenCustomPanel=!(null==e||!e.showCustomTab),this.copyPresentation()}},{key:"updateThemeColorDialogVisible",value:function(e){var t=this;this.themeColorDialogVisible=e,requestAnimationFrame((function(){e||(t.destroyCopySlideApp(),t.clearAICallback())})),this.isConvert=!1}},{key:"updateThemeColorCustomDialogVisible",value:function(e){this.themeColorCustomDialogVisible=e}},{key:"handleTextColorToTheme",value:function(e,t){var i=this,n=e.paragraphList,r=null==t?void 0:t.fontColor;if(null!=n&&n.length){var o=V()(n);return o.forEach((function(e){var t=e.textRuns;null==t||t.forEach((function(e){var t=e.styles;if(t){var n=t.tdColor;if(n){var o;if(G.eb[n.colorValue])return;var a=r||i.getTdColorWithTheme(n,!0);t.tdColor=a;var l=null===(o=i.currentThemeModel)||void 0===o?void 0:o.clrScheme[a.colorValue];l&&(t.color=H.a.lumToHex(l,a.lumOff,a.lumMod))}}}))})),o}}},{key:"customColorList",get:function(){return this.originCustomColorList},set:function(e){this.originCustomColorList=e,ee.b.setItem(ee.a.LOCAL_SLIDE_CUSTOM_THEME,e)}},{key:"clearAICallback",value:function(){this.onSelect=void 0,this.onCancel=void 0}},{key:"handleShapeBackgroundFill",value:function(e){var t,i=(null===(t=e.props.style)||void 0===t?void 0:t.fillBackground)||{},n=i.solidFill,r=i.gradFill;if(n){var o=this.handleSolidFill(n);o&&e.getBackgroundFill().updateCurrentFill({solidFill:o},!1)}if(r){var a=this.handleGradFill(r);e.getBackgroundFill().updateCurrentFill({gradFill:a},!1)}}},{key:"handleSolidFill",value:function(e){var t=e.color;if(!G.eb[t.colorValue]){var i=this.getTdColorWithTheme(t);return new j.a(i)}}},{key:"handleGradFill",value:function(e){var t=this,i=V()(e),n=i.gsList;return null==n||n.forEach((function(e){var i=e.color;i&&!G.eb[i.colorValue]&&(e.color=t.getTdColorWithTheme(i))})),i}},{key:"getTdColorWithTheme",value:function(e,t){var i=e.hsl,n=[];n=i.S<50?this.getWhiteBlackWithTheme(i,t):this.handleHueAndColColor(i);var r=this.handleLumAndRowColor(n,i),o=r.lumMod,a=r.lumOff,l=r.key;return new H.a({themeKey:this.currentThemeModel.getMasterColorKeyFromTheme(l,this.isDark),lumOff:a,lumMod:o,alpha:e.alpha})}},{key:"handleLumAndRowColor",value:function(e,t){var i,n;return e.forEach((function(e){e.forEach((function(e){var r=Math.abs(e.hsl.L-t.L);if(!i)return i=e,void(n=r);r<n&&(i=e,n=r)}))})),i}},{key:"getWhiteBlackWithTheme",value:function(e,t){var i,n=[],r=void 0;return F.c.slice(0,4).forEach((function(t,o){var a=t[0],l=V()(t),c=Math.abs(a.hsl.H-e.H);return 0===c?(n.push(l),void(i=c)):r?void(c<i&&(r=l,i=c)):(r=l,void(i=c))})),!n.length&&r&&n.push(r),t&&n.forEach((function(e){e.forEach((function(e){e.key=G.eb.tx1}))})),n}},{key:"handleHueAndColColor",value:function(e){var t,i=[],n=void 0;return F.c.slice(4).forEach((function(r,o){var a=r[0],l=Math.abs(a.hsl.H-e.H);return 0===l?(i.push(r),void(t=l)):n?void(l<t&&(n=r,t=l)):(n=r,void(t=l))})),!i.length&&n&&i.push(n),i}}]),e}(),c=A()(l.prototype,"themeColorDialogVisible",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=A()(l.prototype,"themeColorCustomDialogVisible",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=A()(l.prototype,"originCustomColorList",[B.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=A()(l.prototype,"currentThemeModel",[B.q,r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=A()(l.prototype,"isDark",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A()(l.prototype,"customColorList",[B.f,o,a],Object.getOwnPropertyDescriptor(l.prototype,"customColorList"),l.prototype),l)},"10eb5d8814":function(e,t,i){"use strict";i.d(t,"a",(function(){return B}));var n,r,o,a,l,c,s,u,d=i("1f925d7f50"),h=i.n(d),f=i("9132715560"),v=i.n(f),p=i("6a364eb35c"),m=i.n(p),b=i("85d0a7609b"),y=i.n(b),g=i("2dc700e1e6"),S=i.n(g),T=(i("f1054791f4"),i("b8217400dc"),i("e6f68cdf2e"),i("e6d98148ee")),k=i("f4e4ed5c17"),O=i("0a8ecd6412"),E=i("798a9cd6f2"),C=i("d5c3deb8c7"),A=i("c528460648"),R=i("5ce71228c0"),w=i("6884e1a126"),L=i("b724aeb83f"),x=i("ced39f0c87"),M=O.v.DOUBLE_TOOLBAR;!function(e){e.SWITCH_TOOLBAR_MODE_EVENT="swithToolbarMode"}(u||(u={}));var I=E.e.API_ROOT,P="".concat(I,"v2/user/attribute/update"),B=(n=function(){function e(){var t=this;v()(this,e),h()(this,"isClickOnToolbar",r,this),h()(this,"isHeaderFold",o,this),h()(this,"isToolbarAniming",a,this),h()(this,"isToolbarMenuShown",l,this),y()(this,"lastInsertButtonClick",0),h()(this,"isMobileToolbarClick",c,this),h()(this,"currMode",s,this),y()(this,"event",void 0),y()(this,"getToolbarMode",(function(){return t.currMode})),y()(this,"setToolbarMode",(function(e){t.currMode=e,R.b.setItem(R.a.TOOLBAR_MODE_SLIDE,e),t.setUserToolbarModeSetting(e)})),y()(this,"updateToolbarMode",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;t.sendEvent(e)})),y()(this,"setUserToolbarModeSetting",(function(e){var t={userAttribute:JSON.stringify({attributes:[{name:"toolbar_mode_slide",value:e}]})};Object(k.a)(P,{method:"POST",data:t}).then((function(e){var t=e.data.header;0!==(null==t?void 0:t.code)&&window.log.error("[toolbarStateManager]setUserToolbarModeSetting failed",t.code,t.message)})).catch((function(e){window.log.error("[toolbarStateManager]setUserToolbarModeSetting error",e)}))})),window.getActiveTab=function(){var e=w.e.get(L.a);console.log("====",e.get(x.a.RibbonActiveTab))},this.event=new T.a,this.currMode=this.getDefaultToolbarMode(),Object(A.a)((function(){t.updateToolbarMode(t.currMode)}))}return m()(e,[{key:"getDefaultToolbarMode",value:function(){var e,t,i,n;return null===R.b.getItem(R.a.HAS_NEW_TOOLBAR_SHOWED)?(R.b.setItem(R.a.HAS_NEW_TOOLBAR_SHOWED,!0),this.setToolbarMode(M),M):(null===(e=window)||void 0===e||null===(t=e.basicClientVars)||void 0===t||null===(i=t.userInfo)||void 0===i||null===(n=i.settings)||void 0===n?void 0:n.toolbarMode)||R.b.getItem(R.a.TOOLBAR_MODE_SLIDE,M)}},{key:"sendEvent",value:function(e){[O.v.SINGLE_TOOLBAR,O.v.DOUBLE_TOOLBAR].includes(e)&&e!==this.currMode&&this.event.emit(u.SWITCH_TOOLBAR_MODE_EVENT,e)}}]),e}(),r=S()(n.prototype,"isClickOnToolbar",[C.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=S()(n.prototype,"isHeaderFold",[C.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=S()(n.prototype,"isToolbarAniming",[C.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=S()(n.prototype,"isToolbarMenuShown",[C.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=S()(n.prototype,"isMobileToolbarClick",[C.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=S()(n.prototype,"currMode",[C.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),n)},"12b829499b":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return d}));var n,r=i("9132715560"),o=i.n(r),a=i("6a364eb35c"),l=i.n(a),c=i("85d0a7609b"),s=i.n(c),u=(i("759492dad9"),i("6e20b6a7d8"),i("0acdc5834b"),i("8ee19818c4"),i("b1ad530fa6"));!function(e){e.CoverPage="CoverPage",e.TableOfContents="TableOfContents",e.SectionDivider="SectionDivider",e.Acknowledgments="Acknowledgments",e.Content="Content"}(n||(n={}));var d=function(){function e(t,i,r){o()(this,e),s()(this,"pageModel",void 0),s()(this,"pageType",n.Content),s()(this,"texts",void 0),s()(this,"allTextString",void 0),this.pageModel=t,this.texts=i,r&&(this.pageType=r)}return l()(e,[{key:"getAllTextString",value:function(){return this.allTextString||(this.allTextString=this.texts.map((function(e){return e.text})).join("")),this.allTextString}},{key:"resetCoverPageTitle",value:function(){if(this.pageType===n.CoverPage){var e=this.texts.reduce((function(e,t){var i=t.contentBlock.getTextFontSize();return i>e?i:e}),0);this.texts.forEach((function(t){var i=t.contentBlock.getTextFontSize();t.titleOrContent=i===e?u.a.Title:u.a.Content}))}}}]),e}()},"18695a8c86":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.ELEMENT="element",e.SLIDE="slide"}(n||(n={}))},"27ac6227b7":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),c=i.n(l),s=(i("8e7cce0ada"),i("c6244f7705"),i("c9a7ecac4d"),i("85d48ef22b"),i("2a6f332b5e"),i("8ee19818c4"),i("b8217400dc"),i("e6f68cdf2e"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36"),i("fe82ecf3fc")),u=i("020899bf26"),d=i("fab0b2fcc7"),h=i("c9c92622ff");function f(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var v=function(){function e(){r()(this,e),c()(this,"stashedSelection",null),c()(this,"editorInstanceService",null),c()(this,"history",{undos:[],redos:[]}),c()(this,"undoRedoCallBacks",new Set),this.initUndoRedoListener()}return a()(e,[{key:"setEditorInstanceServiceDelegate",value:function(e){this.editorInstanceService=e}},{key:"stashSelectionBefore",value:function(e,t,i){var n;null!==(n=this.stashedSelection)&&void 0!==n&&n.selectionBefore||(this.stashedSelection={selectionBefore:e,modelId:t,tableCellCoordinate:i,selectionAfter:e})}},{key:"stashSelectionAfter",value:function(e,t,i){var n,r,o;t===(null===(n=this.stashedSelection)||void 0===n?void 0:n.modelId)&&(null==i?void 0:i.col)===(null===(r=this.stashedSelection.tableCellCoordinate)||void 0===r?void 0:r.col)&&(null==i?void 0:i.row)===(null===(o=this.stashedSelection.tableCellCoordinate)||void 0===o?void 0:o.row)&&e&&(this.stashedSelection.selectionAfter=e)}},{key:"clearRedo",value:function(){this.history.redos=[]}},{key:"triggerUndoRedo",value:function(e,t,i){return e===s.b.Undo?(this.handleUndo(t,i),void this.executeCallbacks()):e===s.b.Redo?(this.executeCallbacks(),void this.handleRedo(t,i)):void 0}},{key:"afterUndoRedo",value:function(e){var t=this;return this.undoRedoCallBacks.add(e),function(){t.undoRedoCallBacks.delete(e)}}},{key:"executeCallbacks",value:function(){this.undoRedoCallBacks.forEach((function(e){return e()}))}},{key:"initUndoRedoListener",value:function(){var e=this;u.a.SDKDataServices.EventManager.promise().then((function(t){t.commandEvents.onUndoRedoChange((function(t){var i=t.mutationsType,n=t.source,r=t.commandId;n!==s.b.Editor||e.handleEdit(i,r)}))}))}},{key:"handleEdit",value:function(e,t){if(this.stashedSelection&&e.some((function(e){return d.b.includes(e)}))){var i=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?f(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({commandId:t},this.stashedSelection);this.writeHistory("undos",i)}this.stashedSelection=null,this.clearRedo()}},{key:"handleUndo",value:function(e,t){var i=this.history.undos;if(i.length>0&&e===i[i.length-1].commandId){var n=i.pop();this.updateTextSelection(t,n.selectionBefore,n.modelId,n.tableCellCoordinate),this.writeHistory("redos",n)}}},{key:"handleRedo",value:function(e,t){var i=this.history.redos;if(i.length>0&&e===i[i.length-1].commandId){var n=i.pop();this.updateTextSelection(t,n.selectionAfter,n.modelId,n.tableCellCoordinate),this.writeHistory("undos",n)}}},{key:"updateTextSelection",value:function(e,t,i,n){if(i===e.id){var r=null;if(Object(h.C)(e))r=e.noteData.noteTextBody.editorInstance;else if(Object(h.B)(e))r=e.editorInstance;else if(Object(h.D)(e)&&n){var o,a,l=null===(o=e.tableItems)||void 0===o||null===(a=o[n.row])||void 0===a?void 0:a[n.col];r=null==l?void 0:l.editorInstance}if(r){var c,s=null===(c=this.editorInstanceService)||void 0===c?void 0:c.getEditorInstance();s&&r!==s&&(null==s||s.triggerBlur()),r.updateSelection(t,!0)}}}},{key:"writeHistory",value:function(e,t){this.history[e].push(t),"undos"===e&&this.history.undos.length>d.a&&this.history.undos.shift()}}]),e}()},"28bc2be06b":function(e,t,i){"use strict";i.d(t,"a",(function(){return f})),i.d(t,"c",(function(){return v})),i.d(t,"g",(function(){return o})),i.d(t,"i",(function(){return a})),i.d(t,"h",(function(){return l})),i.d(t,"e",(function(){return c})),i.d(t,"d",(function(){return p})),i.d(t,"f",(function(){return m})),i.d(t,"b",(function(){return b}));var n,r,o,a,l,c,s=i("85d0a7609b"),u=i.n(s),d=i("382929c8da"),h=i("5fac0349d3"),f="/v2/enterprise/communication/get",v="/v2/enterprise/communication/set";!function(e){e[e.ALL=0]="ALL",e[e.CURRENT=1]="CURRENT",e[e.NOT=2]="NOT"}(o||(o={})),function(e){e.TOGGLE_TYPE="toggle_type",e.FILE_ID="file_id",e.TOGGLE_ON="toggle_on",e.TOGGLE_SCOPE="toggle_scope"}(a||(a={})),function(e){e.FIRST_SHOW="first-show",e.GENERATE_COPIES="generate-copies"}(l||(l={})),function(e){e.NOT="不同步",e.CURRENT="同步本篇",e.ALL="同步全部"}(c||(c={}));var p=(n={},u()(n,d.a.NOT_SYNC,o.NOT),u()(n,d.a.SYNC_CURRENT_FILE,o.CURRENT),u()(n,d.a.SYNC_ALL_FILE,o.ALL),n),m=(r={},u()(r,d.a.NOT_SYNC,h.a.t(c.NOT)),u()(r,d.a.SYNC_CURRENT_FILE,h.a.t(c.CURRENT)),u()(r,d.a.SYNC_ALL_FILE,h.a.t(c.ALL)),r),b="IS_SYNC_TO_B_LIST"},"2d25e86360":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),c=i.n(l),s=(i("b1e2246d82"),i("d5c3deb8c7")),u=i("d3d31c86eb"),d=i("0a4e8b541b"),h=function(){function e(t){var i=this;r()(this,e),c()(this,"costTime",void 0),c()(this,"selectionServiceDelegate",void 0),c()(this,"observeLongtask",(function(){"PerformanceObserver"in window&&new PerformanceObserver((function(e){for(var t,n,r,o=e.getEntries()||[],a=0;a<o.length;a++){var l=o[a];if("longtask"===l.entryType)t=l;else if("switchPageBegin"===l.name)n=l;else if("switchPageEnd"===l.name){r=l,n&&r&&(i.costTime.jsDuration=r.startTime-n.startTime,t?(i.costTime.taskDuration=t.duration,Object(u.c)({opername:"ppt_performance",module:"switch_page",action:"cost_time",ver6:JSON.stringify(i.costTime)})):i.costTime.taskDuration=i.costTime.jsDuration,console.log("PerformanceObserver-switch-page",i.costTime));break}}})).observe({entryTypes:["longtask","mark"]})})),c()(this,"observeSlideIndexChange",(function(e){Object(s.r)((function(){return{slideIndex:e.currentSlideIndex}}),(function(){e.currentSlide&&i.begin(e.currentSlide.key,d.a.includeBaseElementCount(e.currentSlide))}))})),this.costTime={pageKey:null,baseElementCount:0,jsDuration:0,taskDuration:0},t&&this.setSelectionServiceDelegate(t)}return a()(e,[{key:"setSelectionServiceDelegate",value:function(e){this.selectionServiceDelegate||(this.selectionServiceDelegate=e,this.observeSlideIndexChange(e),this.observeLongtask())}},{key:"end",value:function(e){this.costTime.pageKey}},{key:"begin",value:function(e,t){this.costTime.pageKey!==e&&(this.costTime={pageKey:e,baseElementCount:t,jsDuration:0,taskDuration:0})}}]),e}()},"2d65cb09dc":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.EDIT_PC="edit-pc",e.EDIT_MOBILE="edit-mobile",e.THUMBNAIL_PC="thumbnail-pc",e.THUMBNAIL_MOBILE="thumbnail-mobile",e.PLAYER_EDIT_PC="player-edit-pc",e.PLAYER_EDIT_MOBILE="player-edit-mobile",e.PLAYER_THUMBNAIL_PC="player-thumbnail-pc",e.PLAYER_THUMBNAIL_MOBILE="player-thumbnail-mobile",e.UNKNOWN="unknown"}(n||(n={}))},"2e2ccf062e":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));i("73b854064b");var n=i("9132715560"),r=i.n(n),o=i("bd29e2df90"),a=i.n(o),l=i("ab5eb40518"),c=i.n(l),s=i("1b4cdd6a36"),u=i.n(s);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=u()(e);if(t){var r=u()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return c()(this,i)}}var h=function(e){a()(i,e);var t=d(i);function i(){return r()(this,i),t.apply(this,arguments)}return i}(i("e6d98148ee").a)},"37d9b74ca9":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),c=i.n(l),s=i("d5c3deb8c7"),u=i("020899bf26"),d=function(){function e(){var t=this;r()(this,e),c()(this,"selectedAnims",void 0),c()(this,"undo",(function(){window.log.info("slideStore undo"),Object(s.w)((function(){var e,i;null===(e=t.selectedAnims)||void 0===e||e.clear(),null===(i=u.a.SDKDataServices.CommandManager())||void 0===i||i.undo()}))})),c()(this,"redo",(function(){window.log.info("slideStore redo"),Object(s.w)((function(){var e,i;null===(e=t.selectedAnims)||void 0===e||e.clear(),null===(i=u.a.SDKDataServices.CommandManager())||void 0===i||i.redo()}))}))}return a()(e,[{key:"setSelectedAnimsDelegate",value:function(e){this.selectedAnims||(this.selectedAnims=e)}}]),e}()},"477433b002":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.keep=1]="keep",e[e.addSlide=2]="addSlide",e[e.removeSlide=3]="removeSlide",e[e.addLayout=4]="addLayout",e[e.removeLayout=5]="removeLayout",e[e.addMaster=6]="addMaster",e[e.removeMaster=7]="removeMaster",e[e.addElement=8]="addElement",e[e.removeElement=9]="removeElement",e[e.textBlur=10]="textBlur"}(n||(n={}))},"4b44f97ab3":function(e,t,i){"use strict";i.d(t,"a",(function(){return M}));var n,r,o=i("1f925d7f50"),a=i.n(o),l=i("9132715560"),c=i.n(l),s=i("6a364eb35c"),u=i.n(s),d=i("85d0a7609b"),h=i.n(d),f=i("2dc700e1e6"),v=i.n(f),p=(i("f1054791f4"),i("a2a09da1e3"),i("63513d8b56"),i("8ee19818c4"),i("5cdbac46e8")),m=i("d5c3deb8c7"),b=i("a2cf71de79"),y=(i("3bf1976a4f"),i("f4e4ed5c17")),g=i("f8fc8e0087"),S=i("d3d31c86eb"),T=i("bd5de260ae"),k=i("d835d04d7a"),O=i("d9812f1c6f"),E=i("fa42be93c4"),C=i("402eb050f3"),A=i("020899bf26"),R=i("7e61746219"),w=i("05d181ac40"),L=i("9da6335152"),x=function(){function e(){var t=this;c()(this,e),h()(this,"needReportCommitCSSuccess",!0),h()(this,"reportOperateLog",(function(e){var t,i=(null===(t=window.clientVars)||void 0===t?void 0:t.padId)||"",n=Math.floor(Date.now()/1e3),r="/doc/log_report?docid=".concat(i,"&oper_time=").concat(n,"&type=").concat(e);try{y.a.get(r)}catch(e){console.log(e.message)}})),A.a.SDKDataServices.EventManager.promise().then((function(e){e.revisionEvents.onCommitSucceed((function(){t.reportCommitCsSuccess()}))}))}return u()(e,[{key:"reportVisit",value:function(){var e={opername:"doc_core",module:"visit",action:"detail_page"};O.a.isMobile?Object(T.a)(k.b.SLIDE_PV_MOBILE,k.a.SUCCESS):Object(T.a)(k.b.SLIDE_PV_PC,k.a.SUCCESS),Object(T.a)(k.b.SLIDE_PV,k.a.SUCCESS),Object(S.c)(e),window.log.debug(e),this.reportDebugEnvId(),C.b.supportEnterprise(C.a.ALL)&&this.reportOperateLog(E.a.DocOpenDoc),O.a.isMobile&&(w.a.IS_MOBILE_LOCAL_EDIT&&Object(S.c)({opername:L.e.DOC_PPT,module:L.d.LOCAL_DOC,action:L.b.DOC_VIEW,ver7:"PPT"}),Object(R.b)()&&Object(S.c)({opername:L.e.DOC_PPT,module:L.d.DRIVE_DOC,action:L.b.DOC_VIEW,ver7:"PPT"}))}},{key:"reportCommitCsSuccess",value:function(){if(this.needReportCommitCSSuccess){var e={opername:"doc_core",module:"edit",action:"edit_text"};Object(S.c)(e),window.log.debug(e),this.needReportCommitCSSuccess=!1}}},{key:"reportDebugEnvId",value:function(){var e=Object(g.getCookie)("env_id");if(e&&"uat"!==e&&0!==e.indexOf("sit")){var t={opername:"online_envid",module:"visit",action:"detail_page",errorMsg:{envId:e,platform:O.a.isMobile?"mobile":"pc"}};Object(T.a)(k.b.SLIDE_PV_ENVID,k.a.SUCCESS),Object(S.c)(t),window.log.debug(t)}}}]),e}(),M=(n=function(){function e(t,i){var n=this;c()(this,e),h()(this,"isOverCoorperateNum",!1),h()(this,"fileAuth",void 0),h()(this,"disposeReaction",void 0),h()(this,"isLockEditorState",!1),h()(this,"callbacks",[]),h()(this,"willChangeCallbacks",[]),h()(this,"isHistoricalVersion",!1),h()(this,"reportManager",void 0),a()(this,"pptEditorStateInner",r,this),this.selectionService=t,this.uiDataService=i,this.reportManager=new x,this.registerPrivilegeChange(),Object(m.r)((function(){return n.pptEditorState}),(function(e){n.uiDataService.presentation.pptEditorState=e})),this.registerCallbacks()}return u()(e,[{key:"pptEditorState",get:function(){return this.pptEditorStateInner},set:function(e){throw new Error('forbid direct modification, you can use the "setPPTEditorState" api')}},{key:"isEditable",value:function(){return this.pptEditorStateInner<=p.b.EDITABLE}},{key:"updateHistoricalVersionStatus",value:function(e,t){this.isHistoricalVersion=e,t&&(this.pptEditorStateInner=e?p.b.COPYABLE:p.b.EDITABLE)}},{key:"getHistoricalVersionStatus",value:function(){return this.isHistoricalVersion}},{key:"setPPTEditorState",value:function(e){var t=e.state,i=e.scope,n=void 0===i?b.a.ALL:i;if(t!==this.pptEditorStateInner&&this.willChangeCallbacks.every((function(e){return e(t)})))switch(this.pptEditorStateInner=t,n){case b.a.ALL:this.setAllSlideModelState(t);break;case b.a.CURRENT:this.setCurrentSlideModelState(t);case b.a.SERVICE:}}},{key:"onPPTEditorStateChange",value:function(e){var t=this;return this.callbacks.push(e),function(){var i=t.callbacks.indexOf(e);-1!==i&&t.callbacks.splice(i,1)}}},{key:"addStateWillChangeCallbacks",value:function(e){var t=this;return this.willChangeCallbacks.push(e),function(){var i=t.willChangeCallbacks.indexOf(e);-1!==i&&t.willChangeCallbacks.splice(i,1)}}},{key:"registerCallbacks",value:function(){var e=this;this.disposeReaction=Object(m.r)((function(){return e.pptEditorState}),(function(t){e.callbacks.forEach((function(e){e(t)}))}))}},{key:"registerPrivilegeChange",value:function(){var e=this;Object(A.b)((function(){var t,i,n=null!==(t=A.a.PrivilegeManager())&&void 0!==t?t:{},r=n.copyable,o=n.editable,a=null===(i=e.selectionService)||void 0===i?void 0:i.currentSlide;if(o?(e.pptEditorStateInner=p.b.EDITABLE,a&&(a.pptEditorState=p.b.EDITABLE)):r?(e.pptEditorStateInner=p.b.COPYABLE,a&&(a.pptEditorState=p.b.COPYABLE)):(e.pptEditorStateInner=p.b.SELECTABLE,a&&(a.pptEditorState=p.b.SELECTABLE)),!a)var l=Object(m.r)((function(){var t;return null===(t=e.selectionService)||void 0===t?void 0:t.currentSlide}),(function(t){t&&(l(),t.pptEditorState=e.pptEditorStateInner)}));setTimeout((function(){e.reportManager.reportVisit()}),2e3),e.fileAuth=e.pptEditorStateInner}))}},{key:"setAllSlideModelState",value:function(e){var t=this.selectionService.slides;null==t||t.forEach((function(t){t.pptEditorState=e}))}},{key:"setCurrentSlideModelState",value:function(e){var t=this.selectionService.currentSlide;t&&(t.pptEditorState=e)}}]),e}(),r=v()(n.prototype,"pptEditorStateInner",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.b.EDITABLE}}),n)},"57050a8a99":function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return A}));i("342844cefa"),i("a84962d637"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36");var n=i("7a5536c9bf"),r=i.n(n),o=i("176815363d"),a=i.n(o),l=i("9132715560"),c=i.n(l),s=i("6a364eb35c"),u=i.n(s),d=i("85d0a7609b"),h=i.n(d),f=i("3ef2352f0b"),v=i.n(f),p=(i("c6244f7705"),i("081c8cafea"),i("b8217400dc"),i("e6f68cdf2e"),i("963f2eaace"),i("8a35b54c1d"),i("b1e2246d82"),i("6e20b6a7d8"),i("0acdc5834b"),i("2d65cb09dc")),m=i("d9812f1c6f"),b=i("bd5de260ae"),y=i("d835d04d7a"),g=i("d3d31c86eb"),S=i("9da6335152"),T=i("37091e4240"),k=i("565f3982e0"),O=i("5ce71228c0");function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach((function(t){h()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var A=function(){function t(e){c()(this,t),h()(this,"slideRenderStateManager",void 0),h()(this,"presentationConvertStartTime",void 0),this.slideRenderStateManager=e,this.observeFirstSlideComplete(),this.observeVisibleSlideComplete(),this.observePresentationConvertStart()}var i,n;return u()(t,[{key:"observeFirstSlideComplete",value:(n=a()(v.a.mark((function e(){var t,i,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.slideRenderStateManager.getFirstPageDisplayPromise();case 2:t=e.sent,i=t.time,n=t.entry,this.reportTti(i,n);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"observeVisibleSlideComplete",value:(i=a()(v.a.mark((function e(){var t,i,n,r,o,a,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.slideRenderStateManager.getFirstPageDisplayPromise();case 2:return t=e.sent,i=t.time,e.next=6,this.slideRenderStateManager.getVisiblePageDisplayPromise();case 6:return n=e.sent,r=n.time,o=n.entry,e.next=11,this.slideRenderStateManager.getAllThumbnailSiteCompletePromise();case 11:a=e.sent,l=a.time,this.reportListLoad(i,r,l,o);case 14:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"observePresentationConvertStart",value:function(){var e=this;T.b.once(T.a.PRESENTATION_CONVERT_START,(function(){e.presentationConvertStartTime=Math.round(performance.now())}))}},{key:"reportTti",value:function(t,i){var n,r,o,a,l,c="FirstSlide",s="SpecialFirstSlide",u=e.performance.timing.fetchStart;if([p.a.EDIT_PC,p.a.THUMBNAIL_MOBILE,p.a.EDIT_MOBILE].includes(i)){var d=c;(document.hidden||e.clientVars&&window.clientVars.appInfoConfig&&m.a.isWindows)&&(d=s);var h=C(C({},this.getSyncJsInfo()),{},{TTI:t,FirstSlide:e.previewTime?e.previewTime-u:t,presentationConvertStart:this.presentationConvertStartTime,canEdit:null===(n=e.clientVars)||void 0===n||null===(r=n.privilegeAttribute)||void 0===r?void 0:r.can_edit,isSSRHit:e.previewTime?1:0,firstSlideElementInfo:this.getFirstSlideElement(),sameVersionHit:this.isSameVersionHit(),pageSize:this.slideRenderStateManager.getPageSize(),ttfb:e.performance.timing.responseStart-u,htmlLoadTime:e.performance.timing.responseEnd-u,dataGetBegin:(null===(o=e.clientVars)||void 0===o||null===(a=o.__tdw)||void 0===a?void 0:a.beginTime)-u,dataGetCost:this.getDataGetTime(),dataReadyInFirstTask:this.dataReadyInFirstTask(),mainJsCost:this.getMainJsCost(),isHidden:e.document.hidden,isToB:this.isToB(),isBig:this.isBig(),mainJsInfo:this.mainJsInfo(),entry:i,timingDuration:{fetchStartToNavigationStart:e.performance.timing.fetchStart-u,unloadEventStartToNavigationStart:e.performance.timing.unloadEventStart>0?e.performance.timing.unloadEventStart-u:0,redirectStartToNavigationStart:e.performance.timing.redirectStart>0?e.performance.timing.redirectStart-u:0,unloadEventEndToNavigationStart:e.performance.timing.unloadEventEnd>0?e.performance.timing.unloadEventEnd-u:0,redirectEndToNavigationStart:e.performance.timing.redirectEnd>0?e.performance.timing.redirectEnd-u:0}});Object(g.c)({opername:S.e.DOC_PERFORMANCE,module:S.d.PERFORMANCE_START,action:d,ver5:0,ver6:JSON.stringify(h)}),Object(b.b)(y.b.TTI,t),Object(b.a)(y.b.TTI_SUCCEED_IN_5S,t<=5e3?y.a.SUCCESS:y.a.ERROR,"",[i]),Object(b.a)(y.b.WHITE_SCREEN,y.a.ERROR),null===(l=window.log)||void 0===l||l.info("[tti]",h)}}},{key:"reportListLoad",value:function(t,i,n,o){var a,l,c,s=this.slideRenderStateManager.getListCellFirstLoadTimeArr(),u={TTI:t,listCellLoadTime:s,listFirstCellAppearTime:s[0],listInScreenCellAppearTime:i,listSiteCompleteTime:n,firstScreenPageSize:this.slideRenderStateManager.visibleSlideKeyList.length,canEdit:null===(a=e.clientVars)||void 0===a||null===(l=a.privilegeAttribute)||void 0===l?void 0:l.can_edit,pageSize:this.slideRenderStateManager.getPageSize(),isHidden:e.document.hidden,mainJsInfo:this.mainJsInfo(),entry:o};if(s.length>=3&&s.slice(0,3).every((function(e){return!!e})))for(var d=1;d<=3;d++)u["pageEnd-".concat(d)]=Math.max.apply(Math,r()(s.slice(0,d)));Object(g.c)({opername:S.e.DOC_PPT,module:S.d.PERFORMANCE,action:S.b.LIST_LOAD,ver6:JSON.stringify(u)}),Object(b.a)(y.b.LIST_SUCCEED_IN_5S,i<=5e3?y.a.SUCCESS:y.a.ERROR,"",[o]),Object(b.a)(y.b.LIST_SUCCEED_IN_10S,i<=1e4?y.a.SUCCESS:y.a.ERROR,"",[o]),null===(c=window.log)||void 0===c||c.info("[tti-list]",u)}},{key:"isSameVersionHit",value:function(){var t,i=O.b.getItem(O.a.VERSION_HIT),n=null===(t=e.__DWS_INFO__)||void 0===t?void 0:t.releaseVersion;return!(!n||i!==n)||(O.b.setItem(O.a.VERSION_HIT,n),!1)}},{key:"getSyncJsInfo",value:function(){var t=e.performance.getEntriesByType("resource").filter((function(e){return"resource"===(null==e?void 0:e.entryType)&&/-common~|-base~|-slide-edit/.test(null==e?void 0:e.name)})),i=Math.round(Math.min.apply(Math,r()(t.map((function(e){return e.connectStart}))))),n=Math.round(Math.max.apply(Math,r()(t.map((function(e){return e.connectStart}))))),o=Math.round(Math.min.apply(Math,r()(t.map((function(e){return e.responseStart}))))),a=Math.round(Math.max.apply(Math,r()(t.map((function(e){return e.responseStart}))))),l=Math.round(Math.min.apply(Math,r()(t.map((function(e){return e.responseEnd}))))),c=Math.round(Math.max.apply(Math,r()(t.map((function(e){return e.responseEnd}))))),s=Math.round(t.map((function(e){return e.encodedBodySize})).reduce((function(e,t){return e+t}),0)/1024),u=t.filter((function(e){return e.responseEnd===e.responseStart})).length;return{syncJsCount:t.length,syncJsCacheHitCount:u,syncJsAllSize:s,syncJsFirstReqTime:i,syncJsLastReqTime:n,syncJsFirstResTime:o,syncJsLastResTime:a,syncJsFirstOverTime:l,syncJsLastOverTime:c}}},{key:"getDataGetTime",value:function(){var t,i,n,r,o=null===(t=e.clientVars)||void 0===t||null===(i=t.__tdw)||void 0===i?void 0:i.endTime,a=null===(n=e.clientVars)||void 0===n||null===(r=n.__tdw)||void 0===r?void 0:r.beginTime;if(o&&a)return o-a}},{key:"dataReadyInFirstTask",value:function(){var t,i,n,r=null===(t=e.clientVars)||void 0===t||null===(i=t.__tdw)||void 0===i?void 0:i.endTime,o=null===(n=e.jsRunMarkPoints)||void 0===n?void 0:n[k.a.MAIN_END];if(r&&o)return r<o}},{key:"getMainJsCost",value:function(){var t,i,n=null===(t=e.jsRunMarkPoints)||void 0===t?void 0:t[k.a.MAIN_START],r=null===(i=e.jsRunMarkPoints)||void 0===i?void 0:i[k.a.MAIN_END];if(n&&r)return r-n}},{key:"getFirstSlideElement",value:function(){var e,t,i={totel:0,table:0,tableCell:0,shape:0,picture:0,connector:0};((null===(e=this.slideRenderStateManager.selectionService)||void 0===e?void 0:e.slides)||[]).length>0&&(i=null===(t=this.slideRenderStateManager.selectionService)||void 0===t?void 0:t.slides[0].elementNumInfo);return i}},{key:"isToB",value:function(){var t;return null!==(t=e.clientVars)&&void 0!==t&&t.appInfoConfig?1:0}},{key:"isBig",value:function(){var t,i,n,r=this.slideRenderStateManager.getPageSize()||0,o=((null===(t=e.clientVars)||void 0===t||null===(i=t.collab_client_vars)||void 0===i||null===(n=i.initialAttributedText)||void 0===n?void 0:n.text)||"").length/1024*2;return r>1&&o/r>100?1:0}},{key:"mainJsInfo",value:function(){var t,i,n,r;return{start:(null===(t=e.jsRunMarkPoints)||void 0===t?void 0:t[k.a.MAIN_START])-e.performance.timing.responseEnd,end:(null===(i=e.jsRunMarkPoints)||void 0===i?void 0:i[k.a.MAIN_END])-e.performance.timing.responseEnd,during:(null===(n=e.jsRunMarkPoints)||void 0===n?void 0:n[k.a.MAIN_END])-(null===(r=e.jsRunMarkPoints)||void 0===r?void 0:r[k.a.MAIN_START])}}}]),t}()}).call(this,i("5ef37df1a0"))},"57db36e15c":function(e,t,i){"use strict";var n,r,o,a,l;i.d(t,"d",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return l})),function(e){e.HORIZONTAL="horizontal",e.VERTICAL="vertical"}(n||(n={})),function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom",e.LEFT_TOP="left-top",e.LEFT_BOTTOM="left-bottom",e.RIGHT_TOP="right-top",e.RIGHT_BOTTOM="right-bottom",e.NONE="none"}(r||(r={})),function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom"}(o||(o={})),function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom"}(a||(a={})),function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom",e.LEFT_TOP="left-top",e.LEFT_BOTTOM="left-bottom",e.RIGHT_TOP="right-top",e.RIGHT_BOTTOM="right-bottom",e.ALL="all"}(l||(l={}))},"5e1c74b5fd":function(e,t,i){"use strict";i.d(t,"a",(function(){return rt}));var n,r=i("1f925d7f50"),o=i.n(r),a=i("9132715560"),l=i.n(a),c=i("6a364eb35c"),s=i.n(c),u=i("85d0a7609b"),d=i.n(u),h=i("2dc700e1e6"),f=i.n(h),v=(i("f1054791f4"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36"),i("6e20b6a7d8"),i("73b854064b"),i("bd29e2df90")),p=i.n(v),m=i("ab5eb40518"),b=i.n(m),y=i("1b4cdd6a36"),g=i.n(y),S=(i("759492dad9"),i("e0e8dd9366")),T=i("e5a826a0ff"),k=i("2f766f71b0"),O=i.n(k),E=i("57db36e15c"),C=function(){function e(t){l()(this,e),d()(this,"refs",void 0),d()(this,"refGrids",void 0),d()(this,"referId",void 0),d()(this,"referChanged",!0),this.context=t}return s()(e,[{key:"gridifyElements",value:function(e){var t=this;return O()(e.map((function(e){return t.gridify(e.outerFrameOnSlide,e,E.c.ALL)})))}},{key:"reset",value:function(){this.refs=[],this.refGrids=[],this.referId="",this.referChanged=!0}},{key:"isGroup",value:function(e){return e.type===S.d.GROUP}},{key:"getSelectElement",value:function(){return this.context.selectionService.getSelectedModel()}},{key:"isElementSelected",value:function(e){var t;return!(null===(t=this.context.selectionService.selectedElements.selectedArray)||void 0===t||!t.some((function(t){return t.key===e.key})))}},{key:"isChildrenSelected",value:function(e){var t,i,n;return(null===(t=this.context.selectionService.selectedElements.selectedArrayForType(T.a.GROUP))||void 0===t||null===(i=t[0])||void 0===i||null===(n=i.parent)||void 0===n?void 0:n.key)===e.key}},{key:"setRefs",value:function(e){var t=this.simplifyRefs(e);this.refs=t,this.refGrids=this.gridifyElements(t),this.setReferId()}},{key:"setReferId",value:function(){var e=this.refs.map((function(e){return e.ele.key+e.source})).join("-");this.referChanged=this.referId!==e,this.referId=e}},{key:"simplifyRefs",value:function(e){var t=this;return this.isNumerousElements(e)?e.filter((function(e){return!t.isTinyElement(e.ele)})):e}},{key:"isNumerousElements",value:function(e){return e.length>=40}},{key:"isTinyElement",value:function(e){var t=e.props.style,i=t.height,n=t.width,r=this.context.uiDataService.presentation.props,o=r.slideWidth;return i<r.slideHeight/20&&n<o/20}}]),e}(),A=i("14502724a6"),R=i.n(A),w=i("7a5536c9bf"),L=i.n(w),x=i("7b0ebf3e1a");!function(e){e.MOVE="move",e.RESIZE="resize"}(n||(n={}));var M=i("ec99168144");function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function P(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function B(e){var t=e.rotate,i=t?Object(x.j)(e,t):e,n=i.top,r=void 0===n?0:n,o=i.left,a=void 0===o?0:o,l=i.width,c=void 0===l?0:l,s=i.height,u=void 0===s?0:s;return P(P({rotate:t},e),{},{top:r,left:a,width:c,height:u})}function D(e){var t;return B((null==e||null===(t=e.parent)||void 0===t?void 0:t.type)===S.d.GROUP?e.getFrame().frameOnSlide():e.props.style||{})}function F(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;i||(i=W(e));for(var n=[],r=0;r<e.length;r++)n.push(Object(x.d)(e[r],t,i.x,i.y));return n}function _(e,t,i,n){for(var r=[],o=0;o<e.length;o++){var a=e[o];n&&(a=Object(x.b)(a,t.x)),i&&(a=Object(x.c)(a,t.y)),r.push(a)}return r}function N(e,t,i,r,o){if(o&&((null==o?void 0:o.length)>1&&e===n.MOVE||t.type===S.d.GROUP))return function(e,t,i,n){var r=B(P({rotate:e.props.style.rotate},t)),o=B(P({rotate:e.props.style.rotate},i));return P(P(P({},r),o),{},{left:o.left-r.left+n.left,top:o.top-r.top+n.top,width:o.width-r.width+n.width,height:o.height-r.height+n.height})}(t,i,r,o);return B(j(t,i,r))}function j(e,t,i){var n=i.left-t.left,r=i.top-t.top,o=i.width-t.width,a=i.height-t.height;return e.getFrame().frameOnSlide({left:e.props.style.left+n,top:e.props.style.top+r,width:e.props.style.width+o,height:e.props.style.height+a,rotate:e.props.style.rotate,flipH:i.flipH,flipV:i.flipV})}function G(e){var t=Math.min.apply(Math,L()(e.map((function(e){return e.x})))),i=Math.max.apply(Math,L()(e.map((function(e){return e.x})))),n=Math.min.apply(Math,L()(e.map((function(e){return e.y}))));return{left:t,top:n,width:i-t,height:Math.max.apply(Math,L()(e.map((function(e){return e.y}))))-n}}function H(e){var t=e.top,i=e.left,n=e.width,r=e.height;e.flipH,e.flipV;return{topGrid:{orient:E.d.HORIZONTAL,position:t,type:M.a.EDGE,fromEdge:E.a.TOP},bottomGrid:{orient:E.d.HORIZONTAL,position:t+r,type:M.a.EDGE,fromEdge:E.a.BOTTOM},leftGrid:{orient:E.d.VERTICAL,position:i,type:M.a.EDGE,fromEdge:E.a.LEFT},rightGrid:{orient:E.d.VERTICAL,position:i+n,type:M.a.EDGE,fromEdge:E.a.RIGHT},verticalBaseLineGrid:{orient:E.d.VERTICAL,position:i+n/2,type:M.a.BASE_LINE},horizontalBaseLineGrid:{orient:E.d.HORIZONTAL,position:t+r/2,type:M.a.BASE_LINE}}}function z(e,t){var i=V(e);return F(_(i,W(i),!!e.flipV,!!e.flipH),t)}function V(e){return Object(x.m)(e,0)}function W(e){var t=R()(e,4),i=t[0],n=t[1],r=t[2],o=t[3],a=i.x,l=i.y,c=n.x,s=n.y,u=r.x,d=r.y;return{x:(a+c+u+o.x)/4,y:(l+s+d+o.y)/4}}function U(e,t,i,n){!function(e,t,i,n){if(null!=e&&e.some((function(e){return e.orient===E.d.VERTICAL})))switch(i){case E.c.LEFT_TOP:t.height=t.width*n,t.top=t.left*n;break;case E.c.RIGHT_TOP:t.height=t.width*n,t.top=-t.height;break;case E.c.LEFT_BOTTOM:case E.c.RIGHT_BOTTOM:t.height=t.width*n}}(e,t,i,n),function(e,t,i,n){if(null!=e&&e.some((function(e){return e.orient===E.d.HORIZONTAL})))switch(i){case E.c.LEFT_TOP:t.width=t.height/n,t.left=t.top/n;break;case E.c.RIGHT_TOP:t.width=t.height/n;break;case E.c.LEFT_BOTTOM:t.width=t.height/n,t.left=-t.width;break;case E.c.RIGHT_BOTTOM:t.width=t.height/n}}(e,t,i,n)}var q=i("18695a8c86");function K(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?K(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var J=function(e){p()(i,e);var t=Z(i);function i(){return l()(this,i),t.apply(this,arguments)}return s()(i,[{key:"setRefWithSlideOtherElements",value:function(){var e,t=this,i=[],n=null===(e=this.context.selectionService.currentSlide)||void 0===e?void 0:e.children;null==n||n.forEach((function(e){return t.getReferenceRecursive(e,i)})),i.push(this.getSlideRef()),this.setRefs(i)}},{key:"gridify",value:function(e,t){var i=this,n=H(e);return[n.topGrid,n.horizontalBaseLineGrid,n.bottomGrid,n.leftGrid,n.verticalBaseLineGrid,n.rightGrid].map((function(e){return{orient:e.orient,position:e.position,type:e.type,maxAdsorbGap:i.context.option.maxAdsorbGap,source:t.source,refElements:[t]}}))}},{key:"getSlideRef",value:function(e){var t=this.context.uiDataService.presentation.props,i=t.slideWidth,n=t.slideHeight;return{ele:{props:{style:Y({width:i,height:n},e)}},source:q.a.SLIDE,outerFrameOnSlide:Y({top:0,left:0,width:i,height:n},e)}}},{key:"getReferenceRecursive",value:function(e,t){var i,n=this;this.isElementSelected(e)||(this.isGroup(e)?null===(i=e.children)||void 0===i||i.forEach((function(e){n.getReferenceRecursive(e,t)})):t.push({ele:e,source:q.a.ELEMENT,outerFrameOnSlide:D(e)}))}}]),i}(C);i("eb9e932508");function X(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function $(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?X(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):X(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var ee,te=function(e){p()(i,e);var t=Q(i);function i(){return l()(this,i),t.apply(this,arguments)}return s()(i,[{key:"setRefWithShadowOverlappedElements",value:function(e){var t=this,i=this.context.staticRefer.refs,n={outerFrameOnSlide:e},r=i.filter((function(e){return e.source!==q.a.SLIDE&&t.isShadowOverlapped(n,e)})).filter((function(e){var i,n,r=e.outerFrameOnSlide,o=t.context.detectFrame;return i=o,!((n=r).left<=i.left&&n.top<=i.top&&n.width+n.left>=i.width+i.left&&n.top+n.height>=i.top+i.height)}));this.setRefs(r)}},{key:"gridifyElements",value:function(e){return[]}},{key:"gridify",value:function(e,t){var i=this,n=H(e);return[n.topGrid,n.bottomGrid,n.leftGrid,n.rightGrid].map((function(e){return{orient:e.orient,position:e.position,type:e.type,maxAdsorbGap:i.context.option.maxAdsorbGap,source:t.source,refElements:[t]}}))}},{key:"isShadowOverlapped",value:function(e,t){var i=e.outerFrameOnSlide,n=t.outerFrameOnSlide,r=i.left<n.left+n.width&&i.left+i.width>n.left;return i.top<n.top+n.height&&i.top+i.height>n.top||r}},{key:"filterCoveredElements",value:function(e){for(var t=e.map((function(e){return $($({},e.outerFrameOnSlide),{},{ele:e})})),i=this.sortByAreaDescending(t),n=[],r=0;r<i.length;r++){for(var o=!1,a=0;a<r;a++)if(this.isCovered(i[r],i[a])){o=!0;break}o||n.push(i[r].ele)}return n}},{key:"isCovered",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9,n=Math.max(e.left,t.left),r=Math.min(e.left+e.width,t.left+t.width),o=Math.max(e.top,t.top),a=Math.min(e.top+e.height,t.top+t.height);return Math.max(0,r-n)*Math.max(0,a-o)/(e.width*e.height)>=i}},{key:"sortByAreaDescending",value:function(e){return e.sort((function(e,t){return t.width*t.height-e.width*e.height}))}}]),i}(C),ie=i("d5c3deb8c7"),ne=i("5fdb99520e"),re=i("1b0526663d"),oe=i("79fc58c7b0");!function(e){e.DISABLE="0",e.ENABLE="1"}(ee||(ee={}));var ae,le,ce,se,ue,de,he,fe,ve,pe,me;function be(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ye(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?be(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):be(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ge,Se=(ae=Reflect.metadata("design:type",Array),le=Reflect.metadata("design:type",Array),ce=Reflect.metadata("design:type",Array),se=Reflect.metadata("design:type",Array),ue=Reflect.metadata("design:type",Array),de=function(){function e(t,i,n,r,a){l()(this,e),o()(this,"elementGrids",he,this),o()(this,"detectGrids",fe,this),o()(this,"adsorbPoints",ve,this),o()(this,"beforeAdsorbPoints",pe,this),o()(this,"activeSnapLines",me,this),d()(this,"offsetFrame",void 0),d()(this,"scale",void 0),d()(this,"sizeMap",void 0),d()(this,"staticRefer",void 0),d()(this,"dynamicRefer",void 0),d()(this,"option",void 0),d()(this,"element",void 0),d()(this,"rotateOnSlide",void 0),d()(this,"relativeProps",void 0),d()(this,"nextSize",void 0),d()(this,"nextSizeOnSlide",void 0),d()(this,"originalSize",void 0),d()(this,"detectFrame",void 0),d()(this,"originOperationAnchor",void 0),d()(this,"operationAnchorOnSlide",void 0),d()(this,"operationType",void 0),d()(this,"startMousePoint",void 0),d()(this,"mouseEvent",void 0),d()(this,"movingDirection",void 0),d()(this,"movingOrient",void 0),d()(this,"movingOrientDirection",void 0),d()(this,"noChangeAspect",void 0),d()(this,"elementScale",void 0),this.selectionService=t,this.uiDataService=i,this.editAreaCanvasSizeManager=n,this.menuManager=r,this.staticRefer=new J(this),this.dynamicRefer=new te(this),this.option=ye(ye({},this.defaultOptions),a)}return s()(e,[{key:"init",value:function(e,t){this.setOperationElement(e),this.staticRefer.setRefWithSlideOtherElements(),t&&(this.startMousePoint=Object(ne.b)(t))}},{key:"update",value:function(e){this.dynamicRefer.setRefWithShadowOverlappedElements(e)}},{key:"setDetail",value:function(e,t){this.offsetFrame=e.offsetFrame;var i=this.getContextDetailFromPayload(e,t);this.mouseEvent=i.mouseEvent,this.nextSize=i.nextSize,this.originalSize=i.originalSize,this.detectFrame=i.detectFrame,this.nextSizeOnSlide=i.nextSizeOnSlide,this.originOperationAnchor=i.originOperationAnchor,this.operationAnchorOnSlide=i.operationAnchorOnSlide,this.operationType=i.operationType,this.sizeMap=i.sizeMap,this.scale=i.scale,this.elementScale=i.elementScale,this.rotateOnSlide=i.rotateOnSlide,this.noChangeAspect=i.noChangeAspect,i.movingDirection===E.b.NONE&&this.movingDirection||(this.movingDirection=i.movingDirection,this.movingOrient=Object(ne.c)(this.mouseEvent),this.movingOrientDirection=Object(ne.d)(this.mouseEvent))}},{key:"reset",value:function(){this.activeSnapLines=[],this.dynamicRefer.reset(),this.staticRefer.reset(),this.resetDetail(),this.elementGrids=[],this.detectGrids=[],this.beforeAdsorbPoints=[],this.adsorbPoints=[]}},{key:"setOperationElement",value:function(e){this.element=e,this.relativeProps=Object(re.c)(e)}},{key:"setActiveSnapLines",value:function(e,t){this.activeSnapLines=e.map((function(e){return ye(ye({},e),{},{frameOnSlide:t})}))}},{key:"elementRotate",get:function(){var e,t;if(void 0!==this.nextSize.rotate)return this.nextSize.rotate;var i=((null===(e=this.element)||void 0===e||null===(t=e.props)||void 0===t?void 0:t.style)||{}).rotate;return void 0===i?0:i}},{key:"groupRotate",get:function(){var e;return this.isGroupChildren&&(null===(e=this.parentStyle)||void 0===e?void 0:e.rotate)||0}},{key:"isGroupChildren",get:function(){var e,t;return(null===(e=this.element)||void 0===e||null===(t=e.parent)||void 0===t?void 0:t.type)===S.d.GROUP}},{key:"parentStyle",get:function(){var e,t;return null===(e=this.element)||void 0===e||null===(t=e.parent)||void 0===t?void 0:t.props.style}},{key:"getContextDetailFromPayload",value:function(e,t){var i,n,r,o=e.mode,a=e.originalSize,l=e.nextSize,c=e.multiRect,s=e.elementModel,u=e.e,d=Object(ne.i)(u),h=(null==s||null===(i=s.parent)||void 0===i?void 0:i.type)===S.d.GROUP?j(s,a,l):ye({rotate:s.props.style.rotate},l),f=N(t,s,a,l,c),v=Object(ne.e)(o),p=E.c.ALL,m=null!==(n=s.getFrame().frameOnSlide().rotate)&&void 0!==n?n:0;return o!==oe.b.MOVE&&(p=this.getOperationAnchorOnSlide(v,l,m)),{mouseEvent:u,originOperationAnchor:v,operationAnchorOnSlide:p,nextSize:l,originalSize:a,detectFrame:f,nextSizeOnSlide:h,movingDirection:d,operationType:t,sizeMap:e.sizeMap,scale:this.editAreaCanvasSizeManager.getCanvasScale(),rotateOnSlide:m,noChangeAspect:!!(null!=u&&u.shiftKey||null!==(r=s.props.locks)&&void 0!==r&&r.noChangeAspect),elementScale:a.height/a.width}}},{key:"defaultOptions",get:function(){return{maxAdsorbGap:12}}},{key:"resetDetail",value:function(){this.offsetFrame=void 0,this.sizeMap=void 0,this.element=void 0,this.rotateOnSlide=void 0,this.nextSize=void 0,this.detectFrame=void 0,this.originOperationAnchor=void 0,this.operationAnchorOnSlide=void 0,this.operationType=void 0,this.mouseEvent=void 0,this.startMousePoint=void 0,this.movingDirection=void 0,this.movingOrient=void 0,this.movingOrientDirection=void 0,this.noChangeAspect=void 0,this.elementScale=void 0}},{key:"getSelfOperateFlipInfo",value:function(e){var t=this.element.props.style,i=t.flipV,n=!!t.flipH!=!!e.flipH,r=!!i!=!!e.flipV,o=this.relativeProps;return o.relativeFlipH&&(n=!n),o.relativeFlipV&&(r=!r),{flipV:r,flipH:n}}},{key:"getOperationAnchorOnSlide",value:function(e,t,i){var n=this.getSelfOperateFlipInfo(t),r=n.flipV,o=n.flipH,a=Object(ne.a)(e,o,r);return Object(ne.g)(a,i)}}]),e}(),he=f()(de.prototype,"elementGrids",[ie.q,ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe=f()(de.prototype,"detectGrids",[ie.q,le],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=f()(de.prototype,"adsorbPoints",[ie.q,ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=f()(de.prototype,"beforeAdsorbPoints",[ie.q,se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=f()(de.prototype,"activeSnapLines",[ie.q,ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de),Te=(i("3bf1976a4f"),i("22569efd03"),i("547611bd96")),ke=i.n(Te),Oe=(i("b8217400dc"),i("e6f68cdf2e"),i("a2a09da1e3"),i("fb5ce2c53e")),Ee=i("54bdd803dc"),Ce=i.n(Ee);function Ae(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Re(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ae(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(e){e[e.STATIC=0]="STATIC",e[e.DYNAMIC=1]="DYNAMIC"}(ge||(ge={}));var we=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l()(this,e),d()(this,"type",void 0),d()(this,"refGridsCache",void 0),this.context=t,this.disableCache=i}return s()(e,[{key:"detect",value:function(){var e=this.getRefGrids(),t=this.getDetectGrids(),i=this.getClosestSnapLineInDirections(t,e);return this.processActiveSnapLines(i)}},{key:"clearCache",value:function(){this.refGridsCache=void 0}},{key:"getRefGrids",value:function(){var e=this.type===ge.STATIC?this.staticRefer.referChanged:this.dynamicRefer.referChanged;if(!this.refGridsCache||e||this.disableCache){var t=this.collectRefGrids();this.collectRefGridsEffect(t),this.refGridsCache=t}return this.refGridsCache}},{key:"collectRefGridsEffect",value:function(e){}},{key:"processActiveSnapLines",value:function(e){return e}},{key:"isTriggerAdsroption",value:function(e,t,i){return i<=t.maxAdsorbGap}},{key:"getClosestSnapLineInDirections",value:function(e,t){var i=this,n=[];return null==t||t.forEach((function(t){e.forEach((function(e){var r=i.getGridGap(e.position,t.position);if(e.orient===t.orient&&i.isTriggerAdsroption(e,t,r)){var o=n.findIndex((function(e){return e.orient===t.orient})),a=Re(Re({},t),{},{activeAdsorbGap:i.getGridGap(t.position,e.position,!1),frame:i.context.detectFrame});if(-1===o)return void n.push(a);var l=n[o];if(!Ce()(a,l)&&Object(Oe.a)(l.activeAdsorbGap,a.activeAdsorbGap))return void n.push(a);Math.abs(a.activeAdsorbGap)<Math.abs(l.activeAdsorbGap)&&(n=n.filter((function(e){return e.orient!==l.orient}))).push(a)}}))})),n}},{key:"getDetectGrids",value:function(){var e=this,t=this.context.operationType===n.MOVE?this.getMoveModeDetectElementGridOptions():this.getResizeModeDetectElementGridOptions(),i=this.getSelectElement();return t.map((function(t){return{orient:t.orient,position:t.position,type:t.type,fromEdge:t.fromEdge,maxAdsorbGap:e.context.option.maxAdsorbGap,source:q.a.ELEMENT,refElements:[{ele:i,source:q.a.ELEMENT,outerFrameOnSlide:D(i)}]}}))}},{key:"getMoveModeDetectElementGridOptions",value:function(){var e=H(this.context.detectFrame);return[e.topGrid,e.horizontalBaseLineGrid,e.bottomGrid,e.leftGrid,e.verticalBaseLineGrid,e.rightGrid]}},{key:"getResizeModeDetectElementGridOptions",value:function(){var e=this.context.originOperationAnchor,t=this.context.nextSizeOnSlide.rotate,i=void 0===t?0:t,n=e===E.c.LEFT||e===E.c.TOP||e===E.c.BOTTOM||e===E.c.RIGHT;return i%90!=0&&n?[]:n?this.getGridOptionsByEdge():this.context.noChangeAspect?this.getGridOptionsByNoChangeAspect():this.getGridOptionsByAnchor()}},{key:"getSelectElement",value:function(){return this.context.selectionService.getSelectedModel()}},{key:"getGridGap",value:function(e,t){var i=e-t;return!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?Math.abs(i):i}},{key:"getRefFrame",value:function(e){return Re(Re({},e),{},{right:e.left+e.width,bottom:e.top+e.height})}},{key:"staticRefer",get:function(){return this.context.staticRefer}},{key:"dynamicRefer",get:function(){return this.context.dynamicRefer}},{key:"staticReferGrids",get:function(){return this.staticRefer.refGrids}},{key:"getGridOptionsByAnchor",value:function(){var e=this.context.operationAnchorOnSlide,t=this.getResizeNodePositionOnSlide(),i=e.includes("left"),n=e.includes("top");return[{orient:E.d.VERTICAL,position:t.x,type:M.a.EDGE,fromEdge:i?E.a.LEFT:E.a.RIGHT},{orient:E.d.HORIZONTAL,position:t.y,type:M.a.EDGE,fromEdge:n?E.a.TOP:E.a.BOTTOM}]}},{key:"getResizeNodePositionOnSlide",value:function(){var e=this.context.startMousePoint,t=Object(ne.b)(this.context.mouseEvent),i=(t.x-e.x)/this.context.scale/1,n=(t.y-e.y)/this.context.scale/1,r=V(this.context.element.getFrame().frameOnSlide()),o=this.context.relativeProps,a=o.relativeFlipH,l=o.relativeFlipV,c=F(_(r,W(r),!!l,!!a),this.context.rotateOnSlide)[[E.c.LEFT_TOP,E.c.RIGHT_TOP,E.c.RIGHT_BOTTOM,E.c.LEFT_BOTTOM].indexOf(this.context.originOperationAnchor)];return{x:c.x+i,y:c.y+n}}},{key:"getGridOptionsByEdge",value:function(){var e=this.context,t=e.detectFrame,i=e.operationAnchorOnSlide,n=H(t),r=n.topGrid,o=n.bottomGrid,a=n.leftGrid,l=n.rightGrid,c=[];switch(i){case E.c.LEFT:c=[a];break;case E.c.RIGHT:c=[l];break;case E.c.TOP:c=[r];break;case E.c.BOTTOM:c=[o]}return c}},{key:"getGridOptionsByNoChangeAspect",value:function(){var e=this.context,t=e.detectFrame,i=e.operationAnchorOnSlide,n=H(t),r=n.topGrid,o=n.bottomGrid,a=n.leftGrid,l=n.rightGrid,c=[];switch(i){case E.c.LEFT_TOP:c=[a,r];break;case E.c.RIGHT_TOP:c=[l,r];break;case E.c.LEFT_BOTTOM:c=[a,o];break;case E.c.RIGHT_BOTTOM:c=[l,o]}return c}}]),e}();function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var xe=function(e){p()(i,e);var t=Le(i);function i(){var e;l()(this,i);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),d()(ke()(e),"type",ge.STATIC),e}return s()(i,[{key:"collectRefGrids",value:function(){return this.staticRefer.refGrids}},{key:"processActiveSnapLines",value:function(e){return this.filterBaseLineIfEdgeLineActive(e)}},{key:"filterBaseLineIfEdgeLineActive",value:function(e){return e.filter((function(t){var i=t.type===M.a.BASE_LINE;return t.source===q.a.SLIDE||!i||!e.some((function(e){return e.type===M.a.EDGE&&e.orient===t.orient}))}))}}]),i}(we),Me=i("8eec1e4a03"),Ie=i.n(Me),Pe=(i("b4638a0243"),i("ff46ef6411")),Be=i.n(Pe);function De(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Fe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?De(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):De(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var Ne=function(e){p()(i,e);var t=_e(i);function i(){var e,n,r;l()(this,i);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return r=t.call.apply(t,[this].concat(a)),d()(ke()(r),"type",ge.DYNAMIC),d()(ke()(r),"lastOperationType",void 0),d()(ke()(r),"referCoveredResultCache",{}),d()(ke()(r),"marginRefGroups",(e={},d()(e,E.d.HORIZONTAL,{}),d()(e,E.d.VERTICAL,{}),e)),d()(ke()(r),"symmetryRefGroups",(n={},d()(n,E.d.HORIZONTAL,{}),d()(n,E.d.VERTICAL,{}),n)),r}return s()(i,[{key:"clearCache",value:function(){var e,t;Ie()(g()(i.prototype),"clearCache",this).call(this),this.resetCoveredResultCache(),this.marginRefGroups=(e={},d()(e,E.d.HORIZONTAL,{}),d()(e,E.d.VERTICAL,{}),e),this.symmetryRefGroups=(t={},d()(t,E.d.HORIZONTAL,{}),d()(t,E.d.VERTICAL,{}),t)}},{key:"getRefGrids",value:function(){var e=Ie()(g()(i.prototype),"getRefGrids",this).call(this),t=[];return this.addBetweenReferMarginSnapLines(t),[].concat(L()(e),t)}},{key:"collectRefGrids",value:function(){this.resetMarginGroup();var e=[];return this.addExtendMarginSnapLines(e),this.addSlideSymmetryMarginSnapLines(e),e}},{key:"collectRefGridsEffect",value:function(e){this.collectRefGroups(e)}},{key:"processActiveSnapLines",value:function(e){var t=e.filter((function(t){return t.source!==q.a.SLIDE||!e.some((function(e){return e.source!==q.a.SLIDE&&e.orient===t.orient}))}));return this.relateEqualMarginGroups(t)}},{key:"getMoveModeDetectElementGridOptions",value:function(){return Ie()(g()(i.prototype),"getMoveModeDetectElementGridOptions",this).call(this).filter((function(e){return e.type!==M.a.BASE_LINE}))}},{key:"isTriggerAdsroption",value:function(e,t,i){return i<=t.maxAdsorbGap&&e.fromEdge===t.adsorbEdge}},{key:"getGridOptionsByAnchor",value:function(){var e=Ie()(g()(i.prototype),"getGridOptionsByAnchor",this).call(this),t=R()(e,2),n=t[0],r=t[1],o=this.context.detectFrame,a=this.getResizeNodePositionOnSlide(),l=this.getRefFrame(o),c=Object(Oe.b)(a.x,l.left)&&Object(Oe.b)(l.right,a.x),s=Object(Oe.b)(a.y,l.top)&&Object(Oe.b)(l.bottom,a.y);return c?[r]:s?[n]:[n,r]}},{key:"addBetweenReferMarginSnapLines",value:function(e){var t=this,i=this.departRefersWithOrient();[].concat(L()(this.createSnapLineOptionsWithOppositeRefers(i.top,i.bottom,E.d.VERTICAL)),L()(this.createSnapLineOptionsWithOppositeRefers(i.left,i.right,E.d.HORIZONTAL))).forEach((function(i){return t.addBetweenMarginSnapLine(e,i)}))}},{key:"createSnapLineOptionsWithOppositeRefers",value:function(e,t,i){var r=this,o=[];return e.forEach((function(e){t.forEach((function(t){var a=r.context.operationType===n.MOVE?r.createMoveModeSnapLineOption(e,t,i):r.createResizeModeSnapLineOption(e,t,i);a&&o.push.apply(o,L()(a))}))})),o}},{key:"createMoveModeSnapLineOption",value:function(e,t,i){var n=this.context.detectFrame,r=this.getRefOuterFrame(e),o=this.getRefOuterFrame(t);if(i===E.d.HORIZONTAL){var a=n.width,l=(o.left-r.right-a)/2;if(l>=5)return[{frontRef:e,behindRef:t,position:l+r.right,margin:l,orient:Object(ne.f)(i),adsorbEdge:E.a.LEFT}]}var c=n.height,s=(o.top-r.bottom-c)/2;if(s>=5)return[{frontRef:e,behindRef:t,position:s+r.bottom,margin:s,orient:Object(ne.f)(i),adsorbEdge:E.a.TOP}]}},{key:"createResizeModeSnapLineOption",value:function(e,t,i){var n=this.context,r=n.operationAnchorOnSlide,o=n.detectFrame,a=this.getRefFrame(o),l=this.getRefOuterFrame(e),c=this.getRefOuterFrame(t),s=[];if(i===E.d.HORIZONTAL){var u=r.includes("left"),d=r.includes("right");if(u||d){var h=this.calculateMarginSpacingAndPosition({orient:i,isLeftSideAnchor:u,detectElementFrame:a,frontFrame:l,behindFrame:c}),f=h.marginSpacing,v=h.position;f>=5&&s.push({frontRef:e,behindRef:t,position:v,margin:f,orient:Object(ne.f)(i),adsorbEdge:u?E.a.LEFT:E.a.RIGHT})}}else{var p=r.includes("top"),m=r.includes("bottom");if(p||m){var b=this.calculateMarginSpacingAndPosition({orient:i,isTopSideAnchor:p,detectElementFrame:a,frontFrame:l,behindFrame:c}),y=b.marginSpacing,g=b.position;y>=5&&s.push({frontRef:e,behindRef:t,position:g,margin:y,orient:Object(ne.f)(i),adsorbEdge:p?E.a.TOP:E.a.BOTTOM})}}return s}},{key:"calculateMarginSpacingAndPosition",value:function(e){var t=e.orient,i=e.isTopSideAnchor,n=e.isLeftSideAnchor,r=e.detectElementFrame,o=e.frontFrame,a=e.behindFrame,l=0,c=0;if(t===E.d.HORIZONTAL){if(n){var s=r.right;l=a.left-s,c=o.right+l}else{l=r.left-o.right,c=a.left-l}return{marginSpacing:l,position:c}}if(i){var u=r.bottom;l=a.top-u,c=o.bottom+l}else{l=r.top-o.bottom,c=a.top-l}return{marginSpacing:l,position:c}}},{key:"departRefersWithOrient",value:function(){var e,t=this,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.getRefFrame(this.context.detectFrame),r=this.dynamicRefer.refs,o=(e={},d()(e,E.e.TOP,[]),d()(e,E.e.BOTTOM,[]),d()(e,E.e.LEFT,[]),d()(e,E.e.RIGHT,[]),e);return r.forEach((function(e){var i=t.getRefOuterFrame(e);i.bottom<n.top?o[E.e.TOP].push(e):i.top>n.bottom?o[E.e.BOTTOM].push(e):i.right<n.left?o[E.e.LEFT].push(e):i.left>n.right&&o[E.e.RIGHT].push(e)})),i&&(o.top=this.filterCompleteCoveredRefer(o.top,E.e.TOP),o.bottom=this.filterCompleteCoveredRefer(o.bottom,E.e.BOTTOM),o.left=this.filterCompleteCoveredRefer(o.left,E.e.LEFT),o.right=this.filterCompleteCoveredRefer(o.right,E.e.RIGHT)),o}},{key:"filterCompleteCoveredRefer",value:function(e,t){if(0===e.length)return[];for(var i=[],n=this.getOrderedRefsWithOrientDirection(e,t),r=this.getRefFrame(this.context.detectFrame),o=0;o<n.length;o++){var a=n[o];if(this.isShadowCoveredBy(a,r,t)){i.push(a);break}var l=n[o+1];if(l&&this.isShadowCoveredBy(a,l,t)){i.push(a);break}i.push(a)}return i}},{key:"getOrderedRefsWithOrientDirection",value:function(e,t){return t===E.e.TOP||t===E.e.LEFT?this.orderElementsWithOrientDirection(e,t).reverse():this.orderElementsWithOrientDirection(e,t)}},{key:"isShadowCoveredBy",value:function(e,t,i){var n=this.getRefOuterFrame(e),r=t.ele?this.getRefOuterFrame(t):t;return i===E.e.TOP||i===E.e.BOTTOM?n.left<=r.left&&n.right>=r.right:n.top<=r.top&&n.bottom>=r.bottom}},{key:"isCoveredBy",value:function(e,t,i){var n=this.getRefFrame(e.outerFrameOnSlide),r=this.getRefFrame(t.outerFrameOnSlide),o=n.top<=r.top&&n.bottom>=r.bottom,a=n.left<=r.left&&n.right>=r.right;return i===E.e.LEFT?n.left<=r.left&&o:i===E.e.RIGHT?n.right>=r.right&&o:i===E.e.TOP?n.top<=r.top&&a:n.bottom>=r.bottom&&a}},{key:"addExtendMarginSnapLines",value:function(e){this.addExtendMarginSnapLinesWithOrient(this.dynamicRefer.refs,e,E.d.HORIZONTAL),this.addExtendMarginSnapLinesWithOrient(this.dynamicRefer.refs,e,E.d.VERTICAL)}},{key:"addSlideSymmetryMarginSnapLines",value:function(e){var t=this,i=this.context.dynamicRefer.refs,n=this.context.uiDataService.presentation.props,r=n.slideWidth,o=(n.slideHeight-1)/2,a=(r-1)/2,l=this.staticRefer.getSlideRef({height:1,top:o,left:0}),c=this.staticRefer.getSlideRef({width:1,top:0,left:a});i.forEach((function(i){t.addSymmetrySnapLinesWithOrient(i,l,E.d.HORIZONTAL,e),t.addSymmetrySnapLinesWithOrient(i,c,E.d.VERTICAL,e)}))}},{key:"addSymmetrySnapLinesWithOrient",value:function(e,t,i,n){var r=this.context.uiDataService.presentation.props,o=r.slideWidth,a=r.slideHeight/2,l=o/2,c=this.getRefOuterFrame(e);if(i===E.d.HORIZONTAL){if(c.top<=a&&c.bottom>=a)return;var s=c.bottom<a,u=s?a-c.bottom:a-c.top;this.addExtendMarginSnapLine(n,{frontRef:e,behindRef:t,position:a+u,orient:E.d.HORIZONTAL,adsorbEdge:s?E.a.TOP:E.a.BOTTOM,margin:u,source:q.a.SLIDE})}else{if(c.left<=l&&c.right>=l)return;var d=c.right<l,h=d?l-c.right:l-c.left;this.addExtendMarginSnapLine(n,{frontRef:e,behindRef:t,position:l+h,orient:E.d.VERTICAL,adsorbEdge:d?E.a.LEFT:E.a.RIGHT,margin:h,source:q.a.SLIDE})}}},{key:"addExtendMarginSnapLinesWithOrient",value:function(e,t,i){for(var n=this.orderElementsWithOrient(e,i),r=i===E.d.HORIZONTAL,o=0;o<n.length-1;o++)for(var a=n[o],l=this.getRefOuterFrame(a),c=o+1;c<n.length;c++){var s=n[c],u=this.getRefOuterFrame(s);if(this.dynamicRefer.isShadowOverlapped(a,s))if(r){var d=u.left-l.right;if(d>0){if(!this.isCoveredByOtherRefers(a,E.e.LEFT)){var h=l.left-d;this.addExtendMarginSnapLine(t,{frontRef:a,behindRef:s,position:h,orient:E.d.VERTICAL,adsorbEdge:E.a.RIGHT,margin:d})}if(!this.isCoveredByOtherRefers(s,E.e.RIGHT)){var f=d+u.right;this.addExtendMarginSnapLine(t,{frontRef:a,behindRef:s,position:f,orient:E.d.VERTICAL,adsorbEdge:E.a.LEFT,margin:d})}}}else{var v=u.top-l.bottom;if(v>0){if(!this.isCoveredByOtherRefers(a,E.e.TOP)){var p=l.top-v;this.addExtendMarginSnapLine(t,{frontRef:a,behindRef:s,position:p,orient:E.d.HORIZONTAL,adsorbEdge:E.a.BOTTOM,margin:v})}if(!this.isCoveredByOtherRefers(s,E.e.BOTTOM)){var m=v+u.bottom;this.addExtendMarginSnapLine(t,{frontRef:a,behindRef:s,position:m,orient:E.d.HORIZONTAL,adsorbEdge:E.a.TOP,margin:v})}}}}}},{key:"isCoveredByOtherRefers",value:function(e,t){var i=this,n=this.getCoveredResultFromCache(e,t);if(void 0!==n)return n;var r=this.dynamicRefer.refs.some((function(n){if(n.ele.key===e.ele.key)return!1;var r=i.isCoveredBy(n,e,t),o=i.isSameOrientDirectionToDetectFrame(t,[n,e]);return r&&o}));return this.setCoveredResultCache(e,t,r),r}},{key:"isSameOrientDirectionToDetectFrame",value:function(e,t){var i=this,n=this.getRefFrame(this.context.detectFrame);return t.every((function(t){var r=i.getRefFrame(t.outerFrameOnSlide);return e===E.e.LEFT?r.right<n.left:e===E.e.TOP?r.bottom<n.top:e===E.e.RIGHT?r.left>n.right:r.top>n.bottom}))}},{key:"getCoveredResultFromCache",value:function(e,t){var i=e.ele.key+t;return this.referCoveredResultCache[i]}},{key:"setCoveredResultCache",value:function(e,t,i){var n=e.ele.key+t;this.referCoveredResultCache[n]=i}},{key:"resetCoveredResultCache",value:function(){this.referCoveredResultCache={}}},{key:"orderElementsWithOrient",value:function(e,t){var i=this;return Be()(e,[function(e){var n=i.getRefOuterFrame(e);return t===E.d.HORIZONTAL?n.left||0:n.top||0}])}},{key:"orderElementsWithOrientDirection",value:function(e,t){var i=this;return Be()(e,[function(e){var n=i.getRefOuterFrame(e);return t===E.e.TOP?n.bottom||0:t===E.e.BOTTOM?n.top||0:t===E.e.LEFT?n.right||0:n.left||0}])}},{key:"addExtendMarginSnapLine",value:function(e,t){var i=t.frontRef,n=t.behindRef,r=t.position,o=t.orient,a=t.adsorbEdge,l=t.source;if(!(Math.abs(t.margin)<2)){var c=t.margin.toFixed(2);e.push({position:r,orient:o,maxAdsorbGap:this.context.option.maxAdsorbGap,type:M.a.MARGIN,source:l||q.a.ELEMENT,refElements:[i,n],adsorbEdge:a,margin:c,marginType:M.b.EXTEND})}}},{key:"addBetweenMarginSnapLine",value:function(e,t){var i=t.frontRef,n=t.behindRef,r=t.position,o=t.orient,a=t.adsorbEdge,l=(t.source,t.margin.toFixed(2));e.push({position:r,orient:o,maxAdsorbGap:this.context.option.maxAdsorbGap,type:M.a.MARGIN,source:q.a.ELEMENT,refElements:[i,n],adsorbEdge:a,margin:l,marginType:M.b.BETWEEN})}},{key:"collectRefGroups",value:function(e){var t=this;e.forEach((function(e){var i=e.source,n=e.orient,r=e.margin,o=e.refElements,a=e.marginType,l=R()(o,2),c=l[0],s=l[1];i===q.a.SLIDE?t.collectSymmetryGroup(n,r,c):a===M.b.EXTEND&&t.collectMarginGroup(n,r,[c,s])}))}},{key:"getRefOuterFrame",value:function(e){var t=e.outerFrameOnSlide;return Fe(Fe({},t),{},{right:t.left+t.width,bottom:t.top+t.height})}},{key:"collectMarginGroup",value:function(e,t,i){this.marginRefGroups[e][t]||(this.marginRefGroups[e][t]=[]);var n=this.marginRefGroups[e][t];this.isGroupExisted(n,i)||this.marginRefGroups[e][t].push(i)}},{key:"collectSymmetryGroup",value:function(e,t,i){this.symmetryRefGroups[e][t]||(this.symmetryRefGroups[e][t]=[]),this.symmetryRefGroups[e][t].push(i)}},{key:"isGroupExisted",value:function(e,t){return e.some((function(e){return t.every((function(t){return e.some((function(e){return e.ele.key===t.ele.key}))}))}))}},{key:"relateEqualMarginGroups",value:function(e){var t=this;return e.map((function(e){var i=e.margin,n=e.orient,r=(e.source===q.a.SLIDE?t.symmetryRefGroups:t.marginRefGroups)[n][i]||[];return Fe(Fe({},e),{},{equalMarginRefGroup:r})}))}},{key:"resetMarginGroup",value:function(){this.marginRefGroups.horizontal={},this.marginRefGroups.vertical={},this.symmetryRefGroups.horizontal={},this.symmetryRefGroups.vertical={}}}]),i}(we);i("0acdc5834b"),i("826dc923b3");function je(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ge(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?je(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):je(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function He(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g()(e);if(t){var r=g()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return b()(this,i)}}var ze=function(e){p()(i,e);var t=He(i);function i(){var e;l()(this,i);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),d()(ke()(e),"type",ge.DYNAMIC),d()(ke()(e),"heightRefGroups",{}),d()(ke()(e),"widthRefGroups",{}),e}return s()(i,[{key:"detect",value:function(){var e=this.context.nextSizeOnSlide.rotate;return(void 0===e?0:e)%90!=0||this.context.noChangeAspect?[]:Ie()(g()(i.prototype),"detect",this).call(this)}},{key:"processActiveSnapLines",value:function(e){var t=this;return e.forEach((function(i){return i.refElements.push(t.createRefWithNextFrame(e))})),e}},{key:"collectRefGrids",value:function(){return this.resetRectGroup(),this.collectRectGroups(),[].concat(L()(this.getHeightRefGrids()),L()(this.getWidthRefGrids()))}},{key:"createSnapLine",value:function(e){return Ge(Ge({},e),{},{maxAdsorbGap:this.context.option.maxAdsorbGap,type:M.a.RECT,source:q.a.ELEMENT})}},{key:"createRefWithNextFrame",value:function(e){var t=this,i=this.context,n=i.operationAnchorOnSlide,r=i.detectFrame,o=e.reduce((function(e,i){var r=t.getRefFrame(e);if(i.orient===E.d.VERTICAL){if(n.includes("left")){var o=i.position;return Ge(Ge({},e),{},{left:o,width:r.right-o})}if(n.includes("right")){var a=i.position;return Ge(Ge({},e),{},{width:a-r.left})}}else{if(n.includes("top")){var l=i.position;return Ge(Ge({},e),{},{top:l,height:r.bottom-l})}if(n.includes("bottom")){var c=i.position;return Ge(Ge({},e),{},{height:c-r.top})}}return e}),r);return{ele:{props:{style:Ge(Ge({},o),{},{rotate:0})}},source:q.a.ELEMENT,outerFrameOnSlide:o}}},{key:"getHeightRefGrids",value:function(){var e=this,t=this.context,i=t.operationAnchorOnSlide,n=t.detectFrame,r=[];return Object.keys(this.heightRefGroups).forEach((function(t){var o=e.heightRefGroups[t];if(i.includes("top")){var a=n.top+n.height;r.push(e.createSnapLine({orient:E.d.HORIZONTAL,position:a-Number(t),refElements:o}))}i.includes("bottom")&&r.push(e.createSnapLine({orient:E.d.HORIZONTAL,position:n.top+Number(t),refElements:o}))})),r}},{key:"getWidthRefGrids",value:function(){var e=this,t=this.context,i=t.operationAnchorOnSlide,n=t.detectFrame,r=[];return Object.keys(this.widthRefGroups).forEach((function(t){var o=e.widthRefGroups[t];if(i.includes("left")){var a=n.left+n.width;r.push(e.createSnapLine({orient:E.d.VERTICAL,position:a-Number(t),refElements:o}))}i.includes("right")&&r.push(e.createSnapLine({orient:E.d.VERTICAL,position:n.left+Number(t),refElements:o}))})),r}},{key:"collectRectGroups",value:function(){var e=this;this.dynamicRefs.forEach((function(t){var i=t.outerFrameOnSlide,n=i.height.toFixed(2),r=i.width.toFixed(2);e.heightRefGroups[n]||(e.heightRefGroups[n]=[]),e.heightRefGroups[n].push(t),e.widthRefGroups[r]||(e.widthRefGroups[r]=[]),e.widthRefGroups[r].push(t)}))}},{key:"dynamicRefs",get:function(){return this.context.dynamicRefer.refs}},{key:"resetRectGroup",value:function(){this.heightRefGroups={},this.widthRefGroups={}}}]),i}(we),Ve=i("89ec4be862"),We=function(){function e(t,i,n){l()(this,e),d()(this,"edgeAndBaseLineDetector",void 0),d()(this,"marginDetector",void 0),d()(this,"rectDetector",void 0),this.selectionService=t,this.uiDataService=i,this.context=n,this.edgeAndBaseLineDetector=new xe(this.context),this.marginDetector=new Ne(this.context),this.rectDetector=new ze(this.context,!0)}return s()(e,[{key:"detect",value:function(){return this.setDevLines(),this.processActiveSnapLines(this.edgeAndBaseLineDetector.detect(),this.shouldDisableDynamicDetect()?[]:this.marginDetector.detect(),this.shouldDisableDynamicDetect()?[]:this.rectDetector.detect())}},{key:"reset",value:function(){this.edgeAndBaseLineDetector.clearCache(),this.marginDetector.clearCache(),this.rectDetector.clearCache()}},{key:"shouldDisableDynamicDetect",value:function(){return this.context.dynamicRefer.refs.length>80}},{key:"processActiveSnapLines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=[].concat(L()(e),L()(t),L()(i));return this.handleActiveSnapLinesConflict(n)}},{key:"handleActiveSnapLinesConflict",value:function(e){var t=[];return e.forEach((function(e){var i=t.findIndex((function(t){return t.orient===e.orient}));if(-1!==i){var n=t[i];if(Object(Oe.a)(n.activeAdsorbGap,e.activeAdsorbGap))t.push(e);else Math.abs(e.activeAdsorbGap)<Math.abs(n.activeAdsorbGap)&&(t=t.filter((function(e){return e.orient!==n.orient})),t.push(e))}else t.push(e)})),t}},{key:"setDevLines",value:function(){Object(Ve.a)()&&(this.context.elementGrids=[].concat(L()(this.edgeAndBaseLineDetector.getRefGrids()),L()(this.marginDetector.getRefGrids())),this.context.detectGrids=[].concat(L()(this.edgeAndBaseLineDetector.getDetectGrids()),L()(this.marginDetector.getDetectGrids()),L()(this.rectDetector.getDetectGrids())))}}]),e}(),Ue=(i("963f2eaace"),i("981e82437a")),qe=i("2f71c2f9fa"),Ke=i.n(qe);function Ye(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ze(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(i),!0).forEach((function(t){d()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ye(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Je,Xe,$e,Qe=function(){function e(t){l()(this,e),this.context=t}return s()(e,[{key:"adsorb",value:function(e){var t=this.context.operationType;if(e&&0!==e.length){var i=this.filterSameOrientActiveSnapLines(e),r=t===n.RESIZE?this.adsorbInResizing(i):this.adsorbInMoving(i),o=r.framePatch,a=r.points,l=r.afterAdsorbFrame,c=G(a);return this.displayAdsorbPointsInDevEnv(a),{framePatch:o,frameOnSlide:c,afterAdsorbFrame:l}}}},{key:"adsorbInMoving",value:function(e){var t=this,i=this.createInitialFramePatch(),n=z(this.context.nextSizeOnSlide,this.context.rotateOnSlide);this.displayBeforeAdsorbPointsInDevEnv(n);var r=Ze({},this.context.detectFrame);e.forEach((function(e){t.adsorbFrameWithActiveSnapLineInMoving(r,e),n.forEach((function(t){e.orient===E.d.VERTICAL?t.x+=e.activeAdsorbGap:t.y+=e.activeAdsorbGap}))}));var o=this.getAdsorbFramePatch(n),a=o.left,l=o.top;return i.top+=l,i.left+=a,{framePatch:i,points:n,afterAdsorbFrame:r}}},{key:"adsorbFrameWithActiveSnapLineInMoving",value:function(e,t){t.orient===E.d.VERTICAL?e.left+=t.activeAdsorbGap:e.top+=t.activeAdsorbGap}},{key:"adsorbInResizing",value:function(e){var t=this,i=this.createInitialFramePatch(),n={left:0,top:0,width:0,height:0},r=z(this.context.nextSizeOnSlide,this.context.rotateOnSlide);this.displayBeforeAdsorbPointsInDevEnv(r),e.forEach((function(e){t.adsorbFrameWithActiveSnapLineInResizing(n,e);var i=t.getDiagonalAndExtendPoints(e,r),o=i.staticPoint,a=i.afterAdsorbPoint,l=i.extendPoints;o&&a&&(r=t.getAfterAdsorbPoints(a,o,l))}));var o=this.getAdsorbFramePatch(r),a=o.left,l=o.top,c=o.width,s=o.height;i.top+=l,i.left+=a,i.width+=c,i.height+=s;var u=this.context,d=u.detectFrame,h=(u.operationAnchorOnSlide,u.elementScale,u.noChangeAspect,Ze({},d));return h.top+=n.top,h.left+=n.left,h.width+=n.width,h.height+=n.height,{framePatch:i,points:r,afterAdsorbFrame:h}}},{key:"adsorbFrameWithActiveSnapLineInResizing",value:function(e,t){var i=this.context.operationAnchorOnSlide;t.orient===E.d.VERTICAL?(i.includes("left")&&(e.left+=t.activeAdsorbGap,e.width-=t.activeAdsorbGap),i.includes("right")&&(e.width+=t.activeAdsorbGap)):(i.includes("top")&&(e.top+=t.activeAdsorbGap,e.height-=t.activeAdsorbGap),i.includes("bottom")&&(e.height+=t.activeAdsorbGap))}},{key:"getAdsorbFramePatch",value:function(e){var t=G(this.getBeforeTransformPoints(e,this.context.rotateOnSlide)),i=this.context.element.getFrame().convertFrameOnSlideToSelf(Ze(Ze({},t),{},{flipH:this.context.nextSizeOnSlide.flipH,flipV:this.context.nextSizeOnSlide.flipV,rotate:this.context.nextSizeOnSlide.rotate})),n=i.left,r=i.top,o=i.width,a=i.height,l=n-this.context.nextSize.left,c=r-this.context.nextSize.top,s=o-this.context.nextSize.width,u=a-this.context.nextSize.height;return{left:Object(Oe.a)(l,0)?0:l,top:Object(Oe.a)(c,0)?0:c,width:Object(Oe.a)(s,0)?0:s,height:Object(Oe.a)(u,0)?0:u}}},{key:"getBeforeTransformPoints",value:function(e,t){return F(e,-t)}},{key:"filterSameOrientActiveSnapLines",value:function(e){var t,i=(t={},d()(t,E.d.HORIZONTAL,!1),d()(t,E.d.VERTICAL,!1),t);return e.filter((function(e){return!i[e.orient]&&(i[e.orient]=!0,!0)}))}},{key:"getAbsorbPointIndex",value:function(e,t){var i=e.position-e.activeAdsorbGap,n=e.orient===E.d.VERTICAL,r=t.findIndex((function(e){return Object(Oe.a)(n?e.x:e.y,i)})),o=Ke()(t,(function(e){return Object(Oe.a)(n?e.x:e.y,i)})),a=t[r],l=t[o];if(r===o)return r;var c=this.context.operationAnchorOnSlide;return n?c.includes("bottom")&&a.y>l.y||c.includes("top")&&a.y<=l.y?r:o:c.includes("right")&&a.x>=l.x||c.includes("left")&&a.x<l.x?r:o}},{key:"getDiagonalAndExtendPoints",value:function(e,t){var i=e.orient===E.d.VERTICAL,n=this.getAbsorbPointIndex(e,t);if(-1===n)return{staticPoint:null,extendPoints:[],afterAdsorbPoint:null};var r=t[n],o=(n+2)%4,a=t[o],l=i?e.activeAdsorbGap:0,c=i?0:e.activeAdsorbGap;return{staticPoint:a,afterAdsorbPoint:{x:r.x+l,y:r.y+c},extendPoints:t.filter((function(e,t){return t!==o&&t!==n}))}}},{key:"handleNoChangeAspectScale",value:function(e,t,i,n){var r=n.orient===E.d.VERTICAL,o=this.context,a=o.noChangeAspect,l=o.originOperationAnchor;if(a&&Object(ne.h)(l)){var c=[Object(Oe.a)(t.x,i.x)?0:t.x-i.x,Object(Oe.a)(t.y,i.y)?0:t.y-i.y],s=c[0]*c[1],u=s>0?1:s<0?-1:0,d=Object(Ue.a)(n.activeAdsorbGap,c,r);r?e.y=d*u:e.x=d*u}}},{key:"getAfterAdsorbPoints",value:function(e,t,i){var n=[e.x-t.x,e.y-t.y],r=i.map((function(e){return[e.x-t.x,e.y-t.y]})).map((function(e){return Object(Ue.d)(n,e)})).map((function(e){return{x:e[0]+t.x,y:e[1]+t.y}}));return[t,r[0],e,r[1]]}},{key:"createInitialFramePatch",value:function(){return{left:0,top:0,width:0,height:0}}},{key:"element",get:function(){return this.context.element}},{key:"displayBeforeAdsorbPointsInDevEnv",value:function(e){Object(Ve.a)()&&(this.context.beforeAdsorbPoints=e.slice(0))}},{key:"displayAdsorbPointsInDevEnv",value:function(e){Object(Ve.a)()&&(this.context.adsorbPoints=e.slice(0))}}]),e}(),et=i("9486306832"),tt=i("b9a4a16e8e"),it=function(){function e(t){var i=this;l()(this,e),d()(this,"handleNoChangeAspectOffsetFrame",(function(e){var t=i.context,n=t.noChangeAspect,r=t.originOperationAnchor,o=t.activeSnapLines,a=t.elementScale;n&&U(o,e,r,a)})),this.context=t}return s()(e,[{key:"commit",value:function(e){var t=null==e?void 0:e.framePatch;t&&(this.updateOperateOffsetFrame(t),this.updateRelativeOffsetFrame(t))}},{key:"updateOperateOffsetFrame",value:function(e){this.updateOffsetFrameWithPatch(this.context.offsetFrame,e)}},{key:"updateRelativeOffsetFrame",value:function(e){var t=this,i=this.context.sizeMap;null!=i&&i.size&&i.size>1&&i.forEach((function(i){t.updateOffsetFrameWithPatch(i.offsetFrame,e)}))}},{key:"updateOffsetFrameWithPatch",value:function(e,t){var i=this.getOffsetFrameResult(e,t);e.top=i.top,e.left=i.left,e.width=i.width,e.height=i.height}},{key:"getOffsetFrameResult",value:function(e,t){var i=this.context,n=i.nextSize,r=i.originalSize,o=n.top+t.top,a=n.left+t.left,l=n.height+t.height,c=n.width+t.width;return{top:t.top?o-r.top:e.top,left:t.left?a-r.left:e.left,height:t.height?l-r.height:e.height,width:t.width?c-r.width:e.width}}}]),e}(),nt=i("5ce71228c0"),rt=(Je=Reflect.metadata("design:type",Boolean),Xe=function(){function e(t,i,r,a,c,s){var u=this;l()(this,e),d()(this,"context",void 0),d()(this,"detector",void 0),d()(this,"adsorber",void 0),d()(this,"committer",void 0),o()(this,"enableState",$e,this),d()(this,"handleDragStart",(function(e){var t=e.elementModel,i=e.e;u.enableState&&u.initContext(t,i)})),d()(this,"handleDragging",(function(e){u.enableState&&(u.setContextDetail(e,n.MOVE),u.dynamicAdsorb())})),d()(this,"handleDragStop",(function(){u.reset()})),d()(this,"handleResizeStart",(function(e){var t=e.elementModel,i=e.e;u.enableState&&u.initContext(t,i)})),d()(this,"handleResizing",(function(e){u.enableState&&(u.setContextDetail(e,n.RESIZE),u.dynamicAdsorb())})),d()(this,"handleResizeStop",(function(){u.reset()})),this.dragElementHandler=t,this.resizeElementHandler=i,this.selectionService=r,this.editAreaCanvasSizeManager=a,this.menuManager=c,this.uiDataService=s,this.context=new Se(r,s,a,c),this.detector=new We(r,s,this.context),this.adsorber=new Qe(this.context),this.committer=new it(this.context);var h=nt.b.getItem(nt.a.ENABLE_SNAP_LINE_STATE,ee.ENABLE);this.enableState=h===ee.ENABLE,this.subscribeServiceEvents()}return s()(e,[{key:"toggleSnapLine",value:function(){this.enableState=!this.enableState,nt.b.setItem(nt.a.ENABLE_SNAP_LINE_STATE,this.enableState?ee.ENABLE:ee.DISABLE)}},{key:"handleNotifyEvent",value:function(e){e.mode===oe.b.MOVE?this.handleDragging(e):this.handleResizing(e)}},{key:"getActiveSnapLines",value:function(){return this.context.activeSnapLines||[]}},{key:"subscribeServiceEvents",value:function(){this.subscribeDragEvents(),this.subscribeResizeEvents()}},{key:"subscribeDragEvents",value:function(){this.dragElementHandler.on(et.a.DRAG_START,this.handleDragStart),this.dragElementHandler.on(et.a.DRAG_STOP,this.handleDragStop)}},{key:"subscribeResizeEvents",value:function(){this.resizeElementHandler.on(tt.a.RESIZE_START,this.handleResizeStart),this.resizeElementHandler.on(tt.a.RESIZE_STOP,this.handleResizeStop)}},{key:"setContextDetail",value:function(e,t){this.context.setDetail(e,t)}},{key:"initContext",value:function(e,t){this.context.init(e,t)}},{key:"reset",value:function(){this.context.reset(),this.detector.reset()}},{key:"dynamicAdsorb",value:function(){var e=this.context.detectFrame;this.context.update(e);var t=this.detector.detect(),i=this.adsorber.adsorb(t);this.committer.commit(i),this.context.setActiveSnapLines(t,null==i?void 0:i.afterAdsorbFrame)}}]),e}(),$e=f()(Xe.prototype,"enableState",[ie.q,Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe)},"5fdb99520e":function(e,t,i){"use strict";i.d(t,"i",(function(){return d})),i.d(t,"c",(function(){return h})),i.d(t,"d",(function(){return f})),i.d(t,"e",(function(){return p})),i.d(t,"g",(function(){return y})),i.d(t,"a",(function(){return g})),i.d(t,"f",(function(){return S})),i.d(t,"b",(function(){return T})),i.d(t,"h",(function(){return k}));var n,r,o,a=i("85d0a7609b"),l=i.n(a),c=(i("b8217400dc"),i("e6f68cdf2e"),i("79fc58c7b0")),s=i("981e82437a"),u=i("57db36e15c");function d(e){var t=e.movementX,i=e.movementY;return t>0?i>0?u.b.RIGHT_BOTTOM:i<0?u.b.RIGHT_TOP:u.b.RIGHT:t<0?i>0?u.b.LEFT_BOTTOM:i<0?u.b.LEFT_TOP:u.b.LEFT:i>0?u.b.BOTTOM:i<0?u.b.TOP:u.b.NONE}function h(e){var t=e.movementX,i=e.movementY;return Math.abs(t)-Math.abs(i)>0?u.d.HORIZONTAL:u.d.VERTICAL}function f(e){var t=e.movementX,i=e.movementY;return Math.abs(t)-Math.abs(i)>0?t>=0?u.e.RIGHT:u.e.LEFT:i>=0?u.e.BOTTOM:u.e.TOP}var v=(n={},l()(n,c.b.TOP,u.c.TOP),l()(n,c.b.BOTTOM,u.c.BOTTOM),l()(n,c.b.RIGHT,u.c.RIGHT),l()(n,c.b.LEFT,u.c.LEFT),l()(n,c.b.TOP_LEFT,u.c.LEFT_TOP),l()(n,c.b.TOP_RIGHT,u.c.RIGHT_TOP),l()(n,c.b.BOTTOM_LEFT,u.c.LEFT_BOTTOM),l()(n,c.b.BOTTOM_RIGHT,u.c.RIGHT_BOTTOM),l()(n,c.b.MOVE,u.c.ALL),n);function p(e){return v[e]}var m=(r={},l()(r,u.c.TOP,u.c.BOTTOM),l()(r,u.c.BOTTOM,u.c.TOP),l()(r,u.c.LEFT_TOP,u.c.LEFT_BOTTOM),l()(r,u.c.LEFT_BOTTOM,u.c.LEFT_TOP),l()(r,u.c.RIGHT_TOP,u.c.RIGHT_BOTTOM),l()(r,u.c.RIGHT_BOTTOM,u.c.RIGHT_TOP),r),b=(o={},l()(o,u.c.LEFT,u.c.RIGHT),l()(o,u.c.RIGHT,u.c.LEFT),l()(o,u.c.LEFT_TOP,u.c.RIGHT_TOP),l()(o,u.c.LEFT_BOTTOM,u.c.RIGHT_BOTTOM),l()(o,u.c.RIGHT_TOP,u.c.LEFT_TOP),l()(o,u.c.RIGHT_BOTTOM,u.c.LEFT_BOTTOM),o);function y(e,t){var i=Object(s.e)(e),n=Object(s.c)(i,t);return Object(s.b)(n)}function g(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e;return arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(i=m[i]||i),t&&(i=b[i]||i),i}function S(e){return e===u.d.VERTICAL?u.d.HORIZONTAL:u.d.VERTICAL}function T(e){return{x:e.touches?e.touches[0].clientX:e.clientX,y:e.touches?e.touches[0].clientY:e.clientY}}function k(e){return e===u.c.LEFT_BOTTOM||e===u.c.LEFT_TOP||e===u.c.RIGHT_TOP||e===u.c.RIGHT_BOTTOM}},"6d35c5a9da":function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return D}));i("73b854064b");var n,r,o,a,l=i("176815363d"),c=i.n(l),s=i("1f925d7f50"),u=i.n(s),d=i("9132715560"),h=i.n(d),f=i("6a364eb35c"),v=i.n(f),p=i("547611bd96"),m=i.n(p),b=i("8eec1e4a03"),y=i.n(b),g=i("bd29e2df90"),S=i.n(g),T=i("ab5eb40518"),k=i.n(T),O=i("1b4cdd6a36"),E=i.n(O),C=i("85d0a7609b"),A=i.n(C),R=i("2dc700e1e6"),w=i.n(R),L=(i("f1054791f4"),i("3ef2352f0b")),x=i.n(L),M=(i("3bf1976a4f"),i("c6244f7705"),i("081c8cafea"),i("22569efd03"),i("e6d98148ee")),I=i("d5c3deb8c7");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=E()(e);if(t){var r=E()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return k()(this,i)}}!function(e){e.SNAPSHOT_EVENT_NAME="afterAllLoaded"}(a||(a={}));var B=(n=Reflect.metadata("design:type",Array),r=function(e){S()(i,e);var t=P(i);function i(){var e;h()(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),u()(m()(e),"snapshotCallback",o,m()(e)),e}return v()(i,[{key:"on",value:function(e,t){var n=y()(E()(i.prototype),"on",this).call(this,e,t);return e===a.SNAPSHOT_EVENT_NAME&&this.snapshotCallback.push(t),n}}]),i}(M.a),o=w()(r.prototype,"snapshotCallback",[I.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),r),D=function(){function t(i){var n=this;h()(this,t),A()(this,"event",void 0),A()(this,"slideRenderStateManager",void 0),A()(this,"selectionService",void 0),A()(this,"visibleSlideRenderCompletePromise",void 0),A()(this,"visibleSlideRenderCompleteResolve",void 0),A()(this,"currentSlideRenderCompletePromise",void 0),A()(this,"currentSlideRenderCompleteResolve",void 0),A()(this,"isAllLoaded",!1),A()(this,"currentSlideKey",void 0),A()(this,"notifyVisibleSlideLoaded",(function(){n.isAllLoaded=!0,n.event.emit(a.SNAPSHOT_EVENT_NAME),e.slideLoadState?(e.slideLoadState.isAllSlideLoaded=!0,window.log.info("visible slide loaded: ".concat(e.slideLoadState.listener)),e.slideLoadState.listener&&(e.slideLoadState.listener(),e.slideLoadState.listener=void 0)):window.log.info("global.slideLoadState not exist")})),A()(this,"observerVisibleSlideComplete",c()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.slideRenderStateManager.getVisiblePageDisplayPromise();case 2:return e.next=4,n.slideRenderStateManager.getVisibleSlideImgLoadCompletePromise();case 4:return e.next=6,new Promise((function(e){return setTimeout(e,1e3)}));case 6:n.visibleSlideRenderCompleteResolve(),n.notifyVisibleSlideLoaded();case 8:case"end":return e.stop()}}),e)})))),A()(this,"observerCurrentSlideChange",(function(){Object(I.r)((function(){var e;return{currentSlide:null===(e=n.selectionService)||void 0===e?void 0:e.currentSlide}}),function(){var e=c()(x.a.mark((function e(t){var i,r,o,a,l,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.currentSlide){e.next=9;break}return e.next=3,n.slideRenderStateManager.getFirstPageDisplayPromise();case 3:if((o=null===(a=n.selectionService)||void 0===a||null===(l=a.slides)||void 0===l?void 0:l[0])&&n.currentSlideKey!==o.key){e.next=6;break}return e.abrupt("return");case 6:n.currentSlideKey=o.key,e.next=14;break;case 9:return o=t.currentSlide,n.currentSlideKey=o.key,n.currentSlideKey&&(n.currentSlideRenderCompletePromise=new Promise((function(e){n.currentSlideRenderCompleteResolve=e})),window.currentSlideRenderCompletePromise=n.currentSlideRenderCompletePromise),e.next=14,n.slideRenderStateManager.getEditSlideRenderCompletePromiseByModel(o);case 14:return c=(null===(i=o)||void 0===i||null===(r=i.parent)||void 0===r?void 0:r.children.findIndex((function(e){return e===o})))||0,e.next=17,n.slideRenderStateManager.getImgLoadCompletePromiseByModel(o);case 17:return e.next=19,new Promise((function(e){return setTimeout(e,1e3)}));case 19:n.currentSlideRenderCompleteResolve(c);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{fireImmediately:!0})})),A()(this,"observerSnapshotCallbackChange",(function(){Object(I.r)((function(){return n.event.snapshotCallback.length}),(function(){n.isAllLoaded&&n.event.emit(a.SNAPSHOT_EVENT_NAME)}))})),this.visibleSlideRenderCompletePromise=new Promise((function(e){n.visibleSlideRenderCompleteResolve=e})),this.currentSlideRenderCompletePromise=new Promise((function(e){n.currentSlideRenderCompleteResolve=e})),window.renderStateNotification=this,window.visibleSlideRenderCompletePromise=this.visibleSlideRenderCompletePromise,window.currentSlideRenderCompletePromise=this.currentSlideRenderCompletePromise,this.slideRenderStateManager=i,this.event=new B,this.observerVisibleSlideComplete(),this.observerSnapshotCallbackChange()}return v()(t,[{key:"setSelectionServiceDelegate",value:function(e){this.selectionService||(this.selectionService=e,this.observerCurrentSlideChange())}}]),t}()}).call(this,i("5ef37df1a0"))},"7c14fe028b":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.toolbar=1]="toolbar",e[e.rightMenu=2]="rightMenu",e[e.ai=3]="ai",e[e.tips=4]="tips"}(n||(n={}))},"7e6f356806":function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"d",(function(){return s})),i.d(t,"f",(function(){return u})),i.d(t,"e",(function(){return p})),i.d(t,"b",(function(){return m})),i.d(t,"g",(function(){return b})),i.d(t,"c",(function(){return y}));var n,r=i("85d0a7609b"),o=i.n(r),a=i("5fac0349d3"),l=i("711a53c9fc"),c="classic",s="custom",u=[{title:a.a.t("经典"),key:c},{title:a.a.t("自定义"),key:s}],d=(a.a.t("白"),a.a.t("浅灰1"),a.a.t("浅灰2"),a.a.t("浅灰3"),a.a.t("浅灰4"),a.a.t("浅灰5"),a.a.t("黑"),a.a.t("深灰1"),a.a.t("深灰2"),a.a.t("深灰3"),a.a.t("深灰4"),a.a.t("深灰5"),a.a.t("蓝灰"),a.a.t("浅蓝灰1"),a.a.t("浅蓝灰2"),a.a.t("浅蓝灰3"),a.a.t("深蓝灰1"),a.a.t("深蓝灰2"),a.a.t("蓝"),a.a.t("浅蓝1"),a.a.t("浅蓝2"),a.a.t("浅蓝3"),a.a.t("深蓝1"),a.a.t("深蓝2"),a.a.t("天蓝"),a.a.t("浅天蓝1"),a.a.t("浅天蓝2"),a.a.t("浅天蓝3"),a.a.t("深天蓝1"),a.a.t("深天蓝2"),a.a.t("绿"),a.a.t("浅绿1"),a.a.t("浅绿2"),a.a.t("浅绿3"),a.a.t("深绿1"),a.a.t("深绿2"),a.a.t("红"),a.a.t("浅红1"),a.a.t("浅红2"),a.a.t("浅红3"),a.a.t("深红1"),a.a.t("深红2"),a.a.t("橙"),a.a.t("浅橙1"),a.a.t("浅橙2"),a.a.t("浅橙3"),a.a.t("深橙1"),a.a.t("深橙2"),a.a.t("黄"),a.a.t("浅黄1"),a.a.t("浅黄2"),a.a.t("浅黄3"),a.a.t("深黄1"),a.a.t("深黄2"),a.a.t("紫"),a.a.t("浅紫1"),a.a.t("浅紫2"),a.a.t("浅紫3"),a.a.t("深紫1"),a.a.t("深紫2"),{val:l.eb.dk1,color:"000000"}),h={val:l.eb.lt1,color:"ffffff"},f={val:l.eb.hlink,color:"175CEB"},v={val:l.eb.folHlink,color:"81868F"},p={id:"Office",title:"Office",isVip:!1,colorSchema:{dk1:d,lt1:h,dk2:{val:l.eb.dk2,color:"44546A"},lt2:{val:l.eb.lt2,color:"E7E6E6"},accent1:{val:l.eb.accent1,color:"4472C4"},accent2:{val:l.eb.accent2,color:"ED7D31"},accent3:{val:l.eb.accent3,color:"A5A5A5"},accent4:{val:l.eb.accent4,color:"FFC000"},accent5:{val:l.eb.accent5,color:"5B9BD5"},accent6:{val:l.eb.accent6,color:"70AD47"},hlink:{val:l.eb.hlink,color:"0563C1"},folHlink:{val:l.eb.folHlink,color:"954F72"}}},m=[{id:"Tencent",title:a.a.t("腾讯文档"),isVip:!1,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"485368"},lt2:{val:l.eb.lt2,color:"2972F4"},accent1:{val:l.eb.accent1,color:"00A3F5"},accent2:{val:l.eb.accent2,color:"319B62"},accent3:{val:l.eb.accent3,color:"DE3C36"},accent4:{val:l.eb.accent4,color:"F88825"},accent5:{val:l.eb.accent5,color:"F5C400"},accent6:{val:l.eb.accent6,color:"9A38D7"}}},p,{id:"theme_vip_1",title:a.a.t("空境蓝调"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"1C2645"},lt2:{val:l.eb.lt2,color:"D5E3EC"},accent1:{val:l.eb.accent1,color:"246CB8"},accent2:{val:l.eb.accent2,color:"BFE5FA"},accent3:{val:l.eb.accent3,color:"8CBADE"},accent4:{val:l.eb.accent4,color:"4D749F"},accent5:{val:l.eb.accent5,color:"6C97DF"},accent6:{val:l.eb.accent6,color:"0847B1"}}},{id:"theme_vip_2",title:a.a.t("向阳橘黄"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"503719"},lt2:{val:l.eb.lt2,color:"F5F3E9"},accent1:{val:l.eb.accent1,color:"E4943D"},accent2:{val:l.eb.accent2,color:"F8D7A3"},accent3:{val:l.eb.accent3,color:"E3B566"},accent4:{val:l.eb.accent4,color:"DD944B"},accent5:{val:l.eb.accent5,color:"9E9C8E"},accent6:{val:l.eb.accent6,color:"66645A"}}},{id:"theme_vip_3",title:a.a.t("石雾迷灰"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"2b3550"},lt2:{val:l.eb.lt2,color:"e9ebf5"},accent1:{val:l.eb.accent1,color:"727b97"},accent2:{val:l.eb.accent2,color:"c2cfee"},accent3:{val:l.eb.accent3,color:"7c8ebb"},accent4:{val:l.eb.accent4,color:"455682"},accent5:{val:l.eb.accent5,color:"868ba6"},accent6:{val:l.eb.accent6,color:"5e658a"}}},{id:"theme_vip_4",title:a.a.t("翡冷翠绿"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"01383b"},lt2:{val:l.eb.lt2,color:"ecffff"},accent1:{val:l.eb.accent1,color:"317b84"},accent2:{val:l.eb.accent2,color:"8deae7"},accent3:{val:l.eb.accent3,color:"35c5c2"},accent4:{val:l.eb.accent4,color:"108a89"},accent5:{val:l.eb.accent5,color:"0ac487"},accent6:{val:l.eb.accent6,color:"1E7054"}}},{id:"theme_vip_5",title:a.a.t("故宫风韵"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"171616"},lt2:{val:l.eb.lt2,color:"f2e7e7"},accent1:{val:l.eb.accent1,color:"ca3d1f"},accent2:{val:l.eb.accent2,color:"f7dfb7"},accent3:{val:l.eb.accent3,color:"caa267"},accent4:{val:l.eb.accent4,color:"b9752a"},accent5:{val:l.eb.accent5,color:"8f3c1a"},accent6:{val:l.eb.accent6,color:"3c281d"}}},{id:"theme_vip_6",title:a.a.t("敦煌梦境"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"1e282d"},lt2:{val:l.eb.lt2,color:"f5e9d4"},accent1:{val:l.eb.accent1,color:"236a78"},accent2:{val:l.eb.accent2,color:"8edeed"},accent3:{val:l.eb.accent3,color:"4190b6"},accent4:{val:l.eb.accent4,color:"284b5c"},accent5:{val:l.eb.accent5,color:"ef6c45"},accent6:{val:l.eb.accent6,color:"a64326"}}},{id:"theme_vip_7",title:a.a.t("普罗旺斯"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"2f2958"},lt2:{val:l.eb.lt2,color:"f5e6f6"},accent1:{val:l.eb.accent1,color:"793ec7"},accent2:{val:l.eb.accent2,color:"e5bffe"},accent3:{val:l.eb.accent3,color:"db7eec"},accent4:{val:l.eb.accent4,color:"763582"},accent5:{val:l.eb.accent5,color:"4f6755"},accent6:{val:l.eb.accent6,color:"1d381e"}}},{id:"theme_vip_8",title:a.a.t("开罗之光"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"382b26"},lt2:{val:l.eb.lt2,color:"fdf6e1"},accent1:{val:l.eb.accent1,color:"ad714d"},accent2:{val:l.eb.accent2,color:"e2ccba"},accent3:{val:l.eb.accent3,color:"ac7f67"},accent4:{val:l.eb.accent4,color:"9c421f"},accent5:{val:l.eb.accent5,color:"948b82"},accent6:{val:l.eb.accent6,color:"58524c"}}},{id:"theme_vip_9",title:a.a.t("只此青绿"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"1c2e29"},lt2:{val:l.eb.lt2,color:"ecf9f5"},accent1:{val:l.eb.accent1,color:"30867f"},accent2:{val:l.eb.accent2,color:"afe5c8"},accent3:{val:l.eb.accent3,color:"589a76"},accent4:{val:l.eb.accent4,color:"3e6f53"},accent5:{val:l.eb.accent5,color:"dbbb69"},accent6:{val:l.eb.accent6,color:"8c7338"}}},{id:"theme_vip_10",title:a.a.t("日出印象"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"271016"},lt2:{val:l.eb.lt2,color:"ece9f9"},accent1:{val:l.eb.accent1,color:"7c7891"},accent2:{val:l.eb.accent2,color:"ddd1e0"},accent3:{val:l.eb.accent3,color:"bca0b8"},accent4:{val:l.eb.accent4,color:"7c7891"},accent5:{val:l.eb.accent5,color:"ecbda7"},accent6:{val:l.eb.accent6,color:"866753"}}},{id:"theme_vip_11",title:a.a.t("星空之夜"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"102443"},lt2:{val:l.eb.lt2,color:"f3edc1"},accent1:{val:l.eb.accent1,color:"114799"},accent2:{val:l.eb.accent2,color:"fecf56"},accent3:{val:l.eb.accent3,color:"68a8ca"},accent4:{val:l.eb.accent4,color:"3882b5"},accent5:{val:l.eb.accent5,color:"1b5789"},accent6:{val:l.eb.accent6,color:"afccc7"}}},{id:"theme_vip_12",title:a.a.t("叠翠流金"),isVip:!0,colorSchema:{dk1:d,lt1:h,hlink:f,folHlink:v,dk2:{val:l.eb.dk2,color:"3f3b34"},lt2:{val:l.eb.lt2,color:"f8f2e8"},accent1:{val:l.eb.accent1,color:"c09c5d"},accent2:{val:l.eb.accent2,color:"f0e0ca"},accent3:{val:l.eb.accent3,color:"DABD8E"},accent4:{val:l.eb.accent4,color:"b59465"},accent5:{val:l.eb.accent5,color:"c3b7a3"},accent6:{val:l.eb.accent6,color:"737664"}}}],b=(n={},o()(n,c,m),o()(n,s,[]),n),y=[[{hsl:{H:0,S:0,L:255},key:l.eb.lt1},{hsl:{H:0,S:0,L:242},lumMod:95e3,tips:"5%",key:l.eb.lt1},{hsl:{H:0,S:0,L:216},lumMod:85e3,tips:"15%",key:l.eb.lt1},{hsl:{H:0,S:0,L:191},lumMod:75e3,tips:"25%",key:l.eb.lt1},{hsl:{H:0,S:0,L:165},lumMod:65e3,tips:"35%",key:l.eb.lt1},{hsl:{H:0,S:0,L:147},lumMod:5e4,tips:"50%",key:l.eb.lt1}],[{hsl:{H:0,S:0,L:0},key:l.eb.dk1},{hsl:{H:0,S:0,L:127},lumMod:5e4,lumOff:5e4,tips:"50%",key:l.eb.dk1},{hsl:{H:0,S:0,L:89},lumMod:65e3,lumOff:35e3,tips:"35%",key:l.eb.dk1},{hsl:{H:0,S:0,L:63},lumMod:75e3,lumOff:25e3,tips:"25%",key:l.eb.dk1},{hsl:{H:0,S:0,L:38},lumMod:85e3,lumOff:15e3,tips:"15%",key:l.eb.dk1},{hsl:{H:0,S:0,L:13},lumMod:95e3,lumOff:5e3,tips:"5%",key:l.eb.dk1}],[{hsl:{H:219.37499999999997,S:46.36363636363637,L:88},key:l.eb.lt2},{hsl:{H:209.99999999999974,S:51.00000000000021,L:244.99999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.lt2},{hsl:{H:218.57142857142858,S:34.99999999999994,L:204},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.lt2},{hsl:{H:217.99999999999997,S:34.15178571428572,L:143},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.lt2},{hsl:{H:217.49999999999994,S:33.44262295081966,L:60.99999999999999},lumMod:75e3,tips:"25%",key:l.eb.lt2},{hsl:{H:221.99999999999994,S:31.09756097560976,L:40.99999999999999},lumMod:5e4,tips:"50%",key:l.eb.lt2}],[{hsl:{H:218.42364532019707,S:230.06666666666672,L:142.5},key:l.eb.dk2},{hsl:{H:216.9230769230769,S:255,L:242},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.dk2},{hsl:{H:217.49999999999994,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.dk2},{hsl:{H:218.23529411764704,S:255,L:204},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.dk2},{hsl:{H:218.0487804878049,S:204.99999999999997,L:102},lumMod:75e3,tips:"25%",key:l.eb.dk2},{hsl:{H:217.9591836734693,S:204.8360655737705,L:61},lumMod:5e4,tips:"50%",key:l.eb.dk2}],[{hsl:{H:200.08163265306112,S:255,L:122.5},key:l.eb.accent1},{hsl:{H:200.7692307692308,S:255,L:242},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent1},{hsl:{H:200.35714285714278,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent1},{hsl:{H:200.00000000000006,S:255,L:204},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent1},{hsl:{H:200.00000000000006,S:204.83606557377053,L:91.5},lumMod:75e3,tips:"25%",key:l.eb.accent1},{hsl:{H:199.75609756097555,S:204.99999999999997,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent1}],[{hsl:{H:147.7358490566038,S:132.5,L:101.99999999999999},key:l.eb.accent2},{hsl:{H:146.25,S:156.92307692307696,L:242},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent2},{hsl:{H:147.69230769230774,S:122.77777777777771,L:214.49999999999997},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent2},{hsl:{H:148.57142857142856,S:112.34265734265738,L:183.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent2},{hsl:{H:148.23529411764704,S:132.9754601226994,L:81.5},lumMod:75e3,tips:"25%",key:l.eb.accent2},{hsl:{H:148.88888888888886,S:135,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent2}],[{hsl:{H:2.1428571428571352,S:183.07692307692307,L:138},key:l.eb.accent3},{hsl:{H:2.6086956521738847,S:255,L:243.49999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent3},{hsl:{H:2.1428571428571352,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent3},{hsl:{H:1.764705882352935,S:255,L:204},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent3},{hsl:{H:1.8181818181818699,S:182.93478260869568,L:92},lumMod:75e3,tips:"25%",key:l.eb.accent3},{hsl:{H:2.4324324324324076,S:184.99999999999997,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent3}],[{hsl:{H:28.151658767772503,S:239.13333333333335,L:142.5},key:l.eb.accent4},{hsl:{H:23.999999999999993,S:255,L:244.99999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent4},{hsl:{H:24.406779661016962,S:255,L:225.5},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent4},{hsl:{H:26.34146341463413,S:255,L:193.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent4},{hsl:{H:27.8048780487805,S:204.99999999999997,L:102},lumMod:75e3,tips:"25%",key:l.eb.accent4},{hsl:{H:27.8048780487805,S:204.99999999999997,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent4}],[{hsl:{H:48.00000000000003,S:255,L:122.5},key:l.eb.accent5},{hsl:{H:47.142857142857096,S:255,L:241},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent5},{hsl:{H:47.56097560975613,S:255,L:214},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent5},{hsl:{H:47.83216783216781,S:255,L:183.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent5},{hsl:{H:47.85276073619637,S:255,L:81.5},lumMod:75e3,tips:"25%",key:l.eb.accent5},{hsl:{H:48.235294117647044,S:255,L:51},lumMod:5e4,tips:"50%",key:l.eb.accent5}],[{hsl:{H:276.98113207547175,S:169.64435146443518,L:135.5},key:l.eb.accent6},{hsl:{H:294,S:255,L:244.99999999999997},lumMod:2e4,lumOff:8e4,tips:"80%",key:l.eb.accent6},{hsl:{H:286.0714285714286,S:255,L:227},lumMod:4e4,lumOff:6e4,tips:"60%",key:l.eb.accent6},{hsl:{H:277.69911504424783,S:255,L:198.5},lumMod:6e4,lumOff:4e4,tips:"40%",key:l.eb.accent6},{hsl:{H:277.89473684210526,S:148.6196319018405,L:81.5},lumMod:75e3,tips:"25%",key:l.eb.accent6},{hsl:{H:278,S:150,L:50.99999999999999},lumMod:5e4,tips:"50%",key:l.eb.accent6}]]},"8400f5339c":function(e,t,i){"use strict";function n(e){for(var t={x:e.rect.x,y:e.rect.y},i=e.parentBox;i;)t.x+=i.rect.x,t.y+=i.rect.y,i=i.parentBox;return t}function r(e){return!/^\s*$/.test(e)}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}))},"89ec4be862":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("05d181ac40"),r="__displaySnapLineDebugContent__";function o(){return!!n.a.IS_TEST&&window[r]}},"8dab50a41c":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),c=i.n(l),s=i("5fac0349d3").a.t("确认刷新么？有离线编辑内容，将在网络恢复后自动保存到服务器，刷新网页后，内容将丢失"),u=function(){function e(t){var i=this;r()(this,e),c()(this,"hasChangesUnSaved",(function(){var e=i.selectionService.selectedElements.selectedArray;return e&&!i.elementChangesSaved(e)})),this.selectionService=t,window.addEventListener("beforeunload",(function(e){if(i.hasChangesUnSaved()){var t=e||window.event;return t&&(t.returnValue=s),s}}))}return a()(e,[{key:"elementChangesSaved",value:function(e){for(var t=!0,i=0;i<e.length;i++){var n,r;if(e[i].changesSaved&&(null===(n=(r=e[i]).changesSaved)||void 0===n||!n.call(r))){t=!1;break}}return t}}]),e}()},"90fcc536a9":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("9132715560"),r=i.n(n),o=i("85d0a7609b"),a=i.n(o),l=function e(){r()(this,e),a()(this,"showCannotCopyTips",void 0),a()(this,"showBrowserNotSupport",void 0)}},"981e82437a":function(e,t,i){"use strict";i.d(t,"e",(function(){return a})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return u}));var n=i("14502724a6"),r=i.n(n),o=(i("a2a09da1e3"),i("759492dad9"),i("fb5ce2c53e"));function a(e){var t=0;-1!==e.indexOf("top")&&(t=1),-1!==e.indexOf("bottom")&&(t=-1);var i=0;return-1!==e.indexOf("left")&&(i=-1),-1!==e.indexOf("right")&&(i=1),[i,t]}function l(e){var t=r()(e,2),i=t[0],n=t[1],o=[];return 0!==i&&o.push(i>0?"right":"left"),0!==n&&o.push(n>0?"top":"bottom"),o.join("-")}function c(e,t){var i=function(e){var t=e*Math.PI/180,i=Math.cos(t);Object(o.a)(i,0)&&(i=0);var n=Math.sin(t);Object(o.a)(n,0)&&(n=0);return{cosRadius:i,sinRadius:n}}(t),n=i.sinRadius,r=i.cosRadius;return[e[0]*r+e[1]*n,-e[0]*n+e[1]*r]}function s(e,t){var i,n=function(e,t){return e[0]*t[0]+e[1]*t[1]}(e,t)/((i=t)[0]*i[0]+i[1]*i[1]);return[n*t[0],n*t[1]]}function u(e,t,i){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]),r=[t[0]/n,t[1]/n],o=i?e/r[0]:e/r[1];return Math.sqrt(o*o-e*e)}},a2cf71de79:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.ALL="serviceAndAllSlides",e.CURRENT="serviceAndCurrentSlide",e.SERVICE="service"}(n||(n={}))},a5efb5f024:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),c=i.n(l),s=(i("8e7cce0ada"),i("c6244f7705"),i("c9a7ecac4d"),i("85d48ef22b"),i("2a6f332b5e"),i("8ee19818c4"),i("d5c3deb8c7")),u=i("e68a50bae6"),d=i("aba9dcef64"),h=i("020899bf26"),f=i("e5a826a0ff"),v=function(){function e(){var t=this;r()(this,e),c()(this,"selectionService",void 0),c()(this,"masterLayoutEditService",void 0),c()(this,"selectedAnims",void 0),c()(this,"lockService",void 0),c()(this,"historyManager",void 0),c()(this,"cursorManager",void 0),c()(this,"registeredSelectedEventCallbacks",new Set),c()(this,"privilegeService",void 0),c()(this,"selectedSlideEventCallback",(function(){var e,i,n,r,o;null===(e=t.selectedAnims)||void 0===e||e.clear();var a,l=null===(i=h.a.PrivilegeManager())||void 0===i?void 0:i.editable;null!==(n=t.historyManager)&&void 0!==n&&n.isShowingHistory||!l||(null===(a=t.lockService)||void 0===a||a.checkLock());null===(r=t.cursorManager)||void 0===r||r.promise().then((function(e){return e.clearCursorTagsForElements()})),null===(o=d.a.CursorManager())||void 0===o||o.reloadCursor(),u.a.isShown()&&u.a.hide()})),c()(this,"selectedElementEventCallback",(function(){t.registeredSelectedEventCallbacks.forEach((function(e){return e()}))}))}return a()(e,[{key:"setSelectionServiceDelegate",value:function(e){var t=this,i=e.selectionService,n=e.privilegeService;this.selectionService||(this.selectionService=i,this.privilegeService=n,Object(s.r)((function(){var e,i;return[null===(e=t.selectionService)||void 0===e?void 0:e.currentSlideIndex,null===(i=t.selectionService)||void 0===i?void 0:i.currentSlideType]}),this.selectedSlideEventCallback),Object(s.r)((function(){var e,i;return[null===(e=t.selectionService)||void 0===e?void 0:e.selectedElements.selectedArrayDic[f.a.SLIDE].length,null===(i=t.selectionService)||void 0===i?void 0:i.selectedElements.selectedArrayDic[f.a.GROUP].length]}),this.selectedElementEventCallback))}},{key:"setMasterLayoutEditServiceDelegate",value:function(e){var t=this;this.masterLayoutEditService||(this.masterLayoutEditService=e,Object(s.r)((function(){var e;return null===(e=t.masterLayoutEditService)||void 0===e?void 0:e.editType}),this.selectedSlideEventCallback))}},{key:"setSelectedAnimManagerDelegate",value:function(e){this.selectedAnims||(this.selectedAnims=e)}},{key:"setLockServiceDelegate",value:function(e){this.lockService||(this.lockService=e)}},{key:"setHistoryManagerDelegate",value:function(e){this.historyManager||(this.historyManager=e)}},{key:"setCursorManagerDelegate",value:function(e){this.cursorManager||(this.cursorManager=e)}},{key:"registerSelectedElementEventCallback",value:function(e){this.registeredSelectedEventCallbacks.add(e)}},{key:"unregisterSelectedElementEventCallback",value:function(e){this.registeredSelectedEventCallbacks.delete(e)}}]),e}()},a845eb4b3e:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n,r,o,a,l=i("1f925d7f50"),c=i.n(l),s=i("9132715560"),u=i.n(s),d=i("6a364eb35c"),h=i.n(d),f=i("85d0a7609b"),v=i.n(f),p=i("2dc700e1e6"),m=i.n(p),b=(i("f1054791f4"),i("8e7cce0ada"),i("29f8c5f672"),i("c6244f7705"),i("85d48ef22b"),i("2a6f332b5e"),i("081c8cafea"),i("8a35b54c1d"),i("b8217400dc"),i("e6f68cdf2e"),i("6e20b6a7d8"),i("a2a09da1e3"),i("63513d8b56"),i("75563bc376"),i("3bf1976a4f"),i("8ee19818c4"),i("22569efd03"),i("d5c3deb8c7")),y=i("2d65cb09dc"),g=i("f8fc8e0087"),S=i("6d35c5a9da"),T=i("57050a8a99"),k=i("a9d1a34b6a"),O=i("37091e4240"),E=i("01583ddc81"),C=i("0e41c725b0"),A=i("020899bf26"),R=(n=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),r=function(){function e(){var t=this;u()(this,e),c()(this,"visibleSlideKeyList",o,this),c()(this,"isWorkbenchReady",a,this),v()(this,"selectionService",void 0),v()(this,"uiDataService",void 0),v()(this,"snapShotNotification",void 0),v()(this,"ttiReport",void 0),v()(this,"entrySlideRenderCostMap",void 0),v()(this,"editSlideRenderCompleteMap",void 0),v()(this,"visibleSlideRenderComplete",void 0),v()(this,"firstSlideRenderComplete",void 0),v()(this,"allThumbnailSiteComplete",void 0),v()(this,"allSlideConvertComplete",void 0),v()(this,"pageSize",void 0),v()(this,"listPanelSize",void 0),v()(this,"listCellFirstLoadTimeArr",[]),this.visibleSlideKeyList=new Array,this.entrySlideRenderCostMap=new Map,this.editSlideRenderCompleteMap=new Map,this.visibleSlideRenderComplete={},this.visibleSlideRenderComplete.promise=new Promise((function(e){t.visibleSlideRenderComplete.resolve=e})),this.firstSlideRenderComplete={},this.firstSlideRenderComplete.promise=new Promise((function(e){t.firstSlideRenderComplete.resolve=e})),this.allThumbnailSiteComplete={},this.allThumbnailSiteComplete.promise=new Promise((function(e){t.allThumbnailSiteComplete.resolve=e})),this.allSlideConvertComplete={},this.allSlideConvertComplete.promise=new Promise((function(e){t.allSlideConvertComplete.resolve=e})),this.mountSnapShotPlugin(),this.mountTtiReportPlugin(),this.observeSlideConverted()}return h()(e,[{key:"getVisiblePageDisplayPromise",value:function(){return this.visibleSlideRenderComplete.promise}},{key:"isVisiblePageDisplay",get:function(){return!!this.visibleSlideRenderComplete.firstTime}},{key:"getFirstPageDisplayPromise",value:function(){return this.firstSlideRenderComplete.promise}},{key:"isFirstPageDisplay",get:function(){return!!this.firstSlideRenderComplete.firstTime}},{key:"getAllThumbnailSiteCompletePromise",value:function(){return this.allThumbnailSiteComplete.promise}},{key:"isAllThumbnailSiteComplete",get:function(){return!!this.allThumbnailSiteComplete.firstTime}},{key:"getAllSlideConvertCompletePromise",value:function(){return this.allSlideConvertComplete.promise}},{key:"isAllSlideConvertComplete",get:function(){return!!this.allSlideConvertComplete.firstTime}},{key:"getEditSlideRenderCompletePromiseByModel",value:function(e){var t=this.editSlideRenderCompleteMap.get(e.key);return t||((t={}).promise=new Promise((function(e){t&&(t.resolve=e)})),this.editSlideRenderCompleteMap.set(e.key,t)),t.promise}},{key:"getImgLoadCompletePromiseByModel",value:function(e){return k.a.promiseModelTreeImgLoaded(e)}},{key:"getVisibleSlideImgLoadCompletePromise",value:function(){var e,t,i=this,n=(null===(e=this.uiDataService)||void 0===e||null===(t=e.presentation)||void 0===t?void 0:t.children.filter((function(e){return i.visibleSlideKeyList.includes(e.key)})))||[];return Promise.all(n.map((function(e){return i.getImgLoadCompletePromiseByModel(e)})))}},{key:"setSelectionServiceDelegate",value:function(e){var t;this.selectionService||(this.selectionService=e,null===(t=this.snapShotNotification)||void 0===t||t.setSelectionServiceDelegate(e))}},{key:"setUiDataServiceDelegate",value:function(e){this.uiDataService||(this.uiDataService=e)}},{key:"setPageSize",value:function(e){if(this.pageSize=e,0===e){var t=Math.round(performance.now());return this.notifyVisibleSlideRenderCompleted(t,y.a.UNKNOWN),void this.notifyFirstSlideRenderCompleted(t,y.a.UNKNOWN)}}},{key:"setListPanelSize",value:function(e,t){this.listPanelSize=e,this.analyseAllThumbnailSiteComplete(Math.round(performance.now()),t)}},{key:"addVisibleSlide",value:function(e){this.visibleSlideKeyList.includes(e.key)||this.visibleSlideKeyList.push(e.key)}},{key:"removeVisibleSlide",value:function(e){var t=this.visibleSlideKeyList.indexOf(e.key);t>=0&&this.visibleSlideKeyList.splice(t,1)}},{key:"setSlideRenderCompleted",value:function(e,t){var i=e.options.slideModel;if(null!=i&&i.childrenConverted&&!i.preload&&e.hasBuild){var n=this.getRenderSlideKey(t,i.key);if(this.entrySlideRenderCostMap.set(n,performance.now()),void 0!==this.pageSize){var r=Math.round(performance.now());this.analyseFirstSlideRenderComplete(r,t),this.analyseVisibleSlideRenderComplete(r,t,i),this.analyseEditComplete(r,t,i)}}}},{key:"resetEditSlideRenderCompletePromise",value:function(e){var t,i=null===(t=this.uiDataService)||void 0===t?void 0:t.presentation.children.find((function(t){return t.key===e})),n=this.editSlideRenderCompleteMap.get(e);i&&null!=n&&n.latestTime&&(n.latestTime=void 0,n.promise=new Promise((function(e){n&&(n.resolve=e)})))}},{key:"getPageSize",value:function(){return this.pageSize}},{key:"getListCellFirstLoadTimeArr",value:function(){return this.listCellFirstLoadTimeArr}},{key:"mountSnapShotPlugin",value:function(){"1"===Object(g.getQuery)("isSnapshotEnv")&&(this.snapShotNotification=new S.a(this))}},{key:"mountTtiReportPlugin",value:function(){this.ttiReport=new T.a(this)}},{key:"observeSlideConverted",value:function(){var e=this;O.b.onIncludingPast(O.a.MASTER_LAYOUT_CONVERTED,(function(){var t;null===(t=A.a.ContentStatusManager())||void 0===t||t.waitForDocumentReady().then((function(){e.notifyAllSlideConvertCompleted(Math.round(performance.now()),y.a.UNKNOWN)}))}))}},{key:"getRenderSlideKey",value:function(e,t){return"".concat(t||"","-").concat(e)}},{key:"analyseVisibleSlideRenderComplete",value:function(e,t,i){var n,r,o,a=this;if(![y.a.EDIT_PC,y.a.EDIT_MOBILE].includes(t)){var l=null===(n=this.selectionService)||void 0===n||null===(r=n.currentSlide)||void 0===r?void 0:r.key,c=!0;[y.a.PLAYER_EDIT_MOBILE,y.a.PLAYER_EDIT_PC].includes(t)&&(this.entrySlideRenderCostMap.has(this.getRenderSlideKey(t,l))||(c=!1)),[y.a.THUMBNAIL_PC,y.a.THUMBNAIL_MOBILE].includes(t)&&((this.pageSize||0)>1&&(this.listPanelSize||0)<=1&&(c=!1),this.visibleSlideKeyList.forEach((function(e){a.entrySlideRenderCostMap.has(a.getRenderSlideKey(t,e))||(c=!1)})));var s=(null===(o=i.parent)||void 0===o?void 0:o.children.findIndex((function(e){return e===i})))||0;this.listCellFirstLoadTimeArr[s]=this.listCellFirstLoadTimeArr[s]||e,c&&this.notifyVisibleSlideRenderCompleted(e,t)}}},{key:"analyseFirstSlideRenderComplete",value:function(e,t){var i;null!==(i=this.firstSlideRenderComplete)&&void 0!==i&&i.firstTime||this.notifyFirstSlideRenderCompleted(e,t)}},{key:"analyseAllThumbnailSiteComplete",value:function(e,t){var i;null!==(i=this.allThumbnailSiteComplete)&&void 0!==i&&i.firstTime||this.listPanelSize===this.pageSize&&this.notifyAllThumbnailSiteCompleted(e,t)}},{key:"analyseEditComplete",value:function(e,t,i){if(![y.a.THUMBNAIL_PC,y.a.THUMBNAIL_MOBILE,y.a.PLAYER_THUMBNAIL_MOBILE,y.a.PLAYER_THUMBNAIL_PC].includes(t)){var n,r,o=this.editSlideRenderCompleteMap.get(i.key);if(null==o||!o.latestTime)if(o)o.latestTime=e,o.firstTime=null!==(n=o.firstTime)&&void 0!==n?n:e,null===(r=o.resolve)||void 0===r||r.call(o,{time:e,entry:t});else this.editSlideRenderCompleteMap.set(i.key,{firstTime:e,latestTime:e,promise:Promise.resolve({time:e,entry:t})})}}},{key:"notifyVisibleSlideRenderCompleted",value:function(e,t){var i=this;this.visibleSlideRenderComplete.firstTime||(this.visibleSlideRenderComplete.firstTime=e,setTimeout((function(){var n,r,o;null===(n=(r=i.visibleSlideRenderComplete).resolve)||void 0===n||n.call(r,{time:e,entry:t}),O.b.emit(O.a.VISIBLE_PAGE_DISPLAY),null===(o=window.log)||void 0===o||o.info("[tti-notifyVisibleSlideRenderCompleted]",e,t)}),0))}},{key:"notifyAllThumbnailSiteCompleted",value:function(e,t){var i=this;this.allThumbnailSiteComplete.firstTime||(this.allThumbnailSiteComplete.firstTime=e,setTimeout((function(){var n,r,o;null===(n=(r=i.allThumbnailSiteComplete).resolve)||void 0===n||n.call(r,{time:e,entry:t}),O.b.emit(O.a.ALL_THUMBNAIL_SITE_COMPLETE),null===(o=window.log)||void 0===o||o.info("[tti-notifyAllThumbnailSiteCompleted]",e,t)}),0))}},{key:"notifyAllSlideConvertCompleted",value:function(e,t){var i,n,r;this.allSlideConvertComplete.firstTime||(this.allSlideConvertComplete.firstTime=e,null===(i=(n=this.allSlideConvertComplete).resolve)||void 0===i||i.call(n,{time:e,entry:t}),O.b.emit(O.a.ALL_SLIDE_DATA_CONVERT),null===(r=window.log)||void 0===r||r.info("[tti-notifyAllSlideConvertCompleted]",e,t))}},{key:"notifyFirstSlideRenderCompleted",value:function(e,t){var i=this;this.firstSlideRenderComplete.firstTime||(this.firstSlideRenderComplete.firstTime=e,Object(E.a)(),setTimeout((function(){var n,r,o,a;null===(n=(r=i.firstSlideRenderComplete).resolve)||void 0===n||n.call(r,{time:e,entry:t}),O.b.emit(O.a.FIRST_PAGE_DISPLAY),window.dispatchEvent(new Event("first-page-display")),C.e.invokeDocx("firstLoadFinished"),null===(o=window.firstScreenBrandLoading)||void 0===o||o.hide(),null===(a=window.log)||void 0===a||a.info("[tti-notifyFirstSlideRenderCompleted]",e,t)}),0))}}]),e}(),o=m()(r.prototype,"visibleSlideKeyList",[b.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=m()(r.prototype,"isWorkbenchReady",[b.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r)},b1ad530fa6:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return u}));var n,r=i("9132715560"),o=i.n(r),a=i("6a364eb35c"),l=i.n(a),c=i("85d0a7609b"),s=i.n(c);!function(e){e.Title="title",e.Content="content"}(n||(n={}));var u=function(){function e(t,i){o()(this,e),s()(this,"text",void 0),s()(this,"level",void 0),s()(this,"contentBlock",void 0),s()(this,"titleOrContent",void 0),this.text=t,this.contentBlock=i,this.level=0,this.titleOrContent=n.Content}return l()(e,[{key:"toMarkdownString",value:function(){for(var e=this.titleOrContent===n.Title?"(标题)":"(正文)",t="",i=0;i<=this.level;i++)t+="#";return e+t+this.text}},{key:"setTitleOrContent",value:function(e){var t=this.contentBlock.getRect();t.top+t.height<=e+30&&(this.titleOrContent=n.Title)}}]),e}()},b66b5ce3da:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n,r,o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),c=i.n(l),s=i("85d0a7609b"),u=i.n(s),d=(i("1bab7b5fb7"),i("0aeae65bf4"),i("826dc923b3"),i("4f3b15d017"));!function(e){e[e.noVip=1]="noVip",e[e.normalVip=2]="normalVip",e[e.superVip=3]="superVip",e[e.superVipPlus=4]="superVipPlus"}(n||(n={})),function(e){e.theme1="1"}(r||(r={}));var h=function(){function e(){a()(this,e),u()(this,"getIsSuperVip",(function(){var e=window.VipInfo;return 3===(null==e?void 0:e.vipLevel)||4===(null==e?void 0:e.vipLevel)})),u()(this,"getUseSVipTheme",(function(){var e,t,i=window.basicClientVars;return"1"===(null==i||null===(e=i.userInfo)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.vipTheme)}))}return c()(e,[{key:"getIsVipTheme",value:function(){if(d.default.isTencentDocsApp){var e,t,i,r,o=null!==(e=null===(t=navigator.userAgent.match(/VipLevel\/(\d+)/))||void 0===t?void 0:t[1])&&void 0!==e?e:0,a=null!==(i=null===(r=navigator.userAgent.match(/VipTheme\/(\d+)/))||void 0===r?void 0:r[1])&&void 0!==i?i:n.noVip;return!(Number(o)!==n.superVip&&Number(o)!==n.superVipPlus||!Number(a))}return this.getIsSuperVip()&&this.getUseSVipTheme()}}]),e}()},b7888730ab:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("9132715560"),r=i.n(n),o=i("6a364eb35c"),a=i.n(o),l=i("85d0a7609b"),c=i.n(l),s=(i("963f2eaace"),i("3bf1976a4f"),i("8e7cce0ada"),i("c6244f7705"),i("081c8cafea"),i("85d48ef22b"),i("2a6f332b5e"),i("d9812f1c6f")),u=i("3825cc7c15"),d=i("b0c77d1072"),h=i.n(d),f=i("f8fc8e0087"),v=i("5fac0349d3"),p=i("020899bf26"),m=i("37091e4240"),b=i("db0c73f5df"),y=function(){function e(){var t=this;r()(this,e),c()(this,"formatText",(function(e){for(var t="",i=0;i<e.oplist.length;i++){var n=e.oplist[i].nickname;if("string"==typeof n){var r=n.length>10?10:n.length;if(t.length+r>30){t=t.slice(0,-1),t=v.a.t("{0}等{1}人修改过该文档。",{0:t,1:e.user_count});break}n.length>10&&(n="".concat(n.slice(0,10),"...")),t=i===e.oplist.length-1?v.a.t("{0}{1}修改过该文档。",{0:t,1:n}):"".concat(t).concat(n,"、")}}return s.a.isIPad&&(t=t.slice(0,-1),t="".concat(t).concat(v.a.t("，可在PC端".concat(window.hostname,"查看修订记录。")))),t})),c()(this,"showSnackbar",(function(e){if(e.oplist){var n=t.formatText(e);s.a.isIPad?Promise.resolve().then(i.t.bind(null,"82f2dc9440",7)).then((function(e){e.default.show({message:n,autoClose:!0,type:"info",duration:6e3})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})):s.a.isMobile?Promise.resolve().then(i.t.bind(null,"b74ee0edd6",7)).then((function(e){e.default.show({message:n,autoClose:!0,type:"info",duration:6e3})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))})):Promise.resolve().then(i.t.bind(null,"82f2dc9440",7)).then((function(e){e.default.show({message:n,action:v.a.t("查看修订记录"),autoClose:!1,closable:!0,type:"info",onClickAction:function(){try{window.tdwReport({opername:"doc_update_notify",module:"doc_update_notify_toast",action:"clk_update_revise"})}catch(e){window.log.error("[tdwReport]".concat(e))}},onClose:function(){try{window.tdwReport({opername:"doc_update_notify",module:"doc_update_notify_toast",action:"clk_update_close"})}catch(e){window.log.error("[tdwReport]".concat(e))}}})})).catch((function(e){window.log.error("[loadChunk-error]".concat(e))}))}}))}return a()(e,[{key:"init",value:function(){var e=this,t=Object(f.getQuery)("u_n_source"),i=Object(u.e)(window.location.href,"u_n_source");if(window.history.replaceState(null,"",i),t){try{window.tdwReport({opername:"doc_update_notify",module:"doc_update_notify_channe",action:{1:"update_notify_tdoc",2:"update_notify_qq",3:"update_notify_app",4:"update_notify_wechat"}[t]})}catch(e){}m.b.on(m.a.FIRST_PAGE_DISPLAY,(function(){var t,i;2!==(null===(t=p.a.DocInfoManager())||void 0===t?void 0:t.policy)&&(null===(i=e.getModifier())||void 0===i||i.then((function(t){e.showSnackbar(t)})))}))}}},{key:"getModifier",value:function(){if(window.clientVars)return new Promise((function(e,t){h.a.ajax({url:"//".concat(window.hostname,"/cgi-bin/online_docs/oplist_digest_get"),xhrFields:{withCredentials:!0},ajaxType:"get",param:{domain_id:window.clientVars.domainId,pad_id:window.clientVars.padId,xsrf:Object(b.b)()},success:function(i){0===i.retcode?e(i):t()},error:function(e){t(e)}})}))}}]),e}()},b7b86f256a:function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return s}));var n,r,o=i("9132715560"),a=i.n(o),l=i("85d0a7609b"),c=i.n(l);!function(e){e[e.Search=1]="Search",e[e.Replace=2]="Replace"}(n||(n={})),function(e){e.Last="last",e.Next="next"}(r||(r={}));var s=function e(){a()(this,e),c()(this,"pageIndex",void 0),c()(this,"component",void 0),c()(this,"offset",void 0)}},be2e9cb2a5:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("176815363d"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),c=i.n(l),s=i("85d0a7609b"),u=i.n(s),d=i("3ef2352f0b"),h=i.n(d),f=(i("c6244f7705"),i("081c8cafea"),i("8ee19818c4"),i("3bf1976a4f"),i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("bcb5d93d36"),i("e0e8dd9366")),v=i("eabf3daf43"),p=i("2a5f3314a4"),m=i("ce428b7e85"),b=i("9789b08c01"),y=i("609550d527");function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){u()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var T=function(){function e(t){a()(this,e),u()(this,"uiDataService",void 0),this.uiDataService=t}var t;return c()(e,[{key:"enumerateWithCallback",value:(t=r()(h.a.mark((function e(t,i){var n,r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(i||{}).customUiDataService,o=r||this.uiDataService,e.next=4,o.forceConvertSlides(o.presentation.children);case 4:return null===(n=t.onStartEnumerate)||void 0===n||n.call(t),e.next=7,this.enumerateUiDataWithAllText(null==t?void 0:t.slideStartCallback,null==t?void 0:t.slideEndCallback,null==t?void 0:t.presentationEndCallback,null==t?void 0:t.elementCallback,null==t?void 0:t.tableCellCallback,null==t?void 0:t.textBlockParentBoxCallback,null==t?void 0:t.textParagraphParentBoxCallback,null==t?void 0:t.textLineParentBoxCallback,null==t?void 0:t.textElementBoxCallback,i);case 7:case"end":return e.stop()}}),e,this)}))),function(e,i){return t.apply(this,arguments)})},{key:"enumerateWithCallbackSync",value:function(e,t){var i;null===(i=e.onStartEnumerate)||void 0===i||i.call(e),this.enumerateUiDataWithAllText(null==e?void 0:e.slideStartCallback,null==e?void 0:e.slideEndCallback,null==e?void 0:e.presentationEndCallback,null==e?void 0:e.elementCallback,null==e?void 0:e.tableCellCallback,null==e?void 0:e.textBlockParentBoxCallback,null==e?void 0:e.textParagraphParentBoxCallback,null==e?void 0:e.textLineParentBoxCallback,null==e?void 0:e.textElementBoxCallback,t)}},{key:"enumerateUiDataWithAllText",value:function(e,t,i,n,r,o,a,l,c,s){var u=this,d=s||{},h=d.customUiDataService,f=d.slideModelList,v=h||this.uiDataService,p=f||v.slideModelList,m=v.presentation;null==p||p.forEach((function(i,d){var h,f,v={slide:i,slideIndex:d};null==e||e(v);var p=null===(h=m.getMasterChildrenOmitPLByModel)||void 0===h?void 0:h.call(m,i),b=null===(f=m.getLayoutChildrenOmitPLByModel)||void 0===f?void 0:f.call(m,i);p&&u.enumerateUiDataElementsWithAllText(v,p,n,r,o,a,l,c,s),b&&u.enumerateUiDataElementsWithAllText(v,b,n,r,o,a,l,c,s),u.enumerateUiDataElementsWithAllText(v,i.children,n,r,o,a,l,c,s),null==t||t(v)})),null==i||i(m)}},{key:"enumerateUiDataElementsWithAllText",value:function(e,t,i,n,r,o,a,l,c){var s=this;t.forEach((function(t,u){if(!t.hidden||null==c||!c.stopEnumerateHiddenElement)if(t.type===f.d.GROUP)s.enumerateGroupWithAllText(e,t,[u],i,r,o,a,l,c);else if(t.type===f.d.TABLE){null==i||i({element:t,path:[u],slideNode:e});for(var d=t,h=function(i){var r=d.tableItems[i];null==r||r.forEach((function(r,o){null==n||n({path:[u,i,o],element:t,cell:r,slideNode:e,col:o,row:i})}))},v=0;v<d.tableItems.length;v++)h(v)}else s.enumerateLeafElementWithAllText(e,t,[u],i,r,o,a,l,c)}))}},{key:"enumerateGroupWithAllText",value:function(e,t,i,n,r,o,a,l,c){var s=this;null==n||n({element:t,path:i,slideNode:e}),t.children.forEach((function(t,u){if(!t.hidden||null==c||!c.stopEnumerateHiddenElement){var d=i.concat(u);t.type===f.d.GROUP?s.enumerateGroupWithAllText(e,t,d,n,r,o,a,l,c):s.enumerateLeafElementWithAllText(e,t,d,n,r,o,a,l,c)}}))}},{key:"enumerateLeafElementWithAllText",value:function(e,t,i,n,r,o,a,l,c){if(null==n||n({element:t,path:i,slideNode:e}),t.type===f.d.SHAPE){var s,d=t;if(Object(v.i)(d.paragraphList))return;var h=d.pathParser,m=d.props.style,b=m.width,y=m.height,g=h.getTextRect(b,y)||{left:0,top:0,width:b,height:y},S=this.getTextEditorDataModel(d,g).getEditorValue(),T=Object(p.r)(S,{width:g.width,height:g.height},{preciseMeasurement:!0}),k=[];if(null!=c&&c.stopTextBlockParentBoxCallback)return;null==r||r({element:t,textRect:g,textDocumentElement:S,blockBox:T,path:i,textBoxPath:[],slideNode:e}),Object(p.t)(T,(s={},u()(s,p.b.Paragraph,(function(n,r,a){var l=k.concat(a);null==o||o({element:t,textRect:g,textDocumentElement:S,paraBox:n,path:i,textBoxPath:l,slideNode:e})})),u()(s,p.b.TextLine,(function(n,r,o){var l=k.concat(o);null==a||a({element:t,textRect:g,textDocumentElement:S,lineBox:n,path:i,textBoxPath:l,slideNode:e})})),u()(s,p.b.Text,(function(n,r,o){var a=k.concat(o);null==l||l({element:t,textRect:g,textDocumentElement:S,textBox:n,path:i,textBoxPath:a,slideNode:e})})),s))}}},{key:"getTextEditorDataModel",value:function(e,t){var i={paragraphList:e.paragraphList,textBodyStyle:Object(b.b)(e.textBodyStyle),model:e,modelKey:e.key,isTitle:e.isTitleOrCtrTitlePl,textRect:t};return new m.a(S(S({},i),{},{resizeLevel:y.a.getResizeLevel(i),noSaveRawData:!0}))}}]),e}()},bf30dec95c:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n,r,o,a,l,c=i("1f925d7f50"),s=i.n(c),u=i("9132715560"),d=i.n(u),h=i("85d0a7609b"),f=i.n(h),v=i("2dc700e1e6"),p=i.n(v),m=(i("f1054791f4"),i("d5c3deb8c7")),b=(n=function e(){d()(this,e),s()(this,"isEditorTextExpanded",r,this),s()(this,"isEditorTextSelecting",o,this),s()(this,"isEditorTextMouseDown",a,this),s()(this,"editorContentChangeFlag",l,this),f()(this,"isTextPreview",!1),f()(this,"isSlateEditing",!1)},r=p()(n.prototype,"isEditorTextExpanded",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=p()(n.prototype,"isEditorTextSelecting",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=p()(n.prototype,"isEditorTextMouseDown",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=p()(n.prototype,"editorContentChangeFlag",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),n)},c021ec9870:function(e,t,i){"use strict";i.d(t,"a",(function(){return le}));var n,r,o,a,l,c,s,u,d,h,f,v,p,m,b,y,g,S,T,k,O,E=i("1f925d7f50"),C=i.n(E),A=i("9132715560"),R=i.n(A),w=i("6a364eb35c"),L=i.n(w),x=i("85d0a7609b"),M=i.n(x),I=i("2dc700e1e6"),P=i.n(I),B=(i("f1054791f4"),i("8ee19818c4"),i("c554310b5c"),i("d5c3deb8c7")),D=(i("a2a09da1e3"),i("63513d8b56"),n=Reflect.metadata("design:type","undefined"==typeof Array?Object:Array),r=function(){function e(){R()(this,e),C()(this,"_selectedArray",o,this)}return L()(e,[{key:"length",get:function(){return this.selectedArray.length}},{key:"selectedArray",get:function(){return this._selectedArray}},{key:"add",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(B.w)((function(){i.forEach((function(t){t&&!1===e._findItem(t)&&(t.selected=!0,e.selectedArray.push(t))}))}))}},{key:"remove",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(B.w)((function(){i.forEach((function(t){t.selected=!1;var i=e.selectedArray.indexOf(t);-1!==i&&e.selectedArray.splice(i,1)}))}))}},{key:"objectAtIndex",value:function(e){return this.selectedArray[e]}},{key:"indexOfObject",value:function(e){return e?this.selectedArray.indexOf(e):-1}},{key:"clear",value:function(){var e=this;Object(B.w)((function(){e.selectedArray.forEach((function(e){e.selected=!1})),e.selectedArray.splice(0,e.selectedArray.length)}))}},{key:"clearAndAdd",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(B.w)((function(){e.selectedArray.forEach((function(e){e.selected=!1})),e.selectedArray.splice(0,e.selectedArray.length),i.forEach((function(t){t.selected=!0,e.selectedArray.push(t)}))}))}},{key:"sortSelectedArray",value:function(e,t){var i=[];if(t.some((function(e){return e.isMaster})))return i;for(var n=t.length&&t.every((function(e){return e.isLayout})),r=n?e.layoutList:e.children,o=0;o<r.length;o++)for(var a=r[o],l=0;l<t.length;l++){var c=t[l];if(a===c){i.push(c);break}}return i}},{key:"_findItem",value:function(e){return-1!==this._selectedArray.indexOf(e)}}]),e}(),o=P()(r.prototype,"_selectedArray",[B.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),r),F=D,_=i("7a5536c9bf"),N=i.n(_),j=(i("342844cefa"),i("e0e8dd9366")),G=i("70c9433299"),H=i("0e4dc96964"),z=i("b684da8955"),V=i("e5a826a0ff"),W=i("ec5cae33cb"),U=(a=function(){function e(t){R()(this,e),C()(this,"selectedArrayDic",l,this),M()(this,"selectionService",void 0),this.selectionService=t}return L()(e,[{key:"selectedArray",get:function(){return this.selectedArrayForType(V.a.GROUP).length>0?this.selectedArrayForType(V.a.GROUP):this.selectedArrayForType(V.a.SMART_ART).length>0?this.selectedArrayForType(V.a.SMART_ART):this.selectedArrayForType(V.a.SLIDE).length>0?this.selectedArrayForType(V.a.SLIDE):null}},{key:"length",get:function(){var e;return(null===(e=this.selectedArray)||void 0===e?void 0:e.length)||0}},{key:"findRootGroup",value:function(e){var t=e.parent;return Object(z.a)(e,(function(e){t=e})),t}},{key:"isRootGroup",value:function(e,t){return e.length>=1&&this.findRootGroup(e[0])===t}},{key:"isElementInGroup",value:function(e,t){return 1===e.length&&this.findRootGroup(t)===e[0]}},{key:"isIgnoreItem",value:function(e){return!e||this._findItem(e)||e.hidden||!e.selectable}},{key:"add",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(B.w)((function(){i.forEach((function(t){if(!e.isIgnoreItem(t)){var i=e._kind(t),n=e.selectedArrayForType(V.a.GROUP)||[],r=e.selectedArrayForType(V.a.SLIDE)||[];e.selectedArrayForType(V.a.SMART_ART);i!==V.a.SLIDE||e.isRootGroup(n,t)||e.remove.apply(e,N()(n)),i===V.a.GROUP&&r.length&&!e.isElementInGroup(r,t)||(t.selected=!0,e.selectedArrayForType(i).push(t))}}))}))}},{key:"remove",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];Object(B.w)((function(){i.forEach((function(t){var i=e.selectedArrayForType(e._kind(t)),n=i.indexOf(t);-1!==n&&(t.selected=!1,i.splice(n,1))}))}))}},{key:"selectedArrayForType",value:function(e){return this.selectedArrayDic[e]}},{key:"clear",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(B.w)((function(){if(t){var i=e.selectedArrayDic[t];i.forEach((function(e){e.selected=!1})),i.splice(0,i.length)}else{Object.keys(e.selectedArrayDic).forEach((function(t){var i=e.selectedArrayDic[t];i.forEach((function(e){e.selected=!1})),i.splice(0,i.length)}))}}))}},{key:"_kind",value:function(e){var t=e.parent;switch(Object(z.a)(e,(function(e){t=e})),t.type){case j.d.SLIDE:case j.d.MASTER:case j.d.LAYOUT:return V.a.SLIDE;case j.d.GROUP:return V.a.GROUP;case j.d.SMART_ART:return V.a.SMART_ART;default:throw new Error(" SelectedEleManager item Type Error !")}}},{key:"_findItem",value:function(e){return-1!==this.selectedArrayForType(this._kind(e)).indexOf(e)}},{key:"getCurrentModel",value:function(){var e,t=null;if(this.selectionService.lastMouseDownRegion===W.a.NOTE&&0===this.length&&(t=null===(e=this.selectionService.currentSlide)||void 0===e?void 0:e.noteData))return t;var i=this.length;if(0===i)t=new G.a({}),t=new Proxy(t,G.b);else if(1===i){var n;t=null===(n=this.selectionService.selectedElements.selectedArray)||void 0===n?void 0:n[0]}else t=new H.a({selectedModels:this.selectedArray||[],selectionService:this.selectionService});return t}},{key:"getSortedSelectedArray",value:function(){var e,t=this;if(!this.selectedArray||0===this.selectedArray.length)return[];var i=this.selectedArrayForType(V.a.SLIDE)||[],n=this.selectedArray[0];if(this.isElementInGroup(i,n)){e=[];var r=this.findRootGroup(n);Object(z.b)(r,(function(t){e.push(t)}))}else{var o;e=null===(o=n.parent)||void 0===o?void 0:o.children}var a=[];return this.selectedArray.forEach((function(i){t.addElementByLevel(a,e,i)})),a}},{key:"addElementByLevel",value:function(e,t,i){var n=e.length;if(0!==n){for(var r=0,o=n-1;r<=o;){var a,l,c,s,u=Math.floor((r+o)/2),d=e[u],h=null!==(a=null==t||null===(l=t.indexOf)||void 0===l?void 0:l.call(t,d))&&void 0!==a?a:-1;(null!==(c=null==t||null===(s=t.indexOf)||void 0===s?void 0:s.call(t,i))&&void 0!==c?c:-1)<h?o=u-1:r=u+1}e.splice(r,0,i)}else e.push(i)}}]),e}(),l=P()(a.prototype,"selectedArrayDic",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e;return e={},M()(e,V.a.SLIDE,[]),M()(e,V.a.GROUP,[]),M()(e,V.a.SMART_ART,[]),e}}),a),q=U,K=i("14502724a6"),Y=i.n(K),Z=i("176815363d"),J=i.n(Z),X=i("3ef2352f0b"),$=i.n(X),Q=(i("8e7cce0ada"),i("29f8c5f672"),i("c6244f7705"),i("85d48ef22b"),i("2a6f332b5e"),i("081c8cafea"),i("b8217400dc"),i("e6f68cdf2e"),i("8a35b54c1d"),i("6e20b6a7d8"),i("963f2eaace"),i("22569efd03"),i("75563bc376"),i("3bf1976a4f"),i("477433b002")),ee=i("fe82ecf3fc"),te=i("7c46f42788"),ie=i("1288bffff3"),ne=i("020899bf26"),re=i("fab0b2fcc7"),oe=function(){function e(t){var i=this;R()(this,e),M()(this,"selectionService",void 0),M()(this,"masterLayoutEditService",void 0),M()(this,"commitSelectedSnapshotMap",new Map),M()(this,"specialOperate",null),M()(this,"specialOperateExtInfo",null),M()(this,"textSelectionUndoRedo",null),this.selectionService=t,ne.a.SlideAppService.promise().then((function(){i.addCommitChangeListener(),i.addCommandExpireListener()}))}return L()(e,[{key:"setMasterLayoutEditServiceDelegate",value:function(e){this.masterLayoutEditService||(this.masterLayoutEditService=e)}},{key:"setTextSelectionUndoRedoDelegate",value:function(e){this.textSelectionUndoRedo=e}},{key:"markSpecialOperate",value:function(e,t){var i=this;this.specialOperate=e,this.specialOperateExtInfo=t||null,Promise.resolve().then((function(){i.clearSpecialOperate()}))}},{key:"clearSpecialOperate",value:function(){this.specialOperate=null,this.specialOperateExtInfo=null}},{key:"addCommitChangeListener",value:function(){var e,t=this;null===(e=ne.a.SDKDataServices.EventManager())||void 0===e||e.commandEvents.onUndoRedoChange(function(){var e=J()($.a.mark((function e(i){var n,r,o,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.commandId,r=i.source,o=i.mutationsType,a=t.specialOperate||t.guessOperationType(),[ee.b.Editor].includes(r)&&t.bindSelectedWithCommit(n,a),[ee.b.Editor,ee.b.Undo,ee.b.Redo].includes(r)&&Promise.resolve().then((function(){t.updateUiSelected(n,r,a),t.updateTextSelection(n,r,o)})),t.clearSpecialOperate();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"addCommandExpireListener",value:function(){var e,t=this;null===(e=ne.a.SDKDataServices.EventManager())||void 0===e||e.commandEvents.onClearCommand((function(e){e.forEach((function(e){t.commitSelectedSnapshotMap.delete(e)}))}))}},{key:"bindSelectedWithCommit",value:function(e,t){var i,n,r,o=this.getBeforeSelectedSnapshot();switch(t){case Q.a.addSlide:case Q.a.addLayout:case Q.a.addMaster:r=this.getAddSlideAfterSelectedSnapshot(t);break;case Q.a.removeSlide:case Q.a.removeLayout:case Q.a.removeMaster:r=this.getRemoveSlideAfterSelectedSnapshot(t);break;case Q.a.addElement:r=this.getAddElementAfterSelectedSnapshot();break;case Q.a.removeElement:r=this.getRemoveElementAfterSelectedSnapshot();break;case Q.a.textBlur:r=o=null!==(i=null===(n=this.specialOperateExtInfo)||void 0===n?void 0:n.beforeSelectedSnapshot)&&void 0!==i?i:o;break;default:r=o}this.commitSelectedSnapshotMap.set(e,{beforeSelectedSnapshot:o,afterSelectedSnapshot:r})}},{key:"guessOperationType",value:function(){var e=this.guessOperationWithPage();if(e)return e;if(1===this.getSelectedSlideList().length){var t=this.getAfterCommitElementIdArr(),i=t.uiElementIdArr,n=t.sdkElementIdArr;if(n.length>i.length)return Q.a.addElement;for(var r=0;r<n.length;r++)if(!i.includes(n[r]))return Q.a.addElement;if(n.length<i.length)return Q.a.removeElement}return Q.a.keep}},{key:"getBeforeSelectedSnapshot",value:function(){return{currentSlideType:this.selectionService.currentSlideType,slideIdArr:this.getSelectedSlideList().map((function(e){return(null==e?void 0:e.id)||""})).filter((function(e){return!!e}))||[],slideElementIdArr:this.selectionService.selectedElements.selectedArrayForType(V.a.SLIDE).map((function(e){return(null==e?void 0:e.id)||""})).filter((function(e){return!!e}))||[],groupElementIdArr:this.selectionService.selectedElements.selectedArrayForType(V.a.GROUP).map((function(e){var t;return{rootId:(null===(t=e.rootGroupModel)||void 0===t?void 0:t.id)||"",childId:e.id||""}}))||[]}}},{key:"getAddSlideAfterSelectedSnapshot",value:function(e){var t=this.getAfterCommitSlideIdArr(e),i=t.uiSlideIdArr,n=t.sdkSlideIdArr;return{currentSlideType:this.selectionService.currentSlideType,slideIdArr:n.filter((function(e){return!i.includes(e)})),slideElementIdArr:[],groupElementIdArr:[]}}},{key:"getRemoveSlideAfterSelectedSnapshot",value:function(e){var t,i=this.getAfterCommitSlideIdArr(e),n=i.uiSlideIdArr,r=i.sdkSlideIdArr,o=this.getSelectedSlideList().slice(-1)[0],a=n.findIndex((function(e){return e===(null==o?void 0:o.id)}))||0,l=n.slice(0,a+1),c=n.slice(a+1);return(t=r.find((function(e){return c.includes(e)})))||(t=r.concat().reverse().find((function(e){return l.includes(e)}))),{currentSlideType:this.selectionService.currentSlideType,slideIdArr:t?[t]:[],slideElementIdArr:[],groupElementIdArr:[]}}},{key:"getAddElementAfterSelectedSnapshot",value:function(){var e=this.getAfterCommitElementIdArr(),t=e.uiElementIdArr,i=e.sdkElementIdArr;return{currentSlideType:this.selectionService.currentSlideType,slideIdArr:this.getSelectedSlideList().map((function(e){return(null==e?void 0:e.id)||""})).filter((function(e){return!!e}))||[],slideElementIdArr:i.filter((function(e){return!t.includes(e)})),groupElementIdArr:[]}}},{key:"getRemoveElementAfterSelectedSnapshot",value:function(){var e,t,i,n,r=(null===(e=this.selectionService)||void 0===e||null===(t=e.selectedElements)||void 0===t||null===(i=t.selectedArray)||void 0===i||null===(n=i.map((function(e){return(null==e?void 0:e.id)||""})))||void 0===n?void 0:n.filter((function(e){return!!e})))||[],o=this.getAfterCommitElementIdArr().sdkElementIdArr;return{currentSlideType:this.selectionService.currentSlideType,slideIdArr:this.getSelectedSlideList().map((function(e){return(null==e?void 0:e.id)||""})).filter((function(e){return!!e}))||[],slideElementIdArr:r.filter((function(e){return o.includes(e)})),groupElementIdArr:[]}}},{key:"getAfterCommitSlideIdArr",value:function(e){var t,i=null!==(t=this.getPageTypeAfterCommit(e))&&void 0!==t?t:this.selectionService.currentSlideType,n=this.getSlideList(i),r=n.uiSlideList,o=n.sdkSlideList;return{uiSlideIdArr:r.map((function(e){return e.id||""})).filter((function(e){return!!e})),sdkSlideIdArr:o.map((function(e){return e.id||""})).filter((function(e){return!!e}))}}},{key:"guessOperationWithPage",value:function(){var e,t=this.getSlideList(j.d.SLIDE),i=t.uiSlideList,n=t.sdkSlideList;if(i.length<n.length)return Q.a.addSlide;if(i.length>n.length)return Q.a.removeSlide;if((null===(e=this.masterLayoutEditService)||void 0===e?void 0:e.editType)===ie.a.MASTER_LAYOUT){var r=this.getSlideList(j.d.LAYOUT),o=r.uiSlideList,a=r.sdkSlideList;if(o.length<a.length)return Q.a.addLayout;if(o.length>a.length)return Q.a.removeLayout;var l=this.getSlideList(j.d.MASTER),c=l.uiSlideList,s=l.sdkSlideList;if(c.length<s.length)return Q.a.addMaster;if(c.length>s.length)return Q.a.removeMaster}return null}},{key:"getAfterCommitElementIdArr",value:function(){var e,t,i,n,r,o,a=this.selectionService.currentSlide,l=(null==a||null===(e=a.children)||void 0===e?void 0:e.map((function(e){return e.id||""})).filter((function(e){return!!e})))||[],c=(null==a||null===(t=a.children)||void 0===t||null===(i=t.filter((function(e){return e.type===j.d.GROUP})))||void 0===i?void 0:i.map((function(e){return e.id||""})).filter((function(e){return!!e})))||[],s=null==a?void 0:a.sdkData;return{uiElementIdArr:l,uiGroupElementIdArr:c,sdkElementIdArr:(null==s||null===(n=s.shapeList)||void 0===n?void 0:n.map((function(e){return e.id||""})).filter((function(e){return!!e})))||[],sdkGroupElementIdArr:(null==s||null===(r=s.shapeList)||void 0===r||null===(o=r.filter((function(e){return e.type===te.a.GroupShape})))||void 0===o?void 0:o.map((function(e){return e.id||""})).filter((function(e){return!!e})))||[]}}},{key:"updateUiSelected",value:function(e,t,i){var n=this,r=this.commitSelectedSnapshotMap.get(e);if(r){var o=r.afterSelectedSnapshot;t===ee.b.Undo?o=r.beforeSelectedSnapshot:(t===ee.b.Redo||t===ee.b.Editor)&&(o=r.afterSelectedSnapshot),t===ee.b.Editor&&[Q.a.keep,Q.a.textBlur].includes(i)||Object(B.w)((function(){var e,t,r,a,l,c=o,s=c.currentSlideType,u=c.slideIdArr,d=c.slideElementIdArr,h=c.groupElementIdArr,f=null===(e=n.selectionService.currentSlide)||void 0===e?void 0:e.id,v=null!==(t=n.getPageTypeAfterCommit(i))&&void 0!==t?t:s,p=v===j.d.SLIDE?ie.a.SLIDE:ie.a.MASTER_LAYOUT;n.selectionService.updateCurrentSlideType(v),null===(r=n.masterLayoutEditService)||void 0===r||r.updateEditType(p);var m=n.getSlideList(v).uiSlideList,b=m.filter((function(e){return u.includes(e.id||"")}));n.selectionService.selectedSlides.clear(),(a=n.selectionService.selectedSlides).add.apply(a,N()(b)),b.length&&(n.selectionService.currentSlideIndex=m.findIndex((function(e){return e.id===b[0].id}))),f!==(null===(l=n.selectionService.currentSlide)||void 0===l?void 0:l.id)&&(n.selectionService.preventSelectedElementsClear=!0);var y=Y()(b,1)[0],g=(null==y?void 0:y.children.filter((function(e){return d.includes(e.id||"")&&e.selectable})))||[],S=[],T={};h.forEach((function(e){if(e.rootId){if(!T[e.rootId]){var t=null==y?void 0:y.children.find((function(t){return t.id===e.rootId}));T[e.rootId]=n.flatGroupChildren(t,[])}var i=T[e.rootId].find((function(t){return t.id===e.childId}));null!=i&&i.selectable&&S.push(i)}}));var k=n.selectionService.selectedElements,O=[].concat(N()(g),S),E=[].concat(N()(k.selectedArrayForType(V.a.SLIDE)),N()(k.selectedArrayForType(V.a.GROUP))).filter((function(e){return!O.includes(e)}));k.remove.apply(k,N()(E)),k.add.apply(k,N()(O))}))}}},{key:"updateTextSelection",value:function(e,t,i){var n,r;if(this.textSelectionUndoRedo&&(t===ee.b.Undo||t===ee.b.Redo)&&i.some((function(e){return re.b.includes(e)}))){var o=this.selectionService.selectedElements,a=0===o.length?this.selectionService.currentSlide:o.getCurrentModel();null===(n=(r=this.textSelectionUndoRedo).triggerUndoRedo)||void 0===n||n.call(r,t,e,a)}}},{key:"getPresentation",value:function(){return this.selectionService.uiDataService.presentation}},{key:"getSlideList",value:function(e){var t,i,n;if(e===j.d.SLIDE)t=this.getPresentation().children,i=null===(n=this.getPresentation().sdkData)||void 0===n?void 0:n.slideList;else if(e===j.d.MASTER){var r;t=this.getPresentation().masterList,i=null===(r=this.getPresentation().sdkData)||void 0===r?void 0:r.masterList}else if(e===j.d.LAYOUT){var o;t=this.getPresentation().layoutList,i=null===(o=this.getPresentation().sdkData)||void 0===o?void 0:o.layoutList}return{uiSlideList:t,sdkSlideList:i}}},{key:"getSelectedSlideList",value:function(){var e=this.selectionService.selectedSlides.selectedArray;return!e.length&&this.selectionService.currentSlide&&(e=[this.selectionService.currentSlide]),e}},{key:"flatGroupChildren",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return((null==e?void 0:e.children)||[]).forEach((function(e){i.push(e),e.children&&t.flatGroupChildren(e,i)})),i}},{key:"getPageTypeAfterCommit",value:function(e){var t;return(t={},M()(t,Q.a.addSlide,j.d.SLIDE),M()(t,Q.a.removeSlide,j.d.SLIDE),M()(t,Q.a.addLayout,j.d.LAYOUT),M()(t,Q.a.removeLayout,j.d.LAYOUT),M()(t,Q.a.addMaster,j.d.MASTER),M()(t,Q.a.removeMaster,j.d.MASTER),t)[e]}}]),e}(),ae=oe,le=(c=Reflect.metadata("design:type",Object),s=Reflect.metadata("design:type",void 0===W.a?Object:W.a),u=B.q,d=Reflect.metadata("design:type",Object),h=Reflect.metadata("design:type",Function),f=Reflect.metadata("design:paramtypes",[]),v=Reflect.metadata("design:type",Function),p=Reflect.metadata("design:paramtypes",[]),m=function(){function e(t){R()(this,e),C()(this,"currentSlideType",b,this),C()(this,"currentSlideIndex",y,this),C()(this,"mobileCurrentDisplayIndex",g,this),C()(this,"needClearSelectedSlideClearanceFlag",S,this),C()(this,"slideClearanceIndex",T,this),C()(this,"lastMouseDownRegion",k,this),M()(this,"selectedSlides",void 0),M()(this,"selectedElements",void 0),M()(this,"selectedWithCommit",void 0),M()(this,"preventSelectedElementsClear",void 0),C()(this,"selectedModel",O,this),M()(this,"lastMasterEditPageIndex",0),M()(this,"lastMasterEditSlideType",j.d.MASTER),M()(this,"lastSlideEditPageIndex",0),M()(this,"uiDataService",void 0),this.uiDataService=t,this.selectedSlides=new F,this.selectedElements=new q(this),this.selectedWithCommit=new ae(this),this.preventSelectedElementsClear=!1,this.registerCurrentSlideChange(),this.observeSelectedElements()}return L()(e,[{key:"currentSlide",get:function(){var e;return null===(e=this.slides)||void 0===e?void 0:e[this.currentSlideIndex]}},{key:"slides",get:function(){switch(this.currentSlideType){case j.d.MASTER:return this.uiDataService.masterModelList;case j.d.LAYOUT:return this.uiDataService.layoutModelList;default:return this.uiDataService.slideModelList}}},{key:"clearAll",value:function(){this.selectedSlides.clear(),this.selectedElements.clear()}},{key:"getSelectedModel",value:function(){return this.selectedModel}},{key:"updateCurrentSlideType",value:function(e){this.currentSlideType=e||j.d.SLIDE}},{key:"changeCurrentSlideIndexByUserAction",value:function(e){"number"==typeof e&&(this.currentSlideIndex=e,window.dispatchEvent(new CustomEvent("onCurrentSlideIndexChangeByUserAction")))}},{key:"registerCurrentSlideChange",value:function(){var e=this;Object(B.r)((function(){return e.currentSlide}),(function(){e.preventSelectedElementsClear?e.preventSelectedElementsClear=!1:e.selectedElements.clear()}))}},{key:"observeSelectedElements",value:function(){var e=this;B.r((function(){return{selectedElementsCount:e.selectedElements.length,selectedRegion:e.lastMouseDownRegion}}),(function(t){var i,n;e.selectedModel instanceof H.a&&(null===(i=(n=e.selectedModel).dispose)||void 0===i||i.call(n));var r=null;if(t.selectedRegion===W.a.NOTE&&e.currentSlide){var o;r=null===(o=e.currentSlide)||void 0===o?void 0:o.noteData}else{var a=e.selectedElements.length;if(0===a)r=new G.a({}),r=new Proxy(r,G.b);else if(1===a){var l;r=null===(l=e.selectedElements.selectedArray)||void 0===l?void 0:l[0]}else{var c,s=[];null===(c=e.selectedElements.selectedArray)||void 0===c||c.forEach((function(e){s.push(e)})),r=new H.a({selectedModels:s,selectionService:e})}}e.selectedModel=r||new G.a({})}),{fireImmediately:!0})}}]),e}(),b=P()(m.prototype,"currentSlideType",[B.q,c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return j.d.SLIDE}}),y=P()(m.prototype,"currentSlideIndex",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),g=P()(m.prototype,"mobileCurrentDisplayIndex",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),S=P()(m.prototype,"needClearSelectedSlideClearanceFlag",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),T=P()(m.prototype,"slideClearanceIndex",[B.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),k=P()(m.prototype,"lastMouseDownRegion",[B.q,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return W.a.NONE}}),O=P()(m.prototype,"selectedModel",[u,d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P()(m.prototype,"currentSlide",[B.f,h,f],Object.getOwnPropertyDescriptor(m.prototype,"currentSlide"),m.prototype),P()(m.prototype,"slides",[B.f,v,p],Object.getOwnPropertyDescriptor(m.prototype,"slides"),m.prototype),m)},d1428876ce:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n="text_change_event"},e10f45eba9:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("14502724a6"),r=i.n(n),o=i("176815363d"),a=i.n(o),l=i("9132715560"),c=i.n(l),s=i("6a364eb35c"),u=i.n(s),d=i("85d0a7609b"),h=i.n(d),f=i("3ef2352f0b"),v=i.n(f),p=(i("c6244f7705"),i("081c8cafea"),i("8a35b54c1d"),i("342844cefa"),i("f4e4ed5c17")),m=i("e6d98148ee"),b=i("28bc2be06b"),y=(i("8e7cce0ada"),i("85d48ef22b"),i("2a6f332b5e"),i("5fac0349d3")),g=i("d9812f1c6f"),S=i("e0bb7688be"),T=(b.b,y.a.t("这是一篇腾讯文档，是否添加到企业微信文档？")),k=y.a.t("这是一篇腾讯文档，是否生成副本并添加到企业文档列表？"),O=y.a.t("添加成功，以后打开腾讯文档都默认添加。"),E=i("5ce71228c0"),C=function(){function e(t){var i=this;c()(this,e),h()(this,"syncFileManager",void 0),h()(this,"toastOccasion",void 0),h()(this,"callback",void 0),h()(this,"showSyncToast",(function(e,t){i.toastOccasion=e,i.callback=t;var n=i.syncFileManager.currentSyncType;if(e===b.h.FIRST_SHOW){if(E.b.getItem(E.a.IS_SYNC_LIST))return;E.b.setItem(E.a.IS_SYNC_LIST,n)}n===b.g.NOT?i.showToast():null==t||t()})),h()(this,"handleGuideInterFlowClose",(function(e){Object(S.a)(),i.syncFileManager.currentSyncType=e,i.handleClose()})),h()(this,"handleCurrentFileClick",(function(){i.syncFileManager.updateSyncFileType(b.g.CURRENT).then((function(){if(i.syncFileManager.currentSyncType===b.g.CURRENT){var e={message:i.toastOccasion===b.h.FIRST_SHOW?O:y.a.t("已设置，以后都默认执行该操作。"),action:[{text:y.a.t("暂不")},{text:y.a.t("确定"),onClick:i.handleAllFileClick}],type:"success",onClose:i.handleClose,autoClose:!1};i.showSnackbar(e)}}))})),h()(this,"handleAllFileClick",(function(){i.syncFileManager.updateSyncFileType(b.g.ALL)})),h()(this,"handleCloseWithGenerateCopies",(function(){if(i.toastOccasion===b.h.GENERATE_COPIES){var e={message:y.a.t("生成副本失败"),type:"error"};i.showSnackbar(e)}})),h()(this,"handleClose",(function(){var e;i.syncFileManager.currentSyncType!==b.g.NOT&&(null===(e=i.callback)||void 0===e||e.call(i))})),this.syncFileManager=t}return u()(e,[{key:"showToast",value:function(){if(g.a.isMobile)Object(S.b)({handleClose:this.handleGuideInterFlowClose,isCopy:this.toastOccasion===b.h.GENERATE_COPIES});else{var e={message:this.toastOccasion===b.h.FIRST_SHOW?T:k,action:[{text:y.a.t("暂不"),onClick:this.handleCloseWithGenerateCopies},{text:y.a.t("添加"),onClick:this.handleCurrentFileClick}],onClose:this.handleClose,autoClose:!1};this.showSnackbar(e)}}},{key:"showSnackbar",value:function(e){g.a.isMobile||Promise.resolve().then(i.t.bind(null,"82f2dc9440",7)).then((function(t){t.default.show(e)}))}}]),e}(),A=i("020899bf26"),R=function(){function e(){var t=this;c()(this,e),h()(this,"toast",void 0),h()(this,"event",void 0),h()(this,"currentType",void 0),h()(this,"updateSyncFileType",function(){var e=a()(v.a.mark((function e(i){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i!==t.currentType){e.next=2;break}return e.abrupt("return");case 2:return n={toggleOn:!1,toggleScope:0},i===b.g.ALL?n.toggleOn=!0:i===b.g.CURRENT&&(n.toggleOn=!0,n.toggleScope=1),e.next=6,t.setSyncAllFileFlag(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(this,"getItemDescription",(function(){var e=Object.keys(b.d).filter((function(e){return b.d[e]===t.currentType})),i=r()(e,1)[0];return b.f[i]})),h()(this,"getSyncAllFileFlag",a()(v.a.mark((function e(){var i,n,r,o,a,l,c,s,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={},h()(r,b.i.TOGGLE_TYPE,0),h()(r,b.i.FILE_ID,null!==(i=null===(n=A.a.DocInfoManager())||void 0===n?void 0:n.padId)&&void 0!==i?i:""),o=r,e.next=4,p.a.post(b.a,o);case 4:a=e.sent,0===(l=a.data).retcode&&(c=l.result,s=c.toggleOn,u=c.toggleScope,t.setCurrentType(s,u)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),t.currentType=b.g.NOT,window.log.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))),h()(this,"setSyncAllFileFlag",function(){var e=a()(v.a.mark((function e(i){var n,r,o,a,l,c,s,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.toggleOn,r=i.toggleScope,e.prev=1,l={},h()(l,b.i.TOGGLE_TYPE,0),h()(l,b.i.FILE_ID,null!==(o=null===(a=A.a.DocInfoManager())||void 0===a?void 0:a.padId)&&void 0!==o?o:""),h()(l,b.i.TOGGLE_ON,n),h()(l,b.i.TOGGLE_SCOPE,r),c=l,e.next=5,p.a.post(b.c,c);case 5:s=e.sent,0===(u=s.data).retcode&&"success"===u.msg&&t.setCurrentType(n,r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),window.log.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()),h()(this,"setCurrentType",(function(e,i){t.currentType=e&&0===i?b.g.ALL:e&&1===i?b.g.CURRENT:b.g.NOT})),this.currentType=b.g.NOT,this.event=new m.a,this.toast=new C(this)}return u()(e,[{key:"currentSyncType",get:function(){return this.currentType},set:function(e){this.currentType=e}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();h()(R,"instance",void 0)},e56f7da8d5:function(e,t,i){"use strict";i.d(t,"a",(function(){return re}));i("342844cefa"),i("a84962d637"),i("8a35b54c1d"),i("c554310b5c"),i("8ee19818c4"),i("bcb5d93d36");var n,r,o=i("176815363d"),a=i.n(o),l=i("9132715560"),c=i.n(l),s=i("6a364eb35c"),u=i.n(s),d=i("85d0a7609b"),h=i.n(d),f=i("3ef2352f0b"),v=i.n(f),p=(i("c6244f7705"),i("081c8cafea"),i("6e20b6a7d8"),i("0cf3719522")),m=i.n(p),b=i("7a5536c9bf"),y=i.n(b),g=(i("63513d8b56"),i("eb9e932508"),i("b8217400dc"),i("e6f68cdf2e"),i("3bf1976a4f"),i("826dc923b3"),i("22569efd03"),i("7b0ebf3e1a")),S=i("ce2f431a5a"),T=function(){function e(t,i){c()(this,e),h()(this,"frame",void 0),h()(this,"polygon",void 0),h()(this,"elementNode",void 0),h()(this,"textRect",void 0),this.elementNode=t,this.frame=this.elementNode.element.getFrame().frameOnSlide(),this.textRect=i,this.polygon=this.generatePolygon()}return u()(e,[{key:"distanceTo",value:function(e){return this.polygon.distanceToPolygon(e.polygon)}},{key:"generatePolygon",value:function(){var e;if(this.frame.rotate&&0!==this.frame.rotate){var t={x:(this.frame.left+this.frame.left+this.frame.width)/2,y:(this.frame.top+this.frame.top+this.frame.height)/2};if(this.textRect){var i={left:this.frame.left+this.textRect.left,top:this.frame.top+this.textRect.top,width:this.textRect.width,height:this.textRect.height};e=Object(g.m)(i,this.frame.rotate,t)}else e=Object(g.m)(this.frame,this.frame.rotate,t)}else e=[],this.textRect?(e.push({x:this.frame.left+this.textRect.left,y:this.frame.top+this.textRect.top}),e.push({x:this.frame.left+this.textRect.left+this.textRect.width,y:this.frame.top+this.textRect.top}),e.push({x:this.frame.left+this.textRect.left+this.textRect.width,y:this.frame.top+this.textRect.top+this.textRect.height}),e.push({x:this.frame.left+this.textRect.left,y:this.frame.top+this.textRect.top+this.textRect.height})):(e.push({x:this.frame.left,y:this.frame.top}),e.push({x:this.frame.left+this.frame.width,y:this.frame.top}),e.push({x:this.frame.left+this.frame.width,y:this.frame.top+this.frame.height}),e.push({x:this.frame.left,y:this.frame.top+this.frame.height}));return new S.a(e)}}]),e}(),k=i("e0e8dd9366"),O=i("2ba7871556"),E=i("7ce5f66a4e"),C=i("eabf3daf43"),A=i("10b1eb7899"),R=i("2a5f3314a4"),w=(i("963f2eaace"),i("b1e2246d82"),i("8aebbf296a"),i("f45588a8ad"),i("de37db1287"),i("85d48ef22b"),i("8e7cce0ada"),i("2a6f332b5e"),i("3344f1a2e7")),L=(i("4bbb5840d5"),i("c9a7ecac4d"),i("8400f5339c")),x=i("c95136d545"),M=i.n(x),I=i("dc68b581cd"),P=i("14c02e2331");function B(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(l)throw o}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}!function(e){e.ShapeWithTextAndFillOrStroke="shapeWithTextAndFillOrStroke",e.OnlyTextShape="onlyTextShape",e.Element="element"}(n||(n={})),function(e){e[e.Frame=0]="Frame",e[e.Fill=1]="Fill",e[e.Border=2]="Border",e[e.Effect=3]="Effect",e[e.Text=4]="Text"}(r||(r={}));var F,_=function(){function e(t,i){c()(this,e),h()(this,"rect",void 0),h()(this,"info",void 0),h()(this,"degreeOfCoherence",void 0),h()(this,"children",void 0),h()(this,"listIndex",void 0),h()(this,"_hasText",void 0),h()(this,"_firstFontSize",void 0),h()(this,"_firstFontStyle",void 0),h()(this,"_blockType",void 0),h()(this,"_isLine",void 0),this.rect=t,this.info=i}return u()(e,[{key:"blockType",value:function(){return void 0!==this._blockType?this._blockType:this.info?(this.info.paraBox?this._blockType=n.OnlyTextShape:this.info.blockBox?this._blockType=n.ShapeWithTextAndFillOrStroke:this._blockType=n.Element,this._blockType):n.Element}},{key:"hasText",value:function(){return void 0!==this._hasText||(this._hasText=!!this.info.paraBox||!!this.info.blockBox),this._hasText}},{key:"isLine",value:function(){if(void 0!==this._isLine)return this._isLine;if(this.blockType()===n.Element){var e=this.info;if(e.element.type===k.d.CONNECTOR){var t=e.element;if(t.getFrame().getFrameInfo().height<=0||t.getFrame().getFrameInfo().width<=0){var i,r=null===(i=t.getGraphic().getGraphicLinInfo())||void 0===i?void 0:i.bgLine;if(r===I.a.LINE||r===I.a.STRAIGNTCONNECTOR1)return!0}}}return!1}},{key:"getTextDocument",value:function(){if(this.hasText())return this.info.paraBox||this.info.blockBox?this.info.textDocumentElement:void 0}},{key:"getText",value:function(){if(this.hasText()){var e="";if(this.info.paraBox)this.info.paraBox.children.forEach((function(t){t.children.forEach((function(t){e+=t.text}))}));if(this.info.blockBox)this.info.blockBox.children.forEach((function(t){t.children.forEach((function(t){t.children.forEach((function(t){e+=t.text}))})),e+=""}));return e}}},{key:"getFrame",value:function(){var e;return null===(e=this.info)||void 0===e?void 0:e.element.getFrame().frameOnSlide()}},{key:"getFirstFontSize",value:function(){if(void 0!==this._firstFontSize)return this._firstFontSize;if(!this.hasText())return this._firstFontSize=-1,this._firstFontSize;if(this.info.paraBox){var e,t=B(this.info.paraBox.children);try{for(t.s();!(e=t.n()).done;){var i,n=B(e.value.children);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(Object(L.b)(r.text))return this._firstFontSize=Object(R.u)(r.textStyle.fontSize)/P.p,this._firstFontSize}}catch(e){n.e(e)}finally{n.f()}}}catch(e){t.e(e)}finally{t.f()}}if(this.info.blockBox){var o,a=B(this.info.blockBox.children);try{for(a.s();!(o=a.n()).done;){var l,c=B(o.value.children);try{for(c.s();!(l=c.n()).done;){var s,u=B(l.value.children);try{for(u.s();!(s=u.n()).done;){var d=s.value;if(Object(L.b)(d.text))return this._firstFontSize=Object(R.u)(d.textStyle.fontSize)/P.p,this._firstFontSize}}catch(e){u.e(e)}finally{u.f()}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}}return this._firstFontSize=-1,this._firstFontSize}},{key:"getFirstFontStyle",value:function(){if(void 0!==this._firstFontStyle)return this._firstFontStyle;if(!this.hasText())return this._firstFontStyle=void 0,this._firstFontStyle;if(this.info.paraBox){var e,t=B(this.info.paraBox.children);try{for(t.s();!(e=t.n()).done;){var i,n=B(e.value.children);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(Object(L.b)(r.text))return this._firstFontStyle=r.textStyle,this._firstFontStyle}}catch(e){n.e(e)}finally{n.f()}}}catch(e){t.e(e)}finally{t.f()}}if(this.info.blockBox){var o,a=B(this.info.blockBox.children);try{for(a.s();!(o=a.n()).done;){var l,c=B(o.value.children);try{for(c.s();!(l=c.n()).done;){var s,u=B(l.value.children);try{for(u.s();!(s=u.n()).done;){var d=s.value;if(Object(L.b)(d.text))return this._firstFontStyle=d.textStyle,this._firstFontStyle}}catch(e){u.e(e)}finally{u.f()}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}}return this._firstFontStyle=void 0,this._firstFontStyle}},{key:"isSimilarToOther",value:function(e,t,i){if(this.blockType()!==e.blockType())return!1;if(this.blockType()===n.Element){var o=this.info.element,a=e.info.element;if(o.type!==a.type)return!1;if(!(null!=t&&t.includes(r.Frame)||M()(o.getFrame().frameOnSlide(),a.getFrame().frameOnSlide(),this.customizer)))return!1;if((null==t||!t.includes(r.Fill))&&o.getBackgroundFill().getShownFillType()!==a.getBackgroundFill().getShownFillType())return!1;if((null==t||!t.includes(r.Border))&&o.getBorder().getBorderType()!==a.getBorder().getBorderType())return!1}if(this.blockType()===n.ShapeWithTextAndFillOrStroke){var l=this.info,c=e.info;if(!(null!=t&&t.includes(r.Fill)||M()(l.element.getBackgroundFill().getFillInfo(),c.element.getBackgroundFill().getFillInfo())))return!1;if(!(null!=t&&t.includes(r.Border)||M()(l.element.getBorder().getBorderInfo(),c.element.getBorder().getBorderInfo())))return!1;if(!(null!=t&&t.includes(r.Effect)||M()(l.element.getEffect().getEffectCollection(),c.element.getEffect().getEffectCollection())))return!1}if(this.blockType()===n.ShapeWithTextAndFillOrStroke||this.blockType()===n.OnlyTextShape){var s,u,d,h,f=this.info,v=e.info,p=this.rect,m=e.rect,b=p.left+p.width/2,y=m.left+m.width/2,g=void 0!==i?i:(b+y)/2;if((null==t||!t.includes(r.Frame))&&Math.abs(p.left-m.left)>80&&(Math.abs(b-y)>80||Math.abs(b-g)>80||Math.abs(y-g)>80)&&Math.abs(p.left+p.width-(m.left+m.width))>80)return!1;if((null==t||!t.includes(r.Frame))&&Math.abs(p.top-m.top)>80&&Math.abs(p.top+p.height/2-(m.top+m.height/2))>80&&Math.abs(p.top+p.height-(m.top+m.height))>80)return!1;if((null==t||!t.includes(r.Frame))&&Math.abs(p.height-m.height)>Math.min(p.height,m.height))return!1;var S=null===(s=f.textDocumentElement.children)||void 0===s||null===(u=s[0].children)||void 0===u?void 0:u[0].fontSize,T=null===(d=v.textDocumentElement.children)||void 0===d||null===(h=d[0].children)||void 0===h?void 0:h[0].fontSize;if((null==t||!t.includes(r.Text))&&void 0!==S&&void 0!==T&&Math.abs(T-S)>4)return!1}return!0}},{key:"isSameToOther",value:function(e){if(this.blockType()!==e.blockType())return!1;if(this.blockType()===n.Element){var t=this.info.element,i=e.info.element;if(t.type!==i.type)return!1;if(!M()(t.getFrame().frameOnSlide(),i.getFrame().frameOnSlide()))return!1;if(t.type===k.d.SHAPE){if(t.getBackgroundFill().getShownFillType()!==i.getBackgroundFill().getShownFillType())return!1;if(t.getBorder().getBorderType()!==i.getBorder().getBorderType())return!1}}if(this.blockType()===n.ShapeWithTextAndFillOrStroke){var r=this.info,o=e.info;if(!M()(r.element.getBackgroundFill().getFillInfo(),o.element.getBackgroundFill().getFillInfo()))return!1;if(!M()(r.element.getBorder().getBorderInfo(),o.element.getBorder().getBorderInfo()))return!1;if(!M()(r.element.getEffect().getEffectCollection(),o.element.getEffect().getEffectCollection()))return!1;if(!M()(r.element.getFrame().frameOnSlide(),o.element.getFrame().frameOnSlide()))return!1}if(this.blockType()===n.ShapeWithTextAndFillOrStroke||this.blockType()===n.OnlyTextShape){var a,l,c,s,u=this.info,d=e.info,h=this.rect,f=e.rect;if(Math.abs(h.left-f.left)>1&&Math.abs(h.left+h.width/2-(f.left+f.width/2))>1&&Math.abs(h.left+h.width-(f.left+f.width))>1)return!1;if(Math.abs(h.top-f.top)>1&&Math.abs(h.top+h.height/2-(f.top+f.height/2))>1&&Math.abs(h.top+h.height-(f.top+f.height))>1)return!1;var v=null===(a=u.textDocumentElement.children)||void 0===a||null===(l=a[0].children)||void 0===l?void 0:l[0],p=null===(c=d.textDocumentElement.children)||void 0===c||null===(s=c[0].children)||void 0===s?void 0:s[0];if(v.fontSize!==p.fontSize||null!=v&&v.background)return!1}return!0}},{key:"customizer",value:function(e,t,i,n,r,o){if(["left","top","width","height"].includes(i)&&Math.abs(e-t)<30)return!0;if("text"===i||"origin-data"===i)return!0;if("string"==typeof i&&(null!=i&&i.includes("fonts")||null!=i&&i.includes("fontFamily")||null!=i&&i.startsWith("origin")||null!=i&&i.includes("lang")))return!0;var a=new Set,l=new Set;e&&Object.keys(e).forEach((function(e){return a.add(e)})),t&&Object.keys(t).forEach((function(e){return l.add(e)}));var c=y()(a).filter((function(e){return!l.has(e)})),s=y()(l).filter((function(e){return!a.has(e)}));return 1===c.length&&0===s.length&&"origin-data"===c[0]||1===s.length&&0===c.length&&"origin-data"===s[0]||void 0}}]),e}();function N(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return j(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(l)throw o}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}!function(e){e.Horizontal="horizontal",e.Vertical="vertical"}(F||(F={}));var G,H,z=function(){function e(t,i,n){c()(this,e),h()(this,"rect",void 0),h()(this,"type",void 0),h()(this,"separatorBlock1",void 0),h()(this,"separatorBlock2",void 0),h()(this,"blocks1",[]),h()(this,"blocks2",[]),h()(this,"allBlocks1",[]),h()(this,"allBlocks2",[]),h()(this,"totalRect",void 0),h()(this,"_weight",void 0),this.type=t,this.totalRect=n,t===F.Horizontal?(this.separatorBlock1=new _({left:i.left,top:i.top,width:i.width,height:0}),this.separatorBlock2=new _({left:i.left,top:i.top+i.height,width:i.width,height:0})):(this.separatorBlock1=new _({left:i.left,top:i.top,width:0,height:i.height}),this.separatorBlock2=new _({left:i.left+i.width,top:i.top,width:0,height:i.height})),this.rect=i}return u()(e,[{key:"getWeight",value:function(){if(void 0!==this._weight)return this._weight;this._weight=10;this.distanceValue();var e=this.textSizeValue();this._weight+=e;var t=this.connectorValue();this._weight+=t;var i=this.hasTextValue();return this._weight+=i,this._weight}},{key:"distance",value:function(){return this.type===F.Horizontal?this.rect.height:this.rect.width}},{key:"distanceValue",value:function(){return this.type===F.Horizontal?this.rect.height/this.totalRect.height:this.rect.width/this.totalRect.width}},{key:"textSizeValue",value:function(){var e,t=0,i=0,n=N(this.blocks1);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.getFirstFontSize()>t&&(r,t=r.getFirstFontSize())}}catch(e){n.e(e)}finally{n.f()}var o,a=N(this.blocks2);try{for(a.s();!(o=a.n()).done;){var l=o.value;l.getFirstFontSize()>i&&(l,i=l.getFirstFontSize())}}catch(e){a.e(e)}finally{a.f()}var c=Math.abs(t-i);if(0===t||0===i)return 1;var s=c/200*10;return i-t>10&&(s+=5),s}},{key:"hasTextValue",value:function(){var e,t=!1,i=!1,n=N(this.allBlocks1);try{for(n.s();!(e=n.n()).done;){if(e.value.hasText()){t=!0;break}}}catch(e){n.e(e)}finally{n.f()}var r,o=N(this.allBlocks2);try{for(o.s();!(r=o.n()).done;){if(r.value.hasText()){i=!0;break}}}catch(e){o.e(e)}finally{o.f()}return t&&!i||!t&&i?10:0}},{key:"connectorValue",value:function(){if(this.separatorBlock1.blockType()===n.Element){var e=this.separatorBlock1.info;if(e.element.type===k.d.CONNECTOR){var t=e.element,i=t.getFrame().frameOnSlide();if(this.type===F.Horizontal&&i.height<=0&&i.width/this.rect.width>2/3||this.type===F.Vertical&&i.width<=0&&i.height/this.rect.height>2/3){var r,o,a=null===(r=t.getGraphic().getGraphicLinInfo())||void 0===r?void 0:r.bgLine;if(a===I.a.LINE||a===I.a.STRAIGNTCONNECTOR1)if(Object(w.j)(Number(null===(o=t.getBorder().getBorderInfo())||void 0===o?void 0:o.width))<20)return 10}}}return 0}}]),e}(),V=(i("0acdc5834b"),i("968ee3f7e6"),i("b1ad530fa6")),W=function(){function e(t){c()(this,e),h()(this,"children",[]),h()(this,"slideModel",void 0),this.slideModel=t}return u()(e,[{key:"getFirstHOrHNode",value:function(){if(!(this.children.length<1)){var e=this.children[0],t=this.getFirstContainTextNode();if(t)return t;for(;e.type===G.None&&e.children.length>0;)e=e.children[0];return e.type!==G.None?e.children[0]:void 0}}},{key:"getFirstContainTextNode",value:function(){if(!(this.children.length<1))return this.children[0].getFirstContainTextNode()}},{key:"getRectsOfNodes",value:function(){var e=this,t=[];return this.children.forEach((function(i){t.push.apply(t,y()(e.getRectsFromContentNode(i)))})),t}},{key:"getTextTree",value:function(){return[this.children[0].getTextTree()]}},{key:"removeEmptyArraysAndUndefined",value:function(e){var t=this;return e.filter((function(e){return!(Array.isArray(e)&&0===e.length)&&void 0!==e})).map((function(e){return Array.isArray(e)?t.removeEmptyArraysAndUndefined(e):e}))}},{key:"flattenSingleElementArrays",value:function(e){var t=this;return e.reduce((function(e,i){return Array.isArray(i)?1===i.length?e.push.apply(e,y()(t.flattenSingleElementArrays(i))):e.push(t.flattenSingleElementArrays(i)):e.push(i),e}),[])}},{key:"getRectsFromContentNode",value:function(e){var t=this,i=[];return i.push(e.getRect()),e.children.forEach((function(e){i.push.apply(i,y()(t.getRectsFromContentNode(e)))})),i}}]),e}();!function(e){e[e.None=0]="None",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical"}(G||(G={})),function(e){e[e.Nested=0]="Nested",e[e.Parallel=1]="Parallel"}(H||(H={}));var U=function(){function e(t,i){c()(this,e),h()(this,"visualBlocks",[]),h()(this,"children",[]),h()(this,"parent",void 0),h()(this,"type",void 0),h()(this,"childrenStructType",void 0),h()(this,"_rect",void 0),h()(this,"_currentNodeBlocks",void 0),this._rect=t,this.type=i||G.None,this.childrenStructType=H.Nested}return u()(e,[{key:"getCurrentNodeBlocks",value:function(){return this._currentNodeBlocks||(this._currentNodeBlocks=this.removeDuplicates(this.visualBlocks,this.children.map((function(e){return e.visualBlocks})))),this._currentNodeBlocks}},{key:"getFirstContainTextNode",value:function(){for(var e=this;e.children.length>=0;)if(1===e.children.length)e=e.children[0];else{if(e.childrenStructType===H.Parallel)return;for(var t=0,i=void 0,n=0;n<e.children.length;n++)e.children[n].hasText()&&(t+=1,i||(i=e.children[n]));if(0===t)return;if(t>1&&i)return i;if(!i)break;e=i}if(e.hasText())return e}},{key:"getDepth",value:function(){for(var e=0,t=this;t.parent;)t=t.parent,e+=1;return e}},{key:"getRect",value:function(){if(this._rect)return this._rect;var e=1/0,t=1/0,i=-1/0,n=-1/0;return this.visualBlocks.forEach((function(r){var o=r.rect;e=Math.min(e,o.left),t=Math.min(t,o.top),i=Math.max(i,o.left+o.width),n=Math.max(n,o.top+o.height)})),this._rect={left:e,top:t,width:i-e,height:n-t},this._rect}},{key:"getChildAlignRects",value:function(){var e=this;if(this.type===G.None)return[this.getRect()];var t=this.getRect(),i=[];return this.children.forEach((function(n){var r=n.getRect(),o={left:r.left,top:r.top,width:r.width,height:r.height};e.type===G.Vertical?(o.left=t.left,o.width=t.width):(o.top=t.top,o.height=t.height),i.push(o)})),i}},{key:"similarityToNode",value:function(e){return 10}},{key:"isSameStructure",value:function(e){if(this.type!==e.type)return!1;var t=this.visualBlocks.filter((function(e){return!e.isLine()})),i=e.visualBlocks.filter((function(e){return!e.isLine()}));if(t.length!==i.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isSameToOther(i[n]))return!1;return!0}},{key:"isSimilarStructure",value:function(e,t){if(this.visualBlocks.sort((function(e,t){return Number(e.listIndex)-Number(t.listIndex)})),e.visualBlocks.sort((function(e,t){return Number(e.listIndex)-Number(t.listIndex)})),Math.abs(this.visualBlocks.length/e.visualBlocks.length-1)>.2)return!1;for(var i=0,n=0;n<this.visualBlocks.length;n++)for(var r=0;r<e.visualBlocks.length;r++)if(this.visualBlocks[n].isSimilarToOther(e.visualBlocks[r],t)){!0,i+=1;break}return i>0}},{key:"hasText",value:function(){for(var e=0;e<this.visualBlocks.length;e++)if(this.visualBlocks[e].hasText())return!0;return!1}},{key:"getTextFontSize",value:function(){for(var e=0;e<this.visualBlocks.length;e++){var t=this.visualBlocks[e].getFirstFontSize();if(t)return t}return 0}},{key:"getTextTree",value:function(){if(0===this.children.length){if(0===this.visualBlocks.length)return;if(1===this.visualBlocks.length){var e=this.visualBlocks[0].getText();return e?new V.b(e,this):void 0}if(this.visualBlocks.length>1){for(var t="",i=0;i<this.visualBlocks.length;i++){var n=this.visualBlocks[i].getText();n&&(t.length>0?t+="\n".concat(n):t=n)}return new V.b(t,this)}}var r=[];this.children.forEach((function(e){var t=e.getTextTree();t&&r.push(t)}));var o=(r=r.filter((function(e){return e&&(Array.isArray(e)&&e.length>0||e instanceof V.b)}))).length;if(0!==o){if(1===o)return this.getSimpleTextTree(r[0]);if(o>1)if(this.childrenStructType===H.Nested){if(o>1){for(var a=[r[o-1]],l=o-2;l>=0;l--){var c=r[l];if(c instanceof V.b)a=[c,a];else if(Array.isArray(c)&&c.length>0)if(1===c.length)a=[c[0],a];else if(2===c.length&&Array.isArray(c[1])){var s=this.getLastNestedTextTree(c[1]);Array.isArray(s)&&s.length>0&&(s.push(a),a=c)}else a=[c,a]}return a}}else if(this.childrenStructType===H.Parallel)return y()(r)}}},{key:"removeDuplicates",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=new Set(i.flat());return e.filter((function(e){return!r.has(e)}))}},{key:"getSimpleTextTree",value:function(e){return Array.isArray(e)&&1===e.length?this.getSimpleTextTree(e[0]):e}},{key:"getLastNestedTextTree",value:function(e){return Array.isArray(e)&&2===e.length&&Array.isArray(e[1])?this.getLastNestedTextTree(e[1]):e}}],[{key:"getContentNodesStructType",value:function(e,t){var i=t===F.Horizontal?"top":"left",n=(F.Horizontal,e.sort((function(e,t){return e.getRect()[i]-t.getRect()[i]})));return n.length>1&&n[0].isSimilarStructure(n[1],[r.Frame])?H.Parallel:H.Nested}}]),e}();function q(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function K(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?q(Object(i),!0).forEach((function(t){h()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):q(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Y=function(){function e(){c()(this,e),h()(this,"currentContentTree",void 0),h()(this,"contentTreeList",void 0),h()(this,"presentation",void 0),h()(this,"currentElement",void 0),h()(this,"separatorList",void 0),h()(this,"visualBlockList",void 0),h()(this,"currentContentNode",void 0),h()(this,"currentContentRect",void 0)}return u()(e,[{key:"resetWithPresentation",value:function(e){this.presentation=e,this.contentTreeList=[]}},{key:"analysisNewSlide",value:function(e,t){this.visualBlockList=[]}},{key:"analysisSlideEnd",value:function(e,t){this.currentContentTree=new W(e);var i={left:0,top:0,width:this.presentation.props.slideWidth,height:this.presentation.props.slideHeight},n=new U(i);n.visualBlocks=y()(this.visualBlockList),this.currentContentTree.children.push(n),this.setVisualBlocksIndex(),this.doAnalysisRecursively(n),this.contentTreeList.push(this.currentContentTree)}},{key:"analysisElement",value:function(e){var t=new T(e);if(!(t.polygon.vertices[0].x<=0&&t.polygon.vertices[0].y<=0&&t.polygon.vertices[1].x>=this.presentation.props.slideWidth&&t.polygon.vertices[1].y<=0&&t.polygon.vertices[2].x>=this.presentation.props.slideWidth&&t.polygon.vertices[2].y>=this.presentation.props.slideHeight&&t.polygon.vertices[3].x<=0&&t.polygon.vertices[3].y>=this.presentation.props.slideHeight)&&e.element.isFromSlide&&!e.element.hidden){var i=e.element.getFrame().boundingRectOnSlide();if(!(i.left>1.2*this.presentation.props.slideWidth||i.top>1.2*this.presentation.props.slideHeight||i.left+i.width<.2*-this.presentation.props.slideWidth||i.top+i.height<.2*-this.presentation.props.slideHeight))if(e.element.type===k.d.SHAPE){var n=e.element,r=n.getBackgroundFill().getShownFillType(),o=n.getBorder().getBorderType(),a=!1,l=!1;if(r&&r!==O.b.NoFill&&(a=!0),o&&o!==E.b.NoFill&&(l=!0),a||l){var c=new _(i,e);return c.degreeOfCoherence=10,this.visualBlockList.push(c),void(Object(C.i)(n.paragraphList)?c.degreeOfCoherence=9:this.currentElement=e)}this.currentElement=e}else{if(e.element.type===k.d.TABLE||e.element.type===k.d.CHART||e.element.type===k.d.CONNECTOR||e.element.type===k.d.IMAGE){var s=new _(i,e);return s.degreeOfCoherence=10,void this.visualBlockList.push(s)}if(e.element.type===k.d.GROUP)e.element}}}},{key:"analysisBlockParentBox",value:function(e){var t;if(e.element===(null===(t=this.currentElement)||void 0===t?void 0:t.element)&&this.currentElement&&this.currentElement.element.type===k.d.SHAPE){var i=this.currentElement.element,n=i.getBackgroundFill().getShownFillType(),r=i.getBorder().getBorderType(),o=!1,a=!1;if(n&&n!==O.b.NoFill&&(o=!0),r&&r!==E.b.NoFill&&(a=!0),Object(C.i)(this.currentElement.element.paragraphList))return;(a||o)&&(this.visualBlockList[this.visualBlockList.length-1].info=e,this.currentElement=void 0)}}},{key:"analysisTextParagraph",value:function(e){var t,i;if(e.element===(null===(t=this.currentElement)||void 0===t?void 0:t.element)&&e.element.type===k.d.SHAPE&&this.currentElement){var n=e.textBoxPath[e.textBoxPath.length-1],r=null===(i=e.element.paragraphList)||void 0===i?void 0:i[n];if(r&&!Object(C.k)(r)){var o=e.element.getFrame().frameOnSlide(),a=K({},e.paraBox.rect),l=this.getRealBoundsFromTextParagraph(e.paraBox);e.paraBox.parentBox&&(a.x+=e.paraBox.parentBox.rect.x+l.left,a.y+=e.paraBox.parentBox.rect.y+l.top);var c={left:Object(R.u)(a.x)+o.left+e.textRect.left,top:Object(R.u)(a.y)+o.top+e.textRect.top,width:Object(R.u)(l.width),height:Object(R.u)(l.height)},s=Object(g.j)(c,o.rotate,Object(A.c)(o)),u=new _(s,e);u.degreeOfCoherence=10,this.visualBlockList.push(u)}}}},{key:"doAnalysisRecursively",value:function(e){var t=this;this.doAnalysisContent(e),e.children.length>0&&e.children.forEach((function(i){i.parent=e,t.doAnalysisRecursively(i)}))}},{key:"doAnalysisContent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!(e.visualBlocks.length<=1)){this.separatorList=[],this.currentContentNode=e,this.currentContentRect=e.getRect();var i=y()(e.visualBlocks),n=this.visualSeparatorDetection(F.Horizontal),r=this.contentStructureConstruction(n),o=this.visualSeparatorDetection(F.Vertical),a=this.contentStructureConstruction(o),l=this.selectRightSeparatorResult(n,r,o,a);if(l)this.separatorList=l.separatorList,t&&(e.type=l.separatorType===F.Horizontal?G.Vertical:G.Horizontal,e.children=l.contentTreeNodes,e.childrenStructType=l.structType);else{if(e.getDepth()>15)return;if(t){var c=this.handleNoSeparator(i);e.type=c.parentNodeType,e.children=c.nodes,e.childrenStructType=c.structType}}}}},{key:"selectRightSeparatorResult",value:function(e,t,i,n){if(!(e.length<1&&i.length<1)){var r=U.getContentNodesStructType(t,F.Horizontal),o=U.getContentNodesStructType(n,F.Vertical);return e.length<1||i.length<1?e.length>0?{contentTreeNodes:t,separatorList:e,separatorType:F.Horizontal,structType:r}:i.length>0?{contentTreeNodes:n,separatorList:i,separatorType:F.Vertical,structType:o}:void 0:r===H.Parallel?{contentTreeNodes:t,separatorList:e,separatorType:F.Horizontal,structType:r}:o===H.Parallel?{contentTreeNodes:n,separatorList:i,separatorType:F.Vertical,structType:o}:{contentTreeNodes:t,separatorList:e,separatorType:F.Horizontal,structType:r}}}},{key:"setVisualBlocksIndex",value:function(){this.visualBlockList.forEach((function(e,t){e.listIndex=t}))}},{key:"visualSeparatorDetection",value:function(e){var t=this,i=[],n=new z(e,K({},this.currentContentRect),this.currentContentRect);return i.push(n),this.currentContentNode.visualBlocks.forEach((function(n){for(var r=0;r<i.length;){if(t.rectInRectWithType(n.rect,i[r].rect,e))t.splitSeparator(i[r],n,r,i),r+=2;else if(t.rectIntersectionWithType(n.rect,i[r].rect,e)){for(var o=0;r+o<i.length&&t.rectIntersectionWithType(n.rect,i[r+o].rect,e);)o+=1;t.changeSeparator(r,o,n,e,i)}r+=1}})),this.removeAroundSeparator(i,this.currentContentNode),this.setSeparatorBlocks(i,this.currentContentNode),this.removeAroundConnectorSeparator(i),i}},{key:"splitSeparator",value:function(e,t,i,n){if(e.type===F.Horizontal){var r=K({},this.currentContentRect);r.top=t.rect.top+t.rect.height,r.height=e.separatorBlock2.rect.top-t.rect.top-t.rect.height;var o=new z(F.Horizontal,r,this.currentContentRect);o.separatorBlock1=t,o.separatorBlock2=e.separatorBlock2,n.splice(i+1,0,o),e.separatorBlock2=t,e.rect.height=t.rect.top-e.separatorBlock1.rect.top-e.separatorBlock1.rect.height}else{var a=K({},this.currentContentRect);a.left=t.rect.left+t.rect.width,a.width=e.separatorBlock2.rect.left-t.rect.left-t.rect.width;var l=new z(F.Vertical,a,this.currentContentRect);l.separatorBlock1=t,l.separatorBlock2=e.separatorBlock2,n.splice(i+1,0,l),e.separatorBlock2=t,e.rect.width=t.rect.left-e.separatorBlock1.rect.left-e.separatorBlock1.rect.width}}},{key:"changeSeparator",value:function(e,t,i,n,r){var o=n===F.Horizontal?"top":"left",a=n===F.Horizontal?"height":"width";1!==t?(t>1&&(r[e].separatorBlock2=i,r[e].rect[a]=i.rect[o]-r[e].rect[o],this.rectInRectWithType(r[e+t-1].rect,i.rect,n)?r.splice(e+t-1,1):(r[e+t-1].separatorBlock1=i,r[e+t-1].rect[o]=i.rect[o]+i.rect[a],r[e+t-1].rect[a]=r[e+t-1].separatorBlock2.rect[o]-i.rect[o]-i.rect[a])),t>2&&r.splice(e+1,t-2),r[e].rect[a]<0&&r.splice(e,1)):i.rect[o]<r[e].separatorBlock1.rect[o]+r[e].separatorBlock1.rect[a]?i.rect[o]+i.rect[a]<r[e].separatorBlock2.rect[o]?(r[e].separatorBlock1=i,r[e].rect[o]=i.rect[o]+i.rect[a],r[e].rect[a]=r[e].separatorBlock2.rect[o]-r[e].rect[o]):r.splice(e,1):(r[e].separatorBlock2=i,r[e].rect[a]=i.rect[o]-r[e].rect[o])}},{key:"removeAroundSeparator",value:function(e,t){for(var i=e.length,n=t.getRect(),r=i-1;r>=0;r--){var o=e[r];!Object(A.f)(o.rect,n)||o.separatorBlock1.info&&o.separatorBlock2.info||e.splice(r,1)}}},{key:"removeAroundConnectorSeparator",value:function(e){for(var t=e.length-1;t>=0;t--){var i=e[t];0!==i.allBlocks1.length&&0!==i.allBlocks2.length||e.splice(t,1)}}},{key:"setSeparatorBlocks",value:function(e,t){if(!(e.length<1)){var i=e[0].type,n=i===F.Horizontal?"top":"left",r=i===F.Horizontal?"height":"width";t.visualBlocks.sort((function(e,t){return e.rect[n]-t.rect[n]}));for(var o=0;o<t.visualBlocks.length;o++)for(var a=t.visualBlocks[o],l=0;l<e.length;l++)if(e[l].rect[n]-(a.rect[n]+a.rect[r])>-1e-5){if(0===l){e[l].blocks1.includes(a)||e[l].blocks1.push(a);break}if(a.rect[n]-(e[l-1].rect[n]+e[l-1].rect[r])>-1e-5){e[l-1].blocks2.includes(a)||e[l-1].blocks2.push(a),e[l].blocks1.includes(a)||e[l].blocks1.push(a);break}}else if(a.rect[n]-(e[l].rect[n]+e[l].rect[r])>-1e-5&&l===e.length-1){e[l].blocks2.includes(a)||e[l].blocks2.push(a);break}for(var c=0;c<t.visualBlocks.length;c++)for(var s=t.visualBlocks[c],u=0;u<e.length;u++)e[u].rect[n]-(s.rect[n]+s.rect[r])>-1e-5?e[u].allBlocks1.includes(s)||e[u].allBlocks1.push(s):s.rect[n]-(e[u].rect[n]+e[u].rect[r])>-1e-5&&(e[u].allBlocks2.includes(s)||e[u].allBlocks2.push(s))}}},{key:"contentStructureConstruction",value:function(e){if(e.length<1)return[];var t=e[0].type,i=y()(e),n=this.getNameFromType(t);i.sort((function(e,t){return t.getWeight()-e.getWeight()}));for(var r=e[0].getWeight(),o=0,a=0;o<e.length;){if(e[o].getWeight()===r){var l=e[o];if(0===a){if(o>0){l.separatorBlock1=e[0].separatorBlock1,l.rect[n.topOrLeft]=l.separatorBlock1.rect[n.topOrLeft]+l.separatorBlock1.rect[n.heightOrWidth],l.rect[n.heightOrWidth]=l.separatorBlock2.rect[n.topOrLeft]-l.rect[n.topOrLeft];for(var c=o-1;c>=0;c--)l.blocks1=e[c].blocks1.concat(l.blocks1);e.splice(0,o),o=0}}else{l.separatorBlock1=e[a-1].separatorBlock2,l.rect[n.topOrLeft]=l.separatorBlock1.rect[n.topOrLeft]+l.separatorBlock1.rect[n.heightOrWidth],l.rect[n.heightOrWidth]=l.separatorBlock2.rect[n.topOrLeft]-l.rect[n.topOrLeft];for(var s=o-1;s>=a;s--)l.blocks1=e[s].blocks1.concat(l.blocks1);e[a-1].blocks2=l.blocks1,e.splice(a,o-a),o=a}a+=1}o+=1}if(o>a){for(var u=y()(e[o-1].blocks2),d=o-1;d>=a;d--)u=e[d].blocks1.concat(u);e[a-1].blocks2=u,e.splice(a,o-a)}for(var h=[],f=0;f<e.length;f++){if(0===f){var v=new U;v.visualBlocks=y()(e[f].blocks1),h.push(v)}var p=new U;p.visualBlocks=y()(e[f].blocks2),h.push(p)}return h}},{key:"handleNoSeparator",value:function(e){var t=this;e.sort((function(e,t){return Number(e.listIndex)-Number(t.listIndex)}));for(var i=y()(e),n=[],o=[],a=[],l=function(e){if(i[e].hasText())n.push(i[e]);else{for(var r=!0,l=0;l<n.length;l++)if(Object(A.h)(i[e].rect,n[l].rect)){r=!1;break}if(r){var c=new U;if(c.visualBlocks=i.filter((function(t,i){return i>e||i<e&&!o.includes(t)})),t.doAnalysisContent(c,!1),t.separatorList.length>0)return{v:{nodes:[c],structType:H.Nested,parentNodeType:G.None}};o.push(i[e])}else a.push(i[e])}},c=0;c<i.length&&c<10;c++){var s=l(c);if("object"===m()(s))return s.v}var u=i.findIndex((function(e){return!(n.includes(e)||a.includes(e))}));if(u>-1){var d=new U,h=new U;d.visualBlocks=[i[u]];var f=i.filter((function(e,t){return t!==u}));if(h.visualBlocks=f,1!==f.length)return{nodes:[d,h],structType:H.Nested,parentNodeType:G.None};if(d.visualBlocks[0].isSimilarToOther(f[0],[r.Frame])){var v=i[0].getFrame(),p=i[1].getFrame(),b=G.None;return b=Math.abs(Number(null==v?void 0:v.left)-Number(null==p?void 0:p.left))<30?G.Horizontal:G.Vertical,{nodes:[d,h],structType:H.Parallel,parentNodeType:b}}}var g=new U,S=new U;g.visualBlocks=[i[0]];var T=i.filter((function(e,t){return 0!==t}));return S.visualBlocks=T,T.length>0?{nodes:[g,S],structType:H.Nested,parentNodeType:G.None}:{nodes:[g],structType:H.Nested,parentNodeType:G.None}}},{key:"rectInRectWithType",value:function(e,t,i){return i===F.Horizontal?e.top-t.top>-1e-5&&t.top+t.height-(e.top+e.height)>-1e-5:e.left-t.left>-1e-5&&t.left+t.width-(e.left+e.width)>-1e-5}},{key:"rectIntersectionWithType",value:function(e,t,i){return i===F.Horizontal?!(t.top-(e.top+e.height)>-1e-5||e.top-(t.top+t.height)>-1e-5):!(t.left-(e.left+e.width)>-1e-5||e.left-(t.left+t.width)>-1e-5)}},{key:"getNameFromType",value:function(e){return{topOrLeft:e===F.Horizontal?"top":"left",heightOrWidth:e===F.Horizontal?"height":"width"}}},{key:"getRealBoundsFromTextParagraph",value:function(e){if(e.children.length<=0)return{left:0,top:0,width:0,height:0};var t={left:1/0,top:1/0,width:0,height:0},i=0,n=0;return e.children.forEach((function(e){t.left=Math.min(t.left,e.rect.x),t.top=Math.min(t.top,e.rect.y),i=Math.max(i,e.rect.x+e.rect.width),n=Math.max(n,e.rect.y+e.rect.height)})),t.width=i-t.left,t.height=n-t.top,t}}]),e}(),Z=(i("29f8c5f672"),function(){function e(t,i,n){var r;c()(this,e),h()(this,"slideIndex",void 0),h()(this,"node",void 0),h()(this,"area",void 0),h()(this,"type",void 0),this.slideIndex=t,this.node=i,this.area=n,this.type=null==i||null===(r=i.parent)||void 0===r?void 0:r.type}return u()(e,[{key:"hasText",value:function(){return!!this.node&&this.node.hasText()}}]),e}()),J=function e(t,i){c()(this,e),h()(this,"horAlignType",A.a.Same),h()(this,"verAlignType",A.b.Same),this.height=t,this.templateArea=i};function X(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(l)throw o}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var Q=function(){function e(){c()(this,e),h()(this,"firstAlignAreas",void 0),h()(this,"vTitleMaybeModes",new Map),h()(this,"vTitleTemplateMap",new Map),h()(this,"vTitleTemplateIndexMap",new Map),h()(this,"vTitleTemplateSimilarityMap",new Map),h()(this,"vTitleTemplateSimilarBlocksMap",new Map),h()(this,"vTitleMaybeModesMap",new Map)}return u()(e,[{key:"analysisByLayout",value:function(e,t){return this.clear(),this.getInfoFromContentTree(e,t),this.checkTitleModes(e),this.analysisAllSlide(e,t),{titleTemplateMap:this.vTitleTemplateMap,titleTemplateSimilarMap:this.vTitleTemplateSimilarityMap,titleTemplateSimilarBlocksMap:this.vTitleTemplateSimilarBlocksMap}}},{key:"clear",value:function(){this.vTitleTemplateMap=new Map,this.vTitleTemplateIndexMap=new Map,this.vTitleTemplateSimilarityMap=new Map,this.vTitleMaybeModesMap=new Map,this.firstAlignAreas=[],this.vTitleMaybeModes=new Map,this.vTitleTemplateSimilarBlocksMap=new Map}},{key:"getInfoFromContentTree",value:function(e,t){var i=this,n=t.map((function(e){return e.getFirstHOrHNode()})),r=n.map((function(t){var i,n,r=null==t?void 0:t.getRect();return r?((null==t||null===(i=t.parent)||void 0===i?void 0:i.type)===G.Vertical&&(r.left=0,r.width=e.props.slideWidth),(null==t||null===(n=t.parent)||void 0===n?void 0:n.type)===G.Horizontal&&(r.top=0,r.height=e.props.slideHeight),r):r})),o=n.map((function(e,t){return new Z(t,e,r[t])}));o.sort((function(e,t){var i,n,r,o,a,l,c,s,u,d,h,f,v,p,m,b,y,g,S,T,k,O,E,C,A,R,w,L;return e.node||t.node?e.node&&t.node?(null===(i=e.node.parent)||void 0===i?void 0:i.type)!==(null===(n=t.node.parent)||void 0===n?void 0:n.type)?Number(null===(c=t.node.parent)||void 0===c?void 0:c.type)-Number(null===(s=e.node.parent)||void 0===s?void 0:s.type):(null===(r=e.node.parent)||void 0===r?void 0:r.type)===G.Vertical?Math.abs(Number(null===(u=e.area)||void 0===u?void 0:u.top)+Number(null===(d=e.area)||void 0===d?void 0:d.height)-(Number(null===(h=t.area)||void 0===h?void 0:h.top)+Number(null===(f=t.area)||void 0===f?void 0:f.height)))<1?Number(null===(y=e.area)||void 0===y?void 0:y.top)-Number(null===(g=t.area)||void 0===g?void 0:g.top):Number(null===(v=e.area)||void 0===v?void 0:v.top)+Number(null===(p=e.area)||void 0===p?void 0:p.height)-(Number(null===(m=t.area)||void 0===m?void 0:m.top)+Number(null===(b=t.area)||void 0===b?void 0:b.height)):(null===(o=e.node.parent)||void 0===o?void 0:o.type)===G.Horizontal?Math.abs(Number(null===(S=e.area)||void 0===S?void 0:S.left)+Number(null===(T=e.area)||void 0===T?void 0:T.width)-(Number(null===(k=t.area)||void 0===k?void 0:k.left)+Number(null===(O=t.area)||void 0===O?void 0:O.width)))<1?Number(null===(w=e.area)||void 0===w?void 0:w.left)-Number(null===(L=t.area)||void 0===L?void 0:L.left):Number(null===(E=e.area)||void 0===E?void 0:E.left)+Number(null===(C=e.area)||void 0===C?void 0:C.width)-(Number(null===(A=t.area)||void 0===A?void 0:A.left)+Number(null===(R=t.area)||void 0===R?void 0:R.width)):Number(null===(a=e.area)||void 0===a?void 0:a.top)-Number(null===(l=t.area)||void 0===l?void 0:l.top):e.node?-1:t.node?1:0:0}));for(var a=0;a<o.length&&(o[a].type===G.Vertical||o[a].type===G.None);){var l=o[a];if(l.hasText()){var c,s,u,d=Math.floor(Number(null===(c=l.area)||void 0===c?void 0:c.top)+Number(null===(s=l.area)||void 0===s?void 0:s.height));if(this.vTitleMaybeModesMap.has(d))null===(u=this.vTitleMaybeModesMap.get(d))||void 0===u||u.push(l);else this.vTitleMaybeModesMap.set(d,[l])}a+=1}this.vTitleMaybeModesMap.forEach((function(e,t){e.length>1&&i.vTitleMaybeModes.set(t,e)})),this.firstAlignAreas=o.sort((function(e,t){return e.slideIndex-t.slideIndex}))}},{key:"checkTitleModes",value:function(e){var t,i=this,n=X(this.vTitleMaybeModes.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value,o=this.vTitleMaybeModes.get(r);if(o){for(var a=void 0,l=void 0,c=void 0,s=0;s<o.length;s++){var u=o[s];if(u.node){for(var d=s+1;d<o.length;d++){var h,f=o[d].node;if(f&&(null!==(h=u.node)&&void 0!==h&&h.isSameStructure(f))){a=u,l=s;var v=o[d].area;u.area&&v&&(c=Object(A.e)(u.area,v,1));break}}if(a)break}}if(a&&c.result){for(var p=[a],m=0;m<o.length;m++){var b;if(m!==l&&null!==(b=o[m].node)&&void 0!==b&&b.isSameStructure(a.node)){var g=o[m].area;if(!g||!a.area)continue;var S=Object(A.e)(g,a.area,1);if(!S.result)continue;Object(A.d)(S.horizontalAlignType,c.horizontalAlignType)&&Object(A.g)(S.verticalAlignType,c.verticalAlignType)&&p.push(o[m])}}var T=new J(r,a);T.verAlignType=c.verticalAlignType,T.horAlignType=c.horizontalAlignType,this.vTitleTemplateMap.set(T,p)}else this.vTitleMaybeModes.delete(r)}}}catch(e){n.e(e)}finally{n.f()}for(var k=Array.from(this.vTitleTemplateMap.keys()),O=0;O<k.length;){for(var E=k[O],C=this.vTitleTemplateMap.get(E),R=k.length-1;R>O;R--){var w,L,x=k[R],M=this.vTitleTemplateMap.get(x);E.templateArea.node&&x.templateArea.node&&(null!==(w=E.templateArea.node)&&void 0!==w&&w.isSameStructure(x.templateArea.node)?(C&&M&&(null==C||C.push.apply(C,y()(M))),this.vTitleTemplateMap.delete(x),k.splice(R,1)):null!==(L=E.templateArea.node)&&void 0!==L&&L.isSimilarStructure(x.templateArea.node)&&(this.vTitleTemplateMap.delete(x),k.splice(R,1)))}O+=1}this.filterResult(e),this.vTitleTemplateMap.forEach((function(e,t){for(var n=0;n<e.length;n++)i.vTitleTemplateIndexMap.set(e[n].slideIndex,t)}))}},{key:"analysisAllSlide",value:function(e,t){for(var i=this,n=0;n<t.length;n++)for(var r=t[n],o=Array.from(this.vTitleTemplateMap.keys()),a=this.vTitleTemplateIndexMap.get(n),l=0;l<o.length;l++){var c=o[l];if(this.vTitleTemplateMap.get(c)&&a!==c){if(this.compareTreeHasSameTemplate(c,r)){var s;null===(s=this.vTitleTemplateMap.get(c))||void 0===s||s.push(this.firstAlignAreas[n]),this.vTitleTemplateIndexMap.set(n,c);break}var u=this.compareTemplateAndTreeIsSimilar(c,r,e),d=u.isSimilar,h=u.similarInfos;d&&function(){var e=i.vTitleTemplateSimilarityMap.get(c);if(h&&i.vTitleTemplateSimilarBlocksMap.set(n,h),e?e.includes(n)||e.push(n):(e=[n],i.vTitleTemplateSimilarityMap.set(c,e)),a){var t=i.vTitleTemplateMap.get(a);null==t||t.forEach((function(t){var i,n;null!==(i=e)&&void 0!==i&&i.includes(t.slideIndex)||(null===(n=e)||void 0===n||n.push(t.slideIndex))})),i.vTitleTemplateMap.delete(a);var r=i.vTitleTemplateSimilarityMap.get(a);null==r||r.forEach((function(t){var i,n;null!==(i=e)&&void 0!==i&&i.includes(t)||(null===(n=e)||void 0===n||n.push(t))})),i.vTitleTemplateSimilarityMap.delete(a)}}()}}}},{key:"compareTemplateAndTreeIsSimilar",value:function(e,t,i){var n;if(!e.templateArea.node)return{isSimilar:!1};for(var r=null===(n=e.templateArea.node)||void 0===n?void 0:n.visualBlocks,o=[],a=0;a<r.length;a++){var l=r[a],c=t.children[0];if(c){for(var s=!1,u=0;u<c.visualBlocks.length;u++){var d=c.visualBlocks[u];if(l.isSimilarToOther(d,void 0,i.props.slideWidth/2)){var h={similarBlock:d},f=Object(A.e)(d.rect,l.rect,1);f.result&&f.horizontalAlignType&&f.verticalAlignType&&(h.horizontalAlignType=f.horizontalAlignType,h.verticalAlignType=f.verticalAlignType),o.push(h),s=!0;break}}if(!s)return{isSimilar:!1}}}return{isSimilar:!0,similarInfos:o}}},{key:"compareTreeHasSameTemplate",value:function(e,t){var i;if(!e.templateArea.node)return!1;for(var n=null===(i=e.templateArea.node)||void 0===i?void 0:i.visualBlocks,r=[],o=0;o<n.length;o++){var a=n[o],l=t.children[0];if(l){for(var c=!1,s=0;s<l.visualBlocks.length;s++){var u=l.visualBlocks[s];if(a.isSameToOther(u)){var d=Object(A.e)(a.rect,u.rect,1);if(!d.result)continue;if(Object(A.d)(d.horizontalAlignType,e.horAlignType)&&Object(A.g)(d.verticalAlignType,e.verAlignType)){r.push(u),c=!0;break}}}if(!c)return!1}}return!0}},{key:"filterResult",value:function(e){for(var t=e.props.slideHeight,i=Array.from(this.vTitleTemplateMap.keys()),n=i.length-1;n>=0;n--){var r=i[n];r.height>t/2&&this.vTitleTemplateMap.delete(r)}}}]),e}(),ee=(i("75563bc376"),i("405b4a5e2b"),i("899c76157d"),i("12b829499b")),te=function(){function e(){c()(this,e)}return u()(e,[{key:"analysisTitleInfo",value:function(e,t,i){var n=this,r=this.getVIndexTitleTemplateMap(t,i);return e.map((function(e,t){var i=r.get(t);return n.getShowResultFromContentTree(e,i)}))}},{key:"analysisPageInfoByContent",value:function(e,t,i){var n=this;if(0!==e.length){var r=-1,o=-1;e.forEach((function(t,i){0===i&&(t.pageModel.getAllChildrenOfPlaceHolder().find((function(e){return e.isCtrTitlePl}))&&(e[i].pageType=ee.b.CoverPage,o=i));if(-1===r){for(var a=0;a<t.texts.length;a++){var l=t.texts[a].text.toLowerCase();if(n.isContentsRef(l)&&l.length<10){t.pageType=ee.b.TableOfContents,r=i;break}}n.isContentsListRef(t.texts.map((function(e){return e.text})))&&(t.pageType=ee.b.TableOfContents,r=i)}for(var c=0;c<t.texts.length;c++)(t.texts[c].text.toLowerCase().includes("thank")||t.texts[c].text.includes("谢谢")||t.texts[c].text.includes("感谢"))&&(t.pageType=ee.b.Acknowledgments)})),e.length>1&&1===r&&(e[0].pageType=ee.b.CoverPage,o=0),-1!==r?this.handleHasTableContent(e,r,i):this.handleNoTableContent(e,i),e[0].pageType===ee.b.Content&&(e[0].pageType=ee.b.CoverPage,o=0),-1!==o&&e[o].resetCoverPageTitle()}}},{key:"getShowResultFromContentTree",value:function(e,t){var i=e.getTextTree();return i?0===i.length?[]:i[0]?i[0]instanceof V.b?(t&&i[0].setTitleOrContent(t.height),[i[0]]):this.getShowResult(i[0],0,t):[]:[]}},{key:"getShowResult",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=[],r=!1,o=0;o<e.length;o++)e[o]instanceof V.b&&(r=!0);for(var a=0;a<e.length;a++)e[a]instanceof V.b&&(e[a].level=t,i&&e[a].setTitleOrContent(i.height),n.push(e[a])),Array.isArray(e[a])&&(n=n.concat(this.getShowResult(e[a],r?t+1:t)));return n}},{key:"getVIndexTitleTemplateMap",value:function(e,t){var i=new Map;return e.forEach((function(e,t){e.forEach((function(e){i.set(e.slideIndex,t)}))})),t.forEach((function(e,t){e.forEach((function(e){i.set(e,t)}))})),i}},{key:"handleHasTableContent",value:function(e,t,i){for(var n,r=Array.from(i.titleTemplateMap.keys()),o=0,a=0;a<r.length;a++){var l,c,s=r[a],u=null===(l=i.titleTemplateMap.get(s))||void 0===l||null===(c=l.map((function(e){return e.slideIndex})))||void 0===c?void 0:c.concat(i.titleTemplateSimilarMap.get(s)||[]);if(u&&0!==u.length){for(var d=0,h=e[t].getAllTextString(),f=0;f<u.length;f++){var v,p=(null===(v=e[u[f]])||void 0===v?void 0:v.getAllTextString())||"";if(this.longestCommonSubsequence(h,p)/p.length<2/3){d+=1;break}}d>=o&&(o=d,n=u)}}0!==o&&n&&n.forEach((function(i){i!==t&&e[i]&&(e[i].pageType=ee.b.SectionDivider)}))}},{key:"handleNoTableContent",value:function(e,t){for(var i,n=Array.from(t.titleTemplateMap.keys()),r=0,o=0;o<n.length;o++){var a,l,c=n[o],s=null===(a=t.titleTemplateMap.get(c))||void 0===a||null===(l=a.map((function(e){return e.slideIndex})))||void 0===l?void 0:l.concat(t.titleTemplateSimilarMap.get(c)||[]);if(s&&0!==s.length){for(var u=!0,d=0;d<s.length;d++){var h,f=(null===(h=e[s[d]])||void 0===h?void 0:h.getAllTextString())||"";if(f.length>40&&!/\d/.test(f)){u=!1;break}}u&&(0===r||s.length>=r)&&(r=s.length,i=s)}}0!==r&&i&&i.forEach((function(t){e[t]&&(e[t].pageType=ee.b.SectionDivider)}))}},{key:"longestCommonSubsequence",value:function(e,t){for(var i=e.length,n=t.length,r=new Array(i+1).fill(0).map((function(){return new Array(n+1).fill(0)})),o=1;o<=i;o++)for(var a=1;a<=n;a++)e[o-1]===t[a-1]?r[o][a]=r[o-1][a-1]+1:r[o][a]=Math.max(r[o][a-1],r[o-1][a]);return r[i][n]}},{key:"isContentsRef",value:function(e){return e.startsWith("contents")||/^目\s*录$/.test(e)||e.endsWith("contents")||e.endsWith("content")}},{key:"isContentsListRef",value:function(e){var t=!1,i=!1,n=/^目$/,r=/^录$/;return e.forEach((function(e){n.test(e.replaceAll(" ",""))&&(t=!0),r.test(e.replaceAll(" ",""))&&(i=!0)})),t&&i}}]),e}(),ie=i("743ef67b0e");function ne(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var re=function(){function e(t){c()(this,e),h()(this,"analyzer",void 0),h()(this,"titleAnalyzer",void 0),h()(this,"textAnalyzer",void 0),h()(this,"enumerator",void 0),this.analyzer=new Y,this.titleAnalyzer=new Q,this.textAnalyzer=new te,this.enumerator=t}var t,i;return u()(e,[{key:"analysisTextResult",value:(i=a()(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.analysis(t);case 2:return e.abrupt("return",this.getTextResultAfterEnumerateAnalysis(t).pagesText);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"analysisWithTextResultWhenEnumerateContent",value:function(e,t,i){var n=this,r=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(i),!0).forEach((function(t){h()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ne(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t);t.onStartEnumerate=function(){var t;null===(t=r.onStartEnumerate)||void 0===t||t.call(r),n.analyzer.resetWithPresentation(e)},t.slideStartCallback=function(e){var t;null===(t=r.slideStartCallback)||void 0===t||t.call(r,e),n.analyzer.analysisNewSlide(e.slide,e.slideIndex)},t.slideEndCallback=function(e){var t;null===(t=r.slideEndCallback)||void 0===t||t.call(r,e),n.analyzer.analysisSlideEnd(e.slide,e.slideIndex)},t.elementCallback=function(e){var t;null===(t=r.elementCallback)||void 0===t||t.call(r,e),n.analyzer.analysisElement(e)},t.textBlockParentBoxCallback=function(e){var t;null===(t=r.textBlockParentBoxCallback)||void 0===t||t.call(r,e),n.analyzer.analysisBlockParentBox(e)},t.textParagraphParentBoxCallback=function(e){var t;null===(t=r.textParagraphParentBoxCallback)||void 0===t||t.call(r,e),n.analyzer.analysisTextParagraph(e)},t.presentationEndCallback=function(e){var t;null===(t=r.presentationEndCallback)||void 0===t||t.call(r,e);var o=n.getTextResultAfterEnumerateAnalysis(e);i(n.analyzer.contentTreeList,o.pagesText,o.titleResult)}}},{key:"analysis",value:(t=a()(v.a.mark((function e(t,i){var n,r,o,a,l,c,s,u=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.analyzer.resetWithPresentation(t),n=function(e){u.analyzer.analysisNewSlide(e.slide,e.slideIndex)},r=function(e){u.analyzer.analysisSlideEnd(e.slide,e.slideIndex)},o=function(e){u.analyzer.analysisElement(e)},a=function(e){u.analyzer.analysisBlockParentBox(e)},l=function(e){u.analyzer.analysisTextParagraph(e)},c=null!=i?i:this.enumerator,(s=new ie.a).presentation=t,e.next=11,c.enumerateWithCallback({slideStartCallback:n,slideEndCallback:r,elementCallback:o,textBlockParentBoxCallback:a,textParagraphParentBoxCallback:l},{customUiDataService:s});case 11:return e.abrupt("return",this.analyzer.contentTreeList);case 12:case"end":return e.stop()}}),e,this)}))),function(e,i){return t.apply(this,arguments)})},{key:"getTextResultAfterEnumerateAnalysis",value:function(e){var t=this.analyzer.contentTreeList,i=this.titleAnalyzer.analysisByLayout(e,t),n=this.textAnalyzer.analysisTitleInfo(t,i.titleTemplateMap,i.titleTemplateSimilarMap),r=e.children.map((function(e,t){return new ee.a(e,n[t])}));return this.textAnalyzer.analysisPageInfoByContent(r,e,i),{pagesText:r,titleResult:i}}}]),e}()},ec99168144:function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),function(e){e.EDGE="edge",e.BASE_LINE="baseLine",e.MARGIN="margin",e.RECT="rect"}(n||(n={})),function(e){e[e.EXTEND=0]="EXTEND",e[e.BETWEEN=1]="BETWEEN"}(r||(r={}))},f6f2be7c1a:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("9132715560"),r=i.n(n),o=i("85d0a7609b"),a=i.n(o),l=i("020899bf26"),c=function e(){r()(this,e),a()(this,"setSlideTitleAfterReady",(function(){Object(l.b)((function(){var e,t,i,n=(l.a.SlideTitleManager()||{}).title,r=void 0===n?"":n;null===(e=window.wx)||void 0===e||null===(t=e.miniProgram)||void 0===t||null===(i=t.postMessage)||void 0===i||i.call(t,{data:{title:r,type:4}})}))}))}},fab0b2fcc7:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o}));var n=i("711a53c9fc"),r=100,o=[n.c.InsertText,n.c.DeleteText,n.c.SetTextProperties,n.c.SetTextData,n.c.SetTextBodyProperties]},fb0523358a:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var n=i("176815363d"),r=i.n(n),o=i("9132715560"),a=i.n(o),l=i("6a364eb35c"),c=i.n(l),s=i("85d0a7609b"),u=i.n(s),d=i("3ef2352f0b"),h=i.n(d),f=(i("8e7cce0ada"),i("29f8c5f672"),i("c6244f7705"),i("85d48ef22b"),i("2a6f332b5e"),i("081c8cafea"),i("3bf1976a4f"),i("d5c3deb8c7")),v=i("52d461bc51"),p=i.n(v),m=i("d3d31c86eb"),b=i("b86964b011"),y=i("5fac0349d3"),g=i("4f3b15d017"),S=i("5cdbac46e8"),T=i("aba9dcef64"),k=i("37091e4240"),O=i("020899bf26"),E=function(){function e(t,i){a()(this,e),u()(this,"hasShownCannotEditTips",!1),u()(this,"isShowingConvertException",!1),u()(this,"convertErrorElementMap",void 0),u()(this,"userPriviledgeService",void 0),u()(this,"selectionService",void 0),u()(this,"historyManager",void 0),u()(this,"anonymousViewService",void 0),this.injectable=i;var n=t.selectionService;this.convertErrorElementMap=new Map,this.selectionService=n}var t;return c()(e,[{key:"setHistoryManagerDelegate",value:function(e){this.historyManager||(this.historyManager=e)}},{key:"showCannotCopyTips",value:function(){var e,t;if(null!==(e=this.injectable)&&void 0!==e&&e.showCannotCopyTips)return null===(t=this.injectable)||void 0===t?void 0:t.showCannotCopyTips(this);this.showSnackbar({message:y.a.t("文档管理员限制了查看者的操作权限，无法复制内容。"),autoClose:!0,closable:!1})}},{key:"showMsg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.showSnackbar({message:e,duration:t})}},{key:"showBrowserNotSupport",value:function(){var e;if(null!==(e=this.injectable)&&void 0!==e&&e.showBrowserNotSupport)return this.injectable.showBrowserNotSupport(this);var t=g.default.isMac?"⌘+V":"Ctrl+V";this.showSnackbar({message:y.a.t("请使用快捷键 {0} 进行粘贴",{0:t}),autoClose:!0,closable:!0})}},{key:"showSnackbar",value:function(e){try{g.default.isMobile?Promise.resolve().then(i.t.bind(null,"b74ee0edd6",7)).then((function(t){t.default.show(e)})):Promise.resolve().then(i.t.bind(null,"82f2dc9440",7)).then((function(t){t.default.show(e)}))}catch(e){window.log.error("[loadChunk-error]".concat(e))}}},{key:"showCannotEditTips",value:function(){var e,t,i,n,r,o=this;if(!(null!==(e=this.historyManager)&&void 0!==e&&e.isShowingHistory||null!==(t=this.userPriviledgeService)&&void 0!==t&&t.isOverCoorperateNum||null!==(i=this.selectionService.currentSlide)&&void 0!==i&&i.preload)){if((null===(n=this.selectionService)||void 0===n||null===(r=n.slides)||void 0===r?void 0:r.length)>0){var a=T.a.CooperationLockManager(),l=null==a?void 0:a.getLockInfoByIndex(this.selectionService.currentSlideIndex,this.selectionService.currentSlideType);if(l&&!l.user.isSelf)return void O.a.SlideAppService.promise().then((function(e){1===e.getSlideCount()?o.showSnackbar({message:y.a.t("该页正在被其他用户编辑中，请稍后尝试。"),duration:5e3}):o.showSnackbar({message:y.a.t("该页正在被其他用户编辑中，请稍后尝试或编辑其他页。"),duration:5e3})}))}this.isShowAnonymousModal()?this.anonymousViewService.showAnonymousEditModal():this.isEditorStateChangedByOther()||this.hasShownCannotEditTips||(this.hasShownCannotEditTips=!0,Object(b.k)()?k.b.emit(k.a.SHOW_AUTH_GUIDE_PC):k.b.emit(k.a.SHOW_LOGIN_GUIDE_PC))}}},{key:"showConvertExceptionModal",value:function(e,t){if(t.message&&t.stack&&(console.error("ConvertException (SDK -> UI):",t),window.log.info("convert sdk to ui exception: ".concat(t.message," + ").concat(t.stack))),e.key&&!this.convertErrorElementMap.get(e.key)){this.convertErrorElementMap.set(e.key,!0);var i=JSON.stringify({errorMsg:t.message,type:e.type,inGroup:e.inGroup,slideIndex:e.slideIndex});if(Object(m.c)({opername:"quality_slide",module:"detail",action:"convert_sdk2ui_error",ver6:i}),!this.isShowingConvertException){var n=this;n.isShowingConvertException=!0,setTimeout((function(){p.a.confirm({title:y.a.t("提示"),content:y.a.t("文档中有部分数据损坏，该内容不可编辑仅能查看"),onOk:function(){n.isShowingConvertException=!1},cancelText:null})}),10)}}}},{key:"setUserPriviledgeServiceDelegate",value:function(e){var t=this;this.userPriviledgeService||(this.userPriviledgeService=e,Object(f.e)((function(){t.userPriviledgeService&&(t.userPriviledgeService.pptEditorState>S.b.EDITABLE&&(t.hasShownCannotEditTips=!1))})))}},{key:"setAnonymousViewServiceDelegate",value:(t=r()(h.a.mark((function e(t){var i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise();case 2:i=e.sent,this.anonymousViewService=i;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isShowAnonymousModal",value:function(){var e,t;return!(null===(e=this.anonymousViewService)||void 0===e||!e.anonymousStatus)&&(null===(t=this.userPriviledgeService)||void 0===t?void 0:t.fileAuth)===S.a.EDITABLE}},{key:"isEditorStateChangedByOther",value:function(){var e=this.userPriviledgeService;return!!e&&(e.fileAuth===S.a.EDITABLE&&e.pptEditorState!==S.a.EDITABLE)}}]),e}()},fb5ce2c53e:function(e,t,i){"use strict";function n(e,t){return Math.abs(e-t)<=.001}function r(e,t){return!n(e,t)&&e>t}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}))}}]);
//# sourceMappingURL=slide-base~95108331-0acfe4.js.map
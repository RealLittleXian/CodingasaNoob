(this.webpackJsonp=this.webpackJsonp||[]).push([["base~ab752770"],{"0442e400dc":function(A,e,t){"use strict";t.d(e,"a",(function(){return n})),t.d(e,"b",(function(){return i}));var n={HORIZONTAL_LEFT:"horizontal_left",HORIZONTAL_CENTER:"horizontal_center",HORIZONTAL_RIGHT:"horizontal_right",HORIZONTAL_JUSTIFY:"horizontal_justify",HORIZONTAL_DISTRIBUTE:"horizontal_distribute",VERTICAL_TOP:"vertical_top",VERTICAL_CENTER:"vertical_center",VERTICAL_BOTTOM:"vertical_bottom"},i={INDENT_INCREASE:"indent_increase",INDENT_REDUCE:"indent_reduce"}},"06e1dc2299":function(A,e,t){"use strict";t.d(e,"a",(function(){return k})),t.d(e,"d",(function(){return M})),t.d(e,"b",(function(){return P})),t.d(e,"c",(function(){return B}));t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var n=t("85d0a7609b"),i=t.n(n),o=(t("75563bc376"),t("6e20b6a7d8"),t("ab17200d42")),r=t("2ba7871556"),a=t("942685091f"),l=t("d9812f1c6f"),c=t("33c34da0d5"),s=t("516fa97df2"),d=t("6a430d18ea"),u=t("e256935f21"),p=t("a9d1a34b6a");t("3bf1976a4f"),t("c13f133f92"),t("147aa73f92");function h(A){return void 0!==A&&0===A}var f,v=t("0a8ecd6412"),g=t("3344f1a2e7"),y=t("6a9e93341e"),m=t("82826243ac");function b(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function C(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?b(Object(t),!0).forEach((function(e){i()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var S=(f={},i()(f,r.d.NONE,s.R.None),i()(f,r.d.x,s.R.Horizontal),i()(f,r.d.y,s.R.Vertical),i()(f,r.d.xy,s.R.Both),f),E=1.5,O=4;function k(A){var e,t,n,i=A.style,r=A.frame,a=void 0===r?{left:0,top:0}:r,l=A.factoryOptions,s=A.applyImageFilter,d=void 0===s||s,u=A.realRotateAndFlip,p=L(i)&&Object(m.a)(null===(e=i.border)||void 0===e||null===(t=e.sketchStyle)||void 0===t?void 0:t.type)?i.border.sketchStyle:i;return{frame:C(C({width:i.width,height:i.height,flipH:!(null==u||!u.flipH),flipV:!(null==u||!u.flipV),rotate:null==u?void 0:u.rotate},a),{},{offsetFrame:A.style.offsetFrame}),path:{type:null!==(n=p.bgShape||i.bgLine)&&void 0!==n?n:c.e.RECT,controlValues:p.controlValues,pathList:p.pathList},fillStyle:B(i,l,!!A.style.offsetFrame),strokeStyle:M(A),filter:{effect:P(i.effect),imageFilter:d?i.image:void 0,forbidWebgl:o.e,filterDisplayOptions:w(A)}}}function M(A){var e,t,n,i,o,r,a,l,s,d=A.style,u=A.isOutsizeBorder,p=A.factoryOptions;if(!L(d)){var h=null!==(e=d.border)&&void 0!==e&&e.headEnd?C({},null===(t=d.border)||void 0===t?void 0:t.headEnd):void 0,f=null!==(n=d.border)&&void 0!==n&&n.tailEnd?C({},null===(i=d.border)||void 0===i?void 0:i.tailEnd):void 0,v=(p||{}).model,g=1===(null==v?void 0:v.subType)||(null==v?void 0:v.isPlaceholder)||(null==v?void 0:v.isImage);return{lineCap:null===(o=y.G.find((function(A){var e;return A.type===(null===(e=d.border)||void 0===e?void 0:e.linecap)})))||void 0===o?void 0:o.val,lineJoin:Object(y.N)(null===(r=d.border)||void 0===r?void 0:r.linejoin,g).val,lineWidth:null===(a=d.border)||void 0===a?void 0:a.width,fillStyle:T(d),headEnd:h,tailEnd:f,type:(null===(l=d.border)||void 0===l?void 0:l.style)||c.f.SOLID,hitStrokeWidth:D(d,p),isOutsizeBorder:u,minStrokeWidth:E,minEndStrokeWidth:O,compoundType:null===(s=d.border)||void 0===s?void 0:s.compoundType}}}function L(A){var e,t;return!(null!=A&&A.border&&(null!==(e=A.border)&&void 0!==e&&e.color||null!==(t=A.border)&&void 0!==t&&t.gradFill))}function T(A){var e,t;if(null!==(e=A.border)&&void 0!==e&&e.gradFill){var n=A.border.gradFill,i=n.gsList,o=n.lin,r=n.pathGradient,a=n.rotateWithShape;return{gradFill:{gsList:i.map((function(A){var e;return{pos:A.pos,color:null===(e=A.color)||void 0===e?void 0:e.srgb_color}})),lin:o,pathGradient:r,rotateWithShape:!h(a)}}}return{solidFill:{color:null===(t=A.border)||void 0===t?void 0:t.color}}}function w(A){var e,t,n=A.style,i=A.factoryOptions;return Object(d.a)(null==i||null===(e=i.exportImageManager)||void 0===e?void 0:e.isImageCopying,n.width,n.height)?{shadow:u.a.None,glow:u.a.None,softEdge:u.a.None,reflection:u.a.None,image:u.a.None}:null==i||null===(t=i.getFilterDisplayOptions)||void 0===t?void 0:t.call(i)}function R(A){if(A){var e=A.region,t=A.getPageScale;if(e===v.s.LEFTLIST){var n=null==t?void 0:t();if(n)return Object(g.C)(n)}}}function P(A){if(A){var e=A.shadow,t=A.glow,n=A.reflection,i=A.softEdge,o={};return e&&(o.shadow={algn:e.algn,blur:e.blurRad,angle:e.dir,distance:e.dist,size:e.size,scaleX:e.sizeX,scaleY:e.sizeY,isOuter:e.isOuter,color:e.color,skewX:e.skewX,skewY:e.skewY,opacity:e.opacity}),t&&(o.glow=C({},t)),n&&(o.reflection={blur:n.blurRad,angle:n.dir,distance:n.dist,size:n.size,endOpacity:n.endOpacity,startOpacity:n.startOpacity,rotateWithShape:!h(n.rotWithShape)}),i&&(o.softEdge=C({},i)),o}}function B(A,e,t){if(A.fillBackground){var n,i=A.fillBackground,o=i.noFill,r=i.solidFill,a=i.image,l=i.pattFill,c=i.gradFill;if(o)return{noFill:!0};if(r)return{solidFill:{color:null===(n=r.color)||void 0===n?void 0:n.srgb_color}};if(a)return function(A,e,t){var n=A.src,i=A.alpha,o=A.rotWithShape,r=A.tile,a=A.stretch;return{imageFill:{src:p.a.limitImageQuality(n),alpha:i,rotateWithShape:!t&&(e||!h(o)),tile:r?{tx:r.tx,ty:r.ty,sx:r.sx,sy:r.sy,algn:r.algn,flip:S[r.flip]}:void 0,stretch:a}}}(a,A.isForeground,t);if(c)return function(A,e,t){var n=A.gsList,i=A.lin,o=A.pathGradient,r=A.rotateWithShape,a=A.tileRect;return{gradFill:{gsList:n.map((function(A){var e,t;return{pos:A.pos,color:(null===(e=A.color)||void 0===e?void 0:e.srgb_color)||(null===(t=A.color)||void 0===t?void 0:t.srgbColor)}})),lin:i,pathGradient:o,rotateWithShape:!t&&!h(r),tileRect:a,centerFrame:e}}}(c,A.shadeTitleFrame,t);if(l){var s,d,u=l.preset,f=l.bgColor,v=l.fgColor;return{patternFill:{preset:u,bgColor:null===(s=f.color)||void 0===s?void 0:s.srgb_color,fgColor:null===(d=v.color)||void 0===d?void 0:d.srgb_color,pageScale:R(e)}}}}}function D(A,e){var t=A.border;if(!t)return 0;if(function(A){var e=A.fillBackground;return!(l.a.isMobile&&e&&(null==e||!e.noFill))}(A)){var n,i=(null==e||null===(n=e.getPageScale)||void 0===n?void 0:n.call(e))||1;return(t.width||0)+a.a/i}return t.width||0}},"0aa3c1ea74":function(A,e,t){"use strict";t.d(e,"a",(function(){return r}));var n=t("14502724a6"),i=t.n(n),o=(t("4bbb5840d5"),t("1bab7b5fb7"),t("0aeae65bf4"),t("6e20b6a7d8"),t("9d7978d445"),t("826dc923b3"),t("963f2eaace"),t("3bf1976a4f"),t("516fa97df2"));function r(A){var e=null==A?void 0:A.toLowerCase();if("transparent"===e)return o.h.Transparent;if(null!=e&&e.startsWith("#"))return function(A){var e=A.slice(1),t=e.length;if(6===t)return o.h.fromHex(A);if(8===t)return o.h.fromHex8(A);if(3===t){var n=i()(e,3),r=n[0],a=n[1],l=n[2],c="#".concat(r).concat(r).concat(a).concat(a).concat(l).concat(l);return o.h.fromHex(c)}if(4===t){var s=i()(e,4),d=s[0],u=s[1],p=s[2],h=s[3],f="#".concat(d).concat(d).concat(u).concat(u).concat(p).concat(p).concat(h).concat(h);return o.h.fromHex8(f)}return o.h.Black}(e);if(null!=e&&e.startsWith("rgba(")){var t,n=null===(t=e.match(/rgba\((.*)\)/))||void 0===t?void 0:t[1];if(n){var r=n.split(",").map((function(A){return Number(A)})),a=i()(r,4),l=a[0],c=a[1],s=a[2],d=a[3];return o.h.fromRGBA(l,c,s,d)}}if(null!=e&&e.startsWith("rgb(")){var u,p=null===(u=e.match(/rgb\((.*)\)/))||void 0===u?void 0:u[1];if(p){var h=p.split(",").map((function(A){return Number(A)})),f=i()(h,3),v=f[0],g=f[1],y=f[2];return o.h.fromRGB(v,g,y)}}return o.h.Black}},"0c9000b818":function(A,e,t){"use strict";t.d(e,"a",(function(){return o}));var n=t("5655794132"),i=t("8cec191691"),o=function(A){for(var e,t,o=null==A?void 0:A.parent;o&&!(o instanceof n.a);)o=o.parent;var r=(null===(e=o)||void 0===e?void 0:e.parent)instanceof i.a?null===(t=o)||void 0===t?void 0:t.parent:o;return r||void 0}},"0e1cedb272":function(A,e,t){"use strict";t.d(e,"b",(function(){return i})),t.d(e,"a",(function(){return o}));t("7a3400cab1"),t("516fa97df2"),t("7b0ebf3e1a");var n=t("efc1955963");t("147aa73f92");function i(A){A&&(A.filters.length=0)}function o(A){var e=null;if(A instanceof n.a){var t,i,o,r=null==A||null===(t=A.selectedRange)||void 0===t?void 0:t.rowStart,a=null==A||null===(i=A.selectedRange)||void 0===i?void 0:i.colStart,l=null===(o=A.tableItems[r])||void 0===o?void 0:o[a];e=null==l?void 0:l.editorInstance}else{var c,s;e=A&&(A.editorInstance||(null===(c=A.noteInstance)||void 0===c?void 0:c.editorInstance)||(null===(s=A.noteInstance)||void 0===s?void 0:s.textEditor))}return e}},"0f25ec4562":function(A,e,t){"use strict";t.d(e,"a",(function(){return z}));t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("bcb5d93d36");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("85d0a7609b"),l=t.n(a),c=(t("8ee19818c4"),t("6e20b6a7d8"),t("3bf1976a4f"),t("ce428b7e85")),s=t("9789b08c01"),d=t("609550d527"),u=t("2a5f3314a4"),p=t("0ef3962c55"),h=t("1c66973d9e"),f=t("14c02e2331"),v=t("5435d2ca10"),g=t("c2b620c600"),y=t("54a7b7d7a1"),m=t("2ba7871556"),b=t("5a4e4e2c55"),C=t("eabf3daf43"),S=t("580eefa367"),E=t("fd18ffe80d"),O=t("51b2ea9953"),k=t("153bd00100"),M=(t("405b4a5e2b"),t("516fa97df2")),L=t("0aa3c1ea74");t("5d557fc3ce"),t("0eec0ee5bb");var T=t("4151ad1373");var w=t("4c80af32f0");function R(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function P(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?R(Object(t),!0).forEach((function(e){l()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var B="link_hover_id",D=function A(e){var t=this,n=e.getLinkColor,o=e.onLinkMouseEnter,r=e.onLinkMouseLeave,a=e.onLinkClick,c=e.onLinkTouchEnd,s=e.getTextDirection,d=e.linkCursor;i()(this,A),l()(this,"waitRemoveHoverContainer",void 0),l()(this,"onLinkMouseEnter",void 0),l()(this,"onLinkMouseLeave",void 0),l()(this,"getLinkColor",void 0),l()(this,"onLinkClick",void 0),l()(this,"onLinkTouchEnd",void 0),l()(this,"getTextDirection",void 0),l()(this,"linkCursor",void 0),l()(this,"getLinkNode",(function(A,e,n){return t.createLinkNode(A,e,n)})),l()(this,"isLinkText",(function(A){return Object(w.a)(A)})),l()(this,"createLinkNode",(function(A,e,n){var i,o,r,a=e.textElement,l=P(P({},e),{},{underline:!(null!==(i=a.href)&&void 0!==i&&i.iconMode)||e.underline});l.color=t.getLinkColor(a);var c=function(A,e,t,n,i){var o=e.x,r=e.y,a=e.width,l=e.height,c=e.fontSize,s=e.italic,d=e.boxX,u=e.boxY,p=e.fontFamily,h=e.fontWeight,f=e.strike,v=e.rotate,g=e.rotateOrigin,y=e.opacity,m=e.color,b=e.underline,C=n(A,{textX:o,textY:r,rectX:d,rectY:u,rectWidth:a,drawLineOffsetX:e.drawLineOffsetX,isDeleteLineNotRotate:i,rectHeight:l,rotate:v,rotateOrigin:g,textDirection:t,underline:b,lineThrough:f});return"number"==typeof y&&(C.alpha=y),C.x=o,C.y=r,C.fontSize=c,C.fontWeight=h,C.fontFamily=Object(T.b)(p),s&&(C.fontStyle=M.s.Italic),v&&g&&(C.x=C.x+g.x,C.y=C.y+g.y,C.pivotX=g.x,C.pivotY=g.y,C.angle=v),C.fill=new M.i(Object(L.a)(m)),C}(A,l,t.getTextDirection(),(function(A,e){return new h.a(A,e,a)}),!(null===(o=a.href)||void 0===o||!o.iconMode));t.linkCursor&&(c.cursor=t.linkCursor);var s=(null===(r=a.href)||void 0===r?void 0:r.iconMode)&&a.inlineProps;return t.addLinkListener(c,n,s,e),c})),l()(this,"addLinkListener",(function(A,e,n,i){A.onMouseEnter((function(A){t.onLinkMouseEnter(A)})),A.onMouseLeave((function(A){t.onLinkMouseLeave(A)})),A.onClick((function(A){var e;A.stopPropagation(),null===(e=t.onLinkClick)||void 0===e||e.call(t,A)})),A.onTouchEnd((function(A){var e;A.stopPropagation(),null===(e=t.onLinkTouchEnd)||void 0===e||e.call(t,A)})),n&&(e.onMouseEnter((function(A){A.stopPropagation(),t.addHoverStyles(e,i)})),e.onMouseLeave((function(A){A.stopPropagation(),t.removeHoverStyles(e)})))})),l()(this,"addHoverStyles",(function(A,e){if(0===A.children.filter((function(A){return A.id===B})).length){var n=e.boxX,i=e.boxY,o=e.height,r=e.width,a=function(A,e){var t=A.x,n=A.y,i=A.width,o=A.height,r=A.color;if(0===i||0===o)return null;var a=function(A,e){return"M 0 0 L ".concat(A," 0 L ").concat(A," ").concat(e," L 0 ").concat(e," Z")}(i,o),l=new M.N(a),c=Object(L.a)(r),s=new M.i(c);return l.fill=s,255===s.color.alpha&&(l.stroke=s,l.strokeWidth=1),l.x=t,l.y=n,e&&(l.id=e),l}(P(P({},e),{},{x:n,y:i,height:e.rotate?e.height:o,width:e.rotate?r:e.width,color:"#00000012"}),B);a&&A.addChildAt(a,0)}t.waitRemoveHoverContainer||(t.waitRemoveHoverContainer=A,t.addDomListener())})),l()(this,"removeHoverStyles",(function(A){A.children.filter((function(A){return A.id===B})).forEach((function(e){A.removeChild(e),t.waitRemoveHoverContainer=null,t.removeDomListener()}))})),l()(this,"addDomListener",(function(){document.addEventListener("mouseover",t.removeAllHoverStyles)})),l()(this,"removeDomListener",(function(){document.removeEventListener("mouseover",t.removeAllHoverStyles)})),l()(this,"removeAllHoverStyles",(function(){t.waitRemoveHoverContainer&&(t.removeHoverStyles(t.waitRemoveHoverContainer),t.waitRemoveHoverContainer=null,t.removeDomListener())})),this.getLinkColor=n,this.onLinkMouseEnter=o,this.onLinkMouseLeave=r,this.onLinkClick=a,this.onLinkTouchEnd=c,this.getTextDirection=s,this.linkCursor=d},x=t("d9812f1c6f"),F=t("7f877c3077"),I=t("464ceed456"),U=t("65634518db"),j=t("adb7ad9ee3"),N=t("2d47c066fb");function G(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function H(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?G(Object(t),!0).forEach((function(e){l()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var z=function(){function A(e,t){var n=this;i()(this,A),l()(this,"editorModel",void 0),l()(this,"props",void 0),l()(this,"editorContainer",void 0),l()(this,"services",void 0),l()(this,"valueUpdated",!1),l()(this,"rectUpdated",!1),l()(this,"eventHandlers",void 0),l()(this,"id",void 0),l()(this,"linkHandler",void 0),l()(this,"addHighlight",(function(A,e){var t;null===(t=n.controller)||void 0===t||t.addHighlight(A,e)})),l()(this,"addSearchMark",(function(A,e){var t;null===(t=n.controller)||void 0===t||t.addSearchMark(A,e)})),l()(this,"removeHighlight",(function(){var A;null===(A=n.controller)||void 0===A||A.removeHighlight()})),l()(this,"removeSearchMark",(function(){var A;null===(A=n.controller)||void 0===A||A.removeSearchMark()})),l()(this,"copy",(function(){var A;return null===(A=n.controller)||void 0===A?void 0:A.copy()})),l()(this,"paste",(function(A){var e,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null===(e=n.controller)||void 0===e?void 0:e.paste(A,t)})),l()(this,"cut",(function(){var A;return null===(A=n.controller)||void 0===A?void 0:A.cut()})),l()(this,"emptyParagraph",(function(){var A;null===(A=n.controller)||void 0===A||A.emptyParagraph()})),l()(this,"getExpandedRect",(function(){var A;return null===(A=n.controller)||void 0===A?void 0:A.getExpandedRect()})),l()(this,"getSelectionPara",(function(){var A;return(null===(A=n.controller)||void 0===A?void 0:A.getSelectionPara())||[]})),l()(this,"getSelection",(function(A){var e;return(null===(e=n.controller)||void 0===e?void 0:e.getSelection(A))||null})),l()(this,"setFocus",(function(A,e){var t,i;if(null===(t=n.editor)||void 0===t||!t.readonly){var o;if(!n.editor)null===(o=n.editorContainer)||void 0===o||o.initEditor();null===(i=n.controller)||void 0===i||i.setFocus(A,e)}})),l()(this,"setReadyEditing",(function(){var A,e;null!==(A=n.editor)&&void 0!==A&&A.readonly||(n.editor||n.editorContainer.initEditor(),null===(e=n.controller)||void 0===e||e.setReadyEditing())})),l()(this,"triggerBlur",(function(){var A;null===(A=n.controller)||void 0===A||A.triggerBlur()})),l()(this,"operations",(function(A,e,t){var i;return n.editor||n.editorContainer.initEditor(),!(null===(i=n.controller)||void 0===i||!i.operations(A,e,t))})),l()(this,"updateCursor",(function(){var A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.c;n.editorContainer.updateCursor(n.getCursor(A))})),l()(this,"getTextAreaRectSync",(function(){var A;return(null===(A=n.editor)||void 0===A?void 0:A.getLayoutSize())||{width:0,height:0}})),l()(this,"getAllStyles",(function(){return n.getAllStylesSync()})),l()(this,"getAllStylesSync",(function(){var A=n.collectStyles(),e=A.textBodyStyle,t=A.paraStyleList;return n.mergeStyles(t,e)})),l()(this,"isReadOnly",(function(){return void 0!==n.props.editable&&!n.props.editable})),l()(this,"isSelectable",(function(){return!n.isReadOnly()||void 0!==n.props.selectable&&n.props.selectable})),l()(this,"getData",(function(){return n.getEditorData()})),l()(this,"getEditorHeightByParagraphList",(function(A,e){var t,i,o=n.props.textRect?H({},n.props.textRect):Object(C.b)(),r=H({},n.props.textBodyStyle);e&&(r.bodyStyle=e);var a,l=c.a.convertFromTextModel({paragraphList:A,textBodyStyle:r},{noConvertBack:!0});(null===(t=r.bodyStyle)||void 0===t?void 0:t.whiteSpace)===O.g.NO_WRAP&&(a=d.a.getEditorInlineSize(l,{textRect:o,textBodyStyle:r}));var s=((null===(i=n.props.textBodyStyle)||void 0===i?void 0:i.wrapperStyle)||{}).textDirection,u=Object(k.a)(s);return o[u.inlineSize]=a||(null==o?void 0:o[u.inlineSize]),d.a.getEditorBlockSize(l,{textRect:o,textBodyStyle:r})})),l()(this,"getResizeLevel",(function(){return n.editorModel.resizeLevel})),l()(this,"refreshEditorByProps",(function(){n.editorModel.setRawData({paragraphList:n.props.paragraphList,textBodyStyle:n.props.textBodyStyle,resizeLevel:d.a.getResizeLevel(n.props),slideNum:n.props.slideNum,datetime:n.props.datetime,model:n.props.model},!0,!0)})),l()(this,"unregisterEvent",(function(){var A;null===(A=n.eventHandlers)||void 0===A||A.unregisterEvent()})),l()(this,"dispose",(function(){var A,e,t;(null===(A=n.eventHandlers)||void 0===A||A.unregisterEvent(),n.services.logicService.removeComponentLogic(n),null===(e=n.controller)||void 0===e||e.dispose(),n.props.modelKey)&&(null===(t=n.services.fontManager)||void 0===t||t.disposeFontDownloadCallbackByShapeModelKey(n.props.modelKey,n.onFontDownloadedCallback))})),l()(this,"getTextAreaHeightSync",(function(){var A,e;return(null===(A=n.editorContainer)||void 0===A||null===(e=A.getLayoutSize())||void 0===e?void 0:e.height)||0})),l()(this,"setFocusOrClick",(function(A){var e;n.readonly?(null===(e=n.eventHandlers)||void 0===e||e.handleClick(),null==A||A()):n.setFocus(A)})),l()(this,"getTextLinkState",(function(){var A;return!(null===(A=n.controller)||void 0===A||!A.getTextLinkState())})),l()(this,"getBackDeleteTextProps",(function(){var A;return(null===(A=n.controller)||void 0===A?void 0:A.getBackDeleteTextProps())||[]})),l()(this,"insertText",(function(A,e){var t;null===(t=n.controller)||void 0===t||t.insertText(A,e)})),l()(this,"isExpanded",(function(){var A,e;return(null===(A=n.editor)||void 0===A||null===(e=A.isSelectionExpanded)||void 0===e?void 0:e.call(A))||!1})),l()(this,"setSelectionAll",(function(){var A;return null===(A=n.controller)||void 0===A?void 0:A.setSelectionAll()})),l()(this,"setTextLink",(function(){var A;return!(null===(A=n.controller)||void 0===A||!A.setTextLink())})),l()(this,"triggerRedo",(function(){var A;null===(A=n.controller)||void 0===A||A.triggerRedo()})),l()(this,"triggerUndo",(function(){var A;null===(A=n.controller)||void 0===A||A.triggerUndo()})),l()(this,"setSelectionToEnd",(function(){var A;null===(A=n.controller)||void 0===A||A.setSelectionToEnd()})),l()(this,"triggerSave",(function(){var A;null===(A=n.controller)||void 0===A||A.triggerSave()})),l()(this,"resetValueChangeFlag",(function(){var A;null===(A=n.controller)||void 0===A||A.resetValueChangeFlag()})),l()(this,"updateReadonlyState",(function(A){var e,t,i,o;A&&(null===(o=n.controller)||void 0===o||o.clear());null===(e=n.editor)||void 0===e||e.changeReadonly(A),null===(t=n.eventHandlers)||void 0===t||t.unregisterEvent(),null===(i=n.eventHandlers)||void 0===i||i.registerEvent()})),l()(this,"updateEditorData",(function(){var A;null===(A=n.controller)||void 0===A||A.updateEditorData()})),l()(this,"ifUpdateEditorSurface",(function(){n.editorContainer.ifUpdateEditorSurface()})),l()(this,"onChangeFlagChange",(function(A){n.services.editingStateManager&&(n.services.editingStateManager.hasUnsavedTextContent=A)})),l()(this,"onFontDownloadedCallback",(function(A){n.editorContainer.invalidateMeasureCache(A),n.editor.forceRender()})),l()(this,"updateSelection",(function(A,e){if(A){var t,i,o,r=e?null===(t=n.editor)||void 0===t?void 0:t.rangeUtil.convertToText(A):A;null===(i=n.editor)||void 0===i||i.setSelection(r),null===(o=n.editor)||void 0===o||o.focus()}})),l()(this,"getAppPosition",(function(){var A,e,t,i,o,r=null===(A=n.props)||void 0===A||null===(e=A.getApplication)||void 0===e?void 0:e.call(A);if(!r)return{x:0,y:0};var a=null==r||null===(t=r.view)||void 0===t?void 0:t.native;if(!a)return{x:0,y:0};var l=null!==(i=null==a||null===(o=a.getBoundingClientRect)||void 0===o?void 0:o.call(a))&&void 0!==i?i:{left:0,top:0};return{x:l.left,y:l.top}})),l()(this,"getRenderSize",(function(){return n.editorContainer.getRenderSize()})),l()(this,"getTextRect",(function(A){return A?{x:A.left,y:A.top,width:A.width,height:A.height}:{x:0,y:0,width:E.b,height:E.a}})),l()(this,"generateLinkHandler",(function(){return new D(H(H({onLinkMouseEnter:n.handleLinkMouseEnter,onLinkMouseLeave:n.handleLinkMouseLeave,getLinkColor:n.getLinkColor},x.a.isMobile?{onLinkTouchEnd:n.onLinkTouchEnd}:{onLinkClick:n.onLinkClick}),{},{linkCursor:n.props.linkCursor,getTextDirection:function(){return n.editorModel.textDirection}}))})),l()(this,"collectStyles",(function(){var A;if(n.isEditing){var e=[],t=n.editorContainer.getSelectionProps();(null==t?void 0:t.length)&&t.forEach((function(A){var t=A.paragraphProps,n=A.textProps,i=g.a.getOriginProps(t,"raw-"),o=[];(null==n?void 0:n.length)&&n.forEach((function(A){var e=g.a.getOriginProps(A,"raw-");o.push(e)})),e.push({paraStyle:i,runStyleList:o})}));var i=c.a.convertTextBodyStyle(n.editorContainer.getEditorValue(),!1);return{paraStyleList:e,textBodyStyle:i}}var o=(((null===(A=n.editorContainer)||void 0===A?void 0:A.getEditorValue())||n.editorModel.getEditorValue()).children||[]).map((function(A){return{paraStyle:g.a.getOriginProps(A,"raw"),runStyleList:(A.children||[]).map((function(A){return g.a.getOriginProps(A,"raw-")}))}}));return{textBodyStyle:n.editorContainer.editor?c.a.convertTextBodyStyle(n.editorContainer.getEditorValue(),!1):n.editorModel.getTextBodyStyle(),paraStyleList:o}})),l()(this,"mergeStyles",(function(A,e){if(null==A||!A.length)return{};var t=[];return A.forEach((function(A){var i=H({textAlign:"left",PPTLineHeight:1,lineHeight:1.2},A.paraStyle);i.character||(i.buNone=1);var o=A.runStyleList;Array.isArray(o)&&o.forEach((function(A){var o=n.fixCombineStyle(i,A,e);t.push(o)}))})),Object(v.a)(t)})),l()(this,"fixCombineStyle",(function(A,e,t){var n,i=H(H(H(H({},A),e),{},{alignItems:"flex-start"},null==t?void 0:t.wrapperStyle),null==t?void 0:t.bodyStyle);return i.paraPaddingTop=A.paddingTop,i.paraPaddingBottom=A.paddingBottom,i.fontSize&&(i.fontSize/=y.g),i.character&&((i=H(H({},i),i.character)).character=Object(b.a)(i)),i[f.o]=(n={},l()(n,m.b.NoFill,i.noFill),l()(n,m.b.PattFill,i.pattFill),l()(n,m.b.GradualFill,i.gradFill),l()(n,m.b.ImageFill,i.image),l()(n,m.b.SolidFill,i.color),n),i})),l()(this,"getEditorData",(function(){var A,e,t,i=null===(A=n.editorContainer)||void 0===A?void 0:A.getEditorValue();if(i){var o=n.editorModel.doConvertFromDocElementKeepInheritData(i,!1,!1);e=o.paragraphList,t=o.textBodyStyle}return(!e||e&&!e.length)&&(e=[{paragraphProps:{},textRuns:[{text:"",styles:{}}]}]),t||(t={}),{paragraphList:e,textBodyStyle:t}})),l()(this,"handleLinkMouseEnter",(function(A){var e,t,i,o,r={editable:n.props.editable,modelKey:n.props.modelKey,selected:n.props.selected||(null===(e=(t=n.props).getSelected)||void 0===e?void 0:e.call(t))};null===(i=n.services.linkManager)||void 0===i||i.handleLinkMouseEnter(A,{editor:null!==(o=n.editorContainer.editor)&&void 0!==o?o:void 0,updateDataCB:function(){n.updateEditorData()}},r)})),l()(this,"handleLinkClick",(function(A){n.handleLinkMouseEnter(A)})),l()(this,"handleLinkMouseLeave",(function(A){var e,t,i,o={selected:n.props.selected||(null===(e=(t=n.props).getSelected)||void 0===e?void 0:e.call(t))};null===(i=n.services.linkManager)||void 0===i||i.handleLinkMouseLeave(A,o)})),l()(this,"handleLinkTouchEnd",(function(A){var e,t;null===(e=n.services.linkManager)||void 0===e||e.showLinkFloatBarMobile(A,null!==(t=n.editorContainer.editor)&&void 0!==t?t:void 0)})),l()(this,"getLinkColor",(function(A){var e;return"tx"===(null===(e=A["origin-href"])||void 0===e?void 0:e.colorType)&&A.color?A.color:n.props.linkColor?n.props.linkColor:"#0563C1"})),l()(this,"onLinkClick",(function(A){if(n.props.openLinkInPlay){var e=(A.currentTarget||{}).textElement;n.props.openLinkInPlay(null==e?void 0:e["origin-href"])}else n.handleLinkClick(A)})),l()(this,"onLinkTouchEnd",(function(A){if(n.props.openLinkInPlay){var e=(A.currentTarget||{}).textElement;n.props.openLinkInPlay(null==e?void 0:e["origin-href"])}else n.handleLinkTouchEnd(A)})),l()(this,"getCursor",(function(){var A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.c;return n.editorModel.isVert&&A===F.c?F.d:A})),l()(this,"handleSelectionChange",(function(A,e){var t,i,o;null===(t=n.controller)||void 0===t||t.handleSelectionChange(A,e),null===(i=(o=n.props).handleSelectionChange)||void 0===i||i.call(o)})),l()(this,"onInit",(function(){var A;n.props.modelKey&&(null===(A=n.services.fontManager)||void 0===A||A.registerOnFontDownloadCallback(n.props.modelKey,n.onFontDownloadedCallback))})),l()(this,"handleBeforeLayout",(function(A){var e;return e=n.changeParagraphCharacter(A),n.props.styleRenderCallback?n.filterStyles(A,n.props.styleRenderCallback):e})),l()(this,"filterStyles",(function(A,e){var t,n=A.children;return n=null===(t=n)||void 0===t?void 0:t.map((function(A){var t,n,i,o=null===(t=A["origin-character"])||void 0===t||null===(n=t.buFont)||void 0===n?void 0:n.typeface,r=null===(i=A["origin-character"])||void 0===i?void 0:i.character_bullet_char;return(A=e(A,"paragraph")).characterProps&&(A.characterProps=e(H(H({},A.characterProps),{},{font:o,type:r}),"character")),A.children=A.children.map((function(A){return e(A,"textRun")})),A})),H(H({},e(A,"body")),{},{children:n})})),l()(this,"changeParagraphCharacter",(function(A){var e,t=A.children.map(U.c),i=-1,o=null===(e=n.editor)||void 0===e?void 0:e.getSelectionNodes((function(A){return"paragraph"===A.type}));if(null!=o&&o.length){var r,a=null==o||null===(r=o[0])||void 0===r?void 0:r[1];i=null==a?void 0:a[a.length-1]}var l=!1,c=A.children.map((function(A,e){var o,r=Object(j.a)(t[e],e,t,i,null===(o=n.editor)||void 0===o?void 0:o.isEditing);return r&&(l=!0),H(H({},A),{},{characterProps:r})}));return l?H(H({},A),{},{children:c}):A})),l()(this,"getEditorProps",(function(A){return H(H({},A),{},{id:n.id,rectTextId:N.m,textImgId:N.x,defaultFontFamily:F.a,specificFontFamilies:F.b,platform:n.getPlatform(),preventScrollOnFocus:x.a.isMobile,supportMouseOnTouchScreen:x.a.isPad,rect:n.getTextRect(n.props.textRect),readonly:n.isReadOnly(),value:n.getEditorValue(),noDefaultEvent:!0,needCustomRender:n.linkHandler.isLinkText,getCustomNode:n.linkHandler.getLinkNode,getTextDirection:function(){return n.editorModel.textDirection},cursor:n.getCursor(n.props.cursor),handleKeyDown:function(A){var e;return!(null===(e=n.eventHandlers)||void 0===e||!e.handleKeyDown(A))},onFocus:function(){var A;null===(A=n.eventHandlers)||void 0===A||A.handleEditorFocus()},onBlur:function(){var A;null===(A=n.eventHandlers)||void 0===A||A.handleEditorBlur()},getBackDeleteTextProps:n.getBackDeleteTextProps,onValueChange:function(){var A;null===(A=n.controller)||void 0===A||A.handleValueChange()},onCompositionInput:function(){var A;null===(A=n.controller)||void 0===A||A.handleCompositionInput()},getAppPosition:n.getAppPosition,handleBeforeInput:function(A,e){var t;return null===(t=n.eventHandlers)||void 0===t?void 0:t.handleBeforeInput(A,e)},handleSelectionChange:n.handleSelectionChange,onInit:n.onInit,handleBeforeLayout:n.handleBeforeLayout,onDispose:n.dispose,noExtendProps:[{prop:"origin-fieldType",preNoExtend:!0,afterNoExtend:!0},{prop:"href",preNoExtend:!0,afterNoExtend:!0},{prop:"origin-href",preNoExtend:!0,afterNoExtend:!0},{prop:"origin-raw-href",preNoExtend:!0,afterNoExtend:!0},{prop:"inlineProps",preNoExtend:!0,afterNoExtend:!0}]})})),this.id="".concat(N.w,"-").concat(e.modelKey),this.props=e,this.services=t;var o=Object(C.i)(e.paragraphList||[]);this.linkHandler=this.generateLinkHandler(),this.initEditorData(),this.editorContainer=new p.b(this.getEditorProps(this.props),o),this.services.logicService.setComponentLogic({},this)}return r()(A,[{key:"setEventHandlers",value:function(A){this.eventHandlers=A}},{key:"isEditing",get:function(){var A;return!(null===(A=this.controller)||void 0===A||!A.isEditing)}},{key:"isReadyEditing",get:function(){var A;return!(null===(A=this.controller)||void 0===A||!A.isReadyEditing)}},{key:"isTextEnterable",get:function(){var A;return!(null===(A=this.controller)||void 0===A||!A.isTextEnterable)}},{key:"changeFlag",get:function(){var A;return!(null===(A=this.controller)||void 0===A||!A.changeFlag)}},{key:"readonly",get:function(){var A;return!(null===(A=this.editor)||void 0===A||!A.readonly)}},{key:"updateEditorProps",value:function(A){if(this.props=A,this.linkHandler=this.generateLinkHandler(),this.editorContainer.updateProps(this.getEditorProps(A)),this.shouldEditorUpdate(A))if(this.valueUpdated){var e,t,n,i=this.getEditorValue();null===(e=this.editorContainer)||void 0===e||e.resetValue(i,this.rectUpdated),null===(t=(n=this.props).onStyleChange)||void 0===t||t.call(n,{style:this.getAllStylesSync()})}else if(this.rectUpdated){var o;null===(o=this.editorContainer)||void 0===o||o.changeRect()}this.readonly!==this.isReadOnly()&&this.updateReadonlyState(this.isReadOnly()),this.editorContainer.updateCursor(this.getCursor(this.props.cursor))}},{key:"editor",get:function(){var A;return null===(A=this.editorContainer)||void 0===A?void 0:A.editor}},{key:"getUniqueId",value:function(){return"".concat(this.id,"-").concat(this.props.editable)}},{key:"getComponentType",value:function(){return I.a.TEXTEDITOR}},{key:"shouldEditorUpdate",value:function(A){var e,t=!1;if(this.valueUpdated=!1,this.rectUpdated=!1,A.shouldUpdate)t=this.editorModel.setRawData({paragraphList:A.paragraphList,textBodyStyle:A.textBodyStyle,resizeLevel:d.a.getResizeLevel(A),slideNum:this.props.slideNum,datetime:this.props.datetime,model:this.props.model,linkThemeColor:A.linkColor},!1),this.valueUpdated=t,null===(e=A.resetShouldUpdate)||void 0===e||e.call(A);else if(A.resize){var n,i;t=this.editorModel.setRawData({resizeLevel:d.a.getResizeLevel(A,!1)}),this.valueUpdated=t,null===(n=(i=this.props).setResize)||void 0===n||n.call(i,!1)}var o=this.getTextRect(A.textRect);return Object(S.e)(o,this.editorContainer.textRect)||(this.editorContainer.updateTextRect(o),t=!0,this.rectUpdated=!0),t}},{key:"initEditorData",value:function(){var A=this;this.editorModel=new c.a({paragraphList:this.props.paragraphList,textBodyStyle:Object(s.b)(this.props.textBodyStyle),resizeLevel:d.a.getResizeLevel(this.props),slideNum:this.props.slideNum,datetime:this.props.datetime,noSaveRawData:!0,model:this.props.model,triggerUpdate:function(e,t){var n=A.processEditorValue(e);if(t){var i=A.editorContainer.getEditorValue();A.editorContainer.resetValueWithoutEffect(n);var o=A.editorContainer.getEditorValue();h.b.migrate(i,o)}else{var r;null===(r=A.editorContainer)||void 0===r||r.resetValue(n)}}})}},{key:"processEditorValue",value:function(A){return H(H({},A),{},{tailWhitespaceCalculation:f.l})}},{key:"getEditorValue",value:function(){var A=this.editorModel.getEditorValue();return this.processEditorValue(A)}},{key:"controller",get:function(){var A;return null===(A=this.eventHandlers)||void 0===A?void 0:A.getEditorController()}},{key:"getPlatform",value:function(){return x.a.isIOS?u.k.iosMobile:x.a.isAndroid?u.k.androidMobile:u.k.pc}}]),A}()},"1c66973d9e":function(A,e,t){"use strict";t.d(e,"b",(function(){return S})),t.d(e,"a",(function(){return E}));t("73b854064b");var n=t("547611bd96"),i=t.n(n),o=t("8eec1e4a03"),r=t.n(o),a=t("bd29e2df90"),l=t.n(a),c=t("ab5eb40518"),s=t.n(c),d=t("1b4cdd6a36"),u=t.n(d),p=t("9132715560"),h=t.n(p),f=t("6a364eb35c"),v=t.n(f),g=t("85d0a7609b"),y=t.n(g),m=(t("8e7cce0ada"),t("c6244f7705"),t("85d48ef22b"),t("ab67fd3ad5"),t("2a6f332b5e"),t("6e20b6a7d8"),t("c9a7ecac4d"),t("8aebbf296a"),t("8ee19818c4"),t("6c458f1652"),t("2d47c066fb")),b=t("0ef3962c55");function C(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=u()(A);if(e){var i=u()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return s()(this,t)}}var S=new(function(){function A(){h()(this,A),y()(this,"map",new WeakMap)}return v()(A,[{key:"link",value:function(A,e){var t;this.map.has(A)||this.map.set(A,new Set),null===(t=this.map.get(A))||void 0===t||t.add(e)}},{key:"get",value:function(A){return Array.from(this.map.get(A)||[])}},{key:"unlink",value:function(A,e){if(this.map.has(A)){var t=this.map.get(A);null==t||t.delete(e),null!=t&&t.size||this.map.delete(A)}}},{key:"migrate",value:function(A,e){var t=this,n=A.children,i=void 0===n?[]:n,o=e.children,r=void 0===o?[]:o;i.forEach((function(A,e){var n=r[e];if(A&&n){var i=A.children,o=void 0===i?[]:i,a=n.children,l=void 0===a?[]:a;o.forEach((function(A,e){var n=l[e];if(t.map.has(A)){var i=t.map.get(A)||new Set;i.forEach((function(A){A.updateTextElement(n)})),t.map.set(n,i),t.map.delete(A)}}))}}))}}]),A}()),E=function(A){l()(t,A);var e=C(t);function t(A,n,o){var r;return h()(this,t),r=e.call(this,A,n),y()(i()(r),"textElement",void 0),r.textElement=o,S.link(o,i()(r)),r.id=m.h,r}return v()(t,[{key:"updateTextElement",value:function(A){this.textElement=A}},{key:"dispose",value:function(){r()(u()(t.prototype),"dispose",this).call(this),S.unlink(this.textElement,this)}}]),t}(b.a)},"1e07095161":function(A,e,t){"use strict";t.d(e,"c",(function(){return v})),t.d(e,"i",(function(){return g})),t.d(e,"h",(function(){return y})),t.d(e,"a",(function(){return m})),t.d(e,"g",(function(){return b})),t.d(e,"b",(function(){return C})),t.d(e,"j",(function(){return S})),t.d(e,"e",(function(){return E})),t.d(e,"f",(function(){return O})),t.d(e,"d",(function(){return k}));t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("bcb5d93d36"),t("c6244f7705"),t("b1e2246d82"),t("8aebbf296a"),t("f45588a8ad"),t("de37db1287");var n=t("14502724a6"),i=t.n(n),o=t("85d0a7609b"),r=t.n(o),a=t("0cf3719522"),l=t.n(a),c=(t("8ee19818c4"),t("0acdc5834b"),t("342844cefa"),t("963f2eaace"),t("b8217400dc"),t("e6f68cdf2e"),t("85d48ef22b"),t("8e7cce0ada"),t("2a6f332b5e"),t("c73625d763")),s=t.n(c),d=(t("2a5f3314a4"),t("565a44e3b1"),t("e0e8dd9366")),u=t("eabf3daf43"),p=t("aa3cc80657");function h(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function f(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?h(Object(t),!0).forEach((function(e){r()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function v(A){var e=null==A?void 0:A.children,t=[];return e.forEach((function(A,e){var n=(A.children||[]).reduce((function(A,e){return A+e.text}),"");t.push({paraIndex:e,text:n})})),t}function g(A){if(A&&"object"===l()(A)){var e={};return Object.keys(A).forEach((function(t){e[t]=A[t],e["origin-".concat(t)]=A[t],e["origin-raw-".concat(t)]=!0})),e}}function y(A,e){return{wrapperStyle:f(f({},A.wrapperStyle),e.wrapperStyle),bodyStyle:f(f({},A.bodyStyle),e.bodyStyle),autoFitType:s()(e,".autoFitType")?e.autoFitType:A.autoFitType}}function m(A,e){var t,n,o=i()(A.path,2),r=o[0],a=o[1],l=null===(t=e[r])||void 0===t||null===(n=t.children)||void 0===n?void 0:n.slice(0,a);if(l){var c=l.reduce((function(A,e){var t;return A+((null===(t=e.text)||void 0===t?void 0:t.length)||0)}),0);return{path:A.path,offset:c+A.offset}}return A}function b(A,e){var t,n,i=(null==A||null===(t=A.props)||void 0===t?void 0:t.style)||{},o=i.fillBackground,r=i.border,a=Object(u.i)(e||A.paragraphList),l=(null==r?void 0:r.color)&&"none"!==r.color||(null==r?void 0:r.gradFill),c=o&&1!==(null==o?void 0:o.noFill),s=[d.d.SLIDE,d.d.MASTER,d.d.LAYOUT].includes(null===(n=A.parent)||void 0===n?void 0:n.type);return a&&!l&&!c&&s}function C(A){var e=0;return null==A||A.forEach((function(A){var t;null===(t=A.textRuns)||void 0===t||t.forEach((function(A){var t;e+=(null==A||null===(t=A.text)||void 0===t?void 0:t.length)||0}))})),e}function S(A){Array.isArray(A)&&A.forEach((function(A){var e=A.textRuns;Array.isArray(e)&&e.forEach((function(A){var e;null!==(e=A.styles)&&void 0!==e&&e.lang||(A.styles=A.styles||{},function(A,e){if(Object(p.b)(A))if("ea"===e.lang&&Object(p.b)(A))e.lang="latin";else{var t;e.lang=null!==(t=e.lang)&&void 0!==t?t:"latin"}else e.lang="ea"}(A.text,A.styles))}))}))}function E(A){var e=A["origin-character"];return!!e&&!(!e.character||e.buNone)}function O(A,e){return A.path[0]===e.path[0]&&0===A.offset&&0===e.offset}function k(A){var e=[];return A.forEach((function(A,t){var n=(A.textRuns||[]).reduce((function(A,e){return A+e.text}),"");e.push({paraIndex:t,text:n})})),e}},"2a875dc68f":function(A,e,t){"use strict";t.d(e,"a",(function(){return M}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("547611bd96"),l=t.n(a),c=t("8eec1e4a03"),s=t.n(c),d=t("bd29e2df90"),u=t.n(d),p=t("ab5eb40518"),h=t.n(p),f=t("1b4cdd6a36"),v=t.n(f),g=t("85d0a7609b"),y=t.n(g),m=(t("6e20b6a7d8"),t("8a35b54c1d"),t("516fa97df2")),b=t("e0e8dd9366"),C=t("3f95c26bbc"),S=t("4560412a08"),E=t("d5c3deb8c7"),O=t("37091e4240");function k(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return h()(this,t)}}var M=function(A){u()(t,A);var e=k(t);function t(A,n,o,r,a,c,s,d,u,p){var h;i()(this,t),h=e.call(this),y()(l()(h),"slideModel",void 0),y()(l()(h),"getPageScale",void 0),y()(l()(h),"getApplication",void 0),y()(l()(h),"elements",[]),y()(l()(h),"inheritType",void 0),y()(l()(h),"region",void 0),y()(l()(h),"fromScale",void 0),y()(l()(h),"fromMasterLayout",void 0),y()(l()(h),"masterLayoutReaction",void 0),y()(l()(h),"slideNumberReaction",void 0),y()(l()(h),"variable",void 0),y()(l()(h),"uiDataService",void 0),y()(l()(h),"mediaManager",void 0),y()(l()(h),"editingStateManager",void 0),y()(l()(h),"animBrushManager",void 0),y()(l()(h),"formatBrushManager",void 0),y()(l()(h),"handleStableLayerUpdate",void 0),y()(l()(h),"infrastructureService",void 0),y()(l()(h),"previewService",void 0),y()(l()(h),"fontManager",void 0),y()(l()(h),"linkManager",void 0),y()(l()(h),"masterLayoutEditService",void 0),y()(l()(h),"onUpdate",(function(){var A,e;null===(A=(e=h).handleStableLayerUpdate)||void 0===A||A.call(e,{slideModel:h.slideModel,fromInheritLayer:!0})}));var f=s.uiDataService,v=s.mediaManager,g=s.previewService,m=s.masterLayoutEditService,b=s.editingStateManager,C=s.formatBrushManager,S=s.infrastructureService,E=s.fontManager,O=s.linkManager,k=s.animBrushManager;return h.slideModel=n,h.getPageScale=o,h.getApplication=r,h.infrastructureService=S,h.uiDataService=f,h.mediaManager=v,h.linkManager=O,h.editingStateManager=b,h.animBrushManager=k,h.formatBrushManager=C,h.previewService=g,h.fontManager=E,h.masterLayoutEditService=m,h.inheritType=A,h.region=a,h.fromScale=c,h.fromMasterLayout=!!d,h.variable=!!u,h.handleStableLayerUpdate=p,h.addMasterLayoutReaction(),h._addUpdateListener(h.onUpdate),h}return r()(t,[{key:"dispose",value:function(){var A,e;s()(v()(t.prototype),"dispose",this).call(this),null===(A=this.masterLayoutReaction)||void 0===A||A.call(this),null===(e=this.slideNumberReaction)||void 0===e||e.call(this),this.getPageScale=void 0,this.getApplication=void 0}},{key:"updateSlideModel",value:function(A,e){var t=this;this.slideModel=A,this.inheritType=e;var n,i=this.getChildrenOmitPL();i&&(null===(n=this.slideNumberReaction)||void 0===n||n.call(this),this.slideNumberReaction=Object(E.r)((function(){return i.map((function(A){return null==A?void 0:A.hasSlideNum}))}),(function(){return t.rebuildChildren()})));this.rebuildChildren()}},{key:"getElements",value:function(){return this.elements}},{key:"getInheritType",value:function(){return this.inheritType}},{key:"generateRawRenderData",value:function(A){return s()(v()(t.prototype),"generateRawRenderData",this).call(this,A)}},{key:"getMasterLayoutModel",value:function(){var A=this.slideModel.presentationRef;if(A&&this.slideModel.sdkData){if(this.inheritType===b.d.MASTER){var e,t,n=null===(e=A.getMasterChildrenMapKey)||void 0===e?void 0:e.call(A,this.slideModel.sdkData);return null===(t=A.masterList)||void 0===t?void 0:t.filter((function(A){return(null==A?void 0:A.id)===n}))[0]}if(this.inheritType===b.d.LAYOUT){var i,o,r=null===(i=A.getLayoutChildrenMapKey)||void 0===i?void 0:i.call(A,this.slideModel.sdkData);return null===(o=A.layoutList)||void 0===o?void 0:o.filter((function(A){return(null==A?void 0:A.id)===r}))[0]}}}},{key:"addMasterLayoutReaction",value:function(){var A=this,e=this.getMasterLayoutModel();e?this.masterLayoutReaction=Object(E.r)((function(){return e.childrenConverted}),(function(){return A.rebuildChildren()})):O.b.once(O.a.ALL_SLIDE_DATA_CONVERT,(function(){var e=A.getMasterLayoutModel();e&&(e.childrenConverted?A.rebuildChildren():A.masterLayoutReaction=Object(E.r)((function(){return e.childrenConverted}),(function(){return A.rebuildChildren()})))}))}},{key:"rebuildChildren",value:function(){var A,e,t,n=null!==(A=this.getChildrenOmitPL())&&void 0!==A?A:[];this.variable?n=null===(e=n)||void 0===e?void 0:e.filter((function(A){var e;return null==A||null===(e=A.hasSlideNumber)||void 0===e?void 0:e.call(A)})):n=null===(t=n)||void 0===t?void 0:t.filter((function(A){var e;return!(null!=A&&null!==(e=A.hasSlideNumber)&&void 0!==e&&e.call(A))}));this.elements=n;var i=C.a.getInstance();Object(S.a)({canvasLayer:this,canvasArr:this.children,modelsArr:this.elements,componentFactoryOptions:{model:null,getPageScale:this.getPageScale,getApplication:this.getApplication,region:this.region,fromScale:this.fromScale,logicService:i,fromMasterLayout:this.fromMasterLayout,slideModel:this.slideModel,infrastructureService:this.infrastructureService,uiDataService:this.uiDataService,mediaManager:this.mediaManager,editingStateManager:this.editingStateManager,animBrushManager:this.animBrushManager,formatBrushManager:this.formatBrushManager,previewService:this.previewService,fontManager:this.fontManager,linkManager:this.linkManager,masterLayoutEditService:this.masterLayoutEditService}})}},{key:"getChildrenOmitPL",value:function(){var A=this.slideModel.presentationRef;if(A&&this.slideModel.sdkData){var e,t;if(this.inheritType===b.d.MASTER)return null===(e=A.getMasterChildrenOmitPLByModel)||void 0===e?void 0:e.call(A,this.slideModel);if(this.inheritType===b.d.LAYOUT)return null===(t=A.getLayoutChildrenOmitPLByModel)||void 0===t?void 0:t.call(A,this.slideModel)}}}]),t}(m.k)},"2d47c066fb":function(A,e,t){"use strict";t.d(e,"o",(function(){return n})),t.d(e,"n",(function(){return i})),t.d(e,"g",(function(){return o})),t.d(e,"f",(function(){return r})),t.d(e,"e",(function(){return a})),t.d(e,"c",(function(){return l})),t.d(e,"b",(function(){return c})),t.d(e,"p",(function(){return s})),t.d(e,"w",(function(){return d})),t.d(e,"m",(function(){return u})),t.d(e,"x",(function(){return p})),t.d(e,"h",(function(){return h})),t.d(e,"v",(function(){return f})),t.d(e,"t",(function(){return v})),t.d(e,"r",(function(){return g})),t.d(e,"u",(function(){return y})),t.d(e,"s",(function(){return m})),t.d(e,"q",(function(){return b})),t.d(e,"k",(function(){return C})),t.d(e,"j",(function(){return S})),t.d(e,"i",(function(){return E})),t.d(e,"a",(function(){return O})),t.d(e,"y",(function(){return k})),t.d(e,"l",(function(){return M})),t.d(e,"d",(function(){return L}));var n="slide-canvas",i="canvas-shape",o="canvas-image",r="canvas-img-foreground",a="canvas-group",l="canvas-chart",c="canvas-chart-component",s="canvas-smart-art-component",d="canvas-text-editor",u="canvas-rect-text",p="canvas-text-image",h="canvas-link-text",f="canvas-table-node",v="canvas-table-cell",g="canvas-table-bg-cell",y="canvas-table-select-cell",m="canvas-table-container-cell",b="canvas-table-border",C="canvas_placeholder_table",S="canvas_placeholder_img",E="canvas-path-render",O="canvas-anim-wrapper",k="canvas-wrapper",M="slide-player-canvas",L="canvas-connector"},"33e561419d":function(A,e,t){"use strict";t.d(e,"a",(function(){return b}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("547611bd96"),r=t.n(o),a=t("bd29e2df90"),l=t.n(a),c=t("ab5eb40518"),s=t.n(c),d=t("1b4cdd6a36"),u=t.n(d),p=t("85d0a7609b"),h=t.n(p),f=(t("a2a09da1e3"),t("c3df4c6e22")),v=t("ffc220634f"),g=t("db50d57b55"),y=t("5693a1ecb5");function m(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=u()(A);if(e){var i=u()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return s()(this,t)}}var b=function(A){l()(t,A);var e=m(t);function t(A,n){var o;return i()(this,t),o=e.call(this,A,n),h()(r()(o),"handleEditorClick",(function(A){var e,t,n=o.componentOptions.model,i=Object(v.h)(n);[g.a.BODY,g.a.CTRTITLE,g.a.SUBTITLE,g.a.TXT,g.a.TITLE,g.a.SLIDENUM,g.a.DATETIME,g.a.FOOT,g.a.TBL,g.a.PIC].indexOf(i)>-1&&(null===(e=(t=o.component).clickCallBack)||void 0===e||e.call(t,g.a.TXT,A));null==A||A.stopPropagation()})),h()(r()(o),"handleChange",(function(A){var e=A.paragraphList,t=A.textBodyStyle,n=o.componentOptions.model;null==n||n.updateParagraphList(Object(y.e)(e),t)})),o.component.setEventHandlers({textEditorClickCallback:o.handleEditorClick,textEditorChangeCallback:o.handleChange}),o}return t}(f.a)},"38e890ab81":function(A,e,t){"use strict";t.d(e,"a",(function(){return B})),t.d(e,"b",(function(){return x}));var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("85d0a7609b"),l=t.n(a),c=(t("8ee19818c4"),t("8e7cce0ada"),t("29f8c5f672"),t("c6244f7705"),t("85d48ef22b"),t("2a6f332b5e"),t("73b854064b"),t("547611bd96")),s=t.n(c),d=t("bd29e2df90"),u=t.n(d),p=t("ab5eb40518"),h=t.n(p),f=t("1b4cdd6a36"),v=t.n(f),g=t("d5c3deb8c7"),y=t("90b8297389"),m=t("3f95c26bbc"),b=t("41e949fe83"),C=t("ec5cae33cb");function S(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return h()(this,t)}}var E=function(A){u()(t,A);var e=S(t);function t(A){var n;return i()(this,t),n=e.call(this,A),l()(s()(n),"reaction",void 0),n}return r()(t,[{key:"init",value:function(){var A=this;this.reaction||(this.reaction=Object(g.r)((function(){var e,t;return null===(e=A.getAppServices().editableServiceLayer)||void 0===e||null===(t=e.tempElementManager)||void 0===t?void 0:t.getTempElements()}),(function(e){null!=e&&e.length?A.buildTempElements(e):A.clearTempElements()})))}},{key:"dispose",value:function(){var A;null===(A=this.reaction)||void 0===A||A.call(this),this.reaction=null}},{key:"buildTempElements",value:function(){var A=this;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reverse().forEach((function(e){var t,n=new y.a({getPageScale:function(){return A.scale},region:C.a.EDITOR,fromScale:0,logicService:new m.a,getApplication:function(){return A.application},model:e,infrastructureService:A.getAppServices().getInfrastructureService(),uiDataService:A.getAppServices().getUiDataService(),mediaManager:A.getAppServices().viewableServiceLayer.mediaManager,addonManager:A.getAppServices().viewableServiceLayer.addonManager,attachmentManager:A.getAppServices().viewableServiceLayer.attachmentManager,editingStateManager:A.getAppServices().viewableServiceLayer.editingStateManager,formatBrushManager:null===(t=A.getAppServices().editableServiceLayer)||void 0===t?void 0:t.formatBrushManager,rightSideBarService:A.getAppServices().viewableServiceLayer.rightSideBarService,linkManager:A.getAppServices().viewableServiceLayer.linkManager}).getWrapper();A.updateComponents(n)}))}},{key:"clearTempElements",value:function(){this.clearAllComponent()}}]),t}(b.a),O=t("465627d7c5"),k=t("530271770f");function M(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return h()(this,t)}}var L=function(A){u()(t,A);var e=M(t);function t(A){var n;return i()(this,t),n=e.call(this,A),l()(s()(n),"snapLineComponent",void 0),l()(s()(n),"reaction",void 0),n}return r()(t,[{key:"init",value:function(){var A=this;this.reaction||(this.reaction=Object(g.r)((function(){return k.a.getInstance().getActiveSnapLines()}),(function(e){A.buildSnapLineOuter(e)})))}},{key:"dispose",value:function(){var A;null===(A=this.reaction)||void 0===A||A.call(this),this.reaction=null}},{key:"buildSnapLineOuter",value:function(){var A,e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];null===(A=this.snapLineComponent)||void 0===A||A.dispose(),null===(e=this.renderArea)||void 0===e||e.clearAllComponent(),null!=t&&t.length&&(this.snapLineComponent=new O.a(t,this.scale),this.renderArea.updateComponents(this.snapLineComponent))}}]),t}(b.a),T=(t("8a35b54c1d"),t("342844cefa"),t("6d1a03b824")),w=t("7ad4a16d65"),R=t("f9193d718f");function P(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return h()(this,t)}}var B,D=function(A){u()(t,A);var e=P(t);function t(A){var n;return i()(this,t),n=e.call(this,A),l()(s()(n),"slideGuideComponent",void 0),l()(s()(n),"masterGuideComponent",void 0),l()(s()(n),"layoutGuideComponent",void 0),l()(s()(n),"reaction",void 0),l()(s()(n),"isShowHistoryPanel",!1),l()(s()(n),"getAppService",(function(){return R.a.getInstance().getAppServices()})),n.renderArea=new w.a(n.width,n.height,n.scale,n.application,n.renderRectConfig,!0),n.buildGuideLine(),n.reaction=Object(g.r)((function(){var A;return[null===(A=n.getAppService().editableServiceLayer)||void 0===A?void 0:A.masterLayoutEditService.editType]}),(function(){requestAnimationFrame((function(){n.buildGuideLine()}))})),n}return r()(t,[{key:"dispose",value:function(){var A;null===(A=this.reaction)||void 0===A||A.call(this),this.reaction=null}},{key:"updateWithData",value:function(A){var e,t,n,i=this,o=A.width,r=A.height,a=A.scale,l=A.renderRectConfig,c=this.getAppServices().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),s=c.slideLeft,d=c.slideTop,u=l||{},p=u.currentScrollX,h=void 0===p?0:p,f=u.currentScrollY,v=void 0===f?0:f,g=u.contentSize,y=void 0===g?{}:g,m=Object.keys(y).filter((function(A){var e,t;return y[A]!==(null===(e=i.renderRectConfig)||void 0===e||null===(t=e.contentSize)||void 0===t?void 0:t[A])}));this.width===o&&this.height===r&&this.scale===a&&this.left===s&&this.top===d&&this.currentScrollX===h&&this.currentScrollY===v&&0===m.length&&this.isShowHistoryPanel===(null===(e=this.getAppService().editableServiceLayer)||void 0===e?void 0:e.historyManager.isShowHistoryPanel)||(this.isShowHistoryPanel=null!==(t=null===(n=this.getAppService().editableServiceLayer)||void 0===n?void 0:n.historyManager.isShowHistoryPanel)&&void 0!==t&&t,this.width=o,this.height=r,this.left=s,this.top=d,this.scale=a,this.currentScrollX=h,this.currentScrollY=v,this.renderRectConfig=l,this.updateInfo(o,r,a,l))}},{key:"updateInfo",value:function(A,e,t,n){var i=Math.round(A),o=Math.round(e);this.scale=t,this.application.width=i,this.application.height=o,this.application.stage.transform.scaleX=t,this.application.stage.transform.scaleY=t;var r=R.a.getInstance().getAppServices().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize();r.slideLeft,r.slideTop;if(n){this.renderRectConfig=n;var a=n.contentSize,l=n.scrollLeft,c=n.scrollTop,s=n.currentScrollX,d=void 0===s?0:s,u=n.currentScrollY,p=void 0===u?0:u;a.left+l+d,a.top+c+p}this.buildGuideLine(),this.application.requestRender()}},{key:"buildGuideLine",value:function(){this.slideGuideComponent?this.slideGuideComponent.renderGuides():(this.slideGuideComponent=new T.b({type:T.a.slide,isUiComponent:!0}),this.renderArea.updateComponents(this.slideGuideComponent)),this.masterGuideComponent?this.masterGuideComponent.renderGuides():(this.masterGuideComponent=new T.b({type:T.a.master,isUiComponent:!0}),this.renderArea.updateComponents(this.masterGuideComponent)),this.layoutGuideComponent?this.layoutGuideComponent.renderGuides():(this.layoutGuideComponent=new T.b({type:T.a.layout,isUiComponent:!0}),this.renderArea.updateComponents(this.layoutGuideComponent))}}]),t}(b.a);!function(A){A[A.TEMP=0]="TEMP",A[A.SNAPLINE=1]="SNAPLINE",A[A.GUIDE=2]="GUIDE"}(B||(B={}));var x=function(){function A(){var e=this;i()(this,A),l()(this,"renderServiceList",void 0),l()(this,"updatePosition",(function(A){e.renderServiceList.forEach((function(e){null==e||e.updatePosition(A)}))})),this.renderServiceList=new Map}return r()(A,[{key:"initLayer",value:function(A,e){this.renderServiceList.get(e)||(e===B.TEMP&&this.renderServiceList.set(e,new E(A)),e===B.SNAPLINE&&this.renderServiceList.set(e,new L(A)),e===B.GUIDE&&this.renderServiceList.set(e,new D(A)))}},{key:"dispose",value:function(){this.renderServiceList.forEach((function(A){A.dispose()}))}},{key:"updateWithData",value:function(A){this.renderServiceList.forEach((function(e){e.updateWithData(A)}))}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new A),this.instance}}]),A}();l()(x,"instance",void 0)},"41e949fe83":function(A,e,t){"use strict";t.d(e,"a",(function(){return p}));var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("85d0a7609b"),l=t.n(a),c=(t("8a35b54c1d"),t("342844cefa"),t("516fa97df2")),s=t("1068873c4f"),d=t("7ad4a16d65"),u=t("f9193d718f"),p=function(){function A(e){i()(this,A),l()(this,"application",void 0),l()(this,"renderArea",void 0),l()(this,"canvasElement",void 0),l()(this,"scale",void 0),l()(this,"width",void 0),l()(this,"height",void 0),l()(this,"left",void 0),l()(this,"top",void 0),l()(this,"currentScrollX",void 0),l()(this,"currentScrollY",void 0),l()(this,"renderRectConfig",void 0);var t=e.scale,n=e.width,o=e.height,r=e.canvasElement,a=e.renderRectConfig;this.scale=t,this.width=n,this.height=o;var u=this.getAppServices().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),p=u.slideLeft,h=u.slideTop;this.left=p,this.top=h,this.canvasElement=r,this.renderRectConfig=a;var f=new s.c;this.application=new c.a(f,{native:r,interactive:!1}),this.application.resolution=Math.ceil(window.devicePixelRatio),this.setScale(t),this.renderArea=new d.a(this.width,this.height,this.scale,this.application,a),this.init()}return r()(A,[{key:"getApplication",value:function(){return this.application}},{key:"getRenderArea",value:function(){return this.renderArea}},{key:"init",value:function(){}},{key:"dispose",value:function(){}},{key:"updateComponents",value:function(A){this.renderArea.updateComponents(A)}},{key:"clearComponents",value:function(A){this.renderArea.clearComponent(A)}},{key:"clearAllComponent",value:function(){this.renderArea.clearAllComponent()}},{key:"setScale",value:function(A){var e=this.getAppServices().getUiDataService().presentation.props.slideWidth*A,t=this.getAppServices().getUiDataService().presentation.props.slideHeight*A;this.application.width=e,this.application.height=t,this.application.stage.transform.scaleX=A,this.application.stage.transform.scaleY=A,this.application.requestRender()}},{key:"updateWithData",value:function(A){var e=this,t=A.width,n=A.height,i=A.scale,o=A.renderRectConfig,r=this.getAppServices().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),a=r.slideLeft,l=r.slideTop,c=o||{},s=c.currentScrollX,d=void 0===s?0:s,u=c.currentScrollY,p=void 0===u?0:u,h=c.contentSize,f=void 0===h?{}:h,v=Object.keys(f).filter((function(A){var t,n;return f[A]!==(null===(t=e.renderRectConfig)||void 0===t||null===(n=t.contentSize)||void 0===n?void 0:n[A])}));this.width===t&&this.height===n&&this.scale===i&&this.left===a&&this.top===l&&this.currentScrollX===d&&this.currentScrollY===p&&0===v.length||(this.width=t,this.height=n,this.left=a,this.top=l,this.scale=i,this.currentScrollX=d,this.currentScrollY=p,this.renderRectConfig=o,this.renderArea.updateInfo(t,n,i,o))}},{key:"updatePosition",value:function(A){this.renderArea.updatePosition(A)}},{key:"getAppServices",value:function(){return u.a.getInstance().getAppServices()}}]),A}()},"4560412a08":function(A,e,t){"use strict";t.d(e,"a",(function(){return u}));var n=t("85d0a7609b"),i=t.n(n),o=(t("6e20b6a7d8"),t("c6244f7705"),t("bd80bf2d0f"),t("8ee19818c4"),t("963f2eaace"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("bcb5d93d36"),t("90b8297389")),r=t("d5c3deb8c7"),a=t("d3d31c86eb"),l=t("9da6335152");function c(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function s(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?c(Object(t),!0).forEach((function(e){i()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function d(A,e){e&&A.factoryUpdateComponent()}function u(A){var e=A.canvasLayer,t=A.canvasArr,n=void 0===t?[]:t,i=A.modelsArr,c=void 0===i?[]:i,u=A.componentFactoryOptions,p=A.componentNeedUpdate,h=void 0!==p&&p,f=function(A,e){var t={},n=A.map((function(A){var e,n,i=null==A||null===(e=A.factoryOptions)||void 0===e||null===(n=e.model)||void 0===n?void 0:n.key;return t[i]=A,i})),i={},o=e.map((function(A){var e=null==A?void 0:A.key;return i[e]=A,e}));return{canvasKeyMap:t,canvasKeyArr:n,modelsKeyMap:i,modelsKeyArr:o}}(n,c),v=f.canvasKeyMap,g=f.canvasKeyArr,y=f.modelsKeyMap,m=f.modelsKeyArr;if(h||g.toString()!==m.toString()){var b=Date.now();Object(r.w)((function(){try{n.slice().forEach((function(A){var t,n,i,o;null!=A&&A.wrapperInstance&&null!=A&&null!==(t=A.factoryOptions)&&void 0!==t&&null!==(n=t.model)&&void 0!==n&&n.key&&!y[null==A||null===(i=A.factoryOptions)||void 0===i||null===(o=i.model)||void 0===o?void 0:o.key]&&(e.removeChild(A),A.dispose())})),c.slice().forEach((function(A,t){if(e.children.length<=t){var n=new o.a(s(s({},u),{},{model:A})).getWrapper();e.addChildAt(n,t)}else{var i,r,a=e.children[t];if((null==a||null===(i=a.factoryOptions)||void 0===i||null===(r=i.model)||void 0===r?void 0:r.key)!==A.key)if(v[A.key]){var l=v[A.key];e.removeChild(l),e.addChildAt(l,t),d(l,h)}else{var c=new o.a(s(s({},u),{},{model:A})).getWrapper();e.addChildAt(c,t)}else d(a,h)}}))}catch(A){window.log.error("[canvas-sync-build-tree]:".concat(A)),Object(a.c)({opername:l.e.PPT_QUALITY,module:l.d.CANVAS_RENDERER,action:l.b.CANVAS_RENDERER_BUILD_TREE,ver6:JSON.stringify({errorMsg:A.message,async:0})})}})),window&&!window.firstCanvasBuildTreeTime&&(window.firstCanvasBuildTreeTime=Date.now()-b)}}},"4620eb5562":function(A,e,t){"use strict";t.d(e,"a",(function(){return O}));t("73b854064b"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("547611bd96"),l=t.n(a),c=t("bd29e2df90"),s=t.n(c),d=t("ab5eb40518"),u=t.n(d),p=t("1b4cdd6a36"),h=t.n(p),f=t("85d0a7609b"),v=t.n(f),g=(t("3bf1976a4f"),t("516fa97df2")),y=t("4560412a08"),m=t("2d47c066fb"),b=t("e388ef2636");function C(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function S(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?C(Object(t),!0).forEach((function(e){v()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function E(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var O=function(A){s()(t,A);var e=E(t);function t(A){var n;i()(this,t),n=e.call(this),v()(l()(n),"factoryOptions",void 0),v()(l()(n),"needMouseUp",void 0),v()(l()(n),"hasDidMount",!1),v()(l()(n),"updateComponent",(function(){var A=n.factoryOptions.editingStateManager;null!=A&&A.isRotating||null!=A&&A.isResizing||(Object(y.a)({canvasLayer:l()(n),canvasArr:n.children,modelsArr:n.factoryOptions.model.children,componentFactoryOptions:n.childFactoryOption(null),componentNeedUpdate:!0}),n.hasDidMount||(n.componentDidMount(),n.hasDidMount=!0))})),n.factoryOptions=A,n.factoryOptions.asyncBuild||n.updateComponent();var o=n.factoryOptions.model;return n.id="".concat(m.e,"-").concat(o.key),n}return r()(t,[{key:"childFactoryOption",value:function(A){return S(S({},this.factoryOptions),{},{model:A,isGroupChildren:!0})}},{key:"componentDidMount",value:function(){var A=this.factoryOptions.model;b.a.caculateItemValues(A)}}]),t}(g.k)},"4b36a541c0":function(A,e,t){"use strict";t.d(e,"a",(function(){return y}));var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("85d0a7609b"),l=t.n(a),c=t("e5a826a0ff"),s=t("d9812f1c6f"),d=t("e0e8dd9366"),u=t("1acc787c14"),p=t("b684da8955"),h=t("5cdbac46e8"),f=t("9da6335152"),v=t("d3d31c86eb"),g=t("f9193d718f"),y=function(){function A(e){var t=this;i()(this,A),l()(this,"needMouseUp",void 0),l()(this,"findRootGroupMouseDown",(function(A,e){Object(p.a)(e,(function(n){n.isRootGroup&&t.handleMouseDownPresenter(A,e,n)}))})),l()(this,"findRootGroupMouseUp",(function(A,e){Object(p.a)(e,(function(n){n.isRootGroup&&t.handleMouseUpPresenter(A,e)}))})),l()(this,"updateSelectedElement",(function(A,e){var n,i,o;if(0===(null===(n=t.factoryOptions.selectionService)||void 0===n?void 0:n.selectedElements.selectedArrayForType(c.a.GROUP).length))t.needMouseUp=!0,A.stopPropagation();else if(A.stopPropagation(),A.nativeEvent.metaKey||A.nativeEvent.shiftKey||A.nativeEvent.ctrlKey)e.selected?t.needMouseUp=!0:(null===(i=t.factoryOptions.selectionService)||void 0===i||i.selectedElements.add(e),t.reportOnSelect(e));else if(!e.selected){var r,a,l;null===(r=t.factoryOptions.selectionService)||void 0===r||r.selectedElements.clear(c.a.GROUP),null===(a=t.factoryOptions.selectionService)||void 0===a||a.selectedElements.add(e),t.reportOnSelect(e),null===(l=t.factoryOptions.editingStateManager)||void 0===l||l.updateElementCropState(!1)}s.a.isPc&&e.type!==d.d.TABLE&&t.getAppServices().viewableServiceLayer.userPriviledgeService.isEditable()&&(null===(o=t.getAppServices().editableServiceLayer)||void 0===o||o.dragElementHandler.handleMouseDownOnElement(A,e,t.factoryOptions.getPageScale(),t.needMouseUp,(function(){t.needMouseUp=!1})))})),l()(this,"handleMouseDownPresenter",(function(A,e,n){var i,o,r;t.getAppServices().getEntryType()===u.a.PC_EDIT&&(null===(o=t.getAppServices().editableServiceLayer)||void 0===o||null===(r=o.selectedAnims)||void 0===r||r.clear());n.selected&&1===(null===(i=t.factoryOptions.selectionService)||void 0===i?void 0:i.selectedElements.selectedArrayForType(c.a.SLIDE).length)&&(t.tdwHandleMouseDown(e),t.updateSelectedElement(A,e))})),l()(this,"handleMouseUpPresenter",(function(A,e){if(t.needMouseUp){var n,i;if(e.selected)null===(n=t.factoryOptions.selectionService)||void 0===n||n.selectedElements.remove(e);else null===(i=t.factoryOptions.selectionService)||void 0===i||i.selectedElements.add(e);t.reportOnSelect(e),t.needMouseUp=!1}})),l()(this,"reportOnSelect",(function(A){if(t.factoryOptions.model.currentEditState===h.b.EDITABLE){var e="";A.type===d.d.SHAPE&&(e=f.b.CLK_EDIT),A.type===d.d.IMAGE&&(e=f.b.CLK_IMG),A.type===d.d.GROUP&&(e=f.b.CLK_COMBIN),e&&Object(v.c)({opername:f.e.DOC_PPT,module:f.d.PC_OBJ,action:e})}})),l()(this,"tdwHandleMouseDown",(function(A){var e=null;switch(A.type){case d.d.SHAPE:e=1===A.subType?f.b.EDIT_TEXT:f.b.EDIT_SHAPE;break;case d.d.IMAGE:e=f.b.EDIT_IMG;break;case d.d.TABLE:e=f.b.EDIT_FORM}e&&Object(v.c)({opername:f.e.DOC_PPT,module:f.d.PC_OBJ,action:e})})),this.factoryOptions=e}return r()(A,[{key:"getAppServices",value:function(){return g.a.getInstance().getAppServices()}}]),A}()},"4c80af32f0":function(A,e,t){"use strict";t.d(e,"b",(function(){return i})),t.d(e,"a",(function(){return o}));var n=t("711a53c9fc");function i(A){return!o(A)||function(A){var e;if(A)return null===(e=A["origin-href"])||void 0===e?void 0:e.colorType}(A)===n.B[2]}function o(A){return!!A&&!!A["origin-href"]}},"509a56a298":function(A,e,t){"use strict";t.d(e,"a",(function(){return g}));t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("bcb5d93d36");var n=t("14502724a6"),i=t.n(n),o=t("9132715560"),r=t.n(o),a=t("6a364eb35c"),l=t.n(a),c=t("85d0a7609b"),s=t.n(c),d=(t("3bf1976a4f"),t("8ee19818c4"),t("d5c3deb8c7")),u=t("41e949fe83"),p=t("898069ed54"),h=t("f9193d718f");function f(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function v(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?f(Object(t),!0).forEach((function(e){s()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var g=function(){function A(){var e=this;r()(this,A),s()(this,"operationLayer",void 0),s()(this,"overlayLayer",void 0),s()(this,"currentCanvasElementLayer",void 0),s()(this,"canvasOperationInfo",{startIndex:0,endIndex:0,operationElements:[],overlayElements:[]}),s()(this,"reaction",void 0),s()(this,"inCanvasOperation",void 0),s()(this,"updatePosition",(function(A){var t,n;null===(t=e.operationLayer)||void 0===t||t.updatePosition(A),null===(n=e.overlayLayer)||void 0===n||n.updatePosition(A)}))}return l()(A,[{key:"initLayer",value:function(A,e,t){this.operationLayer||(this.operationLayer=new u.a(v(v({},A),{},{canvasElement:e}))),this.overlayLayer||(this.overlayLayer=new u.a(v(v({},A),{},{canvasElement:t}))),this.reaction||this.init()}},{key:"dispose",value:function(){var A;null===(A=this.reaction)||void 0===A||A.call(this),this.reaction=null}},{key:"updateWithData",value:function(A){var e,t;null===(e=this.operationLayer)||void 0===e||e.updateWithData(A),null===(t=this.overlayLayer)||void 0===t||t.updateWithData(A)}},{key:"getAllComponents",value:function(){var A,e,t=(null===(A=this.operationLayer)||void 0===A?void 0:A.getRenderArea().renderComponent.children)||[],n=(null===(e=this.overlayLayer)||void 0===e?void 0:e.getRenderArea().renderComponent.children)||[];return t.concat(n)}},{key:"init",value:function(){var A=this;this.reaction=Object(d.r)((function(){return[A.getAppServices().viewableServiceLayer.editingStateManager.isDragging,A.getAppServices().viewableServiceLayer.editingStateManager.isResizing,A.getAppServices().viewableServiceLayer.editingStateManager.isRotating,A.getAppServices().viewableServiceLayer.editingStateManager.isTableRowColResizing,A.getAppServices().viewableServiceLayer.selectionService.currentSlide]}),(function(e){var t=i()(e,4),n=t[0],o=t[1],r=t[2],a=t[3];n||o||r||a?A.buildSelectedElementInRegionRefresh():A.revertRegionFresh()}))}},{key:"buildSelectedElementInRegionRefresh",value:function(){var A=this.inCanvasOperation,e=this.canvasOperationInfo,t=this.currentCanvasElementLayer;if(!A){var n,i=e.startIndex,o=e.endIndex,r=e.overlayElements,a=e.operationElements;if(null!=t&&null!==(n=t.children)&&void 0!==n&&n.length){for(var l=t.children.length-o-1;l>0;){var c=t.children[t.children.length-1];t.removeChild(c),this.overlayLayer.updateComponents(c),r.unshift(c),l-=1}for(var s=o-i+1;s>0;){var d=t.children[t.children.length-1];t.removeChild(d),this.operationLayer.updateComponents(d),a.unshift(d),Object(p.a)(d),s-=1}}this.inCanvasOperation=!0}}},{key:"revertRegionFresh",value:function(){var A=this.inCanvasOperation,e=this.canvasOperationInfo,t=this.currentCanvasElementLayer;if(A){var n=e.operationElements,i=e.overlayElements;t&&(n.forEach((function(A){t.addChild(A)})),i.forEach((function(A){t.addChild(A)}))),e.operationElements=[],e.overlayElements=[],this.inCanvasOperation=!1}}},{key:"getAppServices",value:function(){return h.a.getInstance().getAppServices()}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new A),this.instance}}]),A}();s()(g,"instance",void 0)},"529ab84664":function(A,e,t){"use strict";t.d(e,"c",(function(){return i})),t.d(e,"e",(function(){return o})),t.d(e,"d",(function(){return r})),t.d(e,"f",(function(){return a})),t.d(e,"g",(function(){return l})),t.d(e,"a",(function(){return c})),t.d(e,"b",(function(){return s}));var n=t("d9812f1c6f"),i=n.a.isMac?"ne-resize":"url(data:image/vnd.microsoft.icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAApoaGg2AAAACgAAAAQAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMdnZ2hn9/f/xubm5yAAAAEAAAAAYAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACHd3d4SMjIz239/f/4iIiPZra2t0AAAAEAAAAAYAAAACAAAAAgAAAAQAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJqamo0f39//N/f3///////7Ozs/4iIiPZra2t0AAAAEAAAAAgAAAAKdXV1VAAAAAgAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAhxcXFuiIiI9uzs7P//////7Ozs/4iIiPZra2t0AAAAGGpqal5/f3/4AAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAxvb29wiIiI9uzs7P//////7Ozs/4eHh/ZycnKmg4OD9H5+fv8AAAAUAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAxvb29wiIiI9uzs7P//////7Ozs/5CQkPrm5ub/fn5+/wAAABYAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAxubm5yiIiI9uzs7P///////v7+//////9+fn7/AAAAFgAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAABRzc3OkkJCQ+P7+/v///////////35+fv8AAAAWAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAIa2trXIODg/Tm5ub/////////////////fn5+/wAAABYAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnZ2dlR/f3/4fn5+/35+fv9+fn7/fn5+/35+fv9+fn7/AAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABgAAAAwAAAAQAAAAEgAAABIAAAASAAAAEgAAAA4AAAAGAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////////////////////////////////////////////////8////+H////g////8Hf///gH///8B////gf///4H///+B////Af///////////////////////////////////////////////////////////8=) 16 16, auto",o=n.a.isMac?"s-resize":"url(data:image/vnd.microsoft.icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAARYWFggVVVVIAAAAAoAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAGTk5OJIGBgd6AgIDgQUFBKgAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABlBQUCKCgoLivr6++r29vfqBgYHkPj4+LAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAZQUFAigoKC4r6+vvr//////////729vfqBgYHkPj4+LAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEU1NTIoCAgN6+vr76/////////////////////729vfp+fn7gQUFBKgAAAAoAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGhoaBp9fX3Wfn5+/35+fv9+fn7///////////9+fn7/fn5+/35+fv98fHzYWFhYIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAgAAAAQAAAAGn5+fv///////////35+fv8AAAAkAAAAFgAAAA4AAAAGAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAQfn5+////////////fn5+/wAAABwAAAAMAAAABAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAA5+fn7///////////9+fn7/AAAAGgAAAAgAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAADn5+fv///////////35+fv8AAAAaAAAACAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAOfn5+////////////fn5+/wAAABoAAAAIAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAx+fn7///////////9+fn7/AAAAGgAAAAgAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACn5+fv9+fn7/fn5+/35+fv8AAAASAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACgAAABAAAAASAAAADgAAAAgAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAQAAAACAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA///////////////////////////////////////////////////////+f////D////gf///wD///4Af///w////8P////D////w////8P////D////w///////////////////////////////////////////////////////8=) 16 16, auto",r=n.a.isMac?"n-resize":"url(data:image/vnd.microsoft.icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABAAAAAQAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABgAAAA4AAAASAAAAEgAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAQfn5+/35+fv9+fn7/fn5+/wAAAAoAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAABZ+fn7///////////9+fn7/AAAADgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFn5+fv///////////35+fv8AAAAQAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAWfn5+////////////fn5+/wAAABAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAABZ+fn7///////////9+fn7/AAAAEAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAGH5+fv///////////35+fv8AAAASAAAABgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAADAAAABQAAAAifn5+////////////fn5+/wAAAB4AAAASAAAACgAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAl1dXR58fHzWfn5+/35+fv9+fn7///////////9+fn7/fn5+/35+fv98fHzWZWVlGgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkVFRSh7e3vYvr6+//////////////////////++vr7/e3t71k5OTiIAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACEFBQSp7e3vYvr6+////////////vr6+/3t7e9hHR0cmAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACEFBQSp7e3vYvr6+/76+vv97e3vYR0dHJgAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACEJCQih7e3vYe3t71klJSSQAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACFJSUiBUVFQgAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA///////////////////////////////////////////////////////8P////D////w////8P////D////w////8P///4Af///AP///4H////D////5///////////////////////////////////////////////////////8=) 16 16, auto",a=n.a.isMac?"e-resize":"url(data:image/vnd.microsoft.icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAGWFhYIAAAAAoAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAACAAAABAAAAA58fHzYQUFBKgAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABgAAAAgAAAAIAAAACAAAAAgAAAAMAAAAFn5+fv9+fn7gPj4+LAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAgAAAASAAAAGgAAABoAAAAaAAAAGgAAABwAAAAkfn5+/729vfqBgYHkPj4+LAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAADn5+fv9+fn7/fn5+/35+fv9+fn7/fn5+/35+fv9+fn7//////729vfqBgYHkQUFBKgAAAAoAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAASfn5+/////////////////////////////////////////////////729vfqAgIDgVVVVIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAABB+fn7/////////////////////////////////////////////////vr6++oCAgN5YWFggAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACn5+fv9+fn7/fn5+/35+fv9+fn7/fn5+/35+fv9+fn7//////76+vvqCgoLiUFBQIgAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACgAAAAwAAAAOAAAADgAAAA4AAAAQAAAAGn5+fv++vr76goKC4lBQUCIAAAAGAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAIAAAACAAAAAgAAAAQAAAAQfn5+/4CAgN5QUFAiAAAABgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAh9fX3WVVVVIAAAAAYAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAmxsbBoAAAAEAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////////////////////////////7////+f////j///wAf//8AD///AA///wAf///+P////n////7////////////////////////////////////////////////////////////8=) 16 16, auto",l=n.a.isMac?"w-resize":"url(data:image/vnd.microsoft.icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAKWFhYIAAAAAYAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADEFBQSp8fHzYAAAADgAAAAQAAAACAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAw9PT0ufn5+4H5+fv8AAAAWAAAADAAAAAgAAAAIAAAACAAAAAgAAAAGAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMPj4+LIGBgeS9vb36fn5+/wAAACQAAAAcAAAAGgAAABoAAAAaAAAAGgAAABIAAAAIAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAACkFBQSqBgYHkvb29+v////9+fn7/fn5+/35+fv9+fn7/fn5+/35+fv9+fn7/fn5+/wAAAA4AAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARVVVUggYGB4L29vfr///////////////////////////////////////////////9+fn7/AAAAEgAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlhYWCCAgIDevr6++v///////////////////////////////////////////////35+fv8AAAAQAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFBQUCKCgoLivr6++v////9+fn7/fn5+/35+fv9+fn7/fn5+/35+fv9+fn7/fn5+/wAAAAoAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABlBQUCKCgoLivr6++n5+fv8AAAAaAAAAEAAAAA4AAAAOAAAADgAAAAwAAAAKAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABlBQUCKAgIDefn5+/wAAABAAAAAEAAAAAgAAAAIAAAACAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABlVVVSB9fX3WAAAACAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABGhoaBoAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////////////////////////////f////n////x////4AP//8AD///AA///4AP///H////5/////f////////////////////////////////////////////////////////////8=) 16 16, auto",c=n.a.isWindowWxMiniProgram?"ew-resize":"col-resize",s=n.a.isWindowWxMiniProgram?"ns-resize":"row-resize"},5655794132:function(A,e,t){"use strict";t.d(e,"a",(function(){return P}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("547611bd96"),l=t.n(a),c=t("8eec1e4a03"),s=t.n(c),d=t("bd29e2df90"),u=t.n(d),p=t("ab5eb40518"),h=t.n(p),f=t("1b4cdd6a36"),v=t.n(f),g=t("85d0a7609b"),y=t.n(g),m=(t("b8217400dc"),t("e6f68cdf2e"),t("8e7cce0ada"),t("c6244f7705"),t("c9a7ecac4d"),t("85d48ef22b"),t("2a6f332b5e"),t("8ee19818c4"),t("342844cefa"),t("759492dad9"),t("3bf1976a4f"),t("516fa97df2")),b=t("1f091e5c6c"),C=t("ab17200d42"),S=t("fa034a86e9"),E=t("0a8ecd6412"),O=t("2d47c066fb"),k=t("7e82f0072b"),M=t("c9c92622ff"),L=t("81758a57a2"),T=t("83f23a2c67"),w=t("d9812f1c6f");function R(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return h()(this,t)}}var P=function(A){u()(t,A);var e=R(t);function t(A,n,o){var r,a;return i()(this,t),a=e.call(this),y()(l()(a),"factoryOptions",void 0),y()(l()(a),"factoryUpdateComponent",void 0),y()(l()(a),"factoryDispose",void 0),y()(l()(a),"historyMark",void 0),y()(l()(a),"lastComponentRect",void 0),y()(l()(a),"keepCacheForAnimation",void 0),y()(l()(a),"updateComponent",(function(){Object(L.b)(l()(a),a.factoryOptions),a.updateElementShowAndEventStatus(),a.renderHistoryMark(),a.checkWindowNeedResize(),a.useAnimCache()})),y()(l()(a),"updateElementShowAndEventStatus",(function(){var A=a.factoryOptions,e=A.model,t=e.selectable,n=e.hidden,i=A.isCroping,o=A.editingStateManager,r=null==o?void 0:o.insertState;a.dealVisibleStatus(),a.pointerEvents=null!=r&&r.type||i||!t||n?m.I.NONE:m.I.AUTO,a.cursor=a.getCursor()})),y()(l()(a),"dealVisibleStatus",(function(A){if("boolean"!=typeof A){var e=a.factoryOptions.model.hidden;a.visible=!e&&a.isShowCanvasAttachmentElement()}else a.visible=A})),y()(l()(a),"renderHistoryMark",(function(){w.a.isMobile||(a.historyMark||(a.historyMark=new b.a(a.factoryOptions,l()(a))),a.historyMark.renderComponent())})),y()(l()(a),"useAnimCache",(function(){if(C.a){var A=a.factoryOptions,e=A.region,t=A.model,n=(t=void 0===t?{}:t).id,i=t.parent;if([E.s.CANVAS,E.s.PLAYER].includes(e))if(i instanceof S.a){var o=null==i?void 0:i.getAllKindsOfSequence();if(o){var r=new Set;Object.keys(o).forEach((function(A){o[A].forEach((function(A){A.forEach((function(A){var e=A.animList;(void 0===e?[]:e).forEach((function(A){r.add(null==A?void 0:A.spid)}))}))}))})),a.keepCacheForAnimation=r.has(n)}}}})),y()(l()(a),"getCursor",(function(){var A,e,t=a.factoryOptions,n=t.isEditable,i=t.region,o=t.model,r=(o||{}).uniqueID,l=null===(A=a.factoryOptions.formatBrushManager)||void 0===A?void 0:A.formatBrushState,c=null===(e=a.factoryOptions.animBrushManager)||void 0===e?void 0:e.animBrushState;if(E.s.PLAYER===i){if(Object(k.a)(a.factoryOptions))return"pointer"}else{if(c){var s=r===(null==c?void 0:c.originElId),d=!a.isMediaElement(o)&&c.allMediaEffect;return s||d?"auto":Object(T.a)(!1)}if(null!=l&&l.data)return Object(T.a)("text"===(null==l?void 0:l.data));if(n)return"move"}return"auto"})),y()(l()(a),"checkWindowNeedResize",(function(){var A,e,t=(null===(A=a.factoryOptions.model)||void 0===A||null===(e=A.props)||void 0===e?void 0:e.style)||{},n=[t.width,t.height,t.left,t.top].join("|");a.lastComponentRect!==n&&(a.lastComponentRect&&window.dispatchEvent(new Event("PPT-resize")),a.lastComponentRect=n)})),y()(l()(a),"isShowCanvasAttachmentElement",(function(){var A=a.factoryOptions,e=A.model,t=A.region,n=A.attachmentManager;if(Object(M.F)(e)){var i,o,r,l;if(Object(M.f)(e)||Object(M.G)(e))return!0;if(t!==E.s.LEFTLIST&&t!==E.s.PRESENTER_VIEW)return!1;var c=!(null!=e&&null!==(i=e.props)&&void 0!==i&&null!==(o=i.attachment)&&void 0!==o&&o.objKey),s=null==n?void 0:n.uploadingMap,d=null==s?void 0:s.has(null==e||null===(r=e.props)||void 0===r||null===(l=r.attachment)||void 0===l?void 0:l.id);if(c&&!d)return!1}return!0})),a.factoryOptions=A,a.factoryDispose=n,a.factoryUpdateComponent=o,a.keepCacheForAnimation=!1,a.updateComponent(),a.id="".concat(O.y,"#").concat(null==A||null===(r=A.model)||void 0===r?void 0:r.key),a}return r()(t,[{key:"wrapperInstance",get:function(){return this}},{key:"dispose",value:function(){var A;s()(v()(t.prototype),"dispose",this).call(this),null===(A=this.factoryDispose)||void 0===A||A.call(this)}},{key:"generateRawRenderData",value:function(A){var e=this.factoryOptions.model;return!this.visible||Object(M.c)(e)?{type:"Container",children:[{type:""}]}:s()(v()(t.prototype),"generateRawRenderData",this).call(this,A)}},{key:"isMediaElement",value:function(A){return(null==A?void 0:A.video)||(null==A?void 0:A.audio)}}]),t}(m.k)},"65634518db":function(A,e,t){"use strict";t.d(e,"c",(function(){return i})),t.d(e,"b",(function(){return r})),t.d(e,"a",(function(){return a}));t("6e20b6a7d8");var n=t("c2b620c600");function i(A){return{paragraphProps:n.a.getOriginProps(A),textRuns:null==A?void 0:A.children.map((function(A){var e=n.a.getOriginProps(A,"raw-");return{text:A.text,styles:e}}))}}t("7eaa8e90a5"),t("7a3400cab1"),t("54a7b7d7a1");var o=t("8da38f8962"),r=function(A){var e,t=null==A||null===(e=A.placeHolder)||void 0===e?void 0:e.type;return"title"===t||"ctrTitle"===t};function a(){if(o.a.isAndroid&&!o.a.isWeChat)try{var A=document.createElement("div");A.style.cssText="font-size:20px;",document.body.appendChild(A);var e=parseInt(window.getComputedStyle(A,null).getPropertyValue("font-size"));return document.body.removeChild(A),20/e}catch(A){console.warn("getFontScale error")}return 1}},"6899c02841":function(A,e,t){"use strict";t.d(e,"a",(function(){return B}));var n,i=t("176815363d"),o=t.n(i),r=t("9132715560"),a=t.n(r),l=t("6a364eb35c"),c=t.n(l),s=t("85d0a7609b"),d=t.n(s),u=t("3ef2352f0b"),p=t.n(u),h=(t("b8217400dc"),t("e6f68cdf2e"),t("6c458f1652"),t("c6244f7705"),t("081c8cafea"),t("d5c3deb8c7")),f=t("67d3be6cf9"),v=t.n(f),g=t("d7a2286b24"),y=t("4e7af1026b"),m=t("e0e8dd9366"),b=t("d9812f1c6f"),C=t("d3d31c86eb"),S=t("9da6335152"),E=t("418ad3ec44"),O=t("b86964b011"),k=t("21f6c93a07"),M=t("c9c92622ff"),L=t("f9193d718f"),T=t("59087c860a"),w=null===(n=g.default.getInstance().getConfig(y.k.addonUnofficial))||void 0===n||n,R=1,P=2,B=function(){function A(e,t){var n=this;a()(this,A),d()(this,"shapeLinkInstance",void 0),d()(this,"linkShowTimer",void 0),d()(this,"linkHideTimer",void 0),d()(this,"hasRegisterFlagAboutEvents",void 0),d()(this,"enterLinkEditOff",void 0),d()(this,"selectedStateChangeOff",void 0),d()(this,"globalStateChangeOff",void 0),d()(this,"enterElementOff",void 0),d()(this,"leaveElementOff",void 0),d()(this,"linkClickOff",void 0),d()(this,"isHovering",!1),d()(this,"getEditCanvasSize",void 0),d()(this,"registerEnterLinkEdit",(function(){var A=n.shapeLinkInstance.factoryOptions,e=A.isEditable,t=A.model,i=n.getMenuManager();[m.d.SHAPE,m.d.IMAGE].includes(t.type)&&e&&!b.a.isMobile&&!n.enterLinkEditOff&&(n.enterLinkEditOff=null==i?void 0:i.event.on(T.a.ENTER_LINK_EDIT,(function(){t.selected&&(n.changeIsEditingLink(!0),n.showLinkEditMenu())})))})),d()(this,"removeEnterLinkEdit",(function(){var A;null===(A=n.enterLinkEditOff)||void 0===A||A.call(n),n.enterLinkEditOff=null})),d()(this,"clearTimer",(function(){n.linkHideTimer&&(clearTimeout(n.linkHideTimer),n.linkHideTimer=null),n.linkShowTimer&&(clearTimeout(n.linkShowTimer),n.linkShowTimer=null)})),d()(this,"iframeInsertShowBarAtNow",(function(){var A=n.shapeLinkInstance.factoryOptions.model,e=n.getLinkData();Object(E.c)(e)===R&&A.selected&&n.delayShowFloatLinkBar()})),d()(this,"handleClick",(function(A){A.stopPropagation(),n.shapeLinkInstance.factoryOptions.isEditable&&!b.a.isMobile&&n.showLinkEditMenu()})),d()(this,"handleDoubleClick",(function(A){A.stopPropagation()})),d()(this,"resize",(function(){var A=n.shapeLinkInstance.factoryOptions.model,e=n.getLinkData();b.a.isMobile||Object(E.c)(e)!==R&&!n.isHovering||!A.selected||n.delayShowFloatLinkBar()})),d()(this,"scroll",(function(){var A=n.shapeLinkInstance.factoryOptions.model,e=n.getLinkData();(Object(E.c)(e)===R||n.isHovering)&&A.selected&&n.delayShowFloatLinkBar()})),d()(this,"registerSelectedStateChange",(function(){var A=n.shapeLinkInstance.factoryOptions.model;n.selectedStateChangeOff=Object(h.r)((function(){return A.selected}),(function(A){A?n.delayShowFloatLinkBar():(n.changeIsEditingLink(!1),n.getLinkManager().linkEditMenuService.hide())}))})),d()(this,"registerGlobalStateChange",(function(){var A=n.shapeLinkInstance.factoryOptions.model,e=n.getLinkData();n.globalStateChangeOff=Object(h.e)((function(){var t,i,o,r,a;n.getEditingStateManager().isControlValuesChanging||n.getEditingStateManager().isMovingWithKeyUpDown||null!==(t=n.getMenuManager())&&void 0!==t&&t.isColorPicking||n.getEditingStateManager().isInAnyEditingState()?(n.clearTimer(),n.getLinkManager().linkFloatBarService.hide(),n.getLinkManager().linkEditMenuService.hide()):Object(E.c)(e)===R&&A.selected&&n.delayShowFloatLinkBar();var l="input"===(null===(i=document.activeElement)||void 0===i||null===(o=i.tagName)||void 0===o||null===(r=o.toLowerCase)||void 0===r?void 0:r.call(o));null!==(a=n.getMenuManager())&&void 0!==a&&a.hideAllMenuNum&&n.shapeLinkInstance.isEditingLink&&!l&&n.getLinkManager().linkEditMenuService.hide()}))})),d()(this,"registerLinkJump",(function(){var A=n.getMenuManager();n.linkClickOff=null==A?void 0:A.event.on(T.a.LINK_CLICK,(function(){if(!n.shapeLinkInstance.factoryOptions.isEditable){var A=n.getLinkData(),e=(null==A?void 0:A.href)||{},t=n.getLinkManager().getLinkUrlWithData(e);e.slideJump?n.handleSlideJump(e.slideJump):n.getLinkManager().linkFloatBarService.openUrl(t)}}))})),d()(this,"registerEnterLeaveElement",(function(){var A=n.getMenuManager();n.enterElementOff=null==A?void 0:A.event.on(T.a.ENTER_ELEMENT,n.enterElementCb),n.leaveElementOff=null==A?void 0:A.event.on(T.a.LEAVE_ELEMENT,n.leaveElementCb)})),d()(this,"enterElementCb",(function(A){var e=n.shapeLinkInstance.factoryOptions,t=e.isEditable;A===e.model.key&&t&&(n.getEditingStateManager().isInAnyEditingState()||n.getLinkManager().linkFloatBarService.isShown()||n.getLinkManager().linkEditMenuService.isShown()||(n.delayShowFloatLinkBar(),n.isHovering=!0))})),d()(this,"leaveElementCb",(function(A){var e=n.shapeLinkInstance.factoryOptions,t=e.isEditable,i=e.model,o=n.getLinkData();A===i.key&&t&&!n.getEditingStateManager().isInAnyEditingState()&&Object(E.c)(o)!==R&&(n.delayHideFloatLinkBar(),n.isHovering=!1)})),d()(this,"changeIsEditingLink",(function(A){var e=n.shapeLinkInstance.isEditingLink;n.shapeLinkInstance.isEditingLink=A,e!==A&&n.shapeLinkInstance.renderComponent()})),d()(this,"getLinkData",(function(){var A,e,t=n.shapeLinkInstance.factoryOptions.model;return Object(M.o)(t)?{href:{url:null===(A=t.props.addon)||void 0===A?void 0:A.originUrl},addon:null===(e=t.props)||void 0===e?void 0:e.addon}:t.props.link})),d()(this,"getGraphicsRect",(function(A){var e=b.a.isMobile?document.getElementsByClassName("mobile-zoom-content")[0]:document.getElementById("select-view");if(!e)return{left:0,top:0,right:0,bottom:0};var t=e.getBoundingClientRect(),n=A.worldBounds,i=n.x,o=n.y,r=n.width,a=n.height,l={left:t.left+i,top:t.top+o,width:r,height:a,right:0,bottom:0};return l.right=l.left+l.width,l.bottom=l.top+l.height,l})),d()(this,"handleSlideJump",(function(A){var e,t,i,o,r,a=n.getLinkManager().getJumpPage(A,null===(e=n.shapeLinkInstance.factoryOptions.selectionService)||void 0===e?void 0:e.currentSlideIndex,null===(t=n.shapeLinkInstance.factoryOptions.selectionService)||void 0===t?void 0:t.slides.length);(null===(i=n.shapeLinkInstance.factoryOptions.selectionService)||void 0===i?void 0:i.currentSlideIndex)!==a&&(null===(o=n.shapeLinkInstance.factoryOptions.selectionService)||void 0===o||o.selectedElements.clear(),null===(r=n.shapeLinkInstance.factoryOptions.selectionService)||void 0===r||r.changeCurrentSlideIndexByUserAction(a))})),d()(this,"removeLink",(function(){var A=n.shapeLinkInstance.factoryOptions.model;A.selected&&A.getLink().removeLink()})),d()(this,"handleFullScreen",(function(A,e){n.getLinkManager().linkFloatBarService.showAddonFullscreen({iframeId:A.iframeId,embedUrl:A.embedUrl,title:e})})),d()(this,"delayShowFloatLinkBar",(function(){n.clearTimer(),n.getLinkManager().linkFloatBarService.hide(),n.linkShowTimer=setTimeout((function(){var A=n.shapeLinkInstance.factoryOptions.model;n.getLinkData()&&A.selected&&n.isCurrentSelectedModel(A)&&n.showFloatLinkBar()}),200)})),d()(this,"delayHideFloatLinkBar",(function(){n.clearTimer(),n.linkHideTimer=setTimeout((function(){n.getLinkManager().linkFloatBarService.isMouseEnter()||n.getLinkManager().linkFloatBarService.hide()}),200)})),d()(this,"showLinkEditMenu",(function(){var A,e=n.shapeLinkInstance,t=e.factoryOptions,i=e.flagGraphics,o=n.getLinkData(),r=n.getGraphicsRect(null==i||null===(A=i.children)||void 0===A?void 0:A[1]);r.x=r.left,r.y=r.top,r.height=r.height+8,n.getLinkManager().linkEditMenuService.hide(),n.getLinkManager().linkEditMenuService.show({anchorRect:r,isTextLink:!1,data:(null==o?void 0:o.href)||{},handleLinkRemove:function(){n.getLinkManager().linkEditMenuService.hide()},handleLinkEdit:function(A){t.model.selected&&t.model.getLink().updateLink({href:A}),n.getLinkManager().linkEditMenuService.hide();var e=null!=o&&o.href?S.b.LINK_EDIT:S.b.LINK_INSERT;Object(C.c)({opername:S.e.DOC_PPT,module:S.d.PC_EDIT,action:e})},handleVisibleChange:function(A){A||n.changeIsEditingLink(!1)}})})),d()(this,"showFloatLinkBar",o()(p.a.mark((function A(){var e,t,i,o,r,a,l,c,s,d,u,h,f,g,y,m,b,C,k,M,L,T,B,D,x,F,I;return p.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(t=n.shapeLinkInstance.factoryOptions.model,i=n.shapeLinkInstance,o=i.factoryOptions,r=i.parentComponent,a=n.getGraphicsRect(r.baseComponent),(l=n.getLinkData())&&!Object(E.g)(a)){A.next=6;break}return A.abrupt("return");case 6:if(c=l.addon,s=(null==l?void 0:l.href)||{},d=n.getLinkManager().getLinkUrlWithData(s),u=s.slideJump,h=o.addonManager,f=Object(E.c)(l)===R,g=n.getAppServices().viewableServiceLayer.userPriviledgeService.pptEditorState,y=!1,m=!1,!f||!Object(O.k)()){A.next=23;break}return A.next=18,null==h?void 0:h.shouldRenderFullScreenItem(c.iframeId,c.extraData);case 18:y=A.sent,k=null==h?void 0:h.addonHandler.addonInfoMap,M=(null==c||null===(b=c.docElement)||void 0===b?void 0:b.addonId)||(null==c?void 0:c.iframeId),L=null==k||null===(C=k.get(M))||void 0===C?void 0:C.isOfficial,m=!L&&!!w;case 23:if(!(n.getEditingStateManager().isInAnyEditingState()||n.getLinkManager().linkFloatBarService.isShown()||n.getLinkManager().linkEditMenuService.isShown())&&t.selected){A.next=25;break}return A.abrupt("return");case 25:T=(null===(e=n.getEditCanvasSize)||void 0===e?void 0:e.call(n))||{},B=T.left,D=void 0===B?0:B,x=T.top,F=void 0===x?0:x,I=f?n.getRectTop(a):a.bottom,n.getLinkManager().linkFloatBarService.show({left:a.left+D,top:I+F,href:d,hasChinese:u,importConfig:n.getLinkManager().linkFloatBarService.getDisplayPrivilege({addon:c,editState:g,linkData:s,isIframeLink:!1,needFullscreen:y,needShowAddon:m,addonHandler:null==h?void 0:h.addonHandler,isElemLink:!0}),addonManager:h,menuManager:n.getMenuManager(),selectionService:n.getAppServices().viewableServiceLayer.selectionService,openLink:function(){s.slideJump?(n.handleSlideJump(s.slideJump),n.getLinkManager().linkFloatBarService.hide()):n.getLinkManager().linkFloatBarService.openUrl(d),n.getLinkManager().linkFloatBarService.handleTdwReport(S.b.ADDON_OPEN,c)},handleLinkRemove:function(){n.removeLink(),n.getLinkManager().linkFloatBarService.hide()},handleLinkEdit:function(){n.showLinkEditMenu()},handleModeChange:function(A){o.model&&A!==c.displayMode&&(null==h||h.changeIframeMode(o.model,A),n.getLinkManager().linkFloatBarService.hide())},deleteElement:function(){var A,e;null===(A=n.shapeLinkInstance.factoryOptions.selectionService)||void 0===A||null===(e=A.currentSlide)||void 0===e||e.deleteElement(),n.getLinkManager().linkFloatBarService.handleTdwReport(S.b.ADDON_DELETE,c)},handleMouseLeave:function(){f||n.getLinkManager().linkFloatBarService.hide()},handleCopyUrl:function(){n.getLinkManager().linkFloatBarService.handleCopyUrl(d),n.getLinkManager().linkFloatBarService.handleTdwReport(S.b.ADDON_COPY,c)},handleModifyUrl:function(){if(Object(E.c)(l)!==P){if(c){var A,e=c,t=e.originUrl,i=e.title,o=e.extraData,r=e.iframeId,a={originUrl:t,title:i,extraData:o,aid:null!=r?r:""};null==h||null===(A=h.addonHandler)||void 0===A||A.emitMessageToAddon("$onToolbarClick",{action:"editAddon",data:a},a.aid),n.getLinkManager().linkFloatBarService.handleTdwReport(S.b.ADDON_MODIFY,c)}}else n.showLinkEditMenu()},handleRefresh:function(){var A,e=document.querySelector("#slide-element-".concat(null===(A=n.shapeLinkInstance)||void 0===A?void 0:A.factoryOptions.model.key)),t=null==e?void 0:e.querySelector("iframe");if(!v()(e)&&!v()(t)){var i=t.src;t.src=i;var o=e.querySelector("#addon-loading");v()(o)||(o.style.display="block",t.addEventListener("load",(function(){o.style.display="none"}),{once:!0}),n.getLinkManager().linkFloatBarService.handleTdwReport(S.b.ADDON_REFRESH,c))}},handleFullScreen:function(){var A=null==h?void 0:h.getAddonFullScreenTitle(c.iframeId,c.extraData);n.handleFullScreen(c,A),n.getLinkManager().linkFloatBarService.handleTdwReport(S.b.ADDON_FULL_SCREEN,c)},tdwOnSelectedItemCallback:function(A){n.getLinkManager().linkFloatBarService.tdwOnSelectedItemCallback(A,c)}});case 28:case"end":return A.stop()}}),A)})))),d()(this,"getRectTop",(function(A){var e=document.getElementById(k.a.CANVAS_WRAPPER);if(e){var t=e.getBoundingClientRect(),n=t.top,i=t.bottom,o=A.top-n,r=i-A.bottom;return o>40?A.top-36-4:r>40?A.bottom+4:n}return A.top-36-4}));var i=(null==e?void 0:e.factoryOptions)||{},r=i.model,l=i.fromScale;e&&[m.d.SHAPE,m.d.IMAGE].includes(null==r?void 0:r.type)&&0===l&&(this.shapeLinkInstance=e,this.getEditCanvasSize=t,this.iframeInsertShowBarAtNow())}return c()(A,[{key:"cancelAllEvents",value:function(){this.cancelFlagAboutEvents()}},{key:"cancelFlagAboutEvents",value:function(){var A,e,t,n,i;this.hasRegisterFlagAboutEvents&&(null===(A=this.enterElementOff)||void 0===A||A.call(this),null===(e=this.leaveElementOff)||void 0===e||e.call(this),null===(t=this.selectedStateChangeOff)||void 0===t||t.call(this),null===(n=this.globalStateChangeOff)||void 0===n||n.call(this),null===(i=this.linkClickOff)||void 0===i||i.call(this),this.clearTimer(),this.getLinkManager().linkFloatBarService.hide(),this.getLinkManager().linkEditMenuService.hide(),window.removeEventListener("resize",this.resize),window.removeEventListener("Scroll-End-Show-LinkFloatBar",this.scroll))}},{key:"registerFlagAboutEvents",value:function(){this.hasRegisterFlagAboutEvents=!0,this.cancelFlagAboutEvents(),this.shapeLinkInstance.flagGraphics&&(this.shapeLinkInstance.flagGraphics.onClick(this.handleClick),this.shapeLinkInstance.flagGraphics.onDoubleClick(this.handleDoubleClick)),this.registerEnterLeaveElement(),this.registerSelectedStateChange(),this.registerGlobalStateChange(),this.registerLinkJump(),window.addEventListener("resize",this.resize),window.addEventListener("Scroll-End-Show-LinkFloatBar",this.scroll)}},{key:"getAppServices",value:function(){return L.a.getInstance().getAppServices()}},{key:"getEditingStateManager",value:function(){return this.getAppServices().viewableServiceLayer.editingStateManager}},{key:"getMenuManager",value:function(){var A;return null===(A=this.getAppServices().editableServiceLayer)||void 0===A?void 0:A.menuManager}},{key:"getLinkManager",value:function(){return this.getAppServices().viewableServiceLayer.linkManager}},{key:"isCurrentSelectedModel",value:function(A){var e,t,n=this.shapeLinkInstance.factoryOptions.selectionService;return 1===(null==n||null===(e=n.selectedElements)||void 0===e||null===(t=e.selectedArray)||void 0===t?void 0:t.length)&&A===n.selectedElements.selectedArray[0]}}]),A}()},"6d1a03b824":function(A,e,t){"use strict";t.d(e,"a",(function(){return P})),t.d(e,"b",(function(){return G}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("547611bd96"),l=t.n(a),c=t("bd29e2df90"),s=t.n(c),d=t("ab5eb40518"),u=t.n(d),p=t("8eec1e4a03"),h=t.n(p),f=t("1b4cdd6a36"),v=t.n(f),g=t("85d0a7609b"),y=t.n(g),m=(t("6e20b6a7d8"),t("b4638a0243"),t("8a35b54c1d"),t("ef51bf4fed"),t("826dc923b3"),t("8ee19818c4"),t("516fa97df2")),b=t("f9193d718f"),C=(t("8e7cce0ada"),t("29f8c5f672"),t("c6244f7705"),t("85d48ef22b"),t("2a6f332b5e"),t("af802ec74b"),t("81ee04f965")),S=(t("1bab7b5fb7"),t("34cd92f77a"),t("3bf1976a4f"),t("405b4a5e2b"),t("529ab84664"));function E(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var O=function(A){s()(t,A);var e=E(t);function t(A){var n;return i()(this,t),n=e.call(this),y()(l()(n),"lineComponent",void 0),y()(l()(n),"props",void 0),y()(l()(n),"hotEventLength",6),y()(l()(n),"defaultLineColor","#A7A7A7"),y()(l()(n),"defaultAlpha",.8),y()(l()(n),"handleMouseDown",(function(A){var e,t;null===(e=A.stopPropagation)||void 0===e||e.call(A),null===(t=A.preventDefault)||void 0===t||t.call(A),n.props.updateGuide(A)})),y()(l()(n),"handleContextMenu",(function(A){var e,t;null===(e=A.preventDefault)||void 0===e||e.call(A),null===(t=A.stopPropagation)||void 0===t||t.call(A),n.props.handleContextMenu(A)})),y()(l()(n),"handleDoubleClick",(function(A){var e,t;null===(e=A.stopPropagation)||void 0===e||e.call(A),null===(t=A.preventDefault)||void 0===t||t.call(A)})),n.props=A,n}return t}(m.k);function k(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var M=function(A){s()(t,A);var e=k(t);function t(A){var n;i()(this,t),n=e.call(this,A),y()(l()(n),"renderGuideLine",(function(A,e){n.props.isUiComponent?n.renderUiGuideLine(A,e):n.renderEventGuideLine(A)})),y()(l()(n),"renderUiGuideLine",(function(A,e){var t=n.getAppService().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),i=t.canvasHeight,o=t.scale,r=i/o,a=A,l=null==e?void 0:e.replace(/#/,""),c="M ".concat(a," ").concat(0," L ").concat(a," ").concat(r);n.lineComponent?(n.lineComponent.stroke=new m.i(m.h.fromHex("#".concat(l)||!1,n.defaultAlpha)),n.lineComponent.path=c):(n.lineComponent=new m.N(c),n.lineComponent.pointerEvents=m.I.NONE,n.lineComponent.stroke=new m.i(m.h.fromHex("#".concat(l)||!1,n.defaultAlpha)),n.lineComponent.strokeWidth=1/o,n.lineComponent.strokeDash=[6,4],n.addChild(n.lineComponent))})),y()(l()(n),"renderEventGuideLine",(function(A){var e=n.getAppService().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),t=e.canvasHeight/e.scale,i=A-n.hotEventLength,o=A+n.hotEventLength,r=n.props.canEdit?m.I.AUTO:m.I.NONE,a="M ".concat(i," ").concat(0," L ").concat(o," ").concat(0," L ").concat(o," ").concat(t," L ").concat(i," ").concat(t," Z");n.lineComponent?n.lineComponent.path=a:(n.lineComponent=new m.N(a),n.lineComponent.fill=new m.i(m.h.Transparent),n.lineComponent.cursor=S.a,n.lineComponent.pointerEvents=r,n.lineComponent.onContextMenu(n.handleContextMenu),n.lineComponent.onMouseDown(n.handleMouseDown),n.lineComponent.onDoubleClick(n.handleDoubleClick),n.addChild(n.lineComponent))})),y()(l()(n),"getAppService",(function(){return b.a.getInstance().getAppServices()}));var o=n.props,r=o.position,a=o.color;return n.renderGuideLine(r,a),n}return t}(O);function L(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var T=function(A){s()(t,A);var e=L(t);function t(A){var n;i()(this,t),n=e.call(this,A),y()(l()(n),"renderGuideLine",(function(A,e){n.props.isUiComponent?n.renderUiGuideLine(A,e):n.renderEventGuideLine(A)})),y()(l()(n),"renderUiGuideLine",(function(A,e){var t=n.getAppService().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),i=t.canvasWidth,o=t.scale,r=i/o,a=A,l=null==e?void 0:e.replace(/#/,""),c="M ".concat(0," ").concat(a," L ").concat(r," ").concat(a);n.lineComponent?(n.lineComponent.stroke=new m.i(m.h.fromHex("#".concat(l)||!1,n.defaultAlpha)),n.lineComponent.path=c):(n.lineComponent=new m.N(c),n.lineComponent.pointerEvents=m.I.NONE,n.lineComponent.stroke=new m.i(m.h.fromHex("#".concat(l)||!1,n.defaultAlpha)),n.lineComponent.strokeWidth=1/o,n.lineComponent.strokeDash=[6,4],n.addChild(n.lineComponent))})),y()(l()(n),"renderEventGuideLine",(function(A){var e=n.getAppService().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),t=e.canvasWidth/e.scale,i=A-n.hotEventLength,o=A+n.hotEventLength,r=n.props.canEdit?m.I.AUTO:m.I.NONE,a="M ".concat(0," ").concat(i," L ").concat(t," ").concat(i," L ").concat(t," ").concat(o," L ").concat(0," ").concat(o," Z");n.lineComponent?n.lineComponent.path=a:(n.lineComponent=new m.N(a),n.lineComponent.fill=new m.i(m.h.Transparent),n.lineComponent.cursor=S.b,n.lineComponent.pointerEvents=r,n.lineComponent.onContextMenu(n.handleContextMenu),n.lineComponent.onMouseDown(n.handleMouseDown),n.lineComponent.onDoubleClick(n.handleDoubleClick),n.addChild(n.lineComponent))})),y()(l()(n),"getAppService",(function(){return b.a.getInstance().getAppServices()}));var o=n.props,r=o.position,a=o.color;o.isUiComponent,o.canEdit;return n.renderGuideLine(r,a),n}return t}(O),w=t("1288bffff3");function R(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var P,B=function(A){s()(t,A);var e=R(t);function t(A){var n,o;i()(this,t),o=e.call(this),y()(l()(o),"componentMap",new Map),y()(l()(o),"props",void 0),y()(l()(o),"guidesManager",void 0),y()(l()(o),"type",void 0),y()(l()(o),"initComponentMap",(function(){var A;switch(o.type){case P.slide:A=o.getSlideService();break;case P.master:A=o.getMasterService();break;case P.layout:A=o.getLayoutService()}A&&(o.props.orient===C.a.ppHorizontalGuide?A.horzUiComponentContainer=l()(o):A.vertUiComponentContainer=l()(o))})),y()(l()(o),"getSlideService",(function(){if(o.guidesManager&&o.props.isUiComponent)return o.guidesManager.slideGuidesService})),y()(l()(o),"getMasterService",(function(){if(o.guidesManager&&o.props.isUiComponent)return o.guidesManager.masterGuidesService})),y()(l()(o),"getLayoutService",(function(){if(o.guidesManager&&o.props.isUiComponent)return o.guidesManager.layoutGuidesService})),y()(l()(o),"updateProps",(function(A){Object.assign(o.props,A),o.x=A.x,o.y=A.y,requestAnimationFrame((function(){o.renderComponent()}))})),y()(l()(o),"showSlideGuides",(function(){var A;if(o.type!==P.slide)return!0;var e=null===(A=o.getAppService().editableServiceLayer)||void 0===A?void 0:A.masterLayoutEditService;return(null==e?void 0:e.editType)!==w.a.MASTER_LAYOUT})),y()(l()(o),"canEditMasterOrLayout",(function(A){var e,t,n;if(o.props.isUiComponent)return!1;var i=null===(e=o.getAppService().editableServiceLayer)||void 0===e?void 0:e.masterLayoutEditService,r=o.getAppService().viewableServiceLayer.selectionService;return!!i&&(i.editType!==w.a.SLIDE&&(A?null===(t=r.currentSlide)||void 0===t?void 0:t.getRelationMasterModel():null===(n=r.currentSlide)||void 0===n?void 0:n.getRelationLayoutModel())===r.currentSlide)})),y()(l()(o),"renderComponent",(function(){o.removeAllComponent(),o.needRender()&&(o.props.orient===C.a.ppHorizontalGuide?o.renderHorzLine():o.renderVertLine())})),y()(l()(o),"needRender",(function(){var A,e,t;if(null!==(A=o.getAppService().editableServiceLayer)&&void 0!==A&&null!==(e=A.historyManager)&&void 0!==e&&e.isShowHistoryPanel)return!1;var n=null===(t=o.getAppService().editableServiceLayer)||void 0===t?void 0:t.masterLayoutEditService;return(o.type!==P.slide||(null==n?void 0:n.editType)===w.a.SLIDE)&&o.props.display})),y()(l()(o),"renderVertLine",(function(){o.props.guideList.forEach((function(A){if(!o.componentMap.get(A)){var e=A.pos,t=A.color,n=new M({position:e,color:t,isUiComponent:o.props.isUiComponent,canEdit:o.props.canEdit,showGuides:o.showSlideGuides(),updateGuide:function(e){o.props.updateGuide(e,A,n)},handleContextMenu:function(e){o.props.handleContextMenu(e,A)}});o.addChild(n),o.componentMap.set(A,n)}}))})),y()(l()(o),"removeAllComponent",(function(){o.componentMap.forEach((function(A,e){o.removeChild(A)})),o.componentMap.clear()})),y()(l()(o),"renderHorzLine",(function(){o.props.guideList.forEach((function(A){if(!o.componentMap.get(A)){var e=A.pos,t=A.color,n=new T({position:e,color:t,isUiComponent:o.props.isUiComponent,canEdit:o.props.canEdit,showGuides:o.showSlideGuides(),updateGuide:function(e){o.props.updateGuide(e,A,n)},handleContextMenu:function(e){o.props.handleContextMenu(e,A)}});o.addChild(n),o.componentMap.set(A,n)}}))})),y()(l()(o),"getAppService",(function(){return b.a.getInstance().getAppServices()})),o.props=A;var r=A.x,a=A.y,c=A.type;return o.x=r,o.y=a,o.type=c,o.guidesManager=null===(n=o.getAppService().editableServiceLayer)||void 0===n?void 0:n.guidesManager,o.initComponentMap(),o.renderComponent(),o}return r()(t,[{key:"dispose",value:function(){h()(v()(t.prototype),"dispose",this).call(this)}}]),t}(m.k),D=t("d5c3deb8c7"),x=t("ea3a38d9d4"),F=t("0a8ecd6412"),I=t("3344f1a2e7"),U=t("d30ed7af65"),j=t("007ae6f287");function N(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}!function(A){A[A.slide=0]="slide",A[A.master=1]="master",A[A.layout=2]="layout"}(P||(P={}));var G=function(A){s()(t,A);var e=N(t);function t(A){var n,o,r,a,c;i()(this,t),c=e.call(this),y()(l()(c),"vertContainer",void 0),y()(l()(c),"horzContainer",void 0),y()(l()(c),"type",void 0),y()(l()(c),"vertGuides",void 0),y()(l()(c),"horzGuides",void 0),y()(l()(c),"cachedVertGuides",void 0),y()(l()(c),"cachedHorzGuides",void 0),y()(l()(c),"reaction",void 0),y()(l()(c),"reaction2",void 0),y()(l()(c),"menuManager",void 0),y()(l()(c),"guidesManager",void 0),y()(l()(c),"gridLineManager",void 0),y()(l()(c),"currentComponent",void 0),y()(l()(c),"slideWidth",void 0),y()(l()(c),"slideHeight",void 0),y()(l()(c),"isUiComponent",void 0),y()(l()(c),"cacheMousePosition",{x:0,y:0,originPos:0}),y()(l()(c),"updateSlide",(function(A,e){c.slideWidth=A,c.slideHeight=e})),y()(l()(c),"renderGuides",(function(){c.getGuidesData(),c.renderHorztContainer(),c.renderVertContainer()})),y()(l()(c),"dispose",(function(){var A,e,n,i,o,r;h()((a=l()(c),v()(t.prototype)),"dispose",a).call(a),null===(A=(e=c).reaction)||void 0===A||A.call(e),null===(n=(i=c).reaction2)||void 0===n||n.call(i),null===(o=c.vertContainer)||void 0===o||o.dispose(),null===(r=c.horzContainer)||void 0===r||r.dispose()})),y()(l()(c),"renderVertContainer",(function(){var A,e=c.getAppService().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),t={x:e.slideLeft/e.scale,y:0,orient:C.a.ppVerticalGuide,guideList:c.vertGuides,updateGuide:c.handleMouseDown,isUiComponent:c.isUiComponent,display:!(null===(A=c.guidesManager)||void 0===A||!A.displayGuides),type:c.type,handleContextMenu:c.showRightMenu,canEdit:c.getCanEdit()};c.vertContainer?c.vertContainer.updateProps(t):(c.vertContainer=new B(t),c.addChild(c.vertContainer))})),y()(l()(c),"renderHorztContainer",(function(){var A,e=c.getAppService().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),t={x:0,y:e.slideTop/e.scale,orient:C.a.ppHorizontalGuide,guideList:c.horzGuides,updateGuide:c.handleMouseDown,isUiComponent:c.isUiComponent,display:!(null===(A=c.guidesManager)||void 0===A||!A.displayGuides),type:c.type,handleContextMenu:c.showRightMenu,canEdit:c.getCanEdit()};c.horzContainer?c.horzContainer.updateProps(t):(c.horzContainer=new B(t),c.addChild(c.horzContainer))})),y()(l()(c),"getCanEdit",(function(){var A;if(c.isUiComponent)return!1;if(c.type===P.slide)return!0;if((null===(A=c.getAppService().editableServiceLayer)||void 0===A?void 0:A.masterLayoutEditService.editType)===w.a.SLIDE&&(c.type===P.master||c.type===P.layout))return!1;var e=c.type===P.master;return c.canEditMasterOrLayout(e)})),y()(l()(c),"canEditMasterOrLayout",(function(A){var e,t,n,i,o=null===(e=c.getAppService().editableServiceLayer)||void 0===e?void 0:e.masterLayoutEditService,r=null===(t=c.getAppService().viewableServiceLayer)||void 0===t?void 0:t.selectionService;return(null==o?void 0:o.editType)!==w.a.SLIDE&&(A?null===(n=r.currentSlide)||void 0===n?void 0:n.getRelationMasterModel():null===(i=r.currentSlide)||void 0===i?void 0:i.getRelationLayoutModel())===r.currentSlide})),y()(l()(c),"getAppService",(function(){return b.a.getInstance().getAppServices()})),y()(l()(c),"getGuidesManager",(function(){var A;return null===(A=c.getAppService().editableServiceLayer)||void 0===A?void 0:A.guidesManager})),y()(l()(c),"getGuidesData",(function(){var A,e,t,n,i,o,r=c.getGuidesManager();switch(c.type){case P.slide:c.vertGuides=(null==r||null===(A=r.slideGuidesService)||void 0===A?void 0:A.vertGuides)||[],c.horzGuides=(null==r||null===(e=r.slideGuidesService)||void 0===e?void 0:e.horzGuides)||[];break;case P.master:c.vertGuides=(null==r||null===(t=r.masterGuidesService)||void 0===t?void 0:t.vertGuides)||[],c.horzGuides=(null==r||null===(n=r.masterGuidesService)||void 0===n?void 0:n.horzGuides)||[];break;case P.layout:c.vertGuides=(null==r||null===(i=r.layoutGuidesService)||void 0===i?void 0:i.vertGuides)||[],c.horzGuides=(null==r||null===(o=r.layoutGuidesService)||void 0===o?void 0:o.horzGuides)||[]}c.cachedVertGuides=c.vertGuides.map((function(A){return A.pos})),c.cachedHorzGuides=c.horzGuides.map((function(A){return A.pos}))})),y()(l()(c),"initReaction",(function(){switch(c.type){case P.slide:c.initSlideReaction();break;case P.master:c.initMasterReaction();break;case P.layout:c.initLayoutReaction()}c.initChangeSlideReaction()})),y()(l()(c),"initChangeSlideReaction",(function(){c.isUiComponent||(c.reaction2=Object(D.r)((function(){return[c.getAppService().viewableServiceLayer.selectionService.currentSlide]}),(function(){requestAnimationFrame((function(){c.getNeedRender()&&c.renderGuides()}))})))})),y()(l()(c),"initSlideReaction",(function(){c.reaction=Object(D.r)((function(){var A,e,t;return[null===(A=c.guidesManager)||void 0===A?void 0:A.displayGuides,null===(e=c.guidesManager)||void 0===e?void 0:e.slideGuidesService.vertGuides.length,null===(t=c.guidesManager)||void 0===t?void 0:t.slideGuidesService.horzGuides.length]}),(function(){requestAnimationFrame((function(){c.renderGuides()}))}))})),y()(l()(c),"initMasterReaction",(function(){c.reaction=Object(D.r)((function(){var A,e,t,n,i;return[null===(A=c.guidesManager)||void 0===A?void 0:A.displayGuides,null===(e=c.guidesManager)||void 0===e?void 0:e.masterGuidesService.vertGuides,null===(t=c.guidesManager)||void 0===t?void 0:t.masterGuidesService.horzGuides,null===(n=c.guidesManager)||void 0===n?void 0:n.masterGuidesService.vertGuides.length,null===(i=c.guidesManager)||void 0===i?void 0:i.masterGuidesService.horzGuides.length]}),(function(){requestAnimationFrame((function(){c.renderGuides()}))}))})),y()(l()(c),"initLayoutReaction",(function(){c.reaction=Object(D.r)((function(){var A,e,t,n,i;return[null===(A=c.guidesManager)||void 0===A?void 0:A.displayGuides,null===(e=c.guidesManager)||void 0===e?void 0:e.layoutGuidesService.vertGuides,null===(t=c.guidesManager)||void 0===t?void 0:t.layoutGuidesService.horzGuides,null===(n=c.guidesManager)||void 0===n?void 0:n.layoutGuidesService.vertGuides.length,null===(i=c.guidesManager)||void 0===i?void 0:i.layoutGuidesService.horzGuides.length]}),(function(){requestAnimationFrame((function(){c.renderGuides()}))}))})),y()(l()(c),"showRightMenu",(function(A,e){var t,n;if(c.menuManager){var i=A.nativeEvent,o=c.menuManager.getRightMenuFromGuides(e);c.menuManager.hideAllMenu();var r=c.getAppService().viewableServiceLayer.linkManager.linkFloatBarService;r.isShown()&&r.hide(),null===(t=c.guidesManager)||void 0===t||t.setCurrentGuide(e),null===(n=c.guidesManager)||void 0===n||n.setCurrentMouseEvent({e:i,pageX:i.pageX,pageY:i.pageY}),c.handleShowRightMenu(o.type,o.items,[],{top:i.clientY,left:i.clientX+8,minWidth:200,subMinWidth:200,onSubMenuVisibleChange:c.onSubMenuVisibleChange.bind(l()(c),o)},(function(A,t,n){o.callback(A,t,{object:n,model:e})}))}})),y()(l()(c),"handleShowRightMenu",(function(A,e,t,n,i){c.getAppService().viewableServiceLayer.rightMenuManager.promise().then((function(o){o.showMenu(A,e,t,n,(function(){o.hideMenu(A),i.apply(void 0,arguments)}))}))})),y()(l()(c),"onSubMenuVisibleChange",(function(A,e,t){A.callback(x.a.POP_MENU,t,{TriggerFrom:F.f.LEFT,visible:e})})),y()(l()(c),"handleMouseDown",(function(A,e,t){var n=A.nativeEvent;0===n.button&&c.guidesManager&&(c.guidesManager.setCurrentGuide(e),c.cacheMousePosition.x=n.clientX,c.cacheMousePosition.y=n.clientY,c.cacheMousePosition.originPos=e.pos,c.currentComponent=t,document.addEventListener("mousemove",c.handleMouseMove),document.addEventListener("mouseup",c.handleMouseUp))})),y()(l()(c),"handleMouseMove",(function(A){if(c.guidesManager){var e=c.getChangedPos(A),t=c.guidesManager.currentGuideModelMap.guide;Object(D.w)((function(){if(t){var n,i;if(t.pos=e,t.orient===C.a.ppVerticalGuide){var o=c.handleVertPos(t);n=o.direction,i=o.message}else{var r=c.handleHoriPos(t);n=r.direction,i=r.message}i=String(Object(I.o)(Math.abs(i)).toFixed(2)),j.a.showTips({left:A.clientX,top:A.clientY,direction:n,message:i})}}))}})),y()(l()(c),"getChangedPos",(function(A){if(!c.guidesManager)return 0;var e=c.getAppService().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize().scale,t=A.clientX-c.cacheMousePosition.x,n=A.clientY-c.cacheMousePosition.y,i=c.guidesManager.currentGuideModelMap.guide,o=0;if(i){var r;i.orient===C.a.ppVerticalGuide?(o=c.cacheMousePosition.originPos+t/e)>c.slideWidth&&(o=c.slideWidth):(o=c.cacheMousePosition.originPos+n/e)>c.slideHeight&&(o=c.slideHeight),o<0&&(o=0);var a=c.guidesManager.getOperationService();null===(r=(i.orient===C.a.ppVerticalGuide?null==a?void 0:a.vertUiComponentContainer:null==a?void 0:a.horzUiComponentContainer).componentMap.get(i))||void 0===r||r.renderGuideLine(o,i.color)}return o})),y()(l()(c),"handleMouseUp",(function(A){var e;if(c.guidesManager){var t=c.guidesManager.currentGuideModelMap.guide;if(c.guidesManager.setCurrentGuidePos((null==t?void 0:t.pos)||0),null===(e=c.currentComponent)||void 0===e||e.renderGuideLine((null==t?void 0:t.pos)||0,(null==t?void 0:t.color)||""),t){var n,i,o,r,a;if(t.orient===C.a.ppVerticalGuide)o=null===(r=c.guidesManager.getOperationService())||void 0===r?void 0:r.vertUiComponentContainer;else o=null===(a=c.guidesManager.getOperationService())||void 0===a?void 0:a.horzUiComponentContainer;null===(n=o)||void 0===n||null===(i=n.componentMap.get(t))||void 0===i||i.renderGuideLine((null==t?void 0:t.pos)||0,t.color)}j.a.hideTips(),document.removeEventListener("mousemove",c.handleMouseMove),document.removeEventListener("mouseup",c.handleMouseUp)}})),y()(l()(c),"handleHoriPos",(function(A){var e,t;(Math.abs(A.pos-c.slideHeight/2)<10&&(A.pos=c.slideHeight/2),null!==(e=c.gridLineManager)&&void 0!==e&&e.isGridAlign)&&(A.pos=c.computeAbsorbGridLine(A.pos,c.slideHeight,(null===(t=c.gridLineManager)||void 0===t?void 0:t.absorbPointY)||[]));return{direction:A.pos>c.slideHeight/2?U.b.down:U.b.up,message:A.pos-c.slideHeight/2}})),y()(l()(c),"computeAbsorbGridLine",(function(A,e,t){var n=t.filter((function(A){return A>0&&A<e}));n.push(0),n.push(e);var i=Number.MAX_SAFE_INTEGER,o=A;return n.forEach((function(e){var t=Math.abs(A-e);t<i&&(i=t,o=e)})),o})),y()(l()(c),"getNeedRender",(function(){var A,e,t,n,i,o,r=c.getGuidesManager(),a=[],l=[];switch(c.type){case P.slide:a=(null==r||null===(A=r.slideGuidesService)||void 0===A?void 0:A.vertGuides)||[],l=(null==r||null===(e=r.slideGuidesService)||void 0===e?void 0:e.horzGuides)||[];break;case P.master:a=(null==r||null===(t=r.masterGuidesService)||void 0===t?void 0:t.vertGuides)||[],l=(null==r||null===(n=r.masterGuidesService)||void 0===n?void 0:n.horzGuides)||[];break;case P.layout:a=(null==r||null===(i=r.layoutGuidesService)||void 0===i?void 0:i.vertGuides)||[],l=(null==r||null===(o=r.layoutGuidesService)||void 0===o?void 0:o.horzGuides)||[]}var s=c.compareGuidesDiff(c.cachedVertGuides,a),d=c.compareGuidesDiff(c.cachedHorzGuides,l);return s||d})),y()(l()(c),"compareGuidesDiff",(function(A,e){var t=!1;return(null==A?void 0:A.length)!==e.length&&(t=!0),null==A||A.forEach((function(A,n){var i;A!==(null==e||null===(i=e[n])||void 0===i?void 0:i.pos)&&(t=!0)})),t}));var s=A.type,d=A.isUiComponent;return c.type=s,c.isUiComponent=d,c.menuManager=null===(n=c.getAppService().editableServiceLayer)||void 0===n?void 0:n.menuManager,c.guidesManager=null===(o=c.getAppService().editableServiceLayer)||void 0===o?void 0:o.guidesManager,c.gridLineManager=null===(r=c.getAppService().editableServiceLayer)||void 0===r?void 0:r.gridLineManager,c.slideWidth=c.getAppService().getUiDataService().presentation.props.slideWidth,c.slideHeight=c.getAppService().getUiDataService().presentation.props.slideHeight,c.isUiComponent?c.pointerEvents=m.I.NONE:c.pointerEvents=m.I.AUTO,c.initReaction(),c.renderGuides(),c}return r()(t,[{key:"handleVertPos",value:function(A){var e,t;(Math.abs(A.pos-this.slideWidth/2)<10&&(A.pos=this.slideWidth/2),null!==(e=this.gridLineManager)&&void 0!==e&&e.isGridAlign)&&(A.pos=this.computeAbsorbGridLine(A.pos,this.slideWidth,(null===(t=this.gridLineManager)||void 0===t?void 0:t.absorbPointX)||[]));return{direction:A.pos>this.slideWidth/2?U.b.right:U.b.left,message:A.pos-this.slideWidth/2}}}]),t}(m.k)},"748db6551d":function(A,e,t){"use strict";t.d(e,"a",(function(){return d}));var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("85d0a7609b"),l=t.n(a),c=t("e0a67dc3fe"),s=t("4e7af1026b"),d=function(){function A(){i()(this,A),l()(this,"disableUncommonFontLogic",!1)}return r()(A,[{key:"disableVip",get:function(){var A;return!(null===(A=c.a.getConfig("custom.vip"))||void 0===A||A)}},{key:"disableCloudFont",get:function(){var A;return!(null===(A=c.a.getConfig(s.k.cloudFont))||void 0===A||A)}},{key:"injectedFontUsingStatus",get:function(){}}]),A}()},"7ad4a16d65":function(A,e,t){"use strict";t.d(e,"a",(function(){return u}));var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("85d0a7609b"),l=t.n(a),c=(t("8ee19818c4"),t("516fa97df2")),s=t("f9193d718f"),d=t("d9812f1c6f"),u=function(){function A(e,t,n,o,r,a){i()(this,A),l()(this,"application",void 0),l()(this,"canvasDom",void 0),l()(this,"renderComponent",void 0),l()(this,"scale",void 0),l()(this,"components",void 0),l()(this,"left",void 0),l()(this,"top",void 0),l()(this,"renderRectConfig",void 0),l()(this,"isOffsetWithPage",void 0),this.scale=n,this.isOffsetWithPage=!!a;var c=r||{},d=c.scrollLeft,u=void 0===d?0:d,p=c.scrollTop,h=void 0===p?0:p,f=s.a.getInstance().getAppServices().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),v=f.slideLeft,g=f.slideTop;this.left=v+u,this.top=g+h,this.application=o,this.application.resolution=Math.ceil(window.devicePixelRatio),this.buildSlideComponent(),this.updateInfo(e,t,n),this.components=[],this.application.requestRender()}return r()(A,[{key:"updateInfo",value:function(A,e,t,n){var i=Math.round(A),o=Math.round(e);this.scale=t,this.application.width=i,this.application.height=o,this.application.stage.transform.scaleX=t,this.application.stage.transform.scaleY=t;var r=s.a.getInstance().getAppServices().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize(),a=r.slideLeft,l=r.slideTop;if(n){this.renderRectConfig=n;var c=n.contentSize,d=n.scrollLeft,u=n.scrollTop,p=n.currentScrollX,h=void 0===p?0:p,f=n.currentScrollY,v=void 0===f?0:f;a=c.left+d+h,l=c.top+u+v}this.isOffsetWithPage||(this.renderComponent.x=a/this.scale,this.renderComponent.y=l/this.scale),this.application.requestRender()}},{key:"updatePosition",value:function(A){if(A&&(this.renderRectConfig=A),this.renderRectConfig){var e=s.a.getInstance().getAppServices().viewableServiceLayer.editAreaCanvasSizeManager.getCanvasSize().scale,t=this.renderRectConfig,n=t.contentSize,i=t.scrollLeft,o=t.scrollTop,r=this.getScrollService(),a=r.currentScrollX,l=r.currentScrollY;this.left=n.left+i,this.top=n.top+o,this.getNeedOpenAutoRender()||(this.application.autoRender=!1),this.isOffsetWithPage?(this.renderComponent.x=a/e,this.renderComponent.y=l/e):(this.renderComponent.x=(this.left+a)/this.scale,this.renderComponent.y=(this.top+l)/this.scale),this.application.autoRender=!0}}},{key:"updateComponents",value:function(A){this.renderComponent.addChildAt(A,0)}},{key:"clearComponent",value:function(A){this.renderComponent.removeChild(A)}},{key:"clearAllComponent",value:function(){for(;this.renderComponent.children[0];)this.renderComponent.removeChild(this.renderComponent.children[0])}},{key:"buildSlideComponent",value:function(){this.renderComponent=new c.j,this.isOffsetWithPage?(this.renderComponent.x=0,this.renderComponent.y=0):(this.renderComponent.x=this.left/this.scale,this.renderComponent.y=this.top/this.scale),this.application.stage.addChild(this.renderComponent)}},{key:"getScrollService",value:function(){return d.a.isMobile?s.a.getInstance().getAppServices().viewableServiceLayer.mobileScrollService:s.a.getInstance().getAppServices().viewableServiceLayer.pcScrollService}},{key:"getNeedOpenAutoRender",value:function(){var A=!1;return this.application.stage.children.forEach((function(e){var t;null!==(t=e.children)&&void 0!==t&&t.length&&(A=!0)})),A}}]),A}()},"81758a57a2":function(A,e,t){"use strict";t.d(e,"b",(function(){return c})),t.d(e,"a",(function(){return s}));t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var n=t("85d0a7609b"),i=t.n(n),o=t("ffc220634f"),r=t("8f6e67dde4");function a(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function l(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?a(Object(t),!0).forEach((function(e){i()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var c=function(A,e){var t,n=e.frame,i=Object(o.c)(n,null==e||null===(t=e.model)||void 0===t?void 0:t.props);return s(A,l(l({},n),i))};function s(A,e){var t=e.left,n=e.top,i=e.width,o=e.height,a=e.rotate;return A.x=Math.floor(t)+Math.floor(i/2),A.y=Math.floor(n)+Math.floor(o/2),A.pivotX=Math.floor(i/2),A.pivotY=Math.floor(o/2),void 0!==a&&(A.angle=a),A.scaleX=Object(r.a)(e)?-1:1,A.scaleY=Object(r.b)(e)?-1:1,A}},"86ade74201":function(A,e,t){"use strict";t.d(e,"a",(function(){return dA}));t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("bcb5d93d36");var n,i=t("14502724a6"),o=t.n(i),r=t("9132715560"),a=t.n(r),l=t("6a364eb35c"),c=t.n(l),s=t("85d0a7609b"),d=t.n(s),u=(t("0acdc5834b"),t("3dc760a4d9"),t("b8217400dc"),t("e6f68cdf2e"),t("8ee19818c4"),t("963f2eaace"),t("6e20b6a7d8"),t("af802ec74b"),t("563386153f"),t("c6244f7705"),t("bd80bf2d0f"),t("ce428b7e85"));!function(A){A[A.INPUT_IDLE=0]="INPUT_IDLE",A[A.INPUT_START=1]="INPUT_START",A[A.INPUTTING=2]="INPUTTING",A[A.INPUT_END=3]="INPUT_END"}(n||(n={}));var p=function(){function A(e){a()(this,A),d()(this,"uploadDelegate",void 0),d()(this,"curState",n.INPUT_IDLE),d()(this,"inputTimer",void 0),d()(this,"paraTextsBeforeStart",void 0),d()(this,"paraTextsInputting",void 0),this.uploadDelegate=e}return c()(A,[{key:"enterInputIdle",value:function(A){this.curState=n.INPUT_IDLE,this.paraTextsBeforeStart=A,this.cancelTimer()}},{key:"cancel",value:function(){this.isInputState()&&(this.cancelTimer(),this.onInputEnd(this.paraTextsInputting,!1))}},{key:"onEditorChange",value:function(A){this.isNoInputState()&&!this.isParaTextEqual(A)&&this.onInputStart(A),this.isInputState()&&this.onInputting(A)}},{key:"clear",value:function(){this.paraTextsInputting=[],this.paraTextsBeforeStart=[]}},{key:"isNoInputState",value:function(){return this.curState===n.INPUT_IDLE||this.curState===n.INPUT_END}},{key:"isInputState",value:function(){return this.curState===n.INPUT_START||this.curState===n.INPUTTING}},{key:"cancelTimer",value:function(){this.inputTimer&&clearTimeout(this.inputTimer),this.inputTimer=null}},{key:"startTimer",value:function(A){var e=this;this.inputTimer=setTimeout((function(){e.inputTimer=null,e.onInputEnd(A,!0)}),2500)}},{key:"onInputStart",value:function(A){this.curState=n.INPUT_START,this.doWhenInput(A)}},{key:"onInputting",value:function(A){this.curState=n.INPUTTING,this.doWhenInput(A)}},{key:"onInputEnd",value:function(A){var e,t,i,o,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(this.curState=n.INPUT_END,this.needUploadData(r,A))?(null===(e=window.log)||void 0===e||e.info("editor auto save happen"),null===(t=this.uploadDelegate)||void 0===t||t.triggerUploadData()):null===(i=this.uploadDelegate)||void 0===i||null===(o=i.resetHasValueChangeFlag)||void 0===o||o.call(i);this.paraTextsBeforeStart=A,this.paraTextsInputting=[]}},{key:"needUploadData",value:function(A,e){return A&&!this.isParaTextEmpty(e)&&!this.isParaTextEqual(e)}},{key:"doWhenInput",value:function(A){this.paraTextsInputting=A,this.cancelTimer(),this.startTimer(A)}},{key:"isParaTextEqual",value:function(A){var e=this.paraTextsBeforeStart;if(Array.isArray(A)&&Array.isArray(e)){var t=A.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(A[n].paraIndex!==e[n].paraIndex||A[n].text!==e[n].text)return!1;return!0}return!1}},{key:"isParaTextEmpty",value:function(A){if(Array.isArray(A)){var e;if(A.length>1)return!1;var t=null===(e=A[0])||void 0===e?void 0:e.text;if(t&&t.length>0)return!1}return!0}}]),A}(),h=t("1e07095161"),f=t("609550d527"),v=t("51b2ea9953"),g=t("eabf3daf43"),y=t("0a8ecd6412"),m=t("9789b08c01"),b=(t("3bf1976a4f"),t("123ec094e2"));function C(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function S(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?C(Object(t),!0).forEach((function(e){d()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function E(A,e){var t=Object(b.a)(A.anchor,A.focus),n=e.reduce((function(A,e,n){return n<t.sIndex||n>t.eIndex?A:function(A,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t.sIndex,i=void 0===n?0:n,o=t.eIndex,r=void 0===o?0:o,a=t.sOffset,l=void 0===a?0:a,c=t.eOffset,s=void 0===c?0:c;if(e>r||e<i)return!1;if(e<r&&e>i)return!0;var d=A.textRuns.reduce((function(A,e){var t;return A+(null===(t=e.text)||void 0===t?void 0:t.length)||0}),0);return e===i&&e===r?0===l&&s===d:e===i?0===l:e!==r||s===d}(e,n,t)?A.concat(S(S({},e),{},{para:!0})):A.concat(S(S(S({},e),function(A,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t.sIndex,i=void 0===n?0:n,o=t.eIndex,r=void 0===o?0:o,a=t.sOffset,l=void 0===a?0:a,c=t.eOffset,s=void 0===c?0:c,d=A.textRuns.reduce((function(A,e){var t;return A+(null===(t=e.text)||void 0===t?void 0:t.length)||0}),0),u=e===i?l:0,p=e===r?s:d,h=Object(g.o)(A,u,p);return{textRuns:h.removedTextRuns}}(e,n,t)),{},{para:!1}))}),[]);return n}var O=t("d9812f1c6f"),k=t("38ba58fbda"),M=O.a.isMac?"metaKey":"ctrlKey",L=function(){function A(e){var t=e.triggerRedo,n=e.triggerUndo;a()(this,A),d()(this,"triggerRedo",void 0),d()(this,"triggerUndo",void 0),this.triggerRedo=t,this.triggerUndo=n}return c()(A,[{key:"handleKeyZEvent",value:function(A){var e,t;return!!A[M]&&(null===(e=A.preventDefault)||void 0===e||e.call(A),null===(t=A.stopPropagation)||void 0===t||t.call(A),O.a.isMac?(A.shiftKey?this.triggerRedo():this.triggerUndo(),!0):(this.triggerUndo(),!0))}},{key:"handleKeyYEvent",value:function(A){var e,t;return!!A[M]&&(null===(e=A.preventDefault)||void 0===e||e.call(A),null===(t=A.stopPropagation)||void 0===t||t.call(A),this.triggerRedo(),!0)}}]),A}(),T=(t("75563bc376"),t("4bbb5840d5"),t("433247001a"),t("1bab7b5fb7"),t("0aeae65bf4"),t("7cedfefaf9")),w=t.n(T),R=t("c2f805291c"),P=t("9b4040e03e"),B=t("0442e400dc"),D=function(){function A(e){var t=e.editor,n=e.getSelection,i=e.operationHandler;a()(this,A),d()(this,"editor",void 0),d()(this,"getSelection",void 0),d()(this,"operationHandler",void 0),this.editor=t,this.getSelection=n,this.operationHandler=i}return c()(A,[{key:"handleTabEvent",value:function(A){return this.operationHandler.setIndent(null!=A&&A.shiftKey?B.b.INDENT_REDUCE:B.b.INDENT_INCREASE),!0}},{key:"handleEnterEvent",value:function(A){var e=this.editor;if(!e.selection)return!1;var t=e.getStartPoint(),n=e.getParent(t.path)[0];return Object(h.e)(n)||this.autoNumbering(),!1}},{key:"handleBackspaceEvent",value:function(A){var e,t,n,i,r=this.editor.getValue(),a=this.getSelection();if(null===a)return!1;var l=a.anchor,c=a.focus;if(!Object(h.f)(l,c))return!1;var s=o()(l.path,1)[0],d=r.children[s];return!!Object(h.e)(d)&&(null===(e=A.preventDefault)||void 0===e||e.call(A),null===(t=A.stopPropagation)||void 0===t||t.call(A),null===(n=(i=this.operationHandler).setCharacter)||void 0===n||n.call(i,{type:R.b.ITEMSYMBOL_NONE}),!0)}},{key:"autoNumbering",value:function(){var A=this.editor,e=A.getStartPoint(),t=e.path.slice(0,-1),n=A.getStartPoint(t),i=A.getString({anchor:n,focus:e});if(i){var o=this.getMatchedNumbering(i);if(o){var r,a,l=o.type,c=o.matchedString,s=A.getAfterPoint(n,c.length);A.deleteText({anchor:n,focus:s}),null===(r=(a=this.operationHandler).setCharacter)||void 0===r||r.call(a,{type:l})}}}},{key:"getMatchedNumbering",value:function(A){var e=Object(P.a)(),t="",n=e.find((function(e){var n=e.startText;if(A.startsWith("".concat(n," "))){var i=new RegExp("^(".concat(w()(n),"\\s+)\\S+")),r=A.match(i);if(r){var a=o()(r,2);return t=a[1],!0}}return!1}));return n&&{type:n.type,matchedString:t}}}]),A}(),x=function(){function A(e){var t=e.editor;a()(this,A),d()(this,"editor",void 0),this.editor=t}return c()(A,[{key:"handleTabEvent",value:function(){return this.editor.insertText("\t"),!0}}]),A}(),F=function(){function A(e){var t=this,n=e.editor,i=e.getSelection,o=e.operationHandler,r=e.triggerUndo,l=e.triggerRedo,c=e.shouldPreventTab;a()(this,A),d()(this,"eventMap",void 0),d()(this,"editor",void 0),d()(this,"getSelection",void 0),d()(this,"shouldPreventTab",void 0),d()(this,"undoHandler",void 0),d()(this,"characterHandler",void 0),d()(this,"tabstopHandler",void 0),this.editor=n,this.getSelection=i,this.shouldPreventTab=c,this.undoHandler=new L({triggerUndo:r,triggerRedo:l}),this.characterHandler=new D({editor:n,getSelection:i,operationHandler:o}),this.tabstopHandler=new x({editor:n}),this.eventMap={tab:function(A){var e,n;return null===(e=A.preventDefault)||void 0===e||e.call(A),null===(n=A.stopPropagation)||void 0===n||n.call(A),!t.shouldPreventTab&&(t.shouldHandleCharacterTab()?t.characterHandler.handleTabEvent(A):t.tabstopHandler.handleTabEvent())},enter:function(A){return t.characterHandler.handleEnterEvent(A)},backspace:function(A){return t.characterHandler.handleBackspaceEvent(A)},z:function(A){return t.undoHandler.handleKeyZEvent(A)},y:function(A){return t.undoHandler.handleKeyYEvent(A)}}}return c()(A,[{key:"handleEvent",value:function(A){var e,t,n,i=null===(e=A.key)||void 0===e?void 0:e.toLowerCase();return null===(t=(n=this.eventMap)[i])||void 0===t?void 0:t.call(n,A)}},{key:"shouldHandleCharacterTab",value:function(){var A=this.editor.getValue(),e=this.getSelection();if(null===e)return!1;var t=e.anchor,n=e.focus,i=o()(t.path,1)[0],r=A.children[i];return!!Object(h.e)(r)&&!!Object(h.f)(t,n)}}]),A}(),I=t("5a4e4e2c55"),U=t("aa3cc80657"),j=t("65634518db"),N=t("c2b620c600"),G=t("0e41c725b0"),H=t("2a5f3314a4"),z=function(){function A(){a()(this,A)}return c()(A,null,[{key:"register",value:function(){if(!this.hasRegistered){var A;if(this.isNeedExternalKeyEvent())this.invokeShortcut(),null===(A=window.mqq)||void 0===A||A.addEventListener("shortcutKeyEvent",this.dispatchKeyboardEvent);this.hasRegistered=!0}}},{key:"unRegister",value:function(){var A;(this.hasRegistered=!1,this.isNeedExternalKeyEvent())&&(null===(A=window.mqq)||void 0===A||A.removeEventListener("shortcutKeyEvent",this.dispatchKeyboardEvent))}},{key:"invokeShortcut",value:function(){this.hasInvoked||(G.e.invokeDocx("registerShortcutKeyEvent",{shortcutKey:[{input:"left",modifier:""},{input:"right",modifier:""},{input:"up",modifier:""},{input:"down",modifier:""}]}),this.hasInvoked=!0)}},{key:"isNeedExternalKeyEvent",value:function(){return window.mqq&&O.a.isIPad&&O.a.isTencentDocApp}}]),A}();function _(A,e){return new KeyboardEvent("keydown",{altKey:!1,bubbles:!0,cancelable:!0,charCode:0,code:A,ctrlKey:!1,detail:0,key:A,keyCode:e,metaKey:!1,repeat:!1,shiftKey:!1})}d()(z,"hasRegistered",!1),d()(z,"hasInvoked",!1),d()(z,"dispatchKeyboardEvent",(function(A){var e=document.querySelector(".".concat(H.f));e&&("up"===A.input&&(null==e||e.dispatchEvent(_("ArrowUp",38))),"down"===A.input&&(null==e||e.dispatchEvent(_("ArrowDown",40))),"left"===A.input&&(null==e||e.dispatchEvent(_("ArrowLeft",37))),"right"===A.input&&(null==e||e.dispatchEvent(_("ArrowRight",39))))}));var V=t("477433b002"),W=t("153bd00100"),K=t("382929c8da"),Y=(t("826dc923b3"),t("9da6335152")),X=t("d3d31c86eb"),Q=t("8930941e65"),q=t("787f07bc3b"),Z=t("54a7b7d7a1"),J=t("14c02e2331"),$=t("d13c0b2ee1"),AA=t("2835303a33"),eA=t("06e1dc2299");function tA(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function nA(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?tA(Object(t),!0).forEach((function(e){d()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):tA(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var iA=function(){function A(e,t){var n=this;a()(this,A),d()(this,"editor",void 0),d()(this,"editorModel",void 0),d()(this,"operationMap",void 0),d()(this,"setFontSizeIncrease",(function(A,e,t){var i=n.editor.getLeafNodeAndRangeRef(n.editor.operationRange),o=n.editor.isEditing&&!n.editor.isExpanded();i.forEach((function(i){var r=i,a=r.node,l=r.rangeRef,c=o?n.editor.getStyle():a,s=c.fontSize,d=c.rawFontSize,u=c.displayFontSize,p=c.fontSizeFrom,h=c["raw-fontSize"],f=Object.create(null);Object(Q.a)(s).isNullOrUndefined()||(f.fontSize=n.getSize(s+A*Z.g,e*Z.g,t*Z.g)),Object(Q.a)(d).isNullOrUndefined()||(f.rawFontSize=n.getSize(d+A,e,t)),Object(Q.a)(u).isNullOrUndefined()||(f.displayFontSize=n.getSize(u+A*Z.g,e*Z.g,t*Z.g)),Object(Q.a)(p).isNullOrUndefined()||(f.fontSizeFrom="textrun"),Object(Q.a)(h).isNullOrUndefined()||(f["raw-fontSize"]=!0),n.editor.isSelectAllText()&&(f.displayFontSize=f.fontSize),n.editor.setStylesForSelection(f,l)})),0===i.length&&n.handleFontSizeChangeNoSelection(A,e,t)})),d()(this,"getSize",(function(A,e,t){return A>t?t:A<e?e:A})),d()(this,"handleFontSizeChangeNoSelection",(function(A,e,t){var i=N.a.getOriginProps(n.editor.getStyle());if(i.displayFontSize){var o=n.getSize(i.displayFontSize+A*Z.g,e*Z.g,t*Z.g)/Z.g;n.setFontSizeInner(o)}})),d()(this,"setCharacterAndUpdate",(function(){var A,e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.type,o=void 0===i?"":i,r=t.color,a=t.size,l=t.customText,c=t.customImage,s=t.startNumber,d=t.range,u=void 0===d?"default":d,p=arguments.length>1?arguments[1]:void 0,h=n.editor.getEditorValue(),f=n.editor.getConvertFromDocElement(h).paragraphList,v=n.editor.getSelectionNodes((function(A){return"paragraph"===A.type})),y=null==v||null===(A=v[0])||void 0===A?void 0:A[1],m=null==v||null===(e=v[(null==v?void 0:v.length)-1])||void 0===e?void 0:e[1],b=null==y?void 0:y[(null==y?void 0:y.length)-1],C=null==m?void 0:m[(null==m?void 0:m.length)-1],S=f.map((function(A,e){var t,i;if("all"!==u&&(e<b||e>C))return A;var d=n.getLevel(p,A),h=Object(I.b)(A.paragraphCharacter,{type:o,color:r,size:a,customText:l,customImage:c,startNumber:s});h.raw=Object.keys(h);var f=nA(nA({},A),{},{paragraphCharacter:h}),v=Object(g.a)({textRunStyle:null===(t=f.textRuns)||void 0===t||null===(i=t[0])||void 0===i?void 0:i.styles});return h.character?f.paragraphProps=Object($.b)({level:d,fontSize:v.rawFontSize,marginLeft:f.paragraphProps.marginLeft,textIndent:f.paragraphProps.textIndent,characterType:o,shapeModel:n.editorModel.model},f.paragraphProps):f.paragraphProps=Object($.a)({shapeModel:n.editorModel.model,level:d,marginLeft:f.paragraphProps.marginLeft,textIndent:f.paragraphProps.textIndent},f.paragraphProps),Object(Q.a)(p).isNullOrUndefined()||(f.paragraphProps.level=p),f}));n.editor.updateRawData(S,void 0,void 0,n.editorModel.autoFitType)})),d()(this,"setParaIndent",(function(){var A,e,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,i=void 0===t?B.b.INDENT_INCREASE:t,o=n.editor.getEditorValue(),r=n.editor.getConvertFromDocElement(o).paragraphList,a=n.editor.getSelectionNodes((function(A){return"paragraph"===A.type})),l=null==a||null===(A=a[0])||void 0===A?void 0:A[1],c=null==a||null===(e=a[a.length-1])||void 0===e?void 0:e[1],s=null==l?void 0:l[(null==l?void 0:l.length)-1],d=null==c?void 0:c[(null==c?void 0:c.length)-1],u=r.map((function(A,e){return e<s||e>d?A:Object(AA.a)(A,i,n.editorModel.model)}));n.editor.updateRawData(u,void 0,void 0,n.editorModel.autoFitType)})),this.editorModel=e,this.initOperationMap(),this.editor=t}return c()(A,[{key:"operations",value:function(A,e,t){var n=this.operationMap[A],i=!1,o=!0;return n&&(o=void 0===(o=n(e,t))||o,i=!0),{isHandled:i,needUpdate:o}}},{key:"setIndent",value:function(A){return this.editor.props.disableIndentation||(A===B.b.INDENT_INCREASE?Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.INDENT,action:Y.b.INDENT}):Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.INDENT,action:Y.b.DEC_INDENT}),this.setParaIndent({type:A})),!1}},{key:"setCharacter",value:function(A){return this.setCharacterAndUpdate(nA(nA({},A),{},{range:this.editor.isEditing?"default":"all"})),!1}},{key:"setFontSize",value:function(A){Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_SIZE});var e=A.match(/-([\d.]*)pt/);if(e){var t=Number(e[1]),n=this.editor.isSelectAllText(),i=this.editorModel.resizeLevel;Object(Q.a)(i).isNullOrUndefined()||n||(t=Number(Object(q.c)(t,i)));var o=this.editor.operationRange;this.setFontSizeInner(t,o)}}},{key:"setFontSizeUp",value:function(A){Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_SIZE}),this.setFontSizeChange(A)}},{key:"setFontSizeDown",value:function(A){Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_SIZE}),this.setFontSizeChange(A)}},{key:"setFontColor",value:function(A){var e,t;Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_COLOR}),A.srgb_color&&(A.srgb_color=A.srgb_color.toUpperCase()),this.setFontFill({tdColor:A});var n={};J.z.map((function(A){return n[A]=null})),null===(e=this.editor)||void 0===e||null===(t=e.removeStylesForSelection)||void 0===t||t.call(e,nA(nA({},n),{},{fillBackground:null}),this.editor.operationRange)}},{key:"setFontBackground",value:function(A){return Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_HIGHLIGHT}),this.editor.setStylesForSelection({backgroundColor:(null==A?void 0:A.srgb_color)||null},this.editor.operationRange)}},{key:"setFontVerticalAlign",value:function(A){switch(Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_SET,action:Y.b.TEXT_VERTICAL_ALIGN}),A){case B.a.VERTICAL_TOP:return this.editor.setStylesForTextBody({alignItems:"flex-start"});case B.a.VERTICAL_CENTER:return this.editor.setStylesForTextBody({alignItems:"center"});case B.a.VERTICAL_BOTTOM:return this.editor.setStylesForTextBody({alignItems:"flex-end"})}}},{key:"setFontHorizontalAlign",value:function(A){switch(Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_SET,action:Y.b.TEXT_HORIONTAL_ALIGN}),A){case B.a.HORIZONTAL_LEFT:return this.editor.setStylesForPara({textAlign:"left"},this.editor.operationRange);case B.a.HORIZONTAL_CENTER:return this.editor.setStylesForPara({textAlign:"center"},this.editor.operationRange);case B.a.HORIZONTAL_RIGHT:return this.editor.setStylesForPara({textAlign:"right"},this.editor.operationRange);case B.a.HORIZONTAL_JUSTIFY:return this.editor.setStylesForPara({textAlign:"justify"},this.editor.operationRange);case B.a.HORIZONTAL_DISTRIBUTE:return this.editor.setStylesForPara({textAlign:"distribute"},this.editor.operationRange)}}},{key:"setFontFamily",value:function(A){return Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_FONT}),this.editor.setStylesForSelection({fontFamily:A,fonts:{ea:A,latin:A}},this.editor.operationRange)}},{key:"setFontFamilyWithLang",value:function(A){if(A.ea||A.latin){var e={fonts:{}};return A.ea&&(e.fonts.ea=A.ea),A.latin&&(e.fonts.latin=A.latin),this.editor.setStylesForSelection(e,this.editor.operationRange)}}},{key:"setFontBold",value:function(A){return Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_BOLD}),A?this.editor.setStylesForSelection({fontWeight:"bold"},this.editor.operationRange):this.editor.setStylesForSelection({fontWeight:"normal"},this.editor.operationRange)}},{key:"setFontItalic",value:function(A){return Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_ITALIC}),A?this.editor.setStylesForSelection({fontStyle:"italic"},this.editor.operationRange):this.editor.setStylesForSelection({fontStyle:"normal"},this.editor.operationRange)}},{key:"setEffect",value:function(A){return this.editor.setStylesForSelection(A,this.editor.operationRange)}},{key:"setFontFill",value:function(A){var e=this,t=nA({},A);t.tdColor&&(t.color=t.tdColor.srgb_color),t=nA(nA({},t),{},{fill:Object(eA.c)({fillBackground:nA({},t)})});var n=this.editor.getLeafNodeAndRangeRef(this.editor.operationRange);n.some((function(A){return A.node["origin-href"]}))?n.forEach((function(A){var n=A.node,i=A.rangeRef,o=n["origin-href"];o?e.editor.setStylesForSelection(nA({href:nA(nA({},o),{},{colorType:"tx"})},t),i):e.editor.setStylesForSelection(t,i)})):this.editor.setStylesForSelection(t,this.editor.operationRange)}},{key:"setFontBorder",value:function(A){return this.editor.setStylesForSelection(A,this.editor.operationRange)}},{key:"setFontUnderline",value:function(A){return Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_UNDERLINE}),A?this.editor.setStylesForSelection({textDecoration:"underline"},this.editor.operationRange):this.editor.setStylesForSelection({textDecoration:"none"},this.editor.operationRange)}},{key:"setDelete",value:function(A){return Object(X.c)({opername:Y.e.DOC_PPT,module:Y.d.PC_TEXT_FORMAT,action:Y.b.TEXT_DELETE}),A?this.editor.setStylesForSelection({del:"sng"},this.editor.operationRange):this.editor.setStylesForSelection({del:"none"},this.editor.operationRange)}},{key:"setParagraphProps",value:function(A){this.handleParaPropsFontScale(A),Object(Q.a)(A.paddingTop).isNumber()&&(A.rawPaddingTop=A.paddingTop),Object(Q.a)(A.paddingBottom).isNumber()&&(A.rawPaddingBottom=A.paddingBottom),this.editor.setStylesForPara(A,this.editor.operationRange)}},{key:"setTextBaseLineOffset",value:function(A){this.editor.setStylesForSelection(d()({},J.x,A),this.editor.operationRange)}},{key:"setTextDirection",value:function(A){this.editor.setStylesForTextBody({textDirection:A})}},{key:"setColumnsData",value:function(A){var e=A.columnNumber,t=A.columnSpace,n={};Object(Q.a)(e).isNumber()&&(n.columnNumber=e),Object(Q.a)(t).isNumber()&&(n.columnSpace=t),Object.keys(n).length>0&&this.editor.setStylesForTextBody(n)}},{key:"setFontSizeInner",value:function(A,e){var t=A*Z.g;return this.editor.setStylesForSelection({rawFontSize:A,displayFontSize:t,fontSize:t,fontSizeFrom:"textrun"},e)}},{key:"setFontSizeChange",value:function(A){var e=A.size||0,t=A.min||8,n=A.max||192,i=this.editor.isSelectAllText(),o=this.editorModel.resizeLevel;return o&&!i&&(e=Object(q.c)(e,o)),this.setFontSizeIncrease(e,t,n)}},{key:"getLevel",value:function(A,e){return A||e.paragraphProps.level||0}},{key:"handleParaPropsFontScale",value:function(A){var e=["marginLeft","textIndent","paddingTop","paddingBottom","tabSize"];A.lineHeight&&"absolute"===A.lineHeightIs&&e.push("lineHeight"),e.forEach((function(e){"number"==typeof A[e]&&(A[e]=A[e]*Z.g)})),A.tabList&&(A.tabList=A.tabList.map((function(A){return nA(nA({},A),{},{position:A.position*Z.g})})))}},{key:"initOperationMap",value:function(){var A,e=this;this.operationMap=(A={"font-size":function(A){return e.setFontSize(A)},"font-size-up":function(A){return e.setFontSizeUp(A)},"font-size-down":function(A){return e.setFontSizeDown(A)},"font-color":function(A){return e.setFontColor(A)},"font-background":function(A){return e.setFontBackground(A)},"font-vertical-align":function(A){return e.setFontVerticalAlign(A)},"font-horizontal-align":function(A){return e.setFontHorizontalAlign(A)},"font-family":function(A){return e.setFontFamily(A)},"font-bold":function(A){return e.setFontBold(A)},"font-italic":function(A){return e.setFontItalic(A)},"font-underline":function(A){return e.setFontUnderline(A)},"font-delete":function(A){return e.setDelete(A)}},d()(A,K.a.BULLET_SET,(function(A){return e.setCharacter(A)})),d()(A,"paragraph-props",(function(A){return e.setParagraphProps(A)})),d()(A,"indent",(function(A){return e.setIndent(A)})),d()(A,J.n,(function(A){return e.setEffect(A)})),d()(A,"text-baseline-offset",(function(A){return e.setTextBaseLineOffset(A)})),d()(A,K.a.TEXT_DIRECTION,(function(A){return e.setTextDirection(A)})),d()(A,J.o,(function(A){return e.setFontFill(A)})),d()(A,J.m,(function(A){return e.setFontBorder(A)})),d()(A,K.a.UNIFORM_FONT,(function(A){return e.setFontFamilyWithLang(A)})),d()(A,K.a.COLUMNS,(function(A){return e.setColumnsData(A)})),A)}}]),A}(),oA=37,rA=39,aA=38,lA=40;function cA(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function sA(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?cA(Object(t),!0).forEach((function(e){d()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):cA(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var dA=function(){function A(e,t,n){var i=this;a()(this,A),d()(this,"editorView",void 0),d()(this,"dataModel",void 0),d()(this,"services",void 0),d()(this,"hasValueChange",!1),d()(this,"saveFocusCallBack",void 0),d()(this,"alreadyChange",!1),d()(this,"editorAutoSave",void 0),d()(this,"operationKey",void 0),d()(this,"editorEvent",void 0),d()(this,"operationHandler",void 0),d()(this,"getAutoFitType",(function(A,e){var t;if(e!==v.a.FONT_AUTO_FIT||!i.isSelectAllText()||i.operationKey!==y.p.FONT_SIZE&&i.operationKey!==y.p.FONT_SIZE_UP)return e;var n=sA({},i.props.textRect||Object(g.b)()),o=sA({},i.props.textBodyStyle),r=u.a.convertFromTextModel({paragraphList:A,textBodyStyle:o},{noConvertBack:!1});return f.a.getEditorBlockSize(r,{textRect:n,textBodyStyle:o})>(Object(W.b)(null===(t=o.wrapperStyle)||void 0===t?void 0:t.textDirection)?n.width:n.height)&&(e=v.a.NO_AUTO_FIT),e})),d()(this,"setStylesForSelection",(function(A,e){var t=Object.entries(A).reduce((function(e,t){var n=o()(t,2),i=n[0],r=n[1],a=N.a.transformTextStyle(i,r,A);if(a){var l=Object.entries(a),c=o()(l,1),s=o()(c[0],2),d=s[0],u=s[1];e[d]=u}return e["origin-".concat(i)]=r,e["origin-raw-".concat(i)]=!0,e}),{}),n=i.dataModel.model||{},r=n.isFromMaster,a=n.isFromLayout,l=n.isPlaceholder;(r||a)&&l?i.handleMasterPlaceholder(t,e):i.editor.changeTextProps(t,e,(function(A,e,t){return[K.a.EFFECT,"origin-".concat(K.a.EFFECT)].includes(A)?sA(sA({},e),t):t}))})),d()(this,"removeStylesForSelection",(function(A,e){Object.entries(A).forEach((function(A){var t=o()(A,2),n=t[0],r=t[1],a=N.a.transformTextStyle(n,r);if(a){var l=o()(Object.entries(a)[0],2),c=l[0];l[1];i.editor.removeTextProps(c,e)}else i.editor.removeTextProps(n,e);i.editor.removeTextProps("origin-".concat(n),e)}))})),d()(this,"setStylesForTextBody",(function(A){i.updateHasValueChangeFlag(!0);var e=Object.entries(A).reduce((function(e,t){var n=o()(t,2),i=n[0],r=n[1],a=N.a.transformEditorStyle(i,r,A);if(a){var l=Object.entries(a),c=o()(l,1),s=o()(c[0],2),d=s[0],u=s[1];e[d]=u}return e["origin-".concat(i)]=r,e["origin-raw-".concat(i)]=!0,e}),{});i.editor.changeDocumentProps(e)})),d()(this,"setStylesForPara",(function(A,e){var t=Object.entries(A).reduce((function(e,t){var n=o()(t,2),i=n[0],r=n[1],a=N.a.transformParaStyle(i,r,A);if(a){var l=Object.entries(a),c=o()(l,1),s=o()(c[0],2),d=s[0],u=s[1];e[d]=u}return e["origin-".concat(i)]=r,e["origin-raw-".concat(i)]=!0,e}),{});i.editor.changeParagraphProps(t,e)})),d()(this,"updateHasValueChangeFlag",(function(A){i.hasValueChange=A,i.editorView.updateChangeFlag(A)})),d()(this,"handleMasterPlaceholder",(function(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.editor.selection,t=i.dataModel.model||{},n=t.isTitleOrCtrTitlePl,r=t.isSubTitlePl;n||r?i.editor.getNodes((function(A){return"paragraph"===A.type})).forEach((function(e){var t=o()(e,2),n=t[0],r=t[1];i.supplyEffect(n,A),i.editor.changeTextProps(A,r)})):i.editor.getNodes((function(A){return"paragraph"===A.type}),e).forEach((function(e){var t=o()(e,2),n=t[0],r=t[1];i.supplyEffect(n,A),i.editor.changeTextProps(A,r)}))})),d()(this,"handleSelectionChangeInEditing",(function(A){var e=i.services,t=e.textEditorStateService,n=e.accessibilityManager;if(t&&(t.isEditorTextExpanded=!!i.editorView.isExpanded()),A&&n){var o=i.getParagraphTextAndOffset(A);if(o){var r=o.offset,a=o.focusParagraphText;null==n||n.promise().then((function(A){null==A||A.readKeyArrowContent(r,a)}))}}})),d()(this,"handleUndo",(function(){var A;null===(A=i.services.undoRedoService)||void 0===A||A.undo()})),d()(this,"handleRedo",(function(){var A;null===(A=i.services.undoRedoService)||void 0===A||A.redo()})),d()(this,"onMouseUp",(function(){var A,e;null===(A=(e=i.props).onMouseUp)||void 0===A||A.call(e),i.updateTextEditorState(!1)})),d()(this,"onBlur",(function(){i.updateTextEditorState(!1)})),d()(this,"onMouseDown",(function(A){var e,t;null===(e=(t=i.props).onMouseDown)||void 0===e||e.call(t,A),i.updateTextEditorState(!0)})),d()(this,"onMouseMove",(function(){var A=i.services.textEditorStateService;A&&(A.isEditorTextMouseDown=!0)})),d()(this,"isPreview",(function(){var A;return!(null===(A=i.services.textEditorStateService)||void 0===A||!A.isTextPreview)})),d()(this,"onKeyDown",(function(A){var e=A.keyCode,t=i.services.accessibilityManager;if(t){var n=function(A,e){switch(e){case v.d.VERTICAL:case v.d.ROTATE_90:case v.d.WORD_ART_VERTICAL_RTL:var t;return(t={},d()(t,oA,lA),d()(t,rA,aA),d()(t,aA,oA),d()(t,lA,rA),t)[A]||A;case v.d.ROTATE_270:var n;return(n={},d()(n,oA,aA),d()(n,rA,lA),d()(n,aA,rA),d()(n,lA,oA),n)[A]||A;case v.d.WORD_ART_VERTICAL_LTR:var i;return(i={},d()(i,oA,aA),d()(i,rA,lA),d()(i,aA,oA),d()(i,lA,rA),i)[A]||A;case v.d.HORIZONTAL:default:return A}}(e,i.dataModel.textDirection);null==t||t.promise().then((function(A){A.handleKeydown(n)}))}})),this.editorView=e,this.dataModel=t,this.services=n,this.operationHandler=this.createOperations(),this.editorAutoSave=new p({triggerUploadData:function(){i.editor.isComposing||i.triggerSave()},resetHasValueChangeFlag:function(){i.updateHasValueChangeFlag(!1)}})}return c()(A,[{key:"operationRange",get:function(){return this.isEditing?this.editor.selection:this.editor.getRange()}},{key:"isEditing",get:function(){var A;return(null===(A=this.editor)||void 0===A?void 0:A.isEditing)||!1}},{key:"isReadyEditing",get:function(){var A;return(null===(A=this.editor)||void 0===A?void 0:A.isReadyEditing)||!1}},{key:"isTextEnterable",get:function(){var A;return(null===(A=this.editor)||void 0===A?void 0:A.isTextEnterable)||!1}},{key:"changeFlag",get:function(){return this.hasValueChange||!1}},{key:"setFocus",value:function(A,e){var t,n,i;this.isEditing?(null===(t=this.editor)||void 0===t||t.focus(),null==A||A()):(this.saveFocusCallBack=A,e&&"number"==typeof e.worldX&&"number"==typeof e.worldY?null===(n=this.editor)||void 0===n||n.triggerMouseDown({posXOfWorld:e.worldX,posYOfWorld:e.worldY}):null===(i=this.editor)||void 0===i||i.focus())}},{key:"setReadyEditing",value:function(){var A;null===(A=this.editor)||void 0===A||A.setReadyEditing()}},{key:"triggerBlur",value:function(){var A,e;this.isReadyEditing?this.removeReadyEditing():(null===(A=this.editor)||void 0===A||A.blur(),this.isEditing||null===(e=this.onBlur)||void 0===e||e.call(this))}},{key:"removeReadyEditing",value:function(){var A;null===(A=this.editor)||void 0===A||A.removeReadyEditing()}},{key:"operations",value:function(A,e,t){var n,i;this.operationKey=A,this.hasValueChange&&this.triggerUpdate();var o,r=this.operationHandler.operations(A,e,t),a=r.isHandled;r.needUpdate&&(this.isExpanded()&&(this.alreadyChange=!0),null!==(o=this.isPreview)&&void 0!==o&&o.call(this)||this.triggerUpdate());return null===(n=(i=this.props).onStyleChange)||void 0===n||n.call(i,{style:this.editorView.getAllStylesSync()}),a}},{key:"getBackDeleteTextProps",value:function(){if(this.isEditing){var A=this.editor.getStyle();return null!=A&&A.inlineProps?[]:["origin-href"]}return[]}},{key:"addHighlight",value:function(A,e){var t={isHighlightFlag:!0,highlightResult:A,keyword:e};this.dataModel.setRawData({searchInfo:t},!0)}},{key:"addSearchMark",value:function(A,e){var t={isSearchingFlag:!0,searchResult:A,keyword:e};this.dataModel.setRawData({searchInfo:t},!0)}},{key:"removeHighlight",value:function(){this.dataModel.setRawData({searchInfo:{isHighlightFlag:!1,highlightResult:[],keyword:""}},!0)}},{key:"removeSearchMark",value:function(){this.dataModel.setRawData({searchInfo:{isSearchingFlag:!1,searchResult:[],keyword:""}},!0)}},{key:"copy",value:function(){if(!this.isExpanded())return null;var A=this.editor.copy();return A?{paragraphListWithoutInherit:{paragraphList:u.a.convertParagraphElementsToParagraphList(A,this.dataModel.resizable)},paragraphListWithInherit:{paragraphList:u.a.convertParagraphElementsToParagraphList(A,this.dataModel.resizable,!1,!1)}}:null}},{key:"paste",value:function(A){var e=this,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function(){var n,i;e.triggerSave();var o=e.dataModel.doConvertParagraphListToParagraphElements(A.paragraphList);null===(n=(i=e.props).onBeforeValueChange)||void 0===n||n.call(i),e.editor.paste(o,t),e.triggerUpdate(),e.alreadyChange=!0};if(this.isEditing)return n();this.setFocus((function(){n()}))}},{key:"cut",value:function(){if(this.isEditing){var A,e;if(!this.isExpanded())return null;null===(A=(e=this.props).onBeforeValueChange)||void 0===A||A.call(e);var t=this.editor.cut();return this.triggerUpdate(),{paragraphListWithoutInherit:{paragraphList:u.a.convertParagraphElementsToParagraphList(t,this.dataModel.resizable)},paragraphListWithInherit:{paragraphList:u.a.convertParagraphElementsToParagraphList(t,this.dataModel.resizable,!1,!1)}}}return null}},{key:"emptyParagraph",value:function(){var A=this.dataModel.getParagraphList(!0);if(null!=A&&A.length){var e=A.slice(0,1),t=e[0].textRuns;e[0].textRuns=(null==t?void 0:t.length)&&t.slice(0,1)||[{text:"",styles:{}}],e[0].textRuns[0].text="",this.updateRawData(e)}}},{key:"getExpandedRect",value:function(){var A,e;return this.isEditing&&(null===(A=(e=this.editor).getSelectionRect)||void 0===A?void 0:A.call(e))||null}},{key:"getSelection",value:function(){var A,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=null===(A=this.editor)||void 0===A?void 0:A.selection;return t&&e?this.editor.rangeUtil.convertToParagraph(t):t}},{key:"getSelectionPara",value:function(){return this.isEditing?E(this.getSelection(),this.dataModel.getParagraphList().map((function(A){return sA(sA({},A),{},{paragraphProps:sA(sA({},A.paragraphProps),A.paragraphCharacter)})}))):[]}},{key:"getTextLinkState",value:function(){var A;return!(null===(A=this.getLinkManager())||void 0===A||!A.getTextLinkState(this.editor))}},{key:"setSelectionAll",value:function(){var A,e;null===(A=this.editor)||void 0===A||null===(e=A.selectAll)||void 0===e||e.call(A)}},{key:"setTextLink",value:function(){var A,e=this;return!!this.isEditing&&(null===(A=this.getLinkManager())||void 0===A||A.getLinkDataAndSetLink({editor:this.editor,updateDataCB:function(){return e.triggerUpdate()}}),!0)}},{key:"insertText",value:function(A,e){this.editor.insertText(A,Object(h.i)(e))}},{key:"triggerRedo",value:function(){var A;this.isReadOnly||(O.a.isMobile?this.triggerBlur():this.hasValueChange&&this.triggerUpdate(),null===(A=this.handleRedo)||void 0===A||A.call(this))}},{key:"triggerUndo",value:function(){var A;this.isReadOnly||(O.a.isMobile?this.triggerBlur():this.hasValueChange&&this.triggerUpdate(),null===(A=this.handleUndo)||void 0===A||A.call(this))}},{key:"handleMouseMove",value:function(A){var e,t;this.isEditing&&(null===(t=this.onMouseMove)||void 0===t||t.call(this));var n=this.editorView.getAppPosition(),i=n.x,o=n.y;null===(e=this.editor)||void 0===e||e.triggerMouseMove({posXOfWorld:A.pageX-i,posYOfWorld:A.pageY-o})}},{key:"handleValueChange",value:function(){var A,e,t;this.alreadyChange||this.updateHasValueChangeFlag(!0),this.alreadyChange=!1;var n=Object(h.c)(this.editor.getValue());this.editorAutoSave.onEditorChange(n),this.handleResizeWhenTextChange();var i=this.editor.getLayoutSize(),o=i.width,r=i.height;null===(A=(e=this.props).onTextChange)||void 0===A||A.call(e,{width:Math.ceil(o),height:Math.ceil(r)}),null===(t=this.getLinkManager())||void 0===t||t.linkFloatBarService.hideAndClearTimeout()}},{key:"handleCompositionInput",value:function(){var A,e;this.updateHasValueChangeFlag(!0);var t=this.editor.getLayoutSize(),n=t.width,i=t.height;null===(A=(e=this.props).onTextChange)||void 0===A||A.call(e,{width:Math.ceil(n),height:Math.ceil(i)})}},{key:"handleMouseDown",value:function(A){this.props.noStopMouseDown||A.stopPropagation();var e,t=A.nativeEvent;2===(null==t?void 0:t.button)&&this.isExpanded()||(null===(e=this.editor)||void 0===e||e.triggerMouseDown({posXOfWorld:A.worldX,posYOfWorld:A.worldY},t));this.onMouseDown(t)}},{key:"handleMouseUp",value:function(){this.onMouseUp(),this.editor.triggerMouseUp()}},{key:"handleClick",value:function(A){var e,t;null===(e=(t=this.props).onClick)||void 0===e||e.call(t,null==A?void 0:A.nativeEvent)}},{key:"handleTouchStart",value:function(A){if(this.isEditing){var e,t,n;null===(e=this.editor)||void 0===e||e.triggerTouchStart({posXOfWorld:A.worldX,posYOfWorld:A.worldY});var i=A.nativeEvent;null===(t=(n=this.props).onTouchStart)||void 0===t||t.call(n,i)}else{var o;null===(o=this.editor)||void 0===o||o.triggerTouchStart({posXOfWorld:A.worldX,posYOfWorld:A.worldY})}}},{key:"handleTouchMove",value:function(A){if(this.isEditing){var e=this.editorView.getAppPosition(),t=e.x,n=e.y,i=document.documentElement,o=i.scrollTop,r=void 0===o?0:o,a=i.scrollLeft,l=void 0===a?0:a;this.editor.triggerTouchMove({posXOfWorld:Object(k.a)(A).pageX-(t+l),posYOfWorld:Object(k.a)(A).pageY-(n+r)})}}},{key:"handleTouchEnd",value:function(A){var e;null===(e=this.editor)||void 0===e||e.triggerTouchEnd(A)}},{key:"updateEditorData",value:function(){var A,e=null===(A=this.editor)||void 0===A?void 0:A.getValue();if(e){var t=this.dataModel.doConvertFromDocElementKeepInheritData(e),n=t.paragraphList,i=t.textBodyStyle||{},o=i.wrapperStyle,r=i.bodyStyle,a=i.autoFitType;this.updateRawData(n,o,r,a,!0)}}},{key:"handleKeyDown",value:function(A){var e=this;if(this.isEditing){var t,n,i;this.onKeyDown(A);var o,r,a=(null===(t=this.dataModel.model)||void 0===t?void 0:t.isTitleOrCtrTitlePl)&&((null===(n=this.dataModel.model)||void 0===n?void 0:n.isFromMaster)||(null===(i=this.dataModel.model)||void 0===i?void 0:i.isFromLayout));if("Enter"===A.key&&a)return this.editor.insertSoftBreak(),!0;if("Enter"===A.key||" "===A.key)null===(o=this.getLinkManager())||void 0===o||o.setLinkWhenEnter(this.editor,(function(){requestAnimationFrame((function(){e.triggerSave()}))}));if(!this.editorEvent)this.editorEvent=new F({editor:this.editor,getSelection:this.getSelection.bind(this),operationHandler:this.operationHandler,shouldPreventTab:null!==(r=this.props.shouldPreventTab)&&void 0!==r&&r,triggerUndo:this.triggerUndo.bind(this),triggerRedo:this.triggerRedo.bind(this)});return this.editorEvent.handleEvent(A)}return!1}},{key:"handleSelectionChange",value:function(A,e){var t,n,i;this.isEditing?(this.handleParagraphCharacter(A,e),null===(t=(n=this.props).onStyleChange)||void 0===t||t.call(n,{style:this.editorView.getAllStylesSync()}),null===(i=this.handleSelectionChangeInEditing)||void 0===i||i.call(this,e)):this.handleParagraphCharacter(A,e)}},{key:"handleBeforeInput",value:function(A,e){if(this.isEditing||this.isReadyEditing){var t,n=null===(t=this.editor.selection)||void 0===t?void 0:t.focus,i=e.text[n.offset-1]||"";if(!Object(U.c)(i,A)||!Object(U.b)(i)&&!Object(U.b)(A)){var o,r,a={};Object(U.d)(A,a);var l=N.a.getOriginProps(e,"raw-"),c=l.fonts,s=l.fontFamily,d=(null==c?void 0:c[null!==(o=a.lang)&&void 0!==o?o:""])||s;return{fontFamily:null===(r=N.a.transformTextStyle("fontFamily",d))||void 0===r?void 0:r.fontFamily,"origin-fontFamily":d,"origin-lang":a.lang,"origin-raw-lang":!0}}}}},{key:"onFocus",value:function(){this.dataModel.noSaveRawData&&this.dataModel.setRawData({noSaveRawData:!1},!0)}},{key:"enterEditing",value:function(){var A,e,t,n;this.saveFocusCallBack&&(this.saveFocusCallBack(),this.clearFocusCallBack()),z.register(),this.editorAutoSave.enterInputIdle(Object(h.d)(this.dataModel.getParagraphList())),this.dataModel.noSaveRawData&&this.dataModel.setRawData({noSaveRawData:!1},!0),this.updateHasValueChangeFlag(!1),null===(A=(e=this.props).onStyleChange)||void 0===A||A.call(e,{style:this.editorView.getAllStylesSync()}),null===(t=(n=this.props).onEnterEditing)||void 0===t||t.call(n)}},{key:"exitEditing",value:function(){var A,e,t,n;if(this.clearFocusCallBack(),this.hasValueChange){var i=this.props.model;if(null!=i&&i.selectionService){var o,r,a={currentSlideType:i.selectionService.currentSlideType,slideIdArr:[i.selectionService.currentSlide.id]};if(i.rootGroupModel)a.groupElementIdArr=[{rootId:(null===(o=i.rootGroupModel)||void 0===o?void 0:o.id)||"",childId:i.id||""}],a.slideElementIdArr=[null===(r=i.rootGroupModel)||void 0===r?void 0:r.id];else i.inTable?(a.groupElementIdArr=[],a.slideElementIdArr=[i.tableModelRef.id]):(a.groupElementIdArr=[],a.slideElementIdArr=[i.id]);i.selectionService.selectedWithCommit.markSpecialOperate(V.a.textBlur,{beforeSelectedSnapshot:a})}this.triggerUpdate()}this.clear(),z.unRegister(),null===(A=(e=this.props).onStyleChange)||void 0===A||A.call(e,{style:this.editorView.getAllStylesSync()}),null===(t=(n=this.props).onExitEditing)||void 0===t||t.call(n)}},{key:"clearFocusCallBack",value:function(){this.saveFocusCallBack=null}},{key:"setSelectionToEnd",value:function(){this.isEditing&&this.editor.selectEnd()}},{key:"triggerSave",value:function(){this.isEditing&&this.hasValueChange&&this.triggerUpdate()}},{key:"resetValueChangeFlag",value:function(){this.isEditing&&(this.isExpanded()&&(this.alreadyChange=!0),this.updateHasValueChangeFlag(!1))}},{key:"dispose",value:function(){this.clear()}},{key:"clear",value:function(){var A,e,t;this.updateHasValueChangeFlag(!1),this.alreadyChange=!1,this.editorAutoSave.cancel(),this.editorAutoSave.clear(),null===(A=this.getLinkManager())||void 0===A||A.linkEditMenuService.hide(),null===(e=this.getLinkManager())||void 0===e||e.linkFloatBarService.hideAndClearTimeout(),null===(t=this.onBlur)||void 0===t||t.call(this)}},{key:"getParagraphTextAndOffset",value:function(A){var e,t;if(A){var n=A.focus,i=this.editor.getParent(n.path),r=o()(i,2)[1],a=this.editor.getString(r),l=null===(e=this.editor)||void 0===e||null===(t=e.getValue())||void 0===t?void 0:t.children;return{offset:Object(h.a)(n,l).offset,focusParagraphText:a}}}},{key:"isSelectAllText",value:function(){var A,e;return!this.isEditing||(null===(A=(e=this.editor).isSelectAll)||void 0===A?void 0:A.call(e))||!1}},{key:"updateRawData",value:function(A,e,t,n,i){if(this.editorView.onChange){var o,r={};e&&(r.wrapperStyle=e),n&&(r.autoFitType=n),t&&(r.bodyStyle=t);var a=Object(h.h)(this.dataModel.getTextBodyStyle(),r);Object(h.j)(A),a=Object(h.h)(a,r),null!=A&&A[0]&&(A[0].isEditorModelTempData=!0),a&&(a.isEditorModelTempData=!0),this.dataModel.setRawData({paragraphList:A,textBodyStyle:a},!0,!0);var l={paragraphList:Object(m.b)(A),textBodyStyle:r};if(this.needInheritStyleShape()){var c=this.dataModel.doConvertFromTextModel(A),s=this.getConvertFromDocElement(c);Object.assign(l,s)}null!==(o=this.isPreview)&&void 0!==o&&o.call(this)||this.editorView.onChange(l,this.checkIsEditing()||i||!1)}}},{key:"handleParagraphCharacter",value:function(A,e){var t,n=this;if(!this.editorView.isReadOnly()){var i=null===(t=this.editor)||void 0===t?void 0:t.getValue();if(i){var r,a,l=i.children,c=this.isSelectionExpand(e),s=this.isSelectionExpand(A),d=l.map(j.c),u=!1;if(!c&&e){var p=d[r=o()(e.anchor.path,1)[0]],h=((null==p?void 0:p.paragraphProps)||{}).character;Object(I.a)(h)&&Object(g.k)(p)&&(u=!0)}if(!s&&A){var f=d[a=o()(A.anchor.path,1)[0]],v=((null==f?void 0:f.paragraphProps)||{}).character;Object(I.a)(v)&&Object(g.k)(f)&&(u=!0)}"number"==typeof r&&"number"==typeof a&&r===a||requestAnimationFrame((function(){var A;u&&(null===(A=n.editor)||void 0===A||A.forceRender())}))}}}},{key:"isSelectionExpand",value:function(A){if(!A)return!1;var e=A.anchor,t=A.focus;return e.path.toString()!==t.path.toString()||e.offset!==t.offset}},{key:"props",get:function(){return this.editorView.getProps()}},{key:"getConvertFromDocElement",value:function(A){return this.dataModel.doConvertFromDocElementKeepInheritData(A)}},{key:"getSelectionLeafNodeAndRangeRef",value:function(){return this.editor.getSelectionLeafNodeAndRangeRef()}},{key:"getLeafNodeAndRangeRef",value:function(A){return this.editor.getLeafNodeAndRangeRef(A)}},{key:"isExpanded",value:function(){var A,e;return(null===(A=(e=this.editor).isSelectionExpanded)||void 0===A?void 0:A.call(e))||!1}},{key:"getStyle",value:function(){return this.editor.getStyle()}},{key:"getEditorValue",value:function(){return this.editor.getValue()}},{key:"getSelectionNodes",value:function(A){var e;return null===(e=this.editor)||void 0===e?void 0:e.getSelectionNodes(A)}},{key:"editor",get:function(){return this.editorView.getAlloyEditor()}},{key:"triggerUpdate",value:function(){this.editorAutoSave.cancel();var A=this.editor.getValue();this.updateData(A),this.updateHasValueChangeFlag(!1)}},{key:"updateData",value:function(A){var e,t,n=this.getConvertFromDocElement(A),i=n.paragraphList,o=n.textBodyStyle,r=this.getAutoFitType(i,this.dataModel.autoFitType),a=r===this.dataModel.autoFitType?o:sA(sA({},o),{},{autoFitType:r}),l=i;Object(h.j)(l),null===(e=(t=this.editorView).onChange)||void 0===e||e.call(t,{paragraphList:l,textBodyStyle:a},!0)}},{key:"needInheritStyleShape",value:function(){var A=this.dataModel.model||{},e=A.isTitleOrCtrTitlePl,t=A.isBodyPl;return A.isFromMaster&&(e||t)}},{key:"checkIsEditing",value:function(){var A;return null===(A=this.editor)||void 0===A?void 0:A.isEditing}},{key:"getLinkManager",value:function(){return this.services.linkManager}},{key:"isReadOnly",get:function(){return this.editorView.isReadOnly()}},{key:"handleResizeWhenTextChange",value:function(){if(this.dataModel.resizable){var A=this.editor.getValue(),e=this.getConvertFromDocElement(A).paragraphList,t=this.props,n={textRect:t.textRect,modelKey:t.modelKey,isTitle:t.isTitle,textBodyStyle:this.dataModel.getTextBodyStyle()},i=f.a.measureResizeLevel(A,n);this.dataModel.resizeLevel!==i&&this.dataModel.setRawData({paragraphList:e,resizeLevel:i},!0,!0)}}},{key:"supplyEffect",value:function(A,e){if(e.effect){var t,n,i=(null==A||null===(t=A.children)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.effect)||{};e.effect=sA(sA({},i),e.effect)}if(e["origin-effect"]){var o,r,a=(null==A||null===(o=A.children)||void 0===o||null===(r=o[0])||void 0===r?void 0:r.effect)||{};e["origin-effect"]=sA(sA({},a),e["origin-effect"])}}},{key:"createOperations",value:function(){return new iA(this.dataModel,this)}},{key:"updateTextEditorState",value:function(A){var e=this.services.textEditorStateService;e&&(e.isEditorTextMouseDown=A,e.isEditorTextExpanded=!!this.editorView.isExpanded())}}]),A}()},"87f81c55b9":function(A,e,t){"use strict";t.d(e,"a",(function(){return E}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("547611bd96"),l=t.n(a),c=t("bd29e2df90"),s=t.n(c),d=t("ab5eb40518"),u=t.n(d),p=t("1b4cdd6a36"),h=t.n(p),f=t("85d0a7609b"),v=t.n(f),g=(t("3bf1976a4f"),t("c3df4c6e22")),y=t("38ba58fbda"),m=t("d9812f1c6f"),b=t("86ade74201"),C=t("a497c16281");function S(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var E=function(A){s()(t,A);var e=S(t);function t(A,n){var o;i()(this,t),o=e.call(this,A,n),v()(l()(o),"isTouchStart",!1),v()(l()(o),"isMouseDown",void 0),v()(l()(o),"isAutoEventOn",!1),v()(l()(o),"controller",void 0),v()(l()(o),"mouseDownOff",void 0),v()(l()(o),"clickOff",void 0),v()(l()(o),"touchStartOff",void 0),v()(l()(o),"initEditorController",(function(){o.controller=new b.a({getAlloyEditor:function(){return o.component.editor},getProps:function(){return o.component.props},getTextRect:function(){return o.component.editor.textRect},isReadOnly:o.component.isReadOnly,getAppPosition:o.component.getAppPosition,updateChangeFlag:function(A){var e,t;null===(e=(t=o.component).onChangeFlagChange)||void 0===e||e.call(t,A)},onChange:function(){for(var A,e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];null===(A=(e=o.component.props).onChange)||void 0===A||A.call.apply(A,[e].concat(n)),o.controller.resetValueChangeFlag()},getEditorHeightByParagraphList:o.component.getEditorHeightByParagraphList,getAllStylesSync:o.component.getAllStylesSync,isExpanded:o.component.isExpanded},o.component.editorModel,o.component.services)})),v()(l()(o),"getEditorController",(function(){return o.controller})),v()(l()(o),"autoRegisterEvent",(function(){o.isAutoEventOn||(m.a.isPad?(document.addEventListener("mousemove",o.handleTouchMove,!0),document.addEventListener("mouseup",o.handleTouchEnd,!0)):(document.addEventListener("mousemove",o.handleMouseMove,!0),document.addEventListener("mouseup",o.handleMouseUp,!0)),document.addEventListener("touchmove",o.handleTouchMove,!0),document.addEventListener("touchend",o.handleTouchEnd,!0),document.addEventListener("touchcancel",o.handleTouchEnd,!0),document.addEventListener("contextmenu",o.handleContextMenu,!0),o.isAutoEventOn=!0)})),v()(l()(o),"autoUnRegisterEvent",(function(){o.isAutoEventOn&&(m.a.isPad?(document.removeEventListener("mousemove",o.handleTouchMove,!0),document.removeEventListener("mouseup",o.handleTouchEnd,!0)):(document.removeEventListener("mousemove",o.handleMouseMove,!0),document.removeEventListener("mouseup",o.handleMouseUp,!0)),document.removeEventListener("touchmove",o.handleTouchMove,!0),document.removeEventListener("touchend",o.handleTouchEnd,!0),document.removeEventListener("touchcancel",o.handleTouchEnd,!0),document.removeEventListener("contextmenu",o.handleContextMenu,!0),o.isAutoEventOn=!1)})),v()(l()(o),"handleClick",(function(A){o.controller.handleClick(A)})),v()(l()(o),"handleTouchStart",(function(A){!o.component.props.supportScrollMobile&&o.isEditing&&A.preventDefault(),o.component.props.supportScrollMobile&&o.isCloseCaret(A)&&A.preventDefault(),o.component.editor||o.component.editorContainer.initEditor(),o.autoRegisterEvent(),(o.component.props.supportScrollMobile||o.isEditing)&&(o.isTouchStart=!0,o.controller.handleTouchStart(A))})),v()(l()(o),"handleTouchMove",(function(A){o.isTouchStart&&o.controller.handleTouchMove(A)})),v()(l()(o),"handleTouchEnd",(function(A){if(A.preventDefault(),o.isTouchStart&&(o.isEditing||o.component.props.supportScrollMobile)&&o.component.props.editable){var e=o.component.getAppPosition(),t=e.x,n=e.y,i=document.documentElement,r=i.scrollTop,a=void 0===r?0:r,l=i.scrollLeft,c=void 0===l?0:l;o.controller.handleTouchEnd({posXOfWorld:Object(y.a)(A).pageX-(t+c),posYOfWorld:Object(y.a)(A).pageY-(n+a)})}o.isTouchStart=!1,o.autoUnRegisterEvent()})),v()(l()(o),"handleMouseMove",(function(A){o.isMouseDown&&o.controller.handleMouseMove(A)})),v()(l()(o),"handleMouseUp",(function(){o.isMouseDown=!1,o.controller.handleMouseUp(),o.autoUnRegisterEvent()})),v()(l()(o),"handleMouseDown",(function(A){o.isMouseDown=!0,A.preventDefault(),o.component.editor||o.component.editorContainer.initEditor(),o.autoRegisterEvent(),o.controller.handleMouseDown(A)})),v()(l()(o),"handleContextMenu",(function(A){A.preventDefault(),o.isEditing&&o.component.setFocus()})),v()(l()(o),"isCloseCaret",(function(A){var e=o.component.getExpandedRect();return!!e&&(!(A.worldX>e.right+8||A.worldX<e.left-8)&&!(A.worldY>e.bottom+8||A.worldY<e.top-8))})),v()(l()(o),"handleEditorFocus",(function(){var A;o.controller.onFocus(),o.controller.enterEditing(),null===(A=o.component.services.editingStateManager)||void 0===A||A.updateElementCropState(!1)})),v()(l()(o),"handleEditorBlur",(function(){o.controller.exitEditing()})),v()(l()(o),"handleKeyDown",(function(A){var e;return!(null===(e=o.controller)||void 0===e||!e.handleKeyDown(A))})),v()(l()(o),"handleBeforeInput",(function(A,e){return o.controller.handleBeforeInput(A,e)})),v()(l()(o),"registerEvent",(function(){m.a.isMobile||(o.clickOff=o.component.editorContainer.onClick(o.handleClick||function(){})),o.component.isReadOnly()&&!o.component.isSelectable()||(m.a.isMobile?(o.touchStartOff=o.component.editorContainer.onTouchStart(o.handleTouchStart||function(){}),m.a.isPad&&(o.mouseDownOff=o.component.editorContainer.onMouseDown(o.handleIpadMousedown))):o.mouseDownOff=o.component.editorContainer.onMouseDown(o.handleMouseDown||function(){}))})),v()(l()(o),"handleIpadMousedown",(function(A){C.a.isTriggerByTouch(A)||o.handleTouchStart(A)})),v()(l()(o),"unregisterEvent",(function(){var A,e,t;null===(A=o.mouseDownOff)||void 0===A||A.dispose(),null===(e=o.clickOff)||void 0===e||e.dispose(),null===(t=o.touchStartOff)||void 0===t||t.dispose()}));var r={handleTouchMove:o.handleTouchMove,handleTouchEnd:o.handleTouchEnd,handleMouseMove:o.handleMouseMove,handleMouseUp:o.handleMouseUp,handleContextMenu:o.handleContextMenu,handleMouseDown:o.handleMouseDown,handleTouchStart:o.handleTouchStart,handleClick:o.handleClick,initEditorController:o.initEditorController,getEditorController:o.getEditorController,handleEditorFocus:o.handleEditorFocus,handleEditorBlur:o.handleEditorBlur,handleKeyDown:o.handleKeyDown,handleBeforeInput:o.handleBeforeInput,registerEvent:o.registerEvent,unregisterEvent:o.unregisterEvent};return o.component.setEventHandlers(r),o.initEditorController(),o.registerEvent(),o}return r()(t,[{key:"isEditing",get:function(){return this.controller.isEditing}}]),t}(g.a)},"898069ed54":function(A,e,t){"use strict";t.d(e,"a",(function(){return a}));t("b8217400dc"),t("e6f68cdf2e");var n=t("0a8ecd6412"),i=t("e0e8dd9366"),o=t("0a4e8b541b"),r=function(A){var e=(null==A?void 0:A.factoryOptions)||{},t=e.model;if(e.region===n.s.CANVAS&&(null==t||!t.type||[i.d.GROUP,i.d.TABLE].includes(null==t?void 0:t.type))&&!(o.a.includeBaseElementCount(t)<100))return A.wrapperInstance},a=function(A){var e=r(A);setTimeout((function(){var A;null!=e&&null!==(A=e.cache)&&void 0!==A&&A.isEmpty&&e.makeCache(!1,!0)}),0)}},"8cec191691":function(A,e,t){"use strict";t.d(e,"a",(function(){return S}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("547611bd96"),l=t.n(a),c=t("8eec1e4a03"),s=t.n(c),d=t("bd29e2df90"),u=t.n(d),p=t("ab5eb40518"),h=t.n(p),f=t("1b4cdd6a36"),v=t.n(f),g=t("85d0a7609b"),y=t.n(g),m=(t("3bf1976a4f"),t("516fa97df2")),b=t("2d47c066fb");function C(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=v()(A);if(e){var i=v()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return h()(this,t)}}var S=function(A){u()(t,A);var e=C(t);function t(A,n,o){var r,a;return i()(this,t),a=e.call(this),y()(l()(a),"factoryOptions",void 0),y()(l()(a),"factoryUpdateComponent",void 0),y()(l()(a),"factoryDispose",void 0),a.factoryOptions=A,a.factoryDispose=n,a.factoryUpdateComponent=o,a.id="".concat(b.a,"#").concat(null==A||null===(r=A.model)||void 0===r?void 0:r.key),a}return r()(t,[{key:"wrapperInstance",get:function(){return this.children[0]}},{key:"dispose",value:function(){var A;s()(v()(t.prototype),"dispose",this).call(this),null===(A=this.factoryDispose)||void 0===A||A.call(this)}}]),t}(m.k)},"90b8297389":function(A,e,t){"use strict";t.d(e,"a",(function(){return JA}));var n=t("176815363d"),i=t.n(n),o=t("9132715560"),r=t.n(o),a=t("6a364eb35c"),l=t.n(a),c=t("85d0a7609b"),s=t.n(c),d=t("3ef2352f0b"),u=t.n(d),p=(t("c6244f7705"),t("081c8cafea"),t("af802ec74b"),t("516fa97df2")),h=t("e0e8dd9366"),f=(t("73b854064b"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36"),t("14502724a6")),v=t.n(f),g=t("547611bd96"),y=t.n(g),m=t("8eec1e4a03"),b=t.n(m),C=t("bd29e2df90"),S=t.n(C),E=t("ab5eb40518"),O=t.n(E),k=t("1b4cdd6a36"),M=t.n(k),L=(t("b8217400dc"),t("e6f68cdf2e"),t("a2a09da1e3"),t("3bf1976a4f"),t("0acdc5834b"),t("3dc760a4d9"),t("0a8ecd6412")),T=t("7693c2de60"),w=t("c53a32287a"),R=(t("405b4a5e2b"),t("e554c15969"));function P(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=M()(A);if(e){var i=M()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return O()(this,t)}}var B=function(A){S()(t,A);var e=P(t);function t(A,n){var i;return r()(this,t),i=e.call(this),s()(y()(i),"factoryOptions",void 0),s()(y()(i),"rectEventArea",void 0),s()(y()(i),"clickOff",void 0),i.factoryOptions=A,n&&(i.clickOff=i.onClick(n)),i}return l()(t,[{key:"renderComponent",value:function(){var A=Object(R.b)({element:this.factoryOptions.model,tableResizing:!1,useAdvHas:!1}),e=A.width,t=A.height,n="M 0 0 L ".concat(e," 0 L ").concat(e," ").concat(t," L 0 ").concat(t," Z");this.rectEventArea?this.rectEventArea.path=n:(this.rectEventArea=new p.N(n),this.rectEventArea.fill=new p.i(p.h.Transparent),this.addChild(this.rectEventArea))}},{key:"dispose",value:function(){var A;b()(M()(t.prototype),"dispose",this).call(this),null===(A=this.clickOff)||void 0===A||A.dispose()}}]),t}(p.j),D=t("3d98c5ddec"),x=t("ffc220634f"),F=t("f24deb6c72"),I=t("989d895fca"),U=t("0f8a241c91"),j=t("eabf3daf43"),N=t("7e171d3359"),G=t("65634518db"),H=t("2d47c066fb"),z=t("5693a1ecb5"),_=t("7e82f0072b"),V=t("6a430d18ea"),W=t("8c4a025d08"),K=t("c9c92622ff"),Y=t("02ae07c580"),X=t("adb93d2c14"),Q=t.n(X),q=t("195c08f6f9"),Z=t("70e2a28e9c"),J=t("8712968007"),$=t("d9812f1c6f");function AA(){return!$.a.isMobile&&Object(J.a)()}var eA=t("51b2ea9953"),tA=t("63945b6fba"),nA=t.n(tA),iA=t("10a677037a"),oA=t("83f23a2c67"),rA=t("b55230b666"),aA=t("75d6c5598b"),lA=t("75f19a1449"),cA=t("0f25ec4562"),sA=t("81758a57a2"),dA=t("7b0ebf3e1a"),uA=t("ab17200d42"),pA=t("3344f1a2e7"),hA=t("4c80af32f0");function fA(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function vA(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?fA(Object(t),!0).forEach((function(e){s()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):fA(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function gA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=M()(A);if(e){var i=M()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return O()(this,t)}}var yA=function(A){S()(t,A);var e=gA(t);function t(A){var n;r()(this,t),n=e.call(this),s()(y()(n),"showTempTextEditor",!1),s()(y()(n),"factoryOptions",void 0),s()(y()(n),"baseComponent",void 0),s()(y()(n),"baseComponentEvent3D",void 0),s()(y()(n),"foregroundComponent",void 0),s()(y()(n),"iframeIconComponent",void 0),s()(y()(n),"shapeLinkFlagComponent",void 0),s()(y()(n),"placeHolderComponent",void 0),s()(y()(n),"textEditor",void 0),s()(y()(n),"textEventRectComponent",void 0),s()(y()(n),"textContainer",void 0),s()(y()(n),"editor3D",void 0),s()(y()(n),"placeHolderGraphics",void 0),s()(y()(n),"shouldRender3D",!0),s()(y()(n),"rendererComponent3D",void 0),s()(y()(n),"updateComponent",(function(){n.isShouldRender()&&(n.renderAllGraphic(),n.componentDidUpdate())})),s()(y()(n),"renderEditor",(function(){n.renderPlaceHolder(),n.renderTextContainer(),n.renderTextEditor()})),s()(y()(n),"renderAllGraphic",(function(){n.checkShouldRender3D()?n.render3D():(n.renderBase(),n.renderTextEventRect(),n.renderEditor(),n.renderShapeLinkFlag(),Object(K.o)(n.factoryOptions.model)?(n.renderForeground(),n.renderPlayerIcon()):(n.foregroundComponent&&(n.removeChild(n.foregroundComponent),n.foregroundComponent.dispose(),n.foregroundComponent=null),n.iframeIconComponent&&n.iframeIconComponent.updateComponent()))})),s()(y()(n),"render3D",(function(){n.rendererComponent3D||(n.rendererComponent3D=new Z.a(n.factoryOptions,(function(A){var e,t;n.checkShouldRenderFlatText()||(n.renderEditor(),n.textEditor&&(n.textEditor.editorContainer.alpha=0),null===(e=n.placeHolderComponent)||void 0===e||e.render(A),null===(t=n.editor3D)||void 0===t||t.editorContainer.render(A))}))),n.children.includes(n.rendererComponent3D)||n.addChildAt(n.rendererComponent3D,0),n.rendererComponent3D.render3D(),n.children.includes(n.baseComponent)&&n.removeChild(n.baseComponent),n.textEventRectComponent&&n.removeChild(n.textEventRectComponent),n.checkShouldRenderFlatText()&&n.renderEditor()})),s()(y()(n),"renderBase",(function(){n.factoryOptions.model.props.style.bgShape&&(n.baseComponent||(n.baseComponent=new w.a(n.factoryOptions)),n.children.includes(n.baseComponent)||n.addChildAt(n.baseComponent,0),n.rendererComponent3D&&n.children.includes(n.rendererComponent3D)&&n.removeChild(n.rendererComponent3D),n.baseComponent.renderComponent())})),s()(y()(n),"renderTextEventRect",(function(){if(!n.checkShouldRender3D()){var A=n.factoryOptions.model;!A.isTextOrPlaceholder||!n.factoryOptions.isEditable&&A.isPlaceholder||(n.textEventRectComponent||(n.textEventRectComponent=new B(n.factoryOptions,(function(){var A,e,t;null!==(A=n.logic)&&void 0!==A&&null!==(e=A.ifCanSetReadyEditing)&&void 0!==e&&e.call(A)&&(null===(t=n.textEditor)||void 0===t||t.setReadyEditing())})),n.addChildAt(n.textEventRectComponent,0)),n.textEventRectComponent.renderComponent())}})),s()(y()(n),"renderPlaceHolder",(function(){if(!n.isPlaceHolderShow)return n.placeHolderComponent&&(n.placeHolderComponent.dispose(),n.removeChild(n.placeHolderComponent),n.placeHolderComponent=null),void n.renderPlaceholderBorder();var A,e,t=n.factoryOptions,i=t.isPreview,o=t.region,r=t.isLeftScale,a=t.model,l=o===L.s.TEMPLATE;n.placeHolderComponent?(n.placeHolderComponent.registerPlaceHolderClick(null===(A=n.logic)||void 0===A?void 0:A.handlePlaceHolderClick),n.placeHolderComponent.updateComponent(i,r)):(n.placeHolderComponent=new T.a(n.factoryOptions,l,!!r,i),n.placeHolderComponent.registerPlaceHolderClick(null===(e=n.logic)||void 0===e?void 0:e.handlePlaceHolderClick),n.addChild(n.placeHolderComponent));if(!n.factoryOptions.fromScale){var c=n.placeHolderComponent.getEditor();c&&a.editorInstance&&(a.selectionStyles=c.getAllStylesSync()),a.setEditorComponent(c)}n.removePlaceholderBorder()})),s()(y()(n),"renderShapeLinkFlag",(function(){n.shapeLinkFlagComponent||(n.shapeLinkFlagComponent=new D.a(n.factoryOptions,y()(n))),n.shapeLinkFlagComponent.renderComponent()})),s()(y()(n),"renderTextEditor",(function(){var A,e,t;if(n.shouldShowEditor()){var i=n.factoryOptions,o=i.model,r=i.fromScale;o.isPlaceholder&&Object(z.d)(o),null===(A=n.logic)||void 0===A||null===(e=A.updateResizevalue)||void 0===e||e.call(A);var a=n.getEditorReadOnlyProps(),l=null!==(t=n.logic)&&void 0!==t&&t.getEditorProps?vA(vA({},a),n.logic.getEditorProps()):a;n.textEditor?(n.textEditor.updateEditorProps(l),n.checkShouldRender3D()&&!n.checkShouldRenderFlatText()||(n.textEditor.editorContainer.alpha=1)):(n.textEditor=new cA.a(l,vA({},n.factoryOptions)),n.textContainer?n.textContainer.addChild(n.textEditor.editorContainer):n.addChild(n.textEditor.editorContainer)),n.renderEditor3D(l),r||n.isPlaceHolderShow||o.setEditorComponent(n.textEditor),Object(I.a)(n.textEditor.editorContainer,n.factoryOptions,!0)}else n.textEditor&&(n.textEditor.editorContainer.dispose(),n.removeChild(n.textEditor.editorContainer),n.textEditor=null)})),s()(y()(n),"renderForeground",(function(){n.foregroundComponent||(n.foregroundComponent=new N.a(n.factoryOptions),n.addChild(n.foregroundComponent)),n.foregroundComponent.renderComponent()})),s()(y()(n),"renderPlayerIcon",(function(){n.iframeIconComponent||(n.iframeIconComponent=new q.b(n.factoryOptions,y()(n))),n.iframeIconComponent.updateComponent()})),s()(y()(n),"getEditorReadOnlyProps",(function(){var A,e,t,i,o=n.factoryOptions,r=o.model,a=o.isEditable,l=o.fromScale,c=o.region,s=o.modelParams,d=o.anim,u=!!l||(null==s||null===(A=s.updateState)||void 0===A?void 0:A.editorShouldUpdate),p=r.slideRef||n.factoryOptions.slideModel;return{paragraphList:n.getParagraphList(),textBodyStyle:r.textBodyStyle,model:r,modelKey:r.key,shouldUpdate:!(null==d||!d.needUpdateFont)||u,textRect:n.getTextRect(),slideNum:n.factoryOptions.isMasterEdit?-1:Object(W.a)(p)+1,datetime:n.factoryOptions.infrastructureService.initDatetime,isTitle:Object(G.b)(r),editable:a,selectable:!l&&(r.slideRef&&!n.factoryOptions.isMasterEdit||n.factoryOptions.isMasterEdit),selected:r.selected,linkCursor:c===L.s.PLAYER?"pointer":"",linkColor:n.getLinkThemeColor(),needRenderTextExtra:!0,getRenderTextExtraOption:n.getRenderTextExtraOption,getApplication:null===(e=n.factoryOptions.getApplication)||void 0===e?void 0:e.bind(y()(n)),cursor:n.getInitialCursor(),resize:null===(t=n.logic)||void 0===t?void 0:t.setResize,setResize:null===(i=n.logic)||void 0===i?void 0:i.setResizeValue,disableIndentation:r.isTitleOrCtrTitlePl}})),s()(y()(n),"getParagraphList",(function(){var A=n.factoryOptions,e=A.model,t=A.anim;if(!e.paragraphList||null==t||!t.needUpdateFont)return e.paragraphList;if(!(null!=t&&t.fontColor||null!=t&&t.fontSize))return e.paragraphList;var i=n.getTextRunStyles(t);return Object(aA.c)(e.paragraphList,i)})),s()(y()(n),"getLinkThemeColor",(function(){var A,e=n.factoryOptions.model.slideRef||n.factoryOptions.slideModel;return null===(A=n.factoryOptions.linkManager)||void 0===A?void 0:A.linkUtils.getLinkColor(e)})),s()(y()(n),"getRenderTextExtraOption",(function(A){var e,t,i,o,r,a,l,c,s=null===(e=n.factoryOptions.model.editorInstance)||void 0===e||null===(t=e.editorModel)||void 0===t?void 0:t.textDirection,d=null===(i=n.factoryOptions.model.textBodyStyle)||void 0===i||null===(o=i.wrapperStyle)||void 0===o?void 0:o.textDirection;return{forbidWebgl:uA.e,effectScale:1/pA.a,shouldShowTextFill:Object(hA.b)(A.textElement),textDirection:null!==(r=null!=s?s:d)&&void 0!==r?r:eA.d.HORIZONTAL,filterDisplayOptions:null===(a=(l=n.factoryOptions).getFilterDisplayOptions)||void 0===a?void 0:a.call(l),forbidFilter:Object(V.a)(null===(c=n.factoryOptions.exportImageManager)||void 0===c?void 0:c.isImageCopying,null==A?void 0:A.logicWidth,null==A?void 0:A.logicHeight)}})),s()(y()(n),"getTextRect",(function(){var A=n.factoryOptions,e=A.model,t=A.frame,i=e.props.textFrame;if(i)return{left:0,top:0,width:i.width,height:i.height};var o=Object(x.j)(t,e.props);return Object(F.b)(e,e.pathParser,o)})),s()(y()(n),"renderPlaceholderBorder",(function(){var A=n.factoryOptions.model,e=A.isFromSlide,t=A.isPlaceholder;!e&&t&&(n.placeHolderGraphics?n.placeHolderGraphics.updatePlaceholder():(n.placeHolderGraphics=new U.a(n.factoryOptions),n.addChild(n.placeHolderGraphics)))})),s()(y()(n),"removePlaceholderBorder",(function(){n.placeHolderGraphics&&(n.placeHolderGraphics.dispose(),n.removeChild(n.placeHolderGraphics),n.placeHolderGraphics=null)})),s()(y()(n),"handleAddonInfoListLoaded",(function(){var A,e,t;n.renderPlayerIcon();var i,o=n.factoryOptions.model,r=null!==(A=null===(e=o.props.addon)||void 0===e?void 0:e.iframeId)&&void 0!==A?A:"",a=n.getAddonManager();a&&((null==a||null===(t=a.addonHandler.addonInfoMap.get(r))||void 0===t?void 0:t.isOfficial)||q.a.indexOf(r)>-1||(null===(i=n.factoryOptions.mediaManager)||void 0===i||i.iframePosterCaches.set(o.key,Q.a),n.renderForeground()))})),n.factoryOptions=A;var i=n.factoryOptions.model;if(n.isShouldRender()&&n.renderAllGraphic(),n.id="".concat(H.n,"-").concat(i.key),Object(K.o)(i)){var o=n.getAddonManager();null==o||o.event.on(Y.a.ADDON_INFO_LOAD_READY,n.handleAddonInfoListLoaded)}return n}return l()(t,[{key:"dispose",value:function(){var A,e;b()(M()(t.prototype),"dispose",this).call(this),null===(A=this.logic)||void 0===A||null===(e=A.dispose)||void 0===e||e.call(A),this.factoryOptions.fromScale||this.factoryOptions.model.setEditorComponent(null);var n=this.getAddonManager();null==n||n.event.off(Y.a.ADDON_INFO_LOAD_READY,this.handleAddonInfoListLoaded),this.dispose3D()}},{key:"renderTempEditor",value:function(){this.showTempTextEditor=!0,this.renderEditor()}},{key:"clearTempEditor",value:function(){this.showTempTextEditor=!1,this.renderEditor()}},{key:"updateTextEditorCursor",value:function(A){var e;null===(e=this.textEditor)||void 0===e||e.updateCursor(A)}},{key:"isRenderPlaceholderComponent",get:function(){return!!this.placeHolderComponent}},{key:"isPlaceholderTextEditable",get:function(){var A,e;return(null===(A=this.placeHolderComponent)||void 0===A||null===(e=A.isTextEditable)||void 0===e?void 0:e.call(A))||!1}},{key:"setShouldRender3D",value:function(A){this.shouldRender3D=A}},{key:"is3DShape",value:function(){var A=this.factoryOptions.model;return!nA()(A.shape3d)||!nA()(A.scene3d)}},{key:"componentDidUpdate",value:function(){var A,e,t=this.factoryOptions,n=t.model;t.fromScale||(null===(A=n.getMenuManager())||void 0===A||A.event.emit(rA.a.REFRESH_MENU_ITEM_VALUES),null===(e=n.getMenuManager())||void 0===e||e.event.emit(rA.a.REFRESH_GROUP_ITEM_VALUES))}},{key:"logic",get:function(){return this.factoryOptions.logicService.getLogic(this.factoryOptions)}},{key:"isShouldRender",value:function(){return!Object(x.i)(this.factoryOptions.model)}},{key:"isPlaceHolderShow",get:function(){var A,e,t=this.factoryOptions,n=t.model,i=t.region,o=Object(x.e)(n),r=Object(x.d)(n);return Object(x.m)(o,(null===(A=this.logic)||void 0===A?void 0:A.isEditorFocus)||(null===(e=this.textEditor)||void 0===e?void 0:e.isEditing),n,r,n.isPlaceholder,i)}},{key:"shouldShowEditor",value:function(){var A=this.factoryOptions,e=A.isEditable,t=A.model;return!(!e&&Object(j.i)(t.paragraphList))&&(!this.isPlaceHolderShow||this.showTempTextEditor)&&!Object(K.o)(t)}},{key:"renderTextContainer",value:function(){if(this.shouldShowTextContainer()){this.textContainer||(this.textContainer=new p.k,this.addChild(this.textContainer));var A=this.factoryOptions,e=A.model,t=A.frame,n=e.props.textFrame,i=Object(x.j)(t,e.props);if(n.rotate&&180===Math.abs(n.rotate)&&null!=t&&t.rotate&&180===Math.abs(t.rotate)){var o=Object(dA.m)(n,-n.rotate),r=v()(o,1)[0],a=Object(dA.m)(i,t.rotate),l=v()(a,1)[0];Object(sA.a)(this.textContainer,vA(vA({},n),{},{left:Math.abs(l.x-r.x),top:Math.abs(l.y-r.y)}))}else Object(sA.a)(this.textContainer,vA(vA({},n),{},{left:n.left-i.left,top:n.top-i.top}))}else this.textContainer&&(this.textContainer.dispose(),this.removeChild(this.textContainer),this.textContainer=null)}},{key:"shouldShowTextContainer",value:function(){return!!this.factoryOptions.model.props.textFrame&&this.shouldShowEditor()}},{key:"getTextRunStyles",value:function(A){var e={fontColor:function(){return{tdColor:new lA.a({rgbaStr:A.fontColor})}},fontSize:function(){return{fontSize:A.fontSize}}};return Object.entries(e).reduce((function(e,t){var n=v()(t,2),i=n[0],o=n[1];return A[i]&&o?vA(vA({},e),o()):e}),{})}},{key:"getInitialCursor",value:function(){var A,e=this.factoryOptions,t=e.region,n=e.model;if(t===L.s.PLAYER)return Object(_.a)(this.factoryOptions)?"pointer":"auto";if((null===(A=n.parent)||void 0===A?void 0:A.type)===h.d.SMART_ART)return"auto";var i=(n||{}).uniqueID,o=this.factoryOptions,r=o.formatBrushManager,a=o.animBrushManager;if(Object(oA.b)({formatBrushManager:r,animBrushManager:a})){var l=null==a?void 0:a.animBrushState,c=null==r?void 0:r.formatBrushState;if(i!==(null==l?void 0:l.originElId))return Object(oA.a)((null==c?void 0:c.data)===iA.a)}return"text"}},{key:"getAddonManager",value:function(){return this.factoryOptions.addonManager}},{key:"checkShouldRenderFlatText",value:function(){var A,e;return!(null===(A=this.factoryOptions.model.textBodyStyle)||void 0===A||null===(e=A.bodyStyle)||void 0===e||!e.isFlatText)}},{key:"checkShouldRender3D",value:function(){return AA()&&this.shouldRender3D&&Object(K.a)(this.factoryOptions.model)&&!this.isPlaceHolderShow&&!this.factoryOptions.fromScale}},{key:"renderEditor3D",value:function(A){this.checkShouldRender3D()?this.editor3D?this.editor3D.updateEditorProps(A):this.editor3D=new cA.a(A,vA({},this.factoryOptions)):this.dispose3D()}},{key:"dispose3D",value:function(){this.editor3D&&(this.editor3D.dispose(),this.editor3D=null)}}]),t}(p.k),mA=t("7a5536c9bf"),bA=t.n(mA),CA=t("afedcbed7f"),SA=t("0e1cedb272");function EA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=M()(A);if(e){var i=M()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return O()(this,t)}}var OA=function(A){S()(t,A);var e=EA(t);function t(A){var n;r()(this,t),n=e.call(this),s()(y()(n),"factoryOptions",void 0),s()(y()(n),"shapeLinkFlagComponent",void 0),s()(y()(n),"foregroundComponent",void 0),s()(y()(n),"baseComponent",void 0),s()(y()(n),"playerIconComponent",void 0),s()(y()(n),"rendererComponent3D",void 0),s()(y()(n),"updateComponent",(function(){n.renderAllGraphic()})),s()(y()(n),"renderAllGraphic",(function(){n.renderBase(),n.renderForeground(),n.checkShouldRender3D()&&n.render3D(),n.renderShapeLinkFlag(),n.renderPlayerIcon()})),s()(y()(n),"renderBase",(function(){n.baseComponent||(n.baseComponent=new w.a(n.factoryOptions),n.addChild(n.baseComponent)),n.baseComponent.renderComponent()})),s()(y()(n),"renderForeground",(function(){n.foregroundComponent||(n.foregroundComponent=new N.a(n.factoryOptions),n.addChild(n.foregroundComponent)),n.foregroundComponent.renderComponent(),n.checkShouldRender3D()&&n.foregroundComponent.foregroundGraphics.promiseImageLoaded().then((function(){var A;null===(A=n.rendererComponent3D)||void 0===A||A.render3D()}))})),s()(y()(n),"render3D",(function(){Z.a.isValid3DModel(n.factoryOptions.model)?(n.rendererComponent3D||(n.rendererComponent3D=new Z.a(n.factoryOptions,(function(A){var e,t,i,o;Object(SA.b)(null===(e=n.baseComponent)||void 0===e?void 0:e.children[0]),Object(SA.b)(null===(t=n.foregroundComponent)||void 0===t?void 0:t.children[0]),null===(i=n.baseComponent)||void 0===i||i.render(A),null===(o=n.foregroundComponent)||void 0===o||o.render(A)}))),n.rendererComponent3D.render3D(),n.children.includes(n.rendererComponent3D)||(bA()(n.children).forEach((function(A){A.dispose(),n.removeChild(A)})),n.addChild(n.rendererComponent3D))):n.rendererComponent3D&&n.children.includes(n.rendererComponent3D)&&(n.rendererComponent3D.dispose(),n.removeChild(n.rendererComponent3D),n.rendererComponent3D=void 0,n.addChild(n.baseComponent),n.addChild(n.foregroundComponent))})),s()(y()(n),"renderShapeLinkFlag",(function(){n.shapeLinkFlagComponent||(n.shapeLinkFlagComponent=new D.a(n.factoryOptions,y()(n))),n.shapeLinkFlagComponent.renderComponent()})),s()(y()(n),"renderPlayerIcon",(function(){n.playerIconComponent||(n.playerIconComponent=new CA.a(n.factoryOptions,y()(n))),n.playerIconComponent.updateComponent()})),n.factoryOptions=A;var i=n.factoryOptions.model;return n.id="".concat(H.g,"-").concat(i.key),n.renderAllGraphic(),n}return l()(t,[{key:"dispose",value:function(){var A,e;b()(M()(t.prototype),"dispose",this).call(this),null===(A=this.logic)||void 0===A||null===(e=A.dispose)||void 0===e||e.call(A)}},{key:"logic",get:function(){return this.factoryOptions.logicService.getLogic(this.factoryOptions)}},{key:"checkShouldRender3D",value:function(){return AA()&&!this.factoryOptions.fromScale}}]),t}(p.k);function kA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=M()(A);if(e){var i=M()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return O()(this,t)}}var MA=function(A){S()(t,A);var e=kA(t);function t(A){var n;return r()(this,t),n=e.call(this),s()(y()(n),"factoryOptions",void 0),s()(y()(n),"baseComponent",void 0),s()(y()(n),"updateComponent",(function(){n.renderAllGraphic()})),s()(y()(n),"renderAllGraphic",(function(){n.renderBase(),n.buildRelation()})),s()(y()(n),"renderBase",(function(){n.baseComponent||(n.baseComponent=new w.a(n.factoryOptions),n.addChild(n.baseComponent)),n.baseComponent.renderComponent()})),s()(y()(n),"buildRelation",(function(){var A=n.factoryOptions,e=A.fromScale,t=A.model;!e&&t.getConnectorInfo()&&t.buildRelation()})),s()(y()(n),"destroyRelation",(function(){var A=n.factoryOptions,e=A.fromScale,t=A.model;if(!e){var i=t.startUIModel;i&&!i.selected&&(t.sdkData||(t.props.style.connectorInfo.start=null),i.removeRelatedUIModelRefs(t));var o=t.endUIModel;o&&!o.selected&&(t.sdkData||(t.props.style.connectorInfo.end=null),o.removeRelatedUIModelRefs(t))}})),n.factoryOptions=A,n.id=H.d,n.renderAllGraphic(),n}return l()(t,[{key:"dispose",value:function(){b()(M()(t.prototype),"dispose",this).call(this),this.destroyRelation()}}]),t}(p.k),LA=t("cbfc890db3"),TA=t("bfd39a628d"),wA=t("2815f95d6c"),RA=t("22cacac18c");function PA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=M()(A);if(e){var i=M()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return O()(this,t)}}var BA=function(A){S()(t,A);var e=PA(t);function t(A){var n;r()(this,t),n=e.call(this),s()(y()(n),"tableCells",void 0),s()(y()(n),"factoryOptions",void 0),s()(y()(n),"tableBackground",void 0),s()(y()(n),"TableBackgroundFillComponent",void 0),s()(y()(n),"tableBorder",void 0),s()(y()(n),"tableEditable",!0),s()(y()(n),"updateComponent",(function(A){var e,t,i,o,r,a,l=n.factoryOptions,c=l.model,s=l.region,d=l.isEditable,u=l.modelParams,p=null==u||null===(e=u.updateState)||void 0===e?void 0:e.tableState,h=d!==n.tableEditable;(A||null!=p&&p.shouldUpdate||h)&&(null===(i=n.TableBackgroundFillComponent)||void 0===i||i.updateModel(c),null===(o=n.tableBackground)||void 0===o||o.updateModel(c),null===(r=n.tableCells)||void 0===r||r.updateModel(c),null===(a=n.tableBorder)||void 0===a||a.updateModel(c.tableBorders));n.tableEditable=d||!1,null===(t=c.cleanStateForRegion)||void 0===t||t.call(c,s)})),n.factoryOptions=A;var i=n.factoryOptions.model;return n.id="".concat(H.v,"-").concat(i.key),n.TableBackgroundFillComponent=new TA.a(n.factoryOptions),n.TableBackgroundFillComponent.pointerEvents=p.I.NONE,n.addChild(n.TableBackgroundFillComponent),n.tableBackground=new LA.a,n.tableBackground.pointerEvents=p.I.NONE,n.addChild(n.tableBackground),n.tableCells=new RA.a(n.factoryOptions),n.addChild(n.tableCells),n.tableBorder=new wA.a(n.factoryOptions),n.tableBorder.pointerEvents=p.I.NONE,n.addChild(n.tableBorder),n.updateComponent(!0),n}return l()(t,[{key:"updateTextEditorCursor",value:function(A){var e;null===(e=this.tableCells)||void 0===e||e.updateTextEditorCursor(A)}},{key:"dispose",value:function(){var A,e,n,i;b()(M()(t.prototype),"dispose",this).call(this),null===(A=this.TableBackgroundFillComponent)||void 0===A||A.dispose(),null===(e=this.tableBackground)||void 0===e||e.dispose(),null===(n=this.tableCells)||void 0===n||n.dispose(),null===(i=this.tableBorder)||void 0===i||i.dispose()}}]),t}(p.k),DA=t("4620eb5562"),xA=t("4560412a08");function FA(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function IA(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?FA(Object(t),!0).forEach((function(e){s()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):FA(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function UA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=M()(A);if(e){var i=M()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return O()(this,t)}}var jA=function(A){S()(t,A);var e=UA(t);function t(A){var n;r()(this,t),n=e.call(this),s()(y()(n),"factoryOptions",void 0),s()(y()(n),"needMouseUp",void 0),s()(y()(n),"hasDidMount",!1),s()(y()(n),"rectEventArea",void 0),s()(y()(n),"updateComponent",(function(){var A=n.factoryOptions.editingStateManager;if(!(null!=A&&A.isRotating||null!=A&&A.isResizing)){var e=Object(R.b)({element:n.factoryOptions.model,tableResizing:!1,useAdvHas:!1}),t=e.width,i=e.height,o="M 0 0 L ".concat(t," 0 L ").concat(t," ").concat(i," L 0 ").concat(i," Z");n.rectEventArea?n.rectEventArea.path=o:(n.rectEventArea=new p.N(o),n.rectEventArea.fill=new p.i(p.h.Transparent),n.addChild(n.rectEventArea)),Object(xA.a)({canvasLayer:y()(n),canvasArr:n.children,modelsArr:n.factoryOptions.model.shapeList,componentFactoryOptions:n.childFactoryOption(null),componentNeedUpdate:!0}),n.hasDidMount||(n.componentDidMount(),n.hasDidMount=!0)}})),n.factoryOptions=A,n.factoryOptions.asyncBuild||n.updateComponent();var i=n.factoryOptions.model;return n.id="".concat(H.p,"-").concat(i.key),n}return l()(t,[{key:"childFactoryOption",value:function(A){return IA(IA({},this.factoryOptions),{},{model:A,isGroupChildren:!0})}},{key:"componentDidMount",value:function(){}}]),t}(p.k),NA=t("5655794132"),GA=t("8cec191691"),HA=t("5cdbac46e8");function zA(A){var e=A.model;return e.selectable&&e.currentEditState<=HA.b.SELECTABLE&&!(e.isPlaceholder&&!e.isCustomPlaceholder&&e.currentEditState>HA.b.EDITABLE)}function _A(A){var e,t,n=A.model,i=A.fromScale,o=A.editingStateManager,r=function(A){var e,t=A.model,n=A.fromScale;return(null===(e=t.parent)||void 0===e?void 0:e.type)!==h.d.SMART_ART&&t.selectable&&t.currentEditState===HA.b.EDITABLE&&!t.isTextMath&&!n&&!t.isAttachment()&&(t.slideRef&&!A.isMasterEdit||!!A.isMasterEdit)}(A),a=function(A){var e=A.model,t=A.region,n=Object(x.e)(e),i=Object(x.d)(e);return Object(x.m)(n,!1,e,i,e.isPlaceholder,t)}(A),l=function(A,e,t){var n=A.model,i=A.region,o=A.fromScale,r=Object(x.k)(e,t,i),a=Object(x.e)(n);return Object(x.f)(r,o,n.isPlaceholder,a,i)}(A,a,r),c=n.type===h.d.TABLE&&(null==o?void 0:o.isResizing),s=Object(R.b)({element:n,tableResizing:c,useAdvHas:!1,fromScale:i});return{isEditable:r,isSelectable:zA(A),isCroping:n.selected&&(null==o?void 0:o.isCroping),isPreview:n.selected&&((null===(e=A.editorAnimPreviewManager)||void 0===e?void 0:e.isAnimPreviewing)||(null===(t=A.previewService)||void 0===t?void 0:t.isPreview)),isLeftScale:l,isOutSideBorder:n.type===h.d.IMAGE,frame:s}}var VA=t("d1f05b304b"),WA=t("d5c3deb8c7"),KA=t("a43df1c570"),YA=t("898069ed54"),XA=t("a7888a8b87"),QA=t.n(XA),qA=t("d3d31c86eb"),ZA=t("9da6335152"),JA=function(){function A(e){var t=this;r()(this,A),s()(this,"factoryOptions",void 0),s()(this,"animWrapper",void 0),s()(this,"wrapper",void 0),s()(this,"inner",void 0),s()(this,"observer",void 0),s()(this,"editStateReaction",void 0),s()(this,"selected",void 0),s()(this,"slideIndexReaction",void 0),s()(this,"updateComponent",(function(){try{t.appendOptionsStates(),t.renderGraphic()}catch(A){0,t.wrapper=t.wrapper||new p.k,t.inner=t.inner||new p.k,window.log.error("[canvas-component-factory]:".concat(A)),Object(qA.c)({opername:ZA.e.PPT_QUALITY,module:ZA.d.CANVAS_RENDERER,action:ZA.b.COMPONENT_FACTORY_RENDER,ver6:JSON.stringify({errorMsg:A.message,style:t.factoryOptions.model.props.style})})}})),s()(this,"getWrapper",(function(){return t.animWrapper||t.wrapper})),s()(this,"addAllListener",(function(){t.addModelObserver(),t.factoryOptions.logicService.setLogic(t.factoryOptions,t)})),s()(this,"removeAllListener",(function(){t.removeModelObserver(),t.factoryOptions.logicService.removeLogic(t.factoryOptions)})),s()(this,"removeModelObserver",(function(){var A,e;t.observer&&(t.observer.removeChangesetObserver(t.changeSetCallback),t.factoryOptions.fromScale||t.observer.removeLocalChangeObserver(t.localChangeCallback)),null===(A=t.editStateReaction)||void 0===A||A.call(t),null===(e=t.slideIndexReaction)||void 0===e||e.call(t)})),s()(this,"addModelObserver",(function(){t.observer=VA.a.createObserver(t.factoryOptions.model),t.observer&&(t.observer.addChangesetObserver(t.changeSetCallback),t.factoryOptions.fromScale||t.observer.addLocalChangeObserver(t.localChangeCallback,!0)),t.editStateReaction=Object(WA.r)((function(){return{slideEditState:t.factoryOptions.model.currentEditState}}),t.changeSetCallback),t.slideIndexReaction=Object(WA.r)((function(){var A,e,n;return{slideIndex:null===(A=t.factoryOptions.slideModel)||void 0===A?void 0:A.slideIndex,editType:null===(e=t.getMasterLayoutEditService())||void 0===e?void 0:e.editType,firstSlideNum:null===(n=t.factoryOptions.uiDataService)||void 0===n?void 0:n.presentation.firstSlideNum}}),(function(){var A,e,n=t.factoryOptions.model;Object(K.B)(n)&&null!=n&&null!==(A=n.hasSlideNumber)&&void 0!==A&&A.call(n)&&null!==(e=t.factoryOptions.slideModel)&&void 0!==e&&e.isSlide&&(n.setUpdateState({editorShouldUpdate:!0}),t.changeSetCallback())}))})),s()(this,"changeSetCallback",i()(u.a.mark((function A(){var e,n,i,o,r;return u.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(i=t.factoryOptions.model,t.factoryOptions.modelParams=QA()({updateState:i.getUpdateState()}),t.factoryOptions.isEditable=!!t.factoryOptions.model.currentEditState,!t.factoryOptions.fromScale){A.next=8;break}return A.next=6,new Promise((function(A){return setTimeout(A)}));case 6:return A.next=8,new Promise((function(A){return setTimeout(A)}));case 8:if(t.updateComponent(),null!==(e=t.factoryOptions.slideModel)&&void 0!==e&&null!==(n=e.getBackgroundFill().getFillInfo())&&void 0!==n&&n.shadeToTitle&&Object(K.B)(t.factoryOptions.model)&&t.factoryOptions.model.isTitleOrCtrTitlePl&&(null===(o=(r=t.factoryOptions).refreshBackground)||void 0===o||o.call(r)),!t.selected){A.next=14;break}return A.next=13,new Promise((function(A){return setTimeout(A)}));case 13:Object(YA.a)(t.wrapper);case 14:case"end":return A.stop()}}),A)})))),s()(this,"localChangeCallback",(function(A,e){t.factoryOptions.modelParams=QA()(e),t.updateComponent(),A.selected!==t.selected&&(t.selected=A.selected,t.selected&&Object(YA.a)(t.wrapper))})),s()(this,"appendOptionsStates",(function(){Object.assign(t.factoryOptions,_A(t.factoryOptions))})),s()(this,"renderGraphic",(function(){if(t.inner){var A;t.wrapper.updateComponent();var e,n,i=t.factoryOptions.model.type;if(null===(A=t.factoryOptions.editingStateManager)||void 0===A||!A.isDragging||i===h.d.CONNECTOR)null===(e=(n=t.inner).updateComponent)||void 0===e||e.call(n)}else t.wrapper=t.createWrapper(),t.inner=t.createInner(),t.wrapper.addChild(t.inner),t.createAnimWrapper()})),s()(this,"createWrapper",(function(){return new NA.a(t.factoryOptions,t.removeAllListener,t.updateComponent)})),s()(this,"createInner",(function(){switch(t.factoryOptions.model.type){case h.d.SHAPE:return new yA(t.factoryOptions);case h.d.IMAGE:return new OA(t.factoryOptions);case h.d.CONNECTOR:return new MA(t.factoryOptions);case h.d.TABLE:return new BA(t.factoryOptions);case h.d.GROUP:return new DA.a(t.factoryOptions);case h.d.CHART:return new KA.a(t.factoryOptions);case h.d.SMART_ART:return new jA(t.factoryOptions);default:return null}})),s()(this,"createAnimWrapper",(function(){t.animWrapper||(t.animWrapper=new GA.a(t.factoryOptions,t.removeAllListener,t.updateComponent),t.animWrapper.addChild(t.wrapper))})),this.factoryOptions=e;var n=e.model;this.checkType(n.type)?(this.selected=n.selected,this.updateComponent(),this.addAllListener()):this.wrapper=new p.k}return l()(A,[{key:"checkType",value:function(A){return A===h.d.CONNECTOR||A===h.d.SHAPE||A===h.d.IMAGE||A===h.d.GROUP||A===h.d.TABLE||A===h.d.CHART||A===h.d.SMART_ART}},{key:"getMasterLayoutEditService",value:function(){return this.factoryOptions.masterLayoutEditService}}]),A}()},"9e0ede001e":function(A,e,t){"use strict";t.d(e,"a",(function(){return G}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("8eec1e4a03"),l=t.n(a),c=t("bd29e2df90"),s=t.n(c),d=t("ab5eb40518"),u=t.n(d),p=t("1b4cdd6a36"),h=t.n(p),f=t("3f95c26bbc"),v=t("e0e8dd9366");function g(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var y=function(A){s()(t,A);var e=g(t);function t(){return i()(this,t),e.apply(this,arguments)}return t}(t("4112e843fb").a);function m(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var b=function(A){s()(t,A);var e=m(t);function t(){return i()(this,t),e.apply(this,arguments)}return t}(y),C=t("547611bd96"),S=t.n(C),E=t("85d0a7609b"),O=t.n(E),k=t("d5c3deb8c7"),M=t("a9e0ee82c1"),L=t.n(M),T=t("c9c92622ff");function w(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var R=function(A){s()(t,A);var e=w(t);function t(A,n){var o;return i()(this,t),o=e.call(this,A,n),O()(S()(o),"iframePosterListener",void 0),O()(S()(o),"addiframePosterListener",(function(){var A=o.factoryOptions.model;o.iframePosterListener=Object(k.y)((function(){var e;return!L()(null===(e=o.factoryOptions.mediaManager)||void 0===e?void 0:e.iframePosterCaches.get(A.key))}),(function(){o.component.updateComponent()}))})),Object(T.o)(o.factoryOptions.model)&&o.addiframePosterListener(),o}return t}(y);function P(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var B=function(A){s()(t,A);var e=P(t);function t(A,n){var o;return i()(this,t),o=e.call(this,A,n),O()(S()(o),"videoPosterListener",void 0),O()(S()(o),"attachmentImageListener",void 0),O()(S()(o),"mediaManager",void 0),o.mediaManager=A.mediaManager,o}return t}(y);function D(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var x=function(A){s()(t,A);var e=D(t);function t(){return i()(this,t),e.apply(this,arguments)}return t}(y);function F(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var I=function(A){s()(t,A);var e=F(t);function t(){return i()(this,t),e.apply(this,arguments)}return t}(y);function U(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var j=function(A){s()(t,A);var e=U(t);function t(){return i()(this,t),e.apply(this,arguments)}return t}(y);function N(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u()(this,t)}}var G=function(A){s()(t,A);var e=N(t);function t(){return i()(this,t),e.apply(this,arguments)}return r()(t,[{key:"createLogic",value:function(A,e){switch(A.model.type){case v.d.SHAPE:return new R(A,e);case v.d.IMAGE:return new B(A,e);case v.d.CONNECTOR:return new x(A,e);case v.d.TABLE:return new b(A,e);case v.d.GROUP:return new I(A,e);case v.d.SMART_ART:return new j(A,e);default:return null}}},{key:"getLogic",value:function(A){return this.logicMap.get(A.model.key)}},{key:"removeLogic",value:function(A){var e,n,i=this.getLogic(A);null==i||null===(e=i.videoPosterListener)||void 0===e||e.call(i),null==i||null===(n=i.iframePosterListener)||void 0===n||n.call(i),l()(h()(t.prototype),"removeLogic",this).call(this,A)}}]),t}(f.a)},a43df1c570:function(A,e,t){"use strict";t.d(e,"a",(function(){return F}));t("73b854064b");var n=t("176815363d"),i=t.n(n),o=t("9132715560"),r=t.n(o),a=t("6a364eb35c"),l=t.n(a),c=t("547611bd96"),s=t.n(c),d=t("8eec1e4a03"),u=t.n(d),p=t("bd29e2df90"),h=t.n(p),f=t("ab5eb40518"),v=t.n(f),g=t("1b4cdd6a36"),y=t.n(g),m=t("85d0a7609b"),b=t.n(m),C=t("3ef2352f0b"),S=t.n(C),E=(t("8e7cce0ada"),t("29f8c5f672"),t("c6244f7705"),t("85d48ef22b"),t("2a6f332b5e"),t("081c8cafea"),t("6e20b6a7d8"),t("3bf1976a4f"),t("759492dad9"),t("516fa97df2")),O=t("081f121f28"),k=t("4373c61ac5"),M=t("0a8ecd6412"),L=t("6ff710444e"),T=t("d3d31c86eb"),w=t("9da6335152"),R=t("ab17200d42"),P=t("bd5de260ae"),B=t("d835d04d7a"),D=t("2d47c066fb");function x(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=y()(A);if(e){var i=y()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return v()(this,t)}}var F=function(A){h()(n,A);var e=x(n);function n(A){var o;return r()(this,n),o=e.call(this),b()(s()(o),"factoryOptions",void 0),b()(s()(o),"model",void 0),b()(s()(o),"chart",void 0),b()(s()(o),"chartComponent",void 0),b()(s()(o),"chartTitleComponent",void 0),b()(s()(o),"chartBackgroundComponent",void 0),b()(s()(o),"isChartSupported",void 0),b()(s()(o),"isActualRenderChart",void 0),b()(s()(o),"loadChartPromise",void 0),b()(s()(o),"ChartComponent",void 0),b()(s()(o),"subChartChangeSetObservers",void 0),b()(s()(o),"subChartRelativeId",void 0),b()(s()(o),"hasReported",void 0),b()(s()(o),"subChartChangeSetCallBackMap",new Map),b()(s()(o),"updateComponent",function(){var A=i()(S.a.mark((function A(e){return S.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return o.updateEditorSheetIfUndoRedo(),A.next=3,o.loadChartComponent();case 3:if(!o.isActualRenderChart){A.next=18;break}if(!o.chartComponent){A.next=10;break}return o.updateBackground(),o.updateTitle(),o.updateChart(e),o.chartTitleComponent&&o.addChild(o.chartTitleComponent),A.abrupt("return");case 10:o.chartBackgroundComponent=o.createBackgroundComponent(),o.updateTitle(),o.chartComponent=o.createChartComponent(),o.addChild(o.chartBackgroundComponent),o.addChild(o.chartComponent),o.chartTitleComponent&&o.addChild(o.chartTitleComponent),A.next=23;break;case 18:if(!o.chartComponent){A.next=21;break}return o.updateChart(e),A.abrupt("return");case 21:o.chartComponent=o.createChartComponent(),o.addChild(o.chartComponent);case 23:case"end":return A.stop()}}),A)})));return function(e){return A.apply(this,arguments)}}()),b()(s()(o),"addSubChartChangeSetObserver",(function(){var A,e=null===(A=o.factoryOptions.model.plotArea)||void 0===A?void 0:A.charts;e&&e.length>0&&(o.subChartChangeSetObservers=e.map((function(A){return new L.a(A)})),o.subChartChangeSetObservers.map((function(A,e){var t=function(){return o.subChartChangeSetCallback(A.model)};return o.subChartChangeSetCallBackMap.set(e,t),A.addChangesetObserver(t)})))})),b()(s()(o),"subChartChangeSetCallback",(function(A){var e;o.updateComponent(!0);var t=null===(e=o.logic)||void 0===e?void 0:e.chartManager;A.undoRedo&&null!=t&&t.isShowChartEditModal&&o.updateSheetInstance()})),b()(s()(o),"getBackgroundComponentProps",(function(){var A,e,t,n;return{frame:{height:null===(A=o.factoryOptions.frame)||void 0===A?void 0:A.height,width:null===(e=o.factoryOptions.frame)||void 0===e?void 0:e.width,top:0,left:0},style:null===(t=o.model.chartSpace)||void 0===t||null===(n=t.props)||void 0===n?void 0:n.style,factoryOptions:o.factoryOptions}})),b()(s()(o),"getChartComponentProps",(function(){var A;return{frame:o.factoryOptions.frame,model:o.model,factoryOptions:o.factoryOptions,titleRect:(null===(A=o.chartTitleComponent)||void 0===A?void 0:A.getRealTitleRect())||{left:0,top:0,height:0,width:0},wholeChart:s()(o)}})),b()(s()(o),"getChartTitleComponentProps",(function(){return{frame:o.factoryOptions.frame,model:o.model,factoryOptions:o.factoryOptions}})),b()(s()(o),"createBackgroundComponent",(function(){return new k.a(o.getBackgroundComponentProps())})),b()(s()(o),"createChartComponent",(function(){return new o.ChartComponent(o.getChartComponentProps())})),b()(s()(o),"createTitleComponent",(function(){return new O.a(o.getChartTitleComponentProps())})),b()(s()(o),"updateChart",(function(A){o.chartComponent.updateProps(o.getChartComponentProps(),A)})),b()(s()(o),"updateTitle",(function(){void 0!==o.model.title?o.chartTitleComponent?o.chartTitleComponent.updateProps(o.getChartTitleComponentProps()):o.chartTitleComponent=o.createTitleComponent():o.chartTitleComponent&&(o.removeChild(o.chartTitleComponent),o.chartTitleComponent.dispose(),o.chartTitleComponent=void 0)})),b()(s()(o),"updateBackground",(function(){o.chartBackgroundComponent.updateProps(o.getBackgroundComponentProps())})),b()(s()(o),"loadChartComponent",(function(){return o.loadChartPromise||(o.loadChartPromise=Promise.all([t.e("commonAsync~9b1fde68"),t.e("commonAsync~27f19aac"),t.e("commonAsync~205ac551"),t.e("commonAsync~0c3a6025"),t.e("commonAsync~32e631b8"),t.e("commonAsync~08369118"),t.e("commonAsync~50db4bb8"),t.e("commonAsync~86c92fed"),t.e("commonAsync~a95f944a"),t.e("commonAsync~6e568190"),t.e("commonAsync~b174e5ca"),t.e("commonAsync~54a68610"),t.e("commonAsync~61b3c105"),t.e("commonAsync~f7b3ac00"),t.e("commonAsync~cece21d6"),t.e("commonAsync~ecbf7682"),t.e("commonAsync~6c5dfa7c"),t.e("commonAsync~90483627"),t.e("commonAsync~d2c096c2"),t.e("commonAsync~1285a477"),t.e("commonAsync~31ded9a0"),t.e("commonAsync~ecdbff9b"),t.e("commonAsync~c2cc425c"),t.e("commonAsync~4fb44df2"),t.e("commonAsync~d06fe423"),t.e("commonAsync~0519277e"),t.e("commonAsync~6df2b9ea"),t.e("commonAsync~b5c4f9e4"),t.e("commonAsync~ffdf5190"),t.e("commonAsync~127b6cf7"),t.e("commonAsync~b3c4a2ff"),t.e("commonAsync~19bb5a55"),t.e("async~493df0b3"),t.e("async~c5b24172"),t.e("async~0d51b00e"),t.e("async~beecf843"),t.e("async~2e2c6527"),t.e("async~da8db81f"),t.e("async~e10030d6"),t.e("async~098dcb65"),t.e("async~d0c14fe8"),t.e("async~7f8bedbf"),t.e("async~f40490b4"),t.e("async~2158e36e"),t.e("async~76acd586"),t.e("async~37d786cf"),t.e("async~30ccc425"),t.e("async~0c7d7381"),t.e("async~907e9098"),t.e("async~43172549"),t.e("async~f19eb79b"),t.e("async~95108331"),t.e("async~718865d2"),t.e("async~89b7a519"),t.e("vendors~chart-component")]).then(t.bind(null,"52594d4cd8")),o.loadChartPromise.then((function(A){o.ChartComponent||(o.ChartComponent=A.ChartContainer)}))),o.loadChartPromise})),o.factoryOptions=A,o.model=A.model,o.id="".concat(D.c,"-").concat(o.model.key),o.isChartSupported=o.model.isChartSupported,o.isActualRenderChart=o.model.isActualRenderChart,o.setCursor(),o.updateComponent(),o.reportChartRender(),o}return l()(n,[{key:"dispose",value:function(){u()(y()(n.prototype),"dispose",this).call(this),this.removeChangeSetObserver()}},{key:"updateEditorSheetIfUndoRedo",value:function(){var A,e=null===(A=this.logic)||void 0===A?void 0:A.chartManager;this.model.undoRedo&&null!=e&&e.isShowChartEditModal&&this.updateSheetInstance()}},{key:"updateSubChartChangeSetObserver",value:function(){this.removeChangeSetObserver(),this.addSubChartChangeSetObserver()}},{key:"updateSheetInstance",value:function(){var A,e=null===(A=this.logic)||void 0===A?void 0:A.chartManager;if(e){var t,n=e.convertChartDataFromSDK();null===(t=e.spreadsheetInstance)||void 0===t||t.loadData([{rows:n}])}}},{key:"removeChangeSetObserver",value:function(){var A,e=this;null===(A=this.subChartChangeSetObservers)||void 0===A||A.map((function(A,t){var n=e.subChartChangeSetCallBackMap.get(t);A.removeChangesetObserver(n)})),this.subChartChangeSetCallBackMap.clear()}},{key:"logic",get:function(){return this.factoryOptions.logicService.getLogic(this.factoryOptions)}},{key:"setCursor",value:function(){this.factoryOptions.region===M.s.PLAYER&&(this.cursor="auto")}},{key:"reportChartRender",value:function(){var A;if((this.factoryOptions.region===M.s.CANVAS||this.factoryOptions.region===M.s.PLAYER||this.factoryOptions.region===M.s.MOBILEBROWSE)&&!this.hasReported){var e=null===(A=this.model.plotArea)||void 0===A?void 0:A.charts.map((function(A){return A.type})).join("-"),t=JSON.stringify({type:e,enableRender:R.b,actualRenderChart:this.isActualRenderChart,fallbackImageSrc:this.model.fallbackImageSrc,region:this.factoryOptions.region});Object(T.c)({opername:w.e.DOC_PPT,module:w.d.CHART,action:this.isActualRenderChart?w.b.RENDER_CHART:w.b.RENDER_FALLBACK,ver6:t}),Object(P.a)(B.b.CHART_RENDER_STATUS,this.isActualRenderChart?B.a.SUCCESS:B.a.ERROR,e),this.hasReported=!0}}}]),n}(E.k)},bf70fbf8a7:function(A,e,t){"use strict";t.d(e,"a",(function(){return H}));t("73b854064b"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var n=t("9132715560"),i=t.n(n),o=t("547611bd96"),r=t.n(o),a=t("bd29e2df90"),l=t.n(a),c=t("ab5eb40518"),s=t.n(c),d=t("8eec1e4a03"),u=t.n(d),p=t("1b4cdd6a36"),h=t.n(p),f=t("85d0a7609b"),v=t.n(f),g=(t("22569efd03"),t("b8217400dc"),t("e6f68cdf2e"),t("516fa97df2")),y=t("6a364eb35c"),m=t.n(y),b=t("c3df4c6e22"),C=t("e5cbb41a81"),S=t("3344f1a2e7"),E=t("d1428876ce"),O=t("54a7b7d7a1"),k=t("cbbf0f8a8c"),M=t("d9812f1c6f");function L(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return s()(this,t)}}var T=function(A){l()(t,A);var e=L(t);function t(A,n){var o;return i()(this,t),o=e.call(this,A,n),v()(r()(o),"handleEditorStyleChange",(function(){var A,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,t=void 0===e?{}:e;if(o.component.cellModel&&!o.componentOptions.fromScale&&(o.component.cellModel.selectionStyles=t,null!==(A=o.component.textEditor)&&void 0!==A&&A.isEditing)){var n=o.componentOptions.model;k.a.caculateItemValues(n)}})),v()(r()(o),"handleSelectionChange",(function(){var A,e,t=o.componentOptions.textSelectionUndoRedo;(null==t||t.stashSelectionAfter(o.component.textEditor.getSelection(),o.component.cellModel.tableModelRef.id,{row:o.component.cellModel.row,col:o.component.cellModel.col}),M.a.isMobile)&&(null===(A=o.logic)||void 0===A||null===(e=A.handleSelectionChangeTable)||void 0===e||e.call(A,o.component.textEditor))})),v()(r()(o),"handleEditorMouseDown",(function(A){var e,t,n,i,r,a=o.componentOptions.model,l=(null===(e=o.componentOptions.selectionService)||void 0===e||null===(t=e.selectedElements)||void 0===t?void 0:t.selectedArray)||[];!Object(C.b)(A)||0===l.length||1===l.length&&l[0]===a||(null===(r=o.component.textEditor)||void 0===r||r.triggerBlur());Object(C.a)(A)&&a.showSelection&&a.cellSelectedState(null!==(n=o.component.cellModel.row)&&void 0!==n?n:0,null!==(i=o.component.cellModel.col)&&void 0!==i?i:0,a.selectedRange)?setTimeout((function(){var A;(a.selectedCellRanges.length>1||a.showSelection)&&(null===(A=o.component.textEditor)||void 0===A||A.triggerBlur())}),50):o.logic&&(o.logic.hasEditorRegisterDocumentMouseUp=!0),A.stopPropagation()})),v()(r()(o),"handleChange",(function(A,e){if(e){var t=o.component.cellModel,n=t.row,i=t.col;o.componentOptions.model.uploadSelectedCellData(A,n,i),window.log.info("cellupdate-handleChange\n".concat(JSON.stringify(A)))}})),v()(r()(o),"handleEditorMouseUp",(function(){var A,e;o.logic&&(o.logic.hasEditorRegisterDocumentMouseUp=!1),null===(A=o.componentOptions.formatBrushManager)||void 0===A||A.onElementSelectionMouseUp(),null===(e=o.componentOptions.animBrushManager)||void 0===e||e.onElementSelectionMouseUp()})),v()(r()(o),"beforeEditorValueChange",(function(){var A=o.componentOptions.textSelectionUndoRedo;null==A||A.clearRedo(),null==A||A.stashSelectionBefore(o.component.textEditor.getSelection(),o.component.cellModel.tableModelRef.id,{row:o.component.cellModel.row,col:o.component.cellModel.col})})),v()(r()(o),"handleTextChange",(function(A){var e,t=A.height,n=o.componentOptions.textEditorStateService;n&&(n.editorContentChangeFlag+=1);var i=t/O.g;window.log.info("handleTextChange-".concat(i)),window.dispatchEvent(new Event(E.a));var r=Math.round(Object(S.C)(i));((null!==(e=o.component.cellModel.displayHeight)&&void 0!==e?e:0)>r||o.component.cellModel.props.style.height<r)&&(o.component.cellModel.displayHeight=r,o.dealRowHeightChange())})),o}return m()(t,[{key:"dealRowHeightChange",value:function(){this.componentOptions.model.resizeDisplayRowHeight()}},{key:"handleEnterEditing",value:function(){window.dispatchEvent(new Event("enterEditing"))}},{key:"handleExitEditing",value:function(){window.dispatchEvent(new Event("exitEditing"))}},{key:"logic",get:function(){return this.componentOptions.logicService.getLogic(this.componentOptions)}}]),t}(b.a),w=t("0c9000b818"),R=t("281cbdced7"),P=t.n(R),B=t("33c34da0d5"),D=t("06e1dc2299"),x=t("81758a57a2"),F=t("51b2ea9953"),I=t("145eddafd2"),U=t("0a4e8b541b");function j(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function N(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?j(Object(t),!0).forEach((function(e){v()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function G(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=h()(A);if(e){var i=h()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return s()(this,t)}}var H=function(A){l()(t,A);var e=G(t);function t(A,n){var o,a,l,c;return i()(this,t),c=e.call(this,A,n),v()(r()(c),"cellNewBackground",void 0),v()(r()(c),"cellOldIndex",void 0),v()(r()(c),"delayResizeDisplayRowHeight",P()((function(){return c.componentOptions.model.resizeDisplayRowHeight()}))),v()(r()(c),"tableComponent",void 0),v()(r()(c),"cellOldParent",void 0),v()(r()(c),"bigTableMode",!1),v()(r()(c),"cellNewParent",void 0),v()(r()(c),"handleEnterEditing",(function(){c.bigTableMode&&c.pickCell(),u()((o=r()(c),h()(t.prototype)),"handleEnterEditing",o).call(o)})),v()(r()(c),"handleExitEditing",(function(){c.bigTableMode&&c.revertPickCell(),u()((a=r()(c),h()(t.prototype)),"handleExitEditing",a).call(a)})),v()(r()(c),"dealRowHeightChange",(function(){if(c.bigTableMode&&c.cellNewParent){var A,e;c.component.renderTextEditor(),c.renderCellBackground();var n=null===(A=c.componentOptions)||void 0===A||null===(e=A.getApplication)||void 0===e?void 0:e.call(A).height;n&&c.cellNewParent.worldBounds.maxY>n&&c.delayResizeDisplayRowHeight()}else u()((l=r()(c),h()(t.prototype)),"dealRowHeightChange",l).call(l)})),v()(r()(c),"onUpdateComponent",(function(){c.updateBigTableMode(),c.bigTableMode&&c.cellNewParent&&(c.componentOptions.isEditable?(c.renderCellBackground(),c.tableOtherPartMakeCache()):c.revertPickCell())})),v()(r()(c),"pickCell",(function(){var A,e=Object(w.a)(c.component);if(e){var t=e.parent;c.tableComponent=e,c.cellOldParent=c.component.parent,c.cellOldIndex=null===(A=c.component.parent)||void 0===A?void 0:A.children.findIndex((function(A){return A===c.component})),c.cellNewParent=c.renderCellNewParent(),c.renderCellBackground(),c.cellNewParent.addChild(c.component),null==t||t.addChild(c.cellNewParent),e.clearCache(),c.tableOtherPartMakeCache()}})),v()(r()(c),"revertPickCell",(function(){var A;c.cellNewParent&&(c.cellOldParent.addChildAt(c.component,c.cellOldIndex),null===(A=c.cellNewParent.parent)||void 0===A||A.removeChild(c.cellNewParent),c.cellNewParent.dispose(),c.cellOldParent=null,c.cellNewParent=null,c.cellNewBackground=null,c.cellOldIndex=null)})),v()(r()(c),"renderCellBackground",(function(){var A,e,t;if(c.cellNewParent){var n=c.component.cellModel,i=n.props.style||{},o=N(N({},n.props.style),{},{bgShape:I.b.rect,editable:!1,selected:!1,border:{color:"#94BF43",style:"solid",width:4}}),r=null==n||null===(A=n.textBodyStyle)||void 0===A||null===(e=A.wrapperStyle)||void 0===e?void 0:e.textDirection;o.height=[F.d.VERTICAL,F.d.ROTATE_90,F.d.ROTATE_270,F.d.WORD_ART_VERTICAL_RTL,F.d.WORD_ART_VERTICAL_LTR].includes(r)?i.height:Math.max(null!==(t=n.displayHeight)&&void 0!==t?t:0,i.height);var a={left:i.left,top:i.top,width:i.width,height:o.height},l=Object(D.a)({style:o,frame:a,factoryOptions:c.componentOptions});c.cellNewBackground?c.cellNewBackground.updateModel(l):(c.cellNewBackground=new B.d(l),c.cellNewParent.addChild(c.cellNewBackground))}})),v()(r()(c),"renderCellNewParent",(function(){if(!c.cellNewParent)return c.cellNewParent=new g.k,c.cellOldParent&&(c.cellNewParent.onDoubleClick((function(A){return c.cellOldParent.dispatch(A)})),c.cellNewParent.onMouseDown((function(A){return c.cellOldParent.dispatch(A)})),c.cellNewParent.onMouseMove((function(A){return c.cellOldParent.dispatch(A)}))),c.cellNewParent=Object(x.b)(c.cellNewParent,c.componentOptions),c.cellNewParent})),v()(r()(c),"tableOtherPartMakeCache",(function(){var A;c.tableComponent&&(c.tableComponent.cache.isEmpty&&(null===(A=c.tableComponent)||void 0===A||A.makeCache(!1,!0)))})),v()(r()(c),"updateBigTableMode",(function(){c.bigTableMode=U.a.includeBaseElementCount(c.componentOptions.model)>=400&&M.a.isPc})),c.component.setEventHandlers({handleEditorMouseDown:c.handleEditorMouseDown,handleEditorMouseUp:c.handleEditorMouseUp,handleTextChange:c.handleTextChange,handleEnterEditing:c.handleEnterEditing,handleExitEditing:c.handleExitEditing,handleChange:c.handleChange,beforeEditorValueChange:c.beforeEditorValueChange,handleEditorStyleChange:c.handleEditorStyleChange,handleSelectionChange:c.handleSelectionChange,revertPickCell:c.revertPickCell,renderCellBackground:c.renderCellBackground,tableOtherPartMakeCache:c.tableOtherPartMakeCache,onUpdateComponent:c.onUpdateComponent,updateBigTableMode:c.updateBigTableMode}),c}return t}(T)},c195ed2318:function(A,e,t){"use strict";t.d(e,"a",(function(){return eA}));t("73b854064b"),t("342844cefa"),t("a84962d637"),t("8a35b54c1d"),t("c554310b5c"),t("8ee19818c4"),t("bcb5d93d36");var n=t("176815363d"),i=t.n(n),o=t("1f925d7f50"),r=t.n(o),a=t("9132715560"),l=t.n(a),c=t("6a364eb35c"),s=t.n(c),d=t("547611bd96"),u=t.n(d),p=t("8eec1e4a03"),h=t.n(p),f=t("bd29e2df90"),v=t.n(f),g=t("ab5eb40518"),y=t.n(g),m=t("1b4cdd6a36"),b=t.n(m),C=t("85d0a7609b"),S=t.n(C),E=t("2dc700e1e6"),O=t.n(E),k=(t("f1054791f4"),t("3ef2352f0b")),M=t.n(k),L=(t("22569efd03"),t("c6244f7705"),t("081c8cafea"),t("8e7cce0ada"),t("85d48ef22b"),t("2a6f332b5e"),t("3bf1976a4f"),t("405b4a5e2b"),t("516fa97df2")),T=t("145eddafd2"),w=t("2a875dc68f"),R=t("e0e8dd9366"),P=t("0a8ecd6412"),B=t("e256935f21"),D=(t("29f8c5f672"),t("a2a09da1e3"),t("1958c4fc35")),x=t("3471fb3b60"),F=t("90b8297389"),I=t("7d90099c1e"),U=t("d3d31c86eb"),j=t("9da6335152"),N=t("2d47c066fb");function G(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function H(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?G(Object(t),!0).forEach((function(e){S()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}var z,_,V=function(){function A(e,t,n,i){l()(this,A),S()(this,"taskGroupKey",void 0),S()(this,"firstBuildTaskGroup",void 0),S()(this,"currentToBuildTaskNeedInfo",[]),S()(this,"currentNum",0),S()(this,"groupNodeMap",new Map),S()(this,"groupTaskQueue",[]),S()(this,"smartArtTaskQueue",[]),S()(this,"taskNum",0),S()(this,"slideComponent",void 0),S()(this,"slideModel",void 0),S()(this,"elementsLayer",void 0),S()(this,"selectionService",void 0),this.slideComponent=e,this.elementsLayer=t,this.slideModel=e.options.slideModel,this.taskGroupKey=n;var o=i.selectionService;this.selectionService=o}var e;return s()(A,[{key:"asyncBuildTree",value:(e=i()(M.a.mark((function A(){return M.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return this.firstBuildTaskGroup=new I.a(this.taskGroupKey,this.getTaskPriority()),this.firstBuildTaskGroup.concurrentMax=1,this.splitSlideChildren(),A.abrupt("return",x.b.addTask(this.firstBuildTaskGroup));case 4:case"end":return A.stop()}}),A,this)}))),function(){return e.apply(this,arguments)})},{key:"cancelBuild",value:function(){var A,e;null===(A=this.elementsLayer)||void 0===A||null===(e=A.dispose)||void 0===e||e.call(A),x.b.getTaskWithKey(this.taskGroupKey)&&x.b.cancelTaskByKey(this.taskGroupKey)}},{key:"splitSlideChildren",value:function(){var A=this;this.slideModel.children.forEach((function(e){if(e.type===R.d.TABLE){A.currentNum>0&&(A.addBuildTask(A.currentToBuildTaskNeedInfo,A.slideModel.key,!1),A.resetTaskInfo());var t=new D.a(A.generateSingleTaskKey(),x.a.HIGH,(function(){A.buildElement(e,A.elementsLayer,!1)}));A.firstBuildTaskGroup.addTask(t)}else e.type===R.d.GROUP&&A.groupTaskQueue.push(e),e.type===R.d.SMART_ART&&A.smartArtTaskQueue.push(e),A.currentNum<A.getElementCountPerTask()&&(A.currentNum+=1,A.currentToBuildTaskNeedInfo.push(e)),A.currentNum===A.getElementCountPerTask()&&(A.addBuildTask(A.currentToBuildTaskNeedInfo,A.slideModel.key,!1),A.resetTaskInfo())})),this.currentNum>0&&(this.addBuildTask(this.currentToBuildTaskNeedInfo,this.slideComponent.options.slideModel.key,!1),this.resetTaskInfo()),this.splitGroupQueue()}},{key:"splitGroupQueue",value:function(){for(;this.groupTaskQueue.length>0;){var A=this.groupTaskQueue.shift();A&&this.splitGroupChildren(A),this.resetTaskInfo()}for(;this.smartArtTaskQueue.length>0;){var e=this.smartArtTaskQueue.shift();e&&this.splitSmartArtChildren(e),this.resetTaskInfo()}}},{key:"splitGroupChildren",value:function(A){var e=this;A.children.forEach((function(t){t.type===R.d.GROUP&&e.groupTaskQueue.push(t),e.currentNum<e.getElementCountPerTask()&&(e.currentNum+=1,e.currentToBuildTaskNeedInfo.push(t)),e.currentNum===e.getElementCountPerTask()&&(e.addBuildTask(e.currentToBuildTaskNeedInfo,A.key,!0),e.resetTaskInfo())})),this.currentNum>0&&(this.addBuildTask(this.currentToBuildTaskNeedInfo,A.key,!0),this.resetTaskInfo())}},{key:"splitSmartArtChildren",value:function(A){var e=this;A.shapeList.forEach((function(t){e.currentNum<e.getElementCountPerTask()&&(e.currentNum+=1,e.currentToBuildTaskNeedInfo.push(t)),e.currentNum===e.getElementCountPerTask()&&(e.addBuildTask(e.currentToBuildTaskNeedInfo,A.key,!0),e.resetTaskInfo())})),this.currentNum>0&&(this.addBuildTask(this.currentToBuildTaskNeedInfo,A.key,!0),this.resetTaskInfo())}},{key:"resetTaskInfo",value:function(){this.currentToBuildTaskNeedInfo=[],this.currentNum=0}},{key:"addBuildTask",value:function(A,e,t){var n=this,i=new D.a(this.generateSingleTaskKey(),x.a.HIGH,(function(){for(var i=0;i<A.length;i++){var o=A[i],r=void 0;t?(r=n.groupNodeMap.get(e))&&n.buildElement(o,r.inner,t):(r=n.elementsLayer,n.buildElement(o,r,t))}}));this.firstBuildTaskGroup.addTask(i)}},{key:"generateSingleTaskKey",value:function(){var A="build-".concat(this.slideComponent.options.region,"-").concat(this.slideModel.key,"-").concat(this.taskNum);return this.taskNum+=1,A}},{key:"childFactoryOption",value:function(A){var e,t,n;return{model:A,isMasterEdit:this.slideComponent.options.isMasterEdit,getPageScale:this.slideComponent.options.getPageScale,getApplication:this.slideComponent.options.getApplication,region:this.slideComponent.options.region,fromScale:this.slideComponent.options.fromScale,logicService:this.slideComponent.options.logicService,getFilterDisplayOptions:this.slideComponent.getFilterDisplayOptions,getPlayerReduxStore:this.slideComponent.options.getPlayerReduxStore,handleSlideClick:this.slideComponent.options.handleSlideClick,mobileEditMode:this.slideComponent.options.mobileEditMode,slideModel:this.slideModel,selectionService:this.selectionService,uiDataService:this.slideComponent.getUiDataServiceDelegate(),mediaManager:this.slideComponent.getMediaManagerDelegate(),rightSideBarManager:this.slideComponent.getRightSideBarManager(),addonManager:this.slideComponent.getAddonManager(),attachmentManager:this.slideComponent.getAttachmentManager(),editorAnimPreviewManager:this.slideComponent.getEditorAnimPreviewManager(),editingStateManager:this.slideComponent.getEditingStateManager(),animBrushManager:this.slideComponent.getAnimBrushManager(),formatBrushManager:this.slideComponent.getFormatBrushManager(),refreshBackground:this.slideComponent.refreshBackground,rightSideBarService:this.slideComponent.getRightSideBarService(),infrastructureService:this.slideComponent.options.infrastructureService,previewService:this.slideComponent.options.previewService,textEditorStateService:this.slideComponent.options.textEditorStateService,historyManager:this.slideComponent.options.historyManager,copyPasteImageService:this.slideComponent.options.copyPasteImageService,masterLayoutEditService:this.slideComponent.options.masterLayoutEditService,fontManager:this.slideComponent.options.fontManager,linkManager:this.slideComponent.options.linkManager,accessibilityManager:this.slideComponent.options.accessibilityManager,undoRedoService:null===(e=this.slideComponent.options)||void 0===e?void 0:e.undoRedoService,textSelectionUndoRedo:null===(t=this.slideComponent.options)||void 0===t?void 0:t.textSelectionUndoRedo,editAreaCanvasSizeManager:null===(n=this.slideComponent.options)||void 0===n?void 0:n.editAreaCanvasSizeManager}}},{key:"buildElement",value:function(A,e,t){try{var n;n=t?(e.id.indexOf(N.p),e.childFactoryOption(A)):this.childFactoryOption(A);var i=new F.a(H(H({},n),{},{asyncBuild:!0}));e.addChild(i.getWrapper()),i.factoryOptions.asyncBuild=!1,A.type!==R.d.GROUP&&A.type!==R.d.SMART_ART||this.groupNodeMap.has(A.key)||this.groupNodeMap.set(A.key,i)}catch(A){window.log.error("[canvas-async-build-tree]:".concat(A)),Object(U.c)({opername:j.e.PPT_QUALITY,module:j.d.CANVAS_RENDERER,action:j.b.CANVAS_RENDERER_BUILD_TREE,ver6:JSON.stringify({errorMsg:A.message,async:1})})}}},{key:"getTaskPriority",value:function(){var A=this.slideComponent.options.region;return A===P.s.LEFTLIST||A===P.s.TEMPLATE?x.a.HIGH:x.a.NORMAL}},{key:"getElementCountPerTask",value:function(){return this.slideComponent.options.region===P.s.PLAYER?2:5}}]),A}(),W=t("4560412a08"),K=function(){function A(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l()(this,A),S()(this,"slideComponent",void 0),S()(this,"hasBuild",void 0),S()(this,"asyncBuilder",void 0),S()(this,"asyncBuild",void 0),S()(this,"asyncRetryTimes",void 0),S()(this,"taskGroupKey",void 0),this.slideComponent=e,this.hasBuild=!1,this.asyncBuild=t,this.asyncRetryTimes=0}return s()(A,[{key:"dispose",value:function(){this.asyncBuilder&&(this.asyncBuilder.cancelBuild(),this.asyncBuilder=null)}},{key:"updateComponent",value:function(){this.hasBuild?this.syncBuildTree():this.asyncBuilder?(this.asyncBuilder.cancelBuild(),this.asyncBuilder=null,this.asyncRetryTimes<3?this.asyncBuildTree():this.syncBuildTree()):this.asyncBuild?this.asyncBuildTree():this.syncBuildTree()}},{key:"switchBuildMode",value:function(A){this.hasBuild||(A?(this.asyncBuilder&&(this.asyncBuilder.cancelBuild(),this.asyncBuilder=null),this.syncBuildTree()):this.asyncBuildTree())}},{key:"syncBuildTree",value:function(){var A;this.slideComponent.elementsLayer||(this.slideComponent.elementsLayer=new L.k,this.slideComponent.addChild(this.slideComponent.elementsLayer)),Object(W.a)({canvasLayer:this.slideComponent.elementsLayer,canvasArr:this.slideComponent.elementsLayer.children,modelsArr:this.slideComponent.options.slideModel.children,componentFactoryOptions:{isMasterEdit:this.slideComponent.options.isMasterEdit,model:null,getPageScale:this.slideComponent.options.getPageScale,getApplication:this.slideComponent.options.getApplication,region:this.slideComponent.options.region,fromScale:this.slideComponent.options.fromScale,logicService:this.slideComponent.options.logicService,handleSlideClick:this.slideComponent.options.handleSlideClick,getPlayerReduxStore:this.slideComponent.options.getPlayerReduxStore,getFilterDisplayOptions:this.slideComponent.getFilterDisplayOptions,mobileEditMode:this.slideComponent.options.mobileEditMode,slideModel:this.slideComponent.options.slideModel,infrastructureService:this.slideComponent.options.infrastructureService,uiDataService:this.slideComponent.getUiDataServiceDelegate(),selectionService:this.slideComponent.getSelectionServiceDelegate(),mediaManager:this.slideComponent.getMediaManagerDelegate(),animManager:this.slideComponent.getAnimManagerDelegate(),exportImageManager:this.slideComponent.getExportImageManager(),rightSideBarManager:this.slideComponent.getRightSideBarManager(),attachmentManager:this.slideComponent.getAttachmentManager(),editingStateManager:this.slideComponent.getEditingStateManager(),addonManager:this.slideComponent.getAddonManager(),editorAnimPreviewManager:this.slideComponent.getEditorAnimPreviewManager(),animBrushManager:this.slideComponent.getAnimBrushManager(),formatBrushManager:this.slideComponent.getFormatBrushManager(),refreshBackground:this.slideComponent.refreshBackground,previewService:this.slideComponent.options.previewService,textEditorStateService:this.slideComponent.options.textEditorStateService,historyManager:this.slideComponent.options.historyManager,copyPasteImageService:this.slideComponent.options.copyPasteImageService,masterLayoutEditService:this.slideComponent.options.masterLayoutEditService,fontManager:this.slideComponent.options.fontManager,linkManager:this.slideComponent.options.linkManager,accessibilityManager:this.slideComponent.options.accessibilityManager,undoRedoService:this.slideComponent.options.undoRedoService,textSelectionUndoRedo:this.slideComponent.options.textSelectionUndoRedo,editAreaCanvasSizeManager:null===(A=this.slideComponent.options)||void 0===A?void 0:A.editAreaCanvasSizeManager}}),this.hasBuild=!0,this.slideComponent.slideElementsHasBuilt=this.checkSlideElementsHasBuilt()}},{key:"asyncBuildTree",value:function(){var A=this;this.asyncRetryTimes+=1,this.taskGroupKey=this.generateTaskGroupKey();var e=new L.k;this.asyncBuilder=new V(this.slideComponent,e,this.taskGroupKey,{selectionService:this.slideComponent.getSelectionServiceDelegate()});var t=this.taskGroupKey;this.asyncBuilder.asyncBuildTree().then((function(){A.hasBuild||A.taskGroupKey!==t||A.slideComponent.isDispose?e.dispose():(A.slideComponent.elementsLayer=e,A.slideComponent.addChild(e),A.hasBuild=!0,A.asyncBuilder=null,A.slideComponent.slideElementsHasBuilt=A.checkSlideElementsHasBuilt())}))}},{key:"generateTaskGroupKey",value:function(){return"build-task-group-".concat(this.slideComponent.options.region,"-").concat(this.asyncRetryTimes,"-").concat(this.slideComponent.options.slideModel.key)}},{key:"checkSlideElementsHasBuilt",value:function(){var A;return this.slideComponent.elementsLayer.children.length===(null===(A=this.slideComponent.options.slideModel.sdkData)||void 0===A?void 0:A.shapeList.length)}}]),A}(),Y=t("a9d1a34b6a"),X=t("d5c3deb8c7"),Q=t("33c34da0d5"),q=t("06e1dc2299"),Z=t("d46708b785");function J(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function $(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?J(Object(t),!0).forEach((function(e){S()(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):J(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function AA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=b()(A);if(e){var i=b()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return y()(this,t)}}var eA=(z=function(A){v()(n,A);var e,t=AA(n);function n(A){var e,i;return l()(this,n),i=t.call(this),r()(u()(i),"slideElementsHasBuilt",_,u()(i)),S()(u()(i),"elementsLayer",void 0),S()(u()(i),"options",void 0),S()(u()(i),"isDispose",void 0),S()(u()(i),"slideElementsLayer",void 0),S()(u()(i),"masterElementsLayer",void 0),S()(u()(i),"layoutElementsLayer",void 0),S()(u()(i),"backGroundGraphic",void 0),S()(u()(i),"whiteBackground",void 0),S()(u()(i),"masterVariableElementsLayer",void 0),S()(u()(i),"layoutVariableElementsLayer",void 0),S()(u()(i),"cachedLayoutModel",void 0),S()(u()(i),"cachedMasterModel",void 0),S()(u()(i),"renderBackground",(function(){if(i.options.region!==P.s.CANVAS){i.renderWhiteBackground();var A=$($({},i.options.slideModel.props.style),{},{width:i.options.uiDataService.presentation.props.slideWidth,height:i.options.uiDataService.presentation.props.slideHeight,bgShape:T.b.rect,editable:!1,selected:!1,shadeTitleFrame:i.options.slideModel.getBackgroundFill().getShadeTitleFrame()}),e={getFilterDisplayOptions:i.getFilterDisplayOptions,getPageScale:i.options.getPageScale,region:i.options.region},t=Object(q.a)({style:A,factoryOptions:e});i.backGroundGraphic?i.backGroundGraphic.updateModel(t):(i.backGroundGraphic=new Q.d(t),i.addChild(i.backGroundGraphic))}})),S()(u()(i),"getFilterDisplayOptions",(function(){return i.options.region===P.s.LEFTLIST?{shadow:B.a.None,glow:B.a.None,softEdge:B.a.None,reflection:B.a.None,image:B.a.None}:void 0})),S()(u()(i),"refreshBackground",(function(){var A,e;i.renderBackground(),null===(A=(e=i.options).renderEditorBackground)||void 0===A||A.call(e)})),S()(u()(i),"addAllListener",(function(){i.options.slideModel.changeSetEngine.addChangesetObserver(i.renderComponent),i.onClick((function(A){var e,t;null===(e=(t=i.options).handleSlideClick)||void 0===e||e.call(t,A,i.options.slideModel)}))})),S()(u()(i),"removeAllListener",(function(){i.options.slideModel.changeSetEngine.removeChangesetObserver(i.renderComponent)})),S()(u()(i),"renderComponent",(function(A){var e,t;null===(e=(t=i.options).onWillRenderCallback)||void 0===e||e.call(t,u()(i)),i.renderBackground(),i.renderMasterLayout(A),i.renderMasterLayoutVariableElements(),i.renderElements()})),S()(u()(i),"renderElements",(function(){i.slideElementsLayer||(i.slideElementsLayer=new K(u()(i),i.options.asyncBuild)),i.slideElementsLayer.updateComponent()})),S()(u()(i),"renderMasterLayoutVariableElements",(function(){(i.options.slideModel.isSlide||i.options.slideModel.isLayout)&&(i.masterVariableElementsLayer||(i.masterVariableElementsLayer=new w.a(R.d.MASTER,i.options.slideModel,i.options.getPageScale,i.options.getApplication,i.options.region,i.options.fromScale,{infrastructureService:i.options.infrastructureService,uiDataService:i.options.uiDataService,mediaManager:i.options.mediaManager,linkManager:i.options.linkManager,editingStateManager:i.options.editingStateManager,animBrushManager:i.options.animBrushManager,formatBrushManager:i.options.formatBrushManager,fontManager:i.options.fontManager,masterLayoutEditService:i.options.masterLayoutEditService},void 0,!0),i.addChild(i.masterVariableElementsLayer)),i.masterVariableElementsLayer.updateSlideModel(i.options.slideModel,R.d.MASTER)),i.options.slideModel.isSlide&&(i.layoutVariableElementsLayer||(i.layoutVariableElementsLayer=new w.a(R.d.LAYOUT,i.options.slideModel,i.options.getPageScale,i.options.getApplication,i.options.region,i.options.fromScale,{infrastructureService:i.options.infrastructureService,uiDataService:i.options.uiDataService,mediaManager:i.options.mediaManager,linkManager:i.options.linkManager,editingStateManager:i.options.editingStateManager,animBrushManager:i.options.animBrushManager,formatBrushManager:i.options.formatBrushManager,fontManager:i.options.fontManager,masterLayoutEditService:i.options.masterLayoutEditService},void 0,!0),i.addChild(i.layoutVariableElementsLayer)),i.layoutVariableElementsLayer.updateSlideModel(i.options.slideModel,R.d.LAYOUT))})),S()(u()(i),"renderMasterLayout",(function(A){if(i.options.region!==P.s.CANVAS){if(i.options.slideModel.isSlide||i.options.slideModel.isLayout){var e,t=i.options.slideModel.getRelationMasterModel();if(t!==i.cachedMasterModel||!i.masterElementsLayer){var n=new w.a(R.d.MASTER,i.options.slideModel,i.options.getPageScale,i.options.getApplication,i.options.region,i.options.fromScale,{infrastructureService:i.options.infrastructureService,uiDataService:i.options.uiDataService,mediaManager:i.options.mediaManager,linkManager:i.options.linkManager,editingStateManager:i.options.editingStateManager,animBrushManager:i.options.animBrushManager,formatBrushManager:i.options.formatBrushManager,fontManager:i.options.fontManager,masterLayoutEditService:i.options.masterLayoutEditService});if(i.masterElementsLayer){var o=i.children.findIndex((function(A){return A===i.masterElementsLayer}));i.removeChild(i.masterElementsLayer),i.addChildAt(n,o)}else i.addChild(n);i.masterElementsLayer=n}i.cachedMasterModel=t,null===(e=i.masterElementsLayer)||void 0===e||e.updateSlideModel(i.options.slideModel,R.d.MASTER)}if(i.options.slideModel.isSlide){var r,a=i.options.slideModel.getRelationLayoutModel();if(a!==i.cachedLayoutModel||!i.layoutElementsLayer){var l=new w.a(R.d.LAYOUT,i.options.slideModel,i.options.getPageScale,i.options.getApplication,i.options.region,i.options.fromScale,{infrastructureService:i.options.infrastructureService,uiDataService:i.options.uiDataService,mediaManager:i.options.mediaManager,linkManager:i.options.linkManager,editingStateManager:i.options.editingStateManager,animBrushManager:i.options.animBrushManager,formatBrushManager:i.options.formatBrushManager,fontManager:i.options.fontManager,masterLayoutEditService:i.options.masterLayoutEditService});if(i.layoutElementsLayer){var c=i.children.findIndex((function(A){return A===i.layoutElementsLayer}));i.removeChild(i.layoutElementsLayer),i.addChildAt(l,c)}else i.addChild(l);i.layoutElementsLayer=l}i.cachedLayoutModel=a,null===(r=i.layoutElementsLayer)||void 0===r||r.updateSlideModel(i.options.slideModel,R.d.LAYOUT)}}else{var s,d;A&&(null===(s=(d=i.options).forceReloadWithoutSelfChange)||void 0===s||s.call(d,A))}})),i.options=A,i.forceRenderOutsideView=!0,i.renderComponent(),i.addAllListener(),null===(e=i.options.editLogic)||void 0===e||e.setComponent(u()(i)),i}return s()(n,[{key:"getRightSideBarService",value:function(){return this.options.rightSideBarService}},{key:"getEditorAnimPreviewManager",value:function(){return this.options.editorAnimPreviewManager}},{key:"getUiDataServiceDelegate",value:function(){return this.options.uiDataService}},{key:"getSelectionServiceDelegate",value:function(){return this.options.selectionService}},{key:"getMediaManagerDelegate",value:function(){return this.options.mediaManager}},{key:"getAnimManagerDelegate",value:function(){return this.options.animManager}},{key:"getExportImageManager",value:function(){return this.options.exportImageManager}},{key:"getRightSideBarManager",value:function(){return this.options.rightSideBarManager}},{key:"getAttachmentManager",value:function(){return this.options.attachmentManager}},{key:"getEditingStateManager",value:function(){return this.options.editingStateManager}},{key:"getAddonManager",value:function(){return this.options.addonManager}},{key:"getFormatBrushManager",value:function(){return this.options.formatBrushManager}},{key:"getAnimBrushManager",value:function(){return this.options.animBrushManager}},{key:"dispose",value:function(){var A,e,t,i;h()(b()(n.prototype),"dispose",this).call(this),this.isDispose=!0,this.slideElementsLayer&&this.slideElementsLayer.dispose(),null===(A=this.options.editLogic)||void 0===A||A.dispose(),this.removeAllListener(),this.options.slideModel.mainSlideTimeline&&this.options.region!==P.s.PRESENTER_VIEW&&this.options.region!==P.s.CANVAS&&(this.options.slideModel.mainSlideTimeline.clearMasterTimeline(),this.options.slideModel.mainSlideTimeline=null),null===(e=this.elementsLayer)||void 0===e||e.dispose(),null===(t=this.masterVariableElementsLayer)||void 0===t||t.dispose(),null===(i=this.layoutVariableElementsLayer)||void 0===i||i.dispose()}},{key:"hasBuild",get:function(){var A;return null===(A=this.slideElementsLayer)||void 0===A?void 0:A.hasBuild}},{key:"display",value:function(){this.hasBuild||this.slideElementsLayer.switchBuildMode(!0)}},{key:"ensureRenderComplete",value:(e=i()(M.a.mark((function A(){var e,t,n;return M.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return n=Y.a.promiseModelTreeImgLoaded(this.options.slideModel),A.next=3,n;case 3:return A.next=5,this.ensureChartSyncRenderComplete();case 5:null===(e=(t=this.options).getApplication)||void 0===e||e.call(t).render();case 6:case"end":return A.stop()}}),A,this)}))),function(){return e.apply(this,arguments)})},{key:"onDidRender",value:function(){var A,e,t,i;h()(b()(n.prototype),"onDidRender",this).call(this),null===(A=(e=this.options).onDidRenderCallback)||void 0===A||A.call(e,this),null===(t=this.options.editLogic)||void 0===t||null===(i=t.onDidRender)||void 0===i||i.call(t)}},{key:"ensureChartSyncRenderComplete",value:function(){var A=Object(Z.a)(this.options.slideModel);return Promise.all(A)}},{key:"renderWhiteBackground",value:function(){var A=this.options.uiDataService.presentation.props,e=A.slideWidth,t=A.slideHeight,n="M 0 0 L ".concat(e," 0 L ").concat(e," ").concat(t," L 0 ").concat(t," Z");this.whiteBackground?this.whiteBackground.path=n:(this.whiteBackground=new L.N(n),this.whiteBackground.fill=new L.i(L.h.White),this.addChild(this.whiteBackground))}}]),n}(L.k),_=O()(z.prototype,"slideElementsHasBuilt",[X.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),z)},e59feb79d0:function(A,e,t){"use strict";t.d(e,"a",(function(){return D}));var n,i,o,r,a,l=t("7a5536c9bf"),c=t.n(l),s=t("176815363d"),d=t.n(s),u=t("1f925d7f50"),p=t.n(u),h=t("9132715560"),f=t.n(h),v=t("6a364eb35c"),g=t.n(v),y=t("85d0a7609b"),m=t.n(y),b=t("2dc700e1e6"),C=t.n(b),S=(t("f1054791f4"),t("3ef2352f0b")),E=t.n(S),O=(t("8e7cce0ada"),t("c6244f7705"),t("c9a7ecac4d"),t("85d48ef22b"),t("2a6f332b5e"),t("29f8c5f672"),t("081c8cafea"),t("8ee19818c4"),t("fce3077cdf"),t("63513d8b56"),t("6e20b6a7d8"),t("0acdc5834b"),t("4bbb5840d5"),t("3bf1976a4f"),t("b8217400dc"),t("d5c3deb8c7")),k=t("feede38eee"),M=t("8a553b8ae9"),L=t("b86964b011"),T=(t("a2a09da1e3"),"TdocsUncommon"),w=function(){function A(){var e,t,n=this;f()(this,A),m()(this,"observers",void 0),m()(this,"onNewFontLoaded",(function(){var A=n.getUncommonFontFace(document.fonts);A&&"loaded"===A.status&&n.notify(A)})),this.observers=[],null===(e=document.fonts)||void 0===e||null===(t=e.addEventListener)||void 0===t||t.call(e,"loadingdone",this.onNewFontLoaded),this.checkFontReady()}return g()(A,[{key:"addObserverForUncommonFontLoaded",value:function(A){this.observers.indexOf(A)<0&&this.observers.push(A)}},{key:"removeObserverForUncommonFontLoaded",value:function(A){var e=this.observers.indexOf(A);e>=0&&this.observers.splice(e,1)}},{key:"checkFontReady",value:function(){var A,e,t,n=this;void 0!==(null===(A=document.fonts)||void 0===A?void 0:A.status)&&("loading"===(null===(e=document.fonts)||void 0===e?void 0:e.status)?null===(t=document.fonts)||void 0===t||t.ready.then((function(A){n.checkUncommonFonts(A)})):this.checkUncommonFonts(document.fonts))}},{key:"getUncommonFontFace",value:function(A){var e=void 0;return null==A||A.forEach((function(A){A.family===T&&(e=A)})),e}},{key:"checkUncommonFonts",value:function(A){var e=this,t=this.getUncommonFontFace(A);if(t)"unloaded"===t.status&&t.load().then((function(){e.notify(t)}));else{var n,i=new FontFace(T,"url(https://docs.gtimg.com/common-cdn/ttf/HYZhongHei-Subset.woff)",{display:"swap",unicodeRange:"U+9FA6-9FEF, U+FA0F,U+FA11,U+FA13-FA14,U+FA1F,U+FA21,U+FA23-FA24,U+FA27-FA29,U+20087,\nU+20089,U+200CC,U+20164,U+20676,U+20CD0,U+2139A,U+21413,U+215D7,U+2298F,U+235CB,U+23C97-23C98,U+23E23,U+241FE,\nU+249DB,U+24A7D,U+24AC9,U+25532,U+25562,U+255A8,U+25ED7,U+26221,U+2648D,U+26676,U+2677C,U+26B5C,U+26C21,U+27FF9,\nU+28408,U+28678,U+28695,U+287E0,U+28B49,U+28C47,U+28C4F,U+28C51,U+28C54,U+28E99,U+29F7E,U+29F83,U+29F8C,U+2A7DD,\nU+2A8FB,U+2A917,U+2AA30,U+2AA36,U+2AA58,U+2AFA2,U+2B127-2B128,U+2B137-2B138,U+2B1ED,U+2B300,U+2B363,U+2B36F,U+2B372,\nU+2B37D,U+2B404,U+2B410,U+2B413,U+2B461,U+2B4E7,U+2B4EF,U+2B4F6,U+2B4F9,U+2B50D-2B50E,U+2B536,U+2B5AE-2B5AF,\nU+2B5B3,U+2B5E7,U+2B5F4,U+2B61C-2B61D,U+2B626-2B628,U+2B62A,U+2B62C,U+2B695-2B696,U+2B6AD,U+2B6ED,U+2B7A9,\nU+2B7C5,U+2B7E6,U+2B7F9,U+2B7FC,U+2B806,U+2B80A,U+2B81C,U+2B8B8,U+2BAC7,U+2BB5F,U+2BB62,U+2BB7C,U+2BB83,U+2BC1B,U+2BD77,\nU+2BD87,U+2BDF7,U+2BE29,U+2C029-2C02A,U+2C0A9,U+2C0CA,U+2C1D5,U+2C1D9,U+2C1F9,U+2C27C,U+2C288,\nU+2C2A4,U+2C317,U+2C35B,U+2C361,U+2C364,U+2C488,U+2C494,U+2C497,U+2C542,U+2C613,U+2C618,U+2C621,U+2C629,U+2C62B-2C62D,\nU+2C62F,U+2C642,U+2C64A-2C64B,U+2C72C,U+2C72F,U+2C79F,U+2C7C1,U+2C7FD,U+2C8D9,U+2C8DE,U+2C8E1,U+2C8F3,U+2C907,U+2C90A,\nU+2C91D,U+2CA02,U+2CA0E,U+2CA7D,U+2CAA9,U+2CB29,U+2CB2D-2CB2E,U+2CB31,U+2CB38-2CB39,U+2CB3B,U+2CB3F,U+2CB41,U+2CB4A,\nU+2CB4E,U+2CB5A-2CB5B,U+2CB64,U+2CB69,U+2CB6C,U+2CB6F,U+2CB73,U+2CB76,U+2CB78,U+2CB7C,U+2CBB1,U+2CBBF-2CBC0,\nU+2CBCE,U+2CC56,U+2CC5F,U+2CCF5-2CCF6,U+2CCFD,U+2CCFF,U+2CD02-2CD03,U+2CD0A,U+2CD8B,U+2CD8D,\nU+2CD8F-2CD90,U+2CD9F-2CDA0,U+2CDA8,U+2CDAD-2CDAE,U+2CDD5,U+2CE18,U+2CE1A,U+2CE23,U+2CE26,U+2CE2A,U+2CE7C,U+2CE88,U+2CE93"});null===(n=document.fonts)||void 0===n||n.add(i),i.load().then((function(){e.notify(i)}))}}},{key:"notify",value:function(A){var e,t,n;null===(e=this.observers)||void 0===e||e.forEach((function(e){return null==e?void 0:e(A,T)})),null===(t=document.fonts)||void 0===t||null===(n=t.removeEventListener)||void 0===n||n.call(t,"loadingdone",this.onNewFontLoaded)}}]),A}(),R=t("020899bf26"),P=t("c9c92622ff"),B=t("aba9dcef64"),D=(n=Reflect.metadata("design:type",Array),i=Reflect.metadata("design:type","undefined"==typeof Set?Object:Set),o=function(){function A(e,t){f()(this,A),m()(this,"usingFontFamiliesBySlide",void 0),p()(this,"downloadedFontFamilies",r,this),p()(this,"globalUsingFontsCache",a,this),m()(this,"editorOnFontDownloadedCallbacks",new Map),m()(this,"shapeModelUsingFonts",new Map),m()(this,"uncommonFontLogic",void 0),m()(this,"disposeFontDownloadedReaction",void 0),m()(this,"disposeGlobalUsingFontsChangeReaction",void 0),this.uiDataService=e,this.injectable=t,this.usingFontFamiliesBySlide=new Map,this.downloadedFontFamilies=[],null!=t&&t.disableUncommonFontLogic||(this.uncommonFontLogic=new w),null!=t&&t.disableCloudFont||(null!=t&&t.disableVip||this.initVipStatus(),this.registerFontDownloadedReaction())}var e,t,n;return g()(A,[{key:"triggerFontDownload",value:(n=d()(E.a.mark((function A(e){var t,n,i=this;return E.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return t=this.fallbackToFontNameAlias(e),A.next=3,Object(k.b)(t);case 3:if(n=A.sent,t===e){A.next=7;break}return A.next=7,Object(M.d)(t,e);case 7:Object(O.w)((function(){n&&i.downloadedFontFamilies.push(t),t!==e&&i.downloadedFontFamilies.push(e)}));case 8:case"end":return A.stop()}}),A,this)}))),function(A){return n.apply(this,arguments)})},{key:"registerOnFontDownloadCallback",value:function(A,e){var t;if(null===(t=this.injectable)||void 0===t||!t.disableCloudFont){this.editorOnFontDownloadedCallbacks.has(A)||this.editorOnFontDownloadedCallbacks.set(A,[]);var n=this.editorOnFontDownloadedCallbacks.get(A);null==n||n.push(e)}}},{key:"collectUsingFontsForShapeModel",value:function(A){var e,t,n;if(A&&(null===(e=this.injectable)||void 0===e||!e.disableCloudFont)){var i=[];if(null===(t=A.paragraphList)||void 0===t||null===(n=t.forEach)||void 0===n||n.call(t,(function(A){var e,t;null==A||null===(e=A.textRuns)||void 0===e||null===(t=e.forEach)||void 0===t||t.call(e,(function(A){var e;null!==(e=A.styles)&&void 0!==e&&e.fonts&&Object.values(A.styles.fonts).forEach((function(A){"string"==typeof A&&i.push(A)}))}))})),A.isPlaceholder){var o=A.presentationRef;o&&i.push(o.globalFont)}this.onRecordUsingFonts(A.key,i)}}},{key:"dispose",value:function(){var A,e;null===(A=this.disposeFontDownloadedReaction)||void 0===A||A.call(this),null===(e=this.disposeGlobalUsingFontsChangeReaction)||void 0===e||e.call(this),this.disposeAllEditorFontDownloadCallbacks()}},{key:"disposeFontDownloadCallbackByShapeModelKey",value:function(A,e){if(this.editorOnFontDownloadedCallbacks.has(A)){var t=this.editorOnFontDownloadedCallbacks.get(A);null==t||t.some((function(A,n){return A===e&&(t.splice(n,1),!0)}))}}},{key:"collectFontsUsingStatus",value:(t=d()(E.a.mark((function A(){var e,t,n,i,o,r,a,l=this;return E.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(null===(e=this.injectable)||void 0===e||!e.injectedFontUsingStatus){A.next=2;break}return A.abrupt("return",this.injectable.injectedFontUsingStatus);case 2:return t={hasCustomFonts:!1,hasTencentSans:!1,hasVipFonts:!1},n=new Set,this.uiDataService.presentation.children.forEach((function(A){A.children.forEach((function(A){l.iterateOnModelChildren(A,n)}))})),i=c()(n).map((function(A){return l.fallbackToFontNameAlias(A)})),o=i.map((function(A){return Object(M.c)(A)})),r=i.map((function(A){return Object(M.b)(A)})),A.prev=8,A.next=11,Promise.all(o);case 11:if(t.hasVipFonts=A.sent.reduce((function(A,e){return A||e}),!1),A.t0=t.hasVipFonts,A.t0){A.next=17;break}return A.next=16,Promise.all(r);case 16:A.t0=A.sent.reduce((function(A,e){return A||e}),!1);case 17:t.hasCustomFonts=A.t0,A.next=25;break;case 20:A.prev=20,A.t1=A.catch(8),null===(a=window.log)||void 0===a||a.error("",A.t1),t.hasVipFonts=!1,t.hasCustomFonts=!1;case 25:return t.hasTencentSans=i.some((function(A){return" W3"===A||" W7"===A})),A.abrupt("return",t);case 27:case"end":return A.stop()}}),A,this,[[8,20]])}))),function(){return t.apply(this,arguments)})},{key:"onRecordUsingFonts",value:function(A,e){var t=this;this.shapeModelUsingFonts.has(A)||this.shapeModelUsingFonts.set(A,new Set);var n=this.shapeModelUsingFonts.get(A);e.forEach((function(A){n.add(A),t.globalUsingFontsCache.add(A)}))}},{key:"disposeAllEditorFontDownloadCallbacks",value:function(){this.editorOnFontDownloadedCallbacks.clear()}},{key:"initVipStatus",value:function(){this.initMyselfVipStatus(),this.initOwnerVipStatus()}},{key:"initMyselfVipStatus",value:(e=d()(E.a.mark((function A(){var e,t,n,i,o;return E.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,B.a.OnlineApiService.promise();case 2:return n=A.sent,A.next=5,n.getUserInfo();case 5:0===(null==(i=A.sent)||null===(e=i.data)||void 0===e?void 0:e.cgicode)&&0===(null==i||null===(t=i.data)||void 0===t?void 0:t.retcode)&&(o=i.data,window.clientVars&&(window.clientVars.vipInfo=Object(L.a)(o.vip_info)));case 7:case"end":return A.stop()}}),A)}))),function(){return e.apply(this,arguments)})},{key:"initOwnerVipStatus",value:function(){var A=this;Object(R.b)((function(){var e=A.getPadId(),t="300000000$",n=e;"string"==typeof e&&e.startsWith(t)&&(n=e.substring(10));var i={file_id:n};fetch("/api/personalize/owner/viplevel",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}).then((function(A){return A.json()})).then((function(A){0===A.retcode&&(window.clientVars.ownerVipInfo={vip_level:A.result.vip_level})})).catch((function(A){window.log.error(A)}))}))}},{key:"getPadId",value:function(){var A,e;return null!==(A=null===(e=R.a.DocInfoManager())||void 0===e?void 0:e.padId)&&void 0!==A?A:""}},{key:"registerFontDownloadedReaction",value:function(){var A=this;this.disposeFontDownloadedReaction=Object(O.r)((function(){return A.downloadedFontFamilies.length}),(function(){var e=A.downloadedFontFamilies[A.downloadedFontFamilies.length-1];A.editorOnFontDownloadedCallbacks.forEach((function(t,n){var i=A.shapeModelUsingFonts.get(n);null!=i&&i.has(e)&&t.forEach((function(A){return A(e)}))}))})),this.disposeGlobalUsingFontsChangeReaction=Object(O.r)((function(){return A.globalUsingFontsCache.size}),(function(){c()(A.globalUsingFontsCache).forEach((function(e){A.triggerFontDownload(e)}))}))}},{key:"iterateOnModelChildren",value:function(A,e){var t,n=this;if(A)if(Object(P.B)(A))null===(t=A.paragraphList)||void 0===t||t.forEach((function(A){var t;null==A||null===(t=A.textRuns)||void 0===t||t.forEach((function(A){var t;null!==(t=A.styles)&&void 0!==t&&t.fonts&&(A.styles.fonts.latin?e.add(A.styles.fonts.latin):A.styles.fonts.ea&&e.add(A.styles.fonts.ea))}))}));else if(Object(P.D)(A)){var i,o=null===(i=A.tableItems)||void 0===i?void 0:i.reduce((function(A,e){return A.concat(e)}),[]);null==o||o.forEach((function(A){n.iterateOnModelChildren(A,e)}))}else Object(P.n)(A)&&A.children.forEach((function(A){n.iterateOnModelChildren(A,e)}))}},{key:"fallbackToFontNameAlias",value:function(A){return["TencentSans W3","","W3"].includes(A)?" W3":["TencentSans W7","W7"].includes(A)?" W7":A}}]),A}(),r=C()(o.prototype,"downloadedFontFamilies",[O.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=C()(o.prototype,"globalUsingFontsCache",[O.q,i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),o)},f59de93b62:function(A,e,t){"use strict";t.d(e,"a",(function(){return s}));var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("85d0a7609b"),l=t.n(a),c=t("0f25ec4562"),s=function(){function A(e){i()(this,A),l()(this,"slideComponent",void 0),this.editorInstanceService=e}return r()(A,[{key:"dispose",value:function(){}},{key:"setComponent",value:function(A){this.slideComponent=A}},{key:"onDidRender",value:function(){this.updateEditorSurface()}},{key:"updateEditorSurface",value:function(){var A=this.editorInstanceService.getEditorInstance();A instanceof c.a&&null!=A&&A.isEditing&&(null==A||A.ifUpdateEditorSurface())}}]),A}()},fd65b6e450:function(A,e,t){"use strict";t.d(e,"a",(function(){return g}));t("73b854064b");var n=t("9132715560"),i=t.n(n),o=t("6a364eb35c"),r=t.n(o),a=t("bd29e2df90"),l=t.n(a),c=t("ab5eb40518"),s=t.n(c),d=t("1b4cdd6a36"),u=t.n(d),p=t("3f95c26bbc"),h=t("464ceed456"),f=t("87f81c55b9");function v(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=u()(A);if(e){var i=u()(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return s()(this,t)}}var g=function(A){l()(t,A);var e=v(t);function t(){return i()(this,t),e.call(this)}return r()(t,[{key:"createComponentLogic",value:function(A,e){return e.getComponentType()===h.a.TEXTEDITOR?new f.a(A,e):null}}]),t}(p.a)}}]);
//# sourceMappingURL=slide-base~ab752770-75239f.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([["common~c344e93b"],{"0066804aa3":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r("93085721b7"),n=r("3ac5e24f6b");class o extends i.a{static fromPageContext(e){const t=new o(e.getPageType());return t.initContextFromPageContext(e),t}getListStyle(){return this.lstStyle}getBodyPr(){return this.bodyPr}getDefaultFont(){return this.defaultFontCollection&&n.a.getFontStyleByFontCollection(this.defaultFontCollection)}getDefaultTextFill(){return this.defaultTextColor&&{solidFill:{egColorChoice:this.defaultTextColor}}}setListStyle(e){this.lstStyle=e}setBodyPr(e){this.bodyPr=e}setDefaultFontCollection(e){this.defaultFontCollection=e}setDefaultTextColor(e){this.defaultTextColor=e}constructor(e){super(e)}}},"01ad966fa3":function(e,t,r){"use strict";r.d(t,"a",(function(){return U}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("711a53c9fc"),s=r("2f766f71b0"),l=r.n(s),c=r("ee6bb53310"),d=r.n(c),u=r("026cc7da1f"),p=r("182acadcf2"),h=r("03420c1dd4"),m=r("285f8ccc4f"),f=r("7c46f42788"),g=r("420d598ff9"),b=r("09ca8a17b7"),v=r("844d924118"),y=r("0130811e8a"),S=r("b41b5d48f6"),x=r("efb57b1462"),_=r("c685265b1c"),T=r("2e46ca67a0"),O=r("3ac5e24f6b"),P=r("cf3340a08c"),C=r("38432b74aa"),I=r("59e51a6447"),w=r("25242563a6"),E=r("c305455190"),j=r("ed382b70c1"),A=r("2ba82388a5"),L=r("9303123b33"),k=r("b0d97736f5"),D=r("963dec4e9c"),R=r("7ecd30c99e"),M=r("215eaa3247"),B=r("d3f3e93e04");class N{updateSlideList(e){this.slideList=e}updateSectionList(e){this.sectionList=e}rebindBySlide(e){for(let t=this.sectionList.length-1;t>=0;t-=1){const r=this.sectionList[t];if(r.props.firstSlideId===e)return void this.rebind(r)}}rebindWhenInsertSlide(e,t){for(let r=t;r>=0;r-=1)if(this.sectionSlideList[r].type!==f.a.Section){if(!this.ignoreSlideList.includes(this.sectionSlideList[r].id))return}else this.bindMutationMap.set(this.sectionSlideList[r].id,e)}setIgnoreSlides(e){for(const t of e)this.ignoreSlideList.push(t.id)}requestBindTask(){this.bindMutationMap.forEach(((e,t)=>{const r=this.sectionList.find((e=>e.id===t));if(!r)return;if(r.props.firstSlideId===e)return;const i=this.slideList.findIndex((t=>t.id===e));this.bindSectionToSlide(r,i>=0?i:this.slideList.length)}))}requestRenameTask(e){this.sectionList.forEach(((t,r)=>{t.props.name!==e[r]&&t.api.updateProps({name:e[r]})}))}addBindMutation(e,t){this.bindMutationMap.set(e.id,t)}rebind(e){var t;const r=e.props.firstSlideId,i=[];for(const t of this.sectionList)if(t.props.firstSlideId===e.props.firstSlideId&&i.push(t),t.id===e.id)break;const n=this.slideList.findIndex((e=>e.id===r));let o=n;for(o=n;o<this.slideList.length;o+=1){var a;if(!this.ignoreSlideList.includes(null===(a=this.slideList[o])||void 0===a?void 0:a.id))break}const s=null===(t=this.slideList[o])||void 0===t?void 0:t.id;for(const e of i)this.bindMutationMap.set(e.id,s)}get sectionSlideList(){const e=[],{sectionList:t,slideList:r}=this;for(const i of r){for(const r of t)r.props.firstSlideId===i.id&&e.push(r);e.push(i)}const i=t.filter((e=>void 0===e.props.firstSlideId));return e.push(...i),e}constructor(e,t,r){this.bindSectionToSlide=r,this.ignoreSlideList=[],this.bindMutationMap=new Map,this.slideList=e,this.sectionList=t}}var F=r("76f1d59f9d");class U extends F.a{addPresentation(e,t,r){let o=[],a=[],s=new Map;const l=[];let c;const d=this.shallowClonePresentation(e);return this.transaction((()=>{this.updateResourceMap(d.resourceMap);const e=new k.a;new D.a(e).directDeduplicate(d,this.model.store.data,{layoutRepeatedRate:0}),s=this.addTheme(d.themeList),d.masterList.forEach((e=>{const t=s.get(e.themeId);t&&(e.themeId=t)})),o=this.addMasters(d.masterList),c=e.getRedundantMasterMap();const u=new Map;Object.values(d.layoutMap).forEach((e=>{var t;const r=null===(t=o.find((t=>t.get(e.masterId))))||void 0===t?void 0:t.get(e.masterId);var i;(r&&(e.masterId=r),u.get(e.masterId))?null===(i=u.get(e.masterId))||void 0===i||i.push(e):u.set(e.masterId,[e])}));for(const e of u.values())l.push(...this.addLayouts(e));d.slideList.forEach((e=>{var t;const r=null===(t=l.find((t=>t.get(e.layoutId))))||void 0===t?void 0:t.get(e.layoutId);r&&(e.layoutId=r)}));const p=r?this.addSlidesWithSection.bind(this):this.addSlides.bind(this);a=p(d.slideList,t),Object.values(d.noteSlideMap).forEach((e=>{var t,r;return this.addNoteSlide(Object(n.a)(Object(i.a)({},e),{slideId:null!==(r=null===(t=a.find((t=>t.get(e.slideId))))||void 0===t?void 0:t.get(e.slideId))&&void 0!==r?r:""}))}))})),{redundantMasterMap:c,masterIdsArr:o,layoutIdsArr:l,themeIdsMap:s,slideIdsArr:a}}updateProps(e){const{showSpecialPlsOnTitleSld:t,firstSlideNum:r,defaultTextStyle:i}=e;this.transaction((()=>{this.request([new E.a({showSpecialPlsOnTitleSld:t,firstSlideNum:r,defaultTextStyle:i&&Object(A.c)(Object(m.a)(this.model.store.data.defaultTextStyle),i)})])}))}resizeSlideSize(e,t,r){if(r!==a.jb.screen4x3&&r!==a.jb.screen16x9&&e/t!=4/3&&e/t!=16/9)return;const{cx:i,cy:n}=this.model.props.sldSz;let o=0;const s=e/i,l=t/n;return o=s<=l?s:l,this.scalePresentation(e,t,r,s,l,o),!0}updateSlideSizeType(e){const t=this.getValidSldSz(e),{cx:r,cy:i,type:n}=this.model.props.sldSz;if(n===t)return;const o=i,s=t===a.jb.screen4x3?4/3*i:16/9*i,l=s/r,c=(s-r)/2;this.transaction((()=>{this.request([new I.a({size:{cx:s,cy:o,type:t}})]);for(const e of this.model.masterList)for(const t of e.shapeList)this.scaleShapeFrame(t,l,1);for(const e of this.model.layoutList)for(const t of e.shapeList)this.scaleShapeFrame(t,l,1);for(const e of this.model.slideList)for(const t of e.shapeList)t.isPlaceholder&&t.type===f.a.Shape?this.scaleShapeFrame(t,l,1):this.moveShapeFrame(t,c,0)}))}addSlides(e,t=this.model.slideList.length){if(!e.length)return[];this.guard((r=>S.a.page.can.insertIntoSlideList(r,e[0].id,t)));const r=[];return this.forEachInTransaction(e,((e,i)=>{const n=Object(m.a)(e);Reflect.deleteProperty(n,"noteSlideId");const o=this.model.getIDGenerator(),a=this.createIdsMapFromPage(n);if(n.timing){[...Object(T.b)(n.timing,o).entries()].forEach((([e,t])=>a.set(e,t)))}const s=this.createKeyframeContext(a),l=Object(h.f)(n,t+i,s);this.request(Object(g.a)(l)),r.push(a)})),r}addSlidesWithSection(e,t=this.model.slideList.length+this.model.sectionList.length){if(!e.length)return[];let r=[];return this.transaction((()=>{const{sectionList:i}=this.model,n=this.getSectionIndexFromGap(t),o=t-n,a=this.model.slideList[o],s=i.filter(((e,t)=>(null==a?void 0:a.id)===e.props.firstSlideId&&t<=n));r=this.addSlides(e,o);for(const e of s)this.bindSectionToSlide(e,o)})),r}addLayouts(e,t){if(!e.length)return[];this.guard((r=>S.a.page.can.insertIntoLayoutIdList(r,e[0].id,e[0].masterId,null!=t?t:0))),Object(u.assert)(e.every((t=>t.masterId===e[0].masterId)),"all layouts must have the same master id");const r=[];return this.forEachInTransaction(e,((e,i)=>{var n;const o=Object(m.a)(e);var a;null!=t||(t=null!==(a=null===(n=this.model.getMasterById(o.masterId))||void 0===n?void 0:n.layoutList.length)&&void 0!==a?a:0);const s=this.model.getIDGenerator(),l=this.createIdsMapFromPage(o);if(e.timing){[...Object(T.b)(e.timing,s).entries()].forEach((([e,t])=>l.set(e,t)))}const c=this.createKeyframeContext(l),d=Object(h.a)(o,t+i,c);this.request(Object(g.a)(d)),r.push(l)})),r}addMasters(e,t=this.model.masterList.length){if(!e.length)return[];this.guard((r=>S.a.page.can.insertIntoMasterList(r,e[0].id,t)));const r=[];return this.forEachInTransaction(e,((e,i)=>{const n=Object(m.a)(e);n.layoutIdList=[];const o=this.model.getIDGenerator(),a=this.createIdsMapFromPage(n);if(e.timing){[...Object(T.b)(e.timing,o).entries()].forEach((([e,t])=>a.set(e,t)))}const s=this.createKeyframeContext(a),l=Object(h.b)(n,t+i,s);this.request(Object(g.a)(l)),r.push(a)})),r}addNotesMasterSlide(e){const t=Object(m.a)(e),{spTree:r}=t.cSld,i=this.model.getIDGenerator(),n=r?Object(T.a)(r.shapeList,i):new Map;var o;(n.set(e.id,i.next()),r)&&(r.id=null!==(o=r.id)&&void 0!==o?o:`spTree_${e.id}`,n.set(r.id,i.next()));const a=this.createKeyframeContext(n),s=Object(h.e)(t,a);this.transaction((()=>this.request(Object(g.a)(s))))}addNoteSlide(e){this.guard((t=>S.a.page.should.exist(t,e.slideId,a.Q.slide)));const t=this.model.store.getSlideById(e.slideId);Object(u.assert)(t);const r=t.getNoteSlide();if(r)return r.id;const o=Object(m.a)(e),{spTree:s}=o.cSld,l=this.model.getIDGenerator(),c=s?Object(T.a)(s.shapeList,l):new Map;var d;(c.set(e.id,l.next()),s)&&(s.id=null!==(d=s.id)&&void 0!==d?d:`spTree_${e.id}`,c.set(s.id,l.next()));const p=this.createKeyframeContext(c),f=Object(h.d)(o,Object(n.a)(Object(i.a)({},p),{page:t.store.data}));return this.transaction((()=>this.request(Object(g.a)(f)))),e.id}removeSlides(e){e.length&&this.transaction((()=>{e.slice().sort(((e,t)=>this.model.slideList.indexOf(t)-this.model.slideList.indexOf(e))).forEach((e=>{const t=e.getWritableOwnedData(),r=this.model.slideList.indexOf(e);if(!t.cSld.spTree)return;const i=Object(T.c)(t.cSld.spTree.shapeList);if(t.timing){[...Object(T.d)(t.timing).entries()].forEach((([e,t])=>i.set(e,t)))}const n=this.createKeyframeContext(i);e.api.deleteShapes(e.shapeList),t.cSld.spTree.shapeList=[];const o=Object(h.f)(t,r,n);this.request(Object(g.a)(l()(Object(g.a)(o).map((e=>e.invert(this.model))).reverse())))}))}))}removeSlidesWithSection(e){e.length&&this.transaction((()=>{const{slideList:t,sectionList:r}=this.model,i=new N(t,r,this.bindSectionToSlide.bind(this));i.setIgnoreSlides(e);for(const t of e)i.rebindBySlide(t.id);i.requestBindTask(),i.updateSectionList(this.model.sectionList),i.requestRenameTask(r.map((e=>e.props.name))),this.removeSlides(e)}))}removeLayouts(e){e.length&&(this.guard((t=>S.a.every((()=>S.a.forEach(e,(e=>S.a.page.should.haveNoStaleReference(t,e.id))))))),this.transaction((()=>{e.slice().sort(((e,t)=>this.model.layoutList.indexOf(t)-this.model.layoutList.indexOf(e))).forEach((e=>{this.transaction((()=>{const t=e.getWritableOwnedData(),r=e.getMaster();var i;const n=null!==(i=null==r?void 0:r.layoutList.indexOf(e))&&void 0!==i?i:-1;if(!t.cSld.spTree)return;const o=Object(T.c)(t.cSld.spTree.shapeList);if(t.timing){[...Object(T.d)(t.timing).entries()].forEach((([e,t])=>o.set(e,t)))}const a=this.createKeyframeContext(o);e.api.deleteShapes(e.shapeList),t.cSld.spTree.shapeList=[];const s=Object(h.a)(t,n,a);this.request(Object(g.a)(l()(Object(g.a)(s).map((e=>e.invert(this.model))).reverse())))}))}))})))}removeMasters(e){e.length&&(this.guard((t=>S.a.every((()=>S.a.forEach(e,(e=>S.a.page.should.haveNoStaleReference(t,e.id))))))),this.transaction((()=>{this.model.store.masterList.intersectSorted(e).forEach((e=>{const t=e.getWritableOwnedData();var r;const i=null!==(r=this.model.masterList.indexOf(e))&&void 0!==r?r:-1;if(!t.cSld.spTree)return;const n=Object(T.c)(t.cSld.spTree.shapeList);if(t.timing){[...Object(T.d)(t.timing).entries()].forEach((([e,t])=>n.set(e,t)))}const o=this.createKeyframeContext(n);e.api.deleteShapes(e.shapeList),t.cSld.spTree.shapeList=[];const a=Object(h.b)(t,i,o);this.transaction((()=>{this.request(Object(g.a)(l()(Object(g.a)(a).map((e=>e.invert(this.model))).reverse())))}))}))})))}removeNoteSlides(e){e.length&&this.transaction((()=>{[...this.model.noteSlideMap.values()].forEach((e=>{var t;const r=(null===(t=this.model.slideList.find((e=>e.id===o.slideId)))||void 0===t?void 0:t.getWritableOwnedData())||{id:"",cSld:{},type:f.a.Slide},o=e.getWritableOwnedData();if(!o.cSld.spTree)return;const a=Object(T.c)(o.cSld.spTree.shapeList),s=this.createKeyframeContext(a);e.api.deleteShapes(e.shapeList),o.cSld.spTree.shapeList=[];const c=Object(h.d)(o,Object(n.a)(Object(i.a)({},s),{page:r}));this.transaction((()=>{this.request(Object(g.a)(l()(Object(g.a)(c).map((e=>e.invert(this.model))).reverse())))}))}))}))}removeNodeSlideMasters(e){e.length&&(this.guard((t=>S.a.forEach(e,(e=>S.a.every((()=>S.a.page.should.haveNoStaleReference(t,e.id))))))),this.transaction((()=>{[...this.model.notesMasterMap.values()].forEach((e=>{const t=e.getWritableOwnedData();if(!t.cSld.spTree)return;const r=Object(T.c)(t.cSld.spTree.shapeList),i=this.createKeyframeContext(r);e.api.deleteShapes(e.shapeList),t.cSld.spTree.shapeList=[];const n=Object(h.e)(t,i);this.transaction((()=>{this.request(Object(g.a)(l()(Object(g.a)(n).map((e=>e.invert(this.model))).reverse())))}))}))})))}moveSlides(e,t){const r=this.model.store.slideList.intersectSorted(e);r.length&&this.transaction((()=>{let e=0;r.forEach((r=>{this.transaction((()=>{var i,n;const o=null!==(n=null===(i=r.getLayout())||void 0===i?void 0:i.id)&&void 0!==n?n:"",s=this.model.slideList.indexOf(r),l=s>=t?s:s-e;let c;s>=t?(c=t+e,e+=1):c=t-1,l!==c&&this.request([new C.a({pageId:r.id,pageType:a.Q.slide,srcParentPageId:o,srcIndex:l,destParentPageId:o,destIndex:c})])}))}))}))}moveSlidesWithSection(e,t){const r=this.model.store.slideList.intersectSorted(e);r.length&&this.transaction((()=>{if(r.length<=0)return;const{slideList:e,sectionList:i}=this.model,n=new N(e,i,this.bindSectionToSlide.bind(this));n.setIgnoreSlides(r);for(const e of r)n.rebindBySlide(e.id);n.rebindWhenInsertSlide(r[0].id,t);const o=t-this.getSectionIndexFromGap(t);this.moveSlides(r,o),n.requestBindTask(),n.updateSectionList(this.model.sectionList),n.requestRenameTask(i.map((e=>e.props.name)))}))}duplicatePages(e){if(!e.length)return;if(e.some((e=>![f.a.Slide,f.a.SlideLayout].includes(e.type))))return;if(1!==new Set(e.map((e=>e.type))).size)return;const t=e[0].type;t===f.a.Slide?this.duplicateSlides(e):t===f.a.SlideLayout&&this.duplicateLayouts(e)}moveLayouts(e,t,r){const i=this.getLayoutsMasterMap(e);0!==i.size&&this.transaction((()=>{for(const[e,n]of i.entries()){if(!n.length)continue;let i=0;e.store.layoutList.intersectSorted(n).forEach((n=>{this.transaction((()=>{const o=e.id,s=r.id,l=e===r,c=e.store.layoutList.findIndexById(n.id),d=c>=t?c:c-i;let u;c>=t?(u=t+i,i+=1):u=l?t-1:t,d===u&&l||this.request([new C.a({pageId:n.id,pageType:a.Q.slideLayout,srcParentPageId:o,srcIndex:d,destParentPageId:s,destIndex:u})])}))}))}}))}addSection(e,t){this.guard((r=>S.a.section.can.insertIntoGapPosition(r,e,t)));const r=this.model.getIDGenerator().next(),{sectionList:i,slideList:n}=this.model,o=this.getGapIndex(t);this.transaction((()=>{let t=0;for(let a=0;a<n.length+1;a+=1){const s=t,l=i.filter((e=>{var t;return e.props.firstSlideId===(null===(t=n[a])||void 0===t?void 0:t.id)}));if(t+=l.length,t+=1,t>o){const t=l.map((e=>e.props.name));t.splice(o-s,0,e),this.transaction((()=>{this.request([new b.a({sectionId:r,name:e}),new x.a({sectionId:r,firstSlideIndex:a})])}));const i=this.model.sectionList.filter((e=>{var t;return e.props.firstSlideId===(null===(t=n[a])||void 0===t?void 0:t.id)}));return void this.transaction((()=>{i.forEach(((e,r)=>{e.props.name!==t[r]&&e.api.updateProps({name:t[r]})}))}))}}}))}removeSections(e){e.length&&(this.guard((t=>S.a.forEach(e,(e=>S.a.section.should.exist(t,e.id))))),this.transaction((()=>{this.request(e.map((e=>new _.a({sectionId:e.id}))))})))}moveSection(e,t){const{sectionList:r,slideList:i}=this.model,n=r.findIndex((t=>t.id===e.id)),o=this.model.store.getSectionBindingSlideIndex(e),a=i.slice(o,o+e.props.numSlides),s=this.model.store.getSectionBindingSlideIndex(r[t]);this.transaction((()=>{const o=new N(i,r,this.bindSectionToSlide.bind(this));o.setIgnoreSlides(a);for(const e of a)o.rebindBySlide(e.id);const l=r.slice(0,t).reduce(((e,t)=>e+t.props.numSlides+1),0)-1;var c,d;a.length>0?(l>=0&&o.rebindWhenInsertSlide(a[0].id,l),o.addBindMutation(e,a[0].id)):(o.rebindBySlide(null===(c=r[t])||void 0===c?void 0:c.props.firstSlideId),o.addBindMutation(e,null===(d=r[t])||void 0===d?void 0:d.props.firstSlideId));const u=r.map((e=>e.props.name)),p=n>=t?t:t-1;Object(j.a)(u,n,p),this.moveSlides(a,s),o.requestBindTask(),o.updateSectionList(this.model.sectionList),o.requestRenameTask(u)}))}updateImageResourceMap(e,t){this.transaction((()=>{this.request([new w.a({resourceType:a.e.Image,id:e,imageDescriptor:t})])}))}updateVideoResourceMap(e,t){this.transaction((()=>{this.request([new w.a({resourceType:a.e.Video,id:e,videoDescriptor:t})])}))}updateAudioResourceMap(e,t){this.transaction((()=>{this.request([new w.a({resourceType:a.e.Audio,id:e,audioDescriptor:t})])}))}updateFontResourceMap(e,t){this.transaction((()=>{this.request([new w.a({resourceType:a.e.Font,id:e,fontDescriptor:t})])}))}updateResourceMap(e){this.transaction((()=>{e.audios&&Object.keys(e.audios).forEach((t=>!this.model.getAudioResourceById(t)&&this.updateAudioResourceMap(t,e.audios[t]))),e.images&&Object.keys(e.images).forEach((t=>!this.model.getImageResourceById(t)&&this.updateImageResourceMap(t,e.images[t]))),e.videos&&Object.keys(e.videos).forEach((t=>!this.model.getVideoResourceById(t)&&this.updateVideoResourceMap(t,e.videos[t]))),e.fonts&&Object.keys(e.fonts).forEach((t=>!this.model.getFontResourceById(t)&&this.updateFontResourceMap(t,e.fonts[t])))}))}updateThemeFontFamily(e){this.forEachInTransaction(this.model.themeList,(t=>{var r,i,n,o;const a=null===(o=this.model.store.data.defaultTextStyle)||void 0===o||null===(n=o.lvl1pPr)||void 0===n||null===(i=n.defRPr)||void 0===i||null===(r=i.ea)||void 0===r?void 0:r.typeface;a&&!O.a.shouldUseSchemeFont(a)&&(this.model.masterList.forEach((e=>e.api.useThemeFontInTextStyle())),this.useThemeFontInDefaultTextStyle()),t.api.updateThemeFontFamily(e,"major"),t.api.updateThemeFontFamily(e,"minor")}))}addTheme(e){this.guard((()=>S.a.forEach(e,(e=>S.a.theme.should.hasCorrectFormat(e)))));const t=e.filter((e=>e.name||e.themeElements)),r=new Map;return t.length?(t.length>0&&this.transaction((()=>{t.forEach((e=>{const t=this.model.getIDGenerator().next(),{name:i,themeElements:n={}}=e;r.set(e.id,t),void 0===n.clrScheme&&(n.clrScheme=p.themeElements.clrScheme),void 0===n.fontScheme&&(n.fontScheme=p.themeElements.fontScheme),void 0===n.fmtScheme&&(n.fmtScheme=p.themeElements.fmtScheme),this.request([new y.a({themeId:t,themeName:i||"",themeElements:n})])}))})),r):r}removeThemeById(e){this.guard((t=>S.a.theme.should.notUsedInMaster(t,e))),this.transaction((()=>{this.request([new v.a({themeId:e})])}))}updateSlideGuideList(e,t=!1){this.transaction((()=>{const r=new E.a({slideGuideList:{guide:e.map(((e,t)=>Object(n.a)(Object(i.a)({},e),{id:`${t+1}`})))}});r.invertible=t,this.request([r])}))}setThemeById(e,t,r){var i;null===(i=this.model.getThemeById(e))||void 0===i||i.api.updateTheme(t,r)}replacePresentation(e){this.transaction((()=>{this.removeSections(this.model.sectionList),this.removeSlides(this.model.slideList),this.removeLayouts(this.model.layoutList),this.removeMasters(this.model.masterList),this.model.themeList.map((e=>e.id)).forEach((e=>{[...this.model.notesMasterMap.values()].map((e=>e.props.themeId)).includes(e)||this.removeThemeById(e)}));const t=t=>{var r;return null!==(r=e[t])&&void 0!==r?r:this.model.store.data[t]};var r;this.request([new I.a({size:t("sldSz")}),new B.a({size:t("notesSz")}),new E.a({defaultTextStyle:t("defaultTextStyle"),tableStyleList:t("tblStyleList"),showSpecialPlsOnTitleSld:t("showSpecialPlsOnTitleSld"),firstSlideNum:t("firstSlideNum"),embeddedFontList:t("embeddedFontList")})]),this.updateSlideGuideList(null!==(r=e.slideGuideList)&&void 0!==r?r:[]),this.addPresentation(e,0)}))}updateCustomSlideSizeWithNoScale(e,t,r){const{cx:i,cy:n}=this.model.props.sldSz,o=t,a=e,s=a/i,l=o/n,c=Math.round((a-i)/2),d=Math.round((o-n)/2);this.transaction((()=>{this.request([new I.a({size:{cx:a,cy:o,type:r}})]),this.updateMasterAndLayoutWithScale(s,l,!1,!0);for(const e of this.model.slideList)for(const t of e.shapeList)this.moveShapeFrame(t,c,d)}))}updateCustomSlideSizeWithEnlargeOrReduce(e,t,r,i){const{cx:n,cy:o}=this.model.props.sldSz;if(n===e&&o===t)return;const a=e/n,s=t/o,l=r?a>=s:a<s;this.transaction((()=>{this.request([new I.a({size:{cx:e,cy:t,type:i}})]),this.updateMasterAndLayoutWithScale(a,s,!0,l);const r=e-n,c=t-o;for(const e of this.model.slideList)for(const t of e.shapeList)this.moveShapeFrameWithScale(t,l,r,c,a,s,n,o),this.scaleShape(t,l?a:s)}))}updateCustomSlideSizeWithScale(e,t,r,i){const{cx:n,cy:o}=this.model.props.sldSz;if(n===e&&o===t)return;const a=this.getMainDirectionIsX(e,t,r),s=e/n,l=t/o;this.transaction((()=>{this.request([new I.a({size:{cx:e,cy:t,type:i}})]),this.updateMasterAndLayoutWithScale(s,l,!0,a);const r=e-n,c=t-o;for(const e of this.model.slideList)for(const t of e.shapeList)this.moveShapeFrameWithScale(t,a,r,c,s,l,n,o),this.scaleShape(t,a?s:l)}))}scalePresentation(e,t,r,i,n,o){this.transaction((()=>{this.request([new I.a({size:{cx:e,cy:t,type:r}})]);for(const e of this.model.masterList)for(const t of e.shapeList)this.scaleShapeFrame(t,i,n),this.scaleShape(t,o);for(const e of this.model.layoutList)for(const t of e.shapeList)this.scaleShapeFrame(t,i,n),this.scaleShape(t,o);for(const e of this.model.slideList)for(const t of e.shapeList)this.scaleShapeFrame(t,i,n),this.scaleShape(t,o)}))}scaleShape(e,t){var r;const i=e.getPage().id,n=e.id;if(e.type===f.a.GroupShape&&this.adaptInnerGroupShape(i,e,t),e.type===f.a.Shape&&(null===(r=e.getOwnedData().txBody)||void 0===r?void 0:r.p)){const{txBody:r}=e.getOwnedData();r&&this.scaleTextBody(i,n,r,t)}if(e.type===f.a.GraphicalObjectFrameTable){const r=e.getCloneData();this.scaleTable(i,n,r,t,e)}if(e.type===f.a.GraphicalObjectFrameSmartArt){e.api.computeChildTransform({scaleX:t,scaleY:t})}}scaleTable(e,t,r,i,n){var o,a,s,l,c,d,u;if(null==r||null===(l=r.graphic)||void 0===l||null===(s=l.graphicData)||void 0===s||null===(a=s.tbl)||void 0===a||null===(o=a.tblGrid)||void 0===o?void 0:o.gridCol){var p,h,m,f;const e=[];let t=0;for(const n of null==r||null===(f=r.graphic)||void 0===f||null===(m=f.graphicData)||void 0===m||null===(h=m.tbl)||void 0===h||null===(p=h.tblGrid)||void 0===p?void 0:p.gridCol)n.w&&(n.w=n.w*i),e.push({index:t,width:n.w}),t+=1;n.api.setTableColWidths(e)}if(null==r||null===(u=r.graphic)||void 0===u||null===(d=u.graphicData)||void 0===d||null===(c=d.tbl)||void 0===c?void 0:c.tr){var g,b,v;const o=[];for(let n=0;n<(null==r||null===(v=r.graphic)||void 0===v||null===(b=v.graphicData)||void 0===b||null===(g=b.tbl)||void 0===g?void 0:g.tr.length);n++){var y,S,x,_;const a=null==r||null===(x=r.graphic)||void 0===x||null===(S=x.graphicData)||void 0===S||null===(y=S.tbl)||void 0===y?void 0:y.tr[n];a.h&&(a.h=a.h*i),null===(_=a.tc)||void 0===_||_.forEach(((r,o)=>r.txBody&&this.scaleTextBody(e,t,r.txBody,i,{row:n,col:o}))),o.push({index:n,height:a.h})}n.api.setTableRowHeights(o)}}scaleTextBody(e,t,r,i,n){var o,a,s;if(null===(o=r.p)||void 0===o?void 0:o.length){const o=Object(m.a)(r.p);o.forEach((e=>{var t,r;e.pPr&&this.scaleParagraphProperties(e.pPr,i),(null===(t=e.endParaRPr)||void 0===t?void 0:t.sz)&&(e.endParaRPr.sz=e.endParaRPr.sz*i),null===(r=e.egTextRun)||void 0===r||r.forEach((e=>{var t,r,n,o,a,s,l;(null===(r=e.r)||void 0===r||null===(t=r.rPr)||void 0===t?void 0:t.sz)&&(e.r.rPr.sz=e.r.rPr.sz*i),(null===(o=e.br)||void 0===o||null===(n=o.rPr)||void 0===n?void 0:n.sz)&&(e.br.rPr.sz=e.br.rPr.sz*i),(null===(s=e.fld)||void 0===s||null===(a=s.rPr)||void 0===a?void 0:a.sz)&&(e.fld.rPr.sz=e.fld.rPr.sz*i),(null===(l=e.fld)||void 0===l?void 0:l.pPr)&&this.scaleParagraphProperties(e.fld.pPr,i)}))})),this.transaction((()=>{n?this.request([new R.a(R.b.fromParagraphListData(o,e,t,n.col,n.row))]):this.request([new R.a(Object(M.b)(R.b.fromParagraphListData(o,e,t),"type"))])}))}if(r.lstStyle){const o=Object(m.a)(r.lstStyle);Object.keys(o).forEach((e=>{if("extLst"===e)return;const t=o[e];this.scaleParagraphProperties(t,i)})),this.transaction((()=>{n?this.request([new L.a(Object(M.b)(L.b.fromTextBodyProperties({lstStyle:null},e,t,n.col,n.row),"type")),new L.a(Object(M.b)(L.b.fromTextBodyProperties({lstStyle:o},e,t,n.col,n.row),"type"))]):this.request([new L.a(Object(M.b)(L.b.fromTextBodyProperties({lstStyle:null},e,t),"type")),new L.a(Object(M.b)(L.b.fromTextBodyProperties({lstStyle:o},e,t),"type"))])}))}if(null===(a=r.bodyPr)||void 0===a?void 0:a.normAutofit){const i=Object(m.a)(r.bodyPr);i.normAutofit&&(i.normAutofit.fontScale=void 0),this.request([new L.a(Object(M.b)(L.b.fromTextBodyProperties({bodyPr:null},e,t),"type")),new L.a(Object(M.b)(L.b.fromTextBodyProperties({bodyPr:i},e,t),"type"))])}if(null===(s=r.bodyPr)||void 0===s?void 0:s.spAutoFit){const n=Object(m.a)(r.bodyPr);n.bIns&&(n.bIns=n.bIns*i),n.lIns&&(n.lIns=n.lIns*i),n.rIns&&(n.rIns=n.rIns*i),n.tIns&&(n.tIns=n.tIns*i),this.transaction((()=>{this.request([new L.a(Object(M.b)(L.b.fromTextBodyProperties({bodyPr:null},e,t),"type")),new L.a(Object(M.b)(L.b.fromTextBodyProperties({bodyPr:n},e,t),"type"))])}))}}scaleParagraphProperties(e,t){var r,i,n,o;(null==e?void 0:e.indent)&&(e.indent=e.indent*t),(null==e?void 0:e.marL)&&(e.marL=e.marL*t),(null==e||null===(i=e.spcAft)||void 0===i||null===(r=i.spcPct)||void 0===r?void 0:r.val)&&(e.spcAft.spcPct.val=e.spcAft.spcPct.val*t),(null==e||null===(o=e.spcBef)||void 0===o||null===(n=o.spcPct)||void 0===n?void 0:n.val)&&(e.spcBef.spcPct.val=e.spcBef.spcPct.val*t)}adaptInnerGroupShape(e,t,r){var i;(null===(i=t.shapeList)||void 0===i?void 0:i.length)&&t.shapeList.forEach((t=>{var i;if(t.type===f.a.GroupShape&&this.adaptInnerGroupShape(e,t,r),t.type===f.a.Shape&&(null===(i=t.getOwnedData().txBody)||void 0===i?void 0:i.p)){const i=t.getOwnedData().txBody;i&&this.scaleTextBody(e,t.id,i,r)}}))}scaleShapeFrame(e,t,r){if(!e.getOwnedData().spPr.xfrm)return;var i;const{off:n,ext:o}=null!==(i=e.props.spPr.xfrm)&&void 0!==i?i:{},{left:a,top:s,width:l,height:c}=e.getFrame().scale(t,r).floor();e.api.updateTransform({off:n&&{x:a,y:s},ext:o&&{cx:l,cy:c}})}moveShapeFrame(e,t,r){if(!e.getOwnedData().spPr.xfrm)return;const{left:i,top:n}=e.getFrame().move(t,r).floor();e.api.updateTransform({off:{x:i,y:n}})}duplicateSlides(e){const t=this.model.store.slideList.intersectSorted(e),r=this.model.store.slideList.findIndexById(t[e.length-1].id)+1,i=t.map((e=>e.getCloneData()));this.addSlides(i,r)}duplicateLayouts(e){const t=this.getLayoutsMasterMap(e);0!==t.size&&this.transaction((()=>{const e=this.model.store.masterList.intersectSorted([...t.keys()]),r=e[e.length-1];if(!r)return;var i;const n=r.store.layoutList.intersectSorted(null!==(i=t.get(r))&&void 0!==i?i:[]);let o=r.store.layoutList.findIndexById(n[n.length-1].id)+1;for(const i of e){var a;const e=null!==(a=t.get(i))&&void 0!==a?a:[];if(!e.length)continue;const n=i.store.layoutList.intersectSorted(e).map((e=>e.getCloneData()));for(const e of n)e.masterId=r.id;r&&(this.addLayouts(n,o),o+=n.length)}}))}createKeyframeContext(e){return{presentation:this.model.store.data,idFactory:t=>{var r;return null!==(r=e.get(t))&&void 0!==r?r:t}}}getSectionIndexFromGap(e){const{sectionList:t}=this.model;let r=0,i=0;for(i=0;i<t.length;i+=1)if(r+=1,r+=t[i].props.numSlides,e<r)return i;return i}getGapIndex(e){const{slideList:t,sectionList:r}=this.model;return void 0===e?t.length+r.length:r.length>0?e+1:e}bindSectionToSlide(e,t){this.transaction((()=>{this.request([new x.a({sectionId:e.id,firstSlideIndex:t})])}))}createIdsMapFromPage(e){const t=new Map,r=this.model.getIDGenerator(),{spTree:i}=e.cSld;if(i){[...Object(T.a)(i.shapeList,r).entries()].forEach((([e,r])=>t.set(e,r)))}var n;(t.set(e.id,r.next()),i)&&(i.id=null!==(n=i.id)&&void 0!==n?n:`spTree_${e.id}`,t.set(i.id,r.next()));return t}useThemeFontInDefaultTextStyle(){const e=Array.from({length:9},((e,t)=>t+1)).reduce(((e,t)=>Object(n.a)(Object(i.a)({},e),{[`lvl${t}pPr`]:{defRPr:{latin:{typeface:"+mn-lt"},ea:{typeface:"+mn-ea"}}}})),{});this.updateProps({defaultTextStyle:e})}getMainDirectionIsX(e,t,r){const{cx:i,cy:n}=this.model.props.sldSz,o=e/i-1,a=t/n-1;return 0!==o&&(0===a||o<=a)}handleCrossOffset(e,t,r){return(t-e/2)*(r-1)}moveShapeFrameWithScale(e,t,r,i,n,o,a,s){if(!e.getOwnedData().spPr.xfrm)return;const{left:l,top:c}=e.getFrame().floor();let d=0,u=0;const p=t?n:o;t?(d=l*(p-1),u=this.handleCrossOffset(s,c,p),u+=i/2):(u=c*(p-1),d=this.handleCrossOffset(a,l,p),d+=r/2);const{left:h,top:m}=e.getFrame().move(d,u).floor(),{width:f,height:g}=e.getFrame().scale(p,p).floor();e.api.updateTransform({off:{x:h,y:m},ext:{cx:f,cy:g}})}getLayoutsMasterMap(e){const t=new Map;return e.forEach((e=>{const r=e.getMaster();var i;const n=null!==(i=t.get(r))&&void 0!==i?i:[];n.push(e),t.set(r,n)})),t}getValidSldSz(e){return e}scaleMaster(e,t,r,i){for(const n of this.model.masterList){for(const r of n.shapeList)this.scaleShapeFrame(r,e,t);r&&(this.scaleMasterTitleStyle(n,i),this.scaleMasterBodyStyle(n,i),this.scaleMasterOtherStyle(n,i))}}scaleMasterTitleStyle(e,t){var r,i;const n=e.getOwnedData(),o=this.getStyleScale(t);if(null===(i=n.txStyles)||void 0===i||null===(r=i.titleStyle)||void 0===r?void 0:r.lvl1pPr){const{defTabSz:t,defRPr:r}=n.txStyles.titleStyle.lvl1pPr,i=null==r?void 0:r.sz,a={};t&&d()(a,"titleStyle.lvl1pPr.defTabSz",t*o),i&&d()(a,"titleStyle.lvl1pPr.defRPr.sz",i*o),e.api.updateProps({txStyles:a})}}scaleMasterBodyStyle(e,t){var r;const i=e.getOwnedData(),n=this.getStyleScale(t),o=Object(m.a)(i.txStyles);if(null===(r=i.txStyles)||void 0===r?void 0:r.bodyStyle){for(let e=1;e<=9;e++){var a;const t=`lvl${e}pPr`,r=null===(a=i.txStyles)||void 0===a?void 0:a.bodyStyle[t];if(r){var s;const{defTabSz:e,defRPr:i,marL:a,indent:l,spcBef:c}=r,u=null==i?void 0:i.sz;e&&d()(o,`bodyStyle.${t}.defTabSz`,e*n),a&&d()(o,`bodyStyle.${t}.marL`,a*n),l&&d()(o,`bodyStyle.${t}.indent`,l*n),u&&d()(o,`bodyStyle.${t}.defRPr.sz`,u*n),(null==c||null===(s=c.spcPts)||void 0===s?void 0:s.val)&&d()(o,`bodyStyle.${t}.spcBef.spcPts.val`,c.spcPts.val*n)}}e.api.updateProps({txStyles:o})}}scaleMasterOtherStyle(e,t){var r;const i=e.getOwnedData(),n=this.getStyleScale(t),o=Object(m.a)(i.txStyles);if(null===(r=i.txStyles)||void 0===r?void 0:r.otherStyle){for(let e=1;e<=9;e++){var a;const t=`lvl${e}pPr`,r=null===(a=i.txStyles)||void 0===a?void 0:a.otherStyle[t];if(r){var s;const{defTabSz:e,defRPr:i,marL:a,indent:l,spcBef:c}=r,u=null==i?void 0:i.sz;e&&d()(o,`otherStyle.${t}.defTabSz`,e*n),a&&d()(o,`otherStyle.${t}.marL`,a*n),l&&d()(o,`otherStyle.${t}.indent`,l*n),u&&d()(o,`otherStyle.${t}.defRPr.sz`,u*n),(null==c||null===(s=c.spcPts)||void 0===s?void 0:s.val)&&d()(o,`otherStyle.${t}.spcBef.spcPts.val`,c.spcPts.val*n)}}e.api.updateProps({txStyles:o})}}scaleLayout(e,t,r){const i=this.getStyleScale(r);for(const r of this.model.layoutList)for(const o of r.shapeList)if(this.scaleShapeFrame(o,e,t),(null==o?void 0:o.type)===f.a.Shape){var n;const e=Object(m.a)(null===(n=o.getOwnedData())||void 0===n?void 0:n.txBody);if(null==e?void 0:e.lstStyle){const t=Object(m.a)(e.lstStyle);for(let e=1;e<=9;e++){const r=`lvl${e}pPr`,n=t[r];if(n){const{marL:e,indent:o,defRPr:a}=n,s=null==a?void 0:a.sz;e&&d()(t,`${r}.marL`,e*i),o&&d()(t,`${r}.indent`,o*i),s&&d()(t,`${r}.defRPr.sz`,s*i)}}o.api.updateTextStyles(t)}}}getStyleScale(e){return e}scalePresentationDefaultTextStyle(e){const t=Object(m.a)(this.model.getOwnedData().defaultTextStyle);if(t){for(let i=1;i<=9;i++){const n=`lvl${i}pPr`,o=null==t?void 0:t[n];if(o){var r;const{defTabSz:i,defRPr:a,marL:s,indent:l,spcBef:c}=o,u=null==a?void 0:a.sz;i&&d()(t,`${n}.defTabSz`,i*e),s&&d()(t,`${n}.marL`,s*e),l&&d()(t,`${n}.indent`,l*e),u&&d()(t,`${n}.defRPr.sz`,u*e),(null==c||null===(r=c.spcPts)||void 0===r?void 0:r.val)&&d()(t,`${n}.spcBef.spcPts.val`,c.spcPts.val*e)}}this.updateProps({defaultTextStyle:t})}}updateMasterAndLayoutWithScale(e,t,r,i){const n=i?e:t;this.scalePresentationDefaultTextStyle(n),this.scaleMaster(e,t,r,n),this.scaleLayout(e,t,n)}shallowClonePresentation(e){const t={};for(const[r,n]of Object.entries(e.layoutMap))t[r]=Object(i.a)({},n);return Object(n.a)(Object(i.a)({},e),{themeList:[...e.themeList],masterList:e.masterList.map((e=>Object(i.a)({},e))),layoutMap:t,slideList:e.slideList.map((e=>Object(i.a)({},e)))})}}Object(o.__decorate)([Object(P.a)()],U.prototype,"addPresentation",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateProps",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"resizeSlideSize",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateSlideSizeType",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addSlides",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addSlidesWithSection",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addLayouts",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addMasters",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addNotesMasterSlide",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addNoteSlide",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeSlides",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeSlidesWithSection",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeLayouts",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeMasters",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeNoteSlides",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeNodeSlideMasters",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"moveSlides",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"moveSlidesWithSection",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"duplicatePages",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"moveLayouts",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addSection",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeSections",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"moveSection",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateImageResourceMap",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateVideoResourceMap",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateAudioResourceMap",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateFontResourceMap",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateResourceMap",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateThemeFontFamily",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"addTheme",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"removeThemeById",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateSlideGuideList",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"setThemeById",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"replacePresentation",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateCustomSlideSizeWithNoScale",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateCustomSlideSizeWithEnlargeOrReduce",null),Object(o.__decorate)([Object(P.a)()],U.prototype,"updateCustomSlideSizeWithScale",null)},"03f2f6a0c1":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseAny=t.createSingleton=void 0,t.createSingleton=function(e){if(window.tdocsNetcheck){var t=window.tdocsNetcheck.getVersion();e.getVersion()>t&&(e.extendCallbacks(window.tdocsNetcheck.getCallbacks()),window.tdocsNetcheck.destory(),window.tdocsNetcheck=e,window.tdocsNetcheck.init())}else window.tdocsNetcheck=e,window.tdocsNetcheck.init();return window.tdocsNetcheck};t.promiseAny=function(e){return new Promise((function(t,r){var i=e.length;i||r(new AggregateError("null"));var n=[];e.forEach((function(e){e.then((function(e){return t(e)})).catch((function(e){i-=1,n.push(e),i||r(new AggregateError(n))}))}))}))}},"04ed9bbbb2":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r("1f69014a3c"),n=r("d7c625d1f2"),o=r("cf3340a08c"),a=r("3f9e0540b8");class s extends a.a{updateProps({spPr:e,nvPr:t,graphic:r,bwMode:n}){var o,a;return super.updateProps({spPr:e&&{xfrm:e.xfrm},nvPr:t&&Object(i.a)({},super.getCommonNonVisualPropsDelta(t)),graphicalObjectFrame:{graphic:r,bwMode:n},table:(null==r||null===(a=r.graphicData)||void 0===a||null===(o=a.tbl)||void 0===o?void 0:o.tblPr)&&r.graphicData.tbl.tblPr})}}Object(n.__decorate)([Object(o.a)()],s.prototype,"updateProps",null)},"0c1600b9fc":function(e,t,r){"use strict";var i,n,o,a,s,l,c,d,u;r.d(t,"a",(function(){return x})),function(e){e[e.New=0]="New",e[e.Sending=1]="Sending",e[e.Failed=2]="Failed",e[e.Sended=3]="Sended",e[e.Offline=4]="Offline"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Operation=1]="Operation",e[e.UndoRedo=2]="UndoRedo",e[e.Customize=3]="Customize"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.SendFailed=1]="SendFailed",e[e.Conflict=2]="Conflict",e[e.Offline=3]="Offline"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.ServerAccept=1]="ServerAccept",e[e.ServerRefuse=2]="ServerRefuse",e[e.ConflictRemove=3]="ConflictRemove",e[e.OfflineDuplicate=4]="OfflineDuplicate",e[e.Exception=5]="Exception",e[e.NetworkError=6]="NetworkError"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.ApplyNewChanges=1]="ApplyNewChanges",e[e.ConflictUndo=2]="ConflictUndo",e[e.ConflictApplyRemote=3]="ConflictApplyRemote",e[e.ConflictIndex=4]="ConflictIndex",e[e.ConflictRevert=5]="ConflictRevert",e[e.ConflictRedo=6]="ConflictRedo",e[e.Offline=7]="Offline",e[e.LocalOperation=8]="LocalOperation"}(s||(s={})),function(e){e[e.Default=0]="Default",e[e.ServerRefuse=1]="ServerRefuse"}(l||(l={})),function(e){e.ADD="add",e.REMOVE="remove",e.REPLACE="replace",e.MOVE="move"}(c||(c={})),function(e){e.GET="_get"}(d||(d={})),function(e){e.MERGE="merge"}(u||(u={}));var p,h,m,f,g,b,v,y,S=r("d7c625d1f2"),x=Object(S.__assign)(Object(S.__assign)({NONE:"none",FADE_IN:"fade_in",FADE_OUT:"fade_out",SCALE:"scale",APPEAR:"appear",DISAPPEAR:"disappear",FLY_IN:"fly_in",FLY_OUT:"fly_out",FLOAT_UP_IN:"float_up_in",FLOAT_UP_OUT:"float_up_out",FLOAT_DOWN_IN:"float_down_in",FLOAT_DOWN_OUT:"float_down_out",CUT_IN:"cut_in",CUT_OUT:"cut_out",ROTATE:"rotate",PLUSE:"pluse",SPREAD:"spread",ENTR_ROTATE:"entr_rotate",ENTR_SCALE:"entr_scale",EXIT_SPREAD:"exit_spread",EXIT_ROTATE:"exit_rotate",EXIT_SCALE:"exit_scale",ENTR_CENTER_REVOLVE:"entr_center_revolve",ENTR_GROW_TURN:"entr_grow_turn",ENTR_RISE_UP:"entr_rise_up",ENTR_SPINNER:"entr_spinner",ENTR_BASIC_ZOOM:"entr_basic_zoom",ENTR_STRETCH:"entr_stretch",EXIT_CENTER_REVOLVE:"exit_center_revolve",EXIT_SHRINK_TURN:"exit_shrink_turn",EXIT_SINK_DOWN:"exit_sink_down",EXIT_SPINNER:"exit_spinner",EXIT_BASIC_ZOOM:"exit_basic_zoom",EXIT_STRETCH:"exit_stretch",EXIT_COLLAPSE:"exit_collapse",ENTR_BOOMERANG:"entr_boomerang",ENTR_PINWHEEL:"entr_pinwheel",ENTR_BASIC_SWIVEL:"entr_basic_swivel",EXIT_BOOMERANG:"exit_boomerang",EXIT_PINWHEEL:"exit_pinwheel",EXIT_BASIC_SWIVEL:"exit_basic_swivel",EMPH_TRANSPARENCY:"emph_transparency"},{ARC:"arc",STRAIGHT_LINE:"straight_line",CYCLE:"cycle",SHAPE:"shape",TURN:"turn",CUSTOM:"custom"}),{ENTR_CREDITS:"entr_credits",EXIT_CREDITS:"exit_credits",ENTR_BLINDS:"entr_blinds",EXIT_BLINDS:"exit_blinds"}),_=1,T=10,O=6,P=2,C=42,I=47,w=8,E=26,j=12,A=55,L=45,k=53,D=43,R=31,M=37,B=49,N=23,F=17,U=50,q=25,G=35,V=19,z=9,W=3;(p={})[_]=x.APPEAR,p[T]=x.FADE_IN,p[C]=x.FLOAT_UP_IN,p[I]=x.FLOAT_DOWN_IN,p[P]=x.FLY_IN,p[j]=x.CUT_IN,p[A]=x.SPREAD,p[L]=x.ENTR_ROTATE,p[k]=x.ENTR_SCALE,p[D]=x.ENTR_CENTER_REVOLVE,p[R]=x.ENTR_GROW_TURN,p[M]=x.ENTR_RISE_UP,p[B]=x.ENTR_SPINNER,p[N]=x.ENTR_BASIC_ZOOM,p[F]=x.ENTR_STRETCH,p[q]=x.ENTR_BOOMERANG,p[G]=x.ENTR_PINWHEEL,p[V]=x.ENTR_BASIC_SWIVEL,p[W]=x.ENTR_BLINDS,(h={})[_]=x.DISAPPEAR,h[T]=x.FADE_OUT,h[P]=x.FLY_OUT,h[C]=x.FLOAT_UP_OUT,h[I]=x.FLOAT_DOWN_OUT,h[j]=x.CUT_OUT,h[A]=x.EXIT_SPREAD,h[L]=x.EXIT_ROTATE,h[k]=x.EXIT_SCALE,h[D]=x.EXIT_CENTER_REVOLVE,h[F]=x.EXIT_COLLAPSE,h[R]=x.EXIT_SHRINK_TURN,h[M]=x.EXIT_SINK_DOWN,h[B]=x.EXIT_SPINNER,h[N]=x.EXIT_BASIC_ZOOM,h[U]=x.EXIT_STRETCH,h[q]=x.EXIT_BOOMERANG,h[G]=x.EXIT_PINWHEEL,h[V]=x.EXIT_BASIC_SWIVEL,h[W]=x.EXIT_BLINDS,(m={})[O]=x.SCALE,m[w]=x.ROTATE,m[E]=x.PLUSE,m[z]=x.EMPH_TRANSPARENCY,(f={})[x.ENTR_RISE_UP]=.9,f[x.EXIT_SINK_DOWN]=.1,null===(g=null===window||void 0===window?void 0:window.navigator)||void 0===g||g.userAgent;!function(e){e[e.JS=0]="JS",e[e.JSON_PATCH=1]="JSON_PATCH"}(b||(b={})),function(e){e[e.DOWN=-1]="DOWN",e[e.UP=1]="UP",e[e.TOP=2]="TOP",e[e.BOTTOM=0]="BOTTOM"}(v||(v={})),function(e){e[e.DOWN=-1]="DOWN",e[e.UP=1]="UP",e[e.TOP=2]="TOP",e[e.BOTTOM=0]="BOTTOM"}(y||(y={}));var H,K;!function(e){e[e.Operation=0]="Operation",e[e.Recv=1]="Recv",e[e.UndoRedo=2]="UndoRedo",e[e.Merge=3]="Merge",e[e.Memory=4]="Memory"}(H||(H={})),function(e){e.backgroundPath="backgroundPath",e.foregroundPath="foregroundPath",e.backupPath="backupPath"}(K||(K={}));var $;!function(e){e[e.ResponseError=1]="ResponseError",e[e.CGIError=2]="CGIError",e[e.ResultError=3]="ResultError",e[e.ParamError=4]="ParamError",e[e.Timeout=5]="Timeout"}($||($={}))},"14bda16c18":function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("83ac05c555"),a=r.n(o),s=r("025e3e9b74"),l=r("ed0457c1f8"),c=r("16d54e1923");class d{init(e){var t,r;(this.presentation=e,this.events=this.presentation.getEvents(),this.idSeed)||(this.idSeed=null===(t=(r=this.presentation.getIDGenerator()).seed)||void 0===t?void 0:t.call(r));this.events.on(s.e.OperationBegin,((e,t)=>{try{this.firstSnapshot||(this.firstSnapshot=JSON.stringify(this.presentation.getOwnedData())),t.type===l.a.EnqueueMutations?this.records.push(t):this.runningCount<1&&(t.type===l.a.API?this.records.push(Object(n.a)(Object(i.a)({},t),{args:this.stringifyOperationArgs(t.args)})):this.records.push(t))}catch(e){console.error(e)}this.runningCount+=1})),this.events.on(s.e.OperationEnd,((e,t)=>{try{if(this.runningCount<=1){const e=a()(this.records,(e=>e.type!==l.a.EndTransaction&&e.type!==l.a.BeginTransaction&&e.type!==l.a.EnqueueMutations));e&&(e.endAt=t)}}catch(e){console.error(e)}this.runningCount-=1})),this.events.on(s.e.OperationError,(()=>{this.runningCount-=1})),this.events.on(s.e.BeginTransaction,(e=>{0===e&&this.runningCount<1&&this.records.push({type:l.a.BeginTransaction,beginAt:performance.now()})})),this.events.on(s.e.EndTransaction,(e=>{0===e&&this.runningCount<1&&this.records.push({type:l.a.EndTransaction,endAt:performance.now()})}))}export(){this.lastSnapshot=JSON.stringify(this.presentation.getOwnedData()),this.firstSnapshot||(this.firstSnapshot=JSON.stringify(this.presentation.getOwnedData()));const{firstSnapshot:e,lastSnapshot:t,idSeed:r,records:i}=this;return JSON.stringify({records:this.getParsedRecords(i),idSeed:r,firstSnapshot:JSON.parse(null!=e?e:""),lastSnapshot:JSON.parse(null!=t?t:"")})}getRecords(e,t){const r=this.records.slice(null!=e?e:0);return t?this.getParsedRecords(r.filter((e=>e.type===t))):this.getParsedRecords(r)}exportAndDownload(){try{const e=this.export(),t=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download="slide-operations.logs.json",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}catch(e){console.error(e)}}stringifyOperationArgs(e){try{return JSON.stringify(e,((e,t)=>t instanceof c.a?{id:t.store.data.id,type:t.store.data.type,isDataModel:!0}:t))}catch(e){return`args stringify error: ${e}`}}getParsedRecords(e){return e.map((e=>e.type===l.a.API?Object(n.a)(Object(i.a)({},e),{args:JSON.parse(e.args)}):e))}constructor(){this.records=[],this.runningCount=0}}},"182341de5a":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));let i=()=>({events:{},emit(e,...t){(this.events[e]||[]).forEach((e=>e(...t)))},on(e,t){return(this.events[e]=this.events[e]||[]).push(t),()=>this.events[e]=(this.events[e]||[]).filter((e=>e!==t))}})},"1a60256e28":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("8c0defe94d"),a=r("d7c625d1f2"),s=r("cf3340a08c"),l=r("285f8ccc4f"),c=r("a74785d12e"),d=r("04ed9bbbb2");class u extends d.a{updateProps({spPr:e,nvPr:t,graphic:r,bwMode:i}){return(null==e?void 0:e.xfrm)&&this.computeChildTransform({transform:null==e?void 0:e.xfrm}),super.updateProps({spPr:e,nvPr:t,graphic:r,bwMode:i})}computeChildTransform(e){var t,r,a;const{transform:s,scaleX:d,scaleY:u}=e;let p=void 0!==d?d:1,h=void 0!==u?u:1;if(s){var m,f,g,b,v,y,S,x,_;const e=null===(g=this.model.store)||void 0===g||null===(f=g.data)||void 0===f||null===(m=f.spPr)||void 0===m?void 0:m.xfrm;void 0!==(null==e||null===(b=e.ext)||void 0===b?void 0:b.cx)&&null!==(null===(v=s.ext)||void 0===v?void 0:v.cx)&&void 0!==(null===(y=s.ext)||void 0===y?void 0:y.cx)&&(p=s.ext.cx/e.ext.cx),void 0!==(null==e||null===(S=e.ext)||void 0===S?void 0:S.cy)&&null!==(null===(x=s.ext)||void 0===x?void 0:x.cy)&&void 0!==(null===(_=s.ext)||void 0===_?void 0:_.cy)&&(h=s.ext.cy/e.ext.cy)}if(1===p&&1===h)return;const T=null===(r=this.model.store.data)||void 0===r||null===(t=r.diagram)||void 0===t?void 0:t.drawing;if(!T)return;const O=Object(l.a)(null===(a=T.spTree)||void 0===a?void 0:a.egGroupShapeMsDsp);if(O&&O.length>0){const e=(e,t)=>Math.floor((e||0)*t)||0,t=(t,r,i,n)=>({off:{x:e(null==t?void 0:t.x,i),y:e(null==t?void 0:t.y,n)},ext:{cx:e(null==r?void 0:r.cx,i),cy:e(null==r?void 0:r.cy,n)}}),r=(e,t)=>{if(!e)return e;const r=Object(i.a)({},e);return void 0!==r.sz&&(r.sz=Math.floor(r.sz*t)),r},a=(e,t)=>e&&0!==e.length?e.map((e=>{const n=Object(i.a)({},e);return n.pPr&&(n.pPr=r(n.pPr,t)),n.egTextRun&&(n.egTextRun=n.egTextRun.map((e=>{var i;return(null==e?void 0:e.r)&&(null==e||null===(i=e.r)||void 0===i?void 0:i.rPr)&&(e.r.rPr=r(e.r.rPr,t)),e}))),n})):e;O.forEach(((e,r)=>{const{spPr:s,txXfrm:l,txBody:c}=e.sp;O[r]={sp:Object(n.a)(Object(i.a)({},e.sp),{spPr:((e,r,a)=>{if(!(null==e?void 0:e.xfrm))return e;const s=e.xfrm,{off:l,ext:c}=s,d=Object(o.a)(s,["off","ext"]);return Object(n.a)(Object(i.a)({},e),{xfrm:Object(i.a)({},d,t(l,c,r,a))})})(s,p,h),txXfrm:((e,r,n)=>{if(!e)return e;const{off:a,ext:s}=e,l=Object(o.a)(e,["off","ext"]);return Object(i.a)({},l,t(a,s,r,n))})(l,p,h),txBody:c?Object(n.a)(Object(i.a)({},c),{p:a(c.p,(p+h)/2)}):void 0})}}))}const P=Object(n.a)(Object(i.a)({},T),{spTree:Object(n.a)(Object(i.a)({},T.spTree),{egGroupShapeMsDsp:O})});return this.transaction((()=>{this.request([new c.a({shapeId:this.model.id,pageId:this.model.getPage().id,drawing:P})])}))}}Object(a.__decorate)([Object(s.a)()],u.prototype,"updateProps",null)},"1af4b2dbf4":function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("8c0defe94d"),a=r("711a53c9fc"),s=r("932627c190"),l=r.n(s),c=r("7df2e5fb1e"),d=r("420d598ff9"),u=r("fdddc95d9b"),p=r("22adaceb28"),h=r("27b8f08537");class m{static from(e){return new m(e)}static fromBufferOrBase64(e){const t=h.a.codec.decode(e,a.dc.CommandData);return new m(t)}static fromMutations(e){return this.fromValidMutationData(e.map((e=>e.toData())))}static fromMutationData(e){return new m({mutations:e})}static fromValidMutationData(e){return new m({mutations:e.map((e=>({type:e.type,[l()(a.c[e.type])]:e})))})}toBase64String(){const e=h.a.codec.encode(this.data,a.dc.CommandData);return c.a.fromUint8Array(e)}getCommandData(){return this.data}getMutations(){var e;return this.mutations||(this.mutations=Object(d.a)(this.getValidMutationData())),null!==(e=this.mutations)&&void 0!==e?e:[]}getValidMutationData(){var e;return(null!==(e=this.data.mutations)&&void 0!==e?e:[]).map((e=>{var{type:t}=e,r=Object(o.a)(e,["type"]);if(!t)throw new Error(`mutation type is not specified: ${JSON.stringify(r)}`);return Object(n.a)(Object(i.a)({},r[u.b[t]]),{type:t})}))}getMutationData(){var e;return null!==(e=this.data.mutations)&&void 0!==e?e:[]}validate(){return this.getValidMutationData().find((e=>!Object(p.a)(e)))}constructor(e){this.data=Object(i.a)({mutations:[]},e)}}},"1ce94b3b3e":function(e,t,r){"use strict";r.d(t,"b",(function(){return P})),r.d(t,"a",(function(){return C}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d1961e40df"),a=r.n(o),s=r("67d3be6cf9"),l=r.n(s),c=r("98efcda99e"),d=r.n(c),u=r("262843d1f7"),p=r("7c46f42788"),h=r("9559b6ab8e"),m=r("78db0f5ada"),f=r("215eaa3247"),g=r("b2a64db471"),b=r("182acadcf2"),v=r("9541c1076d"),y=r.n(v),S=r("ee6bb53310"),x=r.n(S),_=r("711a53c9fc"),T=r("a8241196a7");const O={frame:["adj1"],mathPlus:["adj1"],mathMinus:["adj1"],mathMultiply:["adj1"],hexagon:["adj","vf"],star5:["adj","hf","vf"],star6:["adj","hf"],star7:["adj","hf","vf"],star10:["adj","hf"]};function P(e,{sessionId:t="",useRandomId:r}={}){return(new C).migratePresentation(e,t,r)}class C{updateConnectionsId(){for(const e of this.ctx.connections)e.id=this.getId(e.id,"shape",!1)}migrateGuideList(e){return(null==e?void 0:e.length)?e.map(((e,t)=>this.migrateGuide(e,t))).filter(Boolean):[]}migrateGuide(e,t){if(!e)return;const r={id:`${t+1}`};return l()(e.orient)||(r.orient=_.u[e.orient]),l()(e.pos)||(r.pos=e.pos),l()(e.color)||(r.clr=this.migrateColor({colorType:"rgb",colorValue:e.color})),r}migrateNoteSlide(e){if(e.noteData){const t=this.getNoteSlideId(e);return this.ctx.page={id:t,type:"note"},{id:t,slideId:this.getPageId(e),type:p.a.Notes,cSld:{name:"",spTree:{id:this.createShapeId("spTree"),type:p.a.GroupShape,nvPr:{},spPr:{xfrm:{off:{x:0,y:0},ext:{cx:0,cy:0},chOff:{x:0,y:0},chExt:{cx:0,cy:0}}},shapeList:[y()(this.migrateShape(e.noteData.note),{nvPr:{ph:{type:_.U.body}}})]}}}}}getPageId({id:e,type:t},r=!1){return this.getId([t,e].join(this.idSep),t,r)}createShapeId(e){return this.getShapeId(e,!0)}getShapeId(e,t=!1){var r,i;return e?this.getId([null===(r=this.ctx.page)||void 0===r?void 0:r.type,null===(i=this.ctx.page)||void 0===i?void 0:i.id,e].join(this.idSep),"shape",t):this.createShapeId(u.d.next())}getNoteSlideId(e){if(null==e?void 0:e.noteData)return this.getId(this.getPreNoteId(e),"note")}isNoteSlideIdExisted(e){return!!this.ctx.idsMap[this.getPreNoteId(e)]}getPreNoteId(e){return[e.type,"note",e.id].join(this.idSep)}getId(e,t,r=!1){if(!e)return this.getId(u.d.next(),t);if(this.ctx.idsMap[e]){if(r)return this.getId(u.d.next(),t)}else if(this.useRandomId)this.ctx.idsMap[e]=u.e.next(8);else{const r=[t,String(this.idGenerator.next()).padStart(8,"0")].join("_");this.ctx.idsMap[e]=[this.ctx.sessionId,r].filter(Boolean).join(this.idSep)}return this.ctx.idsMap[e]}getExtname(e){const t=e.lastIndexOf(".");return t>=0?e.slice(t):""}getNumberWithMinPrecision(e){return Number(e.toFixed(0))}fromRgbHexString(e){function t(e){return e.toString(16).padStart(2,"0").toUpperCase()}const r=parseInt(e.toLowerCase().replace(/[^0-9a-f]/g,""),16),i=(65280&r)>>8,n=255&r;return`${t((16711680&r)>>16)}${t(i)}${t(n)}`}resetLayoutId(e){e.slideList.forEach((t=>{e.layoutMap[t.layoutId]||(t.layoutId=Object.keys(e.layoutMap)[0])}))}constructor(){this.idSep="__",this.idGenerator=new u.a,this.useRandomId=!1,this.migratePresentation=(e,t,r=!1)=>{var o,a,s,l,c,d,u,h,m,f,g,b,v,y,S,x,_,T,O,P,C,I,w,E;this.useRandomId=r,this.ctx.presentation=e,this.ctx.sessionId=t,this.ctx.defaultFont=null!==(_=null===(c=e.defaultTextStyleList)||void 0===c||null===(l=c[0])||void 0===l||null===(s=l.defaultRunProps)||void 0===s||null===(a=s.font)||void 0===a||null===(o=a.ea)||void 0===o?void 0:o.typeface)&&void 0!==_?_:"",e.resource=Object(n.a)(Object(i.a)({},e.resource),{imageResource:Object(n.a)(Object(i.a)({},null===(d=e.resource)||void 0===d?void 0:d.imageResource),{resourceMap:Object(i.a)({},null===(h=e.resource)||void 0===h||null===(u=h.imageResource)||void 0===u?void 0:u.resourceMap)}),audioResource:Object(n.a)(Object(i.a)({},null===(m=e.resource)||void 0===m?void 0:m.audioResource),{resourceMap:Object(i.a)({},null===(g=e.resource)||void 0===g||null===(f=g.audioResource)||void 0===f?void 0:f.resourceMap)}),videoResource:Object(n.a)(Object(i.a)({},null===(b=e.resource)||void 0===b?void 0:b.videoResource),{resourceMap:Object(i.a)({},null===(y=e.resource)||void 0===y||null===(v=y.videoResource)||void 0===v?void 0:v.resourceMap)})}),e.slideList=(null!==(T=e.slideList)&&void 0!==T?T:[]).filter(Boolean),e.layoutList=(null!==(O=e.layoutList)&&void 0!==O?O:[]).filter(Boolean),e.masterList=(null!==(P=e.masterList)&&void 0!==P?P:[]).filter(Boolean),e.themeList=(null!==(C=e.themeList)&&void 0!==C?C:[]).filter(Boolean),e.sectionList=null!==(I=e.sectionList)&&void 0!==I?I:[];const j={version:"3.0",type:p.a.Presentation,id:this.getId("root","presentation"),firstSlideNum:e.firstSlideNum,slideList:this.migrateSlideList(e.slideList),layoutMap:this.migrateLayoutList(e.layoutList),noteSlideMap:e.slideList.reduce(((e,t)=>{const r=this.migrateNoteSlide(t);return(null==r?void 0:r.id)&&(e[r.id]=r),e}),{}),notesMasterMap:null!==(w=null===(S=e.notesMasterList)||void 0===S?void 0:S.reduce(((e,t)=>{const r=this.migratePage(t,p.a.NotesMaster);return(null==r?void 0:r.id)&&(e[r.id]=r),e}),{}))&&void 0!==w?w:{},masterList:this.migrateMasterList(e.masterList,e.layoutList),themeList:this.migrateThemeList(e.themeList),sectionMap:this.migrateSectionList(e.sectionList),resourceMap:this.migrateResourceMap(e.resource),sldSz:this.migrateSlideSize(e),notesSz:{cx:6858e3,cy:9144e3},defaultTextStyle:this.migrateTextStyleList(e.defaultTextStyleList),tblStyleList:this.migrateTblStyleList(e.tblStyleList),showSpecialPlsOnTitleSld:null!==(E=e.showSpecialPlsOnTitleSld)&&void 0!==E?E:Boolean(e.showSpecialPlsOnTitleSld),slideGuideList:this.migrateGuideList(null===(x=e.guides)||void 0===x?void 0:x.slideGuides)};return this.updateConnectionsId(),this.resetLayoutId(j),j},this.migrateSlideSize=e=>{const t=e.slideWidth/e.slideHeight;let r="custom";return t===4/3?r="screen4x3":t===16/9?r="screen16x9":1.6===t&&(r="screen16x10"),{cx:e.slideWidth,cy:e.slideHeight,type:_.jb[r]}},this.migrateTblStyleList=e=>{if(l()(e))return;const t={};return l()(e.def)||(t.def=e.def),l()(e.tableStyleEntryList)||(t.tblStyle=e.tableStyleEntryList.map((e=>this.migrateTableStyle(e)))),t},this.migrateTableStyle=e=>{const t={};return l()(e.styleName)||(t.styleName=e.styleName),l()(e.styleId)||(t.styleId=e.styleId),["wholeTbl","band1H","band2H","band1V","band2V","lastCol","firstCol","lastRow","firstRow"].forEach((r=>{l()(e[r])||(t[r]=this.migrateTablePartStyle(e[r]))})),t},this.migrateTablePartStyle=e=>{const t={};return l()(e.tcTxStyle)||(t.tcTxStyle=this.migrateTableCellTextStyle(e.tcTxStyle)),l()(e.tcStyle)||(t.tcStyle=this.migrateTableCellStyle(e.tcStyle)),t},this.migrateTableCellStyle=e=>{const t={};return l()(e.tcBdr)||(t.tcBdr=this.migrateTableBorder(e.tcBdr)),l()(e.fill)||(t.fill=this.migrateBackground(e.fill)),t},this.migrateTableBorder=e=>{const t={};return["bottom","insideH","insideV","left","right","top","tl2br","tr2bl"].forEach((r=>{var i;l()(null===(i=e[r])||void 0===i?void 0:i.ln)||(t[r]=this.migrateOutline(e[r].ln))})),t},this.migrateTableCellTextStyle=e=>{const t={};return l()(e.b)||(t.b=_.O[e.b]),l()(e.i)||(t.i=_.O[e.i]),l()(e.color)||Object.assign(t,this.migrateColor(e.color)),l()(e.fontRef)||(t.fontRef=this.migrateFontRef(e.fontRef)),t},this.migrateFontRef=e=>{const t={};return l()(e.color)||Object.assign(t,this.migrateColor(e.color)),l()(e.idx)||(t.idx=_.z[e.idx]),t},this.migrateSlideList=e=>e.filter(Boolean).map((e=>this.migratePage(e,p.a.Slide))),this.migrateLayoutList=e=>{const t={};return e.forEach((e=>{e.masterId&&(t[this.getPageId(e)]=this.migratePage(e,p.a.SlideLayout))})),t},this.migrateMasterList=(e,t)=>{const r=[];for(const i of e){const e=this.migratePage(i,p.a.SlideMaster);e.layoutIdList=t.filter((t=>this.getPageId({id:t.masterId,type:"master"})===e.id)).map((e=>this.getPageId(e))),r.push(e)}return r},this.migrateThemeList=e=>{const t=new Map;for(const r of e)t.has(r.id)||t.set(r.id,r);return Array.from(t.values()).map(this.migrateTheme).concat(this.ctx.themeList)},this.migrateSectionList=e=>(null==e?void 0:e.length)?(this.ctx.section={currentSlideIndex:0},Object.fromEntries(e.filter(Boolean).map(this.migrateSection).map((e=>[e.id,e])))):{},this.migratePage=(e,t)=>{this.ctx.page=e;const r={id:this.getPageId(e,t===p.a.Slide),type:t};if(e.layoutId&&(r.layoutId=this.getPageId({id:e.layoutId,type:"layout"})),e.masterId&&(r.masterId=this.getPageId({id:e.masterId,type:"master"})),e.themeId)if(t!==p.a.SlideMaster&&t!==p.a.NotesMaster||!this.ctx.idsMap[e.themeId])r.themeId=this.getId(e.themeId,"theme");else{var o;const t=null!==(o=this.ctx.presentation.themeList.find((t=>t.id===e.themeId)))&&void 0!==o?o:{},a=this.getId(t.id,"theme",!0);this.ctx.themeList.push(this.migrateTheme(Object(n.a)(Object(i.a)({},t),{id:a}))),r.themeId=this.getId(a,"theme")}var a;if("slide"===e.type&&(r.show=0!==e.show),"layout"!==e.type&&"slide"!==e.type||(r.showMasterSp=0!==e.showMasterSp),r.cSld=this.migrateCommonSlideData(null!==(a=e.slideData)&&void 0!==a?a:{name:"",groupShape:{shapeList:[],type:"groupShape"}}),e.clrMap&&(r.clrMap=this.migrateColorMap(e.clrMap)),"master"!==e.type&&"notesMaster"!==e.type){var s;const t={};(null==e||null===(s=e.clrMapOvr)||void 0===s?void 0:s.overrideClrMapping)?t.overrideClrMapping=this.migrateColorMap(e.clrMapOvr.overrideClrMapping):t.masterClrMapping=!0,r.clrMapOvr=t}r.timing=this.migrateTiming(e.timing,r.id),e.noteData&&!this.isNoteSlideIdExisted(e)&&(r.noteSlideId=this.getNoteSlideId(e)),e.headerFooter&&(r.hf=this.migrateHeaderFooter(e.headerFooter));const{titleTextStyleList:l,bodyTextStyleList:c,otherTextStyleList:d}=e;(l||c||d)&&(r.txStyles=this.migrateTextStyle(e));const u=(e,t)=>{var r,i;return null!==(i=null==t||null===(r=t.find((t=>t.id===e)))||void 0===r?void 0:r.guides)&&void 0!==i?i:[]};var h,m,f,g;t===p.a.SlideLayout&&(r.slideGuideList=this.migrateGuideList(u(e.id,null===(m=this.ctx.presentation)||void 0===m||null===(h=m.guides)||void 0===h?void 0:h.layoutGuides)));t===p.a.SlideMaster&&(r.slideGuideList=this.migrateGuideList(u(e.id,null===(g=this.ctx.presentation)||void 0===g||null===(f=g.guides)||void 0===f?void 0:f.masterGuides)));return r},this.migrateTextStyle=e=>{const t={};return l()(e.titleTextStyleList)||(t.titleStyle=this.migrateTextStyleList(e.titleTextStyleList)),l()(e.bodyTextStyleList)||(t.bodyStyle=this.migrateTextStyleList(e.bodyTextStyleList)),l()(e.otherTextStyleList)||(t.otherStyle=this.migrateTextStyleList(e.otherTextStyleList)),t},this.migrateHeaderFooter=e=>{const t={};return l()(e.sldNum)||(t.sldNum=Boolean(e.sldNum)),l()(e.datetime)||(t.dt=Boolean(e.datetime)),l()(e.header)||(t.hdr=Boolean(e.header)),l()(e.footer)||(t.ftr=Boolean(e.footer)),t},this.migrateTimingHierarchy=(e,t,r)=>{var n,o,a,s;if(null==e||null===(o=e.type)||void 0===o||null===(n=o.startsWith)||void 0===n?void 0:n.call(o,"tn_")){var c;const t={tn_set:()=>({set:r(e)}),tn_anim:()=>({anim:r(e)}),tn_animEffect:()=>({animEffect:r(e)}),tn_animMotion:()=>({animMotion:r(e)}),tn_animRot:()=>({animRot:r(e)}),tn_animScale:()=>({animScale:r(e)}),tn_cmd:()=>{const t={cBhvr:e.cBhvr,type:_.xb[e.cmdType],cmd:e.cmdName};return{cmd:r(t)}}},{type:i}=e;d()(e,"type");const n=null===(c=t[i])||void 0===c?void 0:c.call(t);if(n)return n}if(!l()(null==e?void 0:e.presetID)){const t=e.presetID;return delete e.presetID,Object(i.a)({presetId:t},r(e))}if(null==e?void 0:e.tavlst){const t=e.tavlst;return delete e.tavlst,Object(i.a)({tavLst:{tav:t.filter(Boolean).map((e=>r(e)))}},r(e))}if(null==e||null===(s=e.cBhvr)||void 0===s||null===(a=s.cTn)||void 0===a?void 0:a.by){var u,p;const{by:t}=e.cBhvr.cTn;return null==e||(null===(p=e.cBhvr)||void 0===p||(null===(u=p.cTn)||void 0===u||delete u.by)),Object(i.a)({by:String(t)},r(e))}if("stCondLst"===t)return{cond:e.map((e=>r(e))).filter(Boolean)};if("childTnLst"===t)return{egTimeNodeChoice:e.map((e=>r(e))).filter(Boolean)};if("attrNameLst"===t)return{attrName:e.map((e=>r(e)))};if("to"===t&&e.toStrVal){if(e.toStrVal)return{strVal:{val:String(e.toStrVal)}};if(e.toFltVal)return{fltVal:{val:e.toFltVal}};if(e.toBoolVal)return{fltVal:{val:e.toBoolVal}};if(e.toIntVal)return{fltVal:{val:e.toIntVal}};if(e.clrVal)return{fltVal:{val:e.clrVal}}}return(null==e?void 0:e.strValue)?{strVal:{val:e.strValue.strValue}}:(null==e?void 0:e.fltValue)?{fltVal:{val:e.fltValue.fltValue}}:(null==e?void 0:e.toBoolValue)?{boolVal:{val:e.toBoolValue}}:(null==e?void 0:e.toIntValue)?{intVal:{val:e.toIntValue}}:(null==e?void 0:e.clrVal)?{clrVal:{val:e.clrVal}}:void 0},this.migrateTimingKeySpell=(e,t)=>({accumulate:_.tb[e],additive:_.ub[e],calcmode:_.mb[e],clrSpc:_.pb[e],dir:_.ob[e],evt:_.Eb[e],fill:_.yb[e],fromSeqType:_.Db[e],masterRel:_.zb[e],nodeType:_.Db[e],origin:_.rb[e],override:_.vb[e],pathEditMode:_.sb[e],presetClass:_.Ab[e],restart:_.Bb[e],seqType:_.Db[e],syncBehavior:_.Cb[e],transition:_.qb[e],val:_.Fb[e],valueType:_.nb[e],xfrmType:_.wb[e]}[t]),this.transformChildTn=e=>a()(e,((e,t)=>{if(l()(e))return e;if(e.id&&d()(e,"id"),e.spid){var r,i;const t=[null===(r=this.ctx.page)||void 0===r?void 0:r.type,null===(i=this.ctx.page)||void 0===i?void 0:i.id,e.spid].join(this.idSep);this.ctx.idsMap[t]?e.spid=this.getShapeId(e.spid):e.spid=""}if("delay"===t||"dur"===t)return String(e);const n=this.migrateTimingHierarchy(e,t,this.transformChildTn);if(n)return n;const o=this.migrateTimingKeySpell(e,t);return o||void 0})),this.migrateTiming=(e,t)=>{const r={},o={};if(null==e?void 0:e.tmRoot){var a,s,l,c,d;const t=e=>{var t;const{nodeType:r}=null!==(t=e.cTn)&&void 0!==t?t:{};if(r===_.Db.mainSeq)return h.q;if(r===_.Db.interactiveSeq){var i,n,o;const t=null===(o=e.nextCondLst)||void 0===o||null===(n=o[0].tgtEl)||void 0===n||null===(i=n.spTgt)||void 0===i?void 0:i.spid;if(t)return t;if(e.nextCondLst)return h.q}};null===(d=[{cTn:Object(n.a)(Object(i.a)({},e.tmRoot),{nodeType:_.Db.tmRoot,childTnLst:{egTimeNodeChoice:null==e||null===(s=e.tmRoot)||void 0===s||null===(a=s.childTnLst)||void 0===a?void 0:a.filter(Boolean).map((e=>({seq:this.transformChildTn(e)})))}})}][0].cTn)||void 0===d||null===(c=d.childTnLst)||void 0===c||null===(l=c.egTimeNodeChoice)||void 0===l||l.forEach((({seq:e})=>{const i=t(e);if(!i)return;r[i]||(r[i]={type:i===h.q?_.Db.mainSeq:e.cTn.nodeType,unitTimeNodeList:[]});const{unitTimeNodeList:n}=r[i],a=e.cTn.childTnLst.egTimeNodeChoice;for(const e of a){const t=e.cTn.childTnLst.egTimeNodeChoice;for(const e of t){const t=e.cTn.childTnLst.egTimeNodeChoice;for(const e of t){var s,l,c,d,u,p,f,g;const t={par:e},r=m.a.getShapeId(t);if(r&&((null===(l=t.par)||void 0===l||null===(s=l.cTn)||void 0===s?void 0:s.presetId)&&(null===(d=t.par)||void 0===d||null===(c=d.cTn)||void 0===c?void 0:c.presetClass)&&!(null===(p=t.par)||void 0===p||null===(u=p.cTn)||void 0===u?void 0:u.presetSubtype)&&(t.par.cTn.presetSubtype=0),n.push(t),(null===(g=t.par)||void 0===g||null===(f=g.cTn)||void 0===f?void 0:f.presetClass)===_.Ab.mediacall)){const e=`${h.t}${r}`;o[e]||(o[e]=0),o[e]+=1}}}}}))}for(const e of Object.keys(this.ctx.mediaIdTimingMap))r[e]={type:_.Db.interactiveSeq,unitTimeNodeList:[Object(n.a)(Object(i.a)({},this.ctx.mediaIdTimingMap[e]),{referenceCount:o[e]})]};return this.ctx.mediaIdTimingMap={},{id:`${h.x}:${t}`,type:p.a.Timing,unitTimeNodeMap:r}},this.migrateCommonSlideData=e=>{var t;return{name:null!==(t=e.name)&&void 0!==t?t:"",spTree:Object(n.a)(Object(i.a)({},this.migrateGroupShape(e.groupShape)),{id:this.createShapeId("spTree"),nvPr:{},spPr:{xfrm:{off:{x:0,y:0},ext:{cx:0,cy:0},chOff:{x:0,y:0},chExt:{cx:0,cy:0}}}}),bg:e.background&&this.migrateSlideBackground(e.background)}},this.migrateSlideBackground=e=>{if(!e||Object.keys(e).length<=0)return;const t={},r=this.migrateBackground(e);return Object.keys(r).length<=0?void 0:(t.bgPr=r,t)},this.migrateGroupShape=e=>{const t=this.migrateCommonNonVisualProps({props:Object(f.b)(e.props,"placeholder"),name:e.name,hidden:e.hidden,locks:e.locks}),r=this.migrateCommonShapeProperties(e.props);var i;return{id:this.createShapeId(e.id),type:p.a.GroupShape,shapeList:(null!==(i=e.shapeList)&&void 0!==i?i:[]).map(this.migrateElement).filter(Boolean),nvPr:t,spPr:r}},this.migrateConnector=e=>{var t;const r=this.migrateCommonNonVisualProps({props:e.props,name:e.name,hidden:e.hidden,locks:e.locks});if(!l()(null===(t=e.props)||void 0===t?void 0:t.cxnSpProps)){const{stCxn:t,endCxn:i}=e.props.cxnSpProps;l()(null==t?void 0:t.id)&&l()(null==t?void 0:t.index)||(r.stCxn=this.migrateConnectorPoint(t)),l()(null==i?void 0:i.id)&&l()(null==i?void 0:i.index)||(r.endCxn=this.migrateConnectorPoint(i))}const i=this.migrateCommonShapeProperties(e.props);return{id:this.createShapeId(e.id),type:p.a.Connector,nvPr:r,spPr:i}},this.migrateConnectorPoint=e=>{const t={};var r,i;l()(e.id)||(t.id=[null===(r=this.ctx.page)||void 0===r?void 0:r.type,null===(i=this.ctx.page)||void 0===i?void 0:i.id,e.id].join(this.idSep),this.ctx.connections.push(t));return l()(e.index)||(t.idx=e.index),t},this.migratePicture=e=>{const t=this.createShapeId(e.id);let r=this.migrateCommonNonVisualProps({props:e.props,name:e.name,hidden:e.hidden,locks:e.locks});l()(e.relativeResize)||(r.preferRelativeResize=Boolean(e.relativeResize));const i=this.migrateCommonShapeProperties(e.props,!0);let n={};return l()(e.image)||(n=this.migratePictureBlipFill(e.image)),l()(e.audio)&&l()(e.video)||(r=this.migratePictureMediaNode(e,r)),{id:t,type:p.a.Picture,nvPr:r,spPr:i,blipFill:n}},this.migrateLocking=e=>{const t={};return l()(e.noGrp)||(t.noGrp=Boolean(e.noGrp)),l()(e.noMove)||(t.noMove=Boolean(e.noMove)),l()(e.noChangeAspect)||(t.noChangeAspect=Boolean(e.noChangeAspect)),l()(e.noResize)||(t.noResize=Boolean(e.noResize)),l()(e.noSelect)||(t.noSelect=Boolean(e.noSelect)),l()(e.noAdjustHandles)||(t.noAdjustHandles=Boolean(e.noAdjustHandles)),l()(e.noChangeArrowheads)||(t.noChangeArrowheads=Boolean(e.noChangeArrowheads)),l()(e.noChangeShapeType)||(t.noChangeShapeType=Boolean(e.noChangeShapeType)),l()(e.noCrop)||(t.noCrop=Boolean(e.noCrop)),l()(e.noEditPoints)||(t.noEditPoints=Boolean(e.noEditPoints)),l()(e.noRot)||(t.noRot=Boolean(e.noRot)),l()(e.noUngrp)||(t.noUngrp=Boolean(e.noUngrp)),l()(e.noTextEdit)||(t.noTextEdit=Boolean(e.noTextEdit)),t},this.migratePictureBlipFill=e=>{const t={};if(!l()(e.src)){const t=this.addImageResource(e.src);t&&(e.src=t)}return l()(e.blip)||(t.blip=this.migratePictureBlip(e.blip,e.src)),l()(e.blip)&&!l()(e.src)&&(t.blip={embed:e.src}),l()(e.srcRect)||(t.srcRect=this.migratePictureRect(e.srcRect)),l()(e.stretch)&&l()(e.tile)?t.egFillModeProperties=this.migratePictureMode({stretch:{fillRect:{}}}):t.egFillModeProperties=this.migratePictureMode(e),l()(e.rotWithShape)||(t.rotWithShape=Boolean(e.rotWithShape)),t},this.migratePictureMediaNode=(e,t)=>{var r,o;if(!e.audio&&!e.video)return t;const{presentation:a}=this.ctx,s=e.audio||e.video,c=e.audio?"audioResource":"videoResource";(null==a||null===(o=a.resource)||void 0===o||null===(r=o[c])||void 0===r?void 0:r.resourceMap)&&s.link&&(a.resource[c].resourceMap[s.link]={src:s.link,format:s.format,size:s.size,isExternal:Boolean(s.isExternal)});const d={cTn:s.tmNode,vol:s.volume,mute:Boolean(s.mute),numSld:s.slideCount,showWhenStopped:Boolean(s.showWhenStopped)};if(!l()(e.video)){const t={video:{cMediaNode:d,fullScrn:Boolean(e.video.fullScrn)}};this.ctx.mediaIdTimingMap[`${h.t}${this.getShapeId(e.id)}`]=t}if(!l()(e.audio)){const t={audio:{cMediaNode:d}};this.ctx.mediaIdTimingMap[`${h.t}${this.getShapeId(e.id)}`]=t}var u,p;return Object(n.a)(Object(i.a)({},t),{egMedia:{videoFile:e.video&&{link:null!==(u=s.link)&&void 0!==u?u:""},audioFile:e.audio&&{link:null!==(p=s.link)&&void 0!==p?p:""}}})},this.migratePictureRect=e=>{const t={};return l()(e.b)||(t.b=this.getNumberWithMinPrecision(e.b)),l()(e.l)||(t.l=this.getNumberWithMinPrecision(e.l)),l()(e.r)||(t.r=this.getNumberWithMinPrecision(e.r)),l()(e.t)||(t.t=this.getNumberWithMinPrecision(e.t)),t},this.migratePictureMode=e=>{const t={};return l()(e.tile)||(t.tile=this.migrateTile(e.tile)),l()(e.stretch)||(t.stretch=this.migrateStretch(e.stretch)),t},this.migrateTile=e=>{const t={};return l()(e.tx)||(t.tx=e.tx),l()(e.ty)||(t.ty=e.ty),l()(e.sx)||(t.sx=e.sx),l()(e.sy)||(t.sy=e.sy),l()(e.flip)||(t.flip=_.Sb[e.flip]),l()(e.algn)||(t.algn=_.cb[e.algn]),t},this.migrateStretch=e=>{const t={};return l()(e.fillRect)||(t.fillRect=this.migratePictureRect(e.fillRect)),t},this.migratePictureBlip=(e,t)=>{const r={};if(!l()(e.src)||!l()(t)){const i=this.addImageResource(e.src,e.imageType);i&&(e.src=i),r.embed=null!=i?i:t}if(!l()(e.backupSrc)){const t=this.addImageResource(e.backupSrc);t&&(e.backupSrc=t)}return l()(e.alphaModFix)||(r.alphaModFix=[{amt:e.alphaModFix}]),l()(e.contrast)&&l()(e.brightness)||(r.lum=[{contrast:e.contrast,bright:e.brightness}]),l()(e.grayscl)||!1===e.grayscl||(r.grayscl=[e.grayscl]),l()(e.biLevel)||0===e.biLevel||(r.biLevel=[{thresh:e.biLevel}]),l()(e.luminance)||(r.lum=[this.migrateLuminance(e.luminance)]),l()(e.duotone)||(r.duotone=[this.migrateDuotone(e.duotone)]),Object.keys(e).some((e=>["backupSrc","colorTemperature","saturate","sharpenSoften","contrast","brightness"].includes(e)))&&(r.extLst={},r.extLst.ext=[{imgProps:[{imgLayer:this.migrateImgLayer(e)}]}]),r},this.migrateLuminance=e=>{const t={};return l()(e.brightness)||(t.bright=e.brightness),l()(e.contrast)||(t.contrast=e.contrast),t},this.migrateDuotone=e=>{const t={};return l()(e.clr1)&&l()(e.clr2)||(t.egColorChoice=[]),l()(e.clr1)||t.egColorChoice.push(this.migrateColor(e.clr1)),l()(e.clr2)||t.egColorChoice.push(this.migrateColor(e.clr2)),t},this.migrateImgLayer=e=>{const t={};l()(e.backupSrc)||(t.embed=e.backupSrc);const{colorTemperature:r,saturate:i,sharpenSoften:n,contrast:o,brightness:a}=e;return(r||i||n||o||a)&&(t.imgEffect=[this.migrateImgEffect(e)]),t},this.migrateImgEffect=e=>{const t={};return l()(e.colorTemperature)||(t.colorTemperature={colorTemp:e.colorTemperature}),l()(e.saturate)||(t.saturation={sat:String(e.saturate)}),l()(e.sharpenSoften)||(t.sharpenSoften={amount:e.sharpenSoften}),l()(e.contrast)&&l()(e.brightness)||(t.brightnessContrast={contrast:e.contrast,bright:e.brightness}),t},this.migrateTable=e=>{const t=this.migrateCommonNonVisualProps({props:e.props,name:e.name,hidden:e.hidden,locks:e.locks}),r=this.migrateCommonShapeProperties(e.props),i={};return e.graphicData&&(i.graphicData=this.migrateGraphicTableData(e.graphicData)),{id:this.createShapeId(e.id),type:p.a.GraphicalObjectFrameTable,nvPr:t,spPr:r,graphic:i}},this.migrateGraphicTableData=e=>({tbl:e.tbl&&this.migrateTableData(e.tbl)}),this.migrateTableData=e=>{const t={};var r;return t.tblPr=this.migrateTablePr(null!==(r=e.tblPr)&&void 0!==r?r:{}),l()(e.tblColList)||(t.tblGrid={gridCol:e.tblColList.map((e=>{var t;return{w:null!==(t=null==e?void 0:e.w)&&void 0!==t?t:0}}))}),l()(e.tblRowList)||(t.tr=e.tblRowList.map((e=>this.migrateTableRow(e)))),t},this.migrateTableRow=e=>{const t={};return l()(e)||(l()(e.h)||(t.h=e.h),l()(e.tcList)||(t.tc=e.tcList.map((e=>this.migrateTableCell(e))))),t},this.migrateTableCell=e=>{const t={};return l()(e)||(l()(e.gridSpan)||(t.gridSpan=e.gridSpan),l()(e.rowSpan)||(t.rowSpan=e.rowSpan),l()(e.hMerge)||(t.hMerge=Boolean(e.hMerge)),l()(e.vMerge)||(t.vMerge=Boolean(e.vMerge)),l()(e.textBody)||(t.txBody=this.migrateTextBody(e.textBody)),l()(e.tcPr)||(t.tcPr=this.migrateTableCellPr(e.tcPr))),t},this.migrateTableCellPr=e=>{const t={};var r,i,n,o,a,s;(Object.assign(t,this.migrateBackground(e)),l()(e.lnT))||(t.lnT=null===(r=this.migrateOutline(e.lnT))||void 0===r?void 0:r.ln);l()(e.lnB)||(t.lnB=null===(i=this.migrateOutline(e.lnB))||void 0===i?void 0:i.ln);l()(e.lnR)||(t.lnR=null===(n=this.migrateOutline(e.lnR))||void 0===n?void 0:n.ln);l()(e.lnL)||(t.lnL=null===(o=this.migrateOutline(e.lnL))||void 0===o?void 0:o.ln);l()(e.lnTlToBr)||(t.lnTlToBr=null===(a=this.migrateOutline(e.lnTlToBr))||void 0===a?void 0:a.ln);l()(e.lnBlToTr)||(t.lnBlToTr=null===(s=this.migrateOutline(e.lnBlToTr))||void 0===s?void 0:s.ln);return l()(e.vert)||(t.vert=_.Ob[e.vert]),l()(e.anchor)||(t.anchor=_.Hb[e.anchor]),l()(e.anchorCtr)||(t.anchorCtr=Boolean(e.anchorCtr)),l()(e.marB)||(t.marB=e.marB),l()(e.marL)||(t.marL=e.marL),l()(e.marR)||(t.marR=e.marR),l()(e.marT)||(t.marT=e.marT),t},this.migrateTablePr=e=>{const t={};var r;return l()(e.effectList)||(t.effectLst=this.migrateEffectLst(e.effectList)),l()(e.firstRow)||(t.firstRow=Boolean(e.firstRow)),l()(e.firstCol)||(t.firstCol=Boolean(e.firstCol)),l()(e.bandRow)||(t.bandRow=Boolean(e.bandRow)),l()(e.bandCol)||(t.bandCol=Boolean(e.bandCol)),l()(e.lastRow)||(t.lastRow=Boolean(e.lastRow)),l()(e.lastCol)||(t.lastCol=Boolean(e.lastCol)),l()(e.rtl)||(t.rtl=Boolean(e.rtl)),t.tableStyleId=null!==(r=e.styleId)&&void 0!==r?r:"{58542034-FE4F-4ADA-92B8-4CA66D0F0DF3}",t},this.migrateGraphicalFrameChart=e=>{var t;const r=this.migrateCommonNonVisualProps({props:e.props,name:e.name,hidden:e.hidden,locks:e.locks}),i=this.migrateCommonShapeProperties(e.props);return{id:this.getShapeId(e.id),type:p.a.GraphicalObjectFrameChart,nvPr:r,spPr:i,chartSpace:(null===(t=e.graphicData)||void 0===t?void 0:t.chart)&&this.migrateChartSpace(e.graphicData.chart)}},this.migrateChartSpace=e=>{const t={},r={props:["spPr",this.migrateCommonShapeProperties],textBody:["txPr",this.migrateTextBody],style:["style"],round:["roundedCorners",this.migrateNumberToCTBoolean],date1904:["date1904",this.migrateNumberToCTBoolean],lang:["lang"]};return this.migrateFromMap(e,t,r),t.chart=this.migrateChart(e),t},this.migrateChart=e=>{const t={},r={title:["title",this.migrateChartTitle],plotArea:["plotArea",this.migrateChartPlotArea],legend:["legend",this.migrateChartLegend],view3D:["view_3d",this.migrateView3D],backWall:["backWall",this.migrateWall],sideWall:["sideWall",this.migrateWall],floor:["floor",this.migrateWall],dispBlanksAs:["dispBlanksAs",this.migrateEnumStringToEnum(_.v,_.v.PBDEFAULT)],plotVisOnly:["plotVisOnly",this.migrateNumberToCTBoolean]};return this.migrateFromMap(e,t,r),t},this.migrateChartTitle=e=>{const t={},r={overlay:["overlay",this.migrateNumberToCTBoolean],props:["spPr",this.migrateCommonShapeProperties],textBody:["txPr",this.migrateTextBody],layout:["layout",this.migrateChartLayout],chartText:["tx",this.migrateChartTitleText]};return this.migrateFromMap(e,t,r),t},this.migrateChartTitleText=e=>{const t={},r={textBody:["rich",this.migrateTextBody]};return this.migrateFromMap(e,t,r),t},this.migrateChartLayout=e=>{const t={},r={},i={leftMode:["xMode",this.migrateEnumStringToEnum(_.C,_.C.PBDEFAULT)],left:["x"],topMode:["yMode",this.migrateEnumStringToEnum(_.C,_.C.PBDEFAULT)],top:["y"],widthMode:["wMode",this.migrateEnumStringToEnum(_.C,_.C.PBDEFAULT)],width:["w"],heightMode:["hMode",this.migrateEnumStringToEnum(_.C,_.C.PBDEFAULT)],height:["h"],layoutTarget:["layoutTarget",this.migrateEnumStringToEnum(_.D,_.D.PBDEFAULT)]};return this.migrateFromMap(e,r,i),t.manualLayout=r,t},this.migrateChartPlotArea=e=>{const t={},r={layout:["layout",this.migrateChartLayout],props:["spPr",this.migrateCommonShapeProperties],charts:["charts",t=>this.migratePlotCharts(t,{categoryAxes:e.categoryAxes,dateAxes:e.dateAxes,valueAxes:e.valueAxes})]};return this.migrateFromMap(e,t,r),t},this.migrateChartType=e=>{switch(e){case"bar":return _.bc.BarChart;case"line":return _.bc.LineChart;case"area":return _.bc.AreaChart;case"pie":return _.bc.PieChart;case"doughnut":return _.bc.DoughnutChart;case"radar":return _.bc.RadarChart;case"scatter":return _.bc.ScatterChart;case"stock":return _.bc.StockChart;case"bar3d":return _.bc.Bar3DChart;case"pie3d":return _.bc.Pie3DChart;case"line3d":return _.bc.Line3DChart;case"ofpie":return _.bc.OfPieChart;case"area3d":return _.bc.Area3DChart;case"surface":return _.bc.SurfaceChart;case"surface3d":return _.bc.Surface3DChart;case"bubble":return _.bc.BubbleChart}},this.migratePlotCharts=(e,t)=>null==e?void 0:e.map((e=>{const r={};this.migrateSubChartSharedProps(e,r,t);const{type:i}=e;switch(i){case"bar":case"bar3d":default:return this.migrateBarChart(e,r);case"line":case"line3d":return this.migrateLineChart(e,r);case"area":case"area3d":return this.migrateAreaChart(e,r);case"pie":case"pie3d":return this.migratePieChart(e,r);case"doughnut":return this.migrateDoughnutChart(e,r);case"radar":return this.migrateRadarChart(e,r);case"scatter":return this.migrateSatterChart(e,r);case"stock":return this.migrateStockChart(e,r);case"ofpie":return this.migrateOfpieChart(e,r);case"bubble":return this.migrateBubbleChart(e,r)}})),this.migrateSer=(e,t)=>e.map((e=>{const{type:r}=t;switch(r){case"bar":case"bar3d":default:return this.migrateBarSer(e);case"line":case"line3d":case"stock":return this.migrateLineSer(e);case"area":case"area3d":return this.migrateAreaSer(e);case"pie":case"pie3d":case"doughnut":case"ofpie":return this.migratePieSer(e);case"radar":return this.migrateRadarSer(e);case"scatter":return this.migrateScatterSer(e);case"bubble":return this.migrateBubbleSer(e)}})),this.migrateSubChartSharedProps=(e,t,r)=>{const i={type:["type",this.migrateChartType],dataLabels:["dLbls",this.migrateDLbls],varyColors:["varyColors",this.migrateNumberToCTBoolean],series:["ser",t=>this.migrateSer(t,e)]};this.migrateFromMap(e,t,i);const{categoryAxes:n,dateAxes:o,valueAxes:a}=r;[n,o,a].forEach(((r,i)=>{const n=0===i,o=1===i,a=2===i;var s;r&&(null===(s=this.migrateAxes(r))||void 0===s||s.forEach((r=>{var i;r&&(null===(i=e.axisIds)||void 0===i?void 0:i.find((e=>{var t;return e===(null===(t=r.axId)||void 0===t?void 0:t.val)})))&&(t.axes=t.axes||[],n?t.axes.push({catAx:r}):o?t.axes.push({dateAx:r}):a&&t.axes.push({valAx:r}))})));return t}))},this.migrateBarChart=(e,t)=>{const r={overlap:["overlap"],gapWidth:["gapWidth"],direction:["barDir",this.migrateEnumStringToEnum(_.j,_.j.PBDEFAULT)],grouping:["grouping",this.migrateEnumStringToEnum(_.k,_.k.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t},this.migrateLineChart=(e,t)=>{const r={marker:["marker",this.migrateNumberToCTBoolean],smooth:["smooth",this.migrateNumberToCTBoolean],grouping:["grouping",this.migrateEnumStringToEnum(_.A,_.A.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t},this.migrateAreaChart=(e,t)=>{const r={grouping:["grouping",this.migrateEnumStringToEnum(_.A,_.A.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t},this.migratePieChart=(e,t)=>{const r={grouping:["grouping",this.migrateEnumStringToEnum(_.A,_.A.PBDEFAULT)],firstSliceAngle:["firstSliceAng"]};return this.migrateFromMap(e,t,r),t},this.migrateDoughnutChart=(e,t)=>{const r={grouping:["grouping",this.migrateEnumStringToEnum(_.A,_.A.PBDEFAULT)],firstSliceAngle:["firstSliceAng"],holeSize:["holeSize"]};return this.migrateFromMap(e,t,r),t},this.migrateRadarChart=(e,t)=>{const r={radarStyle:["radarStyle",this.migrateEnumStringToEnum(_.bb,_.bb.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t},this.migrateSatterChart=(e,t)=>{const r={scatterStyle:["scatterStyle",this.migrateEnumStringToEnum(_.db,_.db.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t},this.migrateStockChart=(e,t)=>{const r={highLowLines:["hiLowLines",this.migrateChartLines],upDownBars:["upDownBars",this.migrateUpDownBars]};return this.migrateFromMap(e,t,r),t},this.migrateUpDownBars=e=>{const t={},r={gapWidth:["gapWidth"],upBars:["upBars",e=>({spPr:this.migrateCommonShapeProperties(e)})],downBars:["downBars",e=>({spPr:this.migrateCommonShapeProperties(e)})]};return this.migrateFromMap(e,t,r),t},this.migrateOfpieChart=(e,t)=>{const r={ofPieType:["ofPieType",this.migrateEnumStringToEnum(_.N,_.N.PBDEFAULT)],gapWidth:["gapWidth"],splitType:["splitType",this.migrateEnumStringToEnum(_.kb,_.kb.PBDEFAULT)],secondPieSize:["secondPieSize"],splitPos:["splitPos"],secondPiePts:["custSplit",this.migrateCustSplit],serLines:["serLines",this.migrateSerLines]};return this.migrateFromMap(e,t,r),t},this.migrateBubbleChart=(e,t)=>{const r={bubble3D:["bubble3D",this.migrateNumberToCTBoolean],bubbleScale:["bubbleScale"],showNegBubbles:["showNegBubbles",this.migrateNumberToCTBoolean],sizeRepresents:["sizeRepresents",this.migrateEnumStringToEnum(_.hb,_.hb.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t},this.migrateSerSharedProps=e=>{const t={},r={idx:["idx"],order:["order"],seriesText:["tx",this.migrateSeriesText],props:["spPr",this.migrateCommonShapeProperties],dataLabels:["dLbls",this.migrateDLbls],trendline:["trendline",this.migrateTrendlines],errorBars:["errBars",this.migrateErrBars],categories:["categories",this.migrateCategories],valueCount:["valueCount",this.migrateWithOriginValue],categoryAxisData:["categoryAxisData",this.migrateWithOriginValue],values:["values",this.migrateWithOriginValue],otherDPt:["otherDPt",this.migrateDPt],otherDLbl:["otherDLbl",this.migrateDLbl],marker:["marker",this.migrateMarker]};return this.migrateFromMap(e,t,r),t.disable=!!e.disable,l()(t.categories)&&(t.categories=[]),t},this.migrateBarSer=e=>{const t={},r={invertIfNegative:["invertIfNegative",this.migrateNumberToCTBoolean],shape:["shape",this.migrateEnumStringToEnum(_.fb,_.fb.PBDEFAULT)]};return this.migrateFromMap(e,t,r),Object(i.a)({},this.migrateSerSharedProps(e),t)},this.migrateLineSer=e=>{const t={},r={marker:["marker",this.migrateMarker],smooth:["smooth",this.migrateNumberToCTBoolean]};return this.migrateFromMap(e,t,r),Object(i.a)({},this.migrateSerSharedProps(e),t)},this.migrateAreaSer=e=>{const t={};return this.migrateFromMap(e,t,{}),Object(i.a)({},this.migrateSerSharedProps(e),t)},this.migratePieSer=e=>{const t={};return this.migrateFromMap(e,t,{}),Object(i.a)({},this.migrateSerSharedProps(e),t)},this.migrateRadarSer=e=>{const t={},r={marker:["marker",this.migrateMarker]};return this.migrateFromMap(e,t,r),Object(i.a)({},this.migrateSerSharedProps(e),t)},this.migrateScatterSer=e=>{const t={},r={marker:["marker",this.migrateMarker],smooth:["smooth",this.migrateNumberToCTBoolean]};return this.migrateFromMap(e,t,r),Object(i.a)({},this.migrateSerSharedProps(e),t)},this.migrateBubbleSer=e=>{const t={},r={invertIfNegative:["invertIfNegative",this.migrateNumberToCTBoolean],bubble3D:["bubble3D",this.migrateNumberToCTBoolean],bubbleSize:["bubbleSize",this.migrateNumDataSource]};return this.migrateFromMap(e,t,r),Object(i.a)({},this.migrateSerSharedProps(e),t)},this.migrateCategories=e=>e.map(((e,t)=>{const r={},i={categoryPoint:["categoryPoint",this.migrateValuePoint],valuePoint:["valuePoint",this.migrateValuePoint],dataLabel:["dataLabel",this.migrateDLbl],dataPoint:["dataPoint",this.migrateDPt]};return this.migrateFromMap(e,r,i),r.idx=t,r})),this.migrateValuePoint=e=>{const t={},r={value:["v",this.migrateWithOriginValue],formatCode:["formatCode",this.migrateWithOriginValue]};return this.migrateFromMap(e,t,r),t},this.migrateDPt=e=>{const t={},r={idx:["idx"],props:["spPr",this.migrateCommonShapeProperties],explosion:["explosion"],bubble3D:["bubble3D",this.migrateNumberToCTBoolean],invertIfNegative:["invertIfNegative",this.migrateNumberToCTBoolean],marker:["marker",this.migrateMarker]};return this.migrateFromMap(e,t,r),t},this.migrateMarker=e=>{const t={},r={symbol:["symbol",this.migrateEnumStringToEnum(_.M,_.M.PBDEFAULT)],size:["size"],props:["spPr",this.migrateCommonShapeProperties]};return this.migrateFromMap(e,t,r),t},this.migrateSeriesText=e=>{const t={},r={value:["v",this.migrateWithOriginValue],strRef:["strRef",this.migrateStrRef]};return this.migrateFromMap(e,t,r),t},this.migrateStrRef=e=>{var t;const r={};var i;return r.strCache={ptCount:{val:e.count},pt:null!==(i=null===(t=e.points)||void 0===t?void 0:t.map((e=>({v:e.value,idx:e.idx}))))&&void 0!==i?i:[]},r},this.migrateWithOriginValue=e=>e,this.migrateNumDataSource=e=>{var t;const r={};return r.numLit={formatCode:e.formatCode,ptCount:{val:e.count},pt:null===(t=e.points)||void 0===t?void 0:t.map((e=>({v:e.value,idx:e.idx,formatCode:e.formatCode})))},r.numRef={numCache:r.numLit},r},this.migrateSerLines=e=>[this.migrateChartLines({props:e})],this.migrateErrBars=e=>e.map((e=>{const t={},r={errDir:["errDir",this.migrateEnumStringToEnum(_.x,_.x.PBDEFAULT)],errBarType:["errBarType",this.migrateEnumStringToEnum(_.w,_.w.PBDEFAULT)],errValType:["errValType",this.migrateEnumStringToEnum(_.y,_.y.PBDEFAULT)],noEndCap:["noEndCap",this.migrateNumberToCTBoolean],props:["spPr",this.migrateCommonShapeProperties],plus:["plus"],minus:["minus"]};return this.migrateFromMap(e,t,r),t})),this.migrateTrendlines=e=>(Array.isArray(e)?e:[e]).map(this.migrateTrendline),this.migrateTrendline=e=>{const t={},r={name:["name",this.migrateWithOriginValue],type:["trendlineType",this.migrateEnumStringToEnum(_.Zb,_.Zb.PBDEFAULT)],props:["spPr",this.migrateCommonShapeProperties],order:["order"],period:["period"],forward:["forward"],backward:["backward"],intercept:["intercept"],dispRSqr:["dispRSqr",this.migrateNumberToCTBoolean],dispEq:["dispEq",this.migrateNumberToCTBoolean],label:["trendlineLbl",this.migrateTrendlineLbl]};return this.migrateFromMap(e,t,r),t},this.migrateTrendlineLbl=e=>{const t={},r={numFmt:["numFmt",this.migrateNumFmt]};return this.migrateFromMap(e,t,r),Object(i.a)({},t,this.migrateChartTitle(e))},this.migrateNumFmt=e=>{const t={},r={formatCode:["formatCode",this.migrateWithOriginValue],sourceLinked:["sourceLinked",e=>!!e]};return this.migrateFromMap(e,t,r),t},this.migrateDLbls=e=>{const t={},r={dataLabel:["dLbl",this.migrateDLbl]};return this.migrateFromMap(e,t,r),Object(i.a)({},this.migrateDLblSharedProps(e),t)},this.migrateDLbl=e=>{const t={},r={idx:["idx"],layout:["layout",this.migrateChartLayout],text:["tx",this.migrateChartTitleText]};return this.migrateFromMap(e,t,r),Object(i.a)({},this.migrateDLblSharedProps(e),t)},this.migrateDLblSharedProps=e=>{const t={},r={delete:["deleteKeyword",this.migrateNumberToCTBoolean],numFmt:["numFmt",this.migrateNumFmt],props:["spPr",this.migrateCommonShapeProperties],textBody:["txPr",this.migrateTextBody],labelPosition:["dLblPos",this.migrateEnumStringToEnum(_.t,_.t.PBDEFAULT)],showLegendKey:["showLegendKey",this.migrateNumberToCTBoolean],showVal:["showVal",this.migrateNumberToCTBoolean],showCategoryName:["showCatName",this.migrateNumberToCTBoolean],showSeriesName:["showSerName",this.migrateNumberToCTBoolean],showPercent:["showPercent",this.migrateNumberToCTBoolean],showBubbleSize:["showBubbleSize",this.migrateNumberToCTBoolean],separator:["separator",this.migrateWithOriginValue],showLeaderLines:["showLeaderLines",this.migrateNumberToCTBoolean],leaderLines:["leaderLines",e=>({spPr:this.migrateCommonShapeProperties(e)})]};var o,a,s,l,c,d;return this.migrateFromMap(Object(n.a)(Object(i.a)({},e),{showLegendKey:null!==(o=e.showLegendKey)&&void 0!==o?o:0,showVal:null!==(a=e.showVal)&&void 0!==a?a:0,showCategoryName:null!==(s=e.showCategoryName)&&void 0!==s?s:0,showSeriesName:null!==(l=e.showSeriesName)&&void 0!==l?l:0,showPercent:null!==(c=e.showPercent)&&void 0!==c?c:0,showBubbleSize:null!==(d=e.showBubbleSize)&&void 0!==d?d:0}),t,r),t},this.migrateAxId=e=>e.map((e=>this.migrateSimpleTypePropsToComplexType(e))),this.migrateAxes=e=>e.filter(Boolean).map((e=>{const t={},r={axId:["axId"],autoLabeled:["autoKeyword",this.migrateNumberToCTBoolean],scaling:["scaling",this.migrateScaling],delete:["deleteKeyword",this.migrateNumberToCTBoolean],position:["axPos",this.migrateEnumStringToEnum(_.i,_.i.PBDEFAULT)],majorGridlines:["majorGridlines",this.migrateChartLines],minorGridlines:["minorGridlines",this.migrateChartLines],title:["title",this.migrateChartTitle],numFmt:["numFmt",this.migrateNumFmt],majorTickMark:["majorTickMark",this.migrateEnumStringToEnum(_.Rb,_.Rb.PBDEFAULT)],minorTickMark:["minorTickMark",this.migrateEnumStringToEnum(_.Rb,_.Rb.PBDEFAULT)],tickLabelPosition:["tickLblPos",this.migrateEnumStringToEnum(_.Qb,_.Qb.PBDEFAULT)],props:["spPr",this.migrateCommonShapeProperties],textBody:["txPr",this.migrateTextBody],crossAx:["crossAx"],crosses:["crosses",this.migrateEnumStringToEnum(_.s,_.s.PBDEFAULT)],crossesAt:["crossesAt"],crossBetween:["crossBetween",this.migrateEnumStringToEnum(_.r,_.r.PBDEFAULT)],lblAlgn:["lblAlgn",this.migrateEnumStringToEnum(_.E,_.E.PBDEFAULT)],lblOffset:["lblOffset"],tickLblSkip:["tickLblSkip"],tickMarkSkip:["tickMarkSkip"],majorUnit:["majorUnit"],minorUnit:["minorUnit"],dispUnits:["dispUnits",this.migrateDispUnits],baseTimeUnit:["baseTimeUnit",this.migrateEnumStringToEnum(_.Tb,_.Tb.PBDEFAULT)],majorTimeUnit:["majorTimeUnit",this.migrateEnumStringToEnum(_.Tb,_.Tb.PBDEFAULT)],minorTimeUnit:["minorTimeUnit",this.migrateEnumStringToEnum(_.Tb,_.Tb.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t})),this.migrateScaling=e=>{const t={},r={orientation:["orientation",this.migrateEnumStringToEnum(_.P,_.P.PBDEFAULT)],max:["max"],min:["min"],logBase:["logBase"]};return this.migrateFromMap(e,t,r),t},this.migrateDispUnits=e=>{const t={},r={dispUnitsLbl:["dispUnitsLbl",this.migrateChartTitle],unit:["builtInUnit",this.migrateEnumStringToEnum(_.o,_.o.PBDEFAULT)]};return this.migrateFromMap(e,t,r),t},this.migrateChartLines=e=>{const t={},r={props:["spPr",this.migrateCommonShapeProperties]};return this.migrateFromMap(e,t,r),t},this.migrateChartLegend=e=>{const t={},r={legendPosition:["legendPos",this.migrateEnumStringToEnum(_.F,_.F.PBDEFAULT)],overlay:["overlay",this.migrateNumberToCTBoolean],props:["spPr",this.migrateCommonShapeProperties],textBody:["txPr",this.migrateTextBody],layout:["layout",this.migrateChartLayout],legendEntry:["legendEntry",this.migrateLegendEntry]};return this.migrateFromMap(e,t,r),t},this.migrateLegendEntry=e=>e.map((e=>{const t={},r={idx:["idx"],delete:["deleteKeyword",this.migrateNumberToCTBoolean],textBody:["txPr",this.migrateTextBody]};return this.migrateFromMap(e,t,r),t})),this.migrateCustSplit=e=>{const t={};return t.secondPiePt=e.map((e=>({val:e}))),t},this.migrateEnumStringToEnum=(e,t)=>r=>({val:e[r]||t}),this.migrateView3D=e=>{const t={},r={rotX:["rotX"],rotY:["rotY"],depthPercent:["depthPercent"],hPercent:["hPercent"],rAngAx:["rAngAx",this.migrateNumberToCTBoolean],perspective:["perspective"]};return this.migrateFromMap(e,t,r),t},this.migrateWall=e=>{const t={},r={props:["spPr",this.migrateCommonShapeProperties],thickness:["thickness"]};return this.migrateFromMap(e,t,r),t},this.migrateSimpleTypePropsToComplexType=e=>({val:e}),this.migrateAllPropsToComplexType=e=>Object.keys(e).reduce(((t,r)=>Object(n.a)(Object(i.a)({},t),{[r]:{val:e[r]}})),{}),this.migrateNumberToCTBoolean=e=>({val:!!e}),this.migrateFromMap=(e,t,r,i=this.migrateSimpleTypePropsToComplexType)=>{Object.keys(r).forEach((n=>{const o=e[n];if(!l()(o)){const[e,a]=r[n];t[e]=a?a(o):i(o)}}))},this.migrateElement=e=>{if(!l()(e)){if("shape"===e.type){var t,r;if("notesMaster"===(null===(t=this.ctx.page)||void 0===t?void 0:t.type)&&(null===(r=e.props)||void 0===r?void 0:r.placeholder)&&l()(e.props.placeholder.type))return;return this.migrateShape(e)}return"groupShape"===e.type?this.migrateGroupShape(e):"cxnSp"===e.type?this.migrateConnector(e):"pic"===e.type?this.migratePicture(e):"graphFrame_Tbl"===e.type?this.migrateTable(e):"chart"===e.type?this.migrateGraphicalFrameChart(e):void 0}},this.migrateShape=e=>{var t,r;const i=this.migrateCommonNonVisualProps({props:e.props,name:e.name,hidden:e.hidden,locks:e.locks});(null===(t=e.props)||void 0===t?void 0:t.txBox)&&(i.txBox=Boolean(e.props.txBox));const n=this.migrateCommonShapeProperties(e.props,!(null===(r=e.props)||void 0===r?void 0:r.placeholder));return{id:this.createShapeId(e.id),type:p.a.Shape,nvPr:i,spPr:n,txBody:e.textBody&&this.migrateTextBody(e.textBody),useBgFill:e.useBgFill&&Boolean(e.useBgFill)}},this.migrateCommonNonVisualProps=e=>{const{props:t,name:r,hidden:i,locks:n}=e,o={};var a,s,l,c;(null==t?void 0:t.placeholder)&&(o.ph={idx:null===(a=t.placeholder)||void 0===a?void 0:a.index,type:_.U[null==t||null===(s=t.placeholder)||void 0===s?void 0:s.type],hasCustomPrompt:(null==t||null===(l=t.placeholder)||void 0===l?void 0:l.hasCustomPrompt)&&Boolean(t.placeholder.hasCustomPrompt)},"master"===(null===(c=this.ctx.page)||void 0===c?void 0:c.type)&&o.ph.type===_.U.ctrTitle&&(o.ph.type=_.U.title));return(null==t?void 0:t.hlink)&&(o.hlinkClick=this.migrateHLink(t.hlink)),(null==t?void 0:t.txBox)&&(o.txBox=Boolean(t.txBox)),(null==t?void 0:t.attachment)&&(o.attachment=this.migrateAttachment(t.attachment)),(null==t?void 0:t.addon)&&(o.addon=this.migrateAddon(t.addon)),(null==t?void 0:t.textMath)&&(o.isEquationShape=Boolean(t.textMath)),r&&(o.name=r),i&&(o.hidden=Boolean(i)),n&&(o.locking=this.migrateLocking(n)),o},this.migrateAddon=e=>{const t={};return l()(e.displayMode)||(t.displayMode=_.f[e.displayMode]),l()(e.embedUrl)||(t.embedUrl=e.embedUrl),l()(e.extraData)||("string"==typeof e.extraData?t.extraData=e.extraData:t.extraData=JSON.stringify(e.extraData)),l()(e.iframeId)||(t.iframeId=e.iframeId),l()(e.originUrl)||(t.originUrl=e.originUrl),l()(e.title)||(t.title=e.title),l()(e.aid)||(t.aid=e.aid),l()(e.type)||(t.type=String(e.type)),l()(e.docElement)||(t.docElement=this.migrateAddonDocElement(e.docElement)),t},this.migrateAddonDocElement=e=>{const t={};return l()(e.type)||(t.type=e.type),l()(e.addonId)||(t.addonId=e.addonId),l()(e.anchorId)||(t.anchorId=e.anchorId),l()(e.embedUrl)||(t.embedUrl=e.embedUrl),l()(e.extraData)||(t.extraData=e.extraData),l()(e.height)||(t.height=e.height),l()(e.width)||(t.width=e.width),l()(e.lockAspectRatio)||(t.lockAspectRatio=e.lockAspectRatio),l()(e.originUrl)||(t.originUrl=e.originUrl),l()(e.packageId)||(t.packageId=e.packageId),l()(e.src)||(t.src=e.src),l()(e.sourceType)||(t.sourceType=e.sourceType),t},this.migrateAttachment=e=>{const t={};return l()(e.id)||(t.id=e.id),l()(e.name)||(t.name=e.name),l()(e.type)||(t.type=e.type),l()(e.classify)||(t.classify=_.g[e.classify]),l()(e.showType)||(t.showType=_.h[e.showType]),l()(e.size)||(t.size=e.size),l()(e.objKey)||(t.objKey=e.objKey),t},this.migrateCommonShapeProperties=(e,t=!1)=>{const r={};return l()(null==e?void 0:e.frame)||(r.xfrm=this.migrateFrame(e.frame)),Object.assign(r,this.migrateBackground(null==e?void 0:e.background)),Object.assign(r,this.migrateOutline(null==e?void 0:e.outline)),l()(null==e?void 0:e.prstGeom)||(r.prstGeom=this.migratePrstGeom(e.prstGeom)),l()(null==e?void 0:e.customGeom)||(r.custGeom=this.migrateCustomGeom(e.customGeom)),t&&l()(null==e?void 0:e.prstGeom)&&l()(null==e?void 0:e.customGeom)&&(r.prstGeom={prst:_.gb.rect}),l()(null==e?void 0:e.effectList)||(r.effectLst=this.migrateEffectLst(e.effectList)),l()(null==e?void 0:e.scene3d)||(r.scene3d=this.migrateScene3d(e.scene3d)),l()(null==e?void 0:e.shape3d)||(r.sp3d=this.migrateShape3d(e.shape3d)),r},this.migrateShape3d=e=>{const t={};return l()(e.bevelTop)||(t.bevelT=this.migrateBevel3d(e.bevelTop)),l()(e.bevelBottom)||(t.bevelB=this.migrateBevel3d(e.bevelBottom)),l()(e.extrusionColor)||(t.extrusionClr=this.migrateColor(e.extrusionColor)),l()(e.materialPreset)||(t.prstMaterial=_.Y[e.materialPreset]),l()(e.extrusionHeight)||(t.extrusionH=e.extrusionHeight),t},this.migrateBevel3d=e=>{const t={};return l()(e.width)||(t.w=e.width),l()(e.height)||(t.h=e.height),l()(e.preset)||(t.prst=_.l[e.preset]),t},this.migrateScene3d=e=>{const t={};var r,i;return t.camera=this.migrateCamera(null!==(r=e.camera)&&void 0!==r?r:{}),t.lightRig=this.migrateLightRig(null!==(i=e.lightRig)&&void 0!==i?i:{},e.direction),t},this.migrateLightRig=(e,t)=>{const r={};var i,n;return l()(e.rotation)||(r.rot=this.migrateRotation3D(e.rotation)),r.rig=null!==(i=_.H[e.rigPreset])&&void 0!==i?i:_.H.threePt,r.dir=null!==(n=_.G[t])&&void 0!==n?n:_.G.t,r},this.migrateCamera=e=>{const t={};var r;return l()(e.rotation)||(t.rot=this.migrateRotation3D(e.rotation)),t.prst=null!==(r=_.V[e.preset])&&void 0!==r?r:_.V.orthographicFront,t},this.migrateRotation3D=e=>{const t={};return l()(e.x)||(t.lat=e.x%216e5),l()(e.y)||(t.lon=e.y%216e5),l()(e.z)||(t.rev=e.z%216e5),t},this.migratePrstGeom=e=>{const t={};var r;if(t.prst=null!==(r=_.gb[e.prstGeomType])&&void 0!==r?r:_.gb.rect,!l()(e.adjList)){const r=e.adjList.map(((t,r)=>{var i;const n=this.getPrstGeomAdjVal(t);var o;return{name:this.getPrstGeomAdjName(null===(i=e.adjList)||void 0===i?void 0:i.length,r,null!==(o=e.prstGeomType)&&void 0!==o?o:"rect",e.adjNameList),fmla:n}}));t.avLst={gd:r}}return t},this.migrateHLink=e=>{const t={};return l()(e.slideJump)||(t.id=e.slideJump.target,t.action=e.slideJump.action),l()(e.url)||(t.id=e.url),l()(e.mimeType)||(t.mimeType=e.mimeType),l()(e.iconMode)||(t.iconMode=Boolean(e.iconMode)),l()(e.tooltip)||(t.tooltip=e.tooltip),l()(e.colorType)||(t.extLst={ext:[{hlinkClr:[{val:_.B[e.colorType]}]}]}),t},this.migrateCustomGeom=e=>{if(Object.keys(e).length<=0)return;const t={};return l()(e.pathList)||(t.pathLst={path:e.pathList.filter(Boolean).map((e=>this.migratePath(e)))}),l()(e.rect)||(t.rect=this.migrateRect(e.rect)),t},this.migratePath=e=>{if(l()(e))return;const t={};return l()(e.width)||(t.w=e.width),l()(e.height)||(t.h=e.height),l()(e.fill)||(t.fill=_.R[e.fill]),l()(e.stroke)||(t.stroke=Boolean(e.stroke)),l()(e.pathString)||(t.pathString=e.pathString),t},this.migrateRect=e=>{const t={};return l()(e.l)||(t.l={geomGuideName:e.l}),l()(e.r)||(t.r={geomGuideName:e.r}),l()(e.b)||(t.b={geomGuideName:e.b}),l()(e.t)||(t.t={geomGuideName:e.t}),t},this.migrateEffectLst=e=>{const t={};return l()(e.glow)||(t.glow=this.migrateEffectGlow(e.glow)),l()(e.outerShadow)||(t.outerShdw=this.migrateEffectOuterShadow(e.outerShadow)),l()(e.innerShadow)||(t.innerShdw=this.migrateEffectInnerShadow(e.innerShadow)),l()(e.reflection)||(t.reflection=this.migrateEffectReflection(e.reflection)),l()(e.softEdge)||(t.softEdge=this.migrateEffectSoftEdge(e.softEdge)),t},this.migrateEffectGlow=e=>{var t;const r={};return l()(e.rad)||(r.rad=e.rad),l()(null===(t=e.glowColor)||void 0===t?void 0:t.color)||(r.egColorChoice=this.migrateColor(e.glowColor.color)),r},this.migrateEffectOuterShadow=e=>{var t;const r={};return l()(e.algn)||(r.algn=_.cb[e.algn]),l()(e.blurRad)||(r.blurRad=e.blurRad),l()(e.dir)||(r.dir=e.dir),l()(e.dist)||(r.dist=e.dist),l()(e.kx)||(r.kx=e.kx),l()(e.ky)||(r.ky=e.ky),l()(e.sx)||(r.sx=e.sx),l()(e.sy)||(r.sy=e.sy),l()(null===(t=e.shadowColor)||void 0===t?void 0:t.color)||(r.egColorChoice=this.migrateColor(e.shadowColor.color)),r},this.migrateEffectInnerShadow=e=>{var t;if(Object.keys(e).length<=0)return;const r={};return l()(e.blurRad)||(r.blurRad=e.blurRad),l()(e.dir)||(r.dir=e.dir),l()(e.dist)||(r.dist=e.dist),l()(null===(t=e.shadowColor)||void 0===t?void 0:t.color)||(r.egColorChoice=this.migrateColor(e.shadowColor.color)),r},this.migrateEffectReflection=e=>{const t={};return l()(e.algn)||(t.algn=_.cb[e.algn]),l()(e.blurRad)||(t.blurRad=e.blurRad),l()(e.dir)||(t.dir=e.dir),l()(e.dist)||(t.dist=e.dist),l()(e.kx)||(t.kx=e.kx),l()(e.ky)||(t.ky=e.ky),l()(e.sx)||(t.sx=e.sx),l()(e.sy)||(t.sy=e.sy),l()(e.endA)||(t.endA=e.endA),l()(e.endPos)||(t.endPos=e.endPos),l()(e.stA)||(t.stA=e.stA),l()(e.rotWithShape)||(t.rotWithShape=Boolean(e.rotWithShape)),t},this.migrateEffectSoftEdge=e=>{const t={};return l()(e.rad)||(t.rad=e.rad),t},this.migrateFrame=e=>{if(0===Object.keys(e).length)return;const t={};return l()(e.left)&&l()(e.right)||(t.off={x:Math.floor(e.left)||0,y:Math.floor(e.top)||0}),l()(e.width)&&l()(e.height)||(t.ext={cx:Math.floor(e.width)||0,cy:Math.floor(e.height)||0}),l()(e.childOffsetLeft)&&l()(e.childOffsetTop)||(t.chOff={x:Math.floor(e.childOffsetLeft)||0,y:Math.floor(e.childOffsetTop)||0}),l()(e.childWidth)&&l()(e.childHeight)||(t.chExt={cx:Math.floor(e.childWidth)||0,cy:Math.floor(e.childHeight)||0}),l()(e.rotate)||(t.rot=e.rotate),l()(e.flipH)||(t.flipH=!!e.flipH),l()(e.flipV)||(t.flipV=!!e.flipV),t},this.migrateBackground=e=>{var t;if(!e)return;const r={};if(!l()(e.shadeToTitle)&&e.shadeToTitle&&(r.shadeToTitle=Boolean(e.shadeToTitle)),(null===(t=e.solidFill)||void 0===t?void 0:t.color)&&(r.solidFill={egColorChoice:this.migrateColor(e.solidFill.color)}),void 0!==e.noFill&&(r.noFill=!!e.noFill),void 0!==e.grpFill&&(r.grpFill=!!e.grpFill),l()(e.image)||(r.blipFill=this.migratePictureBlipFill(e.image)),e.gradFill){const{gsList:t,flip:n,rotateWithShape:o,tileRect:a,pathGradient:s,lin:l}=e.gradFill,c={};a&&(c.tileRect=Object(i.a)({},a)),n&&(c.flip=_.Sb[n]),void 0!==o&&(c.rotWithShape=!!o),(s||l)&&(c.egShadeProperties={path:s&&{fillToRect:Object(i.a)({},s.fillToRect),path:_.S[s.path]},lin:l&&{ang:l.ang,scaled:Boolean(l.scaled)}}),t&&(c.gsLst={gs:t.filter(Boolean).map((e=>({egColorChoice:this.migrateColor(e.color),pos:e.pos})))}),r.gradFill=c}if(e.pattFill){const t={},{fgColor:i,bgColor:n,preset:o}=e.pattFill;i&&(t.fgClr=this.migrateColor(i.color)),n&&(t.bgClr=this.migrateColor(n.color)),o&&(t.prst=_.Z[o]),r.pattFill=t}return r},this.migrateOutline=e=>{if(!e)return;const t={ln:{}};return(1===e.noFill||e.solidFill||e.gradFill)&&(t.ln={egLineFillProperties:this.migrateBackground(e)}),l()(e.width)||(t.ln.w=e.width),l()(e.cmpd)||(t.ln.cmpd=_.q[e.cmpd]),l()(e.style)||(t.ln.egLineDashProperties={prstDash:{val:_.X[e.style]}}),l()(e.cap)||(t.ln.cap=_.I[e.cap]),l()(e.lineJoin)||("miter"===e.lineJoin?t.ln.egLineJoinProperties={miter:{lim:8e5}}:t.ln.egLineJoinProperties={[e.lineJoin]:!0}),l()(e.headEnd)||(t.ln.headEnd=this.migrateLineEnd(e.headEnd)),l()(e.tailEnd)||(t.ln.tailEnd=this.migrateLineEnd(e.tailEnd)),l()(e.sketchStyle)||(t.ln.extLst={ext:[{lineSketchStyleProps:[this.migrateSketchStyle(e.sketchStyle)]}]}),t},this.migrateSketchStyle=e=>{const t={};return l()(e.type)||(t.type={egLineSketchType:{[e.type]:{}}}),l()(e.prstGeom)||(t.egGeometry={prstGeom:this.migratePrstGeom(e.prstGeom)}),l()(e.customGeom)||(t.egGeometry={custGeom:this.migrateCustomGeom(e.customGeom)}),t},this.migrateLineEnd=e=>({type:_.K[e.lineEndType],w:_.L[e.widthType],len:_.J[e.lengthType]}),this.migrateColorMap=e=>{if(!e)return;const t=e;for(const r of Object.keys(e))t[r]=_.p[e[r]];return t},this.migrateColor=e=>{const t={};if(l()(e))return t;const{colorType:r,colorValue:i,srgb_color:n}=e;let o=null;l()(r)&&n&&(o=t.srgbClr={val:this.fromRgbHexString(null!=n?n:"000000")}),"rgb"===r&&(o=t.srgbClr={val:this.fromRgbHexString(null!=i?i:"000000")}),"scheme"===r&&(o=t.schemeClr={val:_.eb[i]});const a=[];return["lumMod","lumOff","tint","shade","comp","inv","gray","alpha","alphaOff","alphaMod","hue","hueOff","hueMod","sat","satMod","satOff","lum","red","redOff","redMod","green","greenOff","greenMod","blue","blueOff","blueMod","gamma","invGamma"].forEach((t=>{if(!l()(e[t])){const r="lumOff"===t?Math.max(0,Number(e[t])):e[t];a.push({[t]:"number"==typeof r?{val:r}:r})}})),o&&a.length&&(o.egColorTransform=a),t},this.migrateTheme=e=>{var t;const r={id:this.getId(e.id,"theme"),type:p.a.Theme};var n;return r.name=null!==(n=null===(t=this.ctx.presentation.masterList.filter(Boolean).find((t=>t.themeId===e.id)))||void 0===t?void 0:t.themeName)&&void 0!==n?n:"自定义主题",l()(e)||(r.themeElements=Object(i.a)({},b.themeElements),l()(e.fontScheme)?r.themeElements.fontScheme={name:"Office",majorFont:{cs:{typeface:""},latin:{typeface:this.ctx.defaultFont},ea:{typeface:this.ctx.defaultFont}},minorFont:{cs:{typeface:""},latin:{typeface:this.ctx.defaultFont},ea:{typeface:this.ctx.defaultFont}}}:r.themeElements.fontScheme=this.migrateFontScheme(e.fontScheme),l()(e.fmtScheme)||(r.themeElements.fmtScheme=this.migrateFmtScheme(e.fmtScheme)),l()(e.themeElements.clrScheme)||(r.themeElements.clrScheme=this.migrateColorScheme(e.themeElements.clrScheme))),r},this.migrateFontScheme=e=>{const t={};return l()(e.majorFont)||(t.majorFont=this.migrateFontCollection(e.majorFont)),l()(e.minorFont)||(t.minorFont=this.migrateFontCollection(e.minorFont)),t.name||(t.name="Office"),t},this.migrateFontCollection=e=>{const t={ea:{typeface:""},cs:{typeface:""}};return l()(e.latin)||(t.latin=this.migrateFont({typeface:e.latin})),l()(e.ea)||(t.ea=this.migrateFont({typeface:e.ea})),l()(e.Hans)||(t.font=[this.migrateSupplementalHansFont(e)]),t},this.migrateFmtScheme=e=>{const t={fillStyleLst:{},lnStyleLst:{},bgFillStyleLst:b.themeElements.fmtScheme.bgFillStyleLst,effectStyleLst:b.themeElements.fmtScheme.effectStyleLst};return l()(e.fillStyleLst)||(t.fillStyleLst.egFillProperties=e.fillStyleLst.map((e=>this.migrateBackground(e)))),l()(e.lnStyleLst)||(t.lnStyleLst.ln=e.lnStyleLst.map((e=>this.migrateOutline(e).ln))),t.name||(t.name="Office"),t},this.migrateColorScheme=e=>{if(!e)return;const t={};for(const r of Object.keys(e))t[r]={srgbClr:{val:e[r]}};return t.name||(t.name="Office"),t},this.migrateTextBody=e=>{var t,r;if(!e)return;const i={};return i.bodyPr=this.migrateTextBodyProps(e.props)||{},e.textStyleList&&(i.lstStyle=this.migrateTextStyleList(e.textStyleList)),i.p=(null===(r=e.paragraphList)||void 0===r||null===(t=r.map)||void 0===t?void 0:t.call(r,this.migrateParagraph))||[],i},this.migrateTextBodyProps=e=>{if(!e)return;const t={};switch(l()(e.vert)||(t.vert=_.Ob[e.vert]),l()(e.anchor)||(t.anchor=_.Hb[e.anchor]),e.autoFitType){case"noAutofit":t.noAutofit=!0;break;case"normAutofit":t.normAutofit={fontScale:e.fontScale,lnSpcReduction:e.lnSpcReduction};break;case"spAutoFit":t.spAutoFit=!0}return l()(e.anchorCtr)||(t.anchorCtr=Boolean(e.anchorCtr)),l()(e.left_inset)||(t.lIns=e.left_inset),l()(e.right_inset)||(t.rIns=e.right_inset),l()(e.top_inset)||(t.tIns=e.top_inset),l()(e.bottom_inset)||(t.bIns=e.bottom_inset),l()(e.wrap)||(t.wrap=_.Pb[e.wrap]),l()(e.numCol)||(t.numCol=e.numCol),l()(e.spcCol)||(t.spcCol=e.spcCol),t},this.migrateTextStyleList=e=>{if(!Array.isArray(e))return;const t={},r=new Map;for(const t of e)r.set(t.level,this.migrateParagraphProps(t));return Object.assign(t,{defPPr:r.get(-1),lvl1pPr:r.get(0),lvl2pPr:r.get(1),lvl3pPr:r.get(2),lvl4pPr:r.get(3),lvl5pPr:r.get(4),lvl6pPr:r.get(5),lvl7pPr:r.get(6),lvl8pPr:r.get(7),lvl9pPr:r.get(8)}),t},this.migrateParagraph=e=>{if(!e)return;const t={};return t.pPr=this.migrateParagraphProps(e.paragraphProps),e.paragraphItem&&(t.egTextRun=e.paragraphItem.map(this.migrateParagraphItem)),t.endParaRPr=this.migrateRunProps(e.endParaRPr),t},this.migrateParagraphItem=e=>{if(!e)return;const t={};switch(e.type){case"run":default:t.r={rPr:this.migrateRunProps(e.props),t:e.text};break;case"runBr":t.br={rPr:this.migrateRunProps(e.props)};break;case"field":t.fld={rPr:this.migrateRunProps(e.props),pPr:{},t:e.text,type:e.fieldType,id:e.id||`{${Object(g.b)()}}`}}return t},this.migrateParagraphProps=e=>{var t,r;if(!e)return{};const i={};return l()(e.alignment)||(i.algn=_.Gb[e.alignment]),l()(e.character_bullet_char)||(i.buChar={charKeyword:e.character_bullet_char}),l()(e.buAutoNum)||(i.buAutoNum={type:_.Ib[e.buAutoNum.type],startAt:e.buAutoNum.startAt}),l()(e.buNone)||(i.buNone=Boolean(e.buNone)),l()(null===(t=e.buBlip)||void 0===t?void 0:t.blip)||(i.buBlip={blip:this.migratePictureBlip(e.buBlip.blip,void 0)}),l()(null===(r=e.buClr)||void 0===r?void 0:r.color)||(i.buClr=this.migrateColor(e.buClr.color)),l()(e.buClrTx)||(i.buClrTx=Boolean(e.buClrTx)),l()(e.buSzTx)||(i.buSzTx=Boolean(e.buSzTx)),l()(e.buFont)||(i.buFont=this.migrateFont(e.buFont)),l()(e.buFontTx)||(i.buFontTx=Boolean(e.buFontTx)),l()(e.buSzPct)||(i.buSzPct={val:String(e.buSzPct)}),l()(e.buSzPts)||(i.buSzPts={val:e.buSzPts}),l()(e.defTablSz)||(i.defTabSz=e.defTablSz),l()(e.tabList)||(i.tabLst={tab:e.tabList.map((({algn:e,pos:t})=>({pos:t,algn:e&&_.Mb[e]})))}),l()(e.level)||(i.lvl=e.level),l()(e.marginLeft)||(i.marL=e.marginLeft),l()(e.marginRight)||(i.marR=e.marginRight),l()(e.indent)||(i.indent=e.indent),l()(e.defaultRunProps)||(i.defRPr=this.migrateRunProps(e.defaultRunProps)),l()(e.lnSpc)||(i.lnSpc=this.migrateTextSpacing(e.lnSpc)),l()(e.spcBef)||(i.spcBef=this.migrateTextSpacing(e.spcBef)),l()(e.spcAft)||(i.spcAft=this.migrateTextSpacing(e.spcAft)),i},this.migrateTextSpacing=e=>{const{spcPct:t,spcPts:r}=e;if(l()(t)&&l()(r))return;const i={};return l()(t)||(i.spcPct={val:Math.min(132e5,Math.max(0,t))}),l()(r)||(i.spcPts={val:r}),i},this.migrateRunProps=e=>{var t;if(!e)return{};const r={};return l()(e.font)||Object.assign(r,{latin:this.migrateFont(e.font.latin),ea:this.migrateFont(e.font.ea),cs:this.migrateFont(e.font.cs),sym:this.migrateFont(e.font.sym)}),l()(e.font_size)||(r.sz=e.font_size),Object.assign(r,this.migrateBackground(e)),Object.assign(r,this.migrateOutline(e.outline)),l()(e.underline)||(r.u=_.Nb[e.underline]),l()(e.strike)||(r.strike=_.Lb[e.strike]),l()(e.bold)||(r.b=Boolean(e.bold)),l()(e.italic)||(r.i=Boolean(e.italic)),l()(e.kern)||(r.kern=e.kern),l()(e.spc)||(r.spc=e.spc),l()(e.baseline)||(r.baseline=e.baseline),l()(e.lang)||(r.lang=e.lang),l()(null===(t=e.highlight)||void 0===t?void 0:t.color)||(r.highlight=this.migrateColor(e.highlight.color)),l()(e.hlink)||(r.hlinkClick=this.migrateHLink(e.hlink)),l()(e.effectList)||(r.effectLst=this.migrateEffectLst(e.effectList)),r},this.migrateFont=e=>{if(!e)return;const t={};return l()(e.typeface)||(t.typeface=e.typeface),l()(e.charset)||(t.charset=Number(e.charset)),t},this.migrateSupplementalHansFont=e=>{const t={};return l()(e.Hans)||(t.script="Hans",t.typeface=e.Hans),t},this.migrateSection=e=>{var t;(null===(t=this.ctx.section)||void 0===t?void 0:t.currentSlideIndex)||(this.ctx.section={currentSlideIndex:0});const{currentSlideIndex:r}=this.ctx.section,i={type:p.a.Section,id:this.getId(e.id,"section"),name:e.name,numSlides:e.numSlides};var n;return r<this.ctx.presentation.slideList.length&&(i.firstSlideId=this.getPageId(this.ctx.presentation.slideList[r])),this.ctx.section.currentSlideIndex+=null!==(n=e.numSlides)&&void 0!==n?n:0,i},this.migrateResourceMap=e=>{const t={images:{},videos:{},audios:{},fonts:{}},{imageResource:r={},videoResource:i={},audioResource:n={}}=null!=e?e:{};var o,a,s;for(const[e,{src:i}]of Object.entries(null!==(o=r.resourceMap)&&void 0!==o?o:{})){const r=this.migrateImage(e,i);e&&(t.images[e]=r)}for(const[e,{src:r,size:n,format:o,isExternal:s}]of Object.entries(null!==(a=i.resourceMap)&&void 0!==a?a:{}))e&&(t.videos[e]={id:e,src:r,size:n,format:o,isExternal:s});for(const[e,{src:r,size:i,format:o,isExternal:a}]of Object.entries(null!==(s=n.resourceMap)&&void 0!==s?s:{}))e&&(t.audios[e]={id:e,src:r,size:i,format:o,isExternal:a});return t},this.getImgUrlFromBlipSrc=e=>{var t,r,i,n;const o=null!==(n=null===(i=this.ctx.presentation)||void 0===i||null===(r=i.resource)||void 0===r||null===(t=r.imageResource)||void 0===t?void 0:t.resourceMap)&&void 0!==n?n:{};var a;return e.startsWith("rel:")?null===(a=o[e])||void 0===a?void 0:a.src:e},this.getPrstGeomAdjVal=e=>{if((null==e?void 0:e.startsWith("val"))&&e.indexOf(".")>0){const t=e.slice(3).trim();return`val ${Math.floor(Number(t))}`}return e},this.getPrstGeomAdjName=(e,t,r,i)=>{if(Object.keys(O).includes(r)){const e=O[r];if(t<=e.length)return e[t]}return Array.isArray(i)&&t<i.length?i[t]:1!==e||r.includes("Connector")?`adj${t+1}`:"adj"},this.migrateImage=(e,t)=>{const r=new URL(t);var i,n,o;return{id:e,type:null!==(i=T.b.get(this.getExtname(r.pathname)))&&void 0!==i?i:"",src:t,width:parseInt(null!==(n=r.searchParams.get("w"))&&void 0!==n?n:"",10)||128,height:parseInt(null!==(o=r.searchParams.get("h"))&&void 0!==o?o:"",10)||128}},this.addImageResource=(e,t)=>{if("string"==typeof e){if(e.startsWith("https://")){const r=`rel:${Object(u.g)(e)}`;return this.hasResource(r)||x()(this.ctx.presentation,`resource.imageResource.resourceMap[${r}]`,{id:r,src:e,type:t}),r}return e}},this.hasResource=e=>{var t,r,i,n;const{images:o,videos:a,audios:s,fonts:l}=null!==(n=null===(i=this.ctx.presentation)||void 0===i||null===(r=i.resource)||void 0===r||null===(t=r.imageResource)||void 0===t?void 0:t.resourceMap)&&void 0!==n?n:{};return!!((null==o?void 0:o[e])||(null==a?void 0:a[e])||(null==s?void 0:s[e])||(null==l?void 0:l[e]))},this.ctx={idsMap:{},sessionId:u.d.next(),mediaIdTimingMap:{},connections:[],defaultFont:"",themeList:[]}}}},"1e80909dc5":function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(r("4f3b15d017")),l=o(r("bc3b705d45")),c=r("03f2f6a0c1");!function(e){e.OFF_LINE="offline",e.ON_LINE="online"}(a||(a={}));var d;window.__offlinetest=!1,void 0!==document.hidden?d="visibilitychange":void 0!==document.mozHidden?d="mozvisibilitychange":void 0!==document.msHidden?d="msvisibilitychange":void 0!==document.webkitHidden&&(d="webkitvisibilitychange");var u=function(){function e(e){var t=this;this.cdnSources=l.default.cdnSources,this.autoRun=l.default.autoRun,this.duration=l.default.duration,this.counter=0,this.handleVisibility=function(){document.hidden||document.webkitHidden||document.msHidden||document.mozHidden?(t.duration=3e5,t.pause(),t.startCheck()):(t.duration=6e4,t.pause(),t.startCheck())},this.handleNetstatus=function(){return i(t,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return e=this,[4,this.netcheck()];case 1:return e.status=t.sent(),this.handleCalback(),[2]}}))}))},this.setConfig(e),this.status=this.navigatorOnlineStatus,this.netchecksource=this.cdnSources[0],this.callbacks=[],this.autoRun&&this.init()}return e.create=function(t){return new e(t)},e.getInstance=function(t){return e.instance||(e.instance=e.create(t)),e.instance},e.prototype.setConfig=function(e){var t=e.cdnSources,r=void 0===t?this.cdnSources:t,i=e.ignoreDefaultSources,n=void 0===i?l.default.ignoreDefaultSources:i,o=e.autoRun,a=void 0===o?this.autoRun:o,s=e.duration,c=void 0===s?this.duration:s;Array.isArray(r)&&(this.cdnSources=n?r:this.cdnSources.concat(r)),this.autoRun=!!a,Number.isInteger(c)&&(this.duration=c)},e.prototype.getVersion=function(){return e.version},e.prototype.init=function(){return i(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return[4,this.preNetCheck()];case 1:return e=t.sent(),this.status=e,this.bindVisibility(),this.bindNetStatus(),this.startCheck(),[2]}}))}))},Object.defineProperty(e.prototype,"isOnline",{get:function(){return!window.__offlinetest&&this.status===a.ON_LINE},enumerable:!1,configurable:!0}),e.prototype.changeEnd=function(e){this.callbacks.push(e)},e.prototype.extendCallbacks=function(e){this.callbacks=this.callbacks.concat(e.slice())},e.prototype.getCallbacks=function(){return this.callbacks},e.prototype.remove=function(e){for(var t=this.callbacks.slice(0,this.callbacks.length),r=0;r<t.length;r++)t[r]===e&&(t.splice(r,1),this.callbacks=t)},e.prototype.handleCalback=function(){var e=this;this.callbacks.forEach((function(t){t(e.status)}))},e.prototype.destory=function(){window.mqq&&s.default.isAndroid&&(s.default.isTencentDocsApp||s.default.isTimOrQQ)&&!s.default.isQQMiniProgram?window.mqq.removeEventListener("qbrowserVisibilityChange",this.handleVisibility):document.removeEventListener(d,this.handleVisibility),this.pause(),window.removeEventListener(a.ON_LINE,this.handleNetstatus),window.removeEventListener(a.OFF_LINE,this.handleNetstatus)},e.prototype.bindNetStatus=function(){window.addEventListener(a.ON_LINE,this.handleNetstatus),window.addEventListener(a.OFF_LINE,this.handleNetstatus)},e.prototype.bindVisibility=function(){window.mqq&&s.default.isAndroid&&(s.default.isTencentDocsApp||s.default.isTimOrQQ)&&!s.default.isQQMiniProgram?window.mqq.addEventListener("qbrowserVisibilityChange",this.handleVisibility):document.addEventListener(d,this.handleVisibility)},e.prototype.pause=function(){clearInterval(this.Timer),this.Timer=null},e.prototype.startCheck=function(){var e=this;this.Timer=window.setInterval((function(){return i(e,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,this.polling()];case 1:return e.sent(),[2]}}))}))}),this.duration)},e.prototype.polling=function(){return i(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return this.preCheckOnlineStatus?[3,1]:(this.status=this.navigatorOnlineStatus,[3,3]);case 1:return e=this,[4,this.netcheck()];case 2:e.status=t.sent(),t.label=3;case 3:return this.counter>=15?[4,this.preNetCheck()]:[3,5];case 4:return t.sent(),this.counter=0,[3,6];case 5:this.counter+=1,t.label=6;case 6:return this.handleCalback(),[2]}}))}))},Object.defineProperty(e.prototype,"navigatorOnlineStatus",{get:function(){return window.navigator.onLine?a.ON_LINE:a.OFF_LINE},enumerable:!1,configurable:!0}),e.prototype.preNetCheck=function(){return i(this,void 0,void 0,(function(){var e=this;return n(this,(function(t){return[2,new Promise((function(t){var r=e.cdnSources.map((function(t){return e.sourceCheck(t)}));c.promiseAny(r).then((function(r){e.preCheckOnlineStatus=!0,e.netchecksource=r,t(a.ON_LINE)})).catch((function(){e.preCheckOnlineStatus=!1,t(a.OFF_LINE)}))}))]}))}))},e.prototype.sourceCheck=function(e){return i(this,void 0,void 0,(function(){var t;return n(this,(function(r){return t=new Image,[2,new Promise((function(r,i){t.onload=function(){r(e)},t.onerror=function(){i(e+" load fail")},t.src=e+"?t="+Date.now()}))]}))}))},e.prototype.netcheck=function(){return i(this,void 0,void 0,(function(){var e=this;return n(this,(function(t){return this.netcheckImage||(this.netcheckImage=new Image),[2,new Promise((function(t){e.netcheckImage.onload=function(){t(a.ON_LINE)},e.netcheckImage.onerror=function(){t(a.OFF_LINE)},e.netcheckImage.src=e.netchecksource+"?t="+Date.now()}))]}))}))},e.version=l.default.version,e}();t.default=u},"2376e903be":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return m}));var i=r("d7c625d1f2"),n=r("9fb5ff8c6f"),o=r("5d64cf765d"),a=function(){function e(e,t,r,i){var n,a=this;this.mode=e,this.proxyCursor=t,this.direction=r,this.engineAspects=i,this.delete=void 0,this.update=void 0,e!==o.j.READ_ONLY&&(this.delete=function(){return a.getProxyCursorWithMode().delete()},this.update=function(e){return a.getProxyCursorWithMode().update(e)}),(null===(n=this.engineAspects)||void 0===n?void 0:n.cursor)&&this.applyAspectPatch()}return e.prototype[Symbol.asyncIterator]=function(){return new s(this)},e.prototype.next=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.proxyCursor.continue()];case 1:return(e=t.sent())?(this.proxyCursor=e,[2,this]):[2,null]}}))}))},e.prototype.value=function(){return this.proxyCursor.value},e.prototype.getProxyCursorWithMode=function(){return this.proxyCursor},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.cursor;if(this.mode!==o.j.READ_ONLY){null==t||t.delete.patch(this,"delete"),null==t||t.update.patch(this,"update")}null==t||t.next.patch(this,"next"),null==t||t.value.patch(this,"value")},e}(),s=function(){function e(e){this.currentCursor=e}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.next=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return this.currentCursor?(e=this.currentCursor.value(),t=this,[4,this.currentCursor.next()]):[2,{value:void 0,done:!0}];case 1:return t.currentCursor=r.sent(),[2,{value:e,done:!1}]}}))}))},e}(),l=function(){function e(e,t,r,i){this.table=e,this.proxyIndex=t,this.mode=r,this.engineAspects=i,this.name=t.name,this.keyPath=t.keyPath,this.unique=t.unique,(null==i?void 0:i.index)&&this.applyAspectPatch()}return e.prototype.getAll=function(e){return this.proxyIndex.getAll(e)},e.prototype.getAllKeys=function(e,t){return this.proxyIndex.getAllKeys(e,t)},e.prototype.get=function(e){return this.proxyIndex.get(e)},e.prototype.openCursor=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.proxyIndex.openCursor(e,t)];case 1:return(r=i.sent())?[2,new a(this.mode,r,null!=t?t:"next")]:[2,null]}}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.index,r=this;null==t||t.get.patch(r,"get"),null==t||t.getAll.patch(r,"getAll"),null==t||t.getAllKeys.patch(r,"getAllKeys"),null==t||t.openCursor.patch(r,"openCursor")},e}(),c=function(){function e(e,t,r,n){this.mode=e,this.objectStore=t,this.engineAspects=r,this.transaction=n,this.createIndex=void 0,this.delete=void 0,this.bulkDelete=void 0,this.clear=void 0,this.insert=void 0,this.upsert=void 0,this.deleteIndex=void 0,this.bulkUpsert=void 0,this.keyPath=t.keyPath,this.autoIncrement=t.autoIncrement,this.tableName=t.name,this.indexNames=Object(i.__spreadArray)([],Object(i.__read)(t.indexNames)),this.initWriteFun(e),(null==r?void 0:r.table)&&this.applyAspectPatch()}return e.prototype.query=function(){throw new Error("query Method is not support for IDB.")},e.prototype.supports=function(e){return!["query","bulkDelete"].includes(e)},e.prototype.index=function(e){var t=this.objectStore.index(e);return new l(this,t,this.mode,this.engineAspects)},e.prototype.getAll=function(e){return this.objectStore.getAll(e)},e.prototype.getAllKeys=function(e,t){return this.objectStore.getAllKeys(e,t)},e.prototype.get=function(e){var t;return null!==(t=this.objectStore.get(e))&&void 0!==t?t:null},e.prototype.openCursor=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.objectStore.openCursor(e,t)];case 1:return(r=i.sent())?[2,new a(this.mode,r,null!=t?t:"next")]:[2,null]}}))}))},e.prototype.initWriteFun=function(e){var t=this;e===o.j.VERSION_CHANGE&&(this.createIndex=this.createIndexFun,this.deleteIndex=function(e){return t.getProxyObjectStoreWithMode().deleteIndex(e)}),e!==o.j.READ_ONLY&&(this.delete=function(e){return t.getProxyObjectStoreWithMode().delete(e)},this.bulkDelete=function(e){throw new Error("bulkDelete Method is not support for IDB.")},this.clear=function(){return t.getProxyObjectStoreWithMode().clear()},this.insert=function(e){return t.getProxyObjectStoreWithMode().add(e)},this.upsert=function(e){return t.getProxyObjectStoreWithMode().put(e)},this.bulkUpsert=function(e){var r=t.getProxyObjectStoreWithMode(),i=e.reduce((function(e,t){return e.push(r.put(t)),e}),[]);return Promise.all(i)})},e.prototype.createIndexFun=function(e,t,r){var i=this.getProxyObjectStoreWithMode();return new l(this,i.createIndex(e,t,r),this.mode)},e.prototype.getProxyObjectStoreWithMode=function(){return this.objectStore},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.table;if(this.mode===o.j.READ_ONLY)return null==t||t.get.patch(this,"get"),null==t||t.getAll.patch(this,"getAll"),null==t||t.getAllKeys.patch(this,"getAllKeys"),null==t||t.index.patch(this,"index"),void(null==t||t.openCursor.patch(this,"openCursor"));this.mode===o.j.VERSION_CHANGE&&(null==t||t.createIndex.patch(this,"createIndex"),null==t||t.deleteIndex.patch(this,"deleteIndex")),null==t||t.delete.patch(this,"delete"),null==t||t.insert.patch(this,"insert"),null==t||t.upsert.patch(this,"upsert"),null==t||t.bulkUpsert.patch(this,"bulkUpsert"),null==t||t.clear.patch(this,"clear")},e}(),d=function(){function e(e,t){this.proxyTransaction=e,this.engineAspects=t,this.tables=e.objectStoreNames,this.mode=e.mode,(null==t?void 0:t.transaction)&&this.applyAspectPatch()}return e.prototype.table=function(e){var t=this.proxyTransaction.objectStore(e);return new c(this.mode,t,this.engineAspects,this)},e.prototype.commit=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.proxyTransaction.done];case 1:return e.sent(),[3,3];case 2:return e.sent(),[2,!1];case 3:return[2,!0]}}))}))},e.prototype.rollback=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,1,,6]),this.proxyTransaction.abort(),[3,6];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,this.proxyTransaction.done];case 3:return e.sent(),[3,5];case 4:return e.sent(),[2,!0];case 5:return[2,!1];case 6:return[2,!0]}}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.transaction,r=this;null==t||t.commit.patch(r,"commit"),null==t||t.rollback.patch(r,"rollback"),null==t||t.table.patch(r,"table")},e}(),u=function(){function e(e,t){this.idbDatabase=e,this.engineAspect=t,this.name=e.name,this.version=e.version,this.tableNames=Object(i.__spreadArray)([],Object(i.__read)(e.objectStoreNames)),this.engineAspect&&this.applyAspectPatch()}return e.prototype.setVersionChangeListener=function(e){this.idbDatabase.addEventListener("versionchange",(function(t){e(t.oldVersion,t.newVersion)}))},e.prototype.close=function(){this.idbDatabase.close()},e.prototype.createTable=function(e,t){var r=this.idbDatabase.createObjectStore(e,t);return new c(o.j.VERSION_CHANGE,r)},e.prototype.deleteTable=function(e){this.idbDatabase.deleteObjectStore(e)},e.prototype.transaction=function(e,t){var r=this.idbDatabase.transaction(e,t);return new d(r,this.engineAspect)},e.prototype.table=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,n,o;return Object(i.__generator)(this,(function(i){return r=this.idbDatabase.transaction([e],t),n=new d(r),o=r.objectStore(e),[2,new c(t,o,this.engineAspect,n)]}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspect)||void 0===e?void 0:e.database;null==t||t.deleteTable.patch(this,"deleteTable"),null==t||t.createTable.patch(this,"createTable"),null==t||t.transaction.patch(this,"transaction"),null==t||t.table.patch(this,"table"),null==t||t.close.patch(this,"close")},e}();var p=function(e,t){var r=typeof e,i=typeof t;if(isNaN(e)||isNaN(t))return indexedDB.cmp(e,t);if(r===i){if("number"===r||"bigint"===r)return e-t;if("string"===r)return function(e,t){return e<t?-1:+(e>t)}(e,t)}return e instanceof Date&&t instanceof Date?e.getTime()-t.getTime():indexedDB.cmp(e,t)},h=r("7b66f04f1e").a.withDefaultMessage("IndexedDB is missing in global context. Consider using `indexeddbshim` for better compatibility or `fake-indexeddb` in your test environment."),m=function(){function e(){if("undefined"==typeof indexedDB)throw new h;this.cmp=p}return e.prototype.deleteDB=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,n.a(e)]}))}))},e.prototype.setAspects=function(e){this.engineAspects=e,this.engineAspects.openDB.patch(this,"openDB"),this.engineAspects.deleteDB.patch(this,"deleteDB")},e.prototype.openDB=function(e,t,r,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,a=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,n.b(e,r,{upgrade:function(e,t,r,i){var n;null===(n=null==o?void 0:o.upgrade)||void 0===n||n.call(o,new u(e,a.engineAspects),t,r,new d(i))},blocked:function(){var e;return null===(e=null==o?void 0:o.blocked)||void 0===e?void 0:e.call(o)},blocking:function(){var e;return null===(e=null==o?void 0:o.blocking)||void 0===e?void 0:e.call(o)},terminated:function(){var e;return null===(e=null==o?void 0:o.terminated)||void 0===e?void 0:e.call(o)}})];case 1:return t=i.sent(),[2,new u(t,this.engineAspects)]}}))}))},e}()},"27b8f08537":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r("4b7c0e9a18"),n=r("7df2e5fb1e");class o extends i.a{decode(e,t){return super.decode(n.a.toUint8Array(e),t,((e,t,r)=>{var i,n;t.endsWith("I")&&!0===r&&(e[t.slice(0,-1)]=null),null===(i=(n=this.processors).decode)||void 0===i||i.call(n,e,t,r)}))}encode(e,t){return super.encode(e,t,((e,t,r)=>{var i,n;null===r&&(e[`${t}I`]=!0),null===(i=(n=this.processors).encode)||void 0===i||i.call(n,e,t,r)}))}constructor(...e){super(...e),this.processors={}}}o.codec=new o},"27ba227690":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r("29d6d62747");class n extends i.a{setChart(e){this.chart=e}getChart(){return this.chart}}},"29d6d62747":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));class i{setTarget(e){this.target=e}getTarget(){return this.target}getPageType(){return this.parent.getPageType()}getPage(){return this.parent.getPage()}getSlide(){return this.parent.getSlide()}getLayout(){return this.parent.getLayout()}getMaster(){return this.parent.getMaster()}getTheme(){return this.parent.getTheme()}getThemeContext(){return this.parent.getThemeContext()}getPlaceholder(e){return this.parent.getPlaceholder(e)}getPresentation(){return this.parent.getPresentation()}constructor(e){this.parent=e}}},"2a19a81d63":function(e,t,r){"use strict";r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return h}));var i,n=r("d7c625d1f2"),o=r("7b66f04f1e"),a=o.a.withMessageCreator("UnexpectedModifierError",(function(e){return'unexpected error occurred at the "'+e+'" stage of the plugable function, there may be a bug in your modifiers.'})),s=o.a.withMessageCreator("InvalidPatchedFunctionError",(function(e){return'patched target is not a function, patched key is "'+e+'"'}));!function(e){e.before="before",e.around="around",e.return="return",e.throw="throw",e.after="after",e.protect="protect"}(i||(i={}));var l=function(){function e(e){this.modifiers={before:[],around:[],return:[],throw:[],after:[],protect:[]},this.createContext=e}return e.prototype.before=function(e){return this.modifiers.before.push(e),this},e.prototype.around=function(e){return this.modifiers.around.push(e),this},e.prototype.throw=function(e){return this.modifiers.throw.push(e),this},e.prototype.return=function(e){return this.modifiers.return.push(e),this},e.prototype.after=function(e){return this.modifiers.after.push(e),this},e.prototype.protect=function(e){return this.modifiers.protect.push(e),this},e.prototype.patch=function(e,t){Object.defineProperty(e,t,{enumerable:!1,value:this.compile(e,t),writable:!0,configurable:!0})},e.prototype.dirty=function(){return Object.values(this.modifiers).some((function(e){return e.length}))},e.prototype.compile=function(e,t){var r=e[t];if("function"!=typeof r)throw new s(t);var i=this.invoke.bind(this);return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(r,this,e)}},e}(),c=l,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.create=function(){return new t((function(){return{}}))},t.withContext=function(e){return new t(e)},t.prototype.invoke=function(e,t,r){var o;if(!this.dirty())return e.call.apply(e,Object(n.__spreadArray)([t],Object(n.__read)(r)));var a=Object.assign(this.createContext(),{args:r,this:t,callee:e,return:void 0,error:void 0});try{this.trigger(i.before,a,this.modifiers.protect),this.modifiers.around.length?this.trigger(i.around,a,this.modifiers.protect):a.return=(o=a.callee).call.apply(o,Object(n.__spreadArray)([a.this],Object(n.__read)(a.args))),this.trigger(i.return,a,this.modifiers.protect)}catch(e){throw this.modifiers.throw.length&&(Object.assign(a,{error:e}),this.trigger(i.throw,a,this.modifiers.protect)),e}finally{this.trigger(i.after,a,this.modifiers.protect)}return a.return},t.prototype.trigger=function(e,t,r){var i,s,l,c;try{for(var d=Object(n.__values)(this.modifiers[e]),u=d.next();!u.done;u=d.next()){var p=u.value;try{p.call(t.this,t)}catch(i){if(!r.length){Object(o.c)(new a(e,i));continue}try{for(var h=(l=void 0,Object(n.__values)(r)),m=h.next();!m.done;m=h.next()){var f=m.value;Object.assign(t,{error:i}),f.call(t.this,t)}}catch(e){l={error:e}}finally{try{m&&!m.done&&(c=h.return)&&c.call(h)}finally{if(l)throw l.error}}}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}},t}(c),u=d,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.create=function(){return new t((function(){return{}}))},t.withContext=function(e){return new t(e)},t.prototype.invoke=function(e,t,r){var o=this;if(!this.dirty())return e.call.apply(e,Object(n.__spreadArray)([t],Object(n.__read)(r)));var a=Object.assign(this.createContext(),{args:r,this:t,callee:e,return:void 0,error:void 0});return new Promise((function(e,t){Object(n.__awaiter)(o,void 0,void 0,(function(){var e,t,r,o;return Object(n.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,7,10,12]),[4,this.trigger(i.before,a,this.modifiers.protect)];case 1:return s.sent(),this.modifiers.around.length?[3,3]:(e=(o=a.callee).call.apply(o,Object(n.__spreadArray)([a.this],Object(n.__read)(a.args))),t=a,[4,e]);case 2:return t.return=s.sent(),[3,5];case 3:return[4,this.trigger(i.around,a,this.modifiers.protect)];case 4:s.sent(),s.label=5;case 5:return[4,this.trigger(i.return,a,this.modifiers.protect)];case 6:return s.sent(),[3,12];case 7:return r=s.sent(),Object.assign(a,{error:r}),this.modifiers.throw.length?[4,this.trigger(i.throw,a,this.modifiers.protect)]:[3,9];case 8:s.sent(),s.label=9;case 9:throw r;case 10:return[4,this.trigger(i.after,a,this.modifiers.protect)];case 11:return s.sent(),[7];case 12:return[2]}}))})).then((function(){e(a.return)})).catch((function(e){t(e)}))}))},t.prototype.trigger=function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,s,l,c,d,u,p,h,m,f,g,b,v;return Object(n.__generator)(this,(function(y){switch(y.label){case 0:y.trys.push([0,15,16,17]),i=Object(n.__values)(this.modifiers[e]),s=i.next(),y.label=1;case 1:if(s.done)return[3,14];l=s.value,y.label=2;case 2:return y.trys.push([2,4,,13]),[4,l.call(t.this,t)];case 3:return y.sent(),[3,13];case 4:if(c=y.sent(),!r.length)return Object(o.c)(new a(e,c)),[3,13];y.label=5;case 5:y.trys.push([5,10,11,12]),b=void 0,d=Object(n.__values)(r),u=d.next(),y.label=6;case 6:return u.done?[3,9]:(p=u.value,Object.assign(t,{error:c}),[4,p.call(t.this,t)]);case 7:y.sent(),y.label=8;case 8:return u=d.next(),[3,6];case 9:return[3,12];case 10:return h=y.sent(),b={error:h},[3,12];case 11:try{u&&!u.done&&(v=d.return)&&v.call(d)}finally{if(b)throw b.error}return[7];case 12:return[3,13];case 13:return s=i.next(),[3,1];case 14:return[3,17];case 15:return m=y.sent(),f={error:m},[3,17];case 16:try{s&&!s.done&&(g=i.return)&&g.call(i)}finally{if(f)throw f.error}return[7];case 17:return[2]}}))}))},t}(c),h=p},"2a81537ef9":function(e,t,r){"use strict";var i,n,o,a;r.d(t,"s",(function(){return i})),r.d(t,"h",(function(){return o})),r.d(t,"o",(function(){return s})),r.d(t,"u",(function(){return c})),r.d(t,"a",(function(){return h})),r.d(t,"n",(function(){return m})),r.d(t,"j",(function(){return v})),r.d(t,"k",(function(){return y})),r.d(t,"t",(function(){return S})),r.d(t,"l",(function(){return x})),r.d(t,"b",(function(){return _})),r.d(t,"p",(function(){return T})),r.d(t,"i",(function(){return O})),r.d(t,"r",(function(){return P})),r.d(t,"q",(function(){return C})),r.d(t,"c",(function(){return I})),r.d(t,"e",(function(){return A})),r.d(t,"d",(function(){return k})),r.d(t,"f",(function(){return D})),r.d(t,"m",(function(){return R})),r.d(t,"g",(function(){return M})),function(e){e.Save="SAVE",e.SaveAs="SAVE_AS",e.SaveByE2E="SAVE_BY_E2E",e.AutoSave="AUTO_SAVE",e.Rename="RENAME"}(i||(i={})),function(e){e.ConvertOnlineSave="convertOnlineSave",e.LocalSave="localSave",e.Save4Close="save4Close"}(n||(n={})),function(e){e.CloseTab="close-tab",e.ContentModified="content-modified",e.UpdateTitle="update-title",e.TimeTrack="time-track",e.Save="save"}(o||(o={})),function(e){e.Current="current",e.AutoSave="auto-save",e.Origin="origin"}(a||(a={}));var s,l=r("cf24892fbf");!function(e){e.Play="play",e.Pause="pause",e.Stop="stop",e.Close="close",e.TogglePause="toggle-pause",e.ToggleMute="toggle-mute",e.SetVolume="set-volume",e.SetPosition="set-position",e.SetRate="set-rate",e.SetTime="set-time",e.SetMute="set-mute",e.FrameSetup="frame-setup",e.FrameReady="frame-ready",e.TimeChanged="time-changed",e.LengthChanged="length-changed",e.PositionChanged="position-changed",e.Opening="opening",e.Playing="playing",e.Paused="paused",e.Stopped="stopped",e.Backward="backward",e.Buffering="buffering",e.EncounteredError="encountered-error",e.EndReached="end-reached",e.Forward="forward",e.FrameCleanup="frame-cleanup",e.MediaChanged="media-changed",e.NothingSpecial="nothing-special",e.PausableChanged="pausable-changed",e.SeekableChanged="seekable-changed",e.LogMessage="log-message"}(s||(s={}));const c=`${l.a}:WebChimeraAPI`;var d,u,p,h,m,f,g,b,v,y,S,x,_,T,O;!function(e){e.Head="head",e.Chunk="chunk",e.End="end",e.Abort="abort",e.FatalError="fatal-error",e.CaptureError="capture-error",e.RequestAbort="abort"}(d||(d={})),function(e){e.ReadCache="read-cache"}(u||(u={})),function(e){e.JSONSaved="json-saved",e.DocumentSaved="document-saved",e.Cancel="cancel",e.Abort="abort",e.FatalError="fatal-error",e.CaptureError="capture-error"}(p||(p={})),function(e){e[e.None=0]="None",e[e.IOShareViolationError=4003]="IOShareViolationError",e[e.IONotFoundError=4004]="IONotFoundError",e[e.IOUnauthorizedAccessError=4005]="IOUnauthorizedAccessError",e[e.IOUnavailableError=4006]="IOUnavailableError",e[e.DocumentEncryptedError=4001]="DocumentEncryptedError",e[e.DocumentBrokenPackageError=4021]="DocumentBrokenPackageError",e[e.DocumentBrokenOOXMLError=4022]="DocumentBrokenOOXMLError",e[e.OutOfSpaceError=4013]="OutOfSpaceError",e[e.MissingConverterError=5e3]="MissingConverterError",e[e.UnsupportedSystemEnvironmentError=5001]="UnsupportedSystemEnvironmentError",e[e.ComponentFetchError=5002]="ComponentFetchError",e[e.ComponentExecuteError=5003]="ComponentExecuteError",e[e.UnexpectedFormatConvertError=5004]="UnexpectedFormatConvertError",e[e.UnexpectedProcessKilledError=5005]="UnexpectedProcessKilledError",e[e.UnexpectedOutputFormatError=5006]="UnexpectedOutputFormatError",e[e.UIModelError=5007]="UIModelError",e[e.UnexpectedInputIOError=5008]="UnexpectedInputIOError",e[e.UnexpectedInputFormatError=5009]="UnexpectedInputFormatError",e[e.UnexpectedFormatConvertNoEndError=5010]="UnexpectedFormatConvertNoEndError",e[e.UnsupportedAppEnvironmentError=5011]="UnsupportedAppEnvironmentError",e[e.CacheDataIOError=5012]="CacheDataIOError",e[e.UnknownError=5120]="UnknownError"}(h||(h={})),function(e){e[e.ErrorUnknown=23e3]="ErrorUnknown",e[e.ImageUploadError=23005]="ImageUploadError",e[e.ImageDownloadError=23006]="ImageDownloadError"}(m||(m={})),function(e){e.InstallProgress="install-progress",e.InstallError="install-error",e.Installed="installed",e.Uninstalled="uninstalled",e.UninstallError="uninstall-error"}(f||(f={})),function(e){e.WillRetrieveManifest="will-retrieve-manifest",e.WillDownload="will-download",e.WillValidate="will-validate",e.WillUnarchive="will-unarchive",e.WillInstall="will-install",e.DidInstall="did-install"}(g||(g={})),function(e){e.DLL="dll",e.Executable="executable",e.Asset="asset",e.Addon="addon"}(b||(b={})),function(e){e.Next="next",e.Chunk="chunk",e.End="end",e.Error="error"}(v||(v={})),function(e){e.Saved="saved",e.Cancel="cancel",e.Error="error"}(y||(y={})),function(e){e.NotSupported="not-supported",e.StatError="stat-error"}(S||(S={})),function(e){e[e.kSuccess=0]="kSuccess",e[e.kUnknownDocsType=14001]="kUnknownDocsType",e[e.kFileNotExist=14002]="kFileNotExist",e[e.kInvalidFilesystem=14003]="kInvalidFilesystem",e[e.kFilesystemEmitError=14004]="kFilesystemEmitError",e[e.kTreewalkerEmitError=14005]="kTreewalkerEmitError",e[e.kInvalidRefResolver=14006]="kInvalidRefResolver",e[e.kInvalidPackageContext=14007]="kInvalidPackageContext",e[e.kInvalidPartContext=14008]="kInvalidPartContext",e[e.kInvalidPackageDescriptor=14009]="kInvalidPackageDescriptor",e[e.kInvalidPartDescriptor=14010]="kInvalidPartDescriptor",e[e.kInvalidPackageStrategy=14011]="kInvalidPackageStrategy",e[e.kInvalidPartStrategy=14012]="kInvalidPartStrategy",e[e.kInvalidAssetPart=14013]="kInvalidAssetPart",e[e.kPasswordRequired=14014]="kPasswordRequired",e[e.kInvalidPassword=14015]="kInvalidPassword",e[e.kInvalidEncryptionContext=14016]="kInvalidEncryptionContext",e[e.kInvalidImportConfig=14017]="kInvalidImportConfig",e[e.kInvalidNamespaceWhenSeekSectpr=14018]="kInvalidNamespaceWhenSeekSectpr",e[e.kImportCancel=14019]="kImportCancel",e[e.kNotSupported=14020]="kNotSupported",e[e.kInvalidImportCache=14021]="kInvalidImportCache",e[e.kInvalidSheetRef=14022]="kInvalidSheetRef",e[e.kInvalidDrawRef=14023]="kInvalidDrawRef",e[e.kInvalidChartRef=14024]="kInvalidChartRef",e[e.kLostRequiredData=14025]="kLostRequiredData",e[e.kInvalidPivotTableRef=14026]="kInvalidPivotTableRef",e[e.kEmptySheetCell=14027]="kEmptySheetCell",e[e.kInvalidSheetId=14028]="kInvalidSheetId",e[e.kSheetDimensionLimited=14029]="kSheetDimensionLimited",e[e.kPresentationPrNotEnough=14030]="kPresentationPrNotEnough",e[e.kSlideMasterNotFound=14031]="kSlideMasterNotFound",e[e.kSlideChunkPageEmptyError=1077]="kSlideChunkPageEmptyError"}(x||(x={})),function(e){e[e.ErrorUnknown=23e3]="ErrorUnknown",e[e.ErrorBusy=23001]="ErrorBusy",e[e.ErrorNotEntity=23002]="ErrorNotEntity",e[e.ErrorPermittion=23003]="ErrorPermittion",e[e.ErrorConverterInstall=23090]="ErrorConverterInstall"}(_||(_={})),function(e){e[e.ErrorUnknown=23e3]="ErrorUnknown",e[e.DomainError=23001]="DomainError",e[e.RequestParseError=23002]="RequestParseError",e[e.IOResultParseError=23003]="IOResultParseError",e[e.FileNoExist=23004]="FileNoExist",e[e.ImageUploadError=23005]="ImageUploadError",e[e.ImageDownloadError=23006]="ImageDownloadError",e[e.FileReadFailed=23007]="FileReadFailed",e[e.NotImplemented=23999]="NotImplemented"}(T||(T={})),function(e){e[e.kUnknownDocsType=15001]="kUnknownDocsType",e[e.kInvalidFileHandle=15002]="kInvalidFileHandle",e[e.kRequiredVisitor=15003]="kRequiredVisitor",e[e.kInvalidPartStrategy=15004]="kInvalidPartStrategy",e[e.kEmptyDataContent=15005]="kEmptyDataContent",e[e.kLostPartVisitor=15006]="kLostPartVisitor",e[e.kExportPBToXFailed=15007]="kExportPBToXFailed",e[e.kEmbedFontFileNotExist=15008]="kEmbedFontFileNotExist",e[e.kEmbedFontOriginFileOpenError=15009]="kEmbedFontOriginFileOpenError",e[e.kEmbedFontDstFileOpenError=15010]="kEmbedFontDstFileOpenError",e[e.kInvalidOOXMLNode=15011]="kInvalidOOXMLNode",e[e.kEncryptFileFailed=15012]="kEncryptFileFailed",e[e.kExportCancel=15013]="kExportCancel",e[e.kInvalidSheetModel=15014]="kInvalidSheetModel",e[e.kInvalidWorksheetId=15015]="kInvalidWorksheetId",e[e.kInvalidWorksheetChartData=15016]="kInvalidWorksheetChartData",e[e.kInvalidPivotTable=15017]="kInvalidPivotTable",e[e.kInvalidPivotCacheDefinitions=15018]="kInvalidPivotCacheDefinitions",e[e.kInvalidPivotCacheRecords=15019]="kInvalidPivotCacheRecords",e[e.kInvalidSheetPivotTable=15020]="kInvalidSheetPivotTable",e[e.kInvalidSheetSharedStringCache=15021]="kInvalidSheetSharedStringCache",e[e.kInvalidSheetFrozenProperty=15022]="kInvalidSheetFrozenProperty",e[e.kInvalidSheetChart=15023]="kInvalidSheetChart",e[e.kInvalidSheetComment=15024]="kInvalidSheetComment",e[e.kAllWorksheetAreHidden=15025]="kAllWorksheetAreHidden",e[e.kInvalidSlideModel=15026]="kInvalidSlideModel",e[e.kEmptySlideViewPr=15027]="kEmptySlideViewPr",e[e.kEmptyTableStyleList=15028]="kEmptyTableStyleList",e[e.kEmptyPresPros=15029]="kEmptyPresPros",e[e.kInvalidSlideId=15030]="kInvalidSlideId",e[e.kInvalidSlideMasterId=15031]="kInvalidSlideMasterId",e[e.kInvalidNotesSlideId=15032]="kInvalidNotesSlideId",e[e.kNotesMasterNotFound=15033]="kNotesMasterNotFound",e[e.kInvalidSlideSection=15034]="kInvalidSlideSection",e[e.kSlideTableNotFound=15035]="kSlideTableNotFound"}(O||(O={}));const P=Object.assign(Object.assign({},x),T),C=Object.assign(Object.assign({},O),T);var I,w,E,j,A,L,k,D;!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.Form=2]="Form",e[e.Slide=4]="Slide",e[e.PDF=6]="PDF",e[e.MIND=90]="MIND",e[e.FLOWCHART=91]="FLOWCHART"}(I||(I={})),function(e){e.FINISH_LOAD="FINISH_LOAD",e.FINISH_DISPLAY="FINISH_DISPLAY",e.BEGIN_DUMP="BEGIN_DUMP",e.MOBILE_PERFERMANCE="MOBILE_PERFERMANCE"}(w||(w={})),function(e){e.CAN_VIEW="can_view",e.CAN_INTERACT="can_interact",e.CAN_EDIT="can_edit"}(E||(E={})),function(e){e.Complete="complete",e.ReadCache="read-cache"}(j||(j={})),function(e){e.Data="data",e.Abort="abort",e.ConverterError="converter-error",e.ContinueWithPassword="continue-with-password",e.DesktopError="desktop-error",e.MobileError="mobile-error"}(A||(A={})),function(e){e[e.SlideFile=0]="SlideFile"}(L||(L={})),function(e){e.Head="head",e.Chunk="chunk",e.End="end",e.Abort="abort",e.Error="error",e.ContinueWithPassword="continue-with-password"}(k||(k={})),function(e){e.JSONSaved="json-saved",e.DocumentSaved="document-saved",e.Cancel="cancel",e.Abort="abort",e.ConverterError="converter-error",e.DesktopError="desktop-error",e.MobileError="mobile-error"}(D||(D={}));var R,M;!function(e){e.PARSE_HTML="parse_html",e.INIT_LOCAL_EDIT="init_local_edit",e.ENGINE_INSTALLED="engine_installed",e.FIRST_CHUNK_FETCHED="first_chunk_fetched",e.ALL_CHUNKS_FETCHED="all_chunks_fetched",e.CAN_VIEW="can_view",e.CAN_INTERACT="can_interact",e.CAN_EDIT="can_edit"}(R||(R={})),function(e){e.BEGIN_DUMP="begin_dump",e.FINISH_DUMP="finish_dump"}(M||(M={}))},"2adf4df3b8":function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));r("1bab7b5fb7"),r("9d7978d445"),r("34cd92f77a");var i=new(r("262843d1f7").b);function n(){return i.next()}function o(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/","&#x60;":"`","&#x3D;":"="};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;|&#x60;|&#x3D;/g,(function(e){return t[e]}))}function a(e){try{return JSON.parse(e)}catch(e){return null}}},"33fdb9613c":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var i=r("711a53c9fc");const n=[i.U.dt,i.U.ftr,i.U.sldNum],o=4294967295},"3ac5e24f6b":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r("711a53c9fc"),n=r("b09773c80f");const o="Arial",a={"+mn-lt":["minorFont","latin"],"+mn-ea":["minorFont","ea"],"+mj-lt":["majorFont","latin"],"+mj-ea":["majorFont","ea"]},s={[i.z.PBDEFAULT]:void 0,[i.z.major]:"majorFont",[i.z.minor]:"minorFont",[i.z.none]:void 0},l=Object.values(i.eb).filter((e=>"string"!=typeof e));class c extends n.a{static shouldUseSchemeFont(e){return/\+m[nj]-../.test(e)}static getFontStyleByFontCollection(e){return{latin:{typeface:c.getSchemeFontInCollection("latin",e)},ea:{typeface:c.getSchemeFontInCollection("ea",e)}}}static getSchemeFontInCollection(e,t){var r,i,n,a,s;return"ea"===e?(null==t||null===(i=t.ea)||void 0===i?void 0:i.typeface)||(null==t||null===(a=t.font)||void 0===a||null===(n=a.find((e=>"Hans"===e.script)))||void 0===n?void 0:n.typeface)||(null==t||null===(s=t.latin)||void 0===s?void 0:s.typeface)||o:(null==t||null===(r=t[e])||void 0===r?void 0:r.typeface)||o}get themeElements(){var e;return null===(e=this.theme)||void 0===e?void 0:e.props.themeElements}resolveFontTypeface(e){var t,r;if(!Object.keys(a).includes(e))return e;const[i,n]=a[e];return c.getSchemeFontInCollection(n,null===(r=this.themeElements)||void 0===r||null===(t=r.fontScheme)||void 0===t?void 0:t[i])}getFontCollectionStyleByIndex(e=i.z.PBDEFAULT){var t,r;const n=s[e];if(n)return null===(r=this.themeElements)||void 0===r||null===(t=r.fontScheme)||void 0===t?void 0:t[n]}getSchemeColorMap(){return this.cacheThemeElements!==this.themeElements&&(this.cacheThemeElements=this.themeElements,this.schemeColorMap=this.createSchemeColorMap()),this.schemeColorMap}getFillStyleByIndex(e){var t,r,i,n;if(e)return null===(n=this.themeElements)||void 0===n||null===(i=n.fmtScheme)||void 0===i||null===(r=i.fillStyleLst)||void 0===r||null===(t=r.egFillProperties)||void 0===t?void 0:t[e-1]}getLineStyleByIndex(e){var t,r,i,n;if(e)return null===(n=this.themeElements)||void 0===n||null===(i=n.fmtScheme)||void 0===i||null===(r=i.lnStyleLst)||void 0===r||null===(t=r.ln)||void 0===t?void 0:t[e-1]}getBackgroundStyleByIndex(e){var t,r,i,n;if(e)return null===(n=this.themeElements)||void 0===n||null===(i=n.fmtScheme)||void 0===i||null===(r=i.bgFillStyleLst)||void 0===r||null===(t=r.egFillProperties)||void 0===t?void 0:t[e-1001]}getEffectListStyleByIndex(e){var t,r,i,n,o;if(e)return null===(o=this.themeElements)||void 0===o||null===(n=o.fmtScheme)||void 0===n||null===(i=n.effectStyleLst)||void 0===i||null===(r=i.effectStyle)||void 0===r||null===(t=r[e-1])||void 0===t?void 0:t.effectLst}createSchemeColorMap(){const e=new Map,t={srgbClr:{val:"000000"}},{themeElements:r,aliasColorMap:n}=this;for(const o of l){if(e.set(o,t),o===i.eb.PBDEFAULT)continue;if(o===i.eb.phClr){e.set(o,{schemeClr:{val:i.eb.phClr}});continue}if(!(null==r?void 0:r.clrScheme))continue;const a=i.eb[o],s=null==n?void 0:n[a];if(s){const t=null==r?void 0:r.clrScheme[i.p[s]];t&&e.set(o,t);continue}const l=null==r?void 0:r.clrScheme[a];l&&e.set(o,l)}return e}constructor({theme:e,aliasColorMap:t}){super(),this.theme=e,this.aliasColorMap=t}}},"3e6c51064c":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r("d7c625d1f2"),n=r("711a53c9fc"),o=r("777acf2e7d"),a=r("b41b5d48f6"),s=r("cf3340a08c"),l=r("2ba82388a5"),c=r("285f8ccc4f"),d=r("76f1d59f9d");class u extends d.a{updateThemeFontFamily(e,t){var r,i,o,a;const s=null===(a=this.model.props.themeElements)||void 0===a||null===(o=a.fontScheme)||void 0===o||null===(i=o[`${t}Font`])||void 0===i||null===(r=i.font)||void 0===r?void 0:r.findIndex((e=>"Hans"===e.script)),l={fontScheme:{[`${t}Font`]:{latin:{typeface:e},ea:{typeface:""},font:[{script:"Hans",typeface:e}],fontOp:{opType:void 0===s||s<0?n.a.Append:n.a.Modify,opIndex:s}}}};this.updateTheme(l)}updateTheme(e,t){this.guard((e=>a.a.theme.should.existInPresentation(e,this.model.id))),this.transaction((()=>{var r;this.request([new o.a({themeId:this.model.id,themeName:null!==(r=null!=t?t:this.model.props.name)&&void 0!==r?r:"",themeElements:e&&Object(l.c)(Object(c.a)(this.model.store.data.themeElements),e)})])}))}constructor(e,t){super(e,t),this.model=e}}Object(i.__decorate)([Object(s.a)()],u.prototype,"updateThemeFontFamily",null),Object(i.__decorate)([Object(s.a)()],u.prototype,"updateTheme",null)},"3f9e0540b8":function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("67d3be6cf9"),s=r.n(a),l=r("07944bec9d"),c=r("3e57ea86bc"),d=r("5a8749f72e"),u=r("7c46f42788"),p=r("215eaa3247"),h=r("cf3340a08c"),m=r("285f8ccc4f"),f=r("2ba82388a5"),g=r("76f1d59f9d");class b extends g.a{updateTransform(e){const t=this.model.type===u.a.GroupShape?{chOff:e.chOff,chExt:e.chExt}:void 0;this.transaction((()=>{this.request([new d.a({shapeId:this.model.id,shapeType:u.b.toShapeType(this.model.type),pageId:this.model.getPage().id,parentId:this.model.parent.id,xfrmDelta:Object(p.b)(e,"chOff","chExt"),chXfrmDelta:t})]),this.computeParentTransform(this.model.parent)}))}updateProps(e){this.transaction((()=>{var t;const r=null===(t=e.spPr)||void 0===t?void 0:t.xfrm;r&&this.updateTransform(r),this.isTransformOnly(e)||this.request([new l.a({shapeId:this.model.id,pageId:this.model.getPage().id,shapeDelta:Object(n.a)(Object(i.a)({},e),{spPr:e.spPr&&Object(p.b)(e.spPr,"xfrm")})})])}))}getCommonNonVisualPropsDelta(e,t){const r=Object(i.a)({addon:!0,attachment:!0},t),o=this.getDeltaByOverride(this.model.store.data.nvPr,e,r);return o&&Object(n.a)(Object(i.a)({},Object(p.b)(o,"txBox","preferRelativeResize","stCxn","endCxn")),{userDrawn:null!==o.userDrawn&&o.userDrawn,isPhoto:null!==o.isPhoto&&o.isPhoto,locking:this.getLockingDelta(o.locking),attachment:o.attachment,addon:o.addon})}getLockingDelta(e){if(s()(e))return e;const t={};for(const[r,i]of Object.entries(e))t[r]=null!==i&&i;return t}computeParentTransform(e){e.type===u.a.GroupShape&&e.parent.type===u.a.GroupShape&&(this.request([new c.a({pageId:this.model.getPage().id,groupId:e.id,parentId:e.parent.id})]),this.computeParentTransform(e.parent))}getDeltaByOverride(e,t,r){if(!0===r)return Object(f.c)(Object(m.a)(e),t);for(const o of Object.keys(r)){var i,n;if(e[o]||t[o])t[o]=this.getDeltaByOverride(null!==(i=e[o])&&void 0!==i?i:{},null!==(n=t[o])&&void 0!==n?n:{},r[o])}return t}isTransformOnly(e){var t;return!!(null===(t=e.spPr)||void 0===t?void 0:t.xfrm)&&1===Object.keys(e).length&&1===Object.keys(e.spPr).length}}Object(o.__decorate)([Object(h.a)()],b.prototype,"updateTransform",null),Object(o.__decorate)([Object(h.a)()],b.prototype,"updateProps",null)},"40a3b0b347":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("7ecd30c99e"),s=r("215eaa3247"),l=r("cf3340a08c"),c=r("285f8ccc4f"),d=r("2ba82388a5"),u=r("9303123b33"),p=r("3f9e0540b8");class h extends p.a{updateProps({spPr:e,nvPr:t,style:r,txBody:o,useBgFill:a}){this.transaction((()=>{o&&this.updateTextBodyProperties({bodyPr:o.bodyPr,lstStyle:o.lstStyle}),super.updateProps({spPr:e,nvPr:t&&Object(n.a)(Object(i.a)({},super.getCommonNonVisualPropsDelta(t)),{shape:{txBox:null!==t.txBox&&t.txBox}}),style:void 0===r?r:Object(d.c)(Object(c.a)(this.model.store.data.style),r),shape:{useBgFill:null!==a&&a}})}))}updateParagraphList(e){return this.transaction((()=>{this.request([new a.a(Object(s.b)(a.b.fromParagraphListData(e,this.model.getPage().id,this.model.id),"type"))])}))}updateTextBodyProperties({bodyPr:e={},lstStyle:t={}}){return this.transaction((()=>{this.request([new u.a(Object(s.b)(u.b.fromTextBodyProperties({bodyPr:e,lstStyle:t},this.model.getPage().id,this.model.id),"col","row","type"))])}))}updateTextStyles(e){this.transaction((()=>{this.updateTextBodyProperties({lstStyle:null}),this.updateTextBodyProperties({lstStyle:e})}))}}Object(o.__decorate)([Object(l.a)()],h.prototype,"updateProps",null),Object(o.__decorate)([Object(l.a)()],h.prototype,"updateParagraphList",null),Object(o.__decorate)([Object(l.a)()],h.prototype,"updateTextBodyProperties",null),Object(o.__decorate)([Object(l.a)()],h.prototype,"updateTextStyles",null)},"4a351e9268":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r("1f69014a3c"),n=r("711a53c9fc"),o=r("7df2e5fb1e"),a=r("1af4b2dbf4"),s=r("27b8f08537");class l{static fromBufferOrBase64(e){const t=s.a.codec.decode(e,n.dc.Revision);return new l(t)}static fromCommandData(e){return new l({commands:e})}toBase64String(){const e=s.a.codec.encode(this.data,n.dc.Revision);return o.a.fromUint8Array(e)}getRevisionData(){return this.data}getCommandData(){var e;return null!==(e=this.data.commands)&&void 0!==e?e:[]}getMutationData(){return this.getCommandData().flatMap((e=>{var t;return null!==(t=e.mutations)&&void 0!==t?t:[]}))}getValidMutationData(){return this.getCommandData().flatMap((e=>a.a.from(e).getValidMutationData()))}constructor(e){this.data=Object(i.a)({commands:[]},e)}}l.empty=new l({})},"5188b6140f":function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var i=r("d7c625d1f2"),n=r("9541c1076d"),o=r.n(n),a=r("711a53c9fc"),s=r("33fdb9613c"),l=r("cf3340a08c"),c=r("74528f4f2d"),d=r("182acadcf2"),u=r("7c46f42788"),p=r("285f8ccc4f"),h=r("969172f78b");class m extends h.a{changeLayout(e,t){this.changeLayoutQuickSetting(e,t,{addLayoutPlaceholders:!0})}changeLayoutQuickSetting(e,t,r){if(!e||!t)return;const i=this.model.getLayout();(null==i?void 0:i.id)!==t.id&&this.transaction((()=>{const e=this.model.placeholders,i=t.store.getVisiblePlaceholders(),n=new Map(e.map((e=>[e.id,e]))),o=new Map(i.map((e=>[e.id,e])));this.transformPlaceholder(t,n,o,!1),this.transformPlaceholder(t,n,o,!0),this.addOrRemoveUnMatchedPlaceholders(Array.from(n.values())),(null==r?void 0:r.addLayoutPlaceholders)&&this.addUnMatchedPlaceholders(Array.from(o.values()),t),this.updateProps({layoutId:t.id})}))}updateSlideVisible(e){this.updateProps({show:!1!==e&&null})}updateShowMasterSp(e){this.updateProps({showMasterSp:e})}addNoteSlide(e){this.transaction((()=>{var t;const r=this.model.context.getPresentation();let[i]=[...r.notesMasterMap.values()],n=r.getThemeById(null==i||null===(t=i.props)||void 0===t?void 0:t.themeId);n||(r.api.addTheme([{type:u.a.Theme,name:"notesMasterTheme",id:"",themeElements:Object(p.a)(d.themeElements)}]),n=r.themeList[r.themeList.length-1]),i||(r.api.addNotesMasterSlide({type:u.a.NotesMaster,id:"",themeId:n.id,notesStyle:c.notesStyle,clrMap:c.clrMap,cSld:{}}),[i]=[...r.notesMasterMap.values()]),r.api.addNoteSlide(e)}))}transformPlaceholder(e,t,r,i){for(const l of t.values())for(const c of r.values()){var n,o;if(this.isPlaceholderMatchedQuickSetting(null===(n=l.props.nvPr.ph)||void 0===n?void 0:n.type,null===(o=c.props.nvPr.ph)||void 0===o?void 0:o.type,i)){var a,s;const i=this.transformMatchedPlaceholder(e,c,l);null==i||null===(s=i[0])||void 0===s||s.api.updateProps({nvPr:{ph:{idx:null===(a=c.props.nvPr.ph)||void 0===a?void 0:a.idx}}}),t.delete(l.id),r.delete(c.id);break}}}addOrRemoveUnMatchedPlaceholders(e){e.forEach((e=>{e.props.isCustomPlaceholder?(e.props.spPr.xfrm&&e.api.updateTransform(e.props.spPr.xfrm),e.api.updateProps({nvPr:{ph:{idx:s.b}}})):this.deleteShapes([e])}))}addUnMatchedPlaceholders(e,t){const r=e.map((e=>this.model.store.getModifyPlaceholderData(e,t))).filter(Boolean);this.addShapes(r)}transformMatchedPlaceholder(e,t,r){const i=this.model.store.getModifyPlaceholderData(t,e);if(i)return"txBody"in r.getOwnedData()&&o()(i,{txBody:r.getOwnedData().txBody}),this.deleteShapes([r]),this.addShapes([i])}isPlaceholderMatchedQuickSetting(e,t,r=!1){return e===t||!!r&&(!(![a.U.ctrTitle,a.U.title].includes(null!=e?e:a.U.PBDEFAULT)||![a.U.ctrTitle,a.U.title].includes(null!=t?t:a.U.PBDEFAULT))||!(![a.U.subTitle,a.U.body,void 0].includes(e)||![a.U.subTitle,a.U.body,void 0].includes(t)))}}Object(i.__decorate)([Object(l.a)()],m.prototype,"changeLayout",null),Object(i.__decorate)([Object(l.a)()],m.prototype,"changeLayoutQuickSetting",null),Object(i.__decorate)([Object(l.a)()],m.prototype,"updateSlideVisible",null),Object(i.__decorate)([Object(l.a)()],m.prototype,"updateShowMasterSp",null),Object(i.__decorate)([Object(l.a)()],m.prototype,"addNoteSlide",null)},"5d64cf765d":function(e,t,r){"use strict";var i,n;r.d(t,"g",(function(){return i})),r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return a})),r.d(t,"l",(function(){return o})),r.d(t,"k",(function(){return p})),r.d(t,"f",(function(){return s})),r.d(t,"e",(function(){return l})),r.d(t,"i",(function(){return c})),r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return u})),r.d(t,"o",(function(){return h})),r.d(t,"n",(function(){return m})),r.d(t,"m",(function(){return f})),r.d(t,"h",(function(){return v})),r.d(t,"j",(function(){return g})),function(e){e.CreateCollection="create-collection",e.DropCollection="drop-collection",e.CreateIndex="create-index",e.DropIndex="drop-index"}(i||(i={})),function(e){e.MoveProperty="move-property",e.DropProperty="drop-property",e.ReplaceProperty="replace-property",e.ClearData="clear-data",e.ReplaceData="replace-data"}(n||(n={}));var o,a={name:"alloy_db_schema_table",indices:[],key:{path:"name"},properties:[]};!function(e){e.Equals="=",e.NotEquals="!=",e.GreaterThan=">",e.GreaterOrEqualThan=">=",e.LessThan="<",e.LessOrEqualThan="<=",e.In="in",e.NotIn="nin"}(o||(o={}));var s,l,c,d,u,p=void 0;function h(e){return"number"==typeof e&&!Number.isNaN(e)||"string"==typeof e||e instanceof Date&&!Number.isNaN(e.getTime())||e instanceof ArrayBuffer||ArrayBuffer.isView(e)||Array.isArray(e)&&e.every(h)}function m(e,t){var r=e;return Array.isArray(t)?t.map((function(e){return r[e]})):r[t]}function f(e,t){return Array.isArray(e)?Array.isArray(t)&&e.length===t.length&&e.every((function(e,r){return f(e,t[r])})):e===t}!function(e){e.OR="or",e.AND="and",e.FILTER="filter",e.NONE="none",e.ALL="all"}(s||(s={})),function(e){e.ENTRIES="entries",e.VALUES="values",e.KEYS="keys",e.COUNT="count"}(l||(l={})),function(e){e.DESCENDING="desc",e.ASCENDING="asc"}(c||(c={})),function(e){e.AutoIncrement="auto-increment"}(d||(d={})),function(e){e.Equals="=",e.GreaterThan=">",e.GreaterOrEqualThan=">=",e.LessThan="<",e.LessOrEqualThan="<="}(u||(u={}));var g,b=r("d7c625d1f2"),v=function(){function e(){}return e.collectionDiff=function(e,t){if(e.name!==t.name)throw new Error("can not compare collection schema with different name");var r={collection:e.name},i=t.indices.filter((function(t){return!e.indices.some((function(e){return e.name===t.name}))})),n=e.indices.filter((function(e){return!t.indices.some((function(t){return t.name===e.name}))}));return(i.length||n.length)&&(r.index={added:Object(b.__spreadArray)([],Object(b.__read)(i)),deleted:Object(b.__spreadArray)([],Object(b.__read)(n))}),r},e.databaseDiff=function(e,t){var r,i,n=this.getCompareMap(e,t),o={added:[],deleted:[],different:[]};try{for(var a=Object(b.__values)(n.values()),s=a.next();!s.done;s=a.next()){var l=s.value;if(!l.oldValue||l.newValue)if(l.oldValue||!l.newValue){if(l.oldValue&&l.newValue){var c=this.collectionDiff(l.oldValue,l.newValue);if(!c.index)continue;o.different.push(c)}}else o.added.push(l.newValue);else o.deleted.push(l.oldValue)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o},e.getCompareMap=function(e,t){var r,i,n,o,a=new Map;try{for(var s=Object(b.__values)(t.collections),l=s.next();!l.done;l=s.next()){var c=l.value;(p=a.get(c.name)||{}).newValue=c,a.set(c.name,p)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}try{for(var d=Object(b.__values)(e.collections),u=d.next();!u.done;u=d.next()){var p;c=u.value;(p=a.get(c.name)||{}).oldValue=c,a.set(c.name,p)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}return a},e}();!function(e){e.READ_ONLY="readonly",e.READ_WRITE="readwrite",e.VERSION_CHANGE="versionchange"}(g||(g={}))},"6486bacc70":function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("67d3be6cf9"),s=r.n(a),l=r("026cc7da1f"),c=r("215eaa3247"),d=r("cf3340a08c"),u=r("285f8ccc4f"),p=r("7ecd30c99e"),h=r("9303123b33"),m=r("2ba82388a5"),f=r("b56763d092"),g=r("daff531963"),b=r("6821617d4e"),v=r("4157227dc7"),y=r("90a993b6f1"),S=r("0d856a1e47"),x=r("8d1a1b3ebd"),_=r("b8a3288ad7"),T=r("128d9bfc05"),O=r("3e3b82a8aa"),P=r("decfd055a5"),C=r("04ed9bbbb2");class I extends C.a{updateProps({spPr:e,nvPr:t,graphic:r,bwMode:o}){var a,s,l,c,d,p;if(!(null==r||null===(s=r.graphicData)||void 0===s||null===(a=s.tbl)||void 0===a?void 0:a.tblPr))return super.updateProps({spPr:e,nvPr:t,graphic:r,bwMode:o});const h=Object(m.c)(Object(u.a)(null!==(p=null===(d=this.model.store.data.graphic)||void 0===d||null===(c=d.graphicData)||void 0===c||null===(l=c.tbl)||void 0===l?void 0:l.tblPr)&&void 0!==p?p:{}),r.graphicData.tbl.tblPr);return super.updateProps({spPr:e,nvPr:t,graphic:Object(n.a)(Object(i.a)({},r),{graphicData:Object(n.a)(Object(i.a)({},r.graphicData),{tbl:Object(n.a)(Object(i.a)({},r.graphicData.tbl),{tblPr:h})})}),bwMode:o})}updateParagraphList(e,t,r){return this.transaction((()=>{this.request([new p.a(Object(c.b)(p.b.fromParagraphListData(e,this.model.getPage().id,this.model.id,t,r),"type"))])}))}updateTextBodyProperties({bodyPr:e,lstStyle:t,col:r,row:i}){return this.transaction((()=>{this.request([new h.a(Object(c.b)(h.b.fromTextBodyProperties({bodyPr:e,lstStyle:t},this.model.getPage().id,this.model.id,r,i),"type"))])}))}insertRowsOrColumns(e,t,r){var i;const n={[g.b.ABOVE]:()=>this.insertTableRows(e,t,g.b.ABOVE),[g.b.BELOW]:()=>this.insertTableRows(e,t,g.b.BELOW),[g.b.LEFT]:()=>this.insertTableCols(e,t,g.b.LEFT),[g.b.RIGHT]:()=>this.insertTableCols(e,t,g.b.RIGHT)};null===(i=n[r])||void 0===i||i.call(n)}deleteRowsOrColumns(e,t,r){var i;const n={[g.a.ROW]:()=>this.deleteTableRows(e,t),[g.a.COLUMN]:()=>this.deleteTableCols(e,t)};null===(i=n[r])||void 0===i||i.call(n)}mergeCell(e){var t,r;const{startRowIndex:i,startColIndex:n,rowSpan:o,colSpan:a}=e;if(s()(i)||!o||s()(n)||!a)return;if(!this.canMergeCell(e))return;const c=Object(u.a)(null===(r=this.model.getOwnedData().graphic)||void 0===r||null===(t=r.graphicData)||void 0===t?void 0:t.tbl),d=null==c?void 0:c.tr;Object(l.assert)(d,"table row list is null");let p=d.slice(i,i+o);p=p.map((e=>({h:e.h,tc:(null==e?void 0:e.tc)&&e.tc.slice(n,n+a)||[]}))),this.transaction((()=>{var t,r;const o=Object(f.h)(c,e);this.forEachInTransaction(o,(e=>this.cancelMergedCellInternal(e))),this.mergeCellInternal(e);const[a]=p[0].tc||[],s=(null==a||null===(t=a.txBody)||void 0===t?void 0:t.p)&&Object(f.a)(a.txBody.p)&&Object(u.a)(null==a||null===(r=a.txBody)||void 0===r?void 0:r.p)||[];this.forEachInTransaction(p,((e,t)=>{this.forEachInTransaction(null==e?void 0:e.tc,((e,r)=>{if((0!==t||0!==r)&&e.txBody){var o;var a;if((null==e||null===(o=e.txBody)||void 0===o?void 0:o.p)&&Object(f.a)(e.txBody.p))(null==e||null===(a=e.txBody)||void 0===a?void 0:a.p)&&s.push(...e.txBody.p),this.updateParagraphList([{egTextRun:[],endParaRPr:{},pPr:{}}],n+r,i+t)}}))})),this.updateParagraphList(s,n,i)}))}cancelMergedCell(e){var t,r,i,n;const{startRowIndex:o,startColIndex:a,rowSpan:l,colSpan:c}=e;if(s()(o)||!l||s()(a)||!c)return;const d=Object(u.a)(null===(r=this.model.getOwnedData().graphic)||void 0===r||null===(t=r.graphicData)||void 0===t?void 0:t.tbl),p=null==d?void 0:d.tr,h=null==d||null===(i=d.tblGrid)||void 0===i?void 0:i.gridCol;if(!p||!h)return;if(o+l>p.length||a+c>h.length)return;const m=null===(n=p.slice(o,o+l))||void 0===n?void 0:n.map((e=>({h:e.h,tc:(null==e?void 0:e.tc)&&e.tc.slice(a,a+c)||[]})));this.transaction((()=>{this.cancelMergedCellInternal(e),this.forEachInTransaction(m,((e,t)=>{this.forEachInTransaction(null==e?void 0:e.tc,((e,r)=>{0===t&&0===r||this.updateParagraphList([],a+r,o+t)}))}))}))}updateTableWidthOrHeight(e){const{xfrm:t,heights:r,widths:i,operation:n}=e,o=r&&r.length===this.model.rowLength&&r.map(((e,t)=>({index:t,height:e})))||[],a=i&&i.length===this.model.colLength&&i.map(((e,t)=>({index:t,width:e})))||[];this.transaction((()=>{t&&this.updateTransform(t);const e=[];(n===g.c.ALL||n===g.c.HEIGHT)&&o.length>0&&e.push(new T.a({pageId:this.model.getPage().id,shapeId:this.model.id,heights:o})),(n===g.c.ALL||n===g.c.WIDTH)&&a.length>0&&e.push(new _.a({pageId:this.model.getPage().id,shapeId:this.model.id,widths:a})),this.request(e)}))}setTableRowHeights(e){this.transaction((()=>{this.request([new T.a({pageId:this.model.getPage().id,shapeId:this.model.id,heights:e})])}))}setTableColWidths(e){this.transaction((()=>{this.request([new _.a({pageId:this.model.getPage().id,shapeId:this.model.id,widths:e})])}))}updateTableCellProperties(e,t){this.model.store.iterateTableRange(t,((t,r,i)=>{this.transaction((()=>{var n;this.request([new P.a({pageId:this.model.getPage().id,shapeId:this.model.id,range:{startRowIndex:t,startColIndex:r,rowSpan:1,colSpan:1},tableCellProperties:e&&Object(m.c)(Object(u.a)(null!==(n=i.tcPr)&&void 0!==n?n:{}),e)})])}))}))}mergeCellInternal(e){this.transaction((()=>{this.request([new x.a({pageId:this.model.getPage().id,shapeId:this.model.id,range:e})])}))}cancelMergedCellInternal(e){this.transaction((()=>{this.request([new O.a({pageId:this.model.getPage().id,shapeId:this.model.id,range:e})])}))}insertTableRows(e,t,r){var n,o,a,s;const l=Object(u.a)(null===(o=this.model.getOwnedData().graphic)||void 0===o||null===(n=o.graphicData)||void 0===n?void 0:n.tbl);var c;const d=(p=e,h=null!==(c=null==l||null===(a=l.tr)||void 0===a?void 0:a.length)&&void 0!==c?c:0,r===g.b.BELOW?0===p?p:p-1:p===h?p-1:p);var p,h;const b=null==l||null===(s=l.tr)||void 0===s?void 0:s[d],v=null==b?void 0:b.tc;if(!l||!v)return;const y=Object(f.h)(l);this.transaction((()=>{var r,n,o,a,s,l,c,d,u,p,h;this.forEachInTransaction(y,(t=>{e>t.startRowIndex&&e<t.startRowIndex+t.rowSpan&&this.cancelMergedCell({startRowIndex:t.startRowIndex,startColIndex:t.startColIndex,rowSpan:t.rowSpan,colSpan:t.colSpan})})),this.insertTableRowsInternal(e,t);const f=Array.from({length:t},((t,r)=>({index:e+r,height:b.h})));this.setTableRowHeights(f);const g=null===(a=this.model.getOwnedData().graphic)||void 0===a||null===(o=a.graphicData)||void 0===o||null===(n=o.tbl)||void 0===n||null===(r=n.tr)||void 0===r?void 0:r.slice(e,e+t);this.forEachInTransaction(g,((t,r)=>{this.forEachInTransaction(v,((t,i)=>{var n,o,a,s,l,c,d,u;((null==t?void 0:t.tcPr)&&this.updateTableCellProperties(t.tcPr,{startRowIndex:e+r,startColIndex:i,rowSpan:1,colSpan:1}),(null==t||null===(n=t.txBody)||void 0===n?void 0:n.bodyPr)||(null==t||null===(o=t.txBody)||void 0===o?void 0:o.lstStyle))&&this.updateTextBodyProperties({bodyPr:null!==(d=null===(l=t.txBody)||void 0===l?void 0:l.bodyPr)&&void 0!==d?d:{},lstStyle:null!==(u=null===(c=t.txBody)||void 0===c?void 0:c.lstStyle)&&void 0!==u?u:{},col:i,row:e+r});if(null===(s=t.txBody)||void 0===s||null===(a=s.p)||void 0===a?void 0:a[0]){var p,h;const n=Object(m.a)([null===(h=t.txBody)||void 0===h||null===(p=h.p)||void 0===p?void 0:p[0]]);if(n[0].egTextRun&&n[0].egTextRun.length>0){var f;const e=n[0].egTextRun.length-1;n[0].endParaRPr=null===(f=n[0].egTextRun[e].r)||void 0===f?void 0:f.rPr}n[0].egTextRun=[],this.updateParagraphList(n,i,e+r)}t.gridSpan&&this.mergeCellInternal({startRowIndex:e+r,startColIndex:i,rowSpan:1,colSpan:t.gridSpan})}))})),this.forEachInTransaction(y,(r=>{e>r.startRowIndex&&e<r.startRowIndex+r.rowSpan&&this.mergeCell({startRowIndex:r.startRowIndex,startColIndex:r.startColIndex,rowSpan:r.rowSpan+t,colSpan:r.colSpan})}));const S=null===(d=this.model.getOwnedData().graphic)||void 0===d||null===(c=d.graphicData)||void 0===c||null===(l=c.tbl)||void 0===l||null===(s=l.tr)||void 0===s?void 0:s.reduce(((e,t)=>e+((null==t?void 0:t.h)||0)),0),x=null===(p=this.model.getOwnedData())||void 0===p||null===(u=p.spPr)||void 0===u?void 0:u.xfrm;this.updateTransform(Object(i.a)({ext:{cx:null==x||null===(h=x.ext)||void 0===h?void 0:h.cx,cy:S}},x))}))}insertTableRowsInternal(e,t){this.transaction((()=>{this.request([new S.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:e,count:t})])}))}insertTableCols(e,t,r){var i,n;const o=Object(f.h)(null===(n=this.model.getOwnedData().graphic)||void 0===n||null===(i=n.graphicData)||void 0===i?void 0:i.tbl);this.transaction((()=>{var i,n,a,s,l,c,d,u,p,h,f,b;this.forEachInTransaction(o,(t=>{e>t.startColIndex&&e<t.startColIndex+t.colSpan&&this.cancelMergedCell({startRowIndex:t.startRowIndex,startColIndex:t.startColIndex,rowSpan:t.rowSpan,colSpan:t.colSpan})})),this.insertTableColsInternal(e,t);const v=null===(s=this.model.getOwnedData().graphic)||void 0===s||null===(a=s.graphicData)||void 0===a||null===(n=a.tbl)||void 0===n||null===(i=n.tblGrid)||void 0===i?void 0:i.gridCol;var y;const S=(x=e,_=t,T=(null!==(y=null==v?void 0:v.length)&&void 0!==y?y:t)-t,r===g.b.RIGHT?0===x?x+_:x-1:x===T?x-1:x+_);var x,_,T;if(!v)return;const O=v.reduce(((e,t)=>e+((null==t?void 0:t.w)||0)),0)+((null===(l=v[S])||void 0===l?void 0:l.w)||0)*t;var P;const C=null!==(P=((null===(p=this.model.getOwnedData())||void 0===p||null===(u=p.spPr)||void 0===u||null===(d=u.xfrm)||void 0===d||null===(c=d.ext)||void 0===c?void 0:c.cx)||0)/O)&&void 0!==P?P:1,I=v.map(((r,i)=>{const n=i>=e&&i<e+t?v[S].w:r.w;return{index:i,width:(null!=n?n:1)*C}}));this.setTableColWidths(I);const w=null===(b=this.model.getOwnedData().graphic)||void 0===b||null===(f=b.graphicData)||void 0===f||null===(h=f.tbl)||void 0===h?void 0:h.tr;this.forEachInTransaction(w,((r,i)=>{var n,o;const a=null==r||null===(n=r.tc)||void 0===n?void 0:n[S],s=null===(o=r.tc)||void 0===o?void 0:o.slice(e,e+t);this.forEachInTransaction(s,((t,r)=>{var n,o,s,l,c,d,u,p;((null==a?void 0:a.tcPr)&&this.updateTableCellProperties(a.tcPr,{startRowIndex:i,startColIndex:e+r,rowSpan:1,colSpan:1}),(null==a||null===(n=a.txBody)||void 0===n?void 0:n.bodyPr)||(null==a||null===(o=a.txBody)||void 0===o?void 0:o.lstStyle))&&this.updateTextBodyProperties({bodyPr:null!==(u=null===(c=a.txBody)||void 0===c?void 0:c.bodyPr)&&void 0!==u?u:{},lstStyle:null!==(p=null===(d=a.txBody)||void 0===d?void 0:d.lstStyle)&&void 0!==p?p:{},col:e+r,row:i});if(null==a||null===(l=a.txBody)||void 0===l||null===(s=l.p)||void 0===s?void 0:s[0]){var h,f;const t=Object(m.a)([null===(f=a.txBody)||void 0===f||null===(h=f.p)||void 0===h?void 0:h[0]]);if(t[0].egTextRun&&t[0].egTextRun.length>0){var g;const e=t[0].egTextRun.length-1;t[0].endParaRPr=null===(g=t[0].egTextRun[e].r)||void 0===g?void 0:g.rPr}t[0].egTextRun=[],this.updateParagraphList(t,e+r,i)}(null==a?void 0:a.rowSpan)&&this.mergeCell({startRowIndex:i,startColIndex:e+r,rowSpan:a.rowSpan,colSpan:1})}))})),this.forEachInTransaction(o,(r=>{e>r.startColIndex&&e<r.startColIndex+r.colSpan&&this.mergeCell({startRowIndex:r.startRowIndex,startColIndex:r.startColIndex,rowSpan:r.rowSpan,colSpan:r.colSpan+t})}))}))}insertTableColsInternal(e,t){this.transaction((()=>{this.request([new y.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:e,count:t})])}))}deleteTableRows(e,t){var r,i;const n=Object(u.a)(null===(i=this.model.getOwnedData().graphic)||void 0===i||null===(r=i.graphicData)||void 0===r?void 0:r.tbl);if(!n)return;const o=null==n?void 0:n.tr.slice(e,e+t),a=Object(f.h)(n),s=(e,t,r)=>!Object(f.g)(e)||(t+r<=e.startRowIndex||e.startRowIndex+e.rowSpan<=t);this.transaction((()=>{this.forEachInTransaction(a,(r=>{s(r,e,t)||this.cancelMergedCell({startRowIndex:r.startRowIndex,startColIndex:r.startColIndex,rowSpan:r.rowSpan,colSpan:r.colSpan})})),this.forEachInTransaction(o,((t,r)=>{this.forEachInTransaction(t.tc,((t,i)=>{var n,o,a;(null==t?void 0:t.tcPr)&&this.updateTableCellProperties({noFill:!0},{startRowIndex:e+r,startColIndex:i,rowSpan:1,colSpan:1}),((null==t||null===(n=t.txBody)||void 0===n?void 0:n.bodyPr)||(null==t||null===(o=t.txBody)||void 0===o?void 0:o.lstStyle))&&this.updateTextBodyProperties({col:i,row:e+r}),(null===(a=t.txBody)||void 0===a?void 0:a.p)&&Object(f.a)(t.txBody.p)&&this.updateParagraphList([{egTextRun:[],endParaRPr:{},pPr:{}}],i,e+r)}))})),this.deleteTableRowsInternal(e,t),this.forEachInTransaction(a,(r=>{if(!s(r,e,t)&&r.rowSpan-t>0){if(r.rowSpan-t==1&&1===r.colSpan)return;this.mergeCellInternal({startRowIndex:r.startRowIndex,startColIndex:r.startColIndex,rowSpan:r.rowSpan-t,colSpan:r.colSpan})}}))}))}deleteTableRowsInternal(e,t){this.transaction((()=>{this.request([new v.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:e,count:t})])}))}deleteTableCols(e,t){var r,i,n;const o=Object(u.a)(null===(i=this.model.getOwnedData().graphic)||void 0===i||null===(r=i.graphicData)||void 0===r?void 0:r.tbl);if(!o)return;const a=null==o||null===(n=o.tr)||void 0===n?void 0:n.map((r=>{var i;return(null==r||null===(i=r.tc)||void 0===i?void 0:i.slice(e,e+t))||[]})),s=Object(f.h)(o),l=(e,t,r)=>!Object(f.g)(e)||(t+r<=e.startColIndex||e.startColIndex+e.colSpan<=t);this.transaction((()=>{this.forEachInTransaction(s,(r=>{l(r,e,t)||this.cancelMergedCell({startRowIndex:r.startRowIndex,startColIndex:r.startColIndex,rowSpan:r.rowSpan,colSpan:r.colSpan})})),this.forEachInTransaction(a,((t,r)=>{this.forEachInTransaction(t,((t,i)=>{var n,o,a;(null==t?void 0:t.tcPr)&&this.updateTableCellProperties({noFill:!0},{startRowIndex:r,startColIndex:e+i,rowSpan:1,colSpan:1}),((null==t||null===(n=t.txBody)||void 0===n?void 0:n.bodyPr)||(null==t||null===(o=t.txBody)||void 0===o?void 0:o.lstStyle))&&this.updateTextBodyProperties({col:e+i,row:r}),(null===(a=t.txBody)||void 0===a?void 0:a.p)&&Object(f.a)(t.txBody.p)&&this.updateParagraphList([{egTextRun:[],endParaRPr:{},pPr:{}}],e+i,r)}))})),this.deleteTableColsInternal(e,t),this.forEachInTransaction(s,(r=>{if(!l(r,e,t)&&r.colSpan-t>0){if(r.colSpan-t==1&&1===r.rowSpan)return;this.mergeCellInternal({startRowIndex:r.startRowIndex,startColIndex:r.startColIndex,rowSpan:r.rowSpan,colSpan:r.colSpan-t})}}))}))}deleteTableColsInternal(e,t){this.transaction((()=>{this.request([new b.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:e,count:t})])}))}canMergeCell(e){var t,r,i,n,o,a,l;const{startRowIndex:c,startColIndex:d,rowSpan:u,colSpan:p}=e;if(s()(c)||!u||s()(d)||!p)return!1;if(Math.min(u,p)<=0||Math.max(u,p)<=1)return!1;const h=null===(i=this.model.getOwnedData().graphic)||void 0===i||null===(r=i.graphicData)||void 0===r||null===(t=r.tbl)||void 0===t?void 0:t.tr,m=null===(l=this.model.getOwnedData().graphic)||void 0===l||null===(a=l.graphicData)||void 0===a||null===(o=a.tbl)||void 0===o||null===(n=o.tblGrid)||void 0===n?void 0:n.gridCol;return!(u+c>h.length)&&(!(p+d>m.length)&&!this.isFullMergedCell(e))}isFullMergedCell(e){var t,r,i,n,o;const{startRowIndex:a,startColIndex:s,rowSpan:l,colSpan:c}=e;if(!s||!a)return!1;const d=null===(o=(null===(i=this.model.getOwnedData().graphic)||void 0===i||null===(r=i.graphicData)||void 0===r||null===(t=r.tbl)||void 0===t?void 0:t.tr)[a])||void 0===o||null===(n=o.tc)||void 0===n?void 0:n[s];if(!d)return;let u=!1;return Object(f.f)(d)&&Object(f.e)(d)?u=d.rowSpan===l&&d.gridSpan===c:Object(f.f)(d)?u=d.rowSpan===l&&1===c:Object(f.e)(d)&&(u=d.gridSpan===c&&1===l),u}}Object(o.__decorate)([Object(d.a)()],I.prototype,"updateProps",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"updateParagraphList",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"updateTextBodyProperties",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"insertRowsOrColumns",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"deleteRowsOrColumns",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"mergeCell",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"cancelMergedCell",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"updateTableWidthOrHeight",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"setTableRowHeights",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"setTableColWidths",null),Object(o.__decorate)([Object(d.a)()],I.prototype,"updateTableCellProperties",null)},"668bd0ac65":function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("711a53c9fc"),a=r("2f766f71b0"),s=r.n(a),l=r("a5f49151bb"),c=r("215eaa3247"),d=r("03420c1dd4"),u=r("7b62e570e0"),p=r("27b8f08537"),h=r("4a351e9268"),m=r("1af4b2dbf4");class f{static fromCommandData(e){return new f({presentation:h.a.fromCommandData([e]).toBase64String()})}static fromPresentationData(e,t){if(!t)return this.fromCommandData(m.a.fromValidMutationData(Object(l.a)(e)).getCommandData());const{slideList:r,noteSlideMap:a,sectionMap:p}=e,g=Object(n.a)(Object(i.a)({},Object(c.b)(e,"slideList","noteSlideMap","sectionMap")),{slideList:[],noteSlideMap:{},sectionMap:{}}),b={presentation:Object(l.a)(g),pages:{}},v={presentation:{noteSlideMap:a,slideList:r},idFactory:e=>e};return r.forEach(((e,t)=>{b.pages[e.id]=[],e.noteSlideId&&(b.pages[e.noteSlideId]=[]);Object(d.f)(e,t,v).forEach((e=>{e.type===o.c.AddPage?b.presentation.push(e):b.pages[e.pageId].push(e)}))})),b.presentation.push(...s()(Object.values(p).map((e=>Object(u.a)(e,v))))),new f({presentation:h.a.fromCommandData([m.a.fromValidMutationData(b.presentation).getCommandData()]).toBase64String(),pages:Object.fromEntries(Object.entries(b.pages).map((([e,t])=>[e,h.a.fromCommandData([m.a.fromValidMutationData(t).getCommandData()]).toBase64String()])))})}static fromEGChunkDataBuffer(e){var t,r;const i=p.a.codec.decode(e,o.dc.EGChunkData);var n,a;return new f({presentation:null!==(n=null===(t=i.slideChunkData)||void 0===t?void 0:t.presentation)&&void 0!==n?n:h.a.empty.toBase64String(),pages:Object.fromEntries((null!==(a=null===(r=i.slideChunkData)||void 0===r?void 0:r.pages)&&void 0!==a?a:[]).map((e=>{var t,r;return[null!==(t=e.id)&&void 0!==t?t:"",null!==(r=e.data)&&void 0!==r?r:h.a.empty.toBase64String()]})))})}static fromMutations(e){return this.fromCommandData(m.a.fromMutations(e).getCommandData())}getData(){return this.data}getCommandData(){const e=[];var t;const r=null!==(t=this.data.pages)&&void 0!==t?t:{};var i;const n=null!==(i=this.data.revisions)&&void 0!==i?i:[];this.appendRevisionToMutations(e,this.data.presentation);for(const[t,i]of Object.entries(r))r[t]="",this.appendRevisionToMutations(e,i);for(const t of n)this.appendRevisionToMutations(e,t);return{mutations:e}}appendRevisionToMutations(e,t){for(const r of h.a.fromBufferOrBase64(t).getMutationData())e.push(r)}constructor(e){this.data=e}}},"6cef2a9a7f":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r("6f5cb1d8ac");class n{static queryLocalFonts(){return this.client.font.queryLocalFonts()}}n.client=i.a.create({font:Object(i.b)()});var o=n,a=r("d7c625d1f2"),s=r("2a81537ef9");class l{constructor(e){this.syncEvents=e=>{this.registListenEvent(e),this.registEmitEvent(e)},this.registListenEvent=e=>{e.on("play",(e=>{this.play(e)})),e.on("pause",(()=>this.pause())),e.on("stop",(()=>this.stop())),e.on("close",(()=>this.close())),e.on("toggle-pause",(()=>this.togglePause())),e.on("toggle-mute",(()=>this.toggleMute())),e.on("set-volume",(e=>{this.volume=e})),e.on("set-position",(e=>{this.position=e})),e.on("set-rate",(e=>{this.rate=e})),e.on("set-time",(e=>{this.time=e})),e.on("set-mute",(e=>{this.mute=e}))},this.registEmitEvent=e=>{this.on("frame-ready",(t=>{e.emit("frame-ready",t)})),this.on("frame-setup",((t,r)=>{e.emit("frame-setup",t,r)})),this.on("time-changed",(t=>{e.emit("time-changed",t)})),this.on("length-changed",(t=>{e.emit("length-changed",t)})),this.on("position-changed",(t=>{e.emit("position-changed",t)})),this.on("log-message",((t,r)=>{e.emit("log-message",t,r)})),this.on("encountered-error",((...t)=>e.emit("encountered-error",...t))),this.on("opening",((...t)=>e.emit("opening",...t))),this.on("playing",((...t)=>e.emit("playing",...t))),this.on("paused",((...t)=>e.emit("paused",...t))),this.on("stopped",((...t)=>e.emit("stopped",...t))),this.on("forward",((...t)=>e.emit("forward",...t))),this.on("backward",((...t)=>e.emit("backward",...t))),this.on("buffering",((...t)=>e.emit("buffering",...t))),this.on("end-reached",((...t)=>e.emit("end-reached",...t))),this.on("frame-cleanup",((...t)=>e.emit("frame-cleanup",...t))),this.on("media-changed",((...t)=>e.emit("media-changed",...t))),this.on("nothing-special",((...t)=>e.emit("nothing-special",...t))),this.on("pausable-changed",((...t)=>e.emit("pausable-changed",...t))),this.on("seekable-changed",((...t)=>e.emit("seekable-changed",...t)))},this.player=e}static createPlayer(){return Object(a.__awaiter)(this,void 0,void 0,(function*(){return new this((yield this.WebChimeraAPI.requireWebChimera()).createPlayer())}))}static getPlayableSrcFromURI(e){return Object(a.__awaiter)(this,void 0,void 0,(function*(){const{client:t}=this;return(yield t.media.isMediaURI(e))?t.media.getLocationFromMediaURI(e):e}))}play(e){return void 0===e?this.player.play():this.player.play(e)}pause(){return this.player.pause()}togglePause(){return this.player.togglePause()}stop(){return this.player.stop()}toggleMute(){return this.player.toggleMute()}close(){return this.player.close()}set volume(e){this.player.volume=e}get volume(){return this.player.volume}set position(e){this.player.position=e}get position(){return this.player.position}set rate(e){this.player.input.rate=e}get rate(){return this.player.input.rate}set time(e){this.player.time=e}get time(){return this.player.time}set mute(e){this.player.mute=e}get mute(){return this.player.mute}get playing(){return this.player.playing}get state(){return this.player.state}get length(){return this.player.length}on(e,t){"frame-ready"!==e?"frame-setup"!==e?"time-changed"!==e?"length-changed"!==e?"position-changed"!==e?"opening"!==e?"playing"!==e?"paused"!==e?"stopped"!==e?"backward"!==e?"buffering"!==e?"encountered-error"!==e?"end-reached"!==e?"forward"!==e?"frame-cleanup"!==e?"media-changed"!==e?"nothing-special"!==e?"pausable-changed"!==e?"seekable-changed"!==e?"log-message"!==e||(this.player.onLogMessage=t):this.player.onSeekableChanged=t:this.player.onPausableChanged=t:this.player.onNothingSpecial=t:this.player.onMediaChanged=t:this.player.onFrameCleanup=t:this.player.onForward=t:this.player.onEndReached=t:this.player.onEncounteredError=t:this.player.onBuffering=t:this.player.onBackward=t:this.player.onStopped=t:this.player.onPaused=t:this.player.onPlaying=t:this.player.onOpening=t:this.player.onPositionChanged=t:this.player.onLengthChanged=t:this.player.onTimeChanged=t:this.player.onFrameSetup=t:this.player.onFrameReady=t}}l.WebChimeraAPI=window[s.u],l.client=i.a.create({media:Object(i.b)()});var c=l;var d=class{static get available(){return!!Object(i.c)()}};const u=i.a.create({loader:Object(i.b)()}).loader;class p{}p.Runtime=d,p.Player=c,p.Font=o,p.Loader=u;var h=p},"6f5cb1d8ac":function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return d}));var i=r("cf24892fbf");const n=()=>window[i.a];var o=r("d7c625d1f2");var a=class{constructor(e){this.handlers=new Map,this.closed=!1,this.subscribe=(e,t)=>{if(this.isClosed())throw new Error("channel is closed");return this.handlers.set(e,t),()=>{this.handlers.delete(e)}},this.publish=(e,...t)=>{if(this.isClosed())throw new Error("channel is closed");n().transport.publish({token:this.token,eventName:e,args:t})},this.fire=(e,...t)=>{var r;null===(r=this.handlers.get(e))||void 0===r||r(...t)},this.close=()=>{this.unsubscribe(),this.handlers.clear(),this.closed=!0},this.isClosed=()=>this.closed,this.unsubscribe=()=>{},this.token=e,this.unsubscribe=n().transport.subscribe(e,(({eventName:e,args:t})=>this.fire(e,...t)))}};var s=class{constructor(e){this.closed=!1,this.subscribe=(e,t)=>{if(this.isClosed())throw new Error("channel is closed");return n().transport.subscribe(this.token,e,t)},this.publish=(e,...t)=>{if(this.isClosed())throw new Error("channel is closed");n().transport.publish({token:this.token,eventName:e,args:t})},this.fire=()=>{},this.close=()=>{this.unsubscribe(),this.closed=!0},this.isClosed=()=>this.closed,this.unsubscribe=()=>{n().transport.unsubscribe(this.token)},this.token=e}};class l{constructor(e){this.protocols=e}static create(e,t){const r=new l(e);return r.init(t),r}init(e){const t=this;for(const r of Object.keys(this.protocols))try{this.registerServiceBroker(r,e)}catch(e){t[r]={version:0}}}registerServiceBroker(e,t){const r=this,i=n();if(!i)throw new Error("missing mega broker in global context");const{protocol:l,broker:c}=i.loadProtocol(e),{apis:d,channels:u,version:p}=l;r[e]={version:p};for(const t of d)r[e][t]=c[t];for(const i of u)r[e][i]=(...e)=>Object(o.__awaiter)(this,void 0,void 0,(function*(){const{token:r}=yield c[i](...e);return t?new s(r):new a(r)}))}}var c=l;var d=function(e={}){return Object.assign({},e)}},"76f1d59f9d":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r("711a53c9fc"),n=r("fdddc95d9b"),o=r("025e3e9b74"),a=r("a5bb88f217"),s=r("a6cf5e8204"),l=r("420d598ff9");class c{request(e,t=!1){return(t?this.transaction:e=>e())((()=>{this.events.emit(o.e.EnqueueMutations,this.onBeforeEnqueueMutations(e),n.a.Editor)})),e}guard(e){const t=this.getPresentation();if(!t)throw new Error("Presentation is not ready or model has no context");const r=e(t);if(r)throw r}getPresentation(){var e;const t=null===(e=this.model.context)||void 0===e?void 0:e.getPresentation();if(!t)throw new Error("Presentation is not ready or model has no context");return t}onBeforeEnqueueMutations(e){const t=[],r=new Set([i.c.SetPresentationProperties,i.c.SetPageProperties,i.c.SetTableCellProperties,i.c.SetTextProperties,i.c.SetChartSpaceProperties,i.c.SetSubChartProperties,i.c.SetTextBodyProperties]),n=new Set([i.c.SetShapeProperties,i.c.SetTextData]);for(const i of e){const e=i.toData();if(n.has(i.type)){const r=this.getPresentation().modifyData(e),n=this.getPresentation().findWildResourceMap(e,!0);if(n.count){t.push(i.clone(e)),t.push(...Object(l.a)(Object(s.a)(n)));continue}if(r){t.push(i.clone(e));continue}}if(r.has(i.type)){const r=this.getPresentation().findWildResourceMap(e,!0);if(r.count){t.push(i.clone(e)),t.push(...Object(l.a)(Object(s.a)(r)));continue}}t.push(i)}return t}constructor(e,t){this.model=e,this.events=t,this.forEachInTransaction=(e,t)=>{this.transaction((()=>{for(const[r,i]of e.entries())t(i,r)}))},this.transaction=Object(a.a)(t)}}},"7a7d98074c":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r("d7c625d1f2"),n=r("cf3340a08c"),o=r("3e2e3e7bce"),a=r("7064f45d39"),s=r("cc8734d850"),l=r("51e3210cf9"),c=r("727c0c7dd8"),d=r("04ed9bbbb2");class u extends d.a{updateProps({spPr:e,nvPr:t,graphic:r,bwMode:i,chartSpace:n}){return this.transaction((()=>{super.updateProps({spPr:e,nvPr:t,graphic:r,bwMode:i}),n&&this.request([new o.a({pageId:this.model.getPage().id,shapeId:this.model.id,chartSpacePr:n})])}))}updateSubChartProps(e,t){return this.transaction((()=>{this.request([new a.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:t,plot:(new c.a).createEgPlotBySubChart(e),axesPr:{axes:e.axes,index:e.axesAddIndex}})])}))}addSubChart(e,t){return this.transaction((()=>{this.request([new s.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:t,subChartType:e.type}),new a.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:t,plot:(new c.a).createEgPlotBySubChart(e),axesPr:{axes:e.axes,index:e.axesAddIndex}})])}))}removeSubChart(e){return this.transaction((()=>{this.request([new l.a({pageId:this.model.getPage().id,shapeId:this.model.id,index:null!=e?e:0})])}))}}Object(i.__decorate)([Object(n.a)()],u.prototype,"updateProps",null),Object(i.__decorate)([Object(n.a)()],u.prototype,"updateSubChartProps",null),Object(i.__decorate)([Object(n.a)()],u.prototype,"addSubChart",null),Object(i.__decorate)([Object(n.a)()],u.prototype,"removeSubChart",null)},"7b66f04f1e":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return s}));var i=r("d7c625d1f2"),n=function(e){function t(t,r){for(var i=this,n=t,o={cause:r};o.cause&&o.cause instanceof Error;)n=t+"\n\t→ "+r,o=o.cause;return(i=e.call(this,n)||this).cause=r,i.name=i.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(i,i.constructor):i.stack=(new Error).stack,Object.setPrototypeOf(i,i.constructor.prototype),i}return Object(i.__extends)(t,e),t}(Error),o={withDefaultMessage:function(e,t){return function(r){function n(i,n){var o=r.call(this,i||t||"",n)||this;return o.name=e,Object.setPrototypeOf(o,o.constructor.prototype),o}return Object(i.__extends)(n,r),n}(n)},withMessageCreator:function(e,t){return function(r){function n(i,n){var o=r.call(this,t(i),n)||this;return o.name=e,Object.setPrototypeOf(o,o.constructor.prototype),o}return Object(i.__extends)(n,r),n}(n)}},a=(o.withDefaultMessage("AssertionError","the asserted condition is invalid"),o.withMessageCreator("UnimplementedError",(function(e){return e?"called with arguments: "+JSON.stringify(e):"called with nothing"})));var s=function(e){0}},"7c46f42788":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return l}));var i,n=r("711a53c9fc");!function(e){e[e.Presentation=1]="Presentation",e[e.Slide=2]="Slide",e[e.SlideMaster=3]="SlideMaster",e[e.SlideLayout=4]="SlideLayout",e[e.Notes=5]="Notes",e[e.NotesMaster=6]="NotesMaster",e[e.Shape=7]="Shape",e[e.GroupShape=8]="GroupShape",e[e.Connector=9]="Connector",e[e.Picture=10]="Picture",e[e.GraphicalObjectFrameTable=11]="GraphicalObjectFrameTable",e[e.GraphicalObjectFrameChart=12]="GraphicalObjectFrameChart",e[e.GraphicalObjectFrameUnknown=13]="GraphicalObjectFrameUnknown",e[e.Section=14]="Section",e[e.Theme=15]="Theme",e[e.Timing=16]="Timing",e[e.GraphicalObjectFrameSmartArt=17]="GraphicalObjectFrameSmartArt"}(i||(i={}));class o{static fromSTPageType(e){return{[n.Q.slide]:2,[n.Q.slideMaster]:3,[n.Q.slideLayout]:4,[n.Q.notes]:5,[n.Q.notesMaster]:6}[e]}static fromShapeType(e){if(e===n.ac.GraphicalObjectFrameUnknown)throw new Error(`unknown shape type ${n.ac[e]}`);return{[n.ac.Shape]:7,[n.ac.Equation]:7,[n.ac.GroupShape]:8,[n.ac.GraphicalObjectFrameSmartart]:17,[n.ac.GraphicalObjectFrameSmartartNew]:17,[n.ac.Picture]:10,[n.ac.Connector]:9,[n.ac.GraphicalObjectFrameTable]:11,[n.ac.GraphicalObjectFrameChart]:12,[n.ac.Ink]:10,[n.ac.GraphicalObjectFrameOleObject]:10,[n.ac.GraphicalObjectFrameThreeDimentionalModel]:10}[e]}static toSTPageType(e){return{2:n.Q.slide,3:n.Q.slideMaster,4:n.Q.slideLayout,5:n.Q.notes,6:n.Q.notesMaster}[e]}static toShapeType(e){return{7:n.ac.Shape,8:n.ac.GroupShape,10:n.ac.Picture,9:n.ac.Connector,11:n.ac.GraphicalObjectFrameTable,12:n.ac.GraphicalObjectFrameChart,17:n.ac.GraphicalObjectFrameSmartartNew,13:n.ac.GraphicalObjectFrameUnknown}[e]}}const a=[7,8,10,9,11,12,17,13],s=[2,3,4,5,6],l=[2,3,4,5,6]},"7d347d6549":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i,n=r("1f69014a3c"),o=r("51767cbdc7"),a=r("d7c625d1f2"),s=r("f78be71a2b"),l=r("285f8ccc4f"),c=r("cf3340a08c"),d=r("ea786cec83"),u=r("7c46f42788"),p=r("969172f78b");!function(e){e.titleTextStyleList="titleTextStyleList",e.bodyTextStyleList="bodyTextStyleList",e.otherTextStyleList="otherTextStyleList"}(i||(i={}));class h extends p.a{addPlaceholder(e){const t=Object(s.f)(s.c[e]);return this.modifyPlaceholderData(t),this.addShapes([t]),this.model.store.findPlaceholderShape({type:s.d[e]})}updateName(e){const t=this.model.getTheme();return null==t?void 0:t.api.updateTheme({},e)}updateTextStyles(e,t){["titleStyle","bodyStyle","otherStyle"].includes(e)&&this.transaction((()=>{this.updateProps({txStyles:{[e]:null}}),this.updateProps({txStyles:{[e]:t}})}))}unlinkMatchedShapesOfPlaceholder(e){this.transaction((()=>{this.model.layoutList.forEach((t=>{var r;if(this.model.id===(null===(r=t.getMaster())||void 0===r?void 0:r.id))for(const r of t.placeholders){var i,n;if(!this.model.store.isMatchedPlaceholder(r.props.nvPr.ph,e.props.nvPr.ph))return;r.api.updateTransform(Object(l.a)(null===(i=e.getInheritedData().spPr)||void 0===i?void 0:i.xfrm)),r.api.updateProps({spPr:{prstGeom:{prst:null===(n=e.props.spPr.prstGeom)||void 0===n?void 0:n.prst}}})}}))}))}updateHeaderFooter(e){this.transaction((()=>{this.updateProps({hf:null}),this.updateProps({hf:e})}))}useThemeFontInTextStyle(){const e=Array.from({length:9},((e,t)=>t+1)).reduce(((e,t)=>Object(o.a)(Object(n.a)({},e),{[`lvl${t}pPr`]:{defRPr:{latin:{typeface:"+mn-lt"},ea:{typeface:"+mn-ea"}}}})),{});this.updateProps({txStyles:{titleStyle:{lvl1pPr:{defRPr:{latin:{typeface:"+mj-lt"},ea:{typeface:"+mj-ea"}}}},bodyStyle:e,otherStyle:e}})}updateSlideGuideList(e,t=!1){this.transaction((()=>{const r=new d.b({pageId:this.model.id,pageType:u.b.toSTPageType(this.model.type),masterProperties:{slideGuideList:{guide:e.map(((e,t)=>Object(o.a)(Object(n.a)({},e),{id:`${t+1}`})))}}});r.invertible=t,this.request([r])}))}modifyPlaceholderData(e){var t,r,i,n;const o=e.spPr.xfrm,a=this.model.parent.props.sldSz.cx/12192e3,s=this.model.parent.props.sldSz.cy/6858e3;(null==o||null===(t=o.ext)||void 0===t?void 0:t.cx)&&(o.ext.cx=o.ext.cx*a),(null==o||null===(r=o.ext)||void 0===r?void 0:r.cy)&&(o.ext.cy=o.ext.cy*s),(null==o||null===(i=o.off)||void 0===i?void 0:i.x)&&(o.off.x=o.off.x*a),(null==o||null===(n=o.off)||void 0===n?void 0:n.y)&&(o.off.y=o.off.y*s)}}Object(a.__decorate)([Object(c.a)()],h.prototype,"addPlaceholder",null),Object(a.__decorate)([Object(c.a)()],h.prototype,"updateName",null),Object(a.__decorate)([Object(c.a)()],h.prototype,"updateTextStyles",null),Object(a.__decorate)([Object(c.a)()],h.prototype,"unlinkMatchedShapesOfPlaceholder",null),Object(a.__decorate)([Object(c.a)()],h.prototype,"updateHeaderFooter",null),Object(a.__decorate)([Object(c.a)()],h.prototype,"useThemeFontInTextStyle",null),Object(a.__decorate)([Object(c.a)()],h.prototype,"updateSlideGuideList",null)},"8bed1d6e25":function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cdnSources=void 0;var n=i(r("d7a2286b24")).default.getInstance().getConfig('npm["@tencent/netcheck"]');t.cdnSources=Object.values((null==n?void 0:n.cdnSources)||["https://docs.qq.com/net-check/img","https://docs.gtimg.com/components/img/1px.gif","https://docs2.gtimg.com/components/img/1px.gif"])},"93085721b7":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r("7c46f42788"),n=r("b09773c80f"),o=r("3ac5e24f6b");class a extends n.a{static fromPageContext(e){const t=new a(e.getPageType());return t.initContextFromPageContext(e),t}getPageType(){return this.pageType}getMaster(){return this.master}getLayout(){return this.layout}setLayout(e){this.layout=e}setMaster(e){this.master=e}getPlaceholder(e){if(e){var t,r,n,o;if(this.pageType===i.a.Slide)return null!==(n=null===(t=this.getLayout())||void 0===t?void 0:t.getPlaceholderShape(e))&&void 0!==n?n:null===(r=this.getMaster())||void 0===r?void 0:r.getPlaceholderShape(e);if(this.pageType===i.a.SlideLayout)return null===(o=this.getMaster())||void 0===o?void 0:o.getPlaceholderShape(e)}}getPage(){if(!this.page)throw new Error("getPage from PageContext without setPage");return this.page}setPage(e){this.page=e}setSlide(e){this.slide=e}getSlide(){return this.slide}getTheme(){return this.theme}setTheme(e){this.theme=e,this.getAliasColorMap()&&(this.themeContext=new o.a({theme:e,aliasColorMap:this.getAliasColorMap()}))}getThemeContext(){return this.themeContext||(this.themeContext=new o.a({theme:this.getTheme(),aliasColorMap:this.getAliasColorMap()})),this.themeContext}initContextFromPageContext(e){const t=e.getTheme(),r=e.getSlide(),i=e.getTarget();this.setPresentation(e.getPresentation()),this.setMaster(e.getMaster()),this.setLayout(e.getLayout()),this.setPage(e.getPage()),i&&this.setTarget(i),r&&this.setSlide(r),t&&this.setTheme(t)}getAliasColorMap(){const e=this.getMaster();if(!(null==e?void 0:e.props))return;const t=e.props.clrMap;if([i.a.Slide,i.a.SlideLayout].includes(this.pageType)){var r,n;const e=this.getSlide(),i=this.getLayout();var o;const{overrideClrMapping:l}=null!==(o=null==e||null===(r=e.props)||void 0===r?void 0:r.clrMapOvr)&&void 0!==o?o:{masterClrMapping:!0};var a;const{overrideClrMapping:c}=null!==(a=null==i||null===(n=i.props)||void 0===n?void 0:n.clrMapOvr)&&void 0!==a?a:{masterClrMapping:!0};var s;return null!==(s=null!=l?l:c)&&void 0!==s?s:t}return t}constructor(e){super(),this.pageType=e}}},"9559b6ab8e":function(e,t,r){"use strict";r.d(t,"j",(function(){return n})),r.d(t,"E",(function(){return o})),r.d(t,"v",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"z",(function(){return l})),r.d(t,"A",(function(){return c})),r.d(t,"G",(function(){return d})),r.d(t,"c",(function(){return u})),r.d(t,"i",(function(){return p})),r.d(t,"F",(function(){return h})),r.d(t,"H",(function(){return m})),r.d(t,"o",(function(){return g})),r.d(t,"p",(function(){return b})),r.d(t,"n",(function(){return v})),r.d(t,"s",(function(){return y})),r.d(t,"w",(function(){return S})),r.d(t,"a",(function(){return x})),r.d(t,"C",(function(){return _})),r.d(t,"h",(function(){return T})),r.d(t,"f",(function(){return O})),r.d(t,"q",(function(){return P})),r.d(t,"x",(function(){return C})),r.d(t,"t",(function(){return I})),r.d(t,"l",(function(){return w})),r.d(t,"d",(function(){return E})),r.d(t,"B",(function(){return j})),r.d(t,"m",(function(){return A})),r.d(t,"k",(function(){return L})),r.d(t,"I",(function(){return k})),r.d(t,"J",(function(){return D})),r.d(t,"D",(function(){return R})),r.d(t,"u",(function(){return M})),r.d(t,"r",(function(){return B})),r.d(t,"y",(function(){return N})),r.d(t,"e",(function(){return F})),r.d(t,"g",(function(){return U}));var i=r("711a53c9fc");const n="default_click_spid",o={MAIN_SEQ:"mainSeq",INTERACTIVE_SEQ:"interactiveSeq"},a={NONE:"none",CLICK_EFFECT:"clickEffect",WITH_EFFECT:"withEffect",AFTER_EFFECT:"afterEffect"};var s,l,c,d,u,p,h,m,f;!function(e){e.None="none",e.FadeIn="fade_in",e.FadeOut="fade_out",e.Scale="scale",e.Appear="appear",e.Disappear="disappear",e.FlyIn="fly_in",e.FlyOut="fly_out",e.FloatUpIn="float_up_in",e.FloatUpOut="float_up_out",e.FloatDownIn="float_down_in",e.FloatDownOut="float_down_out",e.CutIn="cut_in",e.CutOut="cut_out",e.Rotate="rotate",e.Plus="pluse",e.Spread="spread",e.EnterRotate="entr_rotate",e.EnterScale="entr_scale",e.ExitSpread="exit_spread",e.ExitRotate="exit_rotate",e.ExitScale="exit_scale",e.EntrCenterRevolve="entr_center_revolve",e.EntrGrowTurn="entr_grow_turn",e.EntrRiseUp="entr_rise_up",e.EntrSpinner="entr_spinner",e.EntrBasicZoom="entr_basic_zoom",e.EntrStretch="entr_stretch",e.ExitCenterRevolve="exit_center_revolve",e.ExitShrinkTurn="exit_shrink_turn",e.ExitSinkDown="exit_sink_down",e.ExitSpinner="exit_spinner",e.ExitBasicZoom="exit_basic_zoom",e.ExitStretch="exit_stretch",e.ExitCollapse="exit_collapse",e.EntrBoomerang="entr_boomerang",e.EntrPinwheel="entr_pinwheel",e.EntrBasicSwivel="entr_basic_swivel",e.ExitBoomerang="exit_boomerang",e.ExitPinwheel="exit_pinwheel",e.ExitBasicSwivel="exit_basic_swivel",e.EmphTransparency="emph_transparency",e.FillColor="fill_color",e.FontColor="font_color",e.LineColor="line_color",e.BrushColor="brush_color",e.ComplementaryColor="complementary_color",e.ComplementaryColor2="complementary_color2",e.ContrastingColor="contrasting_color",e.Darken="darken",e.Desaturate="desaturate",e.Lighten="lighten",e.ObjectColor="object_color",e.ColorPulse="color_pulse",e.GrowWithColor="grow_with_color",e.Shimmer="shimmer",e.Teeter="teeter",e.Blink="blink",e.BoldReveal="bold_reveal",e.Wave="wave",e.BoldFlash="bold_flash",e.Underline="underline",e.Arc="arc",e.StraightLine="straight_line",e.Cycle="cycle",e.Shape="shape",e.Turn="turn",e.Custom="custom",e.EntrCredits="entr_credits",e.ExitCredits="exit_credits",e.EntrBlinds="entr_blinds",e.ExitBlinds="exit_blinds",e.EntrFloat="entr_float",e.ExitFloat="exit_float",e.EntrCheckerboard="entr_checkerboard",e.ExitCheckerboard="exit_checkerboard",e.CurveUp="curve_up",e.CurveDown="curve_down",e.EntrWipe="entr_wipe",e.ExitWipe="exit_wipe",e.EntrRandomBars="entr_random_bars",e.ExitRandomBars="exit_random_bars",e.DissolveIn="dissolve_in",e.DissolveOut="dissolve_out",e.EntrSplit="entr_split",e.ExitSplit="exit_split",e.EntrStrips="entr_strips",e.ExitStrips="exit_strips",e.EntrShapeCircle="entr_shape_circle",e.ExitShapeCircle="exit_shape_circle",e.EntrShapeBox="entr_shape_box",e.ExitShapeBox="exit_shape_box",e.EntrShapeDiamond="entr_shape_diamond",e.ExitShapeDiamond="exit_shape_diamond",e.EntrShapePlus="entr_shape_plus",e.ExitShapePlus="exit_shape_plus",e.EntrWedge="entr_wedge",e.ExitWedge="exit_wedge",e.EntrWheel="entr_wheel",e.ExitWheel="exit_wheel",e.EntrBounce="entr_bounce",e.ExitBounce="exit_bounce",e.SpiralIn="sprial_in",e.SpiralOut="sprial_out",e.Play="play",e.Pause="pause",e.Stop="stop"}(s||(s={})),function(e){e[e.None=-1]="None",e[e.Appear=1]="Appear",e[e.Fly=2]="Fly",e[e.Stop=3]="Stop",e[e.Box=4]="Box",e[e.Checkerboard=5]="Checkerboard",e[e.ScaleOrCircle=6]="ScaleOrCircle",e[e.RotateOrDiamond=8]="RotateOrDiamond",e[e.EmphTransparency=9]="EmphTransparency",e[e.Fade=10]="Fade",e[e.Cut=12]="Cut",e[e.Plus=13]="Plus",e[e.RandomBars=14]="RandomBars",e[e.Sprial=15]="Sprial",e[e.Split=16]="Split",e[e.EntrStretch=17]="EntrStretch",e[e.Strips=18]="Strips",e[e.BasicSwivel=19]="BasicSwivel",e[e.Wedge=20]="Wedge",e[e.Wheel=21]="Wheel",e[e.Wipe=22]="Wipe",e[e.EntrBasicZoom=23]="EntrBasicZoom",e[e.Boomerang=25]="Boomerang",e[e.PluseOrBounce=26]="PluseOrBounce",e[e.Credits=28]="Credits",e[e.Float=30]="Float",e[e.EntrGrowTurn=31]="EntrGrowTurn",e[e.Pinwheel=35]="Pinwheel",e[e.EntrRiseUp=37]="EntrRiseUp",e[e.FloatUp=42]="FloatUp",e[e.EntrCenterRevolve=43]="EntrCenterRevolve",e[e.EntrRotate=45]="EntrRotate",e[e.FloatDown=47]="FloatDown",e[e.EntrSpinner=49]="EntrSpinner",e[e.ExitStretch=50]="ExitStretch",e[e.Curve=52]="Curve",e[e.EntrScale=53]="EntrScale",e[e.Spread=55]="Spread",e[e.FillColor=1]="FillColor",e[e.FontColor=3]="FontColor",e[e.LineColor=7]="LineColor",e[e.BrushColor=16]="BrushColor",e[e.ComplementaryColor=21]="ComplementaryColor",e[e.ComplementaryColor2=22]="ComplementaryColor2",e[e.ContrastingColor=23]="ContrastingColor",e[e.Darken=24]="Darken",e[e.Desaturate=25]="Desaturate",e[e.Lighten=30]="Lighten",e[e.ObjectColor=19]="ObjectColor",e[e.ColorPulse=27]="ColorPulse",e[e.GrowWithColor=28]="GrowWithColor"}(l||(l={})),function(e){e[e.None=-1]="None",e[e.UnSupport=0]="UnSupport",e[e.Top=1]="Top",e[e.Right=2]="Right",e[e.TopRight=3]="TopRight",e[e.Bottom=4]="Bottom",e[e.Vertical=5]="Vertical",e[e.BottomRight=6]="BottomRight",e[e.Left=8]="Left",e[e.TopLeft=9]="TopLeft",e[e.Across=10]="Across",e[e.BottomLeft=12]="BottomLeft",e[e.EleCenter=16]="EleCenter",e[e.ToSlideBottom=20]="ToSlideBottom",e[e.VerticalIn=21]="VerticalIn",e[e.HorizontalIn=26]="HorizontalIn",e[e.ToEleCenter=32]="ToEleCenter",e[e.OutBottom=36]="OutBottom",e[e.VerticalOut=37]="VerticalOut",e[e.HorizontalOut=42]="HorizontalOut",e[e.LeftRight=110]="LeftRight",e[e.TopBottom=111]="TopBottom",e[e.Total=112]="Total",e[e.Clockwise=113]="Clockwise",e[e.Counterclockwise=114]="Counterclockwise",e[e.InSlightly=272]="InSlightly",e[e.OutSlightly=288]="OutSlightly",e[e.SlideCenter=528]="SlideCenter",e[e.ToSlideCenter=544]="ToSlideCenter"}(c||(c={})),function(e){e[e.Down=42]="Down",e[e.Left=35]="Left",e[e.Right=63]="Right",e[e.Up=64]="Up",e[e.RightDown=49]="RightDown",e[e.RightUp=56]="RightUp"}(d||(d={})),function(e){e[e.Down=37]="Down",e[e.Left=51]="Left",e[e.Right=58]="Right",e[e.Up=44]="Up"}(u||(u={})),function(e){e[e.Horizontal=26]="Horizontal",e[e.Vertical=22]="Vertical",e[e.Repeat=24]="Repeat"}(p||(p={})),function(e){e[e.Circle=1]="Circle",e[e.CurveSquare=20]="CurveSquare",e[e.Rhombus=3]="Rhombus",e[e.EquilateralTriangle=13]="EquilateralTriangle",e[e.Hexagon=4]="Hexagon",e[e.Octagon=10]="Octagon",e[e.Parallelogram=14]="Parallelogram",e[e.Pentagon=15]="Pentagon",e[e.RightTriangle=2]="RightTriangle",e[e.Square=7]="Square",e[e.Ladder=8]="Ladder"}(h||(h={})),function(e){e[e.Down=50]="Down",e[e.RightDown=36]="RightDown",e[e.Up=43]="Up",e[e.RightUp=57]="RightUp"}(m||(m={})),function(e){e[e.PLAY=1]="PLAY",e[e.PAUSE=2]="PAUSE"}(f||(f={}));const g={1:"appear",10:"fade_in",42:"float_up_in",47:"float_down_in",2:"fly_in",12:"cut_in",55:"spread",45:"entr_rotate",53:"entr_scale",43:"entr_center_revolve",31:"entr_grow_turn",37:"entr_rise_up",49:"entr_spinner",23:"entr_basic_zoom",17:"entr_stretch",25:"entr_boomerang",35:"entr_pinwheel",19:"entr_basic_swivel",28:"entr_credits",3:"entr_blinds",30:"entr_float",5:"entr_checkerboard",52:"curve_up",22:"entr_wipe",14:"entr_random_bars",9:"dissolve_in",16:"entr_split",18:"entr_strips",4:"entr_shape_box",6:"entr_shape_circle",8:"entr_shape_diamond",13:"entr_shape_plus",20:"entr_wedge",21:"entr_wheel",26:"entr_bounce",15:"sprial_in"},b={1:"disappear",10:"fade_out",2:"fly_out",42:"float_up_out",47:"float_down_out",12:"cut_out",22:"exit_wipe",55:"exit_spread",45:"exit_rotate",53:"exit_scale",43:"exit_center_revolve",17:"exit_collapse",31:"exit_shrink_turn",37:"exit_sink_down",49:"exit_spinner",23:"exit_basic_zoom",50:"exit_stretch",25:"exit_boomerang",35:"exit_pinwheel",19:"exit_basic_swivel",28:"exit_credits",3:"exit_blinds",30:"exit_float",5:"exit_checkerboard",52:"curve_down",14:"exit_random_bars",9:"dissolve_out",16:"exit_split",18:"exit_strips",4:"exit_shape_box",6:"exit_shape_circle",8:"exit_shape_diamond",13:"exit_shape_plus",20:"exit_wedge",21:"exit_wheel",26:"exit_bounce",15:"sprial_out"},v={6:"scale",8:"rotate",26:"pluse",9:"emph_transparency",1:"fill_color",3:"font_color",7:"line_color",16:"brush_color",21:"complementary_color",22:"complementary_color2",23:"contrasting_color",24:"darken",25:"desaturate",30:"lighten",19:"object_color",27:"color_pulse",28:"grow_with_color"},y={1:"play",2:"pause",3:"stop"};const S=function(){const e={};return[{idsObj:d,type:"straight_line"},{idsObj:u,type:"arc"},{idsObj:p,type:"cycle"},{idsObj:h,type:"shape"},{idsObj:m,type:"turn"}].forEach((t=>{const{idsObj:r,type:i}=t;Object.values(r).forEach((t=>{e[t]=i}))})),e}(),x={fade_in:"fade_in_tn",fade_out:"fade_out_tn",scale:"scale",appear:"appear",disappear:"disappear",fly_in:"fly_in",fly_out:"fly_out",float_up_in:"float_up_in",float_up_out:"float_up_out",float_down_in:"float_down_in",float_down_out:"float_down_out",cut_in:"cut_in",cut_out:"cut_out",pluse:"pluse",rotate:"rotate",spread:"spread",entr_rotate:"entr_rotate",entr_scale:"entr_scale",exit_spread:"exit_spread",exit_rotate:"exit_rotate",exit_scale:"exit_scale",entr_center_revolve:"entr_center_revolve",entr_grow_turn:"entr_grow_turn",entr_rise_up:"entr_rise_up",entr_spinner:"entr_spinner",entr_basic_zoom:"entr_basic_zoom",entr_stretch:"entr_stretch",exit_center_revolve:"exit_center_revolve",exit_shrink_turn:"exit_shrink_turn",exit_sink_down:"exit_sink_down",exit_spinner:"exit_spinner",exit_basic_zoom:"exit_basic_zoom",exit_stretch:"exit_stretch",exit_collapse:"exit_collapse",entr_boomerang:"entr_boomerang",entr_pinwheel:"entr_pinwheel",entr_basic_swivel:"entr_basic_swivel",exit_boomerang:"exit_boomerang",exit_pinwheel:"exit_pinwheel",exit_basic_swivel:"exit_basic_swivel",emph_transparency:"emph_transparency",entr_credits:"entr_credits",exit_credits:"exit_credits",entr_blinds:"entr_blinds",exit_blinds:"exit_blinds",entr_float:"entr_float",exit_float:"exit_float",entr_checkerboard:"entr_checkerboard",exit_checkerboard:"exit_checkerboard",curve_up:"curve_up",curve_down:"curve_down",entr_wipe:"entr_wipe",exit_wipe:"exit_wipe",entr_random_bars:"entr_random_bars",exit_random_bars:"exit_random_bars",dissolve_in:"dissolve_in",dissolve_out:"dissolve_out",entr_split:"entr_split",exit_split:"exit_split",entr_strips:"entr_strips",exit_strips:"exit_strips",entr_shape_circle:"entr_shape_circle",exit_shape_circle:"exit_shape_circle",entr_shape_box:"entr_shape_box",exit_shape_box:"exit_shape_box",entr_shape_diamond:"entr_shape_diamond",exit_shape_diamond:"exit_shape_diamond",entr_shape_plus:"entr_shape_plus",exit_shape_plus:"exit_shape_plus",entr_wedge:"entr_wedge",exit_wedge:"exit_wedge",entr_wheel:"entr_wheel",exit_wheel:"exit_wheel",entr_bounce:"entr_bounce",exit_bounce:"exit_bounce",sprial_in:"sprial_in",sprial_out:"sprial_out",play:"play",pause:"pause",stop:"stop",fill_color:"fill_color",font_color:"font_color",line_color:"line_color",brush_color:"brush_color",complementary_color:"complementary_color",complementary_color2:"complementary_color2",contrasting_color:"contrasting_color",darken:"darken",desaturate:"desaturate",lighten:"lighten",object_color:"object_color",color_pulse:"color_pulse",grow_with_color:"grow_with_color"},_={1:{ppt_x:{0:"#ppt_x",1e5:"#ppt_x"},ppt_y:{0:"#ppt_y-#ppt_h/2",1e5:"#ppt_y"},ppt_w:{0:"#ppt_w",1e5:"#ppt_w"},ppt_h:{0:0,1e5:"#ppt_h"}},4:{ppt_x:{0:"#ppt_x",1e5:"#ppt_x"},ppt_y:{0:"#ppt_y+#ppt_h/2",1e5:"#ppt_y"},ppt_w:{0:"#ppt_w",1e5:"#ppt_w"},ppt_h:{0:0,1e5:"#ppt_h"}},8:{ppt_x:{0:"#ppt_x-#ppt_w/2",1e5:"#ppt_x"},ppt_y:{0:"#ppt_y",1e5:"#ppt_y"},ppt_w:{0:0,1e5:"#ppt_w"},ppt_h:{0:"#ppt_h",1e5:"#ppt_h"}},2:{ppt_x:{0:"#ppt_x+#ppt_w/2",1e5:"#ppt_x"},ppt_y:{0:"#ppt_y",1e5:"#ppt_y"},ppt_w:{0:0,1e5:"#ppt_w"},ppt_h:{0:"#ppt_h",1e5:"#ppt_h"}},10:{ppt_w:{0:0,1e5:"#ppt_w"},ppt_h:{0:"#ppt_h",1e5:"#ppt_h"}}};var T,O;!function(e){e.schemeClr="schemeClr",e.srgbClr="srgbClr"}(T||(T={})),function(e){e.anim="anim",e.animClr="animClr",e.animEffect="animEffect",e.animMotion="animMotion",e.animRot="animRot",e.animScale="animScale",e.cmd="cmd",e.set="set"}(O||(O={}));const P="kDefaultTriggerId",C="path_timing",I="media_",w={entr_rise_up:.9,exit_sink_down:.1};var E;!function(e){e.none="NONE",e.rotation="style.rotation",e.visibility="style.visibility",e.pptX="ppt_x",e.pptY="ppt_y",e.pptW="ppt_w",e.pptH="ppt_h"}(E||(E={}));const j="cBhvr.tgtEl.spTgt.spid",A="cBhvr.cTn.dur",L="cBhvr.cTn.stCondLst.cond[0].delay",k=["ppt_w","ppt_h"],D=["ppt_x","ppt_y"],R=[{presetClass:i.Ab.entr,presetId:1,presetSubtype:0},{presetClass:i.Ab.exit,presetId:1,presetSubtype:0},{presetClass:i.Ab.entr,presetId:10,presetSubtype:0},{presetClass:i.Ab.exit,presetId:10,presetSubtype:0},{presetClass:i.Ab.emph,presetId:6,presetSubtype:0},{presetClass:i.Ab.entr,presetId:2,presetSubtype:1},{presetClass:i.Ab.entr,presetId:2,presetSubtype:2},{presetClass:i.Ab.entr,presetId:2,presetSubtype:3},{presetClass:i.Ab.entr,presetId:2,presetSubtype:4},{presetClass:i.Ab.entr,presetId:2,presetSubtype:6},{presetClass:i.Ab.entr,presetId:2,presetSubtype:8},{presetClass:i.Ab.entr,presetId:2,presetSubtype:9},{presetClass:i.Ab.entr,presetId:2,presetSubtype:12},{presetClass:i.Ab.entr,presetId:55,presetSubtype:0},{presetClass:i.Ab.entr,presetId:45,presetSubtype:0},{presetClass:i.Ab.entr,presetId:53,presetSubtype:16},{presetClass:i.Ab.entr,presetId:53,presetSubtype:528},{presetClass:i.Ab.entr,presetId:43,presetSubtype:0},{presetClass:i.Ab.entr,presetId:31,presetSubtype:0},{presetClass:i.Ab.entr,presetId:37,presetSubtype:0},{presetClass:i.Ab.entr,presetId:49,presetSubtype:0},{presetClass:i.Ab.entr,presetId:23,presetSubtype:16},{presetClass:i.Ab.entr,presetId:23,presetSubtype:528},{presetClass:i.Ab.entr,presetId:23,presetSubtype:272},{presetClass:i.Ab.entr,presetId:23,presetSubtype:32},{presetClass:i.Ab.entr,presetId:23,presetSubtype:36},{presetClass:i.Ab.entr,presetId:23,presetSubtype:288},{presetClass:i.Ab.entr,presetId:17,presetSubtype:10},{presetClass:i.Ab.entr,presetId:17,presetSubtype:1},{presetClass:i.Ab.entr,presetId:17,presetSubtype:4},{presetClass:i.Ab.entr,presetId:17,presetSubtype:8},{presetClass:i.Ab.entr,presetId:17,presetSubtype:2},{presetClass:i.Ab.exit,presetId:43,presetSubtype:0},{presetClass:i.Ab.exit,presetId:31,presetSubtype:0},{presetClass:i.Ab.exit,presetId:37,presetSubtype:0},{presetClass:i.Ab.exit,presetId:49,presetSubtype:0},{presetClass:i.Ab.exit,presetId:23,presetSubtype:32},{presetClass:i.Ab.exit,presetId:23,presetSubtype:544},{presetClass:i.Ab.exit,presetId:23,presetSubtype:288},{presetClass:i.Ab.exit,presetId:23,presetSubtype:16},{presetClass:i.Ab.exit,presetId:23,presetSubtype:20},{presetClass:i.Ab.exit,presetId:23,presetSubtype:272},{presetClass:i.Ab.exit,presetId:17,presetSubtype:10},{presetClass:i.Ab.exit,presetId:17,presetSubtype:1},{presetClass:i.Ab.exit,presetId:17,presetSubtype:4},{presetClass:i.Ab.exit,presetId:17,presetSubtype:8},{presetClass:i.Ab.exit,presetId:17,presetSubtype:2},{presetClass:i.Ab.exit,presetId:50,presetSubtype:0},{presetClass:i.Ab.exit,presetId:2,presetSubtype:1},{presetClass:i.Ab.exit,presetId:2,presetSubtype:2},{presetClass:i.Ab.exit,presetId:2,presetSubtype:3},{presetClass:i.Ab.exit,presetId:2,presetSubtype:4},{presetClass:i.Ab.exit,presetId:2,presetSubtype:6},{presetClass:i.Ab.exit,presetId:2,presetSubtype:8},{presetClass:i.Ab.exit,presetId:2,presetSubtype:9},{presetClass:i.Ab.exit,presetId:2,presetSubtype:12},{presetClass:i.Ab.exit,presetId:55,presetSubtype:0},{presetClass:i.Ab.exit,presetId:45,presetSubtype:0},{presetClass:i.Ab.exit,presetId:53,presetSubtype:32},{presetClass:i.Ab.exit,presetId:53,presetSubtype:544},{presetClass:i.Ab.entr,presetId:42,presetSubtype:0},{presetClass:i.Ab.entr,presetId:47,presetSubtype:0},{presetClass:i.Ab.exit,presetId:42,presetSubtype:0},{presetClass:i.Ab.exit,presetId:47,presetSubtype:0},{presetClass:i.Ab.entr,presetId:12,presetSubtype:1},{presetClass:i.Ab.entr,presetId:12,presetSubtype:2},{presetClass:i.Ab.entr,presetId:12,presetSubtype:4},{presetClass:i.Ab.entr,presetId:12,presetSubtype:8},{presetClass:i.Ab.exit,presetId:12,presetSubtype:1},{presetClass:i.Ab.exit,presetId:12,presetSubtype:2},{presetClass:i.Ab.exit,presetId:12,presetSubtype:4},{presetClass:i.Ab.exit,presetId:12,presetSubtype:8},{presetClass:i.Ab.emph,presetId:8,presetSubtype:0},{presetClass:i.Ab.emph,presetId:26,presetSubtype:0},{presetClass:i.Ab.entr,presetId:25,presetSubtype:0},{presetClass:i.Ab.entr,presetId:35,presetSubtype:0},{presetClass:i.Ab.entr,presetId:19,presetSubtype:10},{presetClass:i.Ab.entr,presetId:19,presetSubtype:5},{presetClass:i.Ab.entr,presetId:28,presetSubtype:0},{presetClass:i.Ab.exit,presetId:25,presetSubtype:0},{presetClass:i.Ab.exit,presetId:35,presetSubtype:0},{presetClass:i.Ab.exit,presetId:19,presetSubtype:10},{presetClass:i.Ab.exit,presetId:19,presetSubtype:5},{presetClass:i.Ab.exit,presetId:28,presetSubtype:0},{presetClass:i.Ab.emph,presetId:9,presetSubtype:0},{presetClass:i.Ab.emph,presetId:1,presetSubtype:2},{presetClass:i.Ab.emph,presetId:3,presetSubtype:2},{presetClass:i.Ab.emph,presetId:7,presetSubtype:2},{presetClass:i.Ab.emph,presetId:16,presetSubtype:0},{presetClass:i.Ab.emph,presetId:21,presetSubtype:0},{presetClass:i.Ab.emph,presetId:22,presetSubtype:0},{presetClass:i.Ab.emph,presetId:23,presetSubtype:0},{presetClass:i.Ab.emph,presetId:24,presetSubtype:0},{presetClass:i.Ab.emph,presetId:25,presetSubtype:0},{presetClass:i.Ab.emph,presetId:30,presetSubtype:0},{presetClass:i.Ab.emph,presetId:19,presetSubtype:0},{presetClass:i.Ab.emph,presetId:27,presetSubtype:0},{presetClass:i.Ab.emph,presetId:28,presetSubtype:0},{presetClass:i.Ab.mediacall,presetId:1,presetSubtype:0},{presetClass:i.Ab.mediacall,presetId:2,presetSubtype:0},{presetClass:i.Ab.entr,presetId:3,presetSubtype:10},{presetClass:i.Ab.entr,presetId:3,presetSubtype:5},{presetClass:i.Ab.exit,presetId:3,presetSubtype:10},{presetClass:i.Ab.exit,presetId:3,presetSubtype:5},{presetClass:i.Ab.entr,presetId:30,presetSubtype:0},{presetClass:i.Ab.exit,presetId:30,presetSubtype:0},{presetClass:i.Ab.entr,presetId:5,presetSubtype:10},{presetClass:i.Ab.exit,presetId:5,presetSubtype:10},{presetClass:i.Ab.entr,presetId:5,presetSubtype:5},{presetClass:i.Ab.exit,presetId:5,presetSubtype:5},{presetClass:i.Ab.entr,presetId:52,presetSubtype:0},{presetClass:i.Ab.exit,presetId:52,presetSubtype:0},{presetClass:i.Ab.entr,presetId:22,presetSubtype:1},{presetClass:i.Ab.entr,presetId:22,presetSubtype:2},{presetClass:i.Ab.entr,presetId:22,presetSubtype:4},{presetClass:i.Ab.entr,presetId:22,presetSubtype:8},{presetClass:i.Ab.exit,presetId:22,presetSubtype:1},{presetClass:i.Ab.exit,presetId:22,presetSubtype:2},{presetClass:i.Ab.exit,presetId:22,presetSubtype:4},{presetClass:i.Ab.exit,presetId:22,presetSubtype:8},{presetClass:i.Ab.entr,presetId:14,presetSubtype:5},{presetClass:i.Ab.entr,presetId:14,presetSubtype:10},{presetClass:i.Ab.exit,presetId:14,presetSubtype:5},{presetClass:i.Ab.exit,presetId:14,presetSubtype:10},{presetClass:i.Ab.entr,presetId:9,presetSubtype:0},{presetClass:i.Ab.exit,presetId:9,presetSubtype:0},{presetClass:i.Ab.entr,presetId:16,presetSubtype:26},{presetClass:i.Ab.entr,presetId:16,presetSubtype:42},{presetClass:i.Ab.entr,presetId:16,presetSubtype:21},{presetClass:i.Ab.entr,presetId:16,presetSubtype:37},{presetClass:i.Ab.exit,presetId:16,presetSubtype:26},{presetClass:i.Ab.exit,presetId:16,presetSubtype:42},{presetClass:i.Ab.exit,presetId:16,presetSubtype:21},{presetClass:i.Ab.exit,presetId:16,presetSubtype:37},{presetClass:i.Ab.entr,presetId:18,presetSubtype:3},{presetClass:i.Ab.entr,presetId:18,presetSubtype:6},{presetClass:i.Ab.entr,presetId:18,presetSubtype:9},{presetClass:i.Ab.entr,presetId:18,presetSubtype:12},{presetClass:i.Ab.exit,presetId:18,presetSubtype:3},{presetClass:i.Ab.exit,presetId:18,presetSubtype:6},{presetClass:i.Ab.exit,presetId:18,presetSubtype:9},{presetClass:i.Ab.exit,presetId:18,presetSubtype:12},{presetClass:i.Ab.entr,presetId:4,presetSubtype:16},{presetClass:i.Ab.entr,presetId:4,presetSubtype:32},{presetClass:i.Ab.exit,presetId:4,presetSubtype:16},{presetClass:i.Ab.exit,presetId:4,presetSubtype:32},{presetClass:i.Ab.entr,presetId:6,presetSubtype:16},{presetClass:i.Ab.entr,presetId:6,presetSubtype:32},{presetClass:i.Ab.exit,presetId:6,presetSubtype:16},{presetClass:i.Ab.exit,presetId:6,presetSubtype:32},{presetClass:i.Ab.entr,presetId:8,presetSubtype:16},{presetClass:i.Ab.entr,presetId:8,presetSubtype:32},{presetClass:i.Ab.exit,presetId:8,presetSubtype:16},{presetClass:i.Ab.exit,presetId:8,presetSubtype:32},{presetClass:i.Ab.entr,presetId:13,presetSubtype:16},{presetClass:i.Ab.entr,presetId:13,presetSubtype:32},{presetClass:i.Ab.exit,presetId:13,presetSubtype:16},{presetClass:i.Ab.exit,presetId:13,presetSubtype:32},{presetClass:i.Ab.entr,presetId:20,presetSubtype:0},{presetClass:i.Ab.exit,presetId:20,presetSubtype:0},{presetClass:i.Ab.entr,presetId:21,presetSubtype:1},{presetClass:i.Ab.exit,presetId:21,presetSubtype:1},{presetClass:i.Ab.entr,presetId:21,presetSubtype:2},{presetClass:i.Ab.exit,presetId:21,presetSubtype:2},{presetClass:i.Ab.entr,presetId:21,presetSubtype:3},{presetClass:i.Ab.exit,presetId:21,presetSubtype:3},{presetClass:i.Ab.entr,presetId:21,presetSubtype:4},{presetClass:i.Ab.exit,presetId:21,presetSubtype:4},{presetClass:i.Ab.entr,presetId:21,presetSubtype:8},{presetClass:i.Ab.exit,presetId:21,presetSubtype:8},{presetClass:i.Ab.entr,presetId:26,presetSubtype:0},{presetClass:i.Ab.exit,presetId:26,presetSubtype:0},{presetClass:i.Ab.entr,presetId:15,presetSubtype:0},{presetClass:i.Ab.exit,presetId:15,presetSubtype:0}],M={cMediaNode:{cTn:{display:!1,fill:3,id:"00006a",stCondLst:{cond:[{delay:"STTLTimeIndefinite_indefinite"}]}},tgtEl:{spTgt:{spid:"000064"}},vol:8e4}},B={cMediaNode:{cTn:{stCondLst:{cond:[{delay:"STTLTimeIndefinite_indefinite"}]},endCondLst:{cond:[{tgtEl:{sldTgt:!0},evt:11,delay:"0"}]},id:"000064",fill:3,display:!1},tgtEl:{spTgt:{spid:"00005e"}},vol:8e4}},N="1";var F;!function(e){e.FILL_COLOR="fillcolor",e.FONT_COLOR="style.color",e.LINE_COLOR="stroke.color",e.FILL_TYPE="fill.type",e.FILL_ON="fill.on",e.FONT_SIZE="style.fontSize",e.FONT_WEIGHT="style.fontWeight"}(F||(F={}));const U=["fill_color","font_color","line_color","brush_color","complementary_color","complementary_color2","contrasting_color","darken","desaturate","lighten","object_color","color_pulse","grow_with_color"]},"969172f78b":function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var i=r("1f69014a3c"),n=r("d7c625d1f2"),o=r("711a53c9fc"),a=r("cf3340a08c"),s=r("36e02f5174"),l=r("2ba82388a5"),c=r("285f8ccc4f"),d=r("b41b5d48f6"),u=r("5d6df242e3"),p=r("7c46f42788"),h=r("2e46ca67a0"),m=r("420d598ff9"),f=r("ea786cec83"),g=r("262843d1f7"),b=r("3e57ea86bc"),v=r("5150a29f68"),y=r("23b30ccff5"),S=r("76f1d59f9d");class x extends S.a{deleteShapes(e){this.guard((t=>d.a.forEach(e,(e=>d.a.shape.should.existInPage(t,e.id,this.model.id))))),this.transaction((()=>{var t;null===(t=this.model.store.spTree)||void 0===t||t.api.deleteShapes(e)}))}convertSmartArtToGroup(e){this.transaction((()=>{const t=this.model.store.getShapeTree(),r=y.a.convertSmartArtToIGroupShapeData(null==e?void 0:e.getCloneData()),i=this.addShapes([r]);this.request([new b.a({pageId:this.model.id,groupId:i[0].id,parentId:t.id})]),this.deleteShapes([e])}))}group(e){this.guard((t=>d.a.forEach(e,(e=>d.a.every(d.a.shape.is.childOfShapeTreeRoot(t,e.id,this.model.id),d.a.shape.is.notTypeOf(t,e.id,p.a.GraphicalObjectFrameTable)))))),this.transaction((()=>{const t=this.model.context.getPresentation().getIDGenerator().next(),r=this.model.store.getShapeTree(),i=new Set(e.map((e=>e.id)));if(i.size<=1)return;const{shapeList:n}=r;let a=n.length-1;for(;a>=0&&!i.has(n[a].id);)a-=1;const s=[];for(let e=a;e>=0;e--)if(i.has(n[e].id)){const t=n[e].id;e!==a&&this.request([new v.a({pageId:this.model.id,shapeId:t,srcParentId:r.id,destParentId:r.id,srcIndex:e,destIndex:a,opType:o.d.Back,destShapeId:""})],!0),s.push(t),a-=1}s.reverse(),a+=1,e.forEach((e=>{var t;return null===(t=this.model.timing)||void 0===t?void 0:t.api.removeAnimationsByShapeId(e.id)})),this.transaction((()=>{this.request([new u.a({pageId:this.model.id,groupShapeId:t,shapeIds:s,isSmartArt:!1,parentId:r.id,index:a})]),this.request([new b.a({pageId:this.model.id,groupId:t,parentId:r.id})])}))}))}ungroup(e){this.guard((t=>d.a.shape.is.childOfShapeTreeRoot(t,e.id,this.model.id))),e.api.ungroup()}reorderShapes(e,t){return this.model.store.getShapeTree().api.reorderShapes(e,t)}moveShapes(e,t){return this.model.store.getShapeTree().api.moveShapes(e,t)}addShapes(e){const t=Object(c.a)(e);for(const e of t)this.normalizeShapeData(e),this.modifyPlaceholderIndex(e);const r=Object(h.a)(t,this.model.context.getPresentation().getIDGenerator()),i={presentation:this.model.parent.store.data,page:this.model.store.data,idFactory:e=>{var t;return null!==(t=r.get(e))&&void 0!==t?t:e}},n=this.model.shapeList.length;return this.forEachInTransaction(t,((e,t)=>{const r=Object(s.a)(e,i,this.model.store.getShapeTree().id,this.model.shapeList.length+t);this.request(Object(m.a)(r))})),this.model.shapeList.slice(n)}updateName(e){this.transaction((()=>{this.request([new f.b({pageId:this.model.id,pageType:p.b.toSTPageType(this.model.type),pageProperties:{name:e}})])}))}updateProps(e){const t=p.b.toSTPageType(this.model.type);this.transaction((()=>{this.request([new f.b(Object(i.a)({pageId:this.model.id,pageType:t},this.getMutationDeltaFromPageData(t,e)))])}))}updateTransition(e){const t=e?Object(l.c)({transition:Object(c.a)(this.model.store.data.transition)},{transition:e}):{transition:e};this.updateProps(t)}createPlaceholderIndex(){const e=this.model.placeholders.map((e=>{var t,r;return null!==(r=null===(t=e.getOwnedData().nvPr.ph)||void 0===t?void 0:t.idx)&&void 0!==r?r:0}));return Math.max(...e,0)+1}getMutationDeltaFromPageData(e,t){switch(e){case o.Q.slide:return f.a.fromSlideDataDelta(t);case o.Q.slideLayout:return f.a.fromLayoutDataDelta(t);case o.Q.slideMaster:return f.a.fromMasterDataDelta(t);default:return{}}}normalizeShapeData(e){const t=e;t.id||(t.id=g.d.next()),t.nvPr||(t.nvPr={}),t.spPr||(t.spPr={})}modifyPlaceholderIndex(e){if(e.type===p.a.GroupShape)return;const t=e.nvPr.ph;if(null==t?void 0:t.idx)for(const e of this.model.placeholders){var r;if(t.idx===(null===(r=e.getOwnedData().nvPr.ph)||void 0===r?void 0:r.idx))return void(t.idx=this.createPlaceholderIndex())}}}Object(n.__decorate)([Object(a.a)()],x.prototype,"deleteShapes",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"convertSmartArtToGroup",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"group",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"ungroup",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"reorderShapes",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"moveShapes",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"addShapes",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"updateName",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"updateProps",null),Object(n.__decorate)([Object(a.a)()],x.prototype,"updateTransition",null)},"9dbd7f12a7":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s}));r("b1e2246d82"),r("8ee19818c4"),r("342844cefa"),r("6e20b6a7d8"),r("759492dad9"),r("405b4a5e2b");var i=r("7c46f42788"),n=function e(t){var r={type:"object",properties:{}};return t.title&&(r.properties.title={type:"string",title:"title",default:"",canOmit:!1}),t.content&&(r.properties.title={type:"string",title:"content",default:"",canOmit:!1}),t.image&&(r.properties.title={type:"string",title:"image",default:"",canOmit:!1}),t.list&&(r.properties.list={type:"array",title:"list",maxLength:t.list.length,minLength:t.list.length,items:e(t.list[0])}),r},o=function(e){var t=e.nvPr.descr;try{return t?JSON.parse(t):null}catch(e){return null}},a=function(e,t,r,n){var o;if(null!=t&&t.isTemplate){var a=t.type;if("list"===a){if(e.type!==i.a.GroupShape)return;n[a]=[];var l={type:"object",properties:{}};return r.properties.list={type:"array",title:e.nvPr.name,default:"",maxLength:e.shapeList.length,minLength:t.minItemsCount<0?e.shapeList.length:t.minItemsCount,items:l,"x-decorator":"FormItem","x-component":"ArrayCards"},void e.shapeList.forEach((function(e){var t={};n[a].push(t),s([e],l,t)}))}n[a]=e.id,r.properties[a]={type:"string",title:e.nvPr.name,default:"",canOmit:null!==(o=t.canOmit)&&void 0!==o&&o,"x-decorator":"FormItem","x-component":"Input"}}},s=function e(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:"object",properties:{}},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=0;s<t.length;s++){var l=t[s],c=o(l);null!=c&&c.isTemplate?a(l,c,r,n):l.type===i.a.GroupShape&&e(l.shapeList,r,n)}return{schema:r,idMap:n}}},"9f56a12fef":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("cf3340a08c"),s=r("3f9e0540b8");class l extends s.a{updateProps({spPr:e,nvPr:t,style:r}){return super.updateProps({spPr:e,nvPr:t&&Object(n.a)(Object(i.a)({},super.getCommonNonVisualPropsDelta(t)),{connector:{stCxn:t.stCxn,endCxn:t.endCxn}}),style:r})}}Object(o.__decorate)([Object(a.a)()],l.prototype,"updateProps",null)},a8241196a7:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o}));const i=new Map([[".jpg","image/jpeg"],[".jpeg","image/jpeg"],[".png","image/png"],[".gif","image/gif"],[".bmp","image/bmp"],[".tif","image/tiff"],[".tiff","image/tiff"],[".ico","image/x-icon"],[".emf","image/emf"],[".wmf","image/wmf"],[".svg","image/svg+xml"],[".webp","image/webp"],[".wdp","image/vnd.ms-photo"]]),n=new Map([[".mp3","audio/mpeg"],[".wav","audio/wav"],[".wma","audio/x-ms-wma"]]),o=new Map([[".mp4","video/mp4"],[".mov","video/quicktime"],[".avi","video/x-msvideo"],[".wmv","video/x-ms-wmv"],[".mkv","video/x-matroska"],[".flv","video/x-flv"],[".mpeg","video/mpeg"],[".mpg","video/mpeg"],[".3gp","video/3gpp"]])},a880efe597:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("711a53c9fc"),s=r("33fdb9613c"),l=r("f78be71a2b"),c=r("285f8ccc4f"),d=r("cf3340a08c"),u=r("7c46f42788"),p=r("ea786cec83"),h=r("969172f78b");class m extends h.a{unlinkMatchedShapesOfPlaceholder(e){this.transaction((()=>{this.model.context.getPresentation().slideList.forEach((t=>{var r;if(this.model.id!==(null===(r=t.getLayout())||void 0===r?void 0:r.id))return;const i=t.placeholders.find((t=>this.model.store.isMatchedPlaceholder(t.props.nvPr.ph,e.props.nvPr.ph)));if(i){var n,o;i.api.updateProps({nvPr:{ph:{idx:s.b}},spPr:{prstGeom:{prst:null===(n=e.props.spPr.prstGeom)||void 0===n?void 0:n.prst}}});const t=null===(o=e.getInheritedData().spPr)||void 0===o?void 0:o.xfrm;t&&i.api.updateTransform(Object(c.a)(t))}}))}))}linkMatchedShapesOfPlaceholder(e){this.transaction((()=>{this.model.context.getPresentation().slideList.forEach((t=>{var r;if(this.model.id!==(null===(r=t.getLayout())||void 0===r?void 0:r.id))return;const i=t.placeholders.find((t=>this.canLinkPlaceholders(t,e)));var n;i&&i.api.updateProps({nvPr:{ph:{idx:null===(n=e.props.nvPr.ph)||void 0===n?void 0:n.idx}}})}))}))}addPlaceholder(e,t=!1){const r=this.createPlaceholderIndex(),o=e===l.a.Content?void 0:l.d[e];return this.addShapes([Object(l.e)(Object(n.a)(Object(i.a)({},l.b[e]),{isVert:t,placeholderIndex:r}))]),this.model.store.findPlaceholderShape({idx:r,type:o})}addUniquePlaceholder(e){var t;const r=l.d[e],o=e===l.a.Title?void 0:this.createPlaceholderIndex();return!(null===(t=this.model.getMaster())||void 0===t?void 0:t.getPlaceholderShape({type:r}))?this.addShapes([Object(l.f)(Object(n.a)(Object(i.a)({},l.c[e]),{placeholderIndex:o}))]):this.addShapes([Object(l.e)(Object(n.a)(Object(i.a)({},l.b[e]),{placeholderIndex:o}))]),this.model.store.findPlaceholderShape({idx:o,type:r})}updateShowMasterSp(e){this.updateProps({showMasterSp:e})}updateHeaderFooter(e){this.updateProps({hf:e})}updateSlideGuideList(e,t=!1){this.transaction((()=>{const r=new p.b({pageId:this.model.id,pageType:u.b.toSTPageType(this.model.type),layoutProperties:{slideGuideList:{guide:e.map(((e,t)=>Object(n.a)(Object(i.a)({},e),{id:`${t+1}`})))}}});r.invertible=t,this.request([r])}))}canLinkPlaceholders(e,t){var r,i,n;const{idx:o}=null!==(n=e.props.nvPr.ph)&&void 0!==n?n:{};var l;const c=null!==(l=null===(r=e.props.nvPr.ph)||void 0===r?void 0:r.type)&&void 0!==l?l:a.U.PBDEFAULT;var d;const u=null!==(d=null===(i=t.props.nvPr.ph)||void 0===i?void 0:i.type)&&void 0!==d?d:a.U.PBDEFAULT,p=[a.U.title,a.U.ctrTitle],h=[a.U.dt,a.U.ftr,a.U.sldNum],m=o===s.b;return p.includes(c)?p.includes(u)&&m:!!h.includes(c)&&(c===u&&m)}}Object(o.__decorate)([Object(d.a)()],m.prototype,"unlinkMatchedShapesOfPlaceholder",null),Object(o.__decorate)([Object(d.a)()],m.prototype,"linkMatchedShapesOfPlaceholder",null),Object(o.__decorate)([Object(d.a)()],m.prototype,"addPlaceholder",null),Object(o.__decorate)([Object(d.a)()],m.prototype,"addUniquePlaceholder",null),Object(o.__decorate)([Object(d.a)()],m.prototype,"updateShowMasterSp",null),Object(o.__decorate)([Object(d.a)()],m.prototype,"updateHeaderFooter",null),Object(o.__decorate)([Object(d.a)()],m.prototype,"updateSlideGuideList",null)},af753b49bd:function(e,t,r){"use strict";var i,n,o,a;r.d(t,"d",(function(){return i})),r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),function(e){e.cover="cover",e.catalogue="catalogue",e.session="session",e.page="page",e.ending="ending",e.component="component"}(i||(i={})),function(e){e[e.cover=0]="cover",e[e.catalogue=1]="catalogue",e[e.session=2]="session",e[e.page=3]="page",e[e.ending=4]="ending"}(n||(n={})),function(e){e.title="title",e.content="content",e.list="list",e.image="image"}(o||(o={})),function(e){e.Page="page",e.List="list",e.None="none"}(a||(a={}))},b09773c80f:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));class i{getPresentation(){if(!this.presentation)throw new Error("getPresentation from BaseContext without setPresentation");return this.presentation}setPresentation(e){this.presentation=e}setTarget(e){this.target=e}getTarget(){return this.target}}},b8d5bd34e3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlobConverter=t.BlobEncoding=void 0;var i,n=r("d7c625d1f2");!function(e){e[e.ArrayBuffer=0]="ArrayBuffer",e[e.Base64=1]="Base64",e[e.DataURL=2]="DataURL",e[e.ObjectURL=3]="ObjectURL",e[e.Blob=4]="Blob"}(i=t.BlobEncoding||(t.BlobEncoding={}));var o=function(){function e(){}return e.convertBlob=function(t,r){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return r===i.Blob?[2,t]:r===i.ObjectURL?[2,URL.createObjectURL(t)]:r===i.ArrayBuffer?[2,this.convertBlobToArrayBuffer(t)]:[4,e.convertBlobToDataURL(t)];case 1:return o=n.sent(),r===i.DataURL?[2,o]:[2,o.split(",")[1]]}}))}))},e.convertBlobToDataURL=function(e){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(t){return[2,new Promise((function(t,r){var i=new FileReader;i.onloadend=function(){if(!i.result)return r(new Error("unable to transform blob to data url"));t(i.result)},i.onabort=r,i.onerror=r,i.readAsDataURL(e)}))]}))}))},e.convertBlobToArrayBuffer=function(e){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(t){return[2,new Promise((function(t,r){var i=new FileReader;i.onloadend=function(){if(!i.result)return r(new Error("unable to transform blob to array buffer"));t(i.result)},i.onabort=r,i.onerror=r,i.readAsArrayBuffer(e)}))]}))}))},e}();t.BlobConverter=o,t.default=o},bc3b705d45:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={version:6,autoRun:!0,ignoreDefaultSources:!0,cdnSources:r("8bed1d6e25").cdnSources,duration:6e4};t.default=i},c7530f2183:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.network=void 0;var n=r("03f2f6a0c1"),o=i(r("1e80909dc5")).default.create({autoRun:!1});t.network=n.createSingleton(o)},c94abe4d15:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));var i=r("efa037e17a"),n=r("7df2e5fb1e"),o=r("27b8f08537");class a{static fromBufferOrBase64(e){const t=o.a.codec.decode(e,i.a.TransformRequest);return new a(t)}toBase64String(){const e=o.a.codec.encode(this.data,i.a.TransformRequest);return n.a.fromUint8Array(e)}getTransformRequestData(){return this.data}constructor(e){this.data=e}}class s{static fromBufferOrBase64(e){const t=o.a.codec.decode(e,i.a.TransformResponse);return new s(t)}toBase64String(){const e=o.a.codec.encode(this.data,i.a.TransformResponse);return n.a.fromUint8Array(e)}getTransformResponseData(){return this.data}constructor(e){this.data=e}}},cac2902cf4:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var i,n=r("d7c625d1f2"),o=r("5d64cf765d"),a=r("7b66f04f1e"),s=r("4e7e6ffadc");!function(e){e.pending="[PENDING]",e.success="[SUCCESS]",e.failure="[FAILURE]",e.slow="[SLOW]"}(i||(i={}));var l=Symbol("begin"),c=function(e,t){return e+"/"+t},d=function(e,t){return"["+e+"."+t+"]"},u=function(e){var t=Array.isArray(e)?e:Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return t+"="+e[t]}));return t.length?Object(n.__spreadArray)(["args:"],Object(n.__read)(t)):[]},p=function(e){return"[-* "+e+"]"},h=function(){function e(e){var t=this,r=void 0===e?{logger:console,verbose:!1,disabled:!1,prefix:""}:e,a=r.logger,s=void 0===a?console:a,c=r.disabled,p=void 0!==c&&c,h=r.verbose,m=void 0!==h&&h,f=r.prefix,g=void 0===f?"":f;this.name="LoggerPlugin",this.formatQueryConditionsExp=function(e){if(e.type===o.f.AND||e.type===o.f.OR){if(!e.exps.length)return;return e.exps.map(t.formatQueryConditionsExp).filter(Boolean).map((function(t){return e.type===o.f.OR&&e.exps.length>1?"("+t+")":t})).join(e.type===o.f.AND?" AND ":" OR ")}return e.type===o.f.FILTER?t.formatPredicate(e.path,e.predicate):e.type},this.formatPredicate=function(e,t){return Object.keys(t).filter((function(e){return void 0!==t[e]})).map((function(r){return e+" "+r+" "+JSON.stringify(t[r])})).join(" AND ")},this.logMethodBegin=function(e,r,o,a){var s;e.timings.set(l,new Date),(s=t.logger).info.apply(s,Object(n.__spreadArray)([t.prefix,i.pending,d(r,o)],Object(n.__read)(u(a))))},this.logMethodEnd=function(e,r,o,a,s){var c,p,h,m,f=e.timings.get(l)||new Date,g=d(r,o),b=Date.now()-f.getTime(),v="cost="+b+"ms",y=b>=500;s.error?(c=t.logger).error.apply(c,Object(n.__spreadArray)([t.prefix,i.failure,d(r,o),v,null===(h=s.error)||void 0===h?void 0:h.message,null===(m=s.error)||void 0===m?void 0:m.stack],Object(n.__read)(u(a)))):(p=t.logger)[y?"warn":"info"].apply(p,Object(n.__spreadArray)(Object(n.__spreadArray)(Object(n.__spreadArray)(Object(n.__spreadArray)([t.prefix,i.success],Object(n.__read)(y?[i.slow]:[])),[g,v]),Object(n.__read)(u(a))),["result:",s.data]))},this.logger=s,this.disabled=p,this.verbose=m,this.prefix=g}return e.prototype.register=function(e){this.disabled||(this.prefix=this.prefix||"["+e.name+"]",this.hookPrimaryKeyQueries(e),this.hookConditionQueries(e),this.hookDataManipulationQueries(e),this.hookEvents(e),this.hookMigration(e),this.verbose&&this.hookEngine(e))},e.prototype.dispose=function(e){throw new a.b({storage:e})},e.prototype.hookMigration=function(e){var t=this,r=function(e,r,i){void 0===i&&(i="migration"),e.before((function(e){t.logMethodBegin(e,i,r,e.args)})).after((function(e){t.logMethodEnd(e,i,r,e.args,{data:e.return,error:e.error})}))};r(e.aspects.migration.buildMigration,"buildMigration"),r(e.aspects.migration.executeDataMigration,"executeDataMigration"),r(e.aspects.migration.executeSchemaMigration,"executeSchemaMigration"),r(e.aspects.migration.updateMigrationChangeInfo,"updateMigrationChangeInfo"),r(e.aspects.migration.prepareAutoUpgradeHandler,"prepareAutoUpgradeHandler"),r(e.aspects.migration.log,"innerLog"),r(e.aspects.migration.actionExecutor.executeSchemaAction,"executeSchemaAction"),r(e.aspects.migration.actionExecutor.executeDataAction,"executeDataAction")},e.prototype.hookEngine=function(e){var t=this,r=function(e,r,i){e.before((function(e){t.logMethodBegin(e,r,i,e.args)})).after((function(e){t.logMethodEnd(e,r,i,e.args,{data:e.return,error:e.error})}))},i=e.aspects.engine;r(i.openDB,"engine","openDB"),r(i.deleteDB,"engine","deleteDB"),this.hookEngineDatabase(i.database,r),this.hookEngineTable(i.table,r),this.hookEngineTransaction(i.transaction,r),this.hookEngineIndex(i.index,r),this.hookEngineCursor(i.cursor,r)},e.prototype.hookEngineDatabase=function(e,t){var r=c("engine","database");t(e.close,r,"close"),t(e.table,r,"table"),t(e.transaction,r,"transaction"),t(e.createTable,r,"createTable"),t(e.deleteTable,r,"deleteTable")},e.prototype.hookEngineTransaction=function(e,t){var r=c("engine","transaction");t(e.commit,r,"commit"),t(e.rollback,r,"rollback"),t(e.table,r,"table")},e.prototype.hookEngineIndex=function(e,t){var r=c("engine","index");t(e.get,r,"get"),t(e.getAll,r,"getAll"),t(e.getAllKeys,r,"getAllKeys"),t(e.openCursor,r,"openCursor")},e.prototype.hookEngineCursor=function(e,t){var r=c("engine","cursor");t(e.delete,r,"delete"),t(e.update,r,"update"),t(e.next,r,"next"),t(e.value,r,"value")},e.prototype.hookEngineTable=function(e,t){var r=c("engine","table");t(e.clear,r,"clear"),t(e.get,r,"get"),t(e.delete,r,"delete"),t(e.getAll,r,"getAll"),t(e.getAllKeys,r,"getAllKeys"),t(e.index,r,"index"),t(e.insert,r,"insert"),t(e.upsert,r,"upsert"),t(e.createIndex,r,"createIndex"),t(e.deleteIndex,r,"deleteIndex"),t(e.openCursor,r,"openCursor"),t(e.query,r,"query"),t(e.bulkDelete,r,"bulkDelete"),t(e.bulkUpsert,r,"bulkUpsert")},e.prototype.hookPrimaryKeyQueries=function(e){var t=this,r=function(e,r){e.before((function(e){t.logMethodBegin(e,e.this.name,r,{key:e.args[0]})})).after((function(e){t.logMethodEnd(e,e.this.name,r,{key:e.args[0]},{data:e.return,error:e.error})}))};r(e.aspects.collection.get,"get"),r(e.aspects.collection.has,"has"),r(e.aspects.collection.delete,"delete")},e.prototype.hookConditionQueries=function(e){var t=this,r=function(e,r){e.before((function(e){t.logMethodBegin(e,e.this.name,r,t.formatQueryConditions(e.this.conditions()))})).after((function(e){t.logMethodEnd(e,e.this.name,r,t.formatQueryConditions(e.this.conditions()),{data:e.return,error:e.error})}))};r(e.aspects.collection.count,"count"),r(e.aspects.collection.entries,"entries"),r(e.aspects.collection.keys,"keys"),r(e.aspects.collection.values,"values"),r(e.aspects.collection.first,"first"),r(e.aspects.collection.last,"last"),r(e.aspects.collection.clear,"clear"),r(e.aspects.collection.update,"update")},e.prototype.hookDataManipulationQueries=function(e){var t=this,r=function(e,r){e.before((function(e){t.logMethodBegin(e,e.this.name,r,e.args)})).after((function(e){t.logMethodEnd(e,e.this.name,r,e.args,{data:e.return,error:e.error})}))};r(e.aspects.collection.insert,"insert"),r(e.aspects.collection.upsert,"upsert"),r(e.aspects.collection.bulkInsert,"bulkInsert"),r(e.aspects.collection.bulkUpsert,"bulkUpsert")},e.prototype.hookEvents=function(e){var t,r=this,i=(t=Date.now(),function(){var e=Date.now(),r="+"+(e-t)+"ms";return t=e,r});e.events.onBootstrapStart((function(){r.logger.info(r.prefix,p(s.StorageEvent.BootstrapStart),i())})),e.events.onBootstrapEnd((function(){r.logger.info(r.prefix,p(s.StorageEvent.BootstrapEnd),i())})),e.events.onSchemaMigrationStart((function(){r.logger.info(r.prefix,p(s.StorageEvent.SchemaMigrationStart),i())})),e.events.onSchemaMigrationEnd((function(){r.logger.info(r.prefix,p(s.StorageEvent.SchemaMigrationEnd),i())})),e.events.onRegisterModel((function(e){var t,o=e.schema;return(t=r.logger).info.apply(t,Object(n.__spreadArray)(Object(n.__spreadArray)([r.prefix,p(s.StorageEvent.RegisterModel)],Object(n.__read)(u({schema:JSON.stringify(o)}))),[i()]))})),e.events.onRegisterPlugin((function(e){var t,o=e.name;return(t=r.logger).info.apply(t,Object(n.__spreadArray)(Object(n.__spreadArray)([r.prefix,p(s.StorageEvent.RegisterPlugin)],Object(n.__read)(u({name:o}))),[i()]))})),e.events.onReady((function(e){var t,o=e.version,a=e.tableNames;return(t=r.logger).info.apply(t,Object(n.__spreadArray)(Object(n.__spreadArray)([r.prefix,p(s.StorageEvent.Ready)],Object(n.__read)(u({version:o,collections:Array.from(a)}))),[i()]))}))},e.prototype.formatQueryConditions=function(e){var t=e.offset,r=e.limit,i=e.order,n=e.exp;return{OFFSET:t||void 0,LIMIT:r,ORDER_BY:i&&"("+i.path+" "+i.type+")",WHERE:"("+this.formatQueryConditionsExp(n)+")"}},e}(),m=h},cc55475c1f:function(e,t,r){"use strict";var i,n,o=r("d7c625d1f2");!function(e){e.CreateCollection="create-collection",e.DropCollection="drop-collection",e.CreateIndex="create-index",e.DropIndex="drop-index"}(i||(i={})),function(e){e.MoveProperty="move-property",e.DropProperty="drop-property",e.ReplaceProperty="replace-property",e.ClearData="clear-data",e.ReplaceData="replace-data"}(n||(n={}));var a,s={name:"alloy_db_schema_table",indices:[],key:{path:"name"},properties:[]};!function(e){e.Equals="=",e.NotEquals="!=",e.GreaterThan=">",e.GreaterOrEqualThan=">=",e.LessThan="<",e.LessOrEqualThan="<=",e.In="in",e.NotIn="nin"}(a||(a={}));var l,c,d,u,p;function h(e){return"number"==typeof e&&!Number.isNaN(e)||"string"==typeof e||e instanceof Date&&!Number.isNaN(e.getTime())||e instanceof ArrayBuffer||ArrayBuffer.isView(e)||Array.isArray(e)&&e.every(h)}!function(e){e.OR="or",e.AND="and",e.FILTER="filter",e.NONE="none",e.ALL="all"}(l||(l={})),function(e){e.ENTRIES="entries",e.VALUES="values",e.KEYS="keys",e.COUNT="count"}(c||(c={})),function(e){e.DESCENDING="desc",e.ASCENDING="asc"}(d||(d={})),function(e){e.AutoIncrement="auto-increment"}(u||(u={})),function(e){e.Equals="=",e.GreaterThan=">",e.GreaterOrEqualThan=">=",e.LessThan="<",e.LessOrEqualThan="<="}(p||(p={}));var m,f,g,b;!function(){function e(){}e.collectionDiff=function(e,t){if(e.name!==t.name)throw new Error("can not compare collection schema with different name");var r={collection:e.name},i=t.indices.filter((function(t){return!e.indices.some((function(e){return e.name===t.name}))})),n=e.indices.filter((function(e){return!t.indices.some((function(t){return t.name===e.name}))}));return(i.length||n.length)&&(r.index={added:Object(o.__spreadArray)([],Object(o.__read)(i)),deleted:Object(o.__spreadArray)([],Object(o.__read)(n))}),r},e.databaseDiff=function(e,t){var r,i,n=this.getCompareMap(e,t),a={added:[],deleted:[],different:[]};try{for(var s=Object(o.__values)(n.values()),l=s.next();!l.done;l=s.next()){var c=l.value;if(!c.oldValue||c.newValue)if(c.oldValue||!c.newValue){if(c.oldValue&&c.newValue){var d=this.collectionDiff(c.oldValue,c.newValue);if(!d.index)continue;a.different.push(d)}}else a.added.push(c.newValue);else a.deleted.push(c.oldValue)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},e.getCompareMap=function(e,t){var r,i,n,a,s=new Map;try{for(var l=Object(o.__values)(t.collections),c=l.next();!c.done;c=l.next()){var d=c.value;(h=s.get(d.name)||{}).newValue=d,s.set(d.name,h)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}try{for(var u=Object(o.__values)(e.collections),p=u.next();!p.done;p=u.next()){var h;d=p.value;(h=s.get(d.name)||{}).oldValue=d,s.set(d.name,h)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}return s}}();!function(e){e.READ_ONLY="readonly",e.READ_WRITE="readwrite",e.VERSION_CHANGE="versionchange"}(m||(m={})),function(e){e.INIT="init",e.GET="get",e.GET_ALL="getAll",e.DELETE="delete",e.INSERT="set",e.UPDATE="update",e.UPDATE_MUTIL_TABLE_DATA="updateMultiTableData",e.BEGIN_TRANSACTION="beginTransaction",e.COMMIT_TRANSACTION="commitTransaction",e.ROLLBACK_TRANSACTION="rollbackTransaction"}(f||(f={})),function(e){e[e.IN=0]="IN",e[e.LOWER_BOUND=1]="LOWER_BOUND",e[e.UPPER_BOUND=2]="UPPER_BOUND",e[e.BOUND=3]="BOUND",e[e.ONLY=4]="ONLY",e[e.NOT_IN=5]="NOT_IN"}(g||(g={})),function(e){e[e.INCREASE=0]="INCREASE",e[e.DECREASE=1]="DECREASE",e[e.INCREASE_BY_TEXT=2]="INCREASE_BY_TEXT",e[e.DECREASE_BY_TEXT=3]="DECREASE_BY_TEXT"}(b||(b={}));var v=r("1202d342f1"),y=function(){function e(){}return e.send=function(t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(o.__generator)(this,(function(n){return r=new Promise((function(e){var r;(null===(r=null===window||void 0===window?void 0:window.tdocs)||void 0===r?void 0:r.clientDatabaseRequest)?window.tdocs.clientDatabaseRequest(t).then(e).catch((function(t,r){e({err_code:r,err_msg:t})})):v.a.invoke({schema:"jsapi",namespace:"docx",method:"clientDatabaseRequest",params:t,removeCallback:!0,callback:function(t){e(t)}})})),i=new Promise((function(t){setTimeout((function(){t({err_msg:"req timeout",err_code:e.timeoutErrorCode})}),e.timeout)})),[2,Promise.race([r,i])]}))}))},e.timeout=1e4,e.timeoutErrorCode="100002",e}(),S=function(){function e(){}return e.getDBKeyFromKeyPath=function(e){return"string"==typeof e?e:e.join("_")},e.normalizeUnionKeyValue=function(e){return Array.isArray(e)?JSON.stringify(e):e},e.getKeyFromValue=function(e,t){if("object"!=typeof e)return e;var r=e;if("string"==typeof t)return r[t];var i=[];return t.forEach((function(e){i.push(r[e])})),i},e.addUnionKeyIfNeed=function(t,r){if("string"==typeof r)return t;var i=Object(o.__assign)({},t),n=e.getDBKeyFromKeyPath(r),a=[];return r.forEach((function(e){return a.push(i[e])})),i[n]=e.normalizeUnionKeyValue(a),i},e.deleteUnionKeyIfNeed=function(t,r){if("string"==typeof r)return t;var i=Object(o.__assign)({},t);return i[e.getDBKeyFromKeyPath(r)]=void 0,i},e}(),x=function(){function e(e,t,r,i,n){var o;this.direction=r,this.mode=i,this.engineAspects=n,this.delete=void 0,this.update=void 0,this.cursor=0,this.engineTable=t,this.values=this.preProcessedData(e),this.isPositiveDirection()||(this.cursor=this.values.length-1),i!==m.READ_ONLY&&(this.delete=this.deleteData,this.update=this.updateData),(null===(o=this.engineAspects)||void 0===o?void 0:o.cursor)&&this.applyAspectPatch()}return e.prototype.next=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){return(e=this.cursor+(this.isPositiveDirection()?1:-1))<0||e>this.values.length-1?[2,null]:(this.cursor=e,[2,this])}))}))},e.prototype.value=function(){return this.values[this.cursor]},e.prototype[Symbol.asyncIterator]=function(){return new _(this)},e.prototype.deleteData=function(){var e=S.getKeyFromValue(this.value(),this.engineTable.keyPath);return this.engineTable.delete(e)},e.prototype.updateData=function(e){return this.engineTable.upsert(e)},e.prototype.isPositiveDirection=function(){return"next"===this.direction||"nextunique"===this.direction},e.prototype.isUniqueDirection=function(){return"nextunique"===this.direction||"prevunique"===this.direction},e.prototype.preProcessedData=function(e){return this.isUniqueDirection()?Object(o.__spreadArray)([],Object(o.__read)(new Set(e))):e},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.cursor;if(this.mode!==m.READ_ONLY){null==t||t.delete.patch(this,"delete"),null==t||t.update.patch(this,"update")}null==t||t.next.patch(this,"next"),null==t||t.value.patch(this,"value")},e}(),_=function(){function e(e){this.currentCursor=e}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.next=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return this.currentCursor?(e=this.currentCursor.value(),t=this,[4,this.currentCursor.next()]):[2,{value:void 0,done:!0}];case 1:return t.currentCursor=r.sent(),[2,{value:e,done:!1}]}}))}))},e}(),T=function(e){function t(t,r){for(var i=this,n=t,o={cause:r};o.cause&&o.cause instanceof Error;)n=t+"\n\t→ "+r,o=o.cause;return(i=e.call(this,n)||this).cause=r,i.name=i.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(i,i.constructor):i.stack=(new Error).stack,Object.setPrototypeOf(i,i.constructor.prototype),i}return Object(o.__extends)(t,e),t}(Error),O={withDefaultMessage:function(e,t){return function(r){function i(i,n){var o=r.call(this,i||t||"",n)||this;return o.name=e,Object.setPrototypeOf(o,o.constructor.prototype),o}return Object(o.__extends)(i,r),i}(T)},withMessageCreator:function(e,t){return function(r){function i(i,n){var o=r.call(this,t(i),n)||this;return o.name=e,Object.setPrototypeOf(o,o.constructor.prototype),o}return Object(o.__extends)(i,r),i}(T)}};O.withDefaultMessage("AssertionError","the asserted condition is invalid"),O.withMessageCreator("UnimplementedError",(function(e){return e?"called with arguments: "+JSON.stringify(e):"called with nothing"}));var P=O.withMessageCreator("UnSupportError Error",(function(e){return"client db does not support "+e})),C=O.withMessageCreator("openDBError",(function(e){return"open db error in database , msg: "+e})),I=O.withMessageCreator("tableNotExist",(function(e){return e+" is not exist in the database"})),w=O.withMessageCreator("indexNotExist",(function(e){return e+" is not exist in the table"})),E=O.withDefaultMessage("WhereOrUnsupportedError","multiple where clause is not supported in native engine"),j=O.withMessageCreator("DBOperationError",(function(e){return"query or write db has error, msg: "+e}));function A(e,t){var r=t.collections.filter((function(t){return t.name===e}));if(!r.length)throw new I(e);return r[0]}function L(e,t,r){if(e.err_code||e.err_msg){var i=new j("has error in "+t+" opt, code: "+e.err_code+" msg: "+e.err_msg);throw null==r||r(i),i}}var k,D=function(){function e(){this.conditions=[],this.limitCount=Number.MAX_VALUE,this.offsetCount=0,this.orders=[]}return e.prototype.addKeyQueryCondition=function(e,t){var r=this;if("string"==typeof e)return this.addCondition(e,t);if(t instanceof Array)return this.addCondition(S.getDBKeyFromKeyPath(e),S.normalizeUnionKeyValue(t));if(!(t instanceof IDBKeyRange))throw new Error("unsupported key: "+t);var i=t.upper,n=t.upperOpen,o=t.lower,a=t.lowerOpen;return e.forEach((function(t,s){var l=null==o?void 0:o[s],c=null==i?void 0:i[s];if(void 0===l&&void 0===c)throw new Error("key range query param has error, keyPath: "+e+" lower: "+o+", upper: "+i);void 0!==l&&void 0!==c?r.addCondition(t,IDBKeyRange.bound(l,c,a,n)):void 0!==l?r.addCondition(t,IDBKeyRange.lowerBound(l,a)):r.addCondition(t,IDBKeyRange.upperBound(c,n))})),this},e.prototype.addCondition=function(e,t,r){void 0===r&&(r=g.ONLY);var i,n=r;return t instanceof IDBKeyRange?void 0!==t.lower&&void 0!==t.upper?(n=g.BOUND,i={lower:t.lower,upper:t.upper,lowerOpen:t.lowerOpen,upperOpen:t.upperOpen}):void 0!==t.lower?(n=g.LOWER_BOUND,i={lower:t.lower,open:t.lowerOpen}):(n=g.UPPER_BOUND,i={upper:t.upper,open:t.upperOpen}):i=t,this.conditions.push({type:n,column:e,value:i}),this},e.prototype.setLimit=function(e){return this.limitCount=e,this},e.prototype.setOffset=function(e){return this.offsetCount=e,this},e.prototype.addOrder=function(e,t){var r=b.INCREASE;t===d.DESCENDING&&(r=b.DECREASE),this.orders.push({key:e,type:r})},e.prototype.build=function(){return{_conditions:this.conditions,_limitCount:this.limitCount,_offsetCount:this.offsetCount,_orders:this.orders}},e}(),R=function(){function e(e,t,r,i,n){var o,a=this;this.dbName=e,this.table=t,this.mode=i,this.engineAspects=n,this.name=r.name,this.keyPath=r.path,this.unique=null!==(o=r.unique)&&void 0!==o&&o,this.transaction=t.transaction,this.reqErrorObserver=function(e){var t;return null===(t=a.transaction)||void 0===t?void 0:t.notifyTransactionFail(e)},(null==n?void 0:n.index)&&this.applyAspectPatch()}return e.prototype.getAll=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,n=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return r={command:f.GET_ALL,dbName:this.dbName,tableName:this.table.tableName,where:e?(new D).addKeyQueryCondition(this.keyPath,e).setLimit(null!=t?t:Number.MAX_VALUE).build():void 0},[4,this.sendRequest(r)];case 1:return L(i=o.sent(),"getAll",this.reqErrorObserver),i.result?[2,i.result.map((function(e){return S.deleteUnionKeyIfNeed(e,n.table.keyPath)}))]:[2,[]]}}))}))},e.prototype.getAllKeys=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i=this;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getAll(null!=e?e:void 0,t)];case 1:return(r=n.sent())?[2,r.map((function(e){return S.getKeyFromValue(e,i.table.keyPath)}))]:[2,[]]}}))}))},e.prototype.get=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return t={command:f.GET,dbName:this.dbName,tableName:this.table.tableName,where:(new D).addKeyQueryCondition(this.keyPath,e).build()},[4,this.sendRequest(t)];case 1:return L(r=i.sent(),"get",this.reqErrorObserver),r.result?[2,S.deleteUnionKeyIfNeed(r.result,this.table.keyPath)]:[2,null]}}))}))},e.prototype.openCursor=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.getAll(e)];case 1:return(r=i.sent())?[2,new x(r,this.table,null!=t?t:"next",this.mode)]:[2,null]}}))}))},e.prototype.sendRequest=function(e){var t,r;(null===(t=this.transaction)||void 0===t?void 0:t.transactionID)&&(e.transaction=this.transaction.transactionID);var i=y.send(e);return null===(r=this.transaction)||void 0===r||r.addResponsePromise(i),i},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.index,r=this;null==t||t.get.patch(r,"get"),null==t||t.getAll.patch(r,"getAll"),null==t||t.getAllKeys.patch(r,"getAllKeys"),null==t||t.openCursor.patch(r,"openCursor")},e}(),M=function(){function e(e,t,r,i,n){var o,a,s,l=this;this.dbName=e,this.collectionSchema=t,this.mode=r,this.engineAspects=i,this.transaction=n,this.createIndex=void 0,this.delete=void 0,this.bulkDelete=void 0,this.clear=void 0,this.insert=void 0,this.upsert=void 0,this.deleteIndex=void 0,this.bulkUpsert=void 0,this.keyPath=null!==(a=null===(o=t.key)||void 0===o?void 0:o.path)&&void 0!==a?a:[],this.autoIncrement=!!(null===(s=t.key)||void 0===s?void 0:s.generator),this.tableName=t.name,this.indexNames=t.indices.map((function(e){return S.getDBKeyFromKeyPath(e.path)})),this.initWriteFun(r),this.reqErrorObserver=function(e){var t;return null===(t=l.transaction)||void 0===t?void 0:t.notifyTransactionFail(e)},(null==i?void 0:i.table)&&this.applyAspectPatch()}return e.prototype.query=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,n,a=this;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return r={command:f.GET_ALL,dbName:this.dbName,tableName:this.tableName,where:this.getClientQueryCondition(e)},[4,this.sendRequest(r)];case 1:return L(i=s.sent(),"query",this.reqErrorObserver),i.result&&i.result.length?(n=i.result.map((function(e){return[S.getKeyFromValue(e,a.keyPath),S.deleteUnionKeyIfNeed(e,a.keyPath)]})),t===c.COUNT?[2,n.length]:t===c.KEYS?[2,n.map((function(e){return Object(o.__read)(e,1)[0]}))]:t===c.VALUES?[2,n.map((function(e){return Object(o.__read)(e,2)[1]}))]:[2,n]):[2,[]]}}))}))},e.prototype.supports=function(){return!0},e.prototype.index=function(e){var t=this.collectionSchema.indices.filter((function(t){return t.name===e}));if(!t.length)throw new w(e);return new R(this.dbName,this,t[0],this.mode,this.engineAspects)},e.prototype.getAll=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,n=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return r={command:f.GET_ALL,dbName:this.dbName,tableName:this.tableName,where:e?(new D).addKeyQueryCondition(this.keyPath,e).setLimit(null!=t?t:Number.MAX_VALUE).build():void 0},[4,this.sendRequest(r)];case 1:return L(i=o.sent(),"getAll",this.reqErrorObserver),i.result&&i.result.length?[2,i.result.map((function(e){return S.deleteUnionKeyIfNeed(e,n.keyPath)}))]:[2,[]]}}))}))},e.prototype.getAllKeys=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i=this;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getAll(null!=e?e:void 0,t)];case 1:return(r=n.sent())?[2,r.map((function(e){return S.getKeyFromValue(e,i.keyPath)}))]:[2,[]]}}))}))},e.prototype.get=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return t={command:f.GET,dbName:this.dbName,tableName:this.tableName,where:(new D).addKeyQueryCondition(this.keyPath,e).build()},[4,this.sendRequest(t)];case 1:return L(r=i.sent(),"get",this.reqErrorObserver),r.result?[2,S.deleteUnionKeyIfNeed(r.result,this.keyPath)]:[2,null]}}))}))},e.prototype.openCursor=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.getAll(e)];case 1:return(r=i.sent())?[2,new x(r,this,null!=t?t:"next",this.mode,this.engineAspects)]:[2,null]}}))}))},e.prototype.initWriteFun=function(e){var t=this;e===m.VERSION_CHANGE&&(this.createIndex=this.createIndexFun,this.deleteIndex=function(e){}),e!==m.READ_ONLY&&(this.delete=this.deleteData,this.bulkDelete=this.bulkDeleteData,this.clear=this.deleteData,this.insert=this.insertAndUpdate,this.upsert=function(e){return t.insertAndUpdate(e,!0)},this.bulkUpsert=this.bulkUpsertData)},e.prototype.createIndexFun=function(e,t){var r=this.collectionSchema.indices.filter((function(t){return t.name===e}));if(!r.length)throw new w(e);return new R(this.dbName,this,r[0],this.mode)},e.prototype.bulkDeleteData=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return t=e.map((function(e){return S.normalizeUnionKeyValue(e)})),r={command:f.DELETE,dbName:this.dbName,tableName:this.tableName,where:e?(new D).addCondition(S.getDBKeyFromKeyPath(this.keyPath),t,g.IN).build():void 0},[4,this.sendRequest(r)];case 1:return L(i.sent(),"bulkDelete",this.reqErrorObserver),[2]}}))}))},e.prototype.bulkUpsertData=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,r,i=this;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return t=e.map((function(e){return S.addUnionKeyIfNeed(e,i.keyPath)})).map((function(e){return{tableName:i.tableName,data:e}})),r={command:f.UPDATE_MUTIL_TABLE_DATA,dbName:this.dbName,multiData:t},[4,this.sendRequest(r)];case 1:return L(n.sent(),"bulkUpsert",this.reqErrorObserver),[2,e.map((function(e){return S.getKeyFromValue(e,i.keyPath)}))]}}))}))},e.prototype.insertAndUpdate=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return r=S.addUnionKeyIfNeed(e,this.keyPath),i={command:t?f.UPDATE:f.INSERT,dbName:this.dbName,tableName:this.tableName,data:r},[4,this.sendRequest(i)];case 1:return L(n.sent(),t?"upsert":"insert",this.reqErrorObserver),[2,S.getKeyFromValue(e,this.keyPath)]}}))}))},e.prototype.deleteData=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return t={command:f.DELETE,dbName:this.dbName,tableName:this.tableName,where:e?(new D).addKeyQueryCondition(this.keyPath,e).build():void 0},[4,this.sendRequest(t)];case 1:return L(r.sent(),e?"delete":"clear",this.reqErrorObserver),[2]}}))}))},e.prototype.sendRequest=function(e){var t,r;(null===(t=this.transaction)||void 0===t?void 0:t.transactionID)&&(e.transaction=this.transaction.transactionID);var i=y.send(e);return null===(r=this.transaction)||void 0===r||r.addResponsePromise(i),i},e.prototype.getClientQueryCondition=function(e){var t,r,i,n,s,l=new D;if(e.whereClauses.length>1)throw new E;if(!e.whereClauses.length)return l.build();var c=Object(o.__read)(e.whereClauses,1)[0];try{for(var d=Object(o.__values)(Object.entries(c)),u=d.next();!u.done;u=d.next()){var p=Object(o.__read)(u.value,2),m=p[0],f=p[1];if(h(f))l.addKeyQueryCondition(m,f);else if(!this.isEmptyPredicate(f)){var b=f[a.In];Array.isArray(b)&&l.addCondition(S.getDBKeyFromKeyPath(m),b.map(S.normalizeUnionKeyValue),g.IN);var v=f[a.NotIn];Array.isArray(v)&&l.addCondition(S.getDBKeyFromKeyPath(m),v.map(S.normalizeUnionKeyValue),g.NOT_IN);try{for(var y=(i=void 0,Object(o.__values)(Object.entries(f))),x=y.next();!x.done;x=y.next()){var _=Object(o.__read)(x.value,2),T=_[0],O=_[1];if(void 0!==O)if(T!==a.NotEquals){var P=(s={},s[a.Equals]=IDBKeyRange.only(O),s[a.GreaterThan]=IDBKeyRange.lowerBound(O,!0),s[a.GreaterOrEqualThan]=IDBKeyRange.lowerBound(O,!1),s[a.LessThan]=IDBKeyRange.upperBound(O,!0),s[a.LessOrEqualThan]=IDBKeyRange.upperBound(O,!1),s)[T];void 0!==P&&l.addKeyQueryCondition(m,P)}else l.addCondition(S.getDBKeyFromKeyPath(m),[S.normalizeUnionKeyValue(O)],g.NOT_IN)}}catch(e){i={error:e}}finally{try{x&&!x.done&&(n=y.return)&&n.call(y)}finally{if(i)throw i.error}}}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}return void 0!==e.limit&&l.setLimit(e.limit),l.setOffset(e.offset),void 0!==e.order&&l.addOrder(S.getDBKeyFromKeyPath(e.order.path),e.order.type),l.build()},e.prototype.isEmptyPredicate=function(e){return!e||Object.values(e).every((function(e){return void 0===e}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.table;null==t||t.get.patch(this,"get"),null==t||t.getAll.patch(this,"getAll"),null==t||t.getAllKeys.patch(this,"getAllKeys"),null==t||t.index.patch(this,"index"),null==t||t.openCursor.patch(this,"openCursor"),this.mode===m.VERSION_CHANGE&&(null==t||t.createIndex.patch(this,"createIndex"),null==t||t.deleteIndex.patch(this,"deleteIndex")),this.mode!==m.READ_WRITE&&this.mode!==m.VERSION_CHANGE||(null==t||t.delete.patch(this,"delete"),null==t||t.insert.patch(this,"insert"),null==t||t.upsert.patch(this,"upsert"),null==t||t.clear.patch(this,"clear"),null==t||t.query.patch(this,"query"),null==t||t.bulkDelete.patch(this,"bulkDelete"),null==t||t.bulkUpsert.patch(this,"bulkUpsert"))},e}();!function(e){e.ACTIVE="active",e.COMMITTING="committing",e.COMPLETED="completed"}(k||(k={}));var B=function(){function e(e,t,r,i,n,o){var a,s=this;this.tables=e,this.dbName=t,this.dbSchema=r,this.transactionID=i,this.mode=n,this.engineAspects=o,this.reqSeqFactory=(a=0,function(){return a+=1}),this.dbRequestSeqAndResponseMap=new Map,this.transactionStatus="active",this.autoCommitTimerId=null,this.onTransactionDonePromiseResolve=function(){},this.onTransactionDonePromiseReject=function(){},this.waitingTransactionDonePromise=new Promise((function(e,t){s.onTransactionDonePromiseResolve=e,s.onTransactionDonePromiseReject=t})),(null==o?void 0:o.transaction)&&this.applyAspectPatch(),this.tryToAutoCommit()}return e.prototype.notifyTransactionFail=function(e){this.onTransactionDonePromiseReject(e),this.clearAutoCommitTimer()},e.prototype.waitForTransactionDone=function(){return this.waitingTransactionDonePromise},e.prototype.addResponsePromise=function(e){var t=this,r=this.reqSeqFactory();this.clearAutoCommitTimer(),this.dbRequestSeqAndResponseMap.set(r,e),e.then((function(){t.dbRequestSeqAndResponseMap.delete(r),t.tryToAutoCommit()}))},e.prototype.table=function(e){return new M(this.dbName,A(e,this.dbSchema),this.mode,this.engineAspects,this)},e.prototype.commit=function(e){var t,r,i,n;return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return this.clearAutoCommitTimer(),"active"!==this.transactionStatus?(e||null===(r=null===(t=window.log)||void 0===t?void 0:t.report)||void 0===r||r.call(t,"transaction_repeat_error",{query:{sessionId:null===(n=null===(i=window.log)||void 0===i?void 0:i.var)||void 0===n?void 0:n.sessionId}}),[2,!0]):this.transactionID?(a={command:f.COMMIT_TRANSACTION,dbName:this.dbName,transaction:this.transactionID},this.transactionStatus="committing",[4,y.send(a)]):(this.onTransactionDonePromiseResolve(),[2,!0]);case 1:return s=o.sent(),this.transactionStatus="completed",s.err_code||s.err_msg?(this.onTransactionDonePromiseReject(),[2,!1]):(this.onTransactionDonePromiseResolve(),[2,!0])}}))}))},e.prototype.rollback=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return this.transactionID?(e={command:f.ROLLBACK_TRANSACTION,dbName:this.dbName,transaction:this.transactionID},[4,y.send(e)]):(this.onTransactionDonePromiseResolve(),[2,!0]);case 1:return(t=r.sent()).err_code||t.err_msg?(this.onTransactionDonePromiseReject(),[2,!1]):(this.onTransactionDonePromiseResolve(),[2,!0])}}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.transaction,r=this;null==t||t.commit.patch(r,"commit"),null==t||t.rollback.patch(r,"rollback"),null==t||t.table.patch(r,"table")},e.prototype.tryToAutoCommit=function(){var e=this;0===this.dbRequestSeqAndResponseMap.size&&null===this.autoCommitTimerId&&(this.autoCommitTimerId=setTimeout((function(){0===e.dbRequestSeqAndResponseMap.size&&"active"===e.transactionStatus&&e.commit(!0)})))},e.prototype.clearAutoCommitTimer=function(){null!==this.autoCommitTimerId&&(clearTimeout(this.autoCommitTimerId),this.autoCommitTimerId=null)},e}(),N=function(){function e(e,t,r,i,n,o){this.isSupportTransactions=n,this.engineAspects=o,this.schema=e,this.name=t,this.version=r,this.tableNames=i,(null==o?void 0:o.database)&&this.applyAspectPatch()}return e.prototype.setVersionChangeListener=function(){},e.prototype.close=function(){},e.prototype.createTable=function(e){return new M(this.name,A(e,this.schema),m.VERSION_CHANGE,this.engineAspects)},e.prototype.deleteTable=function(){},e.prototype.transaction=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return this.isSupportTransactions&&t!==m.READ_ONLY?(r={command:f.BEGIN_TRANSACTION,dbName:this.name},[4,y.send(r)]):[2,new B(e,this.name,this.schema,void 0,null!=t?t:m.READ_ONLY,this.engineAspects)];case 1:return L(i=n.sent(),"startTransaction"),[2,new B(e,this.name,this.schema,i.result,null!=t?t:m.READ_ONLY,this.engineAspects)]}}))}))},e.prototype.table=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(r){return[2,new M(this.name,A(e,this.schema),t,this.engineAspects)]}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.database;null==t||t.deleteTable.patch(this,"deleteTable"),null==t||t.createTable.patch(this,"createTable"),null==t||t.transaction.patch(this,"transaction"),null==t||t.table.patch(this,"table"),null==t||t.close.patch(this,"close")},e}();var F=function(e,t){return e===t?0:e>t?1:-1},U=function(){function e(){this.cmp=F}return e.prototype.deleteDB=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2]}))}))},e.prototype.setAspects=function(e){this.engineAspects=e,e.openDB.patch(this,"openDB"),e.deleteDB.patch(this,"deleteDB")},e.prototype.openDB=function(e,t,r,i){var n,a,s,l;return Object(o.__awaiter)(this,void 0,void 0,(function(){var c,d,u,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,y.send({command:f.INIT,dbName:e,table:this.getTableInfo(t)})];case 1:if((c=o.sent()).err_msg||c.err_code)throw new C(e+" errCode: "+c.err_code+", errMsg: "+c.err_msg);return[4,this.getDBExistTableNames(e)];case 2:return d=o.sent(),u=new N(t,e,null!=r?r:0,d,null!==(a=null===(n=c.result)||void 0===n?void 0:n.supportTransaction)&&void 0!==a&&a,this.engineAspects),(null===(s=c.result)||void 0===s?void 0:s.dbSchemaChange)&&(null==i?void 0:i.upgrade)?[4,u.transaction(d,m.VERSION_CHANGE)]:[2,u];case 3:return p=o.sent(),null===(l=null==i?void 0:i.upgrade)||void 0===l||l.call(i,u,0,null!=r?r:null,p),[4,p.waitForTransactionDone()];case 4:return o.sent(),[2,u]}}))}))},e.prototype.getDBExistTableNames=function(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,y.send({dbName:e,command:f.GET_ALL,tableName:s.name})];case 1:return(r=n.sent()).err_code||r.err_msg||!(null===(t=r.result)||void 0===t?void 0:t.length)?[2,[]]:(i=r.result,[2,Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(i)),[s]).map((function(e){return e.name}))])}}))}))},e.prototype.getTableInfo=function(e){return e?e.collections.map((function(e){var t;if(!(null===(t=e.key)||void 0===t?void 0:t.path))throw new P("key autoIncrement");var r=e.indices.map((function(e){if(e.path instanceof Array)throw new P("union index");return S.getDBKeyFromKeyPath(e.path)}));return e.key.path instanceof Array&&e.key.path.forEach((function(e){r.push(e)})),{tableName:e.name,keyName:S.getDBKeyFromKeyPath(e.key.path),indexs:Object(o.__spreadArray)([],Object(o.__read)(new Set(r)))}})):[]},e}();t.a=U},cf24892fbf:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));const i="__MEGA_BROKER__";["__MEGA_INTERNAL_API__","loadProtocol"].join(":")},daff531963:function(e,t,r){"use strict";var i,n,o,a,s;r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return s})),function(e){e[e.ABOVE=0]="ABOVE",e[e.BELOW=1]="BELOW",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(i||(i={})),function(e){e[e.ROW=0]="ROW",e[e.COLUMN=1]="COLUMN"}(n||(n={})),function(e){e[e.ALL=0]="ALL",e[e.HEIGHT=1]="HEIGHT",e[e.WIDTH=2]="WIDTH"}(o||(o={})),function(e){e.Update="update",e.Add="add",e.Remove="remove"}(a||(a={})),function(e){e.Text="text",e.CellProperties="cellProperties"}(s||(s={}))},e302115f02:function(e,t,r){"use strict";var i;r.d(t,"a",(function(){return i})),function(e){e.numberRef="nr",e.numberLiteral="nl",e.stringRef="sr",e.stringLiteral="sl"}(i||(i={}))},e3f37efdd5:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("026cc7da1f"),s=r("711a53c9fc"),l=r("9559b6ab8e"),c=r("7c46f42788"),d=r("78db0f5ada"),u=r("5a0111def3"),p=r("fd3bb9fd64"),h=r("61211f3c6b"),m=r("76f2cf9a19"),f=r("cf3340a08c"),g=r("285f8ccc4f"),b=r("76f1d59f9d");class v extends b.a{addAnimation(e){const{index:t,delay:r,shapeIds:i,animType:n,triggerId:o,presetSubtype:a,mediaDuration:l,mediaType:d}=e;let{nodeType:u}=e;const p=i.filter((e=>this.getPresentation().store.models.get(e,...c.d)));this.transaction((()=>{p.forEach(((e,i)=>{u||(u=0===i?s.Db.clickEffect:s.Db.withEffect);const c=this.createAddAnimationMutation(e,o,i+t),p=this.createSetAnimationMutation(e,o,i+t,{presetSubtype:a,animType:n,nodeType:u,duration:l,delay:r,mediaType:d});c&&p&&this.transaction((()=>this.request([c,p])))}))}))}removeAnimation(e,t){var r;const i=this.createRemoveAnimation(e,t);var n;const o=this.createSetAnimationMutation(null!==(n=null===(r=i.toData())||void 0===r?void 0:r.shapeId)&&void 0!==n?n:"",e,t,{});this.transaction((()=>this.request([o,i])))}removeAnimationsByShapeId(e){this.getPresentation().store.models.get(e,...c.d)&&this.transaction((()=>{Object.keys(this.model.props.unitTimeNodeMap).forEach((t=>{var r;const i=this.model.props.unitTimeNodeMap[t];var n;[...null!==(n=null==i?void 0:i.unitTimeNodeList)&&void 0!==n?n:[]].forEach((r=>{if(new d.a(r).shapeId===e){var i,n;const e=null!==(n=null===(i=this.model.props.unitTimeNodeMap[t])||void 0===i?void 0:i.unitTimeNodeList.indexOf(r))&&void 0!==n?n:0;this.removeAnimation(t,e)}}));const o=null===(r=this.model.props.unitTimeNodeMap[t])||void 0===r?void 0:r.unitTimeNodeList;if(t===e&&(null==o?void 0:o.length)){var a;let e=o.length-1;var s;const r=null!==(s=null===(a=this.model.getSeqByTriggerId(l.q))||void 0===a?void 0:a.unitTimeNodeList.length)&&void 0!==s?s:0;for(;e>=0;)this.moveAnimation(e,r,t,l.q),e-=1}}))}))}moveAnimation(e,t,r=l.q,i=l.q){var n;const o=this.model.props.unitTimeNodeMap[r],c=this.model.props.unitTimeNodeMap[i],p=null==o||null===(n=o.unitTimeNodeList)||void 0===n?void 0:n[e];Object(a.assert)(o&&p,"time node not found");const h=new d.a(p);this.transaction((()=>{var n,a;this.request([new u.a({pageId:this.context.getPage().id,shapeId:null!==(n=h.shapeId)&&void 0!==n?n:"",fromTriggerId:r,triggerId:i,fromIndex:e,index:t,fromSeqType:null==o?void 0:o.type,seqType:null!==(a=null==c?void 0:c.type)&&void 0!==a?a:i===l.q?s.Db.mainSeq:s.Db.interactiveSeq})])}))}modifyAnimation(e,t,r){var o,s;const l=this.model.props.unitTimeNodeMap[e],u=null==l||null===(o=l.unitTimeNodeList)||void 0===o?void 0:o[t];Object(a.assert)(!!u,"time node not found");const{shapeId:h,dur:m,delay:f,nodeType:b,animType:v,presetSubtype:y,by:S,opacity:x,presetClass:_,id:T,color:O}=new d.a(u),P=this.model.store.isSupportEditAnimType(u),C=null===(s=this.getPresentation())||void 0===s?void 0:s.store.models.get(null!=h?h:"",...c.d);Object(a.assert)(h&&(null==C?void 0:C.id)===h,"shapeId should be exist");const I=r.triggerId||e,w=e!==I,E=r.animType||v,j=v!==E;this.transaction((()=>{if(j)return void this.request([this.createSetAnimationMutation(h,e,t,Object(i.a)({id:T,nodeType:b,shapeId:h,triggerId:e},r),Object(p.b)(this.model.getTimeNode.bind(this.model),h,_))]);const o=Object(i.a)({shapeId:h,id:T,dur:m,delay:f,nodeType:b,animType:v,presetSubtype:y,by:S,opacity:x,triggerId:e,color:O},r);if(this.request([P?this.createSetAnimationMutation(h,e,t,w?Object(n.a)(Object(i.a)({},o),{triggerId:e}):o,Object(p.b)(this.model.getTimeNode.bind(this.model),h,_)):this.createUnSupportSetAnimationMutation(h,e,t,w?Object(n.a)(Object(i.a)({},o),{triggerId:e}):o,Object(g.a)(u))]),w){var a;const r=(null===(a=this.model.getSeqByTriggerId(I))||void 0===a?void 0:a.unitTimeNodeList.length)||0;this.moveAnimation(t,r,e,I)}}))}modifyOriginMediaAnimation(e,t){var r,i;const n=null===(r=this.model.store.data.unitTimeNodeMap[l.q])||void 0===r?void 0:r.unitTimeNodeList,o=null==n?void 0:n[e];Object(a.assert)(o,"kDefaultTriggerTimeNode should be exist");const c=d.a.getShapeId(o);Object(a.assert)(c,"shapeId should be exist");const u=null===(i=this.model.store.data.unitTimeNodeMap[l.t+c])||void 0===i?void 0:i.unitTimeNodeList,h=Object(g.a)(null==u?void 0:u[0]);Object(a.assert)(h,"mediaUnitNode should be exist"),h.par=Object(g.a)(null==o?void 0:o.par);const m=new d.a(h);m.updateDataExpectAnimType(t),this.transaction((()=>{this.removeAnimation(l.q,e);const t=this.createAddAnimationMutation(c,l.q,e),r=new p.a({index:e,shapeId:c,triggerId:l.q,timeNode:m.getData(),pageId:this.context.getPage().id,seqType:s.Db.mainSeq});this.request([t,r])}))}createAddAnimationMutation(e,t,r){return new h.a({pageId:this.context.getPage().id,shapeId:e,triggerId:t,seqType:t===l.q?s.Db.mainSeq:s.Db.interactiveSeq,index:r})}createUnSupportSetAnimationMutation(e,t,r,n,o){return new d.a(o).updateDataExpectAnimType(Object(i.a)({shapeId:e},n)),new p.a({pageId:this.context.getPage().id,shapeId:e,triggerId:t,seqType:s.Db.mainSeq,index:r,timeNode:o})}createSetAnimationMutation(e,t,r,n,o={}){const a=new d.a(Object(i.a)({},o));return a.updateData(Object(i.a)({shapeId:e},n)),new p.a({index:r,shapeId:e,triggerId:t,timeNode:a.getData(),pageId:this.context.getPage().id,seqType:t===l.q?s.Db.mainSeq:s.Db.interactiveSeq})}createRemoveAnimation(e,t){var r;const i=this.model.props.unitTimeNodeMap[e],n=null==i||null===(r=i.unitTimeNodeList)||void 0===r?void 0:r[t];Object(a.assert)(i&&n,"time node not found");const o=new d.a(n);var s;return new m.a({pageId:this.context.getPage().id,shapeId:null!==(s=o.shapeId)&&void 0!==s?s:"",triggerId:e,seqType:i.type,index:t})}constructor(e,t,r){super(e,t),this.context=r}}Object(o.__decorate)([Object(f.a)()],v.prototype,"addAnimation",null),Object(o.__decorate)([Object(f.a)()],v.prototype,"removeAnimation",null),Object(o.__decorate)([Object(f.a)()],v.prototype,"removeAnimationsByShapeId",null),Object(o.__decorate)([Object(f.a)()],v.prototype,"moveAnimation",null),Object(o.__decorate)([Object(f.a)()],v.prototype,"modifyAnimation",null),Object(o.__decorate)([Object(f.a)()],v.prototype,"modifyOriginMediaAnimation",null)},e7714aad84:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r("d7c625d1f2"),n=r("f8a9d85cf9"),o=r("cf3340a08c"),a=r("76f1d59f9d");class s extends a.a{updateProps({name:e}){this.transaction((()=>{this.model.props.name!==e&&this.request([new n.a({sectionId:this.model.id,name:e})])}))}}Object(i.__decorate)([Object(o.a)()],s.prototype,"updateProps",null)},e93cc9d9b1:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r("d7c625d1f2"),n=r("5d64cf765d"),o=r("7b66f04f1e"),a=o.a.withMessageCreator("UnexpectedOutsideMigrationActionError",(function(e){return e+" outside ensure(callback) is not allowed, please wrap your migration actions inside a ensure callback"})),s=function(){function e(e,t){this.name=e,this.context=t}return e.create=function(t){return{index:function(r){return new e(r,t)}}},e.prototype.create=function(e){var t=this.context.scope.collection;if(!t)throw new a("CreateIndex");return this.context.actions.schema.push({type:n.g.CreateIndex,name:this.name,attributes:Object(i.__assign)({},e),collection:t}),this},e.prototype.drop=function(){var e=this.context.scope.collection;if(!e)throw new a("DropIndex");this.context.actions.schema.push({type:n.g.DropIndex,name:this.name,collection:e})},e.prototype.alter=function(e){var t=this.context.scope.collection;if(!t)throw new a("AlterIndex");return this.context.actions.schema.push({type:n.g.DropIndex,name:this.name,collection:t},{type:n.g.CreateIndex,name:this.name,attributes:Object(i.__assign)({},e),collection:t}),this},e.prototype.rename=function(e){var t=this.context.scope.collection;if(!t)throw new a("RenameIndex");this.context.actions.schema.push({type:n.g.DropIndex,name:this.name,collection:t},{type:n.g.CreateIndex,name:e,attributes:{path:""},collection:t})},e.prototype.ensure=function(){throw new o.b},e}(),l=function(){function e(e,t){this.name=e,this.context=t}return e.create=function(t){return{collection:function(r){return new e(r,t)}}},e.prototype.create=function(e){return this.context.actions.schema.push({type:n.g.CreateCollection,name:this.name,attributes:Object(i.__assign)({},e)}),this},e.prototype.drop=function(){this.context.actions.schema.push({type:n.g.DropCollection,name:this.name})},e.prototype.alter=function(e){return this.context.actions.schema.push({type:n.g.DropCollection,name:this.name},{type:n.g.CreateCollection,name:this.name,attributes:Object(i.__assign)({},e)}),this},e.prototype.rename=function(e){this.context.actions.schema.push({type:n.g.DropCollection,name:this.name},{type:n.g.CreateCollection,name:e,attributes:{key:{generator:n.c.AutoIncrement},properties:[]}})},e.prototype.ensure=function(e){var t=this.context,r=Object(i.__assign)({},s.create(t));this.context.scope.collection=this.name,e(r),this.context.scope.collection=null},e}(),c=function(){function e(){this.context={actions:{schema:[],data:[]},scope:{database:null,collection:null}},this.builder=l.create(this.context)}return e.prototype.init=function(e){this.state=e,this.build()},e.prototype.plan=function(){return this.context.actions.schema.length||this.context.actions.data.length?[{schema:{actions:this.context.actions.schema.slice()},data:{actions:this.context.actions.data.slice()}}]:[]},e.prototype.handleDropCollection=function(e){var t,r;try{for(var n=Object(i.__values)(e),o=n.next();!o.done;o=n.next()){var a=o.value;this.builder.collection(a.name).drop()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.handleCreateCollection=function(e){var t,r,n=function(e){o.builder.collection(e.name).create(e).ensure((function(t){var r,n;try{for(var o=(r=void 0,Object(i.__values)(e.indices)),a=o.next();!a.done;a=o.next()){var s=a.value;t.index(s.name).create(s)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}))},o=this;try{for(var a=Object(i.__values)(e),s=a.next();!s.done;s=a.next()){n(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype.handleIndexChange=function(e){var t,r,n=function(e){o.builder.collection(e.collection).ensure((function(t){var r,n,o,a,s,l;try{for(var c=(r=void 0,Object(i.__values)((null===(s=e.index)||void 0===s?void 0:s.added)||[])),d=c.next();!d.done;d=c.next()){var u=d.value;t.index(u.name).create(u)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}try{for(var p=(o=void 0,Object(i.__values)((null===(l=e.index)||void 0===l?void 0:l.deleted)||[])),h=p.next();!h.done;h=p.next()){u=h.value;t.index(u.name).drop()}}catch(e){o={error:e}}finally{try{h&&!h.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}}))},o=this;try{for(var a=Object(i.__values)(e),s=a.next();!s.done;s=a.next()){n(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype.build=function(){if(!this.state)throw new Error("Migration state is undefined, must init before!");var e=this.state.schema,t=e.expect,r=e.actual,i=n.h.databaseDiff(r,t);this.handleCreateCollection(i.added),this.handleDropCollection(i.deleted),this.handleIndexChange(i.different)},e}()},ebec73b55e:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("cf3340a08c"),s=r("3f9e0540b8");class l extends s.a{updateProps({spPr:e,nvPr:t,blipFill:r}){const o={};return e&&(o.spPr=e),t&&(o.nvPr=Object(n.a)(Object(i.a)({},super.getCommonNonVisualPropsDelta(t)),{picture:{preferRelativeResize:null===t.preferRelativeResize||t.preferRelativeResize}})),r&&(o.picture={blipFill:r}),super.updateProps(o)}}Object(o.__decorate)([Object(a.a)()],l.prototype,"updateProps",null)},ed0457c1f8:function(e,t,r){"use strict";var i;r.d(t,"a",(function(){return i})),function(e){e.API="api",e.Undo="undo",e.Redo="redo",e.BeginTransaction="begin-transaction",e.EndTransaction="end-transaction",e.EnqueueMutations="enqueue-mutations"}(i||(i={}))},f2f4fc4fa9:function(e,t,r){"use strict";r.d(t,"b",(function(){return N})),r.d(t,"a",(function(){return F}));var i=r("cf24892fbf"),n=r("d7c625d1f2"),o=r("2a81537ef9"),a=r("f4e4ed5c17"),s=r("a52ab4297c"),l=r.n(s);const c="localServerChanged";class d{constructor(){this.localServerPromise=Promise.resolve(""),this.initLocalServer(),document.addEventListener(c,(()=>this.initLocalServer()))}get(e,t={},r={}){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getAPIPath(e);return a.a.get(i,Object.assign({params:t,paramsSerializer:e=>l.a.stringify(e)},r)).then((e=>e.data)).catch((e=>{throw new Error(e.message)}))}))}getFile(e,t={}){return Object(n.__awaiter)(this,void 0,void 0,(function*(){let r=yield this.get(e,t,{responseType:"arraybuffer"});try{const e=new TextDecoder("utf-8");return r=JSON.parse(e.decode(new Uint8Array(r))),r}catch(e){return{code:0,data:r}}}))}post(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getAPIPath(e);return Object(a.a)(n,{headers:i||{"Content-Type":"application/json; charset=UTF-8"},method:"POST",data:t,params:r}).then((e=>e.data)).catch((e=>{throw new Error(e.message)}))}))}initLocalServer(){var e;if(!(null===(e=window.mqq)||void 0===e?void 0:e.invoke))throw new Error("window.mqq is not exist");this.localServerPromise=new Promise((e=>{window.mqq.invoke("docx","getLocalServer",{},(t=>{e(t.data)}))}))}getAPIPath(e){var t;return Object(n.__awaiter)(this,void 0,void 0,(function*(){return`${/(iphone|ipad|ipod)/i.test(null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.userAgent)?"https":"http"}://${yield this.localServerPromise}${e}`}))}}class u{constructor(e){this.fire=()=>{},this.token=u.createToken(),this.transport=e,u.channels.set(this.token,this)}static createToken(){return this.token+=1,this.token}static get(e){return this.channels.get(e)}subscribe(e,t){if(this.isClosed())throw new Error("channel is closed");return this.transport.subscribe(this.token,e,t)}publish(e,...t){if(this.isClosed())throw new Error("channel is closed");this.transport.publish({token:this.token,eventName:e,args:t})}close(){u.channels.delete(this.token),this.transport.unsubscribe(this.token)}isClosed(){return!u.channels.has(this.token)}}u.token=0,u.channels=new Map;var p=u;const h="/local-edit/fileStat",m="/local-edit/loadFile",f="/local-edit/saveFile";var g,b=class{constructor(e){this.version=1,this.apis=["stat"],this.channels=["save","load"],this.supportedExtnames=["pdf"],this.stat=e=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const{filePath:t}=e;if(!this.checkIfExtnameSupported(t))return{err:{type:o.t.NotSupported,message:`仅支持 ${this.supportedExtnames.join("/")} 等文件后缀`},data:null};try{const{code:t,message:r,data:i}=yield this.localServer.get(h,e);return 0!==t?{err:{type:o.t.StatError,message:`code: ${t}, message: ${r}`},data:null}:{err:null,data:i}}catch(e){return{err:{type:o.t.StatError,message:e.message},data:null}}})),this.localServer=new d,this.transport=e}load(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const{filePath:t,size:r,globalPadId:i}=e,a=new p(this.transport);if(!this.checkIfExtnameSupported(t))throw new Error(`仅支持 ${this.supportedExtnames.join("/")} 等文件后缀`);return a.subscribe(o.j.Next,((e,s)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const n=Math.min(r-e,s);try{const r=yield this.localServer.getFile(m,{filePath:t,offset:e,length:n,globalPadId:i});if(0!==r.code)throw new Error(`api fail code: ${r.code}`);a.publish(o.j.Chunk,e,n,r.data)}catch(e){a.publish(o.j.Error,e.message)}})))),a.subscribe(o.j.End,(()=>{a.close()})),Promise.resolve(a)}))}save(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=new p(this.transport);return this.saveFile(t,e),Promise.resolve(t)}))}showItemInFolder(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){throw new Error("Method not implemented.")}))}saveFile(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){try{const{newPath:r,newTitle:i}=yield this.localServer.post(f,t);e.publish(o.k.Saved,r,i)}catch(t){e.publish(o.k.Error,JSON.stringify(t))}}))}checkIfExtnameSupported(e){var t;const r=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();return!!r&&this.supportedExtnames.includes(r)}};class v{constructor(){this.queue=[],this.top=0}static roll(...e){const t=e.reduce(((e,t)=>e+t.size()),0),r=Math.random()*t;let i=0;for(const t of e)if(i+=t.size(),r<i)return t.next();return Promise.resolve()}size(){return this.queue.length-this.top}isEmpty(){const e=0===this.size();return e&&this.reset(),e}next(){if(this.top<this.queue.length){const e=this.queue[this.top];return this.top+=1,e().catch((()=>{}))}return Promise.resolve()}push(e){this.queue.push(e)}reset(){this.queue=[],this.top=0}}class y{static patch(){if("unpatched"!==this.state)return()=>{};const{toBlobQueue:e,resume:t}=this,r=HTMLCanvasElement.prototype.toBlob;return this.state="paused",HTMLCanvasElement.prototype.toBlob=function(i,n,o){e.push((()=>new Promise((e=>{r.call(this,(t=>{try{i(t)}finally{e()}}),n,o)})))),t().catch((()=>{}))},()=>{HTMLCanvasElement.prototype.toBlob=r,this.resume().finally((()=>{this.toBlobQueue.reset(),this.conflictTaskQueue.reset(),this.state="unpatched"}))}}static addConflictTask(e){return"unpatched"===this.state?e():new Promise(((t,r)=>{this.conflictTaskQueue.push((()=>e().then(t).catch(r).catch((()=>{})))),this.resume().catch((()=>{}))}))}static next(){return v.roll(this.toBlobQueue,this.conflictTaskQueue)}}g=y,y.toBlobQueue=new v,y.conflictTaskQueue=new v,y.state="unpatched",y.resume=()=>Object(n.__awaiter)(void 0,void 0,void 0,(function*(){if("running"!==g.state&&"unpatched"!==g.state){for(g.state="running";!g.toBlobQueue.isEmpty()||!g.conflictTaskQueue.isEmpty();)yield g.next();g.state="paused"}}));class S{constructor(e){this.state="init",this.onPasswordChange=e=>{"resolved"!==this.state&&(this.password=e,this.state="typed",this.load().catch((()=>{this.state="loading"})))},this.tryLoad=e(this.onPasswordChange)}static load(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){return new S(e).load()}))}static isPasswordError(e){return e===o.l.kPasswordRequired||e===o.l.kInvalidPassword}load(){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if("loading"===this.state)return;this.state="loading";const e=yield this.tryLoad(this.password);S.isPasswordError(e)?this.waitForPasswordChange():this.resolve()}))}waitForPasswordChange(){this.state="typing"}resolve(){this.state="resolved"}}class x{constructor(){this.chunkIndex=0,this.chunkSize=1}next(){return!this.isInitialized()||!this.isEnd()&&(this.chunkIndex+=this.chunkSize,!0)}init(e){this.totalChunk=e}isInitialized(){return void 0!==this.totalChunk}isEnd(){return!!this.isInitialized()&&this.chunkIndex+this.chunkSize>=this.totalChunk}getChunkOptions(){return{chunkIndex:this.chunkIndex,chunkSize:this.chunkSize}}}const _="/local-edit/loadDocx",T="/local-edit/saveDocx",O="/local-edit/saveSsrData",P="/local-edit/report",C="/local-edit/chunkImport";class I{constructor(e){this.version=2,this.apis=["report","saveSsrData"],this.channels=["load","loadByChunks","save","edit"],this.fetchChunkData=function(e,{maxRetries:t=3,onRetry:r=(()=>{})}={}){let i=0;return function o(...a){return Object(n.__awaiter)(this,void 0,void 0,(function*(){try{return i+=1,yield e(...a)}catch(e){if(i<t)return r(i),o(...a);throw e}}))}}((e=>Object(n.__awaiter)(this,void 0,void 0,(function*(){const t=yield y.addConflictTask((()=>this.localServer.get(C,e)));return t.code===o.l.kSlideChunkPageEmptyError?(yield(r=200,new Promise((e=>{setTimeout(e,r)}))),e.isStart=0,Promise.reject(t.message)):t;var r}))),{maxRetries:1/0}),this.saveSsrData=(e,t=o.s.Save)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){try{yield this.localServer.post(O,Object.assign(Object.assign({},e),{saveType:t}))}catch(e){console.error(`[mega] MegaDocxService error: ${JSON.stringify(e)}`)}})),this.report=(e,t)=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this.localServer.post(P,Object.assign(Object.assign({},e),{action:t}))})),this.fetchBackups=e=>{throw new Error("Method not implemented.")},this.fetchVersionMap=e=>{throw new Error("Method not implemented.")},this.removeVersion=(e,t)=>{throw new Error("Method not implemented.")},this.localServer=new d,this.transport=e}load(e){const t=new p(this.transport);return this.startLoad(t,e),Promise.resolve(t)}loadByChunks(e){return Object(n.__awaiter)(this,void 0,void 0,(function*(){if("arraybuffer"===e.responseType)throw new Error("responseType arraybuffer is not supported in mobile");const t=new p(this.transport);return this.loadByChunksIntoChannel(t,e).catch((e=>{t.publish(o.d.Error,this.createMobileError(e))})),t}))}save(e,t){const r=new p(this.transport);return this.startSave(r,e,t),Promise.resolve(r)}edit(e){const t=new p(this.transport);return t.subscribe(o.h.ContentModified,((e,t)=>{var r,i;null===(i=(r=window.mqq).invoke)||void 0===i||i.call(r,"docx","localEditStatus",{isModified:e,title:t})})),Promise.resolve(t)}startLoad(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function*(){try{const{code:i,data:n,message:a}=yield this.localServer.get(_,t);if(0===i)return void e.publish(o.e.Data,n);r||i!==o.r.kPasswordRequired&&i!==o.r.kInvalidPassword||e.subscribe(o.e.ContinueWithPassword,(r=>{this.startLoad(e,Object.assign(Object.assign({},t),{password:r}),!0)})),e.publish(o.e.MobileError,i,a)}catch(t){e.publish(o.e.MobileError,o.r.ErrorUnknown,String(t))}}))}loadByChunksIntoChannel(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function*(){const r=new x,i=y.patch(),a=()=>{i(),e.close()};S.load((i=>(e.subscribe(o.d.ContinueWithPassword,i),i=>Object(n.__awaiter)(this,void 0,void 0,(function*(){let n=0;for(;r.next();){const{code:s,data:l,total:c,message:d}=yield this.fetchChunkData(Object.assign(Object.assign(Object.assign({},t),r.getChunkOptions()),{isStart:r.isInitialized()?0:1,password:i}));if(0!==s)return e.publish(o.d.Error,this.createConverterError(d,s)),S.isPasswordError(s)||a(),s;r.isInitialized()?e.publish(o.d.Chunk,l,r.chunkIndex,n):(void 0!==c&&(n=c),r.init(n),e.publish(o.d.Head,l,n))}return e.publish(o.d.End,n),a(),0}))))).catch((t=>{e.publish(o.d.Error,this.createMobileError(t)),a()}))}))}startSave(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function*(){try{const{convertDir:i,newPath:n,newTitle:a,newGlobalPadId:s,code:l,message:c}=yield this.localServer.post(T,Object.assign(Object.assign({},t),{saveType:r}));0===l?(e.publish(o.f.JSONSaved,i),e.publish(o.f.DocumentSaved,n,a,s)):e.publish(o.f.MobileError,l,c)}catch(t){e.publish(o.f.MobileError,o.q.ErrorUnknown,String(t))}}))}createMobileError(e,t=o.p.ErrorUnknown){return{name:e.name,code:t,message:e.message,stack:e.stack}}createConverterError(e,t){return{name:"ConverterError",code:t,message:e}}}const w="/local-edit/uploadImage",E="/local-edit/downloadImage";var j=class{constructor(e){this.version=1,this.apis=["uploadImage","downloadImage"],this.uploadImage=e=>Object(n.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.localServer.post(w,e.data,e.params,{"Content-Type":"multipart/form-data"})}catch(e){return{code:o.n.ErrorUnknown,message:String(e),data:null}}})),this.downloadImage=e=>Object(n.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.localServer.get(E,e)}catch(e){return{code:o.n.ErrorUnknown,message:String(e),data:null}}})),this.localServer=new d}isMediaURI(e){throw new Error("Method not implemented.")}getLocationFromMediaURI(e){throw new Error("Method not implemented.")}};const A="/local-edit/report";var L=class{constructor(){this.version=1,this.apis=["reportPerformance"],this.reportPerformance=e=>Object(n.__awaiter)(this,void 0,void 0,(function*(){this.localServer.post(A,e)})),this.localServer=new d}},k=r("b8e6877859");var D,R=class{constructor(){this.eventEmitterMap=new Map,this.publish=e=>{const{token:t,eventName:r,args:i}=e;this.getEventEmitter(t).emit(String(r),...i)},this.subscribe=(e,t,r)=>this.getEventEmitter(e).on(t,r),this.unsubscribe=e=>{this.eventEmitterMap.has(e)&&(this.getEventEmitter(e).events={},this.eventEmitterMap.delete(e))}}getEventEmitter(e){return this.eventEmitterMap.has(e)||this.eventEmitterMap.set(e,Object(k.a)()),this.eventEmitterMap.get(e)}};class M{constructor(){this.transport=new R,this.services=new Map}static get transport(){return this.instance.transport}static register({services:e,onRegisterError:t}={}){Object.entries(null!=e?e:{}).forEach((([e,r])=>{try{M.instance.registerService(e,r)}catch(r){if(!t)throw r;null==t||t(e,r)}}))}static getService(e){const t=this.instance.services.get(e);if(!t)throw new Error(`Service "${e}" not found`);return t}registerService(e,t){if(this.services.has(e))throw new Error(`Service "${e}" is already registered`);if(!Number.isInteger(t.version)&&t.version<=0)throw new Error(`Service ${e}: version ${t.version} is not an integer greater than 0`);this.services.set(e,t)}}D=M,M.instance=new D;var B=M;function N(){B.register({services:{file:new b(B.transport),docx:new I(B.transport),media:new j(B.transport),report:new L},onRegisterError:(e,t)=>{console.error("[Mega Mobile]",`Service "${e}" is failed to register:`,JSON.stringify(t.stack))}})}function F(){Reflect.set(window,i.a,{loadProtocol:e=>{const t=B.getService(e);return{protocol:{apis:t.apis||[],channels:t.channels||[],version:t.version},broker:t}},transport:B.transport})}},f5b046c378:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var i=r("1f69014a3c"),n=r("51767cbdc7"),o=r("d7c625d1f2"),a=r("711a53c9fc"),s=r("026cc7da1f"),l=r("5150a29f68"),c=r("4289c697da"),d=r("468f65f56d"),u=r("07944bec9d"),p=r("6f50907d63"),h=r("5a8749f72e"),m=r("b41b5d48f6"),f=r("cf3340a08c"),g=r("460aef6a6f"),b=r("7c46f42788"),v=r("3f9e0540b8");class y extends v.a{updateProps({spPr:e,nvPr:t}){super.updateProps({spPr:e,nvPr:t&&super.getCommonNonVisualPropsDelta(t)})}reorderShapes(e,t){this.guard((t=>m.a.forEach(e,(e=>m.a.shape.is.childOfGroupShape(t,null==e?void 0:e.id,this.model.id)))));const{shapeList:r}=this.model.store,i=new Set(e);let n=0,o=r.length-1;if(t===a.d.Backward)for(;i.has(r.at(n));)n+=1;if(t===a.d.Forward)for(;i.has(r.at(o));)o-=1;(t===a.d.Forward||t===a.d.Back?r.toArray().slice().reverse():r.toArray()).filter(((e,t)=>i.has(e)&&t>=n&&t<=o)).forEach((e=>this.reorderShape(e,t)))}moveShapes(e,t){this.guard((r=>m.a.every(m.a.groupShape.can.insertShapeToPosition(r,this.model.id,t),m.a.forEach(e,(e=>m.a.shape.is.childOfGroupShape(r,e.id,this.model.id))))));const{shapeList:r}=this.model.store,i=new Set(e),n=[0],o=(e,t)=>{const o=r.at(e);if(!i.has(o))return;const s=n[t]-n[e];s&&this.reorderShape(o,s>0?a.d.Forward:a.d.Backward,Math.abs(s))};this.forEachInTransaction(r.toArray(),((e,r)=>{if(n.push(n[r]+Number(!i.has(e))),r===t-1)for(let e=t;e>=0;e--)o(e,t);r>=t&&o(r,t)}))}deleteShapes(e){this.guard((t=>m.a.forEach(e,(e=>m.a.shape.should.existInPage(t,e.id,this.model.getPage().id)))));const t=new Set,r=this.getPresentation().store.models;for(const i of e.slice())i.forEachAncestorShapes((e=>{t.add(e.id)}),{reverse:!0}),this.transaction((()=>{const e=r.get(i.parent.id,b.a.GroupShape);if(!e)return;const t=e.shapeList.filter((e=>e.id!==i.id));if((null==e?void 0:e.parent.type)===b.a.GroupShape){if(0!==t.length)return 1===t.length?(e.api.ungroup(),void e.parent.api.removeShapes([i])):void e.api.removeShapes([i]);e.parent.api.removeShapes([e])}else e.api.removeShapes([i])}));for(const e of Array.from(t).reverse()){const t=r.get(e,b.a.GroupShape);if(!t)continue;const o=Object(c.d)(t.shapeList.map((e=>e.getFrame()))),a=Object(c.e)(t.getFrame(),c.a.fromTransform(o));t.api.refreshTransform(Object(n.a)(Object(i.a)({},a),{chOff:o.chOff,chExt:o.chExt}))}}refreshTransform(e){this.transaction((()=>{const{off:t,ext:r,chOff:i,chExt:n}=e;this.request([new h.a({shapeId:this.model.id,shapeType:a.ac.GroupShape,pageId:this.model.getPage().id,parentId:this.model.parent.id,xfrmDelta:{off:t,ext:r},chXfrmDelta:{chOff:i,chExt:n}})])}))}ungroup(){this.guard((e=>m.a.shape.is.typeOf(e,this.model.id,b.a.GroupShape)));const{parent:e}=this.model;Object(s.assert)(e.type===b.a.GroupShape,"parent should be group shape"),this.transaction((()=>{var t;null===(t=this.model.getPage().timing)||void 0===t||t.api.removeAnimationsByShapeId(this.model.id),this.request([new d.a({groupShapeId:this.model.id,pageId:this.model.getPage().id,shapeIds:this.model.shapeList.map((e=>e.id)),parentId:e.id,index:e.store.shapeList.findIndexById(this.model.id)})]),this.model.shapeList.forEach((e=>{const{off:t,ext:r,rot:i,flipH:n,flipV:o}=Object(c.e)(this.model.getFrame(),e.getFrame());if(this.model.props.spPr instanceof g.a&&e.props.spPr instanceof g.a){const t=this.getUnGroupSpPr(this.model.props.spPr,e.props.spPr);Object.keys(t).length>0&&this.request([new u.a({shapeId:e.id,pageId:this.model.getPage().id,shapeDelta:{spPr:t}})])}this.request([new h.a({shapeId:e.id,shapeType:b.b.toShapeType(e.type),pageId:this.model.getPage().id,parentId:this.model.parent.id,xfrmDelta:{off:t,ext:r,rot:i,flipH:n,flipV:o}})])}))}))}getUnGroupSpPr(e,t){let r={};const{scene3d:n,fill:o}=e;var s,l,c;(t.grpFill&&!o.isEmpty()&&(r=Object(i.a)({},o.getDelta())),n)&&(r.scene3d=n,(null===(s=r.scene3d.extLst)||void 0===s?void 0:s.ext)&&(r.scene3d.extLst.extOp={opType:a.a.Set}),(null===(c=r.scene3d.backdrop)||void 0===c||null===(l=c.extLst)||void 0===l?void 0:l.ext)&&(r.scene3d.backdrop.extLst.extOp={opType:a.a.Set}));return r}reorderShape(e,t,r=1){const{shapeList:i}=this.model.store;this.request([new l.a({pageId:this.model.getPage().id,shapeId:e.id,srcParentId:this.model.id,destParentId:this.model.id,srcIndex:i.findIndexById(e.id),destIndex:i.findReorderDestinationIndex(e.id,t,r),opType:0,destShapeId:""})],!0)}removeShapes(e){this.guard((t=>m.a.forEach(e,(e=>m.a.shape.is.childOfGroupShape(t,e.id,this.model.id))))),this.transaction((()=>{for(const r of e){var t;if(null===(t=this.model.getPage().timing)||void 0===t||t.api.removeAnimationsByShapeId(r.id),r.type===b.a.GroupShape){const e=r.shapeList.slice();r.api.ungroup(),this.removeShapes(e)}else this.request([new p.a({shapeId:r.id,pageId:this.model.getPage().id,parentId:this.model.id,index:this.model.store.shapeList.findIndexById(r.id)})],!0)}}))}}Object(o.__decorate)([Object(f.a)()],y.prototype,"updateProps",null),Object(o.__decorate)([Object(f.a)()],y.prototype,"reorderShapes",null),Object(o.__decorate)([Object(f.a)()],y.prototype,"moveShapes",null),Object(o.__decorate)([Object(f.a)()],y.prototype,"deleteShapes",null),Object(o.__decorate)([Object(f.a)()],y.prototype,"refreshTransform",null),Object(o.__decorate)([Object(f.a)()],y.prototype,"ungroup",null)},f78be71a2b:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"d",(function(){return c})),r.d(t,"f",(function(){return d})),r.d(t,"e",(function(){return u}));var i,n=r("711a53c9fc"),o=r("b2a64db471"),a=r("7c46f42788");!function(e){e.Title="title",e.Body="body",e.Table="table",e.Picture="picture",e.Date="date",e.Footer="Footer",e.SlideNumber="slideNumber",e.Content="content"}(i||(i={}));const s={title:{placeholderType:"title",text:["单击此处编辑母版标题样式"],transform2D:{off:{x:838200,y:365125},ext:{cx:10515600,cy:1325563}},hasAnchor:!0},body:{placeholderType:"body",text:["单击此处编辑母版文本样式","二级","三级","四级","五级"],transform2D:{off:{x:838200,y:1825625},ext:{cx:10515600,cy:4351338}}},date:{placeholderType:"date",text:[""],transform2D:{off:{x:838200,y:6356350},ext:{cx:2743200,cy:365125}},hasAnchor:!0,alignment:n.Gb.l,textFieldType:"datetime1"},Footer:{placeholderType:"Footer",transform2D:{off:{x:4038600,y:6356350},ext:{cx:4114800,cy:365125}},hasAnchor:!0,alignment:n.Gb.ctr},slideNumber:{placeholderType:"slideNumber",text:["‹#›"],transform2D:{off:{x:8610600,y:6356350},ext:{cx:2743200,cy:365125}},hasAnchor:!0,alignment:n.Gb.r,textFieldType:"slidenum"}},l={body:{placeholderType:"body",text:["单击此处编辑母版文本样式","二级","三级","四级","五级"]},content:{placeholderType:"content",text:["单击此处编辑母版文本样式","二级","三级","四级","五级"]},picture:{placeholderType:"picture"},table:{placeholderType:"table"},title:{placeholderType:"title",text:["单击此处编辑母版标题样式"]},date:{placeholderType:"date",text:[""],textFieldType:"datetime1"},Footer:{placeholderType:"Footer"},slideNumber:{placeholderType:"slideNumber",text:["‹#›"],textFieldType:"slidenum"}},c={title:n.U.title,body:n.U.body,table:n.U.tbl,picture:n.U.pic,date:n.U.dt,Footer:n.U.ftr,slideNumber:n.U.sldNum},d=({placeholderType:e,placeholderIndex:t,text:r,transform2D:i,hasAnchor:o,alignment:s,textFieldType:l})=>{const d={id:"",type:a.a.Shape,spPr:{},nvPr:{locking:{noGrp:!0}}};return d.spPr.prstGeom={prst:n.gb.rect},i&&(d.spPr.xfrm=i),d.nvPr.ph={},"content"!==e&&(d.nvPr.ph.type=c[e]),t&&(d.nvPr.ph.idx=t),d.txBody={},d.txBody.bodyPr={vert:n.Ob.horz,lIns:91440,rIns:91440,tIns:45720,bIns:45720},o&&(d.txBody.bodyPr.anchor=n.Hb.ctr),s&&(d.txBody.lstStyle={lvl1pPr:{lvl:0,algn:s,defRPr:{sz:1200,solidFill:{egColorChoice:{schemeClr:{val:n.eb.tx1,egColorTransform:[{tint:{val:75e3}}]}}}}}}),d.txBody.p=p(r,l),d},u=({placeholderType:e,placeholderIndex:t,isVert:r,text:i,textFieldType:o})=>{const s={id:"",type:a.a.Shape,spPr:{},nvPr:{locking:{noGrp:!0}}};return s.nvPr.ph={},"content"!==e&&(s.nvPr.ph.type=c[e]),t&&(s.nvPr.ph.idx=t),s.txBody={},r&&(s.txBody.bodyPr={vert:n.Ob.eaVert}),s.txBody.p=p(i,o),s},p=(e,t)=>e&&t?e.map((e=>{const r={};return r.egTextRun=[{fld:{id:`{${Object(o.b)()}}`,rPr:{lang:"zh-CN"},t:"datetime1"===t?h():e,type:t}}],r})):e?e.map(((e,t)=>{const r={};return r.pPr={lvl:t},r.egTextRun=[{r:{rPr:{lang:"zh-CN"},t:e}}],r})):[{endParaRPr:{lang:"zh-CN"}}],h=()=>{const e=new Date;return`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`}},fbd47ef0af:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return m}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var i,n=r("85d0a7609b"),o=r.n(n),a=r("af753b49bd"),s=r("9dbd7f12a7"),l=r("2adf4df3b8");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=(i={},o()(i,a.a.cover,a.d.cover),o()(i,a.a.catalogue,a.d.catalogue),o()(i,a.a.session,a.d.session),o()(i,a.a.page,a.d.page),o()(i,a.a.ending,a.d.ending),i),p=function(e){return u[e]?u[e]:e},h=function(e){if(e.cSld.spTree){var t=e.cSld.spTree.nvPr.descr;if(t){var r=Object(l.a)(t);if(r)return d(d({},r),{},{type:p(r.type)})}}},m=function(e){if(e.cSld.spTree){var t=e.cSld.spTree.nvPr.descr;if(t){var r=Object(l.a)(t);if(r){var i=Object(s.c)(e.cSld.spTree.shapeList,void 0,void 0),n=i.schema,o=i.idMap;return{type:p(r.type),idMap:o,schema:n,imageType:f(n)}}}}},f=function(e){var t;return e.properties.image?a.c.Page:null!==(t=e.properties.list)&&void 0!==t&&t.items.properties.image?a.c.List:a.c.None}},fce1cf19ce:function(e,t,r){"use strict";var i;r.d(t,"a",(function(){return i})),function(e){e.kParagraphBreak="\n",e.kLineBreak="\v",e.kParagraphReturn="\r",e.kFieldBegin="",e.kFieldEnd=""}(i||(i={}))},fdddc95d9b:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var i,n=r("711a53c9fc");!function(e){e.None="none",e.Keyframe="keyframe",e.Editor="editor",e.UndoRedo="undo-redo",e.Collaborator="collaborator",e.CollaboratorConflict="collaborator",e.Offline="offline"}(i||(i={}));const o={[n.c.Empty]:"empty",[n.c.SetPresentationProperties]:"setPresentationProperties",[n.c.SetSlideSize]:"setSlideSize",[n.c.SetNotesSize]:"setNotesSize",[n.c.AddPage]:"addPage",[n.c.RemovePage]:"removePage",[n.c.MovePage]:"movePage",[n.c.SetPageProperties]:"setPageProperties",[n.c.AddShape]:"addShape",[n.c.RemoveShape]:"removeShape",[n.c.TransformShape]:"transformShape",[n.c.MoveShape]:"moveShape",[n.c.Group]:"group",[n.c.Ungroup]:"ungroup",[n.c.SetShapeProperties]:"setShapeProperties",[n.c.AddSection]:"addSection",[n.c.RemoveSection]:"removeSection",[n.c.SetSectionProperties]:"setSectionProperties",[n.c.BindSectionToSlide]:"bindSectionToSlide",[n.c.InsertTableRow]:"insertTableRow",[n.c.InsertTableCol]:"insertTableCol",[n.c.DeleteTableRow]:"deleteTableRow",[n.c.DeleteTableCol]:"deleteTableCol",[n.c.MergeTableCells]:"mergeTableCells",[n.c.UnmergeTableCells]:"unmergeTableCells",[n.c.SetTableColWidths]:"setTableColWidths",[n.c.SetTableRowHeights]:"setTableRowHeights",[n.c.SetTableCellProperties]:"setTableCellProperties",[n.c.AddAnimation]:"addAnimation",[n.c.RemoveAnimation]:"removeAnimation",[n.c.SetAnimationProperties]:"setAnimationProperties",[n.c.MoveAnimation]:"moveAnimation",[n.c.AddTheme]:"addTheme",[n.c.RemoveTheme]:"removeTheme",[n.c.SetTheme]:"setTheme",[n.c.InsertText]:"insertText",[n.c.DeleteText]:"deleteText",[n.c.SetTextProperties]:"setTextProperties",[n.c.SetChartSpaceProperties]:"setChartSpaceProperties",[n.c.AddSubChart]:"addSubChart",[n.c.RemoveSubChart]:"removeSubChart",[n.c.MoveSubChart]:"moveSubChart",[n.c.SetSubChartProperties]:"setSubChartProperties",[n.c.SetTextData]:"setTextData",[n.c.GroupAsSmartArt]:"group",[n.c.SetTextBodyProperties]:"setTextBodyProperties",[n.c.UpdateResourceMap]:"updateResourceMap",[n.c.ComputeGroupTransform]:"computeGroupTransform",[n.c.SetDiagramData]:"setDiagramData",[n.c.SetDiagramDrawing]:"setDiagramDrawing",[n.c.SetDiagrams]:"setDiagrams"}}}]);
//# sourceMappingURL=slide-common~c344e93b-880b03.js.map
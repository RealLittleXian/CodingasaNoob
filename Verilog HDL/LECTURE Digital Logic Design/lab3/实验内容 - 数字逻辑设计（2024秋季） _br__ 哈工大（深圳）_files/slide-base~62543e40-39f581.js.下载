(this.webpackJsonp=this.webpackJsonp||[]).push([["base~62543e40"],{"029d6df9a6":function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=r("7b0ebf3e1a"),d=r("b684da8955"),s=r("e0e8dd9366");function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(){function e(t){i()(this,e),u()(this,"model",void 0),this.model=t}return a()(e,[{key:"frameOnSlide",value:function(e){var t,r,n,i,o=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=null!=e?e:null===(t=(r=this.model).getFrame)||void 0===t?void 0:t.call(r).getFrameInfo(a);return(null===(n=this.model.parent)||void 0===n?void 0:n.type)===s.d.GROUP?Object(d.a)(this.model,(function(e){var t,r=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).getFrameInfo(a),n={x:r.width/2,y:r.height/2},i=Object(c.k)(l,n,r.flipH,r.flipV),u=i.x,d=i.y;l.left=u,l.top=d,o.fixLeftTopAfterRotateByGroup(l,n,r.rotate),o.fixRotateAfterFlipToSlide(l,{rotate:r.rotate,flipH:r.flipH,flipV:r.flipV}),l.left+=r.left,l.top+=r.top,o.fixFlipAfterFlipByGroup(l,r)})):(null===(i=this.model.parent)||void 0===i||i.type,s.d.SMART_ART),l}},{key:"pointOnSlide",value:function(e,t){var r,n=h({},e);return(null===(r=this.model.parent)||void 0===r?void 0:r.type)===s.d.GROUP&&Object(d.a)(this.model,(function(e){var r=e.getFrame().getFrameInfo(t);n.x=r.left+n.x,n.y=r.top+n.y,n=Object(c.l)(n,r)})),n}},{key:"pointToElement",value:function(e,t){for(var r=this,n={x:e.x,y:e.y},i=[],o=this.model.parent;(null===(a=o)||void 0===a?void 0:a.type)===s.d.GROUP;){var a;i.unshift(o),o=o.parent}return i.forEach((function(e){n=r.getReletivePoint(e,n,t)})),n}},{key:"convertFrameOnSlideToSelf",value:function(e){var t,r=this,n=h({},e);if((null===(t=this.model.parent)||void 0===t?void 0:t.type)===s.d.GROUP){var i=[];Object(d.a)(this.model,(function(e){i.unshift(e)})),i.forEach((function(e){var t,i,o=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).getFrameInfo(),a={x:o.width/2,y:o.height/2};n.left-=o.left,n.top-=o.top,r.fixLeftTopAfterRotateByGroup(n,a,-(null!==(i=o.rotate)&&void 0!==i?i:0)),r.fixRotateAfterFlipToGroup(n,{rotate:o.rotate,flipH:o.flipH,flipV:o.flipV});var l=Object(c.k)(n,a,o.flipH,o.flipV),u=l.x,d=l.y;n.left=u,n.top=d,r.fixFlipAfterFlipByGroup(n,o)}))}return n}},{key:"getReletivePoint",value:function(e,t,r){var n,i={x:t.x,y:t.y},o=null===(n=e.getFrame)||void 0===n?void 0:n.call(e).getFrameInfo(r),a=Object(c.f)(o);return o.rotate&&(i=Object(c.d)(i,360-o.rotate,null==a?void 0:a.x,null==a?void 0:a.y)),1===o.flipH&&(i=Object(c.b)(i,a.x)),1===o.flipV&&(i=Object(c.c)(i,a.y)),{x:i.x-o.left,y:i.y-o.top}}},{key:"fixFlipAfterFlipByGroup",value:function(e,t){1===t.flipH&&(e.flipH=0===e.flipH?1:0),1===t.flipV&&(e.flipV=0===e.flipV?1:0)}},{key:"fixLeftTopAfterRotateByGroup",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Object(c.f)(e);n=Object(c.d)(n,r,t.x,t.y),e.left=n.x-e.width/2,e.top=n.y-e.height/2}},{key:"fixRotateAfterFlipToSlide",value:function(e,t){var r,n=t.rotate,i=void 0===n?0:n,o=t.flipH,a=t.flipV,l=null!==(r=e.rotate)&&void 0!==r?r:0,u=o!==a?-1:1;e.rotate=(i+u*l+360)%360}},{key:"fixRotateAfterFlipToGroup",value:function(e,t){var r,n=t.rotate,i=void 0===n?0:n,o=t.flipH,a=t.flipV,l=null!==(r=e.rotate)&&void 0!==r?r:0,u=o!==a?-1:1;e.rotate=((l-i)/u+360)%360}}]),e}()},"0518261faf":function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return b}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("8ee19818c4"),r("b8217400dc"),r("e6f68cdf2e"),r("b684da8955")),d=r("2ba7871556"),s=r("7b0ebf3e1a"),f=r("e0e8dd9366"),h=r("3d0dce06fe"),p=r("444d24ef93");function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var y=1,b=function(){function e(t){i()(this,e),u()(this,"grpFillGroup",void 0),this.grpFillGroup=null!=t?t:null}return a()(e,[{key:"adjustChildBg",value:function(e){var t,r;if(this.grpFillGroup){var n=null===(t=(r=this.grpFillGroup).getBackgroundFill)||void 0===t?void 0:t.call(r).getFillType();this.resetBackgroundRecursion(this.grpFillGroup,e,n)}}},{key:"adjustChildOffsetFrame",value:function(e,t,r){var n,i=this;if(this.isGrpFill(e,t)&&this.didFrameChange(e,r)&&this.isAjudstType(null===(n=e.getBackgroundFill)||void 0===n?void 0:n.call(e).getShownFillType())){var o=this.getGrpFillGroup(e);Object(c.b)(o,(function(e){i.setOffsetFrame(e)})),o.refreshGroupByChildrenWithoutChangeSet+=1}}},{key:"resetBackgroundRecursion",value:function(e,t,r){var n=this;e.children.forEach((function(e){n.adjustChildBackground(e,t,r),e.type===f.d.GROUP&&n.resetBackgroundRecursion(e,t,r)}))}},{key:"adjustChildBackground",value:function(e,t,r){var n,i,o,a,l;(null===(n=e.sdkData)||void 0===n||null===(i=n.props)||void 0===i||null===(o=i.spPr)||void 0===o?void 0:o.grpFill)&&(e.props.style.fillBackground={},h.a.convertPartialDataFromSdkToUi(t,e.props.style.fillBackground),e.props.style.fillBackground.grpFill=y,(null===(a=e.props.style.fillBackground.gradFill)||void 0===a||null===(l=a.pathGradient)||void 0===l?void 0:l.path)===d.c.Shape&&(e.props.style.fillBackground.gradFill.pathGradient.path=d.c.Radial),this.setOffsetFrame(e,r))}},{key:"didFrameChange",value:function(e,t){var r;return(null===(r=e.parent)||void 0===r?void 0:r.type)===f.d.GROUP&&Object(p.b)(t)===p.a.Frame}},{key:"getGrpFillGroup",value:function(e){var t=this;return this.grpFillGroup||(this.grpFillGroup=e.parent,Object(c.a)(e,(function(e){var r=e.props.style.fillBackground;if(null==r||!r.grpFill)return t.grpFillGroup=e,!0}))),this.grpFillGroup}},{key:"getOffsetFrame",value:function(e){var t,r,n,i=this.getGrpFillGroup(e),o=null===(t=i.getFrame)||void 0===t?void 0:t.call(i).frameOnSlide(),a=o.left,l=o.top,d=a+o.width,h=l+o.height,p=null!==(r=i.props.style.rotate)&&void 0!==r?r:0,y=i.props.style.flipH,b=i.props.style.flipV,g=this.isRotateWithShape(i);this.handleRotateWithShape(i,o,g),Object(c.b)(i,(function(e){var t,r=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).frameOnSlide(),n=Object(s.j)(r,r.rotate);a=Math.min(a,n.left),l=Math.min(l,n.top),d=Math.max(d,n.left+n.width),h=Math.max(h,n.top+n.height)}),[f.d.GROUP]);var m,O,k=null===(n=e.getFrame)||void 0===n?void 0:n.call(e).frameOnSlide(),S=d-a,P=h-l,C=a-k.left,R=l-k.top;g&&(m={offsetRotate:((k.rotate||0)-((null===(O=i.getFrame)||void 0===O?void 0:O.call(i).frameOnSlide().rotate)||0)+360)%360,offsetFlipH:!!o.flipH,offsetFlipV:!!o.flipV},i.props.style.rotate=p,i.props.style.flipH=y,i.props.style.flipV=b);return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({offsetX:C,offsetY:R,offsetWidth:S,offsetHeight:P},m)}},{key:"handleRotateWithShape",value:function(e,t,r){var n;if(r){var i=t.rotate,o=void 0===i?0:i,a=t.flipH,l=t.flipV,u=null!==(n=e.props.style.rotate)&&void 0!==n?n:0;e.props.style.rotate=u-o,t.flipH&&(e.props.style.flipH=a?0:1),t.flipV&&(e.props.style.flipV=l?0:1)}}},{key:"isRotateWithShape",value:function(e){var t,r=null===(t=e.getBackgroundFill().getCurrentFill())||void 0===t?void 0:t.fillInfo;return!(0===(null==r?void 0:r.rotateWithShape)||0===(null==r?void 0:r.rotWithShape))}},{key:"isGrpFill",value:function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.sdkData;if(!((null===(t=e.parent)||void 0===t?void 0:t.type)===f.d.GROUP))return!1;var i=null===(r=e.getBackgroundFill)||void 0===r?void 0:r.call(e).getFillInfo();return null!=i&&i.grpFill||!n||!this.hasSdkGrpFill(e)?!(null==i||!i.grpFill||n&&!this.hasSdkGrpFill(e))||(e.props.style.offsetFrame=void 0,!1):(e.props.style.offsetFrame=this.getOffsetFrame(e),!0)}},{key:"isAjudstType",value:function(e){return!(!e||![d.b.GradualFill,d.b.ImageFill,d.b.PattFill].includes(e))}},{key:"hasSdkGrpFill",value:function(e){var t,r,n;return!(null===(t=e.sdkData)||void 0===t||null===(r=t.props)||void 0===r||null===(n=r.spPr)||void 0===n||!n.grpFill)}},{key:"setOffsetFrame",value:function(e,t){var r;this.isGrpFill(e)&&this.isAjudstType(null!=t?t:null===(r=e.getBackgroundFill)||void 0===r?void 0:r.call(e).getShownFillType())&&(e.props.style.offsetFrame=this.getOffsetFrame(e))}}]),e}()},"054b99005b":function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("85d0a7609b"),i=r.n(n),o=r("d5c3deb8c7"),a=r("7b0ebf3e1a"),l=r("3943690d22"),u=r("c73625d763"),c=r.n(u);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){var n,i,u=[];c()(e.props.style,"controlValues")&&(u=Object(o.v)(e.props.style.controlValues));var d=null==e||null===(n=e.getFrame)||void 0===n?void 0:n.call(e).getFrameInfo(!!e.operationFrame);null!=r&&r.get(e.key)&&(d=s(s({},d),r.get(e.key)));var f=e.pathParser.getConnectionPoints(d.width,d.height,u)[t],h={x:f.x+d.left,y:f.y+d.top};h=a.l(h,d),h=null===(i=e.getFrame)||void 0===i?void 0:i.call(e).pointOnSlide(h,!0);var p=null==e?void 0:e.props.style.bgShape;return p&&l.a[p]&&(h.direction=function(e,t,r){var n=l.a[e][r];if(null!=t&&t.flipH&&n%2==1||null!=t&&t.flipV&&n%2==0)return(n+2)%4;return n}(p,d,t)),h}},"06edeef619":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("6c458f1652"),function(){function e(t){i()(this,e),u()(this,"elementModelRef",void 0),this.elementModelRef=t}return a()(e,[{key:"getLink",value:function(){return this.elementModelRef.props.link}},{key:"updateLink",value:function(e){var t=this.getRemoveValByVal(null==e?void 0:e.href);this.elementModelRef.updateAndRemoveProps({link:{href:null==e?void 0:e.href}},t?{link:{href:t}}:null)}},{key:"removeLink",value:function(){this.elementModelRef.removeProps({link:null})}},{key:"getRemoveValByVal",value:function(e){var t={};return null!=e&&e.url?t.slideJump=null:null!=e&&e.slideJump?t.url=null:null!=e&&e.mail?t.slideJump=null:t=null,t}}]),e}())},"0cbec907c5":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"z",(function(){return d})),r.d(t,"x",(function(){return s})),r.d(t,"y",(function(){return f})),r.d(t,"q",(function(){return h})),r.d(t,"u",(function(){return p})),r.d(t,"t",(function(){return v})),r.d(t,"v",(function(){return y})),r.d(t,"w",(function(){return b})),r.d(t,"b",(function(){return n})),r.d(t,"n",(function(){return g})),r.d(t,"s",(function(){return k})),r.d(t,"p",(function(){return S})),r.d(t,"r",(function(){return P})),r.d(t,"c",(function(){return C})),r.d(t,"m",(function(){return R})),r.d(t,"l",(function(){return A})),r.d(t,"e",(function(){return M})),r.d(t,"d",(function(){return T})),r.d(t,"i",(function(){return D})),r.d(t,"h",(function(){return F})),r.d(t,"g",(function(){return E})),r.d(t,"f",(function(){return I})),r.d(t,"k",(function(){return j})),r.d(t,"j",(function(){return w})),r.d(t,"A",(function(){return m})),r.d(t,"o",(function(){return O}));var n,i=r("7a5536c9bf"),o=r.n(i),a=(r("3bf1976a4f"),r("5fac0349d3")),l=r("7f877c3077"),u=r("798a9cd6f2"),c=u.a.ATTACHMENT.DEFAULT_AUDIO_IMAGE,d=u.a.ATTACHMENT.DEFAULT_VIDEO_IMAGE,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",f="https://docimg3.docs.qq.com/image/AgAABTqRgqtHTjP5RydN4YU5S0F1AoQm.png",h="https://docimg1.docs.qq.com/image/AgAABTqRgqvbR-Hg4UBDcYlT0Jywjkc3.png?w=1318&h=408",p="PingFang SC",v="#175ceb",y=14,b=[p].concat(o()(l.a));!function(e){e.VIDEO="video",e.AUDIO="audio",e.DOC="doc",e.IMAGE="image"}(n||(n={}));var g;n.VIDEO,n.AUDIO,n.DOC,n.IMAGE;!function(e){e.SIMPLE_TEXT="simpleText",e.TEXT="text",e.CARD="card",e.NONE="none",e.PREVIEW="preview"}(g||(g={}));var m,O,k={id:g.SIMPLE_TEXT,title:a.a.t("文字链")},S={id:g.TEXT,title:a.a.t("图标+文字链")},P={id:g.PREVIEW,title:a.a.t("预览")},C={id:g.CARD,title:a.a.t("卡片")},R=710,A=448,M=135,T=135,D=710,F=448,E=710,I=120,j=300,w=50;!function(e){e.IDLE="idle",e.LOAD_START="loadStart",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSE="pause",e.SEEKING="seeking",e.SEEKED="seeked",e.BUFFERING="buffering",e.END="end"}(m||(m={})),function(e){e.PLAY_SESSION_START="PLAY_SESSION_START",e.AD_REQ_INFO_START="AD_REQ_INFO_START",e.AD_REQ_INFO_END="AD_REQ_INFO_END",e.AD_REQ_ASSETS_START="AD_REQ_ASSETS_START",e.AD_AUTOPLAY_BLOCKED="AD_AUTOPLAY_BLOCKED",e.AD_PLAYING="AD_PLAYING",e.AD_VOLUME_CHANGE="AD_VOLUME_CHANGE",e.AD_ASSETS_LOADED="AD_ASSETS_LOADED",e.AD_PAUSE="AD_PAUSE",e.AD_RESUME="AD_RESUME",e.AD_END="AD_END",e.AD_TIME_UPDATE="AD_TIME_UPDATE",e.VIDEO_REQ_INFO_START="VIDEO_REQ_INFO_START",e.VIDEO_REQ_INFO_END="VIDEO_REQ_INFO_END",e.VIDEO_LOAD_START="VIDEO_LOAD_START",e.VIDEO_LOAD_PROGRESS="VIDEO_LOAD_PROGRESS",e.VIDEO_DURATION_CHANGE="VIDEO_DURATION_CHANGE",e.VIDEO_METADATA_CHANGE="VIDEO_METADATA_CHANGE",e.VIDEO_TIMEUPDATE="VIDEO_TIMEUPDATE",e.VIDEO_VOLUME_CHANGE="VIDEO_VOLUME_CHANGE",e.VIDEO_RATE_CHANGE="VIDEO_RATE_CHANGE",e.VIDEO_CANPLAY="VIDEO_CANPLAY",e.VIDEO_PLAYING="VIDEO_PLAYING",e.VIDEO_AUTOPLAY_BLOCKED="VIDEO_AUTOPLAY_BLOCKED",e.VIDEO_PAUSE="VIDEO_PAUSE",e.VIDEO_BUFFERING="VIDEO_BUFFERING",e.VIDEO_SEEKING="VIDEO_SEEKING",e.VIDEO_SEEKED="VIDEO_SEEKED",e.VIDEO_SETLEVEL_START="VIDEO_SETLEVEL_START",e.VIDEO_SETLEVEL_END="VIDEO_SETLEVEL_END",e.VIDEO_RESIZE="VIDEO_RESIZE",e.VIDEO_END="VIDEO_END",e.PLAY_SESSION_END="PLAY_SESSION_END"}(O||(O={}))},"0e4dc96964":function(e,t,r){"use strict";r("73b854064b");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("547611bd96"),u=r.n(l),c=r("bd29e2df90"),d=r.n(c),s=r("ab5eb40518"),f=r.n(s),h=r("1b4cdd6a36"),p=r.n(h),v=r("85d0a7609b"),y=r.n(v),b=r("836e76da54"),g=r("e0e8dd9366"),m=r("6c6f5e596f"),O=r("a0d2dff58b"),k=r("e9b1a65b0e"),S=r("00f7badcd2"),P=(r("8ee19818c4"),r("75563bc376"),r("a487fa69e2")),C=r("9657b29818"),R=r("7d1df7d0fb"),A=function(){function e(t){var r=this;i()(this,e),y()(this,"model",void 0),y()(this,"getForegroundImageSize",(function(){return{pl:0,pr:0,pt:0,pb:0,rw:0,rh:0}})),y()(this,"updateForegroundImageSize",(function(){})),y()(this,"isAllImage",(function(){return r.model.selectedModels.every(r.checkIsImage)})),y()(this,"checkIsImage",(function(e){return e.type===g.d.IMAGE&&e.isImage()})),this.model=t}return a()(e,[{key:"getRelativeResize",value:function(){var e=this.model.selectedModels;if(!this.isAllImage())return P.a.noRelative;for(var t=e[0].props.relativeResize,r=e.length,n=1;n<r;n++){if(t!==e[n].props.relativeResize)return P.a.multi}return t===P.a.noRelative?P.a.noRelative:P.a.isRelative}},{key:"handleRelativeResize",value:function(e){var t=this;this.isAllImage()&&Object(C.b)((function(){t.model.selectedModels.forEach((function(t){t.updateProps({relativeResize:e?P.a.isRelative:P.a.noRelative})}))}))}},{key:"resetSize",value:function(){var e=this.model.selectedModels;Object(C.b)((function(){e.forEach((function(e){e.type===g.d.IMAGE&&e.getImageSize().resetSize()}))}))}},{key:"getOriginalSize",value:function(){var e=Object(R.a)(this.model),t=null==e?void 0:e.find((function(e){return e.type===g.d.IMAGE&&e.isImage()}));return t?t.getImageSize().getOriginalSize():{width:0,height:0}}}]),e}(),M=r("29dc9ac489"),T=r("f05fc355c3"),D=(r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36"),r("7a5536c9bf")),F=r.n(D),E=(r("826dc923b3"),r("6e20b6a7d8"),r("342844cefa"),r("9c5b376bf5"));function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var x={left:0,top:0,width:0,height:0,flipV:void 0,flipH:void 0,rotate:0},L=function(e){d()(r,e);var t=w(r);function r(e){var n;return i()(this,r),n=t.call(this,e[0]),y()(u()(n),"updateModelArr",[]),y()(u()(n),"getStyleValue",(function(e,t,r,i){for(var o=n.updateModelArr.length,a=(t?n.updateModelArr[0].getFrame().frameOnSlide(r,i):n.getFinalFrame(n.updateModelArr[0],i))[e],l=1;l<o;l++){var u=(t?n.updateModelArr[l].getFrame().frameOnSlide(r,i):n.getFinalFrame(n.updateModelArr[l],i))[e];if(Math.round(a)!==Math.round(u))return Number.NaN}return a})),y()(u()(n),"getValueArr",(function(e){return n.updateModelArr.map((function(){return e}))})),n.updateModelArr=F()(e),n}return a()(r,[{key:"updateHeight",value:function(e){this.batchUpdateFrameHandler.batchUpdateHeight(j(j({},e),{},{value:this.getValueArr(e.value),updateModelArr:this.updateModelArr}))}},{key:"updateWidth",value:function(e){this.batchUpdateFrameHandler.batchUpdateWidth(j(j({},e),{},{value:this.getValueArr(e.value),updateModelArr:this.updateModelArr}))}},{key:"updateLeft",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateLeft(this.getValueArr(e),this.updateModelArr,t)}},{key:"updateTop",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateTop(this.getValueArr(e),this.updateModelArr,t)}},{key:"updateRotate",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateRotate(this.getValueArr(e),this.updateModelArr,t)}},{key:"updateFrame",value:function(e){this.batchUpdateFrameHandler.batchUpdateFrame(j(j({},e),{},{frame:this.getValueArr(e.frame),updateModelArr:this.updateModelArr}))}},{key:"updateFrameOnSlide",value:function(e){this.batchUpdateFrameHandler.batchUpdateFrameOnSlide(j(j({},e),{},{frame:this.getValueArr(e.frame),updateModelArr:this.updateModelArr}))}},{key:"updateDiffHeight",value:function(e){this.batchUpdateFrameHandler.batchUpdateHeight(j(j({},e),{},{updateModelArr:this.updateModelArr}))}},{key:"updateDiffWidth",value:function(e){this.batchUpdateFrameHandler.batchUpdateHeight(j(j({},e),{},{updateModelArr:this.updateModelArr}))}},{key:"updateDiffLeft",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateLeft(e,this.updateModelArr,t)}},{key:"updateDiffTop",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateTop(e,this.updateModelArr,t)}},{key:"updateDiffRotate",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateRotate(e,this.updateModelArr,t)}},{key:"updateDiffFrame",value:function(e){this.batchUpdateFrameHandler.batchUpdateFrame(j(j({},e),{},{updateModelArr:this.updateModelArr}))}},{key:"updateDiffFrameOnSlide",value:function(e){this.batchUpdateFrameHandler.batchUpdateFrameOnSlide(j(j({},e),{},{updateModelArr:this.updateModelArr}))}},{key:"getFinalFrameInfo",value:function(e,t,r){var n=this,i=j({},x);return Object.keys(i).forEach((function(o){i[o]=n.getStyleValue(o,t,r,e)})),i}}]),r}(E.a);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var N=function(e){d()(r,e);var t=B(r);function r(e){var n;return i()(this,r),n=t.call(this,e),y()(u()(n),"selectedModels",void 0),y()(u()(n),"frameInstance",void 0),y()(u()(n),"fillInstance",void 0),y()(u()(n),"effectInstance",void 0),y()(u()(n),"borderInstance",void 0),y()(u()(n),"lockInstance",void 0),y()(u()(n),"imageSizeInstance",void 0),y()(u()(n),"refreshMenu",void 0),y()(u()(n),"property3DInstance",void 0),y()(u()(n),"dispose",(function(){n.refreshMenu.removeRefreshItemValues()})),n.type=g.d.MULTIPLY,n.selectedModels=e.selectedModels,n.refreshMenu=new M.a(u()(n)),n.refreshMenu.addRefreshItemValues(),n}return a()(r,[{key:"getSelectedModels",value:function(){return this.selectedModels}},{key:"getFrame",value:function(){return this.frameInstance||(this.frameInstance=new L(this.selectedModels)),this.frameInstance}},{key:"getBackgroundFill",value:function(){return this.fillInstance||(this.fillInstance=new m.a(this)),this.fillInstance}},{key:"getLock",value:function(){return this.lockInstance||(this.lockInstance=new S.a(this)),this.lockInstance}},{key:"isTextAttachment",value:function(){for(var e=this.selectedModels,t=0;t<e.length;t++){var r,n;if(null===(r=(n=e[t]).isTextAttachment)||void 0===r||!r.call(n))return!1}return!0}},{key:"getEffect",value:function(){return this.effectInstance||(this.effectInstance=new O.a(this)),this.effectInstance}},{key:"getBorder",value:function(){return this.borderInstance||(this.borderInstance=new k.a(this)),this.borderInstance}},{key:"getImageSize",value:function(){return this.imageSizeInstance||(this.imageSizeInstance=new A(this)),this.imageSizeInstance}},{key:"get3DProperty",value:function(){return this.property3DInstance||(this.property3DInstance=new T.a(this)),this.property3DInstance}},{key:"scene3d",get:function(){return this.get3DProperty().getMultiplyScene3D()}},{key:"shape3d",get:function(){return this.get3DProperty().getMultiplyShape3D()}}]),r}(b.a);t.a=N},"0e5d467d1a":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("8ee19818c4"),r("342844cefa"),r("af802ec74b"),r("ee6bb53310")),d=r.n(c),s=function(){function e(t){i()(this,e),u()(this,"model",void 0),this.model=t}return a()(e,[{key:"handleImageEffect",value:function(e,t){var r=this,n={};if(Object.keys(e).forEach((function(i){var o=e[i];null!=t&&t.onlyChangeUI&&(d()(r.model,"props.style.image.".concat(i),o),r.model.previewChange+=1),n[i]=o})),null==t||!t.onlyChangeUI){var i={style:{image:Object.assign({},this.model.props.style.image,n)}};this.model.updateProps(i)}}}]),e}()},"10d5ddf4e8":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=r("775b80aea6"),d=r("2ba7871556");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h=function(){function e(t){i()(this,e),u()(this,"model",void 0),this.model=t}return a()(e,[{key:"getBackgroundImageSize",value:function(e){var t,r,n=null===(t=this.model.getBackgroundFill().getCurrentFill())||void 0===t?void 0:t.fillInfo,i=f(f({},this.model.props.style),{},{srcRect:null===(r=n.stretch)||void 0===r?void 0:r.fillRect}),o=f(f({},i),e),a=o.width,l=o.height,u=o.srcRect,c=0,d=0,s=0,h=0,p=a,v=l;if(!u)return{pl:c,pr:d,pt:s,pb:h,rw:p,rh:v};var y=u.l,b=void 0===y?0:y,g=u.r,m=void 0===g?0:g,O=u.t,k=void 0===O?0:O,S=u.b;return{pl:c=a*b,pr:d=a*m,pt:s=l*k,pb:h=l*(void 0===S?0:S),rw:p=a+c+d,rh:v=l+s+h}}},{key:"updateBackgroundImageSize",value:function(e,t,r){var n,i,o,a,l,u;if(this.model.getBackgroundFill().getFillType()===d.b.ImageFill){var s=this.model.props.style;t=null!==(n=t)&&void 0!==n?n:s.width,r=null!==(i=r)&&void 0!==i?i:s.height;var h=f(f({},this.getBackgroundImageSize()),e),p=h.pl,v=h.pt,y=h.rw,b=h.rh,g={l:p/t,r:(null!==(o=e.pr)&&void 0!==o?o:y-t-p)/t,t:v/r,b:(null!==(a=e.pb)&&void 0!==a?a:b-r-v)/r},m=null===(l=this.model.getBackgroundFill().getCurrentFill())||void 0===l?void 0:l.fillInfo;this.model.getBackgroundFill().updateCurrentFill({image:f(f({},m),{},{src:(null===(u=c.a.getInstance().getResourceByUrl(m.src))||void 0===u?void 0:u.getCdnUrl())||m.src,stretch:{fillRect:g}})})}}}]),e}()},"188560caec":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("c4ce95b323"),i=r("e0e8dd9366"),o=r("f6115d1d70"),a=r("c45b58bbe8");function l(e){switch(e){case i.d.SHAPE:return a.a;case i.d.IMAGE:return o.a;case i.d.CONNECTOR:return n.a}}},"1b0526663d":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return s}));var n=r("e0e8dd9366"),i=r("8f58e78419"),o=r.n(i),a=r("310c0b6a04"),l=r("c9c92622ff"),u=r("b684da8955"),c=function(e){if(!e)return!1;for(var t=0;t<(null==e?void 0:e.length);t++)if(e[t].type===n.d.GROUP)return!0;return!1};t.b=function(e){var t,r,i,u,c,d=null==e?void 0:e.length;if(!d)return!1;for(var s=0;s<d;s++)if(t=e[s],r=void 0,i=void 0,u=void 0,c=void 0,1===o()(t,"props.".concat(a.b.LOCKS,".noGrp"))||t.isPlaceholder||t.type===n.d.TABLE||t.type===n.d.SMART_ART||(null===(r=t.parent)||void 0===r?void 0:r.type)===n.d.GROUP||(null===(i=t.parent)||void 0===i?void 0:i.type)!==n.d.SLIDE&&(null===(u=t.parent)||void 0===u?void 0:u.type)!==n.d.MASTER&&(null===(c=t.parent)||void 0===c?void 0:c.type)!==n.d.LAYOUT||Object(l.o)(t)||Object(l.d)(t)||Object(l.b)(t)||Object(l.h)(t))return!1;return!0};var d=function(e){var t,r=e.props.style,n=null===(t=e.getFrame)||void 0===t?void 0:t.call(e).frameOnSlide(),i=n.flipH;1===r.flipH&&(i=0===i?1:0);var o=n.flipV;1===r.flipV&&(o=0===o?1:0);var a=0;return Object(u.a)(e,(function(e){a=(e.getFrame().getRotate()+a)%360})),{relativeFlipH:i,relativeFlipV:o,relativeRotate:a}},s=function(e,t,r){var n=t,i=r;if(null!=e&&e.relativeRotate){var o=e.relativeRotate%360*Math.PI/180,a=Math.cos(o),l=Math.sin(o),u=i*a-n*l;n=n*a+i*l,i=u}return 1===(null==e?void 0:e.relativeFlipH)&&(n=-n),1===(null==e?void 0:e.relativeFlipV)&&(i=-i),{offsetX:n,offsetY:i}}},"1c48fbec58":function(e,t,r){"use strict";function n(e,t,r,n){if(!(e&&t&&r&&n))return{l:0,r:0,t:0,b:0};var o=r/e,a=n/t,l=o>a?a:o,u=i((e*l-r)/(e*l*2),2),c=i((t*l-n)/(t*l*2),2);return{l:u,r:u,t:c,b:c}}function i(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r}r.d(t,"a",(function(){return n}))},"1f95bda786":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return a}));var n="child_total_category",i="#404040",o="#000000",a=100},"2550128c65":function(e,t,r){"use strict";r("73b854064b");var n=r("9132715560"),i=r.n(n),o=r("547611bd96"),a=r.n(o),l=r("bd29e2df90"),u=r.n(l),c=r("ab5eb40518"),d=r.n(c),s=r("1b4cdd6a36"),f=r.n(s),h=r("85d0a7609b"),p=r.n(h),v=r("836e76da54"),y=r("e0e8dd9366");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var i=f()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}var g=function(e){u()(r,e);var t=b(r);function r(e){var n;return i()(this,r),n=t.call(this,e),p()(a()(n),"gapIndex",-1),p()(a()(n),"isFromMasterLayout",!1),n.type=y.d.GAP,n.isFromMasterLayout=e.isFromMasterLayout,void 0!==(null==e?void 0:e.gapIndex)&&(n.gapIndex=e.gapIndex),n}return r}(v.a);t.a=g},"2b3a8fd0d8":function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return b}));r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("826dc923b3"),r("75563bc376"),r("342844cefa"),r("8e7cce0ada"),r("29f8c5f672"),r("c6244f7705"),r("85d48ef22b"),r("2a6f332b5e"),r("8ee19818c4"),r("7eaa8e90a5"),r("b4638a0243"),r("6e20b6a7d8"),r("963f2eaace"),r("b684da8955")),d=r("7b0ebf3e1a"),s=r("c6c7cf6a47"),f=r("8e31e67bb3"),h=r("f9193d718f");function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=function(){function e(){var t=this;i()(this,e),u()(this,"rootGroupModel",void 0),u()(this,"adjustedGroupInfoArr",void 0),u()(this,"modifyChildFrameWithShapeAutoFit",(function(e,r){if(t.isShapeAutoFitChildResized(e)&&e.operationFrame){var n=s.a.getInstance().adjustShape(e,{style:r},t.getEditingStateManager().resizeMode).style;e.operationFrame=n,r=n}return r})),u()(this,"checkChildModelNeedChangeWidthHeight",(function(e){if(!e.rotate)return!1;var t=1===(null==e?void 0:e.flipH)?1:0,r=1===(null==e?void 0:e.flipV)?1:0;return Object(d.g)(e.rotate,t,r)})),u()(this,"getChildRectEdge",(function(e,t){var r={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height};return t=t?{left:Math.min(r.left,t.left),top:Math.min(r.top,t.top),right:Math.max(r.right,t.right),bottom:Math.max(r.bottom,t.bottom)}:v({},r)})),u()(this,"getGroupUpdatedFrame",(function(e,r){var n,i,o,a,l=e.props.style,u=e.getFrame().getScaleRelativeToSlide(),c=r.right-r.left,s=r.bottom-r.top,f=l.width-c-r.left,h=l.height-s-r.top,p={frame:{left:l.left+(l.flipH?f:r.left),top:l.top+(l.flipV?h:r.top),width:c,height:s},childFrame:{left:(null!==(n=null===(i=e.props.childFrame)||void 0===i?void 0:i.left)&&void 0!==n?n:0)+r.left/u.scaleX,top:(null!==(o=null===(a=e.props.childFrame)||void 0===a?void 0:a.top)&&void 0!==o?o:0)+r.top/u.scaleY,width:c/u.scaleX,height:s/u.scaleY},diffRect:{left:t.formatFloat(r.left),top:t.formatFloat(r.top),width:t.formatFloat(c-l.width),height:t.formatFloat(s-l.height)}};if(l.rotate){var v=Object(d.f)(l),y=Object(d.f)(p.frame),b=l.rotate,g=Object(d.r)(y,v,b),m=g.x-y.x,O=g.y-y.y;p.frame.left+=m,p.frame.top+=O}return p})),u()(this,"getSdkModelFrameInfo",(function(e){var t,r,n,i,o,a,l,u,c,d,s,f,h,p,v,y=0,b=0,g=0;return{rotate:y=(null!==(t=null===(r=e.sdkData)||void 0===r||null===(n=r.props)||void 0===n||null===(i=n.spPr)||void 0===i||null===(o=i.xfrm)||void 0===o?void 0:o.rot)&&void 0!==t?t:y)/6e4,flipH:b=Number(null!==(a=null===(l=e.sdkData)||void 0===l||null===(u=l.props)||void 0===u||null===(c=u.spPr)||void 0===c||null===(d=c.xfrm)||void 0===d?void 0:d.flipH)&&void 0!==a?a:b),flipV:g=Number(null!==(s=null===(f=e.sdkData)||void 0===f||null===(h=f.props)||void 0===h||null===(p=h.spPr)||void 0===p||null===(v=p.xfrm)||void 0===v?void 0:v.flipV)&&void 0!==s?s:g)}})),u()(this,"isGroupFrameChange",(function(e){return!!Object.keys(e).find((function(t){return 0!==e[t]}))})),u()(this,"getUpdateFrameMap",(function(e,t){var r;return t&&(r=new Map,e.forEach((function(e,n){r.set(e.key,null==t?void 0:t[n])}))),r})),u()(this,"getTempFrame",(function(e,t){var r;return null!==(r=null==t?void 0:t.get(e.key))&&void 0!==r?r:e.operationFrame})),u()(this,"formatFloat",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return parseFloat(e.toFixed(t))}))}return a()(e,[{key:"getAdjustedElementsAndProps",value:function(e,t){var r=this,n=this.getUpdateFrameMap(e,t);this.adjustedGroupInfoArr=[],this.rootGroupModel=e[0].rootGroupModel;var i=Object(c.d)(e);return i.forEach((function(e){Object(c.a)(e,(function(e){r.adjustGroupInfo(e,n)}))})),this.rootGroupModel.childResizeFinished=!1,i.forEach((function(e){Object(c.a)(e,(function(e){e.operationFrame=null}))})),this.adjustedGroupInfoArr}},{key:"adjustGroupInfo",value:function(e,t){var r=this.getAdjustedGroupFrameCausedByChildren(e,t);if(!this.isGroupFrameChange(r.diffRect))return e.groupChildFrameChangedByChildren=null,!0;var n={uiModel:e,props:{style:v({},r.frame),childFrame:v({},r.childFrame)}};e.operationFrame=v({},r.frame),e.groupChildFrameChangedByChildren=v({},r.childFrame),this.addAdjusedGroupInfoArr(n),this.modifyChildrenAfterGroupFrameAdjusted(e,r,t)}},{key:"getAdjustedGroupFrameCausedByChildren",value:function(e,t){var r,n=this;return e.children.forEach((function(e){var i=v(v({},e.props.style),n.getTempFrame(e,t));i=n.modifyChildFrameWithShapeAutoFit(e,i),i=n.checkChildModelNeedChangeWidthHeight(e.props.style)?Object(d.j)(i,90):i,r=n.getChildRectEdge(i,r)})),this.getGroupUpdatedFrame(e,r)}},{key:"modifyChildrenAfterGroupFrameAdjusted",value:function(e,t,r){var n=this;e.children.forEach((function(e){var i=n.getTempFrame(e,r),o=v(v({},e.props.style),i),a=n.getSdkModelFrameInfo(e),l=n.checkChildModelNeedChangeWidthHeight(o)!==n.checkChildModelNeedChangeWidthHeight(a);(i||l)&&n.addAdjusedGroupInfoArr({uiModel:e,props:{style:{width:o.width,height:o.height,left:o.left-t.diffRect.left,top:o.top-t.diffRect.top}}})}))}},{key:"isShapeAutoFitChildResized",value:function(e){var t;return s.a.getInstance().enableAdjustText()&&Object(f.c)(e)&&(null===(t=this.rootGroupModel)||void 0===t?void 0:t.childResizeFinished)}},{key:"addAdjusedGroupInfoArr",value:function(e){var t=!1;this.adjustedGroupInfoArr=this.adjustedGroupInfoArr.map((function(r){return r.uiModel===e.uiModel?(t=!0,{uiModel:e.uiModel,props:v(v({},r.props),e.props)}):r})),t||this.adjustedGroupInfoArr.push(e)}},{key:"getEditingStateManager",value:function(){return h.a.getInstance().getAppServices().viewableServiceLayer.editingStateManager}}]),e}(),b=function(){function e(){var t=this;i()(this,e),u()(this,"rootSmartArtModel",void 0),u()(this,"adjustedSmartArtInfoArr",void 0),u()(this,"getUpdateFrameMap",(function(e,t){var r;return t&&(r=new Map,e.forEach((function(e,n){r.set(e.key,null==t?void 0:t[n])}))),r})),u()(this,"getSdkModelFrameInfo",(function(e){var t,r,n,i,o,a,l,u,c,d,s,f,h,p,v,y=0,b=0,g=0;return{rotate:y=(null!==(t=null===(r=e.sdkData)||void 0===r||null===(n=r.props)||void 0===n||null===(i=n.spPr)||void 0===i||null===(o=i.xfrm)||void 0===o?void 0:o.rot)&&void 0!==t?t:y)/6e4,flipH:b=Number(null!==(a=null===(l=e.sdkData)||void 0===l||null===(u=l.props)||void 0===u||null===(c=u.spPr)||void 0===c||null===(d=c.xfrm)||void 0===d?void 0:d.flipH)&&void 0!==a?a:b),flipV:g=Number(null!==(s=null===(f=e.sdkData)||void 0===f||null===(h=f.props)||void 0===h||null===(p=h.spPr)||void 0===p||null===(v=p.xfrm)||void 0===v?void 0:v.flipV)&&void 0!==s?s:g)}})),u()(this,"getSmartArtUpdatedFrame",(function(e,r){var n,i,o,a,l=e.props.style,u=e.getFrame().getScaleRelativeToSlide(),c=r.right-r.left,s=r.bottom-r.top,f=l.width-c-r.left,h=l.height-s-r.top,p={frame:{left:l.left+(l.flipH?f:r.left),top:l.top+(l.flipV?h:r.top),width:c,height:s},childFrame:{left:(null!==(n=null===(i=e.props.childFrame)||void 0===i?void 0:i.left)&&void 0!==n?n:0)+r.left/u.scaleX,top:(null!==(o=null===(a=e.props.childFrame)||void 0===a?void 0:a.top)&&void 0!==o?o:0)+r.top/u.scaleY,width:c/u.scaleX,height:s/u.scaleY},diffRect:{left:t.formatFloat(r.left),top:t.formatFloat(r.top),width:t.formatFloat(c-l.width),height:t.formatFloat(s-l.height)}};if(l.rotate){var v=Object(d.f)(l),y=Object(d.f)(p.frame),b=l.rotate,g=Object(d.r)(y,v,b),m=g.x-y.x,O=g.y-y.y;p.frame.left+=m,p.frame.top+=O}return p})),u()(this,"getChildRectEdge",(function(e,t){var r={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height};return t=t?{left:Math.min(r.left,t.left),top:Math.min(r.top,t.top),right:Math.max(r.right,t.right),bottom:Math.max(r.bottom,t.bottom)}:v({},r)})),u()(this,"checkChildModelNeedChangeWidthHeight",(function(e){if(!e.rotate)return!1;var t=1===(null==e?void 0:e.flipH)?1:0,r=1===(null==e?void 0:e.flipV)?1:0;return Object(d.g)(e.rotate,t,r)})),u()(this,"modifyChildFrameWithShapeAutoFit",(function(e,r){if(t.isShapeAutoFitChildResized(e)&&e.operationFrame){var n=s.a.getInstance().adjustShape(e,{style:r},t.getEditingStateManager().resizeMode).style;e.operationFrame=n,r=n}return r})),u()(this,"isSmartArtFrameChange",(function(e){return!!Object.keys(e).find((function(t){return 0!==e[t]}))})),u()(this,"getTempFrame",(function(e,t){var r;return null!==(r=null==t?void 0:t.get(e.key))&&void 0!==r?r:e.operationFrame})),u()(this,"formatFloat",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return parseFloat(e.toFixed(t))}))}return a()(e,[{key:"getAdjustedElementsAndProps",value:function(e,t){var r=this,n=this.getUpdateFrameMap(e,t);this.adjustedSmartArtInfoArr=[],this.rootSmartArtModel=e[0].rootSmartArtModel;var i=e.slice(0,1);return i.forEach((function(e){Object(c.c)(e,(function(e){r.adjustSmartArtInfo(e,n)}))})),this.rootSmartArtModel.childResizeFinished=!1,i.forEach((function(e){Object(c.c)(e,(function(e){e.operationFrame=null}))})),this.adjustedSmartArtInfoArr}},{key:"adjustSmartArtInfo",value:function(e,t){var r=this.getAdjustedSmartArtFrameCausedByChildren(e,t);if(!this.isSmartArtFrameChange(r.diffRect))return e.groupChildFrameChangedByChildren=null,!0;var n={uiModel:e,props:{style:v({},r.frame),childFrame:v({},r.childFrame)}};e.operationFrame=v({},r.frame),e.groupChildFrameChangedByChildren=v({},r.childFrame),this.addAdjusedSmartArtInfoArr(n),this.modifyChildrenAfterSmartArtFrameAdjusted(e,r,t)}},{key:"modifyChildrenAfterSmartArtFrameAdjusted",value:function(e,t,r){var n=this;e.shapeList.forEach((function(e){var i=n.getTempFrame(e,r),o=v(v({},e.props.style),i),a=n.getSdkModelFrameInfo(e),l=n.checkChildModelNeedChangeWidthHeight(o)!==n.checkChildModelNeedChangeWidthHeight(a);(i||l)&&n.addAdjusedSmartArtInfoArr({uiModel:e,props:{style:{width:o.width,height:o.height,left:o.left-t.diffRect.left,top:o.top-t.diffRect.top}}})}))}},{key:"getAdjustedSmartArtFrameCausedByChildren",value:function(e,t){var r,n=this;return e.shapeList.forEach((function(e){var i=v(v({},e.props.style),n.getTempFrame(e,t));i=n.modifyChildFrameWithShapeAutoFit(e,i),i=n.checkChildModelNeedChangeWidthHeight(e.props.style)?Object(d.j)(i,90):i,r=n.getChildRectEdge(i,r)})),this.getSmartArtUpdatedFrame(e,r)}},{key:"addAdjusedSmartArtInfoArr",value:function(e){var t=!1;this.adjustedSmartArtInfoArr=this.adjustedSmartArtInfoArr.map((function(r){return r.uiModel===e.uiModel?(t=!0,{uiModel:e.uiModel,props:v(v({},r.props),e.props)}):r})),t||this.adjustedSmartArtInfoArr.push(e)}},{key:"isShapeAutoFitChildResized",value:function(e){var t;return s.a.getInstance().enableAdjustText()&&Object(f.c)(e)&&(null===(t=this.rootSmartArtModel)||void 0===t?void 0:t.childResizeFinished)}},{key:"getEditingStateManager",value:function(){return h.a.getInstance().getAppServices().viewableServiceLayer.editingStateManager}}]),e}()},"2ba7871556":function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return o}));var n,i,o,a,l="fill-color";!function(e){e.NoFill="noFill",e.SolidFill="solidFill",e.GradualFill="gradFill",e.ImageFill="image",e.PattFill="pattFill"}(n||(n={})),function(e){e.Linear="linear",e.Radial="circle",e.Rect="rect",e.Shape="shape"}(i||(i={})),function(e){e.NONE="none",e.xy="xy",e.x="x",e.y="y"}(o||(o={})),function(e){e.TL="tl",e.TR="tr",e.BL="bl",e.BR="br",e.T="t",e.L="l",e.CTR="ctr",e.R="r",e.B="b"}(a||(a={}))},"2c0f58c21b":function(e,t,r){"use strict";r("73b854064b");var n=r("176815363d"),i=r.n(n),o=r("7a5536c9bf"),a=r.n(o),l=r("1f925d7f50"),u=r.n(l),c=r("9132715560"),d=r.n(c),s=r("6a364eb35c"),f=r.n(s),h=r("547611bd96"),p=r.n(h),v=r("bd29e2df90"),y=r.n(v),b=r("ab5eb40518"),g=r.n(b),m=r("8eec1e4a03"),O=r.n(m),k=r("1b4cdd6a36"),S=r.n(k),P=r("85d0a7609b"),C=r.n(P),R=r("2dc700e1e6"),A=r.n(R),M=(r("f1054791f4"),r("3ef2352f0b")),T=r.n(M),D=(r("0acdc5834b"),r("3bf1976a4f"),r("c6244f7705"),r("081c8cafea"),r("8e7cce0ada"),r("85d48ef22b"),r("2a6f332b5e"),r("8ee19818c4"),r("e0e8dd9366")),F=r("ee6bb53310"),E=r.n(F),I=r("643327d0e9"),j=r("b684da8955"),w=r("db8665b60e"),x=r("0518261faf"),L=r("d5c3deb8c7"),B=r("e5a826a0ff"),N=r("4e55019e41"),U=r("2b3a8fd0d8");function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=S()(e);if(t){var i=S()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var _,V,H=function(e){y()(r,e);var t=G(r);function r(e){var n;return d()(this,r),n=t.call(this,e),C()(p()(n),"adjustGroupFrameInfo",void 0),C()(p()(n),"groupModel",void 0),n.groupModel=e,n}return f()(r,[{key:"getAdjustedElementsAndProps",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(e=null===(t=this.groupModel.selectionService)||void 0===t?void 0:t.selectedElements.selectedArrayForType(B.a.GROUP))&&void 0!==e?e:[],n=arguments.length>1?arguments[1]:void 0;return this.adjustGroupFrameInfo||(this.adjustGroupFrameInfo=new U.a),this.adjustGroupFrameInfo.getAdjustedElementsAndProps(r,n)}},{key:"clearTempInfosWithElement",value:function(e){Object(j.a)(e,(function(e){e.groupChildFrameChangedByChildren&&(e.groupChildFrameChangedByChildren=null)}))}},{key:"getScaleRelativeToSlide",value:function(){var e,t=this,r=[];r.push({scaleX:this.groupModel.scaleX,scaleY:this.groupModel.scaleY,rotate:null!==(e=this.groupModel.props.style.rotate)&&void 0!==e?e:0}),Object(j.a)(this.groupModel,(function(e){var n;r.push({scaleX:e.scaleX,scaleY:e.scaleY,rotate:null!==(n=t.groupModel.props.style.rotate)&&void 0!==n?n:0})}));var n=r.reverse(),i={scaleX:1,scaleY:1};return n.forEach((function(e){if(t.needChange(e.rotate)){var r=i.scaleX;i.scaleX=i.scaleY,i.scaleY=r}i.scaleX*=e.scaleX,i.scaleY*=e.scaleY})),i}},{key:"needChange",value:function(e){return e>=45&&e<135||e>=225&&e<315}}]),r}(N.a),z=r("e388ef2636"),W=r("ada2323558"),Y=r("c9c92622ff"),K=r("efe327c706");function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=S()(e);if(t){var i=S()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var q=(_=function(e){y()(n,e);var t,r=X(n);function n(e){var t;return d()(this,n),t=r.call(this,e),C()(p()(t),"sdkData",null),u()(p()(t),"refreshGroupByChildrenWithoutChangeSet",V,p()(t)),C()(p()(t),"groupChildFrameChangedByChildren",void 0),C()(p()(t),"childResizeFinished",!1),C()(p()(t),"groupFrameInstance",void 0),C()(p()(t),"groupReFreshMenuInstance",void 0),t.type=D.d.GROUP,t.props.childFrame={left:0,top:0,width:0,height:0},t}return f()(n,[{key:"unbindSDK",value:function(){var e;O()(S()(n.prototype),"unbindSDK",this).call(this),null===(e=this.groupReFreshMenuInstance)||void 0===e||e.removeRefreshGroupItemValues();for(var t=0;t<this.children.length;t++){var r;null===(r=this.children[t])||void 0===r||r.unbindSDK()}}},{key:"getGifsInGroup",value:function(){return function e(t){return null==t?void 0:t.children.reduce((function(t,r){return Object(Y.l)(r)?t.concat(r):Object(Y.n)(r)?t.concat.apply(t,a()(e(r))):t}),[])}(this)}},{key:"scaleX",get:function(){var e,t,r,n,i,o,a,l,u,c,d,s,f,h,p,v=null===(e=this.sdkData)||void 0===e||null===(t=e.props)||void 0===t||null===(r=t.spPr)||void 0===r||null===(n=r.xfrm)||void 0===n||null===(i=n.chExt)||void 0===i?void 0:i.cx;return void 0!==(null===(o=this.sdkData)||void 0===o||null===(a=o.props)||void 0===a||null===(l=a.spPr)||void 0===l||null===(u=l.xfrm)||void 0===u||null===(c=u.ext)||void 0===c?void 0:c.cx)&&void 0!==v&&v>0?(null===(d=this.sdkData)||void 0===d||null===(s=d.props)||void 0===s||null===(f=s.spPr)||void 0===f||null===(h=f.xfrm)||void 0===h||null===(p=h.ext)||void 0===p?void 0:p.cx)/v:1}},{key:"scaleY",get:function(){var e,t,r,n,i,o,a,l,u,c,d,s,f,h,p,v=null===(e=this.sdkData)||void 0===e||null===(t=e.props)||void 0===t||null===(r=t.spPr)||void 0===r||null===(n=r.xfrm)||void 0===n||null===(i=n.chExt)||void 0===i?void 0:i.cy;return void 0!==(null===(o=this.sdkData)||void 0===o||null===(a=o.props)||void 0===a||null===(l=a.spPr)||void 0===l||null===(u=l.xfrm)||void 0===u||null===(c=u.ext)||void 0===c?void 0:c.cy)&&void 0!==v&&v>0?(null===(d=this.sdkData)||void 0===d||null===(s=d.props)||void 0===s||null===(f=s.spPr)||void 0===f||null===(h=f.xfrm)||void 0===h||null===(p=h.ext)||void 0===p?void 0:p.cy)/v:1}},{key:"isRootGroup",get:function(){var e=!0;return Object(j.a)(this,(function(){return e=!1,!0})),e}},{key:"getFrame",value:function(){return this.groupFrameInstance||(this.groupFrameInstance=new H(this)),this.groupFrameInstance}},{key:"shape3d",get:function(){return this.get3DProperty().getGroupShape3D()},set:function(e){}}],[{key:"convertDataUiToSdk",value:function(e,t,r){K.a.convertUiToSdk({type:D.d.GROUP,uiData:e,sdkData:t,rawUiData:r})}},{key:"convertDataSdkToUi",value:(t=i()(T.a.mark((function e(t,r,i,o){var a,l,u,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O()(S()(n),"convertDataSdkToUi",this).call(this,t,r,i,o),l=[],u=K.a.convertSdkToUi({type:D.d.GROUP,sdkData:t,uiData:r}),l.push(u),null!=t&&t.shapeList&&(null==t?void 0:t.shapeList.length)>0&&(c=I.a.convertArrayDataSdkToUi(w.b,i.shapeList,r.children,r,o),l.push(c)),null===(a=r.parent)||void 0===a||!a.asyncConvertChildren){e.next=9;break}return e.next=8,Promise.all(l);case 8:E()(r,"asyncConvertChildren",!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i){return t.apply(this,arguments)})},{key:"didConvertDataSdkToUi",value:function(e,t,r,i){var o,a,l,u,c,d;O()(S()(n),"didConvertDataSdkToUi",this).call(this,e,t,r,i);!function e(t){t.children.forEach((function(t){t.type===D.d.GROUP&&e(t),t.resetFrame()}))}(t),!(null!==(o=e.props.spPr)&&void 0!==o&&o.solidFill||null!==(a=e.props.spPr)&&void 0!==a&&a.gradFill||null!==(l=e.props.spPr)&&void 0!==l&&l.blipFill||null!==(u=e.props.spPr)&&void 0!==u&&u.pattFill||null!==(c=e.props.spPr)&&void 0!==c&&c.noFill)||null!==(d=e.props.spPr)&&void 0!==d&&d.grpFill||new x.b(t).adjustChildBg(e.props.spPr),t.isRootGroup&&(t.groupReFreshMenuInstance=new z.a(t),t.groupReFreshMenuInstance.addRefreshGroupItemValues())}}]),n}(W.a),V=A()(_.prototype,"refreshGroupByChildrenWithoutChangeSet",[L.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_);t.a=q},"304396ad9f":function(e,t,r){"use strict";r.d(t,"b",(function(){return R})),r.d(t,"c",(function(){return A})),r.d(t,"a",(function(){return M})),r.d(t,"d",(function(){return T}));r("73b854064b"),r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("14502724a6"),i=r.n(n),o=r("547611bd96"),a=r.n(o),l=r("bd29e2df90"),u=r.n(l),c=r("ab5eb40518"),d=r.n(c),s=r("1b4cdd6a36"),f=r.n(s),h=r("9132715560"),p=r.n(h),v=r("6a364eb35c"),y=r.n(v),b=r("85d0a7609b"),g=r.n(b),m=(r("6e20b6a7d8"),r("b8217400dc"),r("e6f68cdf2e"),r("1bab7b5fb7"),r("9d7978d445"),r("34cd92f77a"),r("433247001a"),r("bd80bf2d0f"),r("826dc923b3"),r("f9193d718f")),O=r("d3d31c86eb"),k=r("9da6335152");function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){g()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var i=f()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}var R="tailor-pic",A=["normal","1-1","2-3","3-4","3-5","4-5","3-2","4-3","5-3","5-4","16-9","16-10"].map((function(e){return"".concat(R,"-").concat(e)})),M=function(){function e(t){p()(this,e),g()(this,"model",void 0),this.model=t}return y()(e,[{key:"cropWithShape",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"parallelogram";if(this.model.props.style.bgShape!==e){var t={bgShape:e,controlValues:[]};this.model.operatingGraphicInfo={controlValues:[]},this.model.getGraphic().updateGraphicInfo(t),Object(O.c)({opername:k.e.DOC_PPT,module:k.d.PC_OBJ,action:k.b.IMG_CUT})}}}]),e}(),T=function(e){u()(r,e);var t=C(r);function r(e){var n;return p()(this,r),n=t.call(this,e),g()(a()(n),"picModel",void 0),g()(a()(n),"cropWithWH",(function(e,t){var r,i,o,a=n.picModel.props.style,l=a.width,u=a.height,c=n.picModel.props.style,d=c.top,s=c.left,f=l,h=u,p=e/t,v=0,y=0;p>l/u?d+=y=u-(h=l/p)>>1:s+=v=l-(f=u*p)>>1;var b=n.picModel.props.style.srcRect;if(b){var g=n.picModel.getImageSize().getForegroundImageSize({width:l,height:u,srcRect:b}),m=g.pl,O=g.pr,k=g.pt,S=g.pb;m+=v,O+=v,k+=y,S+=y,b.l=m/(f+O+m),b.r=O/(f+O+m),b.t=k/(h+S+k),b.b=S/(h+S+k)}else b={b:0,t:0,l:0,r:0};var C=[{style:{top:d,left:s,width:f,height:h,srcRect:P({},b)}}];null===(r=n.picModel.selectionService)||void 0===r||null===(i=r.currentSlide)||void 0===i||i.updateElementsProps(C,[n.picModel]),null===(o=n.getBorderSketchManager())||void 0===o||o.updatePathListWhenSizeChange(n.picModel,C[0])})),n.picModel=e,n}return y()(r,[{key:"handleCrop",value:function(e){if(e&&A.includes(e)){if(e!=="".concat(R,"-normal")){var t=e.replace(new RegExp("".concat(R,"-")),"").split("-"),r=i()(t,2),n=r[0],o=r[1];this.cropWithWH(Number(n),Number(o))}this.getEditingStateManager().updateElementCropState(!0),Object(O.c)({opername:k.e.DOC_PPT,module:k.d.PC_OBJ,action:k.b.IMG_CUT})}}},{key:"getEditingStateManager",value:function(){return m.a.getInstance().getAppServices().viewableServiceLayer.editingStateManager}},{key:"getBorderSketchManager",value:function(){var e;return null===(e=m.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.borderSketchManager}}]),r}(M)},"314691d29d":function(e,t,r){"use strict";r.d(t,"a",(function(){return Br}));var n,i,o,a=r("9132715560"),l=r.n(a),u=r("6a364eb35c"),c=r.n(u),d=r("85d0a7609b"),s=r.n(d),f=(r("75563bc376"),r("6e20b6a7d8"),r("73b854064b"),r("342844cefa"),r("a84962d637"),r("c554310b5c"),r("bcb5d93d36"),r("14502724a6")),h=r.n(f),p=r("7a5536c9bf"),v=r.n(p),y=r("547611bd96"),b=r.n(y),g=r("bd29e2df90"),m=r.n(g),O=r("ab5eb40518"),k=r.n(O),S=r("1b4cdd6a36"),P=r.n(S);r("3bf1976a4f"),r("8ee19818c4"),r("8e7cce0ada"),r("c6244f7705"),r("2a6f332b5e"),r("b1e2246d82"),r("c9a7ecac4d"),r("85d48ef22b"),r("8a35b54c1d"),r("b8217400dc"),r("e6f68cdf2e");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var R,A=(n=Reflect.metadata("design:type",Function),i=Reflect.metadata("design:paramtypes",["undefined"==typeof UIData?Object:UIData,"undefined"==typeof ChartContext?Object:ChartContext]),function(e){m()(r,e);var t=C(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),k()(e,new Proxy(b()(e),{get:function(e,t){var r;return t in e?e[t]:null===(r=e.uiData)||void 0===r?void 0:r[t]}}))}return r}(o=n(o=i(o=function(){function e(t,r){l()(this,e),this.uiData=t,this.context=r}return c()(e,[{key:"init",value:function(){return this}}]),e}())||o)||o)||o);!function(e){e.PRIMARY_HORIZONTAL="PRIMARY_HORIZONTAL",e.PRIMARY_VERTICAL="PRIMARY_VERTICAL",e.SECONDARY_HORIZONTAL="SECONDARY_HORIZONTAL",e.SECONDARY_VERTICAL="SECONDARY_VERTICAL"}(R||(R={}));var M=r("9657b29818"),T=r("4843dab469"),D=r.n(T),F=r("b6b6421f89"),E=(r("963f2eaace"),r("8aebbf296a"),r("f45588a8ad"),r("de37db1287"),r("22569efd03"),r("405b4a5e2b"),r("826dc923b3"),r("504c89f6b9"),r("eb5df5b33c"),r("24d5b39d83")),I=r.n(E),j=r("67d3be6cf9"),w=r.n(j),x=r("44c7584d18"),L=r("d3d31c86eb"),B=r("9da6335152"),N=r("8eec1e4a03"),U=r.n(N),G=(r("1bab7b5fb7"),r("0aeae65bf4"),r("a7888a8b87")),_=r.n(G),V=r("75d6c5598b"),H=r("eabf3daf43"),z=r("e9b1a65b0e"),W=r("6c6f5e596f"),Y=r("5f9ccff4fc"),K=r("96745b5cc3"),X=r("5435d2ca10"),q=r("14c02e2331"),Z=r("75f19a1449"),J=r("a0d2dff58b");function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var te=function(e){m()(r,e);var t=ee(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"borderInstance",void 0),s()(b()(e),"fillInstance",void 0),s()(b()(e),"effectInstance",void 0),e}return c()(r,[{key:"props",get:function(){return this.uiData.props}},{key:"getBorder",value:function(){return!this.borderInstance&&this.uiData&&(this.borderInstance=new z.a(this.uiData)),this.borderInstance}},{key:"getBackgroundFill",value:function(){return this.fillInstance||(this.fillInstance=new W.a(this.uiData)),this.fillInstance}},{key:"getEffect",value:function(){return this.effectInstance||(this.effectInstance=new J.a(this.uiData)),this.effectInstance}},{key:"updateBorder",value:function(e){var t={style:{border:e}},r=K.a.convertToUpdateAndRemove(t,this.uiData.props),n={props:r.update},i=r.remove?{props:r.remove}:void 0;this.updateProps(n,i)}},{key:"updateFill",value:function(e){var t={style:{fillBackground:e}},r=K.a.convertToUpdateAndRemove(t,this.uiData.props),n={props:r.update},i=r.remove?{props:r.remove}:void 0;this.updateProps(n,i)}},{key:"updateEffect",value:function(e){var t=J.a.getEffectUpdateRemove(e),r={props:t.update},n=t.remove?{props:t.remove}:void 0;this.updateProps(r,n)}}]),r}(A),re=function(e){m()(r,e);var t=ee(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"text",get:function(){return this.uiData.text}},{key:"paragraphList",get:function(){return this.uiData.paragraphList}},{key:"textBodyStyle",get:function(){return this.uiData.textBodyStyle}},{key:"getParagraphList",value:function(e){var t,r,n,i,o=this.text,a=this.paragraphList,l=e||{},u=l.content,c=void 0===u?"":u,d=l.textAlign,s=void 0===d?"left":d,f=l.level,h=void 0===f?0:f;return o?(null===(t=o.paragraphList)||void 0===t?void 0:t.map((function(e){var t;return $($({},e),{},{paragraphProps:$($({textAlign:s},null==e?void 0:e.paragraphProps),{},{level:h}),textRuns:null===(t=e.textRuns)||void 0===t?void 0:t.map((function(t){var r;return $($({},t),{},{styles:$($({},null===(r=e.paragraphProps)||void 0===r?void 0:r.defaultRunProps),t.styles)})}))})})))||[]:[$($({},null==a?void 0:a[0]),{},{paragraphProps:$($({textAlign:s},null==a||null===(r=a[0])||void 0===r?void 0:r.paragraphProps),{},{level:h}),textRuns:[{text:c,styles:$({},null==a||null===(n=a[0])||void 0===n||null===(i=n.paragraphProps)||void 0===i?void 0:i.defaultRunProps),type:"run"}]})]}},{key:"getTextBodyStyle",value:function(e){var t,r,n,i,o=e||{},a=o.noDefaultPadding,l=void 0!==a&&a,u=o.anchorCenter,c=void 0!==u&&u,d=o.alignItems,s=this.text,f=this.textBodyStyle;s&&(f=s.textBodyStyle);var h=l?0:q.g,p=l?0:q.e,v=l?0:q.f,y=(f||{}).bodyStyle,b=null!==(t=null==y?void 0:y.paddingLeft)&&void 0!==t?t:v,g=null!==(r=null==y?void 0:y.paddingTop)&&void 0!==r?r:h,m=null!==(n=null==y?void 0:y.paddingRight)&&void 0!==n?n:v,O=null!==(i=null==y?void 0:y.paddingBottom)&&void 0!==i?i:p,k=$($({},y),{},{paddingLeft:b,paddingRight:m,paddingTop:g,paddingBottom:O});f=$($({},f),{},{bodyStyle:k});var S=$($({},(f||{}).wrapperStyle),{},{justifyContent:c?"center":"start"});return d&&(S.alignItems=d),f=$($({},f),{},{wrapperStyle:S})}},{key:"getTextContent",value:function(){var e=this.getParagraphList();return Object(H.f)(e)}},{key:"getTextFontFamily",value:function(){var e,t,r=this.getTextStyles();return(null==r?void 0:r.fontFamily)||(null==r||null===(e=r.fonts)||void 0===e?void 0:e.ea)||(null==r||null===(t=r.fonts)||void 0===t?void 0:t.latin)||""}},{key:"getTextFontColor",value:function(){var e=this.getTextStyles();return(null==e?void 0:e.tdColor)||new Z.a}},{key:"getTextFontSize",value:function(){var e=this.getTextStyles();return(null==e?void 0:e.fontSize)||18}},{key:"getTextFontBold",value:function(){var e=this.getTextStyles();return"bold"===(null==e?void 0:e.fontWeight)}},{key:"getTextFontItalic",value:function(){var e=this.getTextStyles();return"italic"===(null==e?void 0:e.fontStyle)}},{key:"getUpdatedTextProps",value:function(e,t){var r=this.createUpdatedText(e,t),n=r.defParaList,i=r.richParaList;return this.createUpdatedProps(n,i)}},{key:"updateFontStyle",value:function(e,t){var r=this.createUpdatedText(e,t),n=r.defParaList,i=r.richParaList;this.updateParagraphList(n,i)}},{key:"updateParagraphList",value:function(e,t){var r=this.createUpdatedProps(e,t);this.updateProps(r)}},{key:"getUpdatedParagraphLsit",value:function(e,t,r){var n=[];switch(t){case Y.a.FONTFAMILY:n=Object(H.s)(_()(e),r);break;case Y.a.FONT_COLOR:var i,o;null!=r&&r.srgb_color&&(r.srgb_color=null===(i=(o=r.srgb_color).toUpperCase)||void 0===i?void 0:i.call(o)),n=Object(V.b)(e,r);break;case Y.a.FONT_SIZE:var a=r.match(/-([\d|\\.]*)pt/);if(!a)return;var l=Number(a[1]);n=Object(V.c)(e,{fontSize:l});break;case Y.a.FONT_SIZE_UP:case Y.a.FONT_SIZE_DOWN:var u=r.size,c=r.min||8,d=r.max||192;n=this.setFontSizeIncrease(e,u,c,d);break;case Y.a.BOLD:n=Object(V.c)(e,{fontWeight:r?"bold":"normal"});break;case Y.a.ITALIC:n=Object(V.c)(e,{fontStyle:r?"italic":"normal"})}return n}},{key:"getTextStyles",value:function(){var e=this,t=this.getParagraphList(),r=this.getTextBodyStyle(),n=[];return Array.isArray(t)&&t.forEach((function(t){var i=t.paragraphProps,o=void 0===i?{}:i,a=t.textRuns;null==a||a.forEach((function(t){var i=t.styles,a=void 0===i?{}:i;n.push(e.combineStyles(r,o,a))}))})),Object(X.a)(n)}},{key:"setFontSizeIncrease",value:function(e,t,r,n){var i=this;return e.map((function(e,o){var a,l,u=i.getTextFontSize()+t;(u>n&&(u=n),u<r&&(u=r),e.textRuns=null===(a=e.textRuns)||void 0===a?void 0:a.map((function(e,t){return e.styles=$({},e.styles),e.styles.fontSize=u,e.styles["raw-fontSize"]=!0,e})),null!==(l=e.paragraphProps)&&void 0!==l&&l.defaultRunProps)&&(e.paragraphProps.defaultRunProps.fontSize=u);return e}))}},{key:"createDefaultParagraphList",value:function(){return[{paragraphProps:{defaultRunProps:{}},textRuns:[]}]}},{key:"createUpdatedText",value:function(e,t){var r,n=this.text,i=this.paragraphList,o=void 0===i?[]:i,a=null==n?void 0:n.paragraphList;null!==(r=o)&&void 0!==r&&r.length||a||(o=this.createDefaultParagraphList());var l,u=this.getUpdatedParagraphLsit(o,e,t);return null!=a&&a.length&&(l=this.getUpdatedParagraphLsit(a,e,t)),{defParaList:u,richParaList:l}}},{key:"createUpdatedProps",value:function(e,t){var r={};return null!=e&&e.length&&(r.paragraphList=e),null!=t&&t.length&&(r.text={paragraphList:t}),r}},{key:"combineStyles",value:function(e,t,r){return $($($($({textAlign:"left",PPTLineHeight:1,lineHeight:1.2},r),t),null==e?void 0:e.wrapperStyle),null==e?void 0:e.bodyStyle)}}]),r}(te),ne=function(e){m()(r,e);var t=ee(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"defaultLineFill",void 0),e}return r}(te),ie=r("5fac0349d3");function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var ue=function(e){m()(r,e);var t=le(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"parentProperty",void 0),e}return c()(r,[{key:"init",value:function(e){return this.parentProperty=e,this}},{key:"updateProps",value:function(e){this.parentProperty.updateProps({title:e})}},{key:"getTitleText",value:function(){var e=this.getParagraphList();return Object(H.f)(e)}},{key:"updateTitleText",value:function(e){var t,r;if(""!==e){var n=this.getParagraphList();this.parentProperty.updateProps({title:{text:{paragraphList:[ae(ae({},n[0]),{},{textRuns:[ae(ae({},null==n||null===(t=n[0])||void 0===t||null===(r=t.textRuns)||void 0===r?void 0:r[0]),{},{text:e})]})]}}})}else this.parentProperty.removeAxisTitle()}},{key:"getParagraphList",value:function(e){return U()(P()(r.prototype),"getParagraphList",this).call(this,null!=e?e:{content:ie.a.t("坐标轴标题"),level:1,textAlign:"center"})}}]),r}(re);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var de=function(e){m()(r,e);var t=ce(r);function r(e,n,i){var o;return l()(this,r),o=t.call(this,e,n),s()(b()(o),"defaultLineFill","#868687"),s()(b()(o),"parentProperty",void 0),o.uiData=e,o.context=n,o.gridlinesType=i,o}return c()(r,[{key:"init",value:function(e){return this.parentProperty=e,this}},{key:"updateProps",value:function(e,t){this.parentProperty.updateProps(s()({},this.gridlinesType,e),t?s()({},this.gridlinesType,t):void 0)}}]),r}(ne),se=r("116dfe1d48"),fe=r("3c97670bd6");function he(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw o}}}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var ge=function(e){m()(r,e);var t=be(r);function r(e,n){var i;return l()(this,r),i=t.call(this,e,n),s()(b()(i),"type",void 0),s()(b()(i),"index",void 0),s()(b()(i),"name",void 0),s()(b()(i),"title",void 0),s()(b()(i),"majorGridlines",void 0),s()(b()(i),"minorGridlines",void 0),s()(b()(i),"values",void 0),s()(b()(i),"scale",void 0),s()(b()(i),"ticks",void 0),s()(b()(i),"isDelete",void 0),s()(b()(i),"autoLabeled",void 0),i.uiData=e,i.context=n,i}return c()(r,[{key:"init",value:function(){this.index=this.uiData.index||0,this.isDelete=!!this.uiData.isDelete,this.autoLabeled=!!this.uiData.autoLabeled,this.type=this.uiData.type;var e=this.uiData.title;e&&(this.title=new ue(e,this.context).init(this));var t=this.uiData.majorGridlines;t&&(this.majorGridlines=new de(t,this.context,F.b.MAJOR_GRID).init(this));var r=this.uiData.minorGridlines;return r&&(this.minorGridlines=new de(r,this.context,F.b.MINOR_GRID).init(this)),this}},{key:"setAxisName",value:function(e){this.name=e}},{key:"setValues",value:function(e,t){this.values=e,this.setScale(t),this.setTicks()}},{key:"setScale",value:function(e){this.scale=this.getScale(this.uiData,e)}},{key:"updateProps",value:function(e,t){var r=this,n=this.getRelativeSubCharts();Object(M.b)((function(){null==n||n.map((function(n){var i=n.axes.findIndex((function(e){return e.axId===r.uiData.axId})),o={};if(e){var a=new Array(i+1).fill(void 0);a[i]=ye(ye({},e),{},{type:r.type}),o.axes=a}var l={};if(t){var u=new Array(i+1).fill(void 0);u[i]=ye(ye({},t),{},{type:r.type}),l.axes=u}n.updateProps(o,l)}))}))}},{key:"getBorder",value:function(){}},{key:"getBackgroundFill",value:function(){}},{key:"showAxis",value:function(){this.name===R.SECONDARY_HORIZONTAL?this.updateProps({isDelete:!1,position:se.a.t}):this.updateProps({isDelete:!1})}},{key:"hideAxis",value:function(){this.updateProps({isDelete:!0})}},{key:"createAxisTitle",value:function(){this.updateProps({title:fe.a.createAxisTitle()})}},{key:"removeAxisTitle",value:function(){this.updateProps(void 0,{title:null})}},{key:"createGridlines",value:function(e){var t={};e.forEach((function(e){t[e]=fe.a.createGridlines(e)})),this.updateProps(t)}},{key:"removeGridlines",value:function(e){var t={};e.forEach((function(e){t[e]=null})),this.updateProps(void 0,t)}},{key:"getRelativeSubCharts",value:function(){var e=this.uiData.axId;if(e){var t=this.context.getPropertyModule("subCharts");return null==t?void 0:t.filter((function(t){var r;return null===(r=t.axisIds)||void 0===r?void 0:r.includes(e)}))}}},{key:"getScale",value:function(e,t){var r=t?t[0]:Math.min.apply(Math,v()(this.values)),n=t?t[1]:Math.max.apply(Math,v()(this.values)),i=e.scaling||{},o=i.max,a=i.min,l=i.logBase,u=e.majorUnit,c=e.minorUnit;return this.calcMinMaxAndUnit(n,r,o,a,u,c,l)}},{key:"setTicks",value:function(){if(this.scale){var e=(this.scaling||{}).logBase,t=this.scale,r=t.max,n=t.majorUnit,i=t.min;this.ticks=this.getAxisTicks(r,i,n,e)}}},{key:"calcMinMaxAndUnit",value:function(e,t,r,n,i,o,a){var l,u,c,d,s,f={max:r,min:n,majorUnit:i,minorUnit:o};if(isNaN(Number(e))||isNaN(Number(t))||!Number.isFinite(e)||!Number.isFinite(t))return f;if(e=this.formatNumber(e),t=this.formatNumber(t),r=this.formatNumber(r),n=this.formatNumber(n),i=this.formatNumber(i),o=this.formatNumber(o),a){var h,p,v,y,b;e=null!==(h=e)&&void 0!==h?h:1,t=null!==(p=t)&&void 0!==p?p:1;var g=null!==(v=r)&&void 0!==v?v:Math.max(e,1),m=null!==(y=n)&&void 0!==y?y:Math.min(t,1);return i=i||a,{max:g=Math.pow(i,Math.ceil(this.mathLogBase(g,i))),min:m=Math.pow(i,Math.floor(this.mathLogBase(m,i)))||1,majorUnit:i,minorUnit:null!==(b=o)&&void 0!==b?b:i}}e=null!==(l=e)&&void 0!==l?l:0,t=null!==(u=t)&&void 0!==u?u:0;var O=null!==(c=r)&&void 0!==c?c:Math.max(e,0),k=null!==(d=n)&&void 0!==d?d:Math.min(t,0);if(w()(r)||w()(n)){var S,P,C=(null!==(S=r)&&void 0!==S?S:e)-(null!==(P=n)&&void 0!==P?P:t),R=1/6;C&&C/Math.max(Math.abs(e),Math.abs(t))<=R&&(O>0&&w()(n)?k=(e-t/R)/-5:k<0&&w()(r)&&(O=(t-e/R)/-5))}var A=i,M=I.a.sub(O,k);if(!M||!Number(M))return f;for(var T,D,F=M.div(5),E=M.div(10),j=[1,2,5],x=Number(E.abs().log(10).floor()),L=Date.now();!A&&x<=Number(F);){if(Date.now()-L>500)return this.reportAxisCalculateError({maxValue:e,minValue:t,settingMax:r,settingMin:n,majorUnit:i,minorUnit:o,logBase:a}),f;var B,N=he(j);try{for(N.s();!(B=N.n()).done;){var U=B.value*Math.pow(10,x);if(4*U<=Number(M)&&10*U>Number(M)){A=U;break}}}catch(e){N.e(e)}finally{N.f()}x+=1}if(!A)return f;if(void 0!==r&&void 0!==n)T=r,D=n;else if(void 0!==r){T=r;var G=I.a.mod(T,A).isZero()?0:I.a.mod(T,A).minus(A);D=Math.floor(k/A)*A+Number(G)}else void 0!==n?(D=n,T=O?(Math.floor(Number(M)/A)+1)*A+k:0):(T=O?(Math.ceil(O/A)+(I.a.mod(O,A).isZero()?1:0))*A:0,D=k?(Math.floor(k/A)-(I.a.mod(k,A).isZero()?1:0))*A:0);return T-O>1e-4*A&&Math.abs(T-O)<.4285*A&&(T+=A),Math.abs(D-k)>1e-4*A&&Math.abs(D-k)<.4285*A&&(D-=A),o=null!==(s=o)&&void 0!==s?s:A/5,{max:this.formatNumber(T),min:this.formatNumber(D),majorUnit:this.formatNumber(A),minorUnit:this.formatNumber(o)}}},{key:"getAxisTicks",value:function(e,t,r,n){var i=[];if(!(isNaN(Number(e))||isNaN(Number(t))||isNaN(Number(r)))){for(var o=new I.a(e),a=new I.a(t),l=Date.now();a.lessThanOrEqualTo(o);){if(Date.now()-l>500)return void this.reportAxisTicksCalculateError({max:e,min:t,unit:r,logBase:n});i.push(a.valueOf()),a=n?a.mul(r):a.add(r)}return i}}},{key:"mathLogBase",value:function(e,t){return Math.log(e)/Math.log(t)}},{key:"formatNumber",value:function(e){return isNaN(e)||w()(e)?e:Object(x.b)(e)}},{key:"reportAxisCalculateError",value:function(e){var t=JSON.stringify(e);Object(L.c)({opername:B.e.DOC_PPT,module:B.d.CHART,action:B.b.AXIS_CALCULATE_ERROR,ver6:t})}},{key:"reportAxisTicksCalculateError",value:function(e){var t=JSON.stringify(e);Object(L.c)({opername:B.e.DOC_PPT,module:B.d.CHART,action:B.b.AXIS_TICKS_CALCULATE_ERROR,ver6:t})}},{key:"model",get:function(){return this.context.getChartModel()}},{key:"getAxesName",value:function(e){return"".concat(e,"Axes")}}]),r}(re);function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Se=function(e){m()(r,e);var t=ke(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"axisList",void 0),e}return c()(r,[{key:"init",value:function(){var e=this,t=this.uiData,r=t.categoryAxes,n=void 0===r?[]:r,i=t.valueAxes,o=void 0===i?[]:i,a=t.dateAxes,l=void 0===a?[]:a,u=[].concat(v()(this.appendAxisTypeAndIndex(n,"category")),v()(this.appendAxisTypeAndIndex(l,"date")),v()(this.appendAxisTypeAndIndex(o,"value")));return this.axisList=u.map((function(t){return new ge(t,e.context).init()})),this.initAxisName(),this}},{key:"getRelativeAxisById",value:function(e){return this.axisList.find((function(t){return t.axId===e}))}},{key:"initAxisValues",value:function(){var e=this.context.getPropertyModule("subCharts");e&&this.axisList.forEach((function(t){var r=[],n=void 0;"value"===t.type&&e.forEach((function(e){var i;if(e&&(null===(i=e.axisIds)||void 0===i?void 0:i.some((function(e){return e===t.axId})))){var o=e.getAxisValuesFromData(t),a=o.values,l=o.range;r=[].concat(v()(r),v()(a)),l&&(n?(n[0]=Math.min(n[0],l[0]),n[1]=Math.max(n[1],l[1])):n=l)}})),t.setValues(r,n),e.forEach((function(e){return e.processAxis(t)}))}))}},{key:"primaryHorizontalAxis",get:function(){return this.axisList.find((function(e){return e.name===R.PRIMARY_HORIZONTAL}))}},{key:"primaryVerticalAxis",get:function(){return this.axisList.find((function(e){return e.name===R.PRIMARY_VERTICAL}))}},{key:"secondaryHorizontalAxis",get:function(){return this.axisList.find((function(e){return e.name===R.SECONDARY_HORIZONTAL}))}},{key:"secondaryVerticalAxis",get:function(){return this.axisList.find((function(e){return e.name===R.SECONDARY_VERTICAL}))}},{key:"getAxisByName",value:function(e){return this.axisList.find((function(t){return t.name===e}))}},{key:"getAllAxes",value:function(){return[this.primaryHorizontalAxis,this.primaryVerticalAxis,this.secondaryHorizontalAxis,this.secondaryVerticalAxis]}},{key:"showAllAxes",value:function(){var e=this;Object(M.b)((function(){D()(e.axisList,(function(e){return e.showAxis()}))}))}},{key:"hideAllAxes",value:function(){var e=this;Object(M.b)((function(){D()(e.axisList,(function(e){return e.hideAxis()}))}))}},{key:"createAllAxesTitle",value:function(){var e=this;Object(M.b)((function(){D()(e.axisList,(function(e){return e.createAxisTitle()}))}))}},{key:"removeAllAxesTitle",value:function(){var e=this;Object(M.b)((function(){D()(e.axisList,(function(e){return e.removeAxisTitle()}))}))}},{key:"createAllAxesGridlines",value:function(){var e=this;Object(M.b)((function(){D()(e.axisList,(function(e){return e.createGridlines([F.b.MAJOR_GRID,F.b.MINOR_GRID])}))}))}},{key:"removeAllAxesGridlines",value:function(){var e=this;Object(M.b)((function(){D()(e.axisList,(function(e){return e.removeGridlines([F.b.MAJOR_GRID,F.b.MINOR_GRID])}))}))}},{key:"appendAxisTypeAndIndex",value:function(e,t){return e.map((function(e,r){return Oe(Oe({},e),{},{type:t,index:r})}))}},{key:"initAxisName",value:function(){var e=this.context.getChartModel().plotArea.charts,t=v()(new Set(e.map((function(e){var t;return null===(t=e.axisIds)||void 0===t?void 0:t[0]})).filter((function(e){return!!e})))),r=v()(new Set(e.map((function(e){var t;return null===(t=e.axisIds)||void 0===t?void 0:t[1]})).filter((function(e){return!!e})))),n=this.axisList.filter((function(e){return t.includes(e.axId)})),i=h()(n,2),o=i[0],a=i[1],l=this.axisList.filter((function(e){return r.includes(e.axId)})),u=h()(l,2),c=u[0],d=u[1];null==o||o.setAxisName(this.isBarChart(e[0])?R.PRIMARY_VERTICAL:R.PRIMARY_HORIZONTAL),null==c||c.setAxisName(this.isBarChart(e[0])?R.PRIMARY_HORIZONTAL:R.PRIMARY_VERTICAL),null==a||a.setAxisName(this.isBarChart(e[1])?R.SECONDARY_VERTICAL:R.SECONDARY_HORIZONTAL),null==d||d.setAxisName(this.isBarChart(e[1])?R.SECONDARY_HORIZONTAL:R.SECONDARY_VERTICAL)}},{key:"isBarChart",value:function(e){return(null==e?void 0:e.type)===se.z.BarChart&&e.direction===se.b.bar}}]),r}(A);function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ce(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Ae,Me,Te=function(e){m()(r,e);var t=Re(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"removeTitle",value:function(){this.model.removeProps({title:null})}},{key:"updateProps",value:function(e,t){this.model.updateAndRemoveProps({title:this.setTextRawMark(e)},{title:t})}},{key:"getParagraphList",value:function(e){var t,n,i,o,a,l,u,c,d,s=1===(null===(t=this.model.plotArea)||void 0===t||null===(n=t.charts)||void 0===n?void 0:n.length)&&1===(null===(i=this.model.plotArea)||void 0===i||null===(o=i.charts[0])||void 0===o||null===(a=o.series)||void 0===a?void 0:a.length)?null===(l=this.model.plotArea)||void 0===l||null===(u=l.charts[0])||void 0===u||null===(c=u.series)||void 0===c||null===(d=c[0])||void 0===d?void 0:d.name:"";return s=s||ie.a.t("图表标题"),U()(P()(r.prototype),"getParagraphList",this).call(this,null!=e?e:{content:s,textAlign:"center",level:1})}},{key:"getChartTitleText",value:function(){var e=this.getParagraphList();return Object(H.f)(e)}},{key:"model",get:function(){return this.context.getChartModel()}},{key:"setTextRawMark",value:function(e){var t;return null!==(t=e.text)&&void 0!==t&&t.paragraphList?Ce(Ce({},e),{},{text:{paragraphList:e.text.paragraphList.map((function(e){var t=_()(e);return["paragraphProps","endParaRPr","paragraphCharacter"].forEach((function(e){var r=t[e];null!=r&&Object.keys(r).map((function(r){t[e]["raw-".concat(r)]=!0}))})),t.textRuns&&t.textRuns.length>0&&t.textRuns.forEach((function(e){var t=e.styles;null!=t&&Object.keys(t).map((function(e){t["raw-".concat(e)]=!0}))})),t}))}}):e}}]),r}(re),De=(r("0acdc5834b"),r("af802ec74b"),r("759492dad9"),r("482ae4f50d")),Fe=r.n(De),Ee=r("ea00dd14b1"),Ie=r.n(Ee),je=r("217161e843"),we=r.n(je),xe=r("2f766f71b0"),Le=r.n(xe),Be=r("fc7fcd60bb"),Ne=r("b4060fa5e7"),Ue=(Ae={},s()(Ae,se.y.linear,"linear"),s()(Ae,se.y.exp,"exponential"),s()(Ae,se.y.log,"logarithmic"),s()(Ae,se.y.power,"power"),s()(Ae,se.y.poly,"polynomial"),Ae),Ge=(Me={},s()(Me,se.y.linear,ie.a.t("线性")),s()(Me,se.y.exp,ie.a.t("指数")),s()(Me,se.y.log,ie.a.t("对数")),s()(Me,se.y.power,ie.a.t("乘幂")),s()(Me,se.y.poly,ie.a.t("多项式")),s()(Me,se.y.movingAvg,ie.a.t("移动平均")),s()(Me,se.y.PBDEFAULT,""),Me),_e=r("4b0c0f4cca");function Ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var We=function(e){m()(r,e);var t=ze(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"data",[]),s()(b()(e),"type",void 0),s()(b()(e),"name",void 0),s()(b()(e),"series",void 0),s()(b()(e),"isSupport",void 0),s()(b()(e),"subChartDataList",void 0),e}return c()(r,[{key:"init",value:function(e,t){var r;return this.type=null!==(r=this.uiData.type)&&void 0!==r?r:se.y.PBDEFAULT,this.series=t,this.subChartDataList=e,this.name=this.uiData.name||"".concat(Ge[this.type],"(").concat(t.name,")"),this.isSupport=!!Ue[this.type],this}},{key:"updateProps",value:function(e,t){var r=this,n=this.sdkSubchart.ser[this.series.idx].trendline,i=Array.isArray(n),o={trendlines:[].concat(v()(new Array(this.uiData.idx)),[i?e:He(He({},this.uiData),e)])},a={trendlines:i?[].concat(v()(new Array(this.uiData.idx)),[t]):null},l=[].concat(v()(new Array(this.series.idx)),[o]),u=[].concat(v()(new Array(this.series.idx)),[a]);Object(M.b)((function(){r.subChartModel.removeProps({series:u}),r.subChartModel.updateProps({series:l})}))}},{key:"removeTrendline",value:function(){this.updateProps(void 0,null)}},{key:"initTrendlineDataSource",value:function(e){var t=this;this.data=[];var r=this.subChartDataList.map((function(e){if(e.ser.name===t.series.name)return t.type!==se.y.linear||""!==e.originValue&&void 0!==e.originValue?""!==e.originValue&&void 0!==e.originValue?He(He({},e),{},{categoryIndex:e.categoryIndex+1}):void 0:He(He({},e),{},{categoryIndex:e.categoryIndex+1,value:0})})).filter((function(e){return!!e})),n=e.createView().source(r),i=Ue[this.uiData.type];if(i){var o,a=this.props,l=this.getTrendlineDataSet(i,n,this.series);if(l.length>0)(o=this.data).push.apply(o,v()(l.map((function(e,r){return He(He({},e),{},{props:a,id:"trend_".concat(t.series.idx,"_").concat(r,"_").concat(i),ser:t.series,seriesId:t.series.seriesId,specialGeometryType:_e.c.trendLine})}))))}}},{key:"getTrendlineDataSet",value:function(e,t,r){var n=this;return t.transform({type:"regression",method:e,fields:["categoryIndex","value"],bandwidth:1,as:["categoryIndex","value"]}),t.rows.map((function(e,r){var i;return He(He({},e),{},{name:n.name,category:null===(i=t.origin[r])||void 0===i?void 0:i.category})}))}},{key:"subChartModel",get:function(){return this.context.getSubChartModel()}},{key:"chartModel",get:function(){return this.context.getChartModel()}},{key:"sdkSubchart",get:function(){return this.chartModel.sdkData.store.subChartList[Number(this.subChartModel.id)]}}]),r}(te),Ye=function(e){m()(r,e);var t=ze(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"getTrendlineDataSet",value:function(e,t,r){var n=this;return t.transform({type:"regression",method:e,fields:["category","value"],as:["category","value"]}),t.rows.map((function(e,t){return He(He({},e),{},{name:n.name})}))}}]),r}(We);function Ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ke(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Ze=function(e){m()(r,e);var t=qe(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"updateProps",value:function(e){}}]),r}(re),Je=function(e){m()(r,e);var t=qe(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"content",void 0),s()(b()(e),"dataItem",void 0),s()(b()(e),"formatCodeColor",void 0),s()(b()(e),"rawParaList",void 0),e}return c()(r,[{key:"updateProps",value:function(e){this.dataItem.updateDataLabel(e)}},{key:"init",value:function(e){return this.dataItem=e,this.generateLabelContent(e),this}},{key:"getParagraphList",value:function(e){if(this.rawParaList){var t,n=this.paragraphList,i=this.shouldMergeDefaultTextProps();return(null===(t=this.rawParaList)||void 0===t?void 0:t.map((function(e){var t;return Xe(Xe({},e),{},{paragraphProps:Xe({textAlign:"center"},null==e?void 0:e.paragraphProps),textRuns:null===(t=e.textRuns)||void 0===t?void 0:t.map((function(t){var r,o,a;return Xe(Xe({},t),{},{styles:Xe(Xe(Xe({},i?null==n||null===(r=n[0])||void 0===r||null===(o=r.paragraphProps)||void 0===o?void 0:o.defaultRunProps:{}),null===(a=e.paragraphProps)||void 0===a?void 0:a.defaultRunProps),t.styles)})}))})})))||[]}return U()(P()(r.prototype),"getParagraphList",this).call(this,null!=e?e:{textAlign:"center",content:this.content})}},{key:"generateLabelContent",value:function(e){var t=e.value,r=(e.valueFormatCode,e.category),n=e.ser,i=e.originSize,o=this.uiData,a=o.showVal,l=o.showCategoryName,u=o.showPercent,c=o.showSeriesName,d=o.showBubbleSize,s=o.separator,f=void 0===s?", ":s,h=o.text,p=o.formatCode,v="",y="",b=[],g=r||"",m=this.getFormattedValueText(e);if(u){var O=t/n.dataList.map((function(e){var t;return(null===(t=e.valuePoint)||void 0===t?void 0:t.value)||0})).reduce((function(e,t){return Number(e)+Number(t||0)}));y=p&&"General"!==p?Object(x.b)(O,p):"".concat(Math.round(100*O),"%")}var k=a?m:"";if(h){var S=h.paragraphList||[],P=[],C=[],R=S.length;this.rawParaList=S.map((function(e,t){var r=e.textRuns.map((function(e){var t="",r=e.text,o=e.type,a=e.fieldType;if("run"===o&&(t=r),"field"===o&&!P.includes(a))switch(P.push(a),a){case F.c.CATEGORY_NAME:case F.c.X_VALUE:t="".concat(g);break;case F.c.VALUE:case F.c.Y_VALUE:t=k;break;case F.c.SERIES_NAME:t=n.name;break;case F.c.BUBBLE_SIZE:t=i||0;break;case F.c.PERCENTAGE:t=y;break;case F.c.CELL_RANGE:t=m;break;default:t=r}return C.push("".concat(t)),Xe(Xe({},e),{},{text:"".concat(t)})})).filter((function(e){return!!e.text}));return R>1&&t!==R-1&&C.push("\n"),Xe(Xe({},e),{},{textRuns:r})})),v=C.join("")}else c&&b.push(n.name),l&&b.push(g),a&&b.push(k),d&&b.push(i||0),u&&b.push(y),v=b.join(f);this.content=v}},{key:"getFormattedValueText",value:function(e){var t=e.value,r=e.valueFormatCode,n=this.uiData.formatCode,i="",o="General"===n&&r?r:n||r;if("string"==typeof t&&isNaN(Number(t)))i="0";else{i=Object(x.b)(t,o);var a=null==o?void 0:o.match(/;\[[a-zA-Z]+\]/gi);t<0&&a&&a.length>0&&(this.formatCodeColor=a[0].slice(2,-1).toLowerCase())}return i}},{key:"shouldMergeDefaultTextProps",value:function(){if(this.text){var e=this.dataItem.dataLabel;if(!(null!=e&&e.paragraphList||null!=e&&e.props))return!0}return!1}}]),r}(Ze),Qe=function(e){m()(r,e);var t=qe(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"seriesProperty",void 0),e}return c()(r,[{key:"init",value:function(e){return this.seriesProperty=e,this}},{key:"updateProps",value:function(e){this.seriesProperty.updateDataLabels(e)}},{key:"updateFontStyle",value:function(e,t){var n=this;Object(M.b)((function(){U()(P()(r.prototype),"updateFontStyle",n).call(n,e,t),n.updateDataListLabelFontStyle(e,t)}))}},{key:"updateParagraphList",value:function(e){this.seriesProperty.updateDataLabels({paragraphList:e},!1)}},{key:"updateDataListLabelFontStyle",value:function(e,t){var r,n=this,i=this.context.getSubChartModel(),o=null===(r=i.series.find((function(e){return e.idx===n.seriesProperty.idx})))||void 0===r?void 0:r.dataList,a=null==o?void 0:o.map((function(r){if(r.dataLabel){var n=i.getSubChartProperty().data.find((function(e){return e.id===r.id}));if(null!=n&&n.label)return{dataLabel:n.label.getUpdatedTextProps(e,t)}}}));this.seriesProperty.updateProps({dataList:a})}}]),r}(Ze),$e=r("ee6bb53310"),et=r.n($e),tt=r("c8a708a138");function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var nt=function(e){m()(r,e);var t=rt(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"parentProperty",void 0),e}return c()(r,[{key:"init",value:function(e){return this.parentProperty=e,this}},{key:"updateProps",value:function(e,t){this.parentProperty.updateGeometry(e,t)}},{key:"getParentProperty",value:function(){return this.parentProperty}}]),r}(te);function it(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var ot=function(e){m()(r,e);var t=it(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"symbol",void 0),s()(b()(e),"parentProperty",void 0),e}return c()(r,[{key:"init",value:function(e){return this.parentProperty=e,this.setSymbol(),this}},{key:"setSymbol",value:function(){this.symbol=this.uiData.symbol||se.n.circle}},{key:"updateProps",value:function(e,t){this.parentProperty.updateMarker(e,t)}},{key:"createMarker",value:function(e){this.parentProperty.createMarker(e)}},{key:"getParentProperty",value:function(){return this.parentProperty}}]),r}(te);function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var ct=function(e){m()(r,e);var t=ut(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"serIndex",void 0),s()(b()(e),"autoThemeColor",void 0),s()(b()(e),"label",void 0),s()(b()(e),"geometry",void 0),s()(b()(e),"markerProperty",void 0),e}return c()(r,[{key:"seriesId",get:function(){return this.uiData.seriesId}},{key:"props",get:function(){return this.uiData.props}},{key:"isEmptySeriesName",get:function(){return this.uiData.isEmptySeriesName}},{key:"idx",get:function(){return this.uiData.idx}},{key:"dataLabels",get:function(){return this.uiData.dataLabels}},{key:"name",get:function(){return this.uiData.name}},{key:"dataList",get:function(){return this.uiData.dataList}},{key:"init",value:function(e){return this.serIndex=e,this.autoThemeColor=this.subChartModel.getSubChartProperty().isAutoThemeColor(this.uiData,this.idx),this.initDataLabelsProperty(),this.initGeometryProperty(),this.initMarkerProperty(),this}},{key:"getDataLabelsProperty",value:function(){return this.label}},{key:"getGeometryProperty",value:function(e){return e?this.markerProperty:this.geometry}},{key:"removeDataLabels",value:function(){var e=this,t=this.subChartModel.series.map((function(t){if(e.idx===t.idx){var r={dataLabels:null};return t.dataList&&(r.dataList=t.dataList.map((function(e){if(e.dataLabel)return{dataLabel:null}}))),r}}));this.subChartModel.removeProps({series:t})}},{key:"updateDataLabels",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={dataLabels:this.dataLabels?_()(e):tt.a.createDataLabels(e)},n=new Array(this.dataList.length).fill(void 0);t&&this.dataList&&(r.dataList=this.dataList.map((function(t,r){if(t.dataLabel)return Object.keys(e).includes("labelPosition")&&(n[r]={dataLabel:{layout:null}}),{dataLabel:e}})));var i={dataList:n};this.updateProps(r,i)}},{key:"removeTrendlines",value:function(){var e=this,t=this.subChartModel.series,r=t.length,n=t.findIndex((function(t){return t.idx===e.idx})),i=new Array(r).fill(void 0);i[n]={trendlines:null},this.subChartModel.removeProps({series:i})}},{key:"createTrendline",value:function(e){var t=this,r=this.subChartModel.series,n=we()(this.chartModel.plotArea.charts.map((function(e){return e.series.length}))),i=r.map((function(r){if(r.idx===t.idx){var i,o,a={style:{}};et()(a,"style.border.color",Object(Be.b)(t.idx,null===(i=t.chartModel.chartSpace)||void 0===i||null===(o=i.colorStyle)||void 0===o?void 0:o.id,n));var l=tt.a.createTrendline({type:e,props:a}),u=r.trendlines;return{trendlines:[].concat(v()((null==u?void 0:u.map((function(e){})))||[]),[l])}}}));this.subChartModel.updateProps({series:i})}},{key:"getUIData",value:function(){return this.uiData}},{key:"updateGeometry",value:function(e,t){var r=_()(e),n=new Array(this.dataList.length).fill(void 0);this.dataList&&(r.dataList=this.dataList.map((function(r,i){if(r.dataPoint)return t&&(n[i]={dataPoint:_()(t)}),{dataPoint:_()(e)}})));var i=lt(lt({},_()(t)),{},{dataList:n});this.updateProps(r,i)}},{key:"updateMarker",value:function(e,t){var r={marker:_()(e)},n=new Array(this.dataList.length).fill(void 0);this.dataList&&(r.dataList=this.dataList.map((function(r,i){var o;if(null!==(o=r.dataPoint)&&void 0!==o&&o.marker)return t&&(n[i]={dataPoint:{marker:t}}),{dataPoint:{marker:e}}})));var i={marker:_()(t),dataList:n};this.updateProps(r,i)}},{key:"createMarker",value:function(e){var t={};et()(t,"style.border.color.colorValue","accent".concat(this.idx+1)),this.updateMarker(lt(lt({},tt.a.createDefaultMarker({props:t})),{},{symbol:e}))}},{key:"updateProps",value:function(e,t){var r=[].concat(v()(new Array(this.serIndex)),[e]),n=[].concat(v()(new Array(this.serIndex)),[t]);this.subChartModel.updateAndRemoveProps({series:r},{series:n})}},{key:"subChartModel",get:function(){return this.context.getSubChartModel()}},{key:"chartModel",get:function(){return this.context.getChartModel()}},{key:"initDataLabelsProperty",value:function(){this.dataLabels&&(this.label=new Qe(this.dataLabels,this.context).init(this))}},{key:"initGeometryProperty",value:function(){this.props&&(this.geometry=new nt({props:this.props},this.context).init(this))}},{key:"initMarkerProperty",value:function(){this.uiData.marker&&(this.markerProperty=new ot(this.uiData.marker,this.context).init(this))}}]),r}(A),dt=r("5dc281b610");function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?st(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ht(e){return 0===Object.keys(e).length}var pt=r("1f95bda786");function vt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var gt=function(e){m()(r,e);var t=bt(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"id",void 0),s()(b()(e),"type",void 0),s()(b()(e),"category",void 0),s()(b()(e),"originCategory",void 0),s()(b()(e),"categoryIndex",void 0),s()(b()(e),"categoryFormatCode",void 0),s()(b()(e),"value",void 0),s()(b()(e),"originValue",void 0),s()(b()(e),"valueFormatCode",void 0),s()(b()(e),"ser",void 0),s()(b()(e),"serIndex",void 0),s()(b()(e),"props",void 0),s()(b()(e),"marker",void 0),s()(b()(e),"dataPoint",void 0),s()(b()(e),"dataLabel",void 0),s()(b()(e),"label",void 0),s()(b()(e),"geometry",void 0),s()(b()(e),"autoThemeColor",void 0),e}return c()(r,[{key:"init",value:function(e){var t,r,n,i,o,a,l,u,c,d,s,f,h=e.dataItem,p=e.serItem,v=e.serIndex,y=e.index,b=this.context.getSubChartModel().type,g=this.context.getChartModel().plotArea.dateAxes,m=!(null==g||!g.length)&&p.dataList.every((function(e){var t;return!isNaN(Number(null===(t=e.categoryPoint)||void 0===t?void 0:t.value))})),O=null===(t=h.categoryPoint)||void 0===t?void 0:t.value,k=m||"number"==typeof O,S=isNaN(Number(O)),P=k&&!S?Number(O):"".concat(O||""),C=null===(r=h.valuePoint)||void 0===r?void 0:r.value,R=Object(x.b)(C);this.id=h.id,this.type=b,this.category=P,this.originCategory=O,this.categoryIndex=y,this.categoryFormatCode=(null===(n=h.categoryPoint)||void 0===n?void 0:n.formatCode)||p.categoryFormatCode,this.value=R,this.originValue=C,this.valueFormatCode=(null===(i=h.valuePoint)||void 0===i?void 0:i.formatCode)||p.valueFormatCode,this.ser=p,this.serIndex=v,this.props=p.props,this.marker=p.marker&&new ot(p.marker,this.context).init(this),h.dataPoint&&(this.dataPoint=h.dataPoint,this.props=(a=p.props,l=h.dataPoint.props,u=null==a?void 0:a.style,c=null==l?void 0:l.style,d=Object(dt.a)((null==u?void 0:u.border)||{},(null==c?void 0:c.border)||{},["color","gradFill","noFill"]),s=Object(dt.a)((null==u?void 0:u.fillBackground)||{},(null==c?void 0:c.fillBackground)||{},["noFill","solidFill","gradFill","pattFill","grpFill","image"]),f=ft(ft(ft({},u),c),{},{border:ht(d)?void 0:d,fillBackground:ht(s)?void 0:s}),ft(ft({},l),{},{style:f})),this.marker=new ot(Object(dt.a)(p.marker,h.dataPoint.marker),this.context).init(this));var A=""===C||w()(C)||w()(R),M=null===(o=h.dataLabel)||void 0===o?void 0:o.delete;if(!A&&!M&&p.dataLabels){this.dataLabel=h.dataLabel;var T=this.context.getSubChartModel().getSubChartProperty();this.label=T.getDataLabelProperty(Object(dt.a)(p.dataLabels,yt({},h.dataLabel)),this)}return this.uiData.dataPoint&&(this.autoThemeColor=this.subChartModel.getSubChartProperty().isAutoThemeColor(this.uiData.dataPoint,y,p.dataList.length)),this.geometry=new nt({props:this.props},this.context).init(this),this}},{key:"updateDataLabel",value:function(e){var t,r;if(this.id!==pt.a)t=this.uiData.dataLabel?{dataLabel:e}:{dataLabel:yt(yt({},this.ser.dataLabels),e)},Object.keys(e).includes("labelPosition")&&(r={dataLabel:{layout:null}}),this.updateProps(t,r);else{var n=this.ser.otherDLbl?{otherDLbl:e}:{otherDLbl:yt(yt({},this.ser.dataLabels),e)},i=Object.keys(e).includes("labelPosition")?{otherDLbl:{layout:null}}:void 0;this.updateSeriesProps(n,i)}}},{key:"updateGeometry",value:function(e,t){var r;if(this.id!==pt.a){var n,i,o,a;if(null!==(r=this.uiData.dataPoint)&&void 0!==r&&r.props)n={dataPoint:e};else n={dataPoint:{props:{style:yt(yt({},null===(i=this.ser)||void 0===i||null===(o=i.props)||void 0===o?void 0:o.style),null==e||null===(a=e.props)||void 0===a?void 0:a.style)}}};var l={dataPoint:t};this.updateProps(n,l)}else this.updateSeriesProps({otherDPt:e},{otherDPt:t})}},{key:"updateProps",value:function(e,t){var r=[].concat(v()(new Array(this.categoryIndex)),[e]),n=[].concat(v()(new Array(this.categoryIndex)),[t]),i=[].concat(v()(new Array(this.serIndex)),[{dataList:r}]),o=[].concat(v()(new Array(this.serIndex)),[{dataList:n}]);this.subChartModel.updateAndRemoveProps({series:i},{series:o})}},{key:"updateSeriesProps",value:function(e,t){var r=e?[].concat(v()(new Array(this.serIndex)),[e]):e,n=t?[].concat(v()(new Array(this.serIndex)),[t]):t;this.subChartModel.updateAndRemoveProps({series:r},{series:n})}},{key:"updateMarker",value:function(e,t){var r,n,i,o,a,l;null!==(r=this.uiData.dataPoint)&&void 0!==r&&r.marker?n={dataPoint:{marker:e}}:n={dataPoint:{marker:yt(yt(yt({},null===(i=this.ser)||void 0===i?void 0:i.marker),e),{},{props:{style:yt(yt({},null===(o=this.ser)||void 0===o||null===(a=o.marker)||void 0===a?void 0:a.props.style),null==e||null===(l=e.props)||void 0===l?void 0:l.style)}})}};var u={dataPoint:{marker:t}};this.updateProps(n,u)}},{key:"createMarker",value:function(e){var t={};et()(t,"style.border.color.colorValue","accent".concat(this.serIndex+1)),this.updateMarker(yt(yt({},tt.a.createDefaultMarker({props:t})),{},{symbol:e}))}},{key:"getGeometryProperty",value:function(e){return e?this.marker:this.geometry}},{key:"subChartModel",get:function(){return this.context.getSubChartModel()}}]),r}(A),mt=function(e){m()(r,e);var t=bt(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"size",void 0),s()(b()(e),"originSize",void 0),e}return c()(r,[{key:"init",value:function(e){return this.size=e.size,this.originSize=e.originSize,U()(P()(r.prototype),"init",this).call(this,e),this}}]),r}(gt),Ot=r("7485b1517d"),kt=r.n(Ot),St=r("54bdd803dc"),Pt=r.n(St),Ct=r("ff46ef6411"),Rt=r.n(Ct),At=r("8f58e78419"),Mt=r.n(At),Tt=r("f9193d718f"),Dt=r("3344f1a2e7");function Ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ft(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function It(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var jt=function(e){m()(r,e);var t=It(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"type",void 0),s()(b()(e),"id",void 0),s()(b()(e),"data",void 0),s()(b()(e),"xAxis",void 0),s()(b()(e),"yAxis",void 0),s()(b()(e),"trendlines",void 0),s()(b()(e),"series",void 0),s()(b()(e),"getGeometryColorPath",(function(){return"fillBackground.solidFill.color"})),s()(b()(e),"getDefaultThemeStyle",(function(t,r,n,i){return{fillBackground:{solidFill:{color:e.getThemeColor(r,n,i)}},border:{noFill:1}}})),s()(b()(e),"getDefaultMarkerThemeStyle",(function(t,r,n){var i,o=e.context.getChartModel().style,a=Object(Be.c)(o),l=a.borderScale,u=a.accentStartIndex,c=e.getThemeColor(t+u,r,n),d=Object(Be.a)(null===(i=e.getThemeColorManager())||void 0===i?void 0:i.currentThemeModel);return{fillBackground:{solidFill:{color:c}},border:Et(Et({},d),{},{width:((null==d?void 0:d.width)||0)*l||1.5*Dt.a,color:c,tdColor:c})}})),s()(b()(e),"getThemeColor",(function(t,r,n){var i,o,a=r||(null===(i=e.chartModel.chartSpace)||void 0===i||null===(o=i.colorStyle)||void 0===o?void 0:o.id),l=n||e.totalSeriesCount;return Object(Be.b)(t,a,l)})),e}return c()(r,[{key:"relativeAxes",get:function(){var e,t=this;return null===(e=this.axisIds)||void 0===e?void 0:e.map((function(e){var r;return null===(r=t.context.getPropertyModule("axes"))||void 0===r?void 0:r.getRelativeAxisById(e)})).filter((function(e){return!!e}))}},{key:"totalSeriesCount",get:function(){return this.context.getChartModel().plotArea.charts.reduce((function(e,t){var r;return e+((null===(r=t.series)||void 0===r?void 0:r.length)||0)}),0)}},{key:"chartModel",get:function(){return this.context.getChartModel()}},{key:"init",value:function(){return this.type=this.uiData.type,this.id=this.uiData.id,this.initSeries(),this.initFlattenData(),this.processData(),this.initAxis(),this.initTrendline(),this}},{key:"getAxisValuesFromData",value:function(e){var t=this,r=this.uiData,n=this.data.map((function(e){return e.value})).filter((function(e){return!isNaN(e)}));if(this.isStackedGrouping(r.grouping)){var i=Fe()(Ie()(this.data,"category"),(function(e){return t.formatNumber(we()(e.map((function(e){return+e.value}))))}));n=[].concat(v()(n),v()(i))}return{values:n}}},{key:"getLegendContentType",value:function(){var e="series",t=this.series;if((null==t?void 0:t.length)>0){var r,n,i,o=null==t||null===(r=t[0].dataList)||void 0===r||null===(n=r[0])||void 0===n||null===(i=n.categoryPoint)||void 0===i?void 0:i.value;if((t.length>1||o&&!isNaN(Date.parse(o)))&&(e="series"),1===this.totalSeriesCount){var a,l,u,c=!!this.varyColors,d=null===(a=this.series)||void 0===a||null===(l=a[0])||void 0===l||null===(u=l.dataList)||void 0===u?void 0:u.some((function(e){return!!e.dataPoint}));(c||d)&&(e="category")}}return e}},{key:"getLegendMarker",value:function(e){return{symbol:Ne.a.Rect,props:e}}},{key:"processLegendItems",value:function(e){return e}},{key:"processAxis",value:function(e){}},{key:"isStackedGrouping",value:function(e){return e===se.i.stacked}},{key:"isPercentStackedGrouping",value:function(e){return e===se.i.percentStacked}},{key:"removeTrendlines",value:function(){var e=this;Object(M.b)((function(){D()(e.series,(function(e){return e.removeTrendlines()}))}))}},{key:"removeDataLabels",value:function(){var e=this;Object(M.b)((function(){D()(e.series,(function(e){return e.removeDataLabels()}))}))}},{key:"updateDataLabels",value:function(e){var t=this;Object(M.b)((function(){D()(t.series,(function(t){return t.updateDataLabels(e)}))}))}},{key:"updateProps",value:function(e,t){this.uiData.updateAndRemoveProps(e,t)}},{key:"getSeries",value:function(e){return this.series.find((function(t){return t.seriesId===e}))}},{key:"getDataItem",value:function(e){return this.data.find((function(t){return t.id===e}))}},{key:"getDataLabelProperty",value:function(e,t){return new Je(e,this.context).init(t)}},{key:"getTrendline",value:function(e,t){return this.trendlines.find((function(r){return r.seriesId===e&&r.idx===t}))}},{key:"updateChartColorsWithTheme",value:function(e){var t=this,r=this.uiData,n=Fe()(this.series,(function(n){var i,o={props:{style:t.getDefaultThemeStyle(n,n.idx,e.id,t.totalSeriesCount)}};null!==(i=n.marker)&&void 0!==i&&i.props&&(o.marker={props:{style:t.getDefaultMarkerThemeStyle(n.idx,e.id,t.totalSeriesCount)}});var a=t.series[0].dataList.length;return r.varyColors&&(o.dataList=n.dataList.map((function(r,n){var i,o,l={props:{style:t.getDefaultThemeStyle(r.dataPoint,n,e.id,a)}};return null!==(i=r.dataPoint)&&void 0!==i&&null!==(o=i.marker)&&void 0!==o&&o.props&&(l.marker={props:{style:t.getDefaultMarkerThemeStyle(n,e.id,t.totalSeriesCount)}}),{dataPoint:l}}))),n.otherDPt&&(o.otherDPt={props:{style:t.getDefaultThemeStyle(n.otherDPt,n.dataList.length,e.id,a)}}),o})),i=r.varyColors?void 0:Fe()(this.series,(function(e){return{dataList:e.dataList.map((function(e){return{dataPoint:null}}))}}));r.updateAndRemoveProps({series:n},{series:i})}},{key:"isAutoThemeColor",value:function(e,t){var r,n,i,o,a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.totalSeriesCount;if(null===(r=Mt()(null===(n=e.props)||void 0===n?void 0:n.style,this.getGeometryColorPath()))||void 0===r||!r.isSchemeColor)return!1;var u=this.getDefaultThemeStyle(e,t,null===(i=this.chartModel.chartSpace)||void 0===i||null===(o=i.colorStyle)||void 0===o?void 0:o.id,l),c=["colorValue","lumMod","lumOff","shade","tint"];return Pt()(kt()(Mt()(null===(a=e.props)||void 0===a?void 0:a.style,this.getGeometryColorPath()),c),kt()(Mt()(u,this.getGeometryColorPath()),c))}},{key:"getChartOriginType",value:function(){return this.context.getSubChartModel().originType}},{key:"initAxis",value:function(){var e=this.context.getSubChartModel();if(null!=e&&e.axisIds){var t=this.context.getPropertyModule("axes");if(t){var r=h()(e.axisIds,2),n=r[0],i=r[1];this.xAxis=t.getRelativeAxisById(n),this.yAxis=t.getRelativeAxisById(i)}}}},{key:"initSeries",value:function(){var e=this,t=this.uiData.series;this.series=[],null==t||t.forEach((function(t,r){var n=new ct(t,e.context).init(r);e.series.push(n)}))}},{key:"initFlattenData",value:function(){var e=this,t=this.series,r=(this.type,this.context.getChartModel().plotArea.dateAxes),n=!(null==r||!r.length)&&t[0].dataList.every((function(e){var t;return!isNaN(Number(null===(t=e.categoryPoint)||void 0===t?void 0:t.value))}));this.data=Le()(t.map((function(t,r){return t.dataList.filter((function(e){var t;return!(n&&w()(null===(t=e.categoryPoint)||void 0===t?void 0:t.value))})).map((function(n,i){return e.initDataItem({dataItem:n,index:i,serIndex:r,serItem:t.uiData})}))}))),n&&(this.data=Rt()(this.data,"category"))}},{key:"initDataItem",value:function(e){return new gt(e.dataItem,this.context).init(e)}},{key:"initTrendline",value:function(){var e=this;this.trendlines=[],this.series.forEach((function(t){var r;null===(r=t.trendlines)||void 0===r||r.forEach((function(r){e.trendlines.push(e.getTrendlineProperty(r,t.getUIData()))}))}))}},{key:"getTrendlineProperty",value:function(e,t){return new We(e,this.context).init(this.data,t)}},{key:"processData",value:function(){this.data=this.data.map((function(e){var t;return Object.assign(e,{category:null!==(t=e.category)&&void 0!==t?t:new Array(e.categoryIndex).fill(" ").join("")})}))}},{key:"createBorderFillWithFillBackground",value:function(e){var t={};return null!=e&&e.solidFill?t.color=null==e?void 0:e.solidFill.color.srgb_color:null!=e&&e.gradFill?t.gradFill=e.gradFill:null!=e&&e.noFill?t.noFill=e.noFill:t.color=void 0,t}},{key:"getThemeColorManager",value:function(){var e;return null===(e=Tt.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.themeColorManager}},{key:"formatNumber",value:function(e){return isNaN(e)||w()(e)?e:Object(x.b)(e)}}]),r}(A);function wt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Bt=function(e){m()(r,e);var t=Lt(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"getGeometryColorPath",(function(e){return"props.style.border.tdColor"})),s()(b()(e),"getDefaultThemeStyle",(function(t,r,n,i){var o,a,l,u=e.context.getChartModel().style,c=Object(Be.c)(u),d=c.borderScale,s=c.accentStartIndex,f=e.getThemeColor(r+s,n,i),h=Object(Be.a)(null===(o=e.getThemeColorManager())||void 0===o?void 0:o.currentThemeModel),p=null===(a=t.props)||void 0===a||null===(l=a.style.border)||void 0===l?void 0:l.noFill;return{border:xt(xt({},h),{},{width:((null==h?void 0:h.width)||0)*d||1.5*Dt.a},p?{noFill:p}:{color:f,tdColor:f})}})),e}return c()(r,[{key:"grouping",get:function(){return this.uiData.grouping||se.i.PBDEFAULT}},{key:"is3D",get:function(){return this.uiData.originType===se.z.Line3DChart}},{key:"getLegendMarker",value:function(e){var t=e.style,r=t.border,n=t.fillBackground,i=xt({},r);return this.is3D&&(i=xt(xt({},i),this.createBorderFillWithFillBackground(n))),{symbol:Ne.a.Line,props:{style:{border:i}}}}},{key:"getDataLabelProperty",value:function(e,t){return new Nt(e,this.context).init(t)}}]),r}(jt),Nt=function(e){m()(r,e);var t=Lt(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"labelPosition",get:function(){return this.uiData.labelPosition||se.g.r}}]),r}(Je),Ut=r("516fa97df2");function Gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Ht=function(e){m()(r,e);var t=Vt(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"direction",void 0),s()(b()(e),"grouping",void 0),s()(b()(e),"gapWidth",void 0),e}return c()(r,[{key:"overlap",get:function(){var e;if(this.getChartOriginType()!==se.z.Bar3DChart)return null!==(e=this.uiData.overlap)&&void 0!==e?e:0}},{key:"init",value:function(){var e,t,n;return U()(P()(r.prototype),"init",this).call(this),this.direction=null!==(e=this.uiData.direction)&&void 0!==e?e:se.b.col,this.grouping=null!==(t=this.uiData.grouping)&&void 0!==t?t:se.c.clustered,this.gapWidth=null!==(n=this.uiData.gapWidth)&&void 0!==n?n:100,this}},{key:"getLegendMarker",value:function(e){var t,r=e.style.border,n=(null==r?void 0:r.color)||(null==r?void 0:r.gradFill);return{symbol:Ne.a.Rect,props:{style:_t(_t({},e.style),{},{border:_t(_t({},r),n?{linejoin:null!==(t=r.linejoin)&&void 0!==t?t:Ut.A.Round}:{})})}}}},{key:"processLegendItems",value:function(e){var t=U()(P()(r.prototype),"processLegendItems",this).call(this,e),n=this.grouping;return this.direction===se.b.bar&&n===se.c.clustered?t.reverse():t}},{key:"isStackedGrouping",value:function(e){return e===se.c.stacked}},{key:"isPercentStackedGrouping",value:function(e){return e===se.c.percentStacked}},{key:"getDataLabelProperty",value:function(e,t){return new zt(e,this.context).init(t)}},{key:"updateSeriesOverlap",value:function(e,t){var r=this.context.getSubChartModel();r.originType===se.z.BarChart&&(t?r.overlap=e:r.updateProps({overlap:e}))}},{key:"getSeriesOverlap",value:function(){var e=this.context.getSubChartModel();if(e.originType===se.z.BarChart)return e.overlap||(e.overlap=this.overlap),e.overlap}},{key:"updateGapWidth",value:function(e,t){var r=this.context.getSubChartModel();r.originType!==se.z.BarChart&&r.originType!==se.z.Bar3DChart||(t?r.gapWidth=e:r.updateProps({gapWidth:e}))}},{key:"getGapWidth",value:function(){var e=this.context.getSubChartModel();if(e.originType===se.z.BarChart||e.originType===se.z.Bar3DChart)return e.gapWidth}},{key:"processData",value:function(){var e,t=(null===(e=this.xAxis)||void 0===e?void 0:e.scaling)||{},n=t.max,i=t.min;w()(n)||(this.data=this.data.filter((function(e){return e.category<=n}))),w()(i)||(this.data=this.data.filter((function(e){return e.category>=i}))),U()(P()(r.prototype),"processData",this).call(this)}}]),r}(jt),zt=function(e){m()(r,e);var t=Vt(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"labelPosition",get:function(){var e=this.context.getSubChartModel().getSubChartProperty();return this.uiData.labelPosition?this.uiData.labelPosition:e.grouping===se.c.stacked||e.grouping===se.c.percentStacked?se.g.ctr:se.g.outEnd}}]),r}(Je);function Wt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Yt=function(e){m()(r,e);var t=Wt(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"initFlattenData",value:function(){U()(P()(r.prototype),"initFlattenData",this).call(this);var e=this.context.getChartModel().plotArea.dateAxes,t=!(null==e||!e.length)&&this.series[0].dataList.every((function(e){var t;return!isNaN(Number(null===(t=e.categoryPoint)||void 0===t?void 0:t.value))}));this.data=this.data.map((function(e){return Object.assign(e,{category:t&&!isNaN(Number(e.category))?Number(e.category):e.category})}))}}]),r}(jt);function Kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Zt=function(e){m()(r,e);var t=qt(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"getGeometryColorPath",(function(){return e.isRadarFilled?"fillBackground.solidFill.color":"border.tdColor"})),s()(b()(e),"getDefaultThemeStyle",(function(t,r,n,i){var o,a,l,u,c=e.getThemeColor(r,n,i);if(e.isRadarFilled)return{fillBackground:{solidFill:{color:c}}};var d=null===(o=e.series)||void 0===o||null===(a=o[0])||void 0===a||null===(l=a.props)||void 0===l?void 0:l.style;return{border:{color:c,tdColor:c,width:(null==d||null===(u=d.border)||void 0===u?void 0:u.width)||1.5*Dt.a}}})),e}return c()(r,[{key:"radarStyle",get:function(){return this.uiData.radarStyle}},{key:"getLegendMarker",value:function(e){var t=e.style||{},r=t.fillBackground,n=t.border;return{symbol:r?Ne.a.Square:Ne.a.Line,props:Xt(Xt({},e),{},{style:Xt(Xt({},null==e?void 0:e.style),{},{border:Xt(Xt({},this.createBorderFillWithFillBackground(r)),n)})})}}},{key:"isRadarFilled",get:function(){return this.radarStyle===se.q.filled}}]),r}(jt);function Jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var er=function(e){m()(r,e);var t=$t(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"firstSliceAngle",get:function(){var e;return null!==(e=this.uiData.firstSliceAngle)&&void 0!==e?e:0}},{key:"getLegendContentType",value:function(){return"category"}},{key:"processLegendItems",value:function(e){var t,r=null===(t=this.series)||void 0===t?void 0:t[0];return e.filter((function(e){return e.ser.idx===(null==r?void 0:r.idx)})).map((function(e){var t,r,n=(null===(t=e.dataItem)||void 0===t?void 0:t.category)||"",i=null===(r=e.dataItem)||void 0===r?void 0:r.categoryFormatCode;return i&&(n=Object(x.b)(n,i)),Qt(Qt({},e),{},{name:n})}))}},{key:"getDataLabelProperty",value:function(e,t){return new tr(e,this.context).init(t)}},{key:"updateAngleOfFirstSlice",value:function(e,t){var r=this.context.getSubChartModel();r.originType!==se.z.PieChart&&r.originType!==se.z.Pie3DChart||(t?r.firstSliceAngle=e:r.updateProps({firstSliceAngle:e}))}},{key:"getAngleOfFirstSlice",value:function(){var e=this.context.getSubChartModel();if(e.originType===se.z.PieChart||e.originType===se.z.Pie3DChart)return e.firstSliceAngle}}]),r}(jt),tr=function(e){m()(r,e);var t=$t(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"labelPosition",get:function(){return this.uiData.labelPosition||se.g.bestFit}}]),r}(Je);function rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var nr=function(e){m()(r,e);var t=rr(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"holeSize",get:function(){var e;return null!==(e=this.uiData.holeSize)&&void 0!==e?e:0}},{key:"firstSliceAngle",get:function(){var e;return null!==(e=this.uiData.firstSliceAngle)&&void 0!==e?e:0}},{key:"updateAngleOfFirstSlice",value:function(e,t){var r=this.context.getSubChartModel();r.originType===se.z.DoughnutChart&&(t?r.firstSliceAngle=e:r.updateProps({firstSliceAngle:e}))}},{key:"getAngleOfFirstSlice",value:function(){var e=this.context.getSubChartModel();if(e.originType===se.z.DoughnutChart)return e.firstSliceAngle}},{key:"getDoughnutHoleSize",value:function(){var e=this.context.getSubChartModel();if(e.originType===se.z.DoughnutChart)return e.holeSize}},{key:"updateDoughnutHoleSize",value:function(e,t){var r=this.context.getSubChartModel();r.originType===se.z.DoughnutChart&&(t?r.holeSize=e:r.updateProps({holeSize:e}))}}]),r}(er);function ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var lr=function(e){m()(r,e);var t=ar(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"getDefaultThemeStyle",(function(t,r,n,i){var o,a,l,u=e.context.getChartModel().style,c=Object(Be.c)(u),d=c.borderScale,s=c.accentStartIndex,f=e.getThemeColor(r+s,n,i),h=Object(Be.a)(null===(o=e.getThemeColorManager())||void 0===o?void 0:o.currentThemeModel),p=null===(a=t.props)||void 0===a||null===(l=a.style.border)||void 0===l?void 0:l.noFill;return{border:or(or({},h),{},{width:((null==h?void 0:h.width)||0)*d||1.5*Dt.a},p?{noFill:p}:{color:f,tdColor:f})}})),e}return c()(r,[{key:"scatterStyle",get:function(){return this.uiData.scatterStyle}},{key:"getLegendMarker",value:function(e,t){return{symbol:null==t?void 0:t.symbol,props:(null==t?void 0:t.props)||e}}},{key:"getAxisValuesFromData",value:function(e){return e.name===R.PRIMARY_VERTICAL?{values:this.data.map((function(e){return e.value})).filter((function(e){return!isNaN(e)}))}:{values:this.data.map((function(e){return e.category})).filter((function(e){return!isNaN(e)}))}}},{key:"getDataLabelProperty",value:function(e,t){return new ur(e,this.context).init(t)}},{key:"initFlattenData",value:function(){U()(P()(r.prototype),"initFlattenData",this).call(this),this.data=cr(this.data)}},{key:"getTrendlineProperty",value:function(e,t){return new Ye(e,this.context).init(this.data,t)}}]),r}(jt),ur=function(e){m()(r,e);var t=ar(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"labelPosition",get:function(){return this.uiData.labelPosition||se.g.r}}]),r}(Je);function cr(e){return e.map((function(e){var t=e.category,r=e.originCategory,n=e.value;if("number"!=typeof e.category&&e.category){var i=e.categoryIndex+1;t=i,r=i}return"number"!=typeof e.value&&e.value&&(n=0),Object.assign(e,{category:t,originCategory:r,value:n})}))}function dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function fr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var hr=function(e){m()(r,e);var t=fr(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"maxBubbleSize",void 0),s()(b()(e),"maxBubbleRadius",void 0),e}return c()(r,[{key:"bubble3D",get:function(){return this.uiData.bubble3D}},{key:"bubbleScale",get:function(){return this.uiData.bubbleScale}},{key:"sizeRepresents",get:function(){return this.uiData.sizeRepresents}},{key:"showNegBubbles",get:function(){return!!this.uiData.showNegBubbles}},{key:"getAxisValuesFromData",value:function(e){return{values:e.name===R.PRIMARY_VERTICAL?this.data.map((function(e){return e.value})).filter((function(e){return!isNaN(e)})):this.data.map((function(e){return e.category})).filter((function(e){return!isNaN(e)}))}}},{key:"processAxis",value:function(e){e.name===R.PRIMARY_VERTICAL?this.extendPrimaryVerticalAxisScale():this.extendPrimaryHorizonAxisScale()}},{key:"getDataLabelProperty",value:function(e,t){return new pr(e,this.context).init(t)}},{key:"updateBubbleSizeRepresent",value:function(e){var t=this.context.getSubChartModel();t.originType===se.z.BubbleChart&&t.updateProps({sizeRepresents:e})}},{key:"getBubbleSizeRepresent",value:function(){var e=this.context.getSubChartModel();if(e.originType===se.z.BubbleChart)return e.sizeRepresents}},{key:"initDataItem",value:function(e){var t,r=new mt(e.dataItem,this.context),n=e.serItem,i=e.index,o=(null===(t=n.bubbleSize)||void 0===t?void 0:t[i])||0;return r.init(sr(sr({},e),{},{size:this.calculateBubbleSize(o),originSize:o})),r}},{key:"initFlattenData",value:function(){U()(P()(r.prototype),"initFlattenData",this).call(this),this.data=cr(this.data)}},{key:"getTrendlineProperty",value:function(e,t){return new Ye(e,this.context).init(this.data,t)}},{key:"extendPrimaryVerticalAxisScale",value:function(){if(this.yAxis){var e=this.data.map((function(e){return e.value||0}));this.extendAxisScale(e,this.yAxis,this.chartFrame.height)}}},{key:"extendPrimaryHorizonAxisScale",value:function(){if(this.xAxis){var e=this.data.map((function(e){return Number(e.category)||0}));this.extendAxisScale(e,this.xAxis,this.chartFrame.width)}}},{key:"extendAxisScale",value:function(e,t,r){var n=this,i=t.scale||{},o=i.max,a=void 0===o?0:o,l=i.min,u=void 0===l?0:l,c=[],d=[];e.forEach((function(e,t){var i=n.data[t];if(!n.isInvalidDataItem(i)){var o=i.size,l=i.originSize;if(n.showNegBubbles||!(l<0)){var s=o/r*(a-u);c.push(e+s),d.push(e-s)}}}));var s=Math.max.apply(Math,c),f=Math.min.apply(Math,d);t.setValues(t.values,[f,s])}},{key:"chartFrame",get:function(){return{width:this.context.getChartModel().getFrame().getWidth(),height:this.context.getChartModel().getFrame().getHeight()}}},{key:"calculateBubbleSize",value:function(e){var t=this,r=Math.abs(e);if(!this.maxBubbleSize){var n=Le()(this.series.map((function(e){var r=e.bubbleSize,n=e.dataList;return(null==r?void 0:r.filter((function(e,r){var i=n[r];return!t.isIgnoreBubbleSize(i)})))||[]}))).filter((function(e){return!(void 0===e||!t.showNegBubbles&&e<0)})).map((function(e){return Math.abs(e)}));this.maxBubbleSize=Math.max.apply(Math,v()(n));var i=this.chartFrame,o=i.width,a=i.height,l=Math.min(o,a);this.maxBubbleRadius=l*(3/13)/2}var u=this.bubbleScale/100;return u>1&&(u*=5/6),u<1&&(u/=5/6),this.sizeRepresents===se.t.w?r/this.maxBubbleSize*this.maxBubbleRadius*u:this.maxBubbleRadius*Math.sqrt(r/this.maxBubbleSize)*u}},{key:"isIgnoreBubbleSize",value:function(e){var t,r,n=this.isValueNil(null==e||null===(t=e.valuePoint)||void 0===t?void 0:t.value),i=this.isValueNil(null==e||null===(r=e.categoryPoint)||void 0===r?void 0:r.value);return n||i}},{key:"isInvalidDataItem",value:function(e){return this.isValueNil(e.value)||this.isValueNil(e.category)}},{key:"isValueNil",value:function(e){return""===e||null==e}}]),r}(jt),pr=function(e){m()(r,e);var t=fr(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"labelPosition",get:function(){return this.uiData.labelPosition||se.g.r}}]),r}(Je),vr=r("a4b5e0f3d1");function yr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var br=function(e){m()(r,e);var t=yr(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"updateProps",value:function(e,t){this.context.getSubChartModel().updateAndRemoveProps({highLowLines:e},{highLowLines:t})}}]),r}(te);function gr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var mr=function(e){m()(r,e);var t=gr(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"barType",void 0),e}return c()(r,[{key:"init",value:function(e){return this.barType=e,this}},{key:"updateProps",value:function(e,t){var r=this.context.getSubChartModel(),n={upDownBars:s()({},this.barType,e)},i={upDownBars:s()({},this.barType,t)};r.updateAndRemoveProps(n,i)}}]),r}(te);function Or(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var kr=function(e){m()(r,e);var t=Or(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"highLowLinesData",void 0),s()(b()(e),"upDownBarsData",void 0),s()(b()(e),"highLowLineProperty",void 0),s()(b()(e),"upBarProperty",void 0),s()(b()(e),"downBarProperty",void 0),e}return c()(r,[{key:"init",value:function(){return U()(P()(r.prototype),"init",this).call(this),this.initStockData(),this.initHighLowLineProperty(),this.initUpDownBarProperty(),this}},{key:"getDataLabelProperty",value:function(e,t){return new Sr(e,this.context).init(t)}},{key:"getHighLowLines",value:function(){return this.highLowLineProperty}},{key:"getUpDownBars",value:function(e){return e===vr.a.DOWN?this.downBarProperty:this.upBarProperty}},{key:"initStockData",value:function(){var e,t,r,n,i,o,a=this,l=!!this.upDownBars,u=!!this.highLowLines;if(4===this.series.length){var c=[0,1,2,3].map((function(e){return a.data.filter((function(t){return t.serIndex===e}))})),d=h()(c,4);e=d[0],r=d[1],n=d[2],t=d[3]}else if(3===this.series.length){var s=[0,1,2].map((function(e){return a.data.filter((function(t){return t.serIndex===e}))})),f=h()(s,3);r=f[0],n=f[1],t=f[2]}u&&r&&n&&(this.highLowLinesData=null===(i=r)||void 0===i?void 0:i.map((function(e,t){return{category:e.category,value:[e.value,n[t].value],chartId:a.id}})));l&&e&&t&&(this.upDownBarsData=null===(o=e)||void 0===o?void 0:o.map((function(e,r){return{category:e.category,value:[e.value,t[r].value],chartId:a.id,barType:e.value-t[r].value>0?"downBars":"upBars"}})))}},{key:"initHighLowLineProperty",value:function(){this.uiData.highLowLines&&(this.highLowLineProperty=new br(this.uiData.highLowLines,this.context))}},{key:"initUpDownBarProperty",value:function(){var e,t;null!==(e=this.uiData.upDownBars)&&void 0!==e&&e.upBars&&(this.upBarProperty=new mr(this.uiData.upDownBars.upBars,this.context).init(vr.a.UP)),null!==(t=this.uiData.upDownBars)&&void 0!==t&&t.downBars&&(this.downBarProperty=new mr(this.uiData.upDownBars.downBars,this.context).init(vr.a.DOWN))}}]),r}(Bt),Sr=function(e){m()(r,e);var t=Or(r);function r(){return l()(this,r),t.apply(this,arguments)}return r}(Nt),Pr=r("1d0dc9eef2");function Cr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Cr(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Mr=function(e){m()(r,e);var t=Ar(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"parentOtherData",void 0),s()(b()(e),"childDefaultData",void 0),e}return c()(r,[{key:"ofPieType",get:function(){var e;return null!==(e=this.uiData.ofPieType)&&void 0!==e?e:se.o.pie}},{key:"splitType",get:function(){var e;return null!==(e=this.uiData.splitType)&&void 0!==e?e:se.u.auto}},{key:"gapWidth",get:function(){var e;return null!==(e=this.uiData.gapWidth)&&void 0!==e?e:100}},{key:"secondPieSize",get:function(){var e;return null!==(e=this.uiData.secondPieSize)&&void 0!==e?e:75}},{key:"splitPos",get:function(){var e;return null!==(e=this.uiData.splitPos)&&void 0!==e?e:0}},{key:"secondPiePts",get:function(){var e;return null!==(e=this.uiData.secondPiePts)&&void 0!==e?e:[]}},{key:"getDataItem",value:function(e){return[].concat(v()(this.data),[this.parentOtherData,this.childDefaultData]).find((function(t){return t.id===e}))}},{key:"getLegendContentType",value:function(){return"category"}},{key:"processLegendItems",value:function(e){var t,r=null===(t=this.series)||void 0===t?void 0:t[0];return e.filter((function(e){return e.ser.idx===(null==r?void 0:r.idx)})).map((function(e){var t,r,n=(null===(t=e.dataItem)||void 0===t?void 0:t.category)||"",i=null===(r=e.dataItem)||void 0===r?void 0:r.categoryFormatCode;return i&&(n=Object(x.b)(n,i)),Rr(Rr({},e),{},{name:n})}))}},{key:"getDataLabelProperty",value:function(e,t){return new Tr(e,this.context).init(t)}},{key:"generateOtherLabel",value:function(e,t,r){var n=h()(this.series,1)[0];return new Dr(Rr(Rr(Rr({},t.label),n.dataLabels),n.otherDLbl),this.context).init(e,r)}},{key:"initFlattenData",value:function(){U()(P()(r.prototype),"initFlattenData",this).call(this),this.data=this.data.filter((function(e){return 0===e.serIndex}));var e=this.genOfPieData(),t=h()(e,2),n=t[0],i=t[1];this.parentOtherData=n,this.childDefaultData=i}},{key:"genOfPieData",value:function(){var e,t=h()(this.series,1)[0],r=h()(this.data,1)[0],n=this.getOtherShapeProps(t),i=new gt({},this.context);Object.assign(i,Rr(Rr({},r),{},{id:pt.a,props:n,label:this.generateOtherLabel(i,r),geometry:this.generateGeometry(n,i),value:void 0}));var o=new gt({},this.context);return Object.assign(o,Rr(Rr({},r),{},{value:pt.d,category:pt.a,id:this.getChildPlaceHolderId(),props:{style:{fillBackground:{solidFill:new Pr.a(pt.c)},border:Rr(Rr({},null===(e=r.props)||void 0===e?void 0:e.style.border),{},{color:pt.b})}},serIndex:0,ser:t})),[i,o]}},{key:"getChildPlaceHolderId",value:function(){return"id_".concat(pt.d)}},{key:"getOtherShapeProps",value:function(e){var t;return null===(t=e.otherDPt)||void 0===t?void 0:t.props}},{key:"generateGeometry",value:function(e,t){return new nt({props:e},this.context).init(t)}}]),r}(jt),Tr=function(e){m()(r,e);var t=Ar(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"labelPosition",get:function(){return this.uiData.labelPosition||se.g.bestFit}}]),r}(Je),Dr=function(e){m()(r,e);var t=Ar(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"init",value:function(e,t){return this.dataItem=e,this.generateLabelContent(e,t),this}},{key:"generateLabelContent",value:function(e,t){if(!t)return U()(P()(r.prototype),"generateLabelContent",this).call(this,e);var n=t.tempData,i=t.parentTotal,o=t.childTotal,a=n.label;if(a){var l=a.showSeriesName,u=a.showCategoryName,c=a.showVal,d=a.showPercent,s=a.separator,f=void 0===s?", ":s,h="",p="",v=[];if(d){var y=o/(o+i);h="".concat(Math.round(100*y),"%")}c&&(p=Object(x.b)(o,"General")),l&&v.push(n.ser.name),u&&v.push(ie.a.t("其他")),c&&v.push(p),d&&v.push(h),this.content=v.join(f)}else this.content=""}}]),r}(Tr);function Fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fr(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ir(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var jr=function(e){m()(r,e);var t=Ir(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"items",void 0),e}return c()(r,[{key:"init",value:function(){return this.items=this.getLegendItems(),this}},{key:"updateProps",value:function(e,t){this.model.updateAndRemoveProps({legend:e},{legend:t})}},{key:"removeLegend",value:function(){this.model.removeProps({legend:null})}},{key:"getLegendItems",value:function(){var e=this,t=this.context.getPropertyModule("subCharts"),r=[];return null==t||t.forEach((function(t){t&&r.push.apply(r,v()(e.getSubChartLegendItems(t)))})),this.sortLegend(r)}},{key:"getSubChartLegendItems",value:function(e){var t=this,r=e.getLegendContentType(),n=e.series,i="series"===r?n.filter((function(e){return!e.disable})).map((function(r){return{name:r.name,paragraphList:t.uiData.paragraphList,marker:e.getLegendMarker(r.props,r.marker&&new ot(r.marker,t.context).init(t)),ser:r}})):e.data.map((function(r){return{name:r.category,paragraphList:t.uiData.paragraphList,marker:e.getLegendMarker(r.props||{style:{}},r.marker),ser:r.ser,dataItem:r}}));return i=this.handleLegendItemsWithLegendEntry(i),i=this.handleLegendItemsWithTrendLine(i,e),i=e.processLegendItems(i)}},{key:"handleLegendItemsWithLegendEntry",value:function(e){var t=this.uiData.legendEntryList;return t?e.filter((function(e,r){return!(null!=t&&t.find((function(e){return e.delete&&e.id===r})))})).map((function(e,r){var n=null==t?void 0:t.find((function(e){return e.id===r}));return n?Er(Er({},e),{},{paragraphList:n.paragraphList}):e})):e}},{key:"handleLegendItemsWithTrendLine",value:function(e,t){var r=t.trendlines,n=(null==r?void 0:r.filter((function(e){return e.isSupport&&e.name})).map((function(e){return{name:e.name||"",type:"trendline",marker:{symbol:Ne.a.Line,props:e.props||{style:{}}},ser:e.series}})))||[];return[].concat(v()(e),v()(n))}},{key:"sortLegend",value:function(e){return Rt()(e,(function(e){return e.type?1:-1}))}},{key:"model",get:function(){return this.context.getChartModel()}}]),r}(re),wr=r("3bb9823058");function xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k()(this,r)}}var Lr=function(e){m()(r,e);var t=xr(r);function r(){var e;l()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),s()(b()(e),"chartSpace",void 0),e}return c()(r,[{key:"initChartSpace",value:function(e){this.chartSpace=e}},{key:"updateProps",value:function(e,t){this.context.getChartModel().updateProps({chartSpace:e})}}]),r}(te),Br=function(){function e(t){l()(this,e),s()(this,"chartTitle",void 0),s()(this,"axes",void 0),s()(this,"subCharts",void 0),s()(this,"legend",void 0),s()(this,"chartSpace",void 0),this.context=t}return c()(e,[{key:"init",value:function(){return this.initTitle(),this.initAxes(),this.initSubCharts(),this.axes.initAxisValues(),this.initLegend(),this.initChartSpace(),this}},{key:"createTitle",value:function(e){this.chartModel.updateProps({title:fe.a.createTitle(e)})}},{key:"removeTitle",value:function(){var e;null===(e=this.chartTitle)||void 0===e||e.removeTitle()}},{key:"createLegend",value:function(e){this.chartModel.updateProps({legend:fe.a.createLegend(void 0,void 0,e)})}},{key:"removeLegend",value:function(){this.legend.removeLegend()}},{key:"updateDataLabels",value:function(e){var t=this;Object(M.b)((function(){D()(t.subCharts,(function(t){return t.updateDataLabels(e)}))}))}},{key:"removeDataLabels",value:function(){var e=this;Object(M.b)((function(){D()(e.subCharts,(function(e){return e.removeDataLabels()}))}))}},{key:"createAllAxes",value:function(){this.axes.showAllAxes()}},{key:"removeAllAxes",value:function(){this.axes.hideAllAxes()}},{key:"createAllAxesTitle",value:function(){this.axes.createAllAxesTitle()}},{key:"removeAllAxesTitle",value:function(){this.axes.removeAllAxesTitle()}},{key:"createAllAxesGridlines",value:function(){this.axes.createAllAxesGridlines()}},{key:"removeAllAxesGridlines",value:function(){this.axes.removeAllAxesGridlines()}},{key:"removeTrendlines",value:function(){var e=this;Object(M.b)((function(){D()(e.subCharts,(function(e){return e.removeTrendlines()}))}))}},{key:"getSelectedElementProperty",value:function(e,t){switch(e){case _e.a.TITLE:return this.chartTitle;case _e.a.LEGEND:return this.legend;case _e.a.AXIS_LABEL:return this.getSelectedAxis()||null;case _e.a.AXIS_TITLE:var r=this.getSelectedAxis();return(null==r?void 0:r.title)||null;case _e.a.DATA_LABEL:return this.getSelectedDataLabel()||null;case _e.a.MAJOR_GRID:case _e.a.MINOR_GRID:var n=this.getSelectedAxis(),i=F.d[e];return(null==n?void 0:n[i])||null;case _e.a.GEOMETRY:return this.getSelectedGeometry(t)||null;default:return null}}},{key:"getChartSpaceProperty",value:function(){return this.chartSpace}},{key:"getSelectedSubChartProperty",value:function(){var e=this.chartModel.selectedElement;if(e){if(this.selectedElementHasGroup(e)){var t=e.group[0].extra,r=void 0===t?{}:t,n=r.seriesId,i=r.specialGeometryType,o=r.chartId;if(i===_e.c.highLowLine){var a=this.subCharts.find((function(e){return e.id===o}));return a}if(i===_e.c.upDownBar){var l=this.subCharts.find((function(e){return e.id===o}));return l}return this.getSubChartBySeries(n)}var u=e.extra,c=(void 0===u?{}:u).seriesId;return this.getSubChartBySeries(c)}}},{key:"updateChartColors",value:function(e){var t=this;Object(M.b)((function(){t.chartModel.updateProps({chartSpace:{colorStyle:e}}),t.updateChartColorsWithTheme(e)}))}},{key:"updateChartColorsWithTheme",value:function(e){var t=this;Object(M.b)((function(){D()(t.subCharts,(function(t){return t.updateChartColorsWithTheme(e)}))}))}},{key:"selectedElementHasGroup",value:function(e){return"group"in e}},{key:"initChartSpace",value:function(){var e,t=this.context.getChartModel();this.chartSpace=new Lr({props:null===(e=t.chartSpace)||void 0===e?void 0:e.props},this.context).init(t.chartSpace)}},{key:"initAxes",value:function(){var e=this.context.getChartModel();this.axes=new Se({categoryAxes:e.plotArea.categoryAxes,valueAxes:e.plotArea.valueAxes,dateAxes:e.plotArea.dateAxes},this.context).init()}},{key:"initSubCharts",value:function(){var e=this,t=this.context.getChartModel();this.subCharts=t.plotArea.charts.map((function(t){var r=e.context.bindSubChart(t);t.setContext(r);var n=function(e){switch(e.type){case se.z.BarChart:return new Ht(e,e.getContext());case se.z.LineChart:return new Bt(e,e.getContext());case se.z.AreaChart:return new Yt(e,e.getContext());case se.z.RadarChart:return new Zt(e,e.getContext());case se.z.PieChart:return new er(e,e.getContext());case se.z.DoughnutChart:return new nr(e,e.getContext());case se.z.ScatterChart:return new lr(e,e.getContext());case se.z.BubbleChart:return new hr(e,e.getContext());case se.z.StockChart:return new kr(e,e.getContext());case se.z.OfPieChart:return new Mr(e,e.getContext())}}(t);return n&&(t.setSubChartProperty(n),n.init()),t.getSubChartProperty()}))}},{key:"initTitle",value:function(){var e=this.context.getChartModel();e.title&&(this.chartTitle=new Te(e.title,this.context))}},{key:"initLegend",value:function(){var e=this.context.getChartModel();e.legend&&(this.legend=new jr(e.legend,this.context).init())}},{key:"chartModel",get:function(){return this.context.getChartModel()}},{key:"getSelectedAxis",value:function(){var e,t,r,n=this.chartModel.selectedElement;if(n){var i="group"in n?null===(e=n.group[0])||void 0===e||null===(t=e.extra)||void 0===t?void 0:t.axisId:null==n||null===(r=n.extra)||void 0===r?void 0:r.axisId;if(i)return this.axes.getRelativeAxisById(i)}}},{key:"getSelectedDataLabel",value:function(){var e=this.chartModel.selectedElement;if(e){if("group"in e){var t=(e.group[0].extra||{}).seriesId,r=this.getSubChartBySeries(t),n=null==r?void 0:r.getSeries(t);return null==n?void 0:n.getDataLabelsProperty()}var i=(null==e?void 0:e.extra)||{},o=i.seriesId,a=i.dataId,l=this.getSubChartBySeries(o),u=null==l?void 0:l.getDataItem(a);return null==u?void 0:u.label}}},{key:"getSelectedGeometry",value:function(e){var t=this.chartModel.selectedElement;if(t){if("group"in t){var r=t.group[0],n=r.extra,i=void 0===n?{}:n,o=r.shapeType,a=i.seriesId,l=i.specialGeometryType,u=i.chartId,c=i.data;if(l===_e.c.highLowLine){var d=this.subCharts.find((function(e){return e.id===u}));return null==d?void 0:d.getHighLowLines()}if(l===_e.c.upDownBar){var s=this.subCharts.find((function(e){return e.id===u}));return null==s?void 0:s.getUpDownBars(c.barType)}var f=this.getSubChartBySeries(a),h=null==f?void 0:f.getSeries(a);return null==h?void 0:h.getGeometryProperty(!(!Object(wr.a)(o)||!e))}var p=t.extra,v=void 0===p?{}:p,y=t.shapeType,b=v.seriesId,g=v.dataId,m=v.specialGeometryType,O=v.data,k=this.getSubChartBySeries(b);if(k){if(m===_e.c.trendLine)return k.getTrendline(b,O[0].trendlineIndex);var S=null==k?void 0:k.getDataItem(g);return null==S?void 0:S.getGeometryProperty(!(!Object(wr.a)(y)||!e))}}}},{key:"getSubChartBySeries",value:function(e){return this.subCharts.find((function(t){return t.series.some((function(t){return t.seriesId===e}))}))}}]),e}()},"3bb9823058":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("4b0c0f4cca");function i(e,t){return t!==n.c.trendLine&&("line"===e||"smooth"===e)}},"405d9ef7a4":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return h}));var n,i,o,a=r("85d0a7609b"),l=r.n(a),u=(r("75563bc376"),r("22569efd03"),r("826dc923b3"),r("b1e2246d82"),r("5fac0349d3"));!function(e){e[e.string=1]="string",e[e.number=2]="number"}(o||(o={}));var c={ClARITY:{name:"sharpenSoften",getSdkValue:function(e){var t,r,n;return null===(t=d(e))||void 0===t||null===(r=t.find((function(e){return!(null==e||!e.sharpenSoften)})))||void 0===r||null===(n=r.sharpenSoften)||void 0===n?void 0:n.amount},getSdkPath:function(e){var t,r,n=null!==(t=null===(r=d(e))||void 0===r?void 0:r.findIndex((function(e){return!(null==e||!e.sharpenSoften)})))&&void 0!==t?t:0;return"extLst.ext[0].imgProps[0].imgLayer.imgEffect[".concat(n=n<0?0:n,"].sharpenSoften.amount")},title:u.a.t("清晰度"),defaultValue:0,coefficient:1e3,dataType:o.number},BRIGHTNESS:{name:"brightness",getSdkValue:function(e){var t;return null===(t=s(e))||void 0===t?void 0:t.bright},getSdkPath:function(e){var t,r,n=null!==(t=null===(r=d(e))||void 0===r?void 0:r.findIndex((function(e){return!(null==e||!e.brightnessContrast)})))&&void 0!==t?t:0;return"extLst.ext[0].imgProps[0].imgLayer.imgEffect[".concat(n=n<0?0:n,"].brightnessContrast.bright")},title:u.a.t("亮度"),defaultValue:0,coefficient:1e3,dataType:o.number},CONTRAST:{name:"contrast",getSdkValue:function(e){var t;return null===(t=s(e))||void 0===t?void 0:t.contrast},getSdkPath:function(e){var t,r,n=null!==(t=null===(r=d(e))||void 0===r?void 0:r.findIndex((function(e){return!(null==e||!e.brightnessContrast)})))&&void 0!==t?t:0;return"extLst.ext[0].imgProps[0].imgLayer.imgEffect[".concat(n=n<0?0:n,"].brightnessContrast.contrast")},title:u.a.t("对比度"),defaultValue:0,coefficient:1e3,dataType:o.number},SATURATE:{name:"saturate",getSdkValue:function(e){var t,r,n,i=null===(t=d(e))||void 0===t||null===(r=t.find((function(e){return!(null==e||!e.saturation)})))||void 0===r||null===(n=r.saturation)||void 0===n?void 0:n.sat;if(null==i)return;if(Number(i)||0===Number(i))return Number(i)},getSdkPath:function(e){var t,r,n=null!==(t=null===(r=d(e))||void 0===r?void 0:r.findIndex((function(e){return!(null==e||!e.saturation)})))&&void 0!==t?t:0;return"extLst.ext[0].imgProps[0].imgLayer.imgEffect[".concat(n=n<0?0:n,"].saturation.sat")},title:u.a.t("饱和度"),defaultValue:100,coefficient:1e3,dataType:o.string},COLORTEMPERATURE:{name:"colorTemperature",getSdkValue:function(e){var t,r,n;return null===(t=d(e))||void 0===t||null===(r=t.find((function(e){return!(null==e||!e.colorTemperature)})))||void 0===r||null===(n=r.colorTemperature)||void 0===n?void 0:n.colorTemp},getSdkPath:function(e){var t,r,n=null!==(t=null===(r=d(e))||void 0===r?void 0:r.findIndex((function(e){return!(null==e||!e.colorTemperature)})))&&void 0!==t?t:0;return"extLst.ext[0].imgProps[0].imgLayer.imgEffect[".concat(n=n<0?0:n,"].colorTemperature.colorTemp")},title:u.a.t("色温"),defaultValue:6500,coefficient:1,dataType:o.number}};function d(e){var t,r,n,i,o,a;return null==e||null===(t=e.extLst)||void 0===t||null===(r=t.ext)||void 0===r||null===(n=r[0])||void 0===n||null===(i=n.imgProps)||void 0===i||null===(o=i[0])||void 0===o||null===(a=o.imgLayer)||void 0===a?void 0:a.imgEffect}function s(e){var t,r;return null===(t=d(e))||void 0===t||null===(r=t.find((function(e){return!(null==e||!e.brightnessContrast)})))||void 0===r?void 0:r.brightnessContrast}var f=(n={},l()(n,c.ClARITY.name,c.ClARITY.defaultValue),l()(n,c.BRIGHTNESS.name,c.BRIGHTNESS.defaultValue),l()(n,c.CONTRAST.name,c.CONTRAST.defaultValue),n),h=(i={},l()(i,c.SATURATE.name,c.SATURATE.defaultValue),l()(i,c.COLORTEMPERATURE.name,c.COLORTEMPERATURE.defaultValue),i)},"4203b66c5e":function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));r("73b854064b"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("547611bd96"),u=r.n(l),c=r("bd29e2df90"),d=r.n(c),s=r("ab5eb40518"),f=r.n(s),h=r("1b4cdd6a36"),p=r.n(h),v=r("85d0a7609b"),y=r.n(v),b=(r("8ee19818c4"),r("342844cefa"),r("9da6335152")),g=r("570b26a0fa"),m=r("9789b08c01"),O=r("b41a98a1ec"),k=r("4317629fd1"),S=r("8f58e78419"),P=r.n(S),C=r("ee6bb53310"),R=r.n(C),A=r("e9b1a65b0e"),M=r("3344f1a2e7"),T=r("65843d4926"),D=r("9b36746bc7"),F=r("75f19a1449"),E=r("5ce71228c0");function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var x=function(e,t){return e||t},L=function(e){d()(r,e);var t=w(r);function r(e){var n;return i()(this,r),n=t.call(this,e),y()(u()(n),"tableModel",void 0),y()(u()(n),"updateTableBorderInfo",(function(e){n.tableModel.uploadEditingCellData(!1),n.modifyBorderInfo(e),Object(g.tdw)({opername:b.e.DOC_PPT,module:b.d.PC_TABLE_FORMAT,action:b.b.TABLE_BORDER_COLOR})})),y()(u()(n),"clearTableBorderStyle",(function(){var e=n.tableModel.sdkData;e.api.transaction((function(){n.tableModel.uploadEditingCellData(!1),n.tableModel.props.items.forEach((function(t,r){t.forEach((function(t,n){var i={startRowIndex:r,startColIndex:n,rowSpan:1,colSpan:1};e.api.updateTableCellProperties({lnB:null,lnL:null,lnR:null,lnT:null},i)}))}))}))})),y()(u()(n),"updateTableBorderStyle",(function(e){n.tableModel.uploadEditingCellData(!1),n.modifyBorderStyle(e)})),y()(u()(n),"getBorderStyle",(function(e){var t=n.allOuterBorderExist(e),r=n.allInnerBorderExist(e),i=t&&r;return{border_none:n.allBorderNotExist(e),border_all:i,border_outer:t,border_inner:r,border_horizontal:e.horizontal,border_vertical:e.vertical,border_top:e.top,border_right:e.right,border_bottom:e.bottom,border_left:e.left}})),y()(u()(n),"allOuterBorderExist",(function(e){return e.left&&e.right&&e.top&&e.bottom})),y()(u()(n),"allInnerBorderExist",(function(e){return e.horizontal&&e.vertical})),y()(u()(n),"allBorderNotExist",(function(e){return!(e.left||e.right||e.top||e.bottom||e.horizontal||e.vertical)})),y()(u()(n),"caculateCellBorderStyle",(function(e,t,r){n.caculateCellTopBorderStyle(e,t,r),n.caculateCellBottomBorderStyle(e,t,r),n.caculateCellLeftBorderStyle(e,t,r),n.caculateCellRightBorderStyle(e,t,r)})),y()(u()(n),"caculateCellTopBorderStyle",(function(e,t,r){if(t){var i=r;t.top&&!t.top.noFill||(n.topAdjacentCellSelected(e.rowStart,e.colStart)?i.horizontal=!1:i.top=!1)}})),y()(u()(n),"caculateCellBottomBorderStyle",(function(e,t,r){if(t){var i=r;t.bottom&&!t.bottom.noFill||(n.bottomAdjacentCellSelected(e.rowEnd,e.colStart)?i.horizontal=!1:i.bottom=!1)}})),y()(u()(n),"caculateCellLeftBorderStyle",(function(e,t,r){if(t){var i=r;t.left&&!t.left.noFill||(n.leftAdjacentCellSelected(e.rowStart,e.colStart)?i.vertical=!1:i.left=!1)}})),y()(u()(n),"caculateCellRightBorderStyle",(function(e,t,r){if(t){var i=r;t.right&&!t.right.noFill||(n.rightAdjacentCellSelected(e.rowStart,e.colEnd)?i.vertical=!1:i.right=!1)}})),y()(u()(n),"updateHVState",(function(e){1===n.tableModel.selectedCellRanges.length&&(e.horizontal=!1,e.vertical=!1);var t=n.getSingleRowOrCol();t.rowStartIsSingle&&(e.horizontal=!1),t.colStartIsSingle&&(e.vertical=!1)})),y()(u()(n),"getSingleRowOrCol",(function(){var e,t,r,i;return null===(e=n.tableModel.selectedCellRanges)||void 0===e||null===(t=e.forEach)||void 0===t||t.call(e,(function(e){isNaN(r)?r=e.rowStart:r!==e.rowStart&&(r=-1),isNaN(i)?i=e.colStart:i!==e.colStart&&(i=-1)})),{rowStartIsSingle:-1!==r,colStartIsSingle:-1!==i}})),y()(u()(n),"modifyBorderStyle",(function(e){var t=[];n.tableModel.props.items.forEach((function(r,i){var o=[];r.forEach((function(t,r){if(!t.hMerge&&!t.vMerge&&n.tableModel.cellSelectedState(i,r,n.tableModel.selectedRange)){var a={},l=P()(t,"borders")||{};n.modifyCellTopBorderStyle(i,r,e,a,l),n.modifyCellBottomBorderStyle(i,r,e,a,l),n.modifyCellLeftBorderStyle(i,r,e,a,l),n.modifyCellRightBorderStyle(i,r,e,a,l);var u={borders:a};o.push(u)}else o.push(void 0)})),t.push(o)}));for(var r=0;r<n.tableModel.selectedCellRanges.length;r++){var i=n.tableModel.selectedCellRanges[r];n.modifyAdjacentBorderStyleForRange(e,i,t)}n.tableUpdateProps(t)})),y()(u()(n),"modifyCellTopBorderStyle",(function(e,t,r,i,o){var a=n.topAdjacentCellSelected(e,t)?r.border_horizontal:r.border_top;if(n.borderStyleChanged(o.top,a))if(a){var l=n.getRecentBorderColor();R()(i,"top.color",l),R()(i,"top.width",Object(M.C)(1)),R()(i,"top.tdColor",new F.a({rgbaStr:l}))}else R()(i,"top.noFill",1)})),y()(u()(n),"modifyCellBottomBorderStyle",(function(e,t,r,i,o){var a=n.bottomAdjacentCellSelected(e,t)?r.border_horizontal:r.border_bottom;if(n.borderStyleChanged(o.bottom,a))if(a){var l=n.getRecentBorderColor();R()(i,"bottom.color",l),R()(i,"bottom.width",Object(M.C)(1)),R()(i,"bottom.tdColor",new F.a({rgbaStr:l}))}else R()(i,"bottom.noFill",1)})),y()(u()(n),"modifyCellLeftBorderStyle",(function(e,t,r,i,o){var a=n.leftAdjacentCellSelected(e,t)?r.border_vertical:r.border_left;if(n.borderStyleChanged(o.left,a))if(a){var l=n.getRecentBorderColor();R()(i,"left.color",l),R()(i,"left.width",Object(M.C)(1)),R()(i,"left.tdColor",new F.a({rgbaStr:l}))}else R()(i,"left.noFill",1)})),y()(u()(n),"modifyCellRightBorderStyle",(function(e,t,r,i,o){var a=n.rightAdjacentCellSelected(e,t)?r.border_vertical:r.border_right;if(n.borderStyleChanged(o.right,a))if(a){var l=n.getRecentBorderColor();R()(i,"right.color",l),R()(i,"right.width",Object(M.C)(1)),R()(i,"right.tdColor",new F.a({rgbaStr:l}))}else R()(i,"right.noFill",1)})),y()(u()(n),"borderStyleChanged",(function(e,t){return!(!!(!e||Object.keys(e).length<=0||null!=e&&e.noFill)===!t)})),y()(u()(n),"modifyBorderInfo",(function(e){var t,r,i,o=n.tableModel;if(e){var a=e.tdColor,l=e.width,u=e.style;void 0!==a&&(t=a),void 0!==l&&(r=l),void 0!==u&&(i=u)}var c=[],d=Object(M.C)(1);o.props.items.forEach((function(e,a){var l=[];e.forEach((function(e,u){if(!e.hMerge&&!e.vMerge&&o.cellSelectedState(a,u,o.selectedRange)){var c,s,f=null===(c=n.tableModel.props.items)||void 0===c||null===(s=c[a])||void 0===s?void 0:s[u],h=(null==f?void 0:f.borders)||{},p=h.left,v=h.top,y=h.bottom,b=h.right,g={left:j({},null==p?void 0:p.border),top:j({},null==v?void 0:v.border),right:j({},null==b?void 0:b.border),bottom:j({},null==y?void 0:y.border)};t&&(R()(g,"top.color",t.srgbColor),R()(g,"left.color",t.srgbColor),R()(g,"bottom.color",t.srgbColor),R()(g,"right.color",t.srgbColor),R()(g,"top.tdColor",t),R()(g,"left.tdColor",t),R()(g,"bottom.tdColor",t),R()(g,"right.tdColor",t),R()(g,"top.width",x(x(r,P()(e.borders,"top.border.width")),d)),R()(g,"left.width",x(x(r,P()(e.borders,"left.border.width")),d)),R()(g,"bottom.width",x(x(r,P()(e.borders,"bottom.border.width")),d)),R()(g,"right.width",x(x(r,P()(e.borders,"right.border.width")),d))),r&&(R()(g,"top.width",x(x(r,P()(e.borders,"top.border.width")),d)),R()(g,"left.width",x(x(r,P()(e.borders,"left.border.width")),d)),R()(g,"bottom.width",x(x(r,P()(e.borders,"bottom.border.width")),d)),R()(g,"right.width",x(x(r,P()(e.borders,"right.border.width")),d))),i&&(R()(g,"top.style",i),R()(g,"left.style",i),R()(g,"bottom.style",i),R()(g,"right.style",i)),null===t&&(R()(g,"top.noFill",1),R()(g,"left.noFill",1),R()(g,"bottom.noFill",1),R()(g,"right.noFill",1)),l.push({borders:g})}else l.push(void 0)})),c.push(l)})),o.selectedCellRanges.forEach((function(t){n.modifyAdjacentBorderColorForRange(e,r,t,c)})),n.tableUpdateProps(c)})),y()(u()(n),"topAdjacentCellSelected",(function(e,t){if(e>0){var r=e-1,i=t;return n.tableModel.cellCoordsInSelectedRanges(r,i,n.tableModel.selectedCellRanges)}return!1})),y()(u()(n),"bottomAdjacentCellSelected",(function(e,t){if(e<n.tableModel.props.rowHeights.length-1){for(var r=e+1;null!==(i=n.tableModel.props.items)&&void 0!==i&&null!==(o=i[r])&&void 0!==o&&null!==(a=o[t])&&void 0!==a&&a.vMerge;){var i,o,a;r+=1}var l=t;return n.tableModel.cellCoordsInSelectedRanges(r,l,n.tableModel.selectedCellRanges)}return!1})),y()(u()(n),"leftAdjacentCellSelected",(function(e,t){if(t>0){var r=e,i=t-1;return n.tableModel.cellCoordsInSelectedRanges(r,i,n.tableModel.selectedCellRanges)}return!1})),y()(u()(n),"rightAdjacentCellSelected",(function(e,t){if(t<n.tableModel.props.colWidths.length-1){for(var r=e,i=t+1;null!==(o=n.tableModel.props.items)&&void 0!==o&&null!==(a=o[e])&&void 0!==a&&null!==(l=a[i])&&void 0!==l&&l.hMerge;){var o,a,l;i+=1}return n.tableModel.cellCoordsInSelectedRanges(r,i,n.tableModel.selectedCellRanges)}return!1})),n.tableModel=e,n}return a()(r,[{key:"getTableBorderInfo",value:function(){var e,t=this,r=null,n={horizontal:!0,vertical:!0,left:!0,right:!0,top:!0,bottom:!0};this.tableModel.selectedCellRanges&&(this.updateHVState(n),null===(e=this.tableModel.selectedCellRanges)||void 0===e||e.forEach((function(e){var i=e.rowStart,o=e.colStart,a=t.tableModel.tableItems[i][o],l=P()(a,"borders");l&&void 0!==r&&Object.keys(l).forEach((function(e){var t=P()(l[e],"border");if(null===r)r=t;else if(!Object(m.d)(r,t,O.c)){var n=Object(m.c)(r,t);Object.keys(n).forEach((function(e){r&&delete r[e]}))}}));t.caculateCellBorderStyle(e,l,n)})));return{borderStyle:this.getBorderStyle(n),borderColor:"string"==typeof r?{color:r}:r}}},{key:"modifyAdjacentBorderStyleForRange",value:function(e,t,r){for(var n=t.rowStart;n<=t.rowEnd;n++)for(var i=t.colStart;i<=t.colEnd;i++)this.modifyAdjacentBorderStyleForRangeTop(e,t,r,n,i),this.modifyAdjacentBorderStyleForRangeBottom(e,t,r,n,i),this.modifyAdjacentBorderStyleForRangeLeft(e,t,r,n,i),this.modifyAdjacentBorderStyleForRangeRight(e,t,r,n,i)}},{key:"modifyAdjacentBorderStyleForRangeTop",value:function(e,t,r,n,i){n===t.rowStart&&n>0&&!this.topAdjacentCellSelected(n,i)&&this.modifyTopAdjacentCellBorderStyle(n,i,e,r)}},{key:"modifyAdjacentBorderStyleForRangeBottom",value:function(e,t,r,n,i){n===t.rowEnd&&n<this.tableModel.props.rowHeights.length-1&&!this.bottomAdjacentCellSelected(n,i)&&this.modifyBottomAdjacentCellBorderStyle(n,i,e,r)}},{key:"modifyAdjacentBorderStyleForRangeLeft",value:function(e,t,r,n,i){i===t.colStart&&i>0&&!this.leftAdjacentCellSelected(n,i)&&this.modifyLeftAdjacentCellBorderStyle(n,i,e,r)}},{key:"modifyAdjacentBorderStyleForRangeRight",value:function(e,t,r,n,i){i===t.colEnd&&i<this.tableModel.props.colWidths.length-1&&!this.rightAdjacentCellSelected(n,i)&&this.modifyRightAdjacentCellBorderStyle(n,i,e,r)}},{key:"modifyTopAdjacentCellBorderStyle",value:function(e,t,r,n){var i=n,o=this.tableModel.getMergedCellRangeForCoords(e-1,t),a=o.rowStart,l=o.colStart,u=this.tableModel.props.items[a][l];if(l>=t){var c=i[a][l]||{borders:{}},d=P()(u,"borders.bottom")||{},s=j({},d),f=r.border_top;if(this.borderStyleChanged(d,f)){if(f){var h=this.getRecentBorderColor();R()(s,"color",h),R()(s,"tdColor",new F.a({rgbaStr:h})),s.width||(s.width=Object(M.C)(1))}else R()(s,"noFill",1);R()(c,"borders.bottom",s),i[a][l]=c}}}},{key:"modifyBottomAdjacentCellBorderStyle",value:function(e,t,r,n){var i=n,o=this.tableModel.getMergedCellRangeForCoords(e+1,t),a=o.rowStart,l=o.colStart,u=this.tableModel.props.items[a][l];if(l>=t){var c=i[a][l]||{borders:{}},d=P()(u,"borders.top")||{},s=j({},d),f=r.border_bottom;if(this.borderStyleChanged(d,f)){if(f){var h=this.getRecentBorderColor();R()(s,"color",h),R()(s,"tdColor",new F.a({rgbaStr:h})),s.width||(s.width=Object(M.C)(1))}else R()(s,"noFill",1);R()(c,"borders.top",s),i[a][l]=c}}}},{key:"modifyLeftAdjacentCellBorderStyle",value:function(e,t,r,n){var i=n,o=this.tableModel.getMergedCellRangeForCoords(e,t-1),a=o.rowStart,l=o.colStart,u=this.tableModel.props.items[a][l];if(a>=e){var c=i[a][l]||{borders:{}},d=P()(u,"borders.right")||{},s=j({},d),f=r.border_left;if(this.borderStyleChanged(d,f)){if(f){var h=this.getRecentBorderColor();R()(s,"color",h),R()(s,"tdColor",new F.a({rgbaStr:h})),s.width||(s.width=Object(M.C)(1))}else R()(s,"noFill",1);R()(c,"borders.right",s),i[a][l]=c}}}},{key:"modifyRightAdjacentCellBorderStyle",value:function(e,t,r,n){var i=n,o=this.tableModel.getMergedCellRangeForCoords(e,t+1),a=o.rowStart,l=o.colStart,u=this.tableModel.props.items[a][l];if(a>=e){var c=i[a][l]||{borders:{}},d=P()(u,"borders.left")||{},s=j({},d),f=r.border_right;if(this.borderStyleChanged(d,f)){if(f){var h=this.getRecentBorderColor();R()(s,"color",h),R()(s,"tdColor",new F.a({rgbaStr:h})),s.width||(s.width=Object(M.C)(1))}else R()(s,"noFill",1);R()(c,"borders.left",s),i[a][l]=c}}}},{key:"getRecentBorderColor",value:function(){var e=E.b.getItem(E.a.BORDER_COLOR_RECENT_COLOR);return e&&e!==k.a||(e="#999999"),e}},{key:"modifyAdjacentBorderColorForRange",value:function(e,t,r,n){for(var i=r.rowStart;i<=r.rowEnd;i++)for(var o=r.colStart;o<=r.colEnd;o++)this.modifyAdjacentBorderColorForRangeTop(e,t,r,n,i,o),this.modifyAdjacentBorderColorForRangeBottom(e,t,r,n,i,o),this.modifyAdjacentBorderColorForRangeLeft(e,t,r,n,i,o),this.modifyAdjacentBorderColorForRangeRight(e,t,r,n,i,o)}},{key:"modifyAdjacentBorderColorForRangeTop",value:function(e,t,r,n,i,o){i===r.rowStart&&i>0&&!this.topAdjacentCellSelected(i,o)&&this.modifyTopAdjacentCellBorderColor(i,o,e,t,n)}},{key:"modifyAdjacentBorderColorForRangeBottom",value:function(e,t,r,n,i,o){i===r.rowEnd&&i<this.tableModel.props.rowHeights.length-1&&!this.bottomAdjacentCellSelected(i,o)&&this.modifyBottomAdjacentCellBorderColor(i,o,e,t,n)}},{key:"modifyAdjacentBorderColorForRangeLeft",value:function(e,t,r,n,i,o){o===r.colStart&&o>0&&!this.leftAdjacentCellSelected(i,o)&&this.modifyLeftAdjacentCellBorderColor(i,o,e,t,n)}},{key:"modifyAdjacentBorderColorForRangeRight",value:function(e,t,r,n,i,o){o===r.colEnd&&o<this.tableModel.props.colWidths.length-1&&!this.rightAdjacentCellSelected(i,o)&&this.modifyRightAdjacentCellBorderColor(i,o,e,t,n)}},{key:"modifyTopAdjacentCellBorderColor",value:function(e,t,r,n,i){var o=i,a=Object(M.C)(1),l=o[e][t],u=this.tableModel.getMergedCellRangeForCoords(e-1,t),c=u.rowStart,d=u.colStart;if(d>=t){var s,f=x(o[c][d],{borders:{}}),h=this.tableModel.props.items[c][d],p={},v=(null==l||null===(s=l.borders)||void 0===s?void 0:s.top)||{},y=v.tdColor,b=v.width,g=v.style;y&&(R()(p,"color",y.srgbColor),R()(p,"tdColor",y)),b&&R()(p,"width",x(x(b,P()(h.borders,"bottom.border.width")),a)),g&&R()(p,"style",g),null===y&&R()(p,"noFill",1),R()(f,"borders.bottom",p),o[c][d]=f}}},{key:"modifyBottomAdjacentCellBorderColor",value:function(e,t,r,n,i){var o=i,a=Object(M.C)(1),l=this.tableModel.getMergedCellRangeForCoords(e+1,t),u=l.rowStart,c=l.colStart;if(c>=t){var d,s=x(o[u][c],{borders:{}}),f=this.tableModel.props.items[u][c],h={},p=o[e][t],v=(null==p||null===(d=p.borders)||void 0===d?void 0:d.bottom)||{},y=v.tdColor,b=v.width,g=v.style;y&&(R()(h,"color",y.srgbColor),R()(h,"tdColor",y)),b&&R()(h,"width",x(x(b,P()(f.borders,"bottom.border.width")),a)),null===y&&R()(h,"noFill",1),g&&R()(h,"style",g),R()(s,"borders.top",h),o[u][c]=s}}},{key:"modifyLeftAdjacentCellBorderColor",value:function(e,t,r,n,i){var o=i,a=Object(M.C)(1),l=this.tableModel.getMergedCellRangeForCoords(e,t-1),u=l.rowStart,c=l.colStart;if(u>=e){var d,s=x(o[u][c],{borders:{}}),f=this.tableModel.props.items[u][c],h={},p=o[e][t],v=(null==p||null===(d=p.borders)||void 0===d?void 0:d.left)||{},y=v.tdColor,b=v.width,g=v.style;y&&(R()(h,"color",y.srgbColor),R()(h,"tdColor",y)),b&&R()(h,"width",x(x(b,P()(f.borders,"bottom.border.width")),a)),null===y&&R()(h,"noFill",1),g&&R()(h,"style",g),R()(s,"borders.right",h),o[u][c]=s}}},{key:"modifyRightAdjacentCellBorderColor",value:function(e,t,r,n,i){var o=i,a=Object(M.C)(1),l=this.tableModel.getMergedCellRangeForCoords(e,t+1),u=l.rowStart,c=l.colStart;if(u>=e){var d,s=x(o[u][c],{borders:{}}),f=this.tableModel.props.items[u][c],h={},p=o[e][t],v=(null==p||null===(d=p.borders)||void 0===d?void 0:d.right)||{},y=v.tdColor,b=v.width,g=v.style;y&&(R()(h,"color",y.srgbColor),R()(h,"tdColor",y)),b&&R()(h,"width",x(x(b,P()(f.borders,"bottom.border.width")),a)),null===y&&R()(h,"noFill",1),g&&R()(h,"style",g),R()(s,"borders.left",h),o[u][c]=s}}},{key:"tableUpdateProps",value:function(e){var t=this.tableModel.sdkData;t.api.transaction((function(){e.forEach((function(e,r){e.forEach((function(e,n){if(e){var i={};D.a.convertPartialDataFromUiToSdk(e,i);var o={startRowIndex:r,startColIndex:n,rowSpan:1,colSpan:1};i.tcPr&&(Object(T.a)(i.tcPr),t.api.updateTableCellProperties(i.tcPr,o))}}))}))}))}}]),r}(A.a)},"423ed06f51":function(e,t,r){"use strict";r.d(t,"a",(function(){return Y}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("b8217400dc"),r("e6f68cdf2e"),r("e0e8dd9366")),d=function(){function e(t){i()(this,e),u()(this,"model",void 0),this.model=t}return a()(e,[{key:"getCopiedUiModelWithSdkModel",value:function(e){return e.sdkData=this.model.sdkData,e.parent=this.model.slideRef,e.asyncConvertChildren=!1,e.doConvertSdkDataModelToUiData(this.model.sdkData).catch(),e.isPlaceholder=!1,this.model.placeHolder&&(e.placeHolder=void 0),e}}]),e}(),s=(r("73b854064b"),r("547611bd96")),f=r.n(s),h=r("8eec1e4a03"),p=r.n(h),v=r("bd29e2df90"),y=r.n(v),b=r("ab5eb40518"),g=r.n(b),m=r("1b4cdd6a36"),O=r.n(m),k=(r("8ee19818c4"),r("fce3077cdf"),r("939b677bb3")),S=r("98efcda99e"),P=r.n(S),C=r("285f8ccc4f"),R=r("ee6bb53310"),A=r.n(R);function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var T=function(){function e(t){i()(this,e),u()(this,"model",void 0),this.model=t}return a()(e,[{key:"getCopiedSdkModel",value:function(e){var t,r,n=null==e?void 0:e.cloneCustomizer,i=this.model.sdkData,o=null!=e&&e.withoutOwnedData?{}:this.copiedCloneDeep(null==i||null===(t=i.getOwnedData)||void 0===t?void 0:t.call(i),n);return{inheritedSdkData:null!=e&&e.withoutInheritedData?{}:this.copiedCloneDeep(null==i||null===(r=i.getInheritedData)||void 0===r?void 0:r.call(i),n),ownSdkData:o}}},{key:"copiedCloneDeep",value:function(e,t){return t?Object(C.b)(e,t):Object(C.a)(e)}}]),e}(),D=function(e){y()(r,e);var t=M(r);function r(e){var n;return i()(this,r),n=t.call(this,e),u()(f()(n),"elementBaseModel",void 0),n.elementBaseModel=e,n}return a()(r,[{key:"getCopiedSdkModel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getEleCopiedSdkModelV3(e)}},{key:"getEleCopiedSdkModelV3",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=p()(O()(r.prototype),"getCopiedSdkModel",this).call(this,n);return i?((null===(e=this.elementBaseModel.parent)||void 0===e?void 0:e.type)===c.d.GROUP&&Object.values(i).forEach((function(e){t.modifyChildInGroup(e)})),n.isOriginal||this.elementBaseModel.type!==c.d.IMAGE&&this.elementBaseModel.type!==c.d.TABLE&&this.elementBaseModel.type!==c.d.CHART||Object.values(i).forEach((function(e){P()(e.nvPr,"ph")})),i):{}}},{key:"modifyChildInGroup",value:function(e){var t,r,n=null===(t=(r=this.elementBaseModel).getFrame)||void 0===t?void 0:t.call(r).frameOnSlide();e.spPr.xfrm=k.a.convertPartialDataFromUiToSdk(n,{scaleX:1,scaleY:1,left:0,top:0},!1),this.copyGroupBg(this.elementBaseModel.sdkData,e)}},{key:"copyGroupBg",value:function(e,t){for(var r=e;!0===(null===(n=r)||void 0===n||null===(i=n.store)||void 0===i||null===(o=i.data)||void 0===o||null===(a=o.spPr)||void 0===a?void 0:a.grpFill);){var n,i,o,a;r=r.parent}r&&r!==e&&["solidFill","gradFill","blipFill","pattFill","noFill"].forEach((function(e){var n,i,o;null!==(n=r.store)&&void 0!==n&&null!==(i=n.data)&&void 0!==i&&null!==(o=i.spPr)&&void 0!==o&&o[e]&&A()(t,"spPr.".concat(e),Object(C.a)(r.store.data.spPr[e]))}))}}]),r}(T);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var E=function(e){y()(r,e);var t=F(r);function r(e){var n;return i()(this,r),n=t.call(this,e),u()(f()(n),"sectionMode",void 0),n.sectionMode=e,n}return a()(r,[{key:"getCopiedSdkModel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.sectionMode.sdkData)return p()(O()(r.prototype),"getCopiedSdkModel",this).call(this,e)}}]),r}(T),I=(r("342844cefa"),r("7c46f42788")),j=r("711a53c9fc"),w=r("a42b29265b");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var L=function(e){y()(r,e);var t=x(r);function r(e){var n;return i()(this,r),n=t.call(this,e),u()(f()(n),"shapeModel",void 0),n.shapeModel=e,n}return a()(r,[{key:"getCopiedSdkModel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getCopiedSdkModelV3(e)}},{key:"getCopiedSdkModelV3",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.isOriginal,i=p()(O()(r.prototype),"getCopiedSdkModel",this).call(this,t);if(i)return n||Object.keys(i).forEach((function(t){var r,n=i[t];!(null!=n&&n.isPlaceholder||null!=n&&null!==(r=n.nvPr)&&void 0!==r&&r.ph)||null!=n&&n.isCustomPlaceholder||A()(n,"nvPr.txBox",!0),e.isCopiedPlaceholder(n)?A()(n,"nvPr.txBox",!1):e.updatePlaceHolderSdkData(i,t)})),i}},{key:"updatePlaceHolderSdkData",value:function(e,t){var r,n=e[t];if(n.type!==I.a.GroupShape&&null!==(r=n.nvPr)&&void 0!==r&&r.ph)if(t!==w.a.INHERIT){var i=e[w.a.INHERIT].spPr.xfrm;A()(n,"spPr.xfrm",i)}else P()(n.nvPr,"ph")}},{key:"isCopiedPlaceholder",value:function(e){var t,r;return!!this.shapeModel.isPlaceholder&&((null===(t=this.shapeModel.parent)||void 0===t?void 0:t.type)===c.d.LAYOUT&&![j.U.title,j.U.dt,j.U.ftr,j.U.sldNum].includes(null===(r=e.nvPr.ph)||void 0===r?void 0:r.type))}}]),r}(D);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var N=function(e){y()(r,e);var t=B(r);function r(e){var n;return i()(this,r),n=t.call(this,e),u()(f()(n),"groupModel",void 0),n.groupModel=e,n}return a()(r,[{key:"getCopiedSdkModel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.groupModel.sdkData;if(t){var n=p()(O()(r.prototype),"getCopiedSdkModel",this).call(this,e);if(n)return e.withoutInheritedData||r.recursiveCopiedGroupSdkData(n.inheritedSdkData,t),n}}}],[{key:"recursiveCopiedGroupSdkData",value:function(e,t){var r,n=this;e.shapeList||(e.shapeList=[]),null===(r=t.shapeList)||void 0===r||r.forEach((function(t){var r=Object(C.a)(t.getInheritedData());e.shapeList.push(r),t.type===I.a.GroupShape&&n.recursiveCopiedGroupSdkData(r,t)}))}}]),r}(D);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var G=function(e){y()(r,e);var t=U(r);function r(e){var n;return i()(this,r),n=t.call(this,e),u()(f()(n),"smartArtModel",void 0),n.smartArtModel=e,n}return a()(r,[{key:"getCopiedSdkModel",value:function(){if(this.smartArtModel.sdkData){var e=p()(O()(r.prototype),"getCopiedSdkModel",this).call(this);return e.inheritedSdkData.diagram||(e.inheritedSdkData.diagram=e.ownSdkData.diagram),e}}}]),r}(D);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var V=function(e){y()(r,e);var t=_(r);function r(e){var n;return i()(this,r),n=t.call(this,e),u()(f()(n),"pageModel",void 0),n.pageModel=e,n}return a()(r,[{key:"getCopiedSdkModel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.pageModel.sdkData;if(t){var n=p()(O()(r.prototype),"getCopiedSdkModel",this).call(this,e);if(n)return e.withoutInheritedData||this.recursiveCopiedSdkModelForData(n.inheritedSdkData,t),n}}},{key:"recursiveCopiedSdkModelForData",value:function(e,t){var r,n;null!==(r=e.cSld.spTree)&&void 0!==r&&r.shapeList||A()(e,"cSld.spTree.shapeList",[]),null===(n=t.shapeList)||void 0===n||n.forEach((function(t){var r,n=Object(C.a)(t.getInheritedData());null===(r=e.cSld.spTree)||void 0===r||r.shapeList.push(n),t.type===I.a.GroupShape&&N.recursiveCopiedGroupSdkData(n,t)}))}}]),r}(T);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g()(this,r)}}var z=function(e){y()(r,e);var t=H(r);function r(e){var n;return i()(this,r),n=t.call(this,e),u()(f()(n),"themeModel",void 0),n.themeModel=e,n}return a()(r,[{key:"getCopiedSdkModel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.themeModel.sdkData)return p()(O()(r.prototype),"getCopiedSdkModel",this).call(this,e)}}]),r}(T),W=[c.d.GROUP,c.d.CHART,c.d.SHAPE,c.d.TABLE,c.d.IMAGE,c.d.CONNECTOR],Y=function(){function e(t){i()(this,e),u()(this,"model",void 0),this.model=t}return a()(e,[{key:"getCopiedSdkModel",value:function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(this.model.type){case c.d.SLIDE:case c.d.LAYOUT:case c.d.MASTER:r=new V(this.model);break;case c.d.THEME:r=new z(this.model);break;case c.d.NOTE:r={};break;default:r=function(e){switch(e.type){case c.d.SHAPE:return new L(e);case c.d.GROUP:return new N(e);case c.d.SMART_ART:return new G(e);case c.d.SECTION:return new E(e);case c.d.IMAGE:case c.d.TABLE:case c.d.CHART:return new D(e);default:return new T(e)}}(this.model)}return null===(e=(t=r).getCopiedSdkModel)||void 0===e?void 0:e.call(t,n)}},{key:"getCopiedUiModelWithSdkModel",value:function(e){return W.includes(this.model.type)?new d(this.model).getCopiedUiModelWithSdkModel(e):null}}]),e}()},"44c7584d18":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return l})),r.d(t,"c",(function(){return u}));r("b8217400dc"),r("e6f68cdf2e"),r("826dc923b3"),r("1bab7b5fb7"),r("34cd92f77a"),r("433247001a"),r("bd80bf2d0f");var n=r("d292a8cd59"),i=r.n(n),o=r("e49595a6eb"),a=function(e,t){var r;if(null==e)return"";if(null!==(r=t)&&void 0!==r&&r.includes("General"))return e;"m/d/yy"===t&&(t="yyyy/m/d");var n=i.a.createInstance({pattern:t}),a=Object(o.fmtIsDate)(t||"");t&&a&&e>60&&(e-=1);try{var l,u,c=Object(o.formatValue)(e,n,{});return t||isNaN(c.value)?a?null===(l=c.value)||void 0===l||null===(u=l.replace)||void 0===u?void 0:u.call(l,/ 0:00$/,""):c.value:Number(c.value)}catch(t){return console.error("getFormattedNumber err",t),e}},l="__cIndex:",u=function(e){return e.replace(new RegExp("".concat(l,"(\\d+)$")),"")}},"4e55019e41":function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));r("73b854064b"),r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("547611bd96"),u=r.n(l),c=r("bd29e2df90"),d=r.n(c),s=r("ab5eb40518"),f=r.n(s),h=r("1b4cdd6a36"),p=r.n(h),v=r("85d0a7609b"),y=r.n(v),b=r("e0e8dd9366"),g=r("7b0ebf3e1a"),m=r("9c5b376bf5"),O=r("029d6df9a6");function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var C=function(e){d()(r,e);var t=P(r);function r(e){var n;return i()(this,r),n=t.call(this,e),y()(u()(n),"groupFrameHanlder",void 0),n.groupFrameHanlder=new O.a(e),n}return a()(r,[{key:"frameOnSlide",value:function(e,t){return this.getFinalFrameInfo(t,!0,e)}},{key:"updateHeight",value:function(e){this.batchUpdateFrameHandler.batchUpdateHeight(S(S({},e),{},{value:[e.value],updateModelArr:[this.model]}))}},{key:"updateWidth",value:function(e){this.batchUpdateFrameHandler.batchUpdateWidth(S(S({},e),{},{value:[e.value],updateModelArr:[this.model]}))}},{key:"updateLeft",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateLeft([e],[this.model],t)}},{key:"updateTop",value:function(e,t){this.batchUpdateFrameHandler.batchUpdateTop([e],[this.model],t)}},{key:"updateRotate",value:function(e,t){this.model.type!==b.d.TABLE&&this.batchUpdateFrameHandler.batchUpdateRotate([e],[this.model],t)}},{key:"updateFrame",value:function(e){this.batchUpdateFrameHandler.batchUpdateFrame(S(S({},e),{},{frame:[e.frame],updateModelArr:[this.model]}))}},{key:"updateFrameOnSlide",value:function(e){this.batchUpdateFrameHandler.batchUpdateFrameOnSlide(S(S({},e),{},{frame:[e.frame],updateModelArr:[this.model]}))}},{key:"convertFrameOnSlideToSelf",value:function(e){return this.groupFrameHanlder.convertFrameOnSlideToSelf(e)}},{key:"boundingRectOnSlide",value:function(e,t){var r=this.frameOnSlide(e,t),n=r.rotate?r.rotate:0;return Object(g.j)(r,n)}},{key:"pointOnSlide",value:function(e,t){return this.groupFrameHanlder.pointOnSlide(e,t)}},{key:"pointToElement",value:function(e,t){return this.groupFrameHanlder.pointToElement(e,t)}},{key:"outerFrameOnSlide",value:function(){var e=this.frameOnSlide(void 0,!!this.model.operationFrame);return e.rotate?Object(g.j)(e,e.rotate):e}},{key:"getFinalFrameInfo",value:function(e,t,r){return t?this.groupFrameHanlder.frameOnSlide(r,e):this.getFinalFrame(this.model,e)}}]),r}(m.a)},"5dc281b610":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("8ee19818c4"),r("342844cefa"),r("b8217400dc"),r("e6f68cdf2e");var n=r("c962f63650"),i=r.n(n);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=i()(t);return Object.keys(e).forEach((function(i){var o;r.includes(i)&&r.some((function(e){return void 0!==t[e]}))||(n[i]=null!==(o=t[i])&&void 0!==o?o:e[i])})),n}},"5f9ccff4fc":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={FONTFAMILY:"fontfamily",FONT_COLOR:"font-color",FONT_SIZE:"font-size",FONT_SIZE_UP:"font-size-up",FONT_SIZE_DOWN:"font-size-down",BOLD:"bold",ITALIC:"italic"}},"672a8f3b69":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var n,i="sketchStyle";!function(e){e.NONE="lineSketchNone",e.CURVED="lineSketchCurved",e.FREEHAND="lineSketchFreehand",e.SCRIBBLE="lineSketchScribble"}(n||(n={}))},"6c6f5e596f":function(e,t,r){"use strict";r.d(t,"a",(function(){return q}));var n=r("14502724a6"),i=r.n(n),o=r("7a5536c9bf"),a=r.n(o),l=r("9132715560"),u=r.n(l),c=r("6a364eb35c"),d=r.n(c),s=r("85d0a7609b"),f=r.n(s),h=(r("8ee19818c4"),r("75563bc376"),r("342844cefa"),r("b8217400dc"),r("e6f68cdf2e"),r("8a35b54c1d"),r("2ba7871556")),p=r("9da6335152"),v=r("d3d31c86eb"),y=r("a859b64b06"),b=r("e0e8dd9366"),g=r("ee6bb53310"),m=r.n(g),O=(r("73b854064b"),r("bd29e2df90")),k=r.n(O),S=r("ab5eb40518"),P=r.n(S),C=r("1b4cdd6a36"),R=r.n(C),A=function e(){u()(this,e),f()(this,"fillInfo",void 0)};function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=R()(e);if(t){var i=R()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return P()(this,r)}}var T=function(e){k()(r,e);var t=M(r);function r(e){var n;return u()(this,r),n=t.call(this),e&&(n.fillInfo=e),n}return r}(A),D=r("0cf3719522"),F=r.n(D);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=R()(e);if(t){var i=R()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return P()(this,r)}}var I=function(e){k()(r,e);var t=E(r);function r(e){var n;return u()(this,r),n=t.call(this),"object"===F()(e)&&(n.fillInfo=e),n}return r}(A);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=R()(e);if(t){var i=R()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return P()(this,r)}}var w=function(e){k()(r,e);var t=j(r);function r(e){var n;return u()(this,r),n=t.call(this),e&&(n.fillInfo=e),n}return r}(A);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=R()(e);if(t){var i=R()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return P()(this,r)}}var L=function(e){k()(r,e);var t=x(r);function r(e){var n;return u()(this,r),n=t.call(this),e&&(n.fillInfo=e),n}return r}(A),B=r("730207179f"),N=r("9789b08c01"),U=r("96745b5cc3"),G=r("7d1df7d0fb"),_=r("0518261faf"),V=r("9b36746bc7"),H=r("65843d4926"),z=r("7b0ebf3e1a"),W=r("9657b29818"),Y=r("e388ef2636"),K=r("775b80aea6"),X=r("75f19a1449"),q=function(){function e(t){var r=this;u()(this,e),f()(this,"model",void 0),f()(this,"selectionService",void 0),f()(this,"mergePropertyValCache",void 0),f()(this,"getFillType",(function(){var e=r.getFillInfo();if(e&&!e.grpFill)return r.getFinalFillType(e)})),f()(this,"getShownFillType",(function(){var e=r.getFillInfo();if(e)return r.getFinalFillType(e)})),f()(this,"getFillInfo",(function(){if(r.model.type===b.d.MULTIPLY||r.model.type===b.d.TABLE)return r.mergePropertyValCache;if(!r.model.props)return null;var e=r.model.props.style;return r.setFillShownColor(e.fillBackground),Object(B.a)(e,"fillBackground"),e.fillBackground})),f()(this,"setFillShownColor",(function(e){var t,r,n;if(e){var i;if((null===(t=e.gradFill)||void 0===t||null===(r=t.gsList)||void 0===r?void 0:r.length)>0){var o,a=e.gradFill.gsList,l=a[a.length-1];i=null==l||null===(o=l.color)||void 0===o?void 0:o.srgb_color}else if(null!==(n=e.solidFill)&&void 0!==n&&n.color){var u;i=null===(u=e.solidFill)||void 0===u?void 0:u.color.srgb_color}i&&(e.color=i)}})),f()(this,"handleFill",(function(e,t,n){e.type===b.d.TABLE?r.handleTableFill(e,t,n):e.type===b.d.GROUP?r.handleGroupFill(e,t,n):r.updateModelFill(e,t,n)})),f()(this,"handleTableFill",(function(e,t,n){Object(W.b)((function(){n?null!==e.selectedCellRanges&&e.selectedCellRanges.forEach((function(r){var i=e.props.items[r.rowStart][r.colStart];i.parent=e.parent;var o=Object(N.a)(t,!0);i.getBackgroundFill().updateCurrentFill(o,n)})):(e.uploadEditingCellData(!1),r.modifyTableFillColor(e,t,n))}))})),f()(this,"modifyTableFillColor",(function(e,t,r){var n=[],i=[];if(e.props.items.forEach((function(o,a){var l=[],u=[];o.forEach((function(n,i){if(!n.hMerge&&!n.vMerge&&e.cellSelectedState(a,i,e.selectedRange)){var o=Object(N.a)(t,!0);if(r)m()(n,"props.style.fillBackground",o);else{var c={style:{fillBackground:o}},d=U.a.convertToUpdateAndRemove(c,n.props);l.push({props:d.update}),u.push({props:d.remove})}}else l.push(void 0),u.push(void 0)})),n.push(l),i.push(u)})),!r){var o=e.sdkData;Object(W.b)((function(){n.forEach((function(e,t){e.forEach((function(e,r){if(e){var n={};V.a.convertPartialDataFromUiToSdk(e,n);var i={startRowIndex:t,startColIndex:r,rowSpan:1,colSpan:1};n.tcPr&&(Object(H.a)(n.tcPr),o.api.updateTableCellProperties(n.tcPr,i))}}))}))}))}})),f()(this,"handleGroupFill",(function(e,t,n){Object(W.b)((function(){e.children.forEach((function(e){if(n){var r,i,o,a=e.props.style.fillBackground,l=t;null!=a&&a.grpFill&&(null===(r=l)||void 0===r||null===(i=r.gradFill)||void 0===i||null===(o=i.pathGradient)||void 0===o?void 0:o.path)===h.c.Shape&&(l=Object(N.b)(t),m()(l,"gradFill.pathGradient.path",h.c.Radial)),e.getBackgroundFill().updateCurrentFill(l,n)}else{var u;null!==(u=e.props.style.fillBackground)&&void 0!==u&&u.grpFill||e.getBackgroundFill().updateCurrentFill({grpFill:_.a},n)}})),r.updateModelFill(e,t,n),!n&&e.isRootGroup&&Y.a.caculateItemValues(e)}))})),f()(this,"getFinalFillType",(function(e){var t=Object.keys(h.b).find((function(t){return null==e?void 0:e[h.b[t]]}));return t?h.b[t]:void 0})),f()(this,"modifyFillInfo",(function(e){if(e.image){var t,r=K.a.getInstance();e.image.src=(null===(t=r.getResourceByUrl(e.image.src))||void 0===t?void 0:t.getCdnUrl())||e.image.src}})),this.model=t,this.mergePropertyValCache=null,this.selectionService=this.model.selectionService}return d()(e,[{key:"getShownColor",value:function(){var e=this.getFillInfo();return null==e?void 0:e.color}},{key:"getShownTdColor",value:function(){var e,t=this.getFillInfo();return null==t||null===(e=t.solidFill)||void 0===e?void 0:e.color}},{key:"getCurrentFill",value:function(){var e,t=this.getFillType(),r=this.getFillInfo();return t&&r?(e={},f()(e,h.b.SolidFill,new T(r[t])),f()(e,h.b.GradualFill,new I(r[t])),f()(e,h.b.ImageFill,new w(r[t])),f()(e,h.b.PattFill,new L(r[t])),f()(e,h.b.NoFill,null),e)[t]:null}},{key:"updateCurrentFillForCurrentModel",value:function(e){this.handleFill(this.model,Object(N.a)(e,!0),!1)}},{key:"updateCurrentFill",value:function(e,t){var r=this;this.modifyFillInfo(e),Object(W.b)((function(){var n,i=[];if(r.model.type===b.d.EMPTY||r.model.type===b.d.SLIDE){var o,l=(null===(o=r.selectionService)||void 0===o?void 0:o.selectedSlides.selectedArray)||[];i=l.length>0?a()(l):[r.model]}else i=r.model.type===b.d.MULTIPLY?a()(r.model.selectedModels):[r.model];null===(n=i)||void 0===n||n.forEach((function(n){r.handleFill(n,Object(N.a)(e,!0),t)}))}))}},{key:"getFillColor",value:function(){var e,t,r=this,n=this.getFillType();if(n){var i=(e={},f()(e,h.b.SolidFill,(function(){return r.getSolidFillColor()})),f()(e,h.b.GradualFill,(function(){return r.getGradientFillColor()})),f()(e,h.b.PattFill,(function(){return r.getPattFillColor()})),f()(e,h.b.ImageFill,(function(){return r.getImageFillColor()})),f()(e,h.b.NoFill,(function(){})),e);return null===(t=i[n])||void 0===t?void 0:t.call(i)}}},{key:"refreshMergePropertyValCache",value:function(){if([b.d.MULTIPLY,b.d.TABLE].includes(this.model.type)){var e=this.model,t=Object(G.d)(e,(function(e){var t;return f()({},h.a,null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillInfo())}));this.mergePropertyValCache=t[h.a]||null}return this.mergePropertyValCache}},{key:"getShadeTitleFrame",value:function(){var e,t,r=this.model.type;if((r===b.d.SLIDE||r===b.d.MASTER||r===b.d.LAYOUT)&&null!==(e=this.getFillInfo())&&void 0!==e&&e.shadeToTitle){var n=this.model.children.filter((function(e){return e.isTitleOrCtrTitlePl})),o=i()(n,1)[0];if(o){var a=Object(z.j)(o.props.style,null!==(t=o.props.style.rotate)&&void 0!==t?t:0),l=a.left,u=a.top,c=a.height;return{left:l,top:u,width:a.width,height:c}}}}},{key:"updateModelFill",value:function(e,t,r){var n={style:{fillBackground:t}};if(r)this.adjustProps(t),y.a.updateUiProps(n,e),void 0!==e.previewChange&&(e.previewChange+=1);else{var i=U.a.convertToUpdateAndRemove(n,e.props);null!=t&&t.image||i.remove?e.updateAndRemoveProps(i.update,i.remove):e.updateProps(i.update),this.handleUpdateFillReport(n)}}},{key:"adjustProps",value:function(e){if(e){["solidFill","gradFill","image"].forEach((function(t){e[t]||(e[t]=null)}))}}},{key:"handleUpdateFillReport",value:function(e){var t,r,n;null!==(t=e.style.fillBackground)&&void 0!==t&&t.gradFill?n=p.b.CLK_CHANGE_COLOR:null!==(r=e.style.fillBackground)&&void 0!==r&&r.image&&(n=p.b.CLK_STUFF_IMG),n&&Object(v.c)({opername:p.e.DOC_PPT,module:p.d.PC_EDIT_FORMAT,action:n})}},{key:"getSolidFillColor",value:function(){var e,t=null===(e=this.getCurrentFill())||void 0===e?void 0:e.fillInfo;return null==t?void 0:t.color}},{key:"getGradientFillColor",value:function(){var e,t,r,n=null===(e=this.getCurrentFill())||void 0===e?void 0:e.fillInfo;return null==n||null===(t=n.gsList)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.color}},{key:"getPattFillColor",value:function(){var e,t,r=null===(e=this.getCurrentFill())||void 0===e?void 0:e.fillInfo;return null==r||null===(t=r.fgColor)||void 0===t?void 0:t.color}},{key:"getImageFillColor",value:function(){return new X.a({rgbaStr:"#ffffff"})}}]),e}()},"6ed1f9725a":function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n,i,o,a,l,u,c,d=r("176815363d"),s=r.n(d),f=r("6a364eb35c"),h=r.n(f),p=r("1f925d7f50"),v=r.n(p),y=r("9132715560"),b=r.n(y),g=r("85d0a7609b"),m=r.n(g),O=r("2dc700e1e6"),k=r.n(O),S=(r("f1054791f4"),r("3ef2352f0b")),P=r.n(S),C=(r("826dc923b3"),r("c6244f7705"),r("081c8cafea"),r("ee6bb53310")),R=r.n(C),A=r("e0e8dd9366"),M=r("d5c3deb8c7"),T=r("d9aec3d919"),D=r("e07d40ec82"),F=(n=Reflect.metadata("design:type",void 0===T.a?Object:T.a),i=Reflect.metadata("design:type",String),o=Reflect.metadata("design:type",Number),a=function e(){b()(this,e),m()(this,"type",A.d.GUIDES),v()(this,"orient",l,this),v()(this,"color",u,this),v()(this,"pos",c,this)},l=k()(a.prototype,"orient",[M.q,n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=k()(a.prototype,"color",[M.q,i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=k()(a.prototype,"pos",[M.q,o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),function(){function e(){b()(this,e),m()(this,"slideGuideList",[]),m()(this,"type",A.d.GUIDES),m()(this,"sdkData",void 0)}var t;return h()(e,[{key:"bindSDK",value:(t=s()(P.a.mark((function t(r){return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r?(this.sdkData=r,e.convertDataSdkToUi(this.sdkData,this)):this.unbindSDK();case 1:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})},{key:"unbindSDK",value:function(){this.sdkData&&(this.sdkData=null)}}],[{key:"convertDataUiToSdk",value:function(e){return D.a.convertPartialDataFromUiToSdk(e||[])}},{key:"convertDataSdkToUi",value:function(e,t){var r;null!=e&&null!==(r=e.props)&&void 0!==r&&r.slideGuideList&&R()(t,"slideGuideList",D.a.convertPartialDataFromSdkToUi(e.props.slideGuideList))}}]),e}())},"6fdf19cac3":function(e,t,r){},7288817546:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.WIDTH="width",e.HEIGHT="height",e.LEFT="left",e.TOP="top",e.ROTATE="rotate"}(n||(n={}))},"73f8a2368f":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o}));r("4bbb5840d5"),r("1bab7b5fb7"),r("34cd92f77a"),r("22569efd03");var n=r("f08da50217");function i(e,t){return t[e-1].uniqueID}function o(e,t){if(e.startsWith("/ppt/slides/slide"))return e.replace(/[^0-9]/g,"");var r=t.findIndex((function(t){return(null==t?void 0:t.uniqueID)===e}));return r<0?n.a:String(r+1)}},"75f19a1449":function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return v}));var n=r("14502724a6"),i=r.n(n),o=r("9132715560"),a=r.n(o),l=r("6a364eb35c"),u=r.n(l),c=r("85d0a7609b"),d=r.n(c),s=(r("826dc923b3"),r("b4638a0243"),r("1bab7b5fb7"),r("0aeae65bf4"),r("3bf1976a4f"),r("963f2eaace"),r("c6244f7705"),r("bd80bf2d0f"),r("7a3400cab1"),r("3823a0b5bb"),r("34cd92f77a"),r("4bbb5840d5"),r("6e20b6a7d8"),r("147aa73f92")),f=r("711a53c9fc"),h=function(e){return e>100&&(e=100),Number((1-e/100).toFixed(2))};function p(e){var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d)?)[\s+]?/i);return t&&t.length>=4?{hex:"#".concat("0".concat(parseInt(t[1],10).toString(16)).slice(-2)).concat("0".concat(parseInt(t[2],10).toString(16)).slice(-2)).concat("0".concat(parseInt(t[3],10).toString(16)).slice(-2)).toUpperCase(),o:+t[4]}:e}var v=function(){function e(t){if(a()(this,e),d()(this,"colorType","rgb"),d()(this,"colorValue","FFFFFF"),d()(this,"lumMod",null),d()(this,"lumOff",null),d()(this,"shade",null),d()(this,"tint",null),d()(this,"srgbColor",""),d()(this,"originAlpha",1),t){var r=t.rgbaStr,n=t.srgbClr,i=t.themeKey,o=t.lumOff,l=t.lumMod,u=t.alpha,c=t.shade,f=t.tint;if(i){if(this.colorValue=i,r){var h=Object(s.a)(r);this.srgb_color=Object(s.i)(h.colorValue,this.alpha),this.alpha=Math.min(Math.max(h.alpha,0),1)}else this.alpha=1;this.lumOff=o,this.lumMod=l,this.shade=c,this.tint=f}else if(r&&r.length>0){var p=Object(s.a)(r);this.colorValue=p.colorValue,this.alpha=Math.min(Math.max(p.alpha,0),1),this.srgb_color=Object(s.i)(this.colorValue,this.alpha)}else if(n){var v,y,b,g,m;this.colorValue=null!==(v=null==n?void 0:n.val)&&void 0!==v?v:"",this.alpha=(null!==(y=null==n||null===(b=n.egColorTransform)||void 0===b||null===(g=b[0])||void 0===g||null===(m=g.alpha)||void 0===m?void 0:m.val)&&void 0!==y?y:1e5)/1e5,this.srgb_color=Object(s.i)(this.colorValue,this.alpha)}(null!=u?u:Number.isSafeInteger(u))&&(this.alpha=u||1)}}return u()(e,[{key:"rgba",get:function(){return Object(s.j)(this.srgb_color,this.alpha)}},{key:"rgb",get:function(){return e.rgbaToRgb(this.rgba)}},{key:"alpha",get:function(){return this.originAlpha},set:function(e){e>1&&(e=1),this.originAlpha=e,this.srgb_color&&(this.srgb_color=Object(s.i)(this.srgb_color.slice(0,7),e))}},{key:"srgb_color",get:function(){return this.srgbColor},set:function(e){var t;this.srgbColor=null==e||null===(t=e.toLowerCase)||void 0===t?void 0:t.call(e)}},{key:"isSchemeColor",get:function(){return!!f.eb[this.colorValue]}},{key:"hsl",get:function(){return e.rgb2Hsl(e.hexToIRgb(this.srgb_color))}},{key:"toPropValue",value:function(){return{color:{alpha:this.alpha,colorType:this.colorType,colorValue:this.colorValue,lumMod:this.lumMod,lumOff:this.lumOff,shade:this.shade,tint:this.tint,srgb_color:this.srgb_color,rgba:this.rgba,rgb:this.rgb}}}},{key:"updateCustomColor",value:function(t){var r,n=e.formatColor(t),i=(r=this.alpha,Math.round(100*(1-r))),o=p(n).slice(0,7);this.colorValue=o.replace("#",""),this.srgb_color=e.formatColor(e.getOpacityChangedColor(i,o))}},{key:"updateOpacity",value:function(e){this.alpha=h(e)}},{key:"getColorWithNoAlpha",value:function(){return this.srgb_color.slice(0,this.srgb_color.length-2)}}],[{key:"hue2RGB",value:function(e,t,r){var n=r;return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}},{key:"number2Hex",value:function(e){var t=e.toString(16).toUpperCase();return 1===t.length?"0".concat(t):t}},{key:"rgb2hexStrWithRgbObj",value:function(t,r,n){return"#".concat(e.number2Hex(t)).concat(e.number2Hex(r)).concat(e.number2Hex(n))}},{key:"hsl2Rgb",value:function(t){var r,n,i=0,o=0,a=0,l=1*t.H/360,u=1*t.S/255,c=1*t.L/255;return 0===u?(i=255*c,o=255*c,a=255*c):(r=2*c-(n=c<.5?c*(1+u):c+u-u*c),i=255*e.hue2RGB(r,n,l+1/3),o=255*e.hue2RGB(r,n,l),a=255*e.hue2RGB(r,n,l-1/3)),{R:Math.floor(i+.5),G:Math.floor(o+.5),B:Math.floor(a+.5)}}},{key:"rgb2RgbString",value:function(e){var t=e.R,r=e.G,n=e.B;return"rgb(".concat(t,", ").concat(r,", ").concat(n,")")}},{key:"hex2RgbObject",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{R:parseInt(t[1],16),G:parseInt(t[2],16),B:parseInt(t[3],16)}:null}},{key:"lumToHex",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e5,i=e.luminanceWithMod(t,n/1e5);return e.luminanceWithOff(i,r/1e5)}},{key:"luminanceWithMod",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.hex2RgbObject(t);if(!n)throw console.info("[lumToHex]: hex %s",t),new Error("lum To hex fail");var i=e.rgb2Hsl(n),o=i.L*r;i.L=Math.min(o,255);var a=e.hsl2Rgb(i);return e.rgb2hexStrWithRgbObj(a.R,a.G,a.B)}},{key:"luminanceWithOff",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.hex2RgbObject(t);if(!n)throw console.info("[lumToHex]: hex %s",t),new Error("lum To hex fail");var i=e.rgb2Hsl(n),o=i.L+255*r;i.L=Math.min(o,255);var a=e.hsl2Rgb(i);return e.rgb2hexStrWithRgbObj(a.R,a.G,a.B)}},{key:"rgb2Hsl",value:function(e){var t,r,n,i,o=e.R/255,a=e.G/255,l=e.B/255,u=Math.min(o,Math.min(a,l)),c=Math.max(o,Math.max(a,l)),d=c-u,s=0,f=0;return t=(c+u)/2,Math.abs(d)<1e-6?(s=0,f=0):(f=t<.5?d/(c+u):d/(2-c-u),r=((c-o)/6+d/2)/d,n=((c-a)/6+d/2)/d,i=((c-l)/6+d/2)/d,Math.abs(o-c)<1e-6?s=i-n:Math.abs(a-c)<1e-6?s=1/3+r-i:Math.abs(l-c)<1e-6&&(s=2/3+n-r),s<0&&(s+=1),s>1&&(s-=1)),{H:360*s,S:255*f,L:255*t}}},{key:"formatColor",value:function(e){if(null!=e&&e.startsWith("rgba")){var t,r,n=p(e),i=n.hex,o=n.o;return null===(t=(r=Object(s.i)(i,o)).replace)||void 0===t?void 0:t.call(r,"##","#")}return null!=e&&e.startsWith("rgb")?"".concat(Object(s.l)(e),"ff"):null!=e&&e.startsWith("#")?e:"#".concat(e).toLowerCase()}},{key:"hexToIRgb",value:function(e){var t,r=(null===(t=e.match(/\w\w/g))||void 0===t?void 0:t.map((function(e){return parseInt(e,16)})))||[],n=i()(r,3);return{R:n[0],G:n[1],B:n[2]}}},{key:"rgbOrRgbaToRgbaWithNewAlpha",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.replace("a",""),n=/rgb\((\d+,\s*[\d]+,\s*[\d]+)/g.exec(r);return n?"rgba(".concat(n[1],",").concat(t,")"):e}},{key:"getOpacityChangedColor",value:function(e,t){var r,n=null!==(r=h(e))&&void 0!==r?r:1,i=Object(s.e)(t);return"rgba(".concat(i[0],",").concat(i[1],",").concat(i[2],",").concat(n,")")}},{key:"rgbaToRgb",value:function(e){if(!e)return"";var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d)?)[\s+]?/i);return"rgb(".concat(t[1],", ").concat(t[2],", ").concat(t[3],")")}}]),e}()},"79fc58c7b0":function(e,t,r){"use strict";r.d(t,"b",(function(){return n}));var n={TOP_LEFT:"TOP_LEFT",TOP:"TOP",TOP_RIGHT:"TOP_RIGHT",RIGHT:"RIGHT",BOTTOM_RIGHT:"BOTTOM_RIGHT",BOTTOM:"BOTTOM",BOTTOM_LEFT:"BOTTOM_LEFT",LEFT:"LEFT",MOVE:"MOVE"}},"7a4a9cf3b8":function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n,i,o,a,l=r("14502724a6"),u=r.n(l),c=r("9132715560"),d=r.n(c),s=r("6a364eb35c"),f=r.n(s),h=r("85d0a7609b"),p=r.n(h),v=(r("8ee19818c4"),r("405b4a5e2b"),r("3bf1976a4f"),r("c6244f7705"),r("bd80bf2d0f"),r("8e7cce0ada"),r("29f8c5f672"),r("85d48ef22b"),r("2a6f332b5e"),r("672a8f3b69")),y="M",b="L",g="C",m="Q",O="Z";!function(e){e[e.UP=-1]="UP",e[e.DOWN=1]="DOWN"}(a||(a={}));var k=(n={},p()(n,v.b.CURVED,4),p()(n,v.b.FREEHAND,5),p()(n,v.b.SCRIBBLE,4),n),S=(i={},p()(i,v.b.CURVED,7),p()(i,v.b.FREEHAND,1),p()(i,v.b.SCRIBBLE,1),i),P=(o={},p()(o,v.b.CURVED,5),p()(o,v.b.FREEHAND,3),p()(o,v.b.SCRIBBLE,4),o),C=r("516fa97df2"),R=r("33c34da0d5");function A(e,t){var r="";return e.forEach((function(e){if(e.cmd===y)r+="M".concat(Math.round(e.x)," ").concat(Math.round(e.y)," ");else if(e.cmd===b)r+=M(e,t);else if(e.cmd===g)r+=function(e,t){var r=t.roughness,n=t.roughnessOffset,i=t.direction,o=t.sizeFactor,a=t.seed,l=void 0===a?Math.random():a,u=D(n,r,l)*o*T(e,o),c=e.x1+u*i,d=e.y1+u*i,s=e.x2+u*-i,f=e.y2+u*-i;return"C".concat(Math.round(c)," ").concat(Math.round(d),", ").concat(Math.round(s)," ").concat(Math.round(f),", ").concat(Math.round(e.x)," ").concat(Math.round(e.y)," ")}(e,t);else if(e.cmd===m)r+=function(e,t){var r=t.roughness,n=t.roughnessOffset,i=t.sizeFactor,o=t.seed,a=void 0===o?Math.random():o,l=D(n,r,a)*i*T(e,i),u=(e.startX+2*e.x1)/3+l,c=(e.startY+2*e.y1)/3+l,d=(e.x+2*e.x1)/3+l,s=(e.y+2*e.y1)/3+l;return"C".concat(Math.round(u)," ").concat(Math.round(c),", ").concat(Math.round(d)," ").concat(Math.round(s),", ").concat(Math.round(e.x)," ").concat(Math.round(e.y)," ")}(e,t);else if(e.cmd===O){var n=e.startX,i=e.startY,o=e.x,a=e.y;Math.round(n)===Math.round(o)&&Math.round(i)===Math.round(a)||(r+=M(e,t)),r+="Z"}})),r}function M(e,t){var r=t.roughness,n=t.bowing,i=t.roughnessOffset,o=t.direction,a=t.sizeFactor,l=t.seed,u=void 0===l?Math.random():l,c=e.startX,d=e.startY,s=e.x,f=e.y,h=n*(f-d)/200,p=n*(c-s)/200,v=D(i,r,u)*a*Math.sqrt(T(e,a)),y=.25+.1*Math.random(),b=s!==c?(f-d)/(s-c):0,g=b>Math.tan(30*Math.PI/180)&&b<Math.tan(60*Math.PI/180)?0:1,m=b>Math.tan(30*Math.PI/180)&&b<Math.tan(60*Math.PI/180)?1.5:1,O=h*o+c+(s-c)*y+v*o*g,k=h*o+d+(f-d)*y+v*o*m,S=p*-o+c+2*(s-c)*y+v*-o*g,P=p*-o+d+2*(f-d)*y+v*-o*m;return"C".concat(Math.round(O)," ").concat(Math.round(k),", ").concat(Math.round(S)," ").concat(Math.round(P),", ").concat(Math.round(e.x)," ").concat(Math.round(e.y)," ")}function T(e,t){return Math.sqrt(Math.pow(e.startX-e.x,2)+Math.pow(e.startY-e.y,2))/200/t}function D(e,t,r){return Math.abs(t*(r*e*2-e))}function F(e,t,r){for(var n="",i=t===v.b.FREEHAND?150*r:100*r,o=e.startX,a=e.startY,l=e.x,u=e.y,c=Math.sqrt(Math.pow(o-l,2)+Math.pow(a-u,2)),d=Math.ceil(c/i),s=0;s<d;s++){var f=void 0,h=void 0;s===d-1?(f=l,h=u):l===o?(f=l,h=Math.round((u-a)/d*(s+1))+a):(f=Math.round((l-o)/d*(s+1))+o,h=Math.round((f-o)/(l-o)*(u-a)+a)),n+=" L ".concat(f," ").concat(h)}return n}var E=r("2ba7871556"),I=r("82826243ac"),j=r("e0e8dd9366"),w=function(){function e(){d()(this,e)}return f()(e,null,[{key:"generateSketchPathList",value:function(t){if(!Object(I.a)(t.type))return[];var r=[],n=[];return e.duplicateAndCombinePath(t,r,n),e.splitPath(t,r,n),e.roughenPath(t,r,n),r}},{key:"duplicateAndCombinePath",value:function(t,r,n){var i,o,a,l,u,c,d,s=t.model,f=t.style,h=(null==s?void 0:s.props.style)||{},p=h.width,v=h.height,y=h.controlValues,b=h.bgShape,g=h.pathList,m=Math.round(null!==(i=null==f?void 0:f.width)&&void 0!==i?i:p),O=Math.round(null!==(o=null==f?void 0:f.height)&&void 0!==o?o:v),k=e.getBorder(s).sketchStyle;Object(R.g)({type:null!==(a=null!==(l=null!==(u=null==f?void 0:f.bgShape)&&void 0!==u?u:null==k?void 0:k.bgShape)&&void 0!==l?l:b)&&void 0!==a?a:R.e.RECT,width:m,height:O,controlValues:null!==(c=null==f?void 0:f.controlValues)&&void 0!==c?c:y,pathList:null!==(d=null==k?void 0:k.pathList)&&void 0!==d?d:g}).svgPathInRect().forEach((function(t){var i,o;if(t){var a=m/(null!==(i=t.scaleX)&&void 0!==i?i:1),l=O/(null!==(o=t.scaleY)&&void 0!==o?o:1);e.sizeFactor=1/(t.scaleX||1);var u={width:a,height:l,pathString:t.svgPath,fill:R.b.NONE,stroke:1},c={width:a,height:l,pathString:t.svgPath,stroke:0,fill:t.fillMode},d=C.G.parse(t.svgPath);if(e.shouldRenderFillPath(s,t,d)&&!t.notStroke)r.push(c),r.push(u),n.push(d),n.push(d);else{var f={width:a,height:l,pathString:t.svgPath,stroke:t.notStroke?0:1,fill:t.fillMode};r.push(f),n.push(d)}}}))}},{key:"shouldRenderFillPath",value:function(t,r,n){var i=n.length>1&&n[0].x===n[n.length-1].x&&n[0].y===n[n.length-1].y||n[n.length-1].cmd===O;return r.fillMode!==R.b.NONE&&i&&e.hasFill(t)}},{key:"hasFill",value:function(e){var t;return(null===(t=e.getBackgroundFill)||void 0===t?void 0:t.call(e).getFillType())!==E.b.NoFill}},{key:"splitPath",value:function(t,r,n){t.type!==v.b.CURVED&&n.forEach((function(i,o){var a=function(e,t,r){var n="";return e.forEach((function(e){if(e.cmd===y)n+="M ".concat(e.x," ").concat(e.y);else if(e.cmd===b)n+=F(e,t,r);else if(e.cmd===g)n+="".concat(e.cmd," ").concat(e.x1," ").concat(e.y1,", ").concat(e.x2," ").concat(e.y2,", ").concat(e.x," ").concat(e.y);else if(e.cmd===m)n+="".concat(e.cmd," ").concat(e.x1," ").concat(e.y1,", ").concat(e.x," ").concat(e.y);else if(e.cmd===O){var i=e.startX,o=e.startY,a=e.x,l=e.y;Math.round(i)===Math.round(a)&&Math.round(o)===Math.round(l)||(n+=F(e,t,r)),n+="Z"}})),n}(i,t.type,e.sizeFactor);n[o]=C.G.parse(a),r[o].pathString=a}))}},{key:"roughenPath",value:function(t,r,n){var i=t.model,o=t.type,a=void 0===o?v.b.NONE:o;n.forEach((function(n,o){var l=e.getSeed(t)||[],c=u()(l,2),d=c[0],s=c[1],f=r[o],h=f.fill!==R.b.NONE?d:s,p=e.getScale(i,a,f),v={roughness:k[a]*p,bowing:S[a]*p,roughnessOffset:P[a]*p,direction:e.getDirection(i,f),seed:h,sizeFactor:e.sizeFactor};r[o].pathString=A(n,v)}))}},{key:"getScale",value:function(t,r,n){return t.type===j.d.IMAGE?1:e.hasFill(t)?n.fill!==R.b.NONE?1:r===v.b.CURVED?.4:1:t.isPlaceholder&&r===v.b.CURVED?.2:1}},{key:"getDirection",value:function(t,r){var n=t.isPlaceholder?a.UP:a.DOWN;return e.hasFill(t)?r.fill!==R.b.NONE?n:t.isPlaceholder?a.DOWN:a.UP:n}},{key:"getSeed",value:function(t){if(t.type===v.b.CURVED){var r=e.generateKey(t);if(e.seedMap.has(r))return e.seedMap.get(r);var n=Math.random(),i=Math.random();return e.seedMap.set(r,[n,i]),[n,i]}}},{key:"generateKey",value:function(e){var t,r,n,i,o=e.model,a=e.type,l=e.style,u=(null==o?void 0:o.props.style)||{},c=u.width,d=u.height,s=u.controlValues,f=u.bgShape,h=null!==(t=null==l?void 0:l.width)&&void 0!==t?t:c,p=null!==(r=null==l?void 0:l.height)&&void 0!==r?r:d,v=null!==(n=null==l?void 0:l.controlValues)&&void 0!==n?n:s;return"".concat(a,"_").concat(f,"_").concat(h,"_").concat(p,"_").concat(null==v||null===(i=v.toString)||void 0===i?void 0:i.call(v))}},{key:"getBorder",value:function(e){var t,r,n;return null!==(t=null===(r=(n=e).getBorder)||void 0===r?void 0:r.call(n).getBorderInfo())&&void 0!==t?t:{}}}]),e}();p()(w,"seedMap",new Map),p()(w,"sizeFactor",void 0)},"7b6d43f0a9":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("e0e8dd9366"),i=r("d97e8bdaab"),o=r("af54378dce"),a=r("fa034a86e9"),l=r("e98fc7647c"),u=(r("63684fef46"),r("71b8848e13"));function c(e){switch(e){case n.d.SLIDE:return new a.a;case n.d.MASTER:return new o.a;case n.d.LAYOUT:return new i.a;case n.d.NOTE:return new l.a;case n.d.SECTION:return new a.a;case n.d.THEME:return new u.b}}},"7ce5f66a4e":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return n})),r.d(t,"b",(function(){return i}));var n,i,o="border-color";!function(e){e.Butt="flat",e.Round="rnd",e.Square="sq"}(n||(n={})),function(e){e.NoFill="noFill",e.SolidFill="solidFill",e.GradualFill="gradFill"}(i||(i={}))},"7e34de61c3":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i}));var n,i,o="effect";!function(e){e.GLOW="glow",e.REFLECTION="reflection",e.SOFTEDGE="softEdge",e.SHADOW="shadow"}(n||(n={})),function(e){e.TL="tl",e.T="t",e.TR="tr",e.L="l",e.CTR="ctr",e.R="r",e.BL="bl",e.B="b",e.BR="br"}(i||(i={}))},"7e4a465ef4":function(e,t,r){"use strict";(function(e){r("73b854064b");var n=r("176815363d"),i=r.n(n),o=r("9132715560"),a=r.n(o),l=r("6a364eb35c"),u=r.n(l),c=r("547611bd96"),d=r.n(c),s=r("bd29e2df90"),f=r.n(s),h=r("ab5eb40518"),p=r.n(h),v=r("8eec1e4a03"),y=r.n(v),b=r("1b4cdd6a36"),g=r.n(b),m=r("85d0a7609b"),O=r.n(m),k=r("3ef2352f0b"),S=r.n(k),P=(r("3bf1976a4f"),r("8e7cce0ada"),r("c6244f7705"),r("081c8cafea"),r("85d48ef22b"),r("2a6f332b5e"),r("8ee19818c4"),r("d9d7d67d6f")),C=r("801d78248f"),R=r("5b326a30b1"),A=r("d3d31c86eb"),M=r("9da6335152"),T=r("3471fb3b60"),D=r("c73625d763"),F=r.n(D),E=r("643327d0e9"),I=r("7d90099c1e"),j=r("d5c3deb8c7"),w=r("d9812f1c6f"),x=r("8c4a025d08"),L=r("fa034a86e9"),B=r("63684fef46"),N=r("84a9790521"),U=r("6ed1f9725a"),G=r("020899bf26"),_=r("2f1cded8d8");function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var i=g()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var H=function(t){f()(l,t);var r,n,o=V(l);function l(e){var t;return a()(this,l),t=o.call(this,e),O()(d()(t),"asyncConvertSlideChildren",!0),O()(d()(t),"needConvertChildren",!0),O()(d()(t),"convertMasterAndLayoutPromise",void 0),O()(d()(t),"registerSdkEvent",void 0),O()(d()(t),"taskGroup",void 0),O()(d()(t),"slideRenderStateManager",void 0),O()(d()(t),"replacePresentationData",(function(e){var r;null===(r=t.sdkData)||void 0===r||r.api.replacePresentation(e)})),t.props={style:{},slideWidth:C.a.width,slideHeight:C.a.height,slideSizeType:R.a.SLIDE_SIZE_16_9},Object(j.i)(t.props,{slideSizeType:j.q,slideWidth:j.q,slideHeight:j.q}),t}return u()(l,[{key:"convertTaskGroup",get:function(){return(!this.taskGroup||this.taskGroup.isCanceled||this.taskGroup.isFinished)&&(this.taskGroup=new I.a("convert-children-".concat(this.type,"(").concat(this.key,")"),T.a.NORMAL),this.taskGroup.concurrent=!0),this.taskGroup}},{key:"converGuideDataSdkToUi",value:function(e){this.guideModel||(this.guideModel=new U.a,this.guideModel.bindSDK(e))}},{key:"convertArrayDataSdkToUi",value:function(e,t){var r,n,i=this;this.registerSdkEvent||(this.registerSdkEvent=!0,null===(n=G.a.EventManager())||void 0===n||n.on(_.a.LoadDocumentAllChunksSuccess,(function(){i.convertMasterAndLayoutPromise.then((function(){return i.changeEditableState(!0)}))})));var o=[E.a.convertArrayDataSdkToUi((function(){return L.a}),e.slideList,this.children,this,T.a.HIGH)];(null==e||null===(r=e.sectionList)||void 0===r?void 0:r.length)>0&&(null==t||!t.remove)?(this.sectionList=[],o.push(E.a.convertArrayDataSdkToUi((function(){return B.a}),e.sectionList,this.sectionList,this))):this.sectionList&&(this.sectionList=void 0),Promise.all(o).then((function(){var e;null===(e=i.initSectionFoldedState)||void 0===e||e.call(i)}))}},{key:"sdkOnDidChangeV3",value:(n=i()(S.a.mark((function e(t,r){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r||this.children.clear(),e.next=3,y()(g()(l.prototype),"sdkOnDidChangeV3",this).call(this,t,r);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"initSectionFoldedState",value:function(){var e,t;w.a.isMobile||this.sectionManager&&this.sectionManager.initSectionFoldedState(null!==(e=null===(t=this.sectionList)||void 0===t?void 0:t.length)&&void 0!==e?e:0)}}],[{key:"convertDataSdkToUi",value:(r=i()(S.a.mark((function t(r,n,i,o){var a,u,c;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:y()(g()(l),"convertDataSdkToUi",this).call(this,r,n,i,o),e.log.info("[key process]","PresentationModel convert start"),N.a.convertPartialDataFromSdkToUi(r,n),null!==(a=n.getMasterLayoutEditService)&&void 0!==a&&null!==(u=a.call(n))&&void 0!==u&&u.isMasterEditType||((null===(c=r.slideList)||void 0===c?void 0:c.length)>0?(n.children.length<=0&&n.convertDataAtPageIndex(0),this.handleCurSlideIndex(r,n)):n.selectionService&&(n.selectionService.currentSlideIndex=-1)),l.prototype.convertArrayDataSdkToUi.call(n,r,o),l.prototype.converGuideDataSdkToUi.call(n,r),F()(r,"slideHeight")&&(this.reported||(n.props.slideSizeType===R.a.SLIDE_SIZE_16_9?Object(A.c)({opername:M.e.DOC_PPT,module:M.d.PC_EDIT_PAGE,action:M.b.THISPAGE_SN}):n.props.slideSizeType===R.a.SLIDE_SIZE_4_3?Object(A.c)({opername:M.e.DOC_PPT,module:M.d.PC_EDIT_PAGE,action:M.b.THISPAGE_FT}):Object(A.c)({opername:M.e.DOC_PPT,module:M.d.PC_EDIT_PAGE,action:M.b.THISPAGE_OTH}),this.reported=!0));case 7:case"end":return t.stop()}}),t,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"handleCurSlideIndex",value:function(e,t){var r=e.slideList.length;if(t.selectionService)if(t.selectionService.currentSlideIndex<0)w.a.isMobile||(t.selectionService.currentSlideIndex=0);else{var n=t.selectionService.currentSlide,i=-1;e.slideList.forEach((function(e,t){e.id===(null==n?void 0:n.id)&&(i=t)})),i<0&&t.selectionService.currentSlideIndex>=r&&(t.selectionService.currentSlideIndex=r-1),i>=0&&(t.selectionService.currentSlideIndex=i)}}},{key:"convertDataUiToSdk",value:function(e,t){}},{key:"didConvertDataSdkToUi",value:function(e,t,r,n){t.needConvertChildren?(y()(g()(l),"didConvertDataSdkToUi",this).call(this,e,t,r,n),Object(x.b)(t),t.convertThemeSdkDataToUiData(),t.convertMasterAndLayoutPromise=t.convertMasterAndLayoutSdkDataToUiData()):t.convertMasterAndLayoutPromise=Promise.resolve()}}]),l}(P.a);O()(H,"reported",void 0),t.a=H}).call(this,r("5ef37df1a0"))},"82826243ac":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("672a8f3b69");function i(e){return e===n.b.CURVED||e===n.b.FREEHAND||e===n.b.SCRIBBLE}},"89b95fa9c3":function(e,t,r){"use strict";r.d(t,"a",(function(){return M}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n,i=r("14502724a6"),o=r.n(i),a=r("7a5536c9bf"),l=r.n(a),u=r("9132715560"),c=r.n(u),d=r("6a364eb35c"),s=r.n(d),f=r("85d0a7609b"),h=r.n(f),p=(r("8e7cce0ada"),r("29f8c5f672"),r("c6244f7705"),r("85d48ef22b"),r("2a6f332b5e"),r("8ee19818c4"),r("b8217400dc"),r("e6f68cdf2e"),r("3bf1976a4f"),r("e0e8dd9366")),v=r("f40fd417a1"),y=r("79fc58c7b0"),b=r("8e31e67bb3"),g=r("c6c7cf6a47"),m=r("d5c3deb8c7"),O=r("1b0526663d"),k=r("9657b29818"),S=r("7288817546"),P=r("b684da8955"),C=r("029d6df9a6");function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){h()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.WIDTH="width",e.HEIGHT="height"}(n||(n={}));var M=function(){function e(t){var r=this;c()(this,e),h()(this,"selectionService",void 0),h()(this,"updateModelArr",[]),h()(this,"mode",void 0),h()(this,"applyShapeAutoFit",void 0),h()(this,"updateMultiWidthOrHeight",(function(e,t){r.updateData(e.mode,e.applyShapeAutoFit),r.updateModelArr=l()(e.updateModelArr);var n=new Map;r.updateModelArr.forEach((function(i,o){var a=r.getFrameWhenWidthOrHeightchange(e.value[o],t,i,e.isIgnoreLock);n.set(i.key,a)})),r.batchUpdateModelFrame(n)})),h()(this,"getFrameWhenWidthOrHeightchange",(function(e,t,n,i){var o,a;if(null!==(o=(a=n).isTextAttachment)&&void 0!==o&&o.call(a))return null;var l=A(A({},n.getFrame().getFrameInfo()),{},h()({},t,e));return r.handleLockAspect(t,l,n,i),r.handleLeftTopWhenHeightOrWidthChange(n,l),l})),h()(this,"handleLockAspect",(function(e,t,r,i){var o,a,l;null!==(o=r.props)&&void 0!==o&&null!==(a=o.locks)&&void 0!==a&&a.noChangeAspect&&!i&&(l=0===r.props.style.width||0===r.props.style.height?1:r.props.style.width/r.props.style.height,e===n.WIDTH?t.height=t[e]/l:t.width=t[e]*l)})),h()(this,"handleLeftTopWhenHeightOrWidthChange",(function(e,t){var n=e.props.style.rotate,i=r.mode===y.b.LEFT,a=r.mode===y.b.TOP,l=t.width-e.props.style.width,u=t.height-e.props.style.height;if(!n)return i&&(t.left-=l),void(a&&(t.top-=u));var c=Object(v.a)({originalFrame:e.props.style,rotate:n,widthOffset:l,heightOffset:u,isLeftChange:Boolean(i),isTopChange:Boolean(a)}),d=o()(c,1)[0];t.left=d.x,t.top=d.y})),h()(this,"persistSizeForGroup",(function(e){var t,n=e.updatePropsArr,i=e.updateModels,o=e.multiFrameMap,a=e.removeModels,l=e.removePropsArr,u=[];r.updateModelArr.forEach((function(e){u.push(null==o?void 0:o.get(e.key))}));var c=r.getRootGroupModel();c&&c.getFrame().getAdjustedElementsAndProps(r.updateModelArr,u).forEach((function(e){n.push(e.props),i.push(e.uiModel)})),r.commitChange(a,i,l,n),(null===(t=r.updateModelArr)||void 0===t?void 0:t.length)>0&&(null==c||c.getFrame().clearTempInfosWithElement(r.updateModelArr[0]))})),h()(this,"updateData",(function(e,t){r.mode=null!=e?e:y.b.BOTTOM_RIGHT,r.applyShapeAutoFit=t})),h()(this,"isNeedToAdjustText",(function(e){return g.a.getInstance().enableAdjustText()&&Object(b.c)(e)&&r.applyShapeAutoFit})),h()(this,"getNextStyle",(function(e,t,n){return(null==e?void 0:e.type)!==p.d.TABLE||n?{style:r.isNeedToAdjustText(e)?r.frameInfoAfterAdjust(e,t):t}:e.resizeTable(t,r.mode)})),h()(this,"getFrameInfoOfModel",(function(e,t){var r,n,i,o,a=null===(r=e.getFrame)||void 0===r?void 0:r.call(e).frameOnSlide(),l=function(e){return void 0!==(null==t?void 0:t[e])?t[e]:null==a?void 0:a[e]};return{style:{left:l("left"),top:l("top"),width:l("width"),height:l("height"),flipH:l("flipH"),flipV:l("flipV"),rotate:null!==(n=null===(i=e.props)||void 0===i||null===(o=i.style)||void 0===o?void 0:o.rotate)&&void 0!==n?n:0}}})),h()(this,"getFinalLeftOrTop",(function(e,t,r,n){var i;return(null==e||null===(i=e.parent)||void 0===i?void 0:i.type)===p.d.GROUP&&n&&Object(P.a)(e,(function(e){t-=e.props.style[r]})),t})),h()(this,"getDiffLeftTop",(function(e,t,r,n){var i,o=0,a=0,l=null===(i=e.getFrame)||void 0===i?void 0:i.call(e).frameOnSlide(),u=e.props.style,c=u.left,d=u.top;return n?r===S.a.LEFT?o=t-l.left:a=t-l.top:r===S.a.LEFT?o=t-c:a=t-d,{diffLeft:o,diffTop:a}})),h()(this,"handleRelatedInfo",(function(e,t,n,i,o){var a;null==e||null===(a=e.relatedUIModelRefs)||void 0===a||a.forEach((function(e){r.updateModelArr.includes(e)||e.type===p.d.CONNECTOR&&r.handleConnectedConnector({updateModel:e,uiModels:t,updatePropsArr:n,toUpdateModelFrameMap:i,isOnlyMove:o})}))})),h()(this,"handleConnectorRemoveInfo",(function(e,t,r){if(e.type===p.d.CONNECTOR){var n=e.toRemoveConnectorInfoProps();n&&(t.push(e),r.push(n))}})),h()(this,"getFinalRotate",(function(e,t,r){var n,i,o,a;return(null==e||null===(n=e.parent)||void 0===n?void 0:n.type)===p.d.GROUP&&r?(t-((null!==(i=null===(o=e.getFrame)||void 0===o?void 0:o.call(e).frameOnSlide().rotate)&&void 0!==i?i:0)+360-(null!==(a=e.props.style.rotate)&&void 0!==a?a:0))%360+360)%360:t})),h()(this,"isConnectedConnector",(function(e){return!(e.type!==p.d.CONNECTOR||e.startUIModel&&e.endUIModel||!(e.startUIModel&&r.updateModelArr.includes(e.startUIModel)||e.startUIModel&&r.updateModelArr.includes(e.startUIModel)))})),this.selectionService=t}return s()(e,[{key:"batchUpdateWidth",value:function(e){this.needUpdate(e.value,e.updateModelArr)&&this.updateMultiWidthOrHeight(e,n.WIDTH)}},{key:"batchUpdateHeight",value:function(e){this.needUpdate(e.value,e.updateModelArr)&&this.updateMultiWidthOrHeight(e,n.HEIGHT)}},{key:"batchUpdateLeft",value:function(e,t,r){this.needUpdate(e,t)&&this.updateLeftOrTop(e,t,S.a.LEFT,r)}},{key:"batchUpdateTop",value:function(e,t,r){this.needUpdate(e,t)&&this.updateLeftOrTop(e,t,S.a.TOP,r)}},{key:"batchUpdateRotate",value:function(e,t,r){var n=this;if(this.needUpdate(e,t)){var i=new Map,o=[],a=[],u=[],c=[];this.updateModelArr=l()(t),this.updateModelArr.forEach((function(t,l){if(t.type!==p.d.TABLE){var d=n.getFinalRotate(t,e[l],r);i.set(t.key,{rotate:d}),a.push({style:A(A({},t.getFrame().getFrameInfo()),{},{rotate:d})}),o.push(t),n.handleRelatedInfo(t,o,a,i),n.updateRelatedInfoForConnector(t,!0),n.handleConnectorRemoveInfo(t,u,c)}})),this.commitChange(u,o,c,a)}}},{key:"batchUpdateFrame",value:function(e){if(this.needUpdate(e.frame,e.updateModelArr)){this.updateData(e.mode,e.applyShapeAutoFit),this.updateModelArr=l()(e.updateModelArr);var t=new Map;this.updateModelArr.forEach((function(r,n){t.set(r.key,A(A({},r.getFrame().getFrameInfo()),e.frame[n]))})),this.batchUpdateModelFrame(t)}}},{key:"batchUpdateFrameOnSlide",value:function(e){var t=this;if(this.needUpdate(e.frame,e.updateModelArr)){this.updateModelArr=l()(e.updateModelArr),this.updateData(e.mode,e.applyShapeAutoFit);var r=e.frame,n=new Map;this.updateModelArr.forEach((function(e,i){var o,a=Array.isArray(r)?r[i]:r,l=A(A({},e.getFrame().frameOnSlide()),a);(null===(o=e.parent)||void 0===o?void 0:o.type)===p.d.GROUP&&(l=t.convertModelFrameOnSlideToSelf(e,l)),n.set(e.key,l)})),this.batchUpdateModelFrame(n)}}},{key:"convertModelFrameOnSlideToSelf",value:function(e,t){return new C.a(e).convertFrameOnSlideToSelf(t)}},{key:"batchUpdateModelFrame",value:function(e,t){var r=this;Object(k.b)((function(){var n=[],i=[],o=[],a=[],l=[];r.updateModelArr.forEach((function(u){r.isConnectedConnector(u)?l.push(u):r.modifyUpdateInfo({updateModel:u,multiFrameMap:e,type:t,updateModels:n,updatePropsArr:i,removeModels:o,removePropsArr:a})})),l.forEach((function(t){r.handleConnectedConnector({updateModel:t,uiModels:n,updatePropsArr:i,toUpdateModelFrameMap:e})})),r.checkIsGroup()?r.persistSizeForGroup({multiFrameMap:e,updateModels:n,updatePropsArr:i,removeModels:o,removePropsArr:a}):r.commitChange(o,n,a,i)}))}},{key:"modifyUpdateInfo",value:function(e){var t=e.updateModel,r=e.multiFrameMap,n=e.type,i=e.updateModels,o=e.updatePropsArr,a=e.removeModels,l=e.removePropsArr,u=r.get(t.key);if(u){var c=n&&["left","top"].includes(n);this.updateRelatedInfoForConnector(t,c),this.handleConnectorRemoveInfo(t,a,l),i.push(t);var d=this.getNextStyle(t,u,c);o.push(d),null==r||r.set(t.key,d.style),this.handleRelatedInfo(t,i,o,r,c)}}},{key:"frameInfoAfterAdjust",value:function(e,t){var r=this.getFrameInfoOfModel(e,t);return g.a.getInstance().adjustShape(e,r,this.mode).style}},{key:"updateLeftOrTop",value:function(e,t,r,n){var i=this,o=new Map;this.updateModelArr=l()(t),this.updateModelArr.forEach((function(t,a){var l,u=t.props.style,c=u.left,d=u.top,s=u.width,f=u.height,v=h()({left:c,top:d,width:s,height:f},r,i.getFinalLeftOrTop(t,e[a],r,n));if((null===(l=t.parent)||void 0===l?void 0:l.type)===p.d.GROUP){var y=i.getDiffLeftTop(t,e[a],r,n),b=y.diffLeft,g=y.diffTop,m=Object(O.d)(Object(O.c)(t),b,g);v.left=c+m.offsetX,v.top=d+m.offsetY}o.set(t.key,v)})),this.batchUpdateModelFrame(o,r)}},{key:"commitChange",value:function(e,t,r,n){var i,o,a,l;e.length>0?(t.forEach((function(){return r.unshift(void 0)})),e.forEach((function(){return n.push(null)})),null===(i=this.selectionService)||void 0===i||null===(o=i.currentSlide)||void 0===o||o.updateAndRemovePropsForElements(n,r,t.concat(e))):null===(a=this.selectionService)||void 0===a||null===(l=a.currentSlide)||void 0===l||l.updateElementsProps(n,t)}},{key:"handleConnectedConnector",value:function(e){var t,r=e.uiModels,n=e.updatePropsArr,i=e.toUpdateModelFrameMap,o=e.isOnlyMove,a=e.updateModel;if(i){var l=this.getOffsetFrameForConnectorOnlyMove(a,o,i);if(l)t=A(A({},a.getUpdateStylePropsForOnlyMove(l)),{},{bgLine:a.props.style.bgLine,controlValues:Object(m.v)(a.props.style.controlValues)});else{var u=a.getUpdateStyleProps(i),c=u.frame,d=u.bgLine,s=u.controlValues;t=A(A({},c),{},{bgLine:d,controlValues:s})}}else t=A(A({},a.operationFrame),{},{bgLine:a.props.style.bgLine,controlValues:Object(m.v)(a.props.style.controlValues)});r.push(a),n.push({style:t})}},{key:"updateRelatedInfoForConnector",value:function(e,t){e.type===p.d.CONNECTOR&&e.resetStartAndEndForMove(t)}},{key:"getOffsetFrameForConnectorOnlyMove",value:function(e,t,r){var n,i,o,a;if(t)return(null!==(n=e.startUIModel)&&void 0!==n&&n.selected&&null!==(i=e.endUIModel)&&void 0!==i&&i.selected||e.startUIModel&&!e.endUIModel)&&(o=null==r?void 0:r.get(e.startUIModel.key),a=e.startUIModel),!e.startUIModel&&e.endUIModel&&(o=null==r?void 0:r.get(e.endUIModel.key),a=e.endUIModel),o?{left:o.left-a.props.style.left,top:o.top-a.props.style.top}:void 0}},{key:"checkIsGroup",value:function(){var e;return(null===(e=this.updateModelArr[0].parent)||void 0===e?void 0:e.type)===p.d.GROUP}},{key:"getRootGroupModel",value:function(){return this.updateModelArr[0].rootGroupModel}},{key:"needUpdate",value:function(e,t){return e.length>0&&t.length>0}}]),e}()},"95e4bf6bea":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=(r("8ee19818c4"),r("968ee3f7e6"),r("b8217400dc"),r("e6f68cdf2e"),r("444d24ef93")),u=function(){function e(){i()(this,e)}return a()(e,[{key:"adjustTableBg",value:function(e,t){var r=this;if(this.didFrameChange(t)){var n=e.props.style.width,i=e.props.style.height;e.props.items.flat().forEach((function(e){r.isAjudstType(e)&&(e.props.style.offsetFrame={offsetX:-e.props.style.left,offsetY:-e.props.style.top,offsetHeight:i,offsetWidth:n})}))}}},{key:"adjustCellBg",value:function(e,t){if(this.isAjudstType(e)&&!this.didFrameChange(t)){var r=e.parent;e.props.style.offsetFrame={offsetX:-e.props.style.left,offsetY:-e.props.style.top,offsetHeight:r.props.style.height,offsetWidth:r.props.style.width}}else e.props.style.offsetFrame=void 0}},{key:"didFrameChange",value:function(e){var t=Object(l.b)(e);return[l.a.All,l.a.Frame,l.a.TableAddOrRemove].includes(t)}},{key:"isAjudstType",value:function(e){var t,r=e.getBackgroundFill().getFillInfo();return!(null==r||!r.pattFill)||!(null==r||null===(t=r.image)||void 0===t||!t.tile)}}]),e}()},"96745b5cc3":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("8ee19818c4"),r("342844cefa"),r("9789b08c01")),d=r("8f58e78419"),s=r.n(d),f=r("c73625d763"),h=r.n(f),p=r("ee6bb53310"),v=r.n(p),y=function(){function e(){i()(this,e)}return a()(e,null,[{key:"clearBorderFillNull",value:function(e){["gradFill","color"].forEach((function(t){null===e[t]&&delete e[t]}))}},{key:"checkSolidFill",value:function(e,t){h()(e,"solidFill")?t.noFill=null:t.solidFill=null}},{key:"checkGradFill",value:function(e,t,r){if(h()(e,"gradFill")){if(s()(e,"gradFill.gsList")&&s()(r,"style.fillBackground.gradFill.gsList")){var n=e.gradFill.gsList,i=b(r.style.fillBackground.gradFill.gsList.length),o=b(n.length);if(i>o){for(var a=[],l=0;l<i;l++)l<o?a.push(void 0):a.push({});v()(t,"gradFill.gsList",a)}}s()(e,"gradFill.lin")||v()(t,"gradFill.lin",null),s()(e,"gradFill.pathGradient")||v()(t,"gradFill.pathGradient",null),t.noFill=null}else t.gradFill=null}},{key:"checkImageFill",value:function(e,t){if(h()(e,"image")){var r=s()(e,"image.alpha");"number"==typeof r||r||v()(t,"image.alpha",null),s()(e,"image.stretch")?v()(t,"image.tile",null):s()(e,"image.tile")&&v()(t,"image.stretch",null),h()(e,"image.stretch")||v()(t,"image.stretch",null),h()(e,"image.tile")||v()(t,"image.tile",null),t.noFill=null}else t.image=null}},{key:"checkPatternFill",value:function(e,t){null!=e&&e.pattFill?t.noFill=null:t.pattFill=null}},{key:"checkNoFillGradFill",value:function(e,t,r){var n;0===e.width&&(Object.keys((null==r||null===(n=r.style)||void 0===n?void 0:n.border)||{}).forEach((function(e){"color"!==e&&"colorValue"!==e&&"gradFill"!==e&&(t[e]=null)})),null===e.color&&(t.color=null,t.colorValue=null),null===e.gradFill&&(t.gradFill=null),delete t.width)}},{key:"checkBorderGradFill",value:function(e,t,r){if(e.gradFill){var n,i,o,a,l,u;if(null!=e&&null!==(n=e.gradFill)&&void 0!==n&&n.gsList)if(null!=r&&null!==(a=r.style)&&void 0!==a&&null!==(l=a.border)&&void 0!==l&&null!==(u=l.gradFill)&&void 0!==u&&u.gsList){var c=e.gradFill.gsList,d=b(r.style.border.gradFill.gsList.length),s=b(c.length);if(d>s){for(var f=[],h=0;h<d;h++)h<s?f.push(void 0):f.push({});v()(t,"gradFill.gsList",f)}}null!=e&&null!==(i=e.gradFill)&&void 0!==i&&i.lin||v()(t,"gradFill.lin",null),null!=e&&null!==(o=e.gradFill)&&void 0!==o&&o.pathGradient||v()(t,"gradFill.pathGradient",null)}else null===e.gradFill&&(t.gradFill=null)}}]),e}();function b(e){return e||0}u()(y,"convertToUpdateAndRemove",(function(e,t){var r,n,i,o,a=null,l=e;if(h()(e,"style.fillBackground")){var u={};a={style:{fillBackground:u},useBgFill:null};var d=(l=Object(c.a)(e,!0)).style.fillBackground;y.checkSolidFill(d,u),y.checkGradFill(d,u,t),y.checkImageFill(d,u),y.checkPatternFill(d,u)}else if(null!=e&&null!==(r=e.style)&&void 0!==r&&r.border){var s=l.style.border,f={};a={style:{border:f}},l=Object(c.a)(e,!0),y.checkBorderGradFill(s,f,t),y.checkNoFillGradFill(s,f,t),y.clearBorderFillNull(l.style.border),0===Object.keys(a.style.border).length&&(a=null)}return h()(t,"style.border.sketchStyle")&&null===(null===(n=e.style)||void 0===n||null===(i=n.border)||void 0===i?void 0:i.sketchStyle)&&v()(a,"style.border.sketchStyle",null),h()(t,"style.pathList")&&null===(null===(o=e.style)||void 0===o?void 0:o.customGeom)&&v()(a,"style.customGeom",null),{update:l,remove:a}}))},"96818dd0e4":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="mailto:"},"9c5b376bf5":function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("826dc923b3"),r("730207179f")),d=r("89b95fa9c3"),s=r("7288817546"),f=function(){function e(t){var r=this;i()(this,e),u()(this,"selectionService",void 0),u()(this,"model",void 0),u()(this,"batchUpdateFrameHandler",void 0),u()(this,"getFinalFrame",(function(e,t){var n=e.props.style;if(t){var i=r.getFrameInfoByOtherData(e,"flipH",0),o=r.getFrameInfoByOtherData(e,"flipV",0),a=r.getFrameInfoByOtherData(e,"rotate",0),l=e.operationFrame||n;return{flipH:i,flipV:o,rotate:a,left:l.left,top:l.top,width:l.width,height:l.height}}return{left:n.left,top:n.top,width:n.width,height:n.height,flipH:n.flipH||0,flipV:n.flipV||0,rotate:n.rotate||0}})),u()(this,"getValueOfFrame",(function(e,t){var n=t?r.frameOnSlide():r.getFrameInfo();return isNaN(Number(null==n?void 0:n[e]))?Number.NaN:null==n?void 0:n[e]})),this.model=t,this.batchUpdateFrameHandler=new d.a(t.selectionService)}return a()(e,[{key:"getHeight",value:function(){return this.getValueOfFrame(s.a.HEIGHT)}},{key:"getWidth",value:function(){return this.getValueOfFrame(s.a.WIDTH)}},{key:"getLeft",value:function(e){return this.getValueOfFrame(s.a.LEFT,e)}},{key:"getTop",value:function(e){return this.getValueOfFrame(s.a.TOP,e)}},{key:"getRotate",value:function(e){return this.getValueOfFrame(s.a.ROTATE,e)}},{key:"getFrameInfo",value:function(e){return this.getFinalFrameInfo(e)}},{key:"frameOnSlide",value:function(e,t){return this.getFinalFrameInfo(t,!0,e)}},{key:"getFrameInfoByOtherData",value:function(e,t,r){var n,i=r;Object(c.a)(e,"operationFrame.".concat(t))?i=null===(n=e.operationFrame)||void 0===n?void 0:n[t]:Object(c.a)(e,"props.style.".concat(t))&&(i=e.props.style[t]);return i}}]),e}()},a0d2dff58b:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("b8217400dc"),r("e6f68cdf2e"),r("8ee19818c4"),r("342844cefa"),r("d5c3deb8c7")),d=r("9657b29818"),s=r("c73625d763"),f=r.n(s),h=r("a859b64b06"),p=r("e0e8dd9366"),v=r("7d1df7d0fb"),y=r("7e34de61c3"),b=function(){function e(t){i()(this,e),u()(this,"model",void 0),u()(this,"mergePropertyValCache",void 0),this.model=t,this.mergePropertyValCache=null}return a()(e,[{key:"getGlow",value:function(){var e;return(null===(e=this.getEffectCollection())||void 0===e?void 0:e[y.b.GLOW])||null}},{key:"getReflection",value:function(){var e;return(null===(e=this.getEffectCollection())||void 0===e?void 0:e[y.b.REFLECTION])||null}},{key:"getSoftEdge",value:function(){var e;return(null===(e=this.getEffectCollection())||void 0===e?void 0:e[y.b.SOFTEDGE])||null}},{key:"getShadow",value:function(){var e;return(null===(e=this.getEffectCollection())||void 0===e?void 0:e[y.b.SHADOW])||null}},{key:"updateGlow",value:function(e,t){return this.updateEffectCollection(u()({},y.b.GLOW,e),t)}},{key:"updateReflection",value:function(e,t){return this.updateEffectCollection(u()({},y.b.REFLECTION,e),t)}},{key:"updateSoftEdge",value:function(e,t){return this.updateEffectCollection(u()({},y.b.SOFTEDGE,e),t)}},{key:"updateShadow",value:function(e,t){return this.updateEffectCollection(u()({},y.b.SHADOW,e),t)}},{key:"getEffectCollection",value:function(){return[p.d.GROUP,p.d.MULTIPLY].includes(this.model.type)?this.mergePropertyValCache:this.model.props.style[y.c]||null}},{key:"updateEffectCollection",value:function(e,t){var r=this;if([p.d.GROUP,p.d.MULTIPLY].includes(this.model.type)){var n=[];this.model.type===p.d.MULTIPLY?n=this.model.selectedModels:this.model.type===p.d.GROUP&&(n=this.model.children),c.w((function(){Object(d.b)((function(){r.updateMultiple(n,e,t)}))}))}else this.updateSingle(this.model,e,t)}},{key:"refreshMergePropertyValCache",value:function(){if([p.d.GROUP,p.d.MULTIPLY].includes(this.model.type)){var e=this.model,t=Object(v.d)(e,(function(e){var t;return u()({},y.c,null===(t=e.getEffect)||void 0===t?void 0:t.call(e).getEffectCollection())}));this.mergePropertyValCache=t[y.c]||null}return this.mergePropertyValCache}},{key:"updateMultiple",value:function(e,t,r){e.forEach((function(e){e.getEffect().updateEffectCollection(t,r)}))}},{key:"updateSingle",value:function(t,r,n){var i=e.getEffectUpdateRemove(r);i&&(n?(h.a.updateUiProps(i.update,t),t.previewChange+=1):i.remove?t.updateAndRemoveProps(i.update,i.remove):t.updateProps(i.update))}}],[{key:"getEffectUpdateRemove",value:function(t){var r={style:{effect:{}}};if([y.b.GLOW,y.b.REFLECTION,y.b.SOFTEDGE].forEach((function(n){var i=null==t?void 0:t[n];f()(t,n)&&e.isNullOrEmptyObj(i)&&(r.style.effect[n]=null)})),f()(t,y.b.SHADOW)){var n=null==t?void 0:t[y.b.SHADOW];r.style.effect[y.b.SHADOW]=e.isNullOrEmptyObj(n)?null:{isOuter:!(null!=n&&n.isOuter)}}return{update:{style:{effect:t}},remove:Object.keys(r.style.effect).length?r:null}}},{key:"isNullOrEmptyObj",value:function(e){return null===e||0===Object.keys(e||{}).length}}]),e}()},a42b29265b:function(e,t,r){"use strict";var n,i,o,a,l;r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return l})),function(e){e.INHERIT="inheritedSdkData",e.OWN="ownSdkData"}(n||(n={})),function(e){e[e.textBodyModel=0]="textBodyModel",e[e.sdkModel=1]="sdkModel"}(i||(i={})),function(e){e[e.Version2=2]="Version2",e[e.Version3=3]="Version3"}(o||(o={})),function(e){e.THEME_LIST="themeList",e.MASTER_LIST="masterList",e.LAYOUT_LIST="layoutList",e.SLIDE_LIST="data"}(a||(a={})),function(e){e.SLIDE="slide",e.SHAPE="shape",e.TEXT="text"}(l||(l={}))},a487fa69e2:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.noRelative=0]="noRelative",e[e.isRelative=1]="isRelative",e[e.multi=2]="multi"}(n||(n={}))},af54378dce:function(e,t,r){"use strict";r.d(t,"a",(function(){return H}));r("73b854064b");var n,i,o,a=r("176815363d"),l=r.n(a),u=r("1f925d7f50"),c=r.n(u),d=r("9132715560"),s=r.n(d),f=r("6a364eb35c"),h=r.n(f),p=r("547611bd96"),v=r.n(p),y=r("bd29e2df90"),b=r.n(y),g=r("ab5eb40518"),m=r.n(g),O=r("8eec1e4a03"),k=r.n(O),S=r("1b4cdd6a36"),P=r.n(S),C=r("85d0a7609b"),R=r.n(C),A=r("2dc700e1e6"),M=r.n(A),T=(r("f1054791f4"),r("3ef2352f0b")),D=r.n(T),F=(r("b1e2246d82"),r("c6244f7705"),r("081c8cafea"),r("8e7cce0ada"),r("85d48ef22b"),r("2a6f332b5e"),r("8a35b54c1d"),r("75563bc376"),r("fa034a86e9")),E=r("d5c3deb8c7"),I=r("e0e8dd9366"),j=r("9657b29818"),w=r("9da6335152"),x=r("d3d31c86eb"),L=r("be02c6bd58"),B=r("4a58b725b5"),N=r("f78be71a2b"),U=r("711a53c9fc"),G=r("477433b002"),_=r("3471fb3b60");function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P()(e);if(t){var i=P()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m()(this,r)}}var H=(n=function(e){b()(u,e);var t,r,n,a=V(u);function u(){var e;return s()(this,u),e=a.call(this),R()(v()(e),"isMaster",!0),c()(v()(e),"preload",i,v()(e)),c()(v()(e),"layoutList",o,v()(e)),R()(v()(e),"titleTextStyleList",void 0),R()(v()(e),"bodyTextStyleList",void 0),R()(v()(e),"otherTextStyleList",void 0),R()(v()(e),"themeId",void 0),R()(v()(e),"clrMap",void 0),R()(v()(e),"autoConvertChildren",!0),R()(v()(e),"needConvertChildren",!0),e.type=I.d.MASTER,e}return h()(u,[{key:"themeName",get:function(){var e;return(null===(e=this.getTheme())||void 0===e?void 0:e.name)||""}},{key:"getRelationLayoutModel",value:function(){}},{key:"getRelationMasterModel",value:function(){return this}},{key:"bindRelationObserver",value:function(){}},{key:"bindSDK",value:(n=l()(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k()(P()(u.prototype),"bindSDK",this).call(this,t),this.needConvertChildren&&this.presentationRef&&(this.needConvertChildren=this.presentationRef.needConvertChildren);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"convertSdkToUiChildrenLogic",value:(r=l()(D.a.mark((function e(t){var r,n,i,o=arguments;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],this.needConvertChildren){e.next=3;break}return e.abrupt("return");case 3:if((i=[]).push(this.getChildrenConvertPromise(_.a.NORMAL)),!this.asyncConvertChildren){e.next=9;break}return e.next=8,Promise.all(i);case 8:this.asyncConvertChildren=!1;case 9:if(null!==(r=this.sdkData)&&void 0!==r&&r.id){e.next=11;break}return e.abrupt("return");case 11:this.presentationRef.masterChildrenMap[this.sdkData.id]=this.children.filter((function(e){return!e.isPlaceholder})),this.setSyncLoad(),n||(this.childrenConverted=!0);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updatePlaceholderFormat",value:function(e){var t,r,n=this,i=e.value,o=e.checked,a=e.targetShape;null===(t=this.selectionService)||void 0===t||t.selectedWithCommit.markSpecialOperate(G.a.keep),Object(j.b)((function(){switch(i){case L.e:n.handleTitlePlCheckedChange(o,a);break;case L.a:n.handleBodyPlCheckedChange(o,a);break;case L.b:n.handleDateCheckedChange(o,a);break;case L.c:n.handleFooterPlCheckedChange(o,a);break;case L.d:n.handleNumberPlCheckedChange(o,a);break;default:n.handleOtherCheckedChange(o,a)}})),null===(r=this.selectionService)||void 0===r||r.selectedElements.clear()}},{key:"handleTitlePlCheckedChange",value:function(e,t){if(e){var r;null===(r=this.sdkData)||void 0===r||r.api.addPlaceholder(N.a.Title)}else{var n=t||this.findChildByPlTypeNum(U.U.title)||this.findChildByPlTypeNum(U.U.ctrTitle),i=null==n?void 0:n.sdkData;if(!i)return;this.handleUnCheckedChange(i),this.unlinkMatchedShapesOfPlaceholder(i)}Object(x.c)({opername:w.e.DOC_PPT,module:w.d.MASTER,action:w.b.MASTER_TITLE_CHECKBOX_CLICK})}},{key:"handleBodyPlCheckedChange",value:function(e,t){if(e){var r;null===(r=this.sdkData)||void 0===r||r.api.addPlaceholder(N.a.Body)}else{var n,i=U.U.body,o=(null==t?void 0:t.sdkData)||(null===(n=this.findChildByPlTypeNum(i))||void 0===n?void 0:n.sdkData);this.handleUnCheckedChange(o),this.unlinkMatchedShapesOfPlaceholder(o)}Object(x.c)({opername:w.e.DOC_PPT,module:w.d.MASTER,action:w.b.MASTER_TEXT_CHECKBOX_CLICK})}},{key:"handleDateCheckedChange",value:function(e,t){if(e){var r;null===(r=this.sdkData)||void 0===r||r.api.addPlaceholder(N.a.Date)}else{var n,i=U.U.dt,o=(null==t?void 0:t.sdkData)||(null===(n=this.findChildByPlTypeNum(i))||void 0===n?void 0:n.sdkData);this.handleUnCheckedChange(o),this.unlinkMatchedShapesOfPlaceholder(o)}Object(x.c)({opername:w.e.DOC_PPT,module:w.d.MASTER,action:w.b.MASTER_DATE_CHECKBOX_CLICK})}},{key:"handleFooterPlCheckedChange",value:function(e,t){if(e){var r;null===(r=this.sdkData)||void 0===r||r.api.addPlaceholder(N.a.Footer)}else{var n,i=U.U.ftr,o=(null==t?void 0:t.sdkData)||(null===(n=this.findChildByPlTypeNum(i))||void 0===n?void 0:n.sdkData);this.handleUnCheckedChange(o),this.unlinkMatchedShapesOfPlaceholder(o)}Object(x.c)({opername:w.e.DOC_PPT,module:w.d.MASTER,action:w.b.MASTER_FOOTER_CHECKBOX_CLICK})}},{key:"handleNumberPlCheckedChange",value:function(e,t){if(e){var r;null===(r=this.sdkData)||void 0===r||r.api.addPlaceholder(N.a.SlideNumber)}else{var n,i=U.U.sldNum,o=(null==t?void 0:t.sdkData)||(null===(n=this.findChildByPlTypeNum(i))||void 0===n?void 0:n.sdkData);this.handleUnCheckedChange(o),this.unlinkMatchedShapesOfPlaceholder(o)}Object(x.c)({opername:w.e.DOC_PPT,module:w.d.MASTER,action:w.b.MASTER_PAGE_NUM_CHECKBOX_CLICK})}},{key:"handleOtherCheckedChange",value:function(e,t){if(e);else{var r=t;this.handleUnCheckedChange(r)}}},{key:"getTheme",value:function(){var e=this;return this.parent.themeList.find((function(t){return t.id===e.themeId}))}},{key:"handleUnCheckedChange",value:function(e){e&&this.deleteShapes([e])}},{key:"unlinkMatchedShapesOfPlaceholder",value:function(e){var t;null===(t=this.sdkData)||void 0===t||t.api.unlinkMatchedShapesOfPlaceholder(e)}}],[{key:"convertDataUiToSdk",value:function(e,t,r){k()(P()(u),"convertDataUiToSdk",this).call(this,e,t,r)}},{key:"convertDataSdkToUi",value:(t=l()(D.a.mark((function e(t,r,n,i){var o,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k()(P()(u),"convertDataSdkToUi",this).call(this,t,r,n,i),B.a.convertPartialDataFromSdkToUi(t.props,r),"layoutList"===(null==i||null===(o=i.diffs)||void 0===o||null===(a=o.childList)||void 0===a?void 0:a.key)&&r.parent.convertMasterAndLayoutSdkDataToUiData();case 3:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),u}(F.a),i=M()(n.prototype,"preload",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=M()(n.prototype,"layoutList",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),n)},b0233a497a:function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"a",(function(){return d}));r("8a14e05f2c"),r("826dc923b3"),r("c6244f7705"),r("081c8cafea");var n=r("eabf3daf43"),i=r("0cbec907c5");function o(e,t,r){if("number"!=typeof e||Number.isNaN(e))return{width:t,height:r};var n=t,i=r;return t/r>e?n=i*e:i=n/e,{width:n,height:i}}function a(e){return o(e,i.m,i.l)}function l(e){return o(e,i.i,i.h)}function u(e){if(e){var t=Object(n.h)(e),r=t.w,i=t.h,o=Number(r),a=Number(i);return o&&a&&!Number.isNaN(o)&&!Number.isNaN(a)?o/a:void 0}}function c(e){return!("number"!=typeof e||Number.isNaN(e))}function d(e){return new Promise((function(t,r){var n=new Image;n.onload=function(){var e=n.width,r=n.height;t({width:e,height:r})},n.onerror=function(){r(new Error("Failed to load image"))},n.src=e}))}},b4060fa5e7:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.MinSquare="minSquare",e.Square="square",e.Rect="rect",e.Line="hor-line",e.Circle="circle"}(n||(n={}))},b684da8955:function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return l})),r.d(t,"d",(function(){return u}));r("b8217400dc"),r("e6f68cdf2e"),r("8e7cce0ada"),r("c6244f7705"),r("c9a7ecac4d"),r("85d48ef22b"),r("2a6f332b5e"),r("8ee19818c4"),r("8aebbf296a");var n=r("e0e8dd9366");function i(e,t){for(var r=!1;e.parent&&!0!==r;)(e=e.parent).type!==n.d.GROUP&&e.type!==n.d.SMART_ART||(r=t(e))}function o(e,t){for(var r=!1;e.parent&&!0!==r;)(e=e.parent).type===n.d.GROUP&&(r=t(e))}function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e&&e.type===n.d.GROUP)for(var i=e.children.length,o=0;o<i;o++){var l=e.children[o];null!=l&&l.type&&r&&Array.isArray(r)&&r.includes(l.type)||t(l),(null==l?void 0:l.type)===n.d.GROUP&&a(l,t,r)}}function l(e,t){var r=[],i=[],a={},l=0;if(e&&e.length>0)for(var u=0;u<e.length;u++){var c;if((null===(c=e[u].parent)||void 0===c?void 0:c.type)===n.d.GROUP){var d=null;if(o(e[u],(function(e){d=e})),d){var s=d.key;if(a[s]){r[a[s]-1].push(e[u])}else{var f=[e[u]];r.push(f),l+=1,a[s]=l,i[l-1]=d}}}}t&&t(i,r)}function u(e){if(e.length<=1)return e;var t=new Set,r=new Set(e);return e.forEach((function(e){t.add(e),o(e,(function(e){e.children.forEach((function(e){t.has(e)||(t.add(e),r.delete(e))}))}))})),Array.from(r)}},c16ce1e345:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));r("73b854064b");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("547611bd96"),u=r.n(l),c=r("bd29e2df90"),d=r.n(c),s=r("ab5eb40518"),f=r.n(s),h=r("1b4cdd6a36"),p=r.n(h),v=r("85d0a7609b"),y=r.n(v),b=r("e5a826a0ff"),g=r("4e55019e41"),m=r("2b3a8fd0d8"),O=r("b684da8955");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var S=function(e){d()(r,e);var t=k(r);function r(e){var n;return i()(this,r),n=t.call(this,e),y()(u()(n),"adjustSmartArtFrameInfo",void 0),y()(u()(n),"smartArtModel",void 0),n.smartArtModel=e,n}return a()(r,[{key:"getAdjustedElementsAndProps",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(e=null===(t=this.smartArtModel.selectionService)||void 0===t?void 0:t.selectedElements.selectedArrayForType(b.a.SMART_ART))&&void 0!==e?e:[],n=arguments.length>1?arguments[1]:void 0;return this.adjustSmartArtFrameInfo||(this.adjustSmartArtFrameInfo=new m.b),this.adjustSmartArtFrameInfo.getAdjustedElementsAndProps(r,n)}},{key:"clearTempInfosWithElement",value:function(e){Object(O.c)(e,(function(e){e.groupChildFrameChangedByChildren&&(e.groupChildFrameChangedByChildren=null)}))}},{key:"getScaleRelativeToSlide",value:function(){var e={scaleX:this.smartArtModel.scaleX,scaleY:this.smartArtModel.scaleY};return Object(O.c)(this.smartArtModel,(function(t){e.scaleX*=t.scaleX,e.scaleY*=t.scaleY})),e}}]),r}(g.a)},c77811d8de:function(e,t,r){"use strict";r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return l})),r.d(t,"e",(function(){return u}));var n=r("9559b6ab8e"),i={NONE:"none",CLICK_EFFECT:"clickEffect",WITH_EFFECT:"withEffect",AFTEREFFECT:"afterEffect"},o={ARC:n.b.Arc,STRAIGHT_LINE:n.b.StraightLine,CYCLE:n.b.Cycle,SHAPE:n.b.Shape,TURN:n.b.Turn,CUSTOM:n.b.Custom},a={PLAY:n.b.Play,PAUSE:n.b.Pause,STOP:n.b.Stop},l={NONE:"none",HOLD:"hold",REMOVE:"remove"},u={NONE:"none",ENTR:"entr",EXIT:"exit",EMPH:"emph",PATH:"path",MEDIA:"mediacall"}},d0e88023e6:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));r("342844cefa"),r("a84962d637"),r("c554310b5c"),r("bcb5d93d36");var n=r("14502724a6"),i=r.n(n),o=r("85d0a7609b"),a=r.n(o),l=r("9132715560"),u=r.n(l),c=r("6a364eb35c"),d=r.n(c),s=(r("0acdc5834b"),r("6e20b6a7d8"),r("8a35b54c1d"),r("85d48ef22b"),r("8e7cce0ada"),r("2a6f332b5e"),r("3dc760a4d9"),r("b8217400dc"),r("e6f68cdf2e"),r("8ee19818c4"),r("c9c92622ff")),f=r("7c46f42788"),h=r("78db0f5ada"),p=r("0e0be5791f"),v=r.n(p),y=r("285f8ccc4f");function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=function(){function e(){u()(this,e)}return d()(e,null,[{key:"filter",value:function(e){var t=this,r=!1,n=function(e){var t=Object(s.A)(e);return t&&(r=!0),t};return[e.reduce((function(e,r){if(r.type===f.a.Slide)return e.push(t.filterAttachmentInSlide(r,n)),e;var i=t.filterAttachmentInChildData(r,n);return t.addIfTruly(i,e)}),[]),r]}},{key:"filterAttachmentInSlide",value:function(e,t){var r=this,n=e,i=n.getWritableOwnedData(),o=n.shapeList.reduce((function(e,n){var i=r.filterAttachmentInChildData(n,t);return r.addIfTruly(i,e)}),[]),a=n.shapeList.filter((function(e){return!o.some((function(t){return t.id===e.id}))})).map((function(e){return e.id})),l=i.timing&&this.filterAttachmentTiming(a,i.timing);return g(g({},Object(y.a)(v()(i,["cSld","timing"]))),{},{cSld:g(g({},i.cSld),i.cSld.spTree?{spTree:g(g({},i.cSld.spTree),{},{shapeList:o})}:{}),timing:l})}},{key:"filterAttachmentTiming",value:function(e,t){var r=g({},t);if(!t.unitTimeNodeMap)return r;r.unitTimeNodeMap={};for(var n=0,o=Object.entries(t.unitTimeNodeMap);n<o.length;n++){var a=i()(o[n],2),l=a[0],u=a[1];null!=u&&u.unitTimeNodeList&&!e.includes(l)&&(r.unitTimeNodeMap[l]=g(g({},u),{},{unitTimeNodeList:u.unitTimeNodeList.filter((function(t){return!e.some((function(e){var r;return null!==(r=e===h.a.getShapeId(t))&&void 0!==r?r:""}))}))}))}return r}},{key:"filterAttachmentInChildData",value:function(e,t){return e.type===f.a.GroupShape?this.filterAttachmentInGroup(e,t):this.filterAttachmentInNormal(e,t)}},{key:"filterAttachmentInGroup",value:function(e,t){var r=this,n=[];return e.shapeList.forEach((function(e){var i=r.filterAttachmentInChildData(e,t);r.addIfTruly(i,n)})),0===n.length?null:1===n.length?n[0]:g(g({},null==e?void 0:e.getWritableOwnedData()),{},{shapeList:n})}},{key:"filterAttachmentInNormal",value:function(e,t){if(t(e))return null;if(null!=e&&e.getWritableOwnedData()){if(e.type===f.a.GraphicalObjectFrameChart){var r,n,i,o,a=e.getWritableOwnedData();return g(g({},a),{},{chartSpace:a.chartSpace&&g(g({},a.chartSpace),{},{chart:a.chartSpace.chart&&g(g({},a.chartSpace.chart),{},{plotArea:a.chartSpace.chart.plotArea&&g(g({},a.chartSpace.chart.plotArea),{},{charts:null===(r=a.chartSpace)||void 0===r||null===(n=r.chart)||void 0===n||null===(i=n.plotArea)||void 0===i||null===(o=i.charts)||void 0===o?void 0:o.map((function(e){return e}))})})})})}return null==e?void 0:e.getWritableOwnedData()}}},{key:"addIfTruly",value:function(e,t){return e&&t.push(e),t}}]),e}()},d2df6c0011:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o}));r("a2a09da1e3");var n=r("96818dd0e4");function i(e){var t="",r="",i=n.a;if(e&&0===e.indexOf(i)){var o=e.indexOf("?");o>0?(t=e.substring(i.length,o),r=decodeURI(e.substring(o+9))):t=e.substring(i.length)}return{address:t,subject:r}}function o(e){var t=e.address,r=e.subject,i=n.a;return t&&(i+=t),r&&(i+="?subject=".concat(encodeURI(r))),i}},d97e8bdaab:function(e,t,r){"use strict";r.d(t,"a",(function(){return X}));r("73b854064b");var n,i,o=r("7a5536c9bf"),a=r.n(o),l=r("176815363d"),u=r.n(l),c=r("1f925d7f50"),d=r.n(c),s=r("9132715560"),f=r.n(s),h=r("6a364eb35c"),p=r.n(h),v=r("547611bd96"),y=r.n(v),b=r("bd29e2df90"),g=r.n(b),m=r("ab5eb40518"),O=r.n(m),k=r("8eec1e4a03"),S=r.n(k),P=r("1b4cdd6a36"),C=r.n(P),R=r("85d0a7609b"),A=r.n(R),M=r("2dc700e1e6"),T=r.n(M),D=(r("f1054791f4"),r("3ef2352f0b")),F=r.n(D),E=(r("75563bc376"),r("c6244f7705"),r("081c8cafea"),r("8e7cce0ada"),r("85d48ef22b"),r("2a6f332b5e"),r("8a35b54c1d"),r("24f382e0f4"),r("963f2eaace"),r("fa034a86e9")),I=r("e0e8dd9366"),j=r("c49b1dfed9"),w=r("9657b29818"),x=r("d3d31c86eb"),L=r("9da6335152"),B=r("be02c6bd58"),N=r("9541c1076d"),U=r.n(N),G=r("c45b58bbe8"),_=r("90225ed0ae"),V=r("f78be71a2b"),H=r("711a53c9fc"),z=r("477433b002"),W=r("3471fb3b60"),Y=r("d5c3deb8c7");function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=C()(e);if(t){var i=C()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return O()(this,r)}}var X=(n=function(e){g()(l,e);var t,r,n,o=K(l);function l(){var e;return f()(this,l),e=o.call(this),d()(y()(e),"preload",i,y()(e)),A()(y()(e),"masterId",void 0),A()(y()(e),"autoConvertChildren",!0),A()(y()(e),"layoutType",void 0),A()(y()(e),"needConvertChildren",!0),A()(y()(e),"isLayout",!0),e.type=I.d.LAYOUT,e}return p()(l,[{key:"getRelationMasterModel",value:function(){var e,t=this;return null===(e=this.presentationRef)||void 0===e?void 0:e.masterList.find((function(e){return(null==e?void 0:e.id)===t.masterId}))}},{key:"getRelationLayoutModel",value:function(){return this}},{key:"bindSDK",value:(n=u()(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S()(C()(l.prototype),"bindSDK",this).call(this,t),this.needConvertChildren&&this.presentationRef&&(this.needConvertChildren=this.presentationRef.needConvertChildren);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"convertSdkToUiChildrenLogic",value:(r=u()(F.a.mark((function e(t){var r,n,i,o=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],this.needConvertChildren){e.next=3;break}return e.abrupt("return");case 3:if((i=[]).push(this.getChildrenConvertPromise(W.a.NORMAL)),!this.asyncConvertChildren){e.next=9;break}return e.next=8,Promise.all(i);case 8:this.asyncConvertChildren=!1;case 9:this.presentationRef.layoutChildrenMap[null===(r=this.sdkData)||void 0===r?void 0:r.id]=this.children.filter((function(e){return!e.isPlaceholder})),this.setSyncLoad(),n||(this.childrenConverted=!0);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updatePlaceholderFormat",value:function(e){var t,r,n=this,i=e.value,o=e.checked,a=e.targetShape;null===(t=this.selectionService)||void 0===t||t.selectedWithCommit.markSpecialOperate(z.a.keep),Object(w.b)((function(){switch(i){case B.e:n.handleTitlePlCheckedChange(o,a);break;case B.b:n.handleDateCheckedChange(o,a);break;case B.c:n.handleFooterCheckedChange(o,a);break;case B.d:n.handleNumberCheckedChange(o,a);break;default:n.handleOtherCheckedChange(o,a)}})),null===(r=this.selectionService)||void 0===r||r.selectedElements.clear()}},{key:"handleTitlePlCheckedChange",value:function(e,t){if(e){var r,n=null===(r=this.sdkData)||void 0===r?void 0:r.api.addUniquePlaceholder(V.a.Title);this.handleCheckedChange(n)}else{var i=t||this.findChildByPlTypeNum(H.U.title)||this.findChildByPlTypeNum(H.U.ctrTitle);this.handleUnCheckedChange(null==i?void 0:i.sdkData)}Object(x.c)({opername:L.e.DOC_PPT,module:L.d.MASTER,action:L.b.MASTER_TITLE_CHECKBOX_CLICK})}},{key:"handleDateCheckedChange",value:function(e,t){if(e){var r,n=null===(r=this.sdkData)||void 0===r?void 0:r.api.addUniquePlaceholder(V.a.Date);this.handleCheckedChange(n)}else{var i,o=H.U.dt,a=(null==t?void 0:t.sdkData)||(null===(i=this.findChildByPlTypeNum(o))||void 0===i?void 0:i.sdkData);this.handleUnCheckedChange(a)}Object(x.c)({opername:L.e.DOC_PPT,module:L.d.MASTER,action:L.b.MASTER_DATE_CHECKBOX_CLICK})}},{key:"handleFooterCheckedChange",value:function(e,t){if(e){var r,n=null===(r=this.sdkData)||void 0===r?void 0:r.api.addUniquePlaceholder(V.a.Footer);this.handleCheckedChange(n)}else{var i,o=H.U.ftr,a=(null==t?void 0:t.sdkData)||(null===(i=this.findChildByPlTypeNum(o))||void 0===i?void 0:i.sdkData);this.handleUnCheckedChange(a)}Object(x.c)({opername:L.e.DOC_PPT,module:L.d.MASTER,action:L.b.MASTER_FOOTER_CHECKBOX_CLICK})}},{key:"handleNumberCheckedChange",value:function(e,t){if(e){var r,n=null===(r=this.sdkData)||void 0===r?void 0:r.api.addUniquePlaceholder(V.a.SlideNumber);this.handleCheckedChange(n)}else{var i,o=H.U.sldNum,a=(null==t?void 0:t.sdkData)||(null===(i=this.findChildByPlTypeNum(o))||void 0===i?void 0:i.sdkData);this.handleUnCheckedChange(a)}Object(x.c)({opername:L.e.DOC_PPT,module:L.d.MASTER,action:L.b.MASTER_PAGE_NUM_CHECKBOX_CLICK})}},{key:"handleOtherCheckedChange",value:function(e,t){e||this.handleUnCheckedChange(null==t?void 0:t.sdkData)}},{key:"addNewPlaceholder",value:function(e,t){var r,n=this,i=e.style,o=i.top,l=i.left,u=i.width,c=i.height,d={},s=this.sdkData;r={},A()(r,j.a.INSERT_PLACEHOLDER_HORZ_CONTENT,(function(){var e;return null==s||null===(e=s.api)||void 0===e?void 0:e.addPlaceholder(V.a.Content)})),A()(r,j.a.INSERT_PLACEHOLDER_VERT_CONTENT,(function(){var e;return null==s||null===(e=s.api)||void 0===e?void 0:e.addPlaceholder(V.a.Content,!0)})),A()(r,j.a.INSERT_PLACEHOLDER_HORZ_TEXT,(function(){var e;return null==s||null===(e=s.api)||void 0===e?void 0:e.addPlaceholder(V.a.Body)})),A()(r,j.a.INSERT_PLACEHOLDER_VERT_TEXT,(function(){var e;return null==s||null===(e=s.api)||void 0===e?void 0:e.addPlaceholder(V.a.Body,!0)})),A()(r,j.a.INSERT_PLACEHOLDER_PICTURE,(function(){var e;return null==s||null===(e=s.api)||void 0===e?void 0:e.addPlaceholder(V.a.Picture)})),A()(r,j.a.INSERT_PLACEHOLDER_TABLE,(function(){var e;return null==s||null===(e=s.api)||void 0===e?void 0:e.addPlaceholder(V.a.Table)})),d=r,Object(w.b)((function(){var e,r,i,a,s=null===(e=(r=d)[t])||void 0===e?void 0:e.call(r),f=s,h={style:{flipH:0,flipV:0,height:c,left:l,rotate:0,top:o,width:u}},p=new G.a;if(p){p.props=U()(p.props,h);var v=[],y=[],b={};Object.getPrototypeOf(p).constructor.convertDataUiToSdk(p,b,n),y.push(b),v.push(f),null===(i=n.presentationRef)||void 0===i||null===(a=i.sdkData)||void 0===a||a.api.forEachInTransaction(v,(function(e,t){e.api.updateProps(y[t])})),n.handleCheckedChange(s)}})),Object(w.b)((function(){var e;if(n.selectionService){n.selectionService.selectedElements.clear();var t=n.children.slice(-1);(e=n.selectionService.selectedElements).add.apply(e,a()(t))}}))}},{key:"handleCheckedChange",value:function(e){var t;e&&(null===(t=this.sdkData)||void 0===t||t.api.linkMatchedShapesOfPlaceholder(e))}},{key:"handleUnCheckedChange",value:function(e){var t;e&&(this.deleteShapes([e]),null===(t=this.sdkData)||void 0===t||t.api.unlinkMatchedShapesOfPlaceholder(e))}}],[{key:"convertDataSdkToUi",value:(t=u()(F.a.mark((function e(t,r,n,i){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S()(C()(l),"convertDataSdkToUi",this).call(this,t,r,n,i),_.a.convertPartialDataFromSdkToUi(t.props,r);case 2:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),l}(E.a),i=T()(n.prototype,"preload",[Y.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},db8665b60e:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return h}));var n=r("37884b4887"),i=r("c4ce95b323"),o=r("e0e8dd9366"),a=r("2c0f58c21b"),l=r("e98fc7647c"),u=r("f6115d1d70"),c=r("c45b58bbe8"),d=r("efc1955963"),s=r("fdce3a8bd2");function f(e){switch(e){case o.d.SHAPE:return new c.a;case o.d.IMAGE:return new u.a;case o.d.GROUP:return new a.a;case o.d.CONNECTOR:return new i.a;case o.d.CHART:return new n.a;case o.d.NOTE:return new l.a;case o.d.TABLE:return new d.a;case o.d.SMART_ART:return new s.a}}function h(e){switch(e){case o.d.SHAPE:return c.a;case o.d.IMAGE:return u.a;case o.d.GROUP:return a.a;case o.d.SMART_ART:return s.a;case o.d.CONNECTOR:return i.a;case o.d.CHART:return n.a;case o.d.NOTE:return l.a;case o.d.TABLE:return d.a}}},e98fc7647c:function(e,t,r){"use strict";r("73b854064b");var n=r("176815363d"),i=r.n(n),o=r("9132715560"),a=r.n(o),l=r("6a364eb35c"),u=r.n(l),c=r("547611bd96"),d=r.n(c),s=r("8eec1e4a03"),f=r.n(s),h=r("bd29e2df90"),p=r.n(h),v=r("ab5eb40518"),y=r.n(v),b=r("1b4cdd6a36"),g=r.n(b),m=r("85d0a7609b"),O=r.n(m),k=r("3ef2352f0b"),S=r.n(k),P=(r("3bf1976a4f"),r("c6244f7705"),r("081c8cafea"),r("b7e835a157")),C=r("c45b58bbe8"),R=r("c73625d763"),A=r.n(R),M=r("ee6bb53310"),T=r.n(M),D=r("1e174780ae"),F=r("07586e7add"),E=r("4197f8e070");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var i=g()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return y()(this,r)}}var j=function(e){p()(n,e);var t,r=I(n);function n(){var e;a()(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e=r.call.apply(r,[this].concat(i)),O()(d()(e),"noteTextBody",void 0),O()(d()(e),"initData",(function(){if(e.noteTextBody)e.noteTextBody.unbindSDK(),e.noteTextBody.initParagraphList();else{var t=new C.a;t.initParagraphList(),t.parent=d()(e),e.noteTextBody=t}})),e}return u()(n,null,[{key:"convertDataSdkToUi",value:(t=i()(S.a.mark((function e(t,r,i){var o,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f()(g()(n),"convertDataSdkToUi",this).call(this,t,r,i),E.a.convertPartialDataFromSdkToUi(t.props,r),F.a.convertDataSdkToUi(t,r,void 0),o=t.note,a=t.note,o&&(r.noteTextBody.unbindSDK(),r.noteTextBody.bindSDK(a));case 6:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"convertDataUiToSdk",value:function(e,t,r){if(f()(g()(n),"convertDataUiToSdk",this).call(this,e,t,r),A()(e,"noteTextBody.paragraphList")){var i={};D.a.convertPartialDataFromUiToSdk(e.noteTextBody,i,r),T()(t,"note",i)}}}]),n}(P.a);t.a=j},e9b1a65b0e:function(e,t,r){"use strict";r.d(t,"a",(function(){return D}));var n,i,o,a,l=r("1f925d7f50"),u=r.n(l),c=r("9132715560"),d=r.n(c),s=r("6a364eb35c"),f=r.n(s),h=r("85d0a7609b"),p=r.n(h),v=r("2dc700e1e6"),y=r.n(v),b=(r("f1054791f4"),r("8a35b54c1d"),r("342844cefa"),r("b8217400dc"),r("75563bc376"),r("e6f68cdf2e"),r("8ee19818c4"),r("730207179f")),g=r("a859b64b06"),m=r("3344f1a2e7"),O=r("7ce5f66a4e"),k=r("e0e8dd9366"),S=r("9657b29818"),P=r("7d1df7d0fb"),C=r("96745b5cc3"),R=r("d5c3deb8c7"),A=r("9789b08c01"),M=r("82826243ac"),T=r("ed9b19c8a4"),D=(n=R.q,i=Reflect.metadata("design:type",void 0===O.IBorderInfo?Object:O.IBorderInfo),o=function(){function e(t){var r=this;d()(this,e),p()(this,"model",void 0),p()(this,"onlyUIChange",void 0),p()(this,"isPreviewColor",void 0),u()(this,"mergePropertyValCache",a,this),p()(this,"getBorderType",(function(){var e=r.getBorderInfo();if(r.model.type===k.d.MULTIPLY){var t,n;if(!e)return;var i=Object(P.a)(r.model),o=(null===(t=(n=i[0]).getBorder)||void 0===t?void 0:t.call(n).getBorderInfo())||{},a=Object.keys(o).filter((function(e){return![null,void 0].includes(o[e])})).length,l=Object.keys(e).filter((function(t){return![null,void 0].includes(e[t])})).length;if(a!==l)return;var u=i.find((function(e){var t,r;return Object(M.a)(null===(t=e.props.style.border)||void 0===t||null===(r=t.sketchStyle)||void 0===r?void 0:r.type)}));if(u){var c,d=(null===(c=u.getBorder)||void 0===c?void 0:c.call(u).getBorderInfo())||{};if(l!==Object.keys(d).filter((function(e){return![null,void 0].includes(d[e])})).length)return}}return null!=e&&e.gradFill?O.b.GradualFill:null!=e&&e.color?O.b.SolidFill:O.b.NoFill})),p()(this,"getBorderInfo",(function(){if([k.d.GROUP,k.d.MULTIPLY].includes(r.model.type))return r.mergePropertyValCache;if(r.model.type===k.d.TABLE)return r.model.getBorder().getTableBorderInfo().borderColor;if(!r.model.props)return null;var e=r.model.props.style;return e.border&&Object.keys(e.border).forEach((function(t){Object(b.a)(e.border,t)})),e.border})),p()(this,"handleBorder",(function(e,t){if(e.type===k.d.TABLE)e.getBorder().updateTableBorderInfo(t);else if(e.type===k.d.MULTIPLY){e.selectedModels.forEach((function(e){r.handleBorder(e,Object(A.a)(t,!0))}))}else e.type===k.d.GROUP?e.children.forEach((function(e){r.handleBorder(e,t)})):r.updateModelBorder(e,t)})),this.mergePropertyValCache=null,this.model=t}return f()(e,[{key:"updateCurrentBorder",value:function(e,t,r){var n=this;this.onlyUIChange=t,this.isPreviewColor=r,t?this.handleBorder(this.model,e):Object(S.b)((function(){n.handleBorder(n.model,e)}))}},{key:"handleBorderSpecial",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getBorderInfo(),r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getBorderType())===O.b.NoFill;r&&(null!=e&&e.style||null!=e&&e.width)&&!e.color&&!e.gradFill?e.color="#000000":(this.setBorderColor(e,t),this.setBorderStyleAndWidth(r,e))}},{key:"refreshMergePropertyValCache",value:function(){if([k.d.GROUP,k.d.MULTIPLY].includes(this.model.type)){var e=this.model,t=Object(P.d)(e,(function(e){var t;return p()({},O.a,null===(t=e.getBorder)||void 0===t?void 0:t.call(e).getBorderInfo())}));this.mergePropertyValCache=t[O.a]||null}return this.mergePropertyValCache}},{key:"setBorderColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getBorderInfo();this.isPreviewColor||void 0!==(null==e?void 0:e.color)||"#000000"!==(null==t?void 0:t.color)||e&&(e.color=t.color)}},{key:"setBorderStyleAndWidth",value:function(e,t){e&&null!=t&&t.color&&!t.style&&!t.width&&(t.style="solid",t.width=Object(m.C)(1))}},{key:"updateModelBorder",value:function(e,t){this.handleBorderSpecial(t,e.getBorder().getBorderInfo(),e.getBorder().getBorderType());var r={style:{border:t}};if(this.onlyUIChange)g.a.updateUiProps(r,e),e.previewChange+=1;else{var n=C.a.convertToUpdateAndRemove(r,e.props);T.a.updateSketchUpdateAndRemoveProps(e,r,n),n.remove?e.updateAndRemoveProps(n.update,n.remove):e.updateProps(n.update)}}}]),e}(),a=y()(o.prototype,"mergePropertyValCache",[n,i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)},eb36e1b9a0:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("a2a09da1e3"),r("e0e8dd9366")),d=r("9657b29818"),s=r("f9193d718f"),f=r("516fa97df2"),h=function(){function e(t){i()(this,e),u()(this,"elementModelRef",void 0),this.elementModelRef=t}return a()(e,[{key:"getGraphicInfo",value:function(){if(this.elementModelRef.type===c.d.SHAPE||this.elementModelRef.type===c.d.IMAGE){var e=this.elementModelRef;return{bgShape:e.props.style.bgShape,controlValues:e.props.style.controlValues}}return null}},{key:"updateGraphicInfo",value:function(e){var t=this;this.elementModelRef.type!==c.d.SHAPE&&this.elementModelRef.type!==c.d.IMAGE||Object(d.b)((function(){var r;t.elementModelRef.updateProps({style:e}),null===(r=t.getBorderSketchManager())||void 0===r||r.updatePathListWhenSizeChange(t.elementModelRef,e)}))}},{key:"getGraphicLinInfo",value:function(){if(this.elementModelRef.type===c.d.CONNECTOR){var e=this.elementModelRef;return{bgLine:e.props.style.bgLine,controlValues:e.props.style.controlValues}}return null}},{key:"updateGraphicLineInfo",value:function(e){this.elementModelRef.type===c.d.CONNECTOR&&this.elementModelRef.updateProps({style:e})}},{key:"isPathOpened",value:function(e){if(-1===e.indexOf("Z")&&-1===e.indexOf("z")){var t=f.G.parse(e),r=t.length;return!(r>1&&t[0].x===t[r-1].x&&t[0].y===t[r-1].y)}return!1}},{key:"getBorderSketchManager",value:function(){var e;return null===(e=s.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.borderSketchManager}}]),e}()},ed9b19c8a4:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r("7a5536c9bf"),i=r.n(n),o=r("9132715560"),a=r.n(o),l=r("6a364eb35c"),u=r.n(l),c=(r("405b4a5e2b"),r("8ee19818c4"),r("3bf1976a4f"),r("c73625d763")),d=r.n(c),s=r("ee6bb53310"),f=r.n(s),h=r("672a8f3b69"),p=r("7a4a9cf3b8"),v=r("33c34da0d5"),y=r("e0e8dd9366"),b=function(){function e(){a()(this,e)}return u()(e,null,[{key:"updateSketchUpdateAndRemoveProps",value:function(t,r,n){var i;if(this.shouldUpdate(t,r)){var o=(null===(i=t.props)||void 0===i?void 0:i.style)||{},a=o.bgShape,l=o.controlValues,u=o.pathList,c=o.border,d=(r.style.border.sketchStyle||{}).type,s=void 0===d?h.b.NONE:d;if(s===h.b.NONE){var y,b=null==c||null===(y=c.sketchStyle)||void 0===y?void 0:y.bgShape;if(f()(n,"update.style.bgShape",b),f()(n,"update.style.border.sketchStyle",{type:s,bgShape:this.getBgShape(t,b),controlValues:null!=l?l:[],customGeom:this.getCustomGeom(t,this.getPathList(t,b,u))}),b===v.e.CUSTOM){var g,m=e.getCustomGeom(t,null==c||null===(g=c.sketchStyle)||void 0===g?void 0:g.pathList);f()(n,"update.style.customGeom",m)}else f()(n,"update.style.customGeom",null),f()(n,"remove.style.customGeom",null)}else{var O,k;f()(n,"update.style.bgShape",v.e.CUSTOM);var S=p.a.generateSketchPathList({model:t,type:s});f()(n,"update.style.customGeom",e.getCustomGeom(t,S)),f()(n,"update.style.border.sketchStyle",{type:s,bgShape:this.getBgShape(t,a),controlValues:null!=l?l:[],customGeom:this.getCustomGeom(t,this.getPathList(t,a,u))}),f()(n,"remove.style.bgShape",a),(null==c||null===(O=c.sketchStyle)||void 0===O?void 0:O.bgShape)===v.e.CUSTOM&&(null==c||null===(k=c.sketchStyle)||void 0===k?void 0:k.type)===h.b.NONE&&(f()(n,"remove.style.border.sketchStyle.bgShape",v.e.CUSTOM),f()(n,"remove.style.border.sketchStyle.customGeom",null))}}}},{key:"getCustomGeom",value:function(e,t){if(t){var r=[],n=e.props.style.pathList;if(n){var o=Math.max(n.length-t.length,0);r=Array(o).fill(null)}return t.forEach((function(e,t){e&&(!d()(e,"stroke")&&d()(n[t],"stroke")&&(e.stroke=1),!d()(e,"fill")&&d()(n[t],"fill")&&(e.fill=v.b.NORMAL))})),{pathList:[].concat(i()(t),i()(r)),rect:{b:"b",l:"l",r:"r",t:"t"}}}}},{key:"shouldUpdate",value:function(e,t){var r,n,i,o,a=((null===(r=e.props)||void 0===r?void 0:r.style)||{}).border,l=t.style.border.sketchStyle;if(l)return!(e.type!==y.d.IMAGE&&e.type!==y.d.SHAPE||(null==a||null===(n=a.sketchStyle)||void 0===n?void 0:n.type)===(null==l?void 0:l.type)||(null==a||null===(i=a.sketchStyle)||void 0===i||!i.type)&&(null==l?void 0:l.type)===h.b.NONE||(null==l||!l.type)&&(null==a||null===(o=a.sketchStyle)||void 0===o?void 0:o.type)===h.b.NONE)}},{key:"getBgShape",value:function(e,t){var r,n,i,o,a,l=((null===(r=e.props)||void 0===r?void 0:r.style)||{}).border;return null!==(n=(null==l||null===(i=l.sketchStyle)||void 0===i?void 0:i.type)===h.b.NONE?t:null!==(o=null==l||null===(a=l.sketchStyle)||void 0===a?void 0:a.bgShape)&&void 0!==o?o:t)&&void 0!==n?n:v.e.RECT}},{key:"getPathList",value:function(e,t,r){var n,i,o,a,l,u,c=((null===(n=e.props)||void 0===n?void 0:n.style)||{}).border;return(null!==(i=null==c||null===(o=c.sketchStyle)||void 0===o?void 0:o.bgShape)&&void 0!==i?i:t)===v.e.CUSTOM&&(null==c||null===(a=c.sketchStyle)||void 0===a?void 0:a.type)!==h.b.NONE?null!==(l=null==c||null===(u=c.sketchStyle)||void 0===u?void 0:u.pathList)&&void 0!==l?l:r:void 0}}]),e}()},f05fc355c3:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("8ee19818c4"),r("3bf1976a4f"),r("0acdc5834b"),r("963f2eaace"),r("e0e8dd9366")),d=r("b684da8955"),s=r("7d1df7d0fb"),f=r("9657b29818"),h=r("3f08d65fa4"),p=r("d041da251a"),v=r("75f19a1449");function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e){return e.type===c.d.GROUP}function m(e){return e.type===c.d.SHAPE}function O(e){return e.type===c.d.MULTIPLY}var k=function(){function e(t){var r=this;i()(this,e),u()(this,"handleMultiplyModel",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o=r.model;O(o)?Object(f.b)((function(){o.selectedModels.forEach((function(t){return e.call.apply(e,[r,t].concat(n))}))})):e.call.apply(e,[r,o].concat(n))})),u()(this,"resetChild3dProperties",(function(e){r.canModelHaveScene3dProperty(e)&&e.sdkData&&(e.scene3d=void 0,e.shape3d=void 0,Object(f.b)((function(){e.updateAndRemoveProps({},{scene3d:null,shape3d:null})})))})),u()(this,"updateChildScene3D",(function(e,t){t&&(!t.camera&&t.lightRig&&(t.camera={preset:"orthographicFront"}),!t.lightRig&&t.camera&&(t.lightRig={direction:"t",rigPreset:"threePt"}));var r=e,n=[];g(e)?Object(d.b)(e,(function(e){e.scene3d&&n.push(e)})):Object(d.a)(e,(function(e){if(e.scene3d)return r=e,!0})),Object(f.b)((function(){0!==n.length&&n.forEach((function(e){e.updateAndRemoveProps({},{scene3d:null})})),r.updateProps({scene3d:t})}))})),u()(this,"updateChildShape3D",(function(e,t){Object(f.b)((function(){e.shape3d=t;var r,n=null;t&&(n={},p.a.convertShape3DFromUiToSdk(t,null!==(r=n)&&void 0!==r?r:void 0));e.sdkData.api.updateProps({spPr:{sp3d:n}})}))})),u()(this,"updateChildExtrusionHeight",(function(e,t){if(e.sdkData){r.updateModelShape3dProperties(e,(function(e){e.shape3d||(e.shape3d={}),e.shape3d.extrusionHeight=t,r.updateChildShape3D(e,e.shape3d)}))}})),u()(this,"updateChildIsFlatText",(function(e,t){null!=e&&e.sdkData&&(g(e)?Object(f.b)((function(){Object(d.b)(e,(function(e){m(e)&&e.updateShowFlatText(t)}))})):m(e)&&e.updateShowFlatText(t))})),u()(this,"updateChildCameraRotation",(function(e,t){if(e.sdkData&&r.canModelHaveScene3dProperty(e)){var n=function(e){e.scene3d||(e.scene3d={}),e.scene3d.camera?(e.scene3d.camera.preset="orthographicFront",e.scene3d.camera.rotation=b({x:0,y:0,z:0},t)):e.scene3d={camera:{preset:"orthographicFront",rotation:b({x:0,y:0,z:0},t)}},r.updateChildScene3D(e,e.scene3d)};if(g(e)){var i=Object(s.e)(e,!1);Object(f.b)((function(){i.forEach((function(e){var t,r;e.scene3d&&(e.scene3d=void 0,null===(t=e.sdkData)||void 0===t||null===(r=t.removeProps)||void 0===r||r.call(t,{scene3d:null}))})),n(e)}))}else{var o=null;Object(d.a)(e,(function(e){if(e.scene3d)return o=e,!0})),n(o||e)}}})),u()(this,"updateChildLightRotation",(function(e,t){var n;e.sdkData&&r.canModelHaveScene3dProperty(e)&&(e.scene3d||(e.scene3d={}),null!==(n=e.scene3d)&&void 0!==n&&n.lightRig?e.scene3d.lightRig.rotation=b({x:0,y:0,z:0},t):e.scene3d.lightRig={direction:"t",rotation:b({x:0,y:0,z:0},t)},r.updateChildScene3D(e,e.scene3d))})),u()(this,"updateChildMaterialPreset",(function(e,t){if(e.sdkData){r.updateModelShape3dProperties(e,(function(n){n.shape3d||(n.shape3d={}),n.shape3d.materialPreset=t,r.updateChildShape3D(e,e.shape3d)}))}})),u()(this,"updateChildCameraPreset",(function(e,t){e.sdkData&&r.canModelHaveScene3dProperty(e)&&(e.scene3d||(e.scene3d={}),e.scene3d.camera||(e.scene3d.camera={}),e.scene3d.camera.rotation&&delete e.scene3d.camera.rotation,e.scene3d.camera.preset=t,r.updateChildScene3D(e,e.scene3d))})),u()(this,"updateChildBevelTop",(function(e,t){if(e.sdkData){r.updateModelShape3dProperties(e,(function(e){e.shape3d||(e.shape3d={}),e.shape3d.bevelTop=t}))}})),u()(this,"updateChildBevelBottom",(function(e,t){if(e.sdkData){r.updateModelShape3dProperties(e,(function(e){e.shape3d||(e.shape3d={}),e.shape3d.bevelTop=t}))}})),this.model=t}return a()(e,[{key:"reset3dProperties",value:function(){this.handleMultiplyModel(this.resetChild3dProperties)}},{key:"updateShape3D",value:function(e){this.handleMultiplyModel(this.updateChildShape3D,e)}},{key:"updateScene3D",value:function(e){this.handleMultiplyModel(this.updateChildScene3D,e)}},{key:"updateExtrusionHeight",value:function(e){this.handleMultiplyModel(this.updateChildExtrusionHeight,e)}},{key:"updateExtrusionColor",value:function(e){this.handleMultiplyModel(this.updateChildExtrusionColor,e)}},{key:"updateIsFlatText",value:function(e){this.handleMultiplyModel(this.updateChildIsFlatText,e)}},{key:"updateCameraRotation",value:function(e){this.handleMultiplyModel(this.updateChildCameraRotation,e)}},{key:"updateLightRotation",value:function(e){this.handleMultiplyModel(this.updateChildLightRotation,e)}},{key:"updateLightRigPreset",value:function(e){this.handleMultiplyModel(this.updateChildLightRigPreset,e)}},{key:"updateMaterialPreset",value:function(e){this.handleMultiplyModel(this.updateChildMaterialPreset,e)}},{key:"updateCameraPreset",value:function(e){this.handleMultiplyModel(this.updateChildCameraPreset,e)}},{key:"getMultiplyScene3D",value:function(){var e;if(O(this.model))return this.model.selectedModels.length<=1?null===(e=this.model.selectedModels[0])||void 0===e?void 0:e.scene3d:this.model.selectedModels.slice(1).reduce((function(e,t){return Object(h.a)(e,t.scene3d)}),this.model.selectedModels[0].scene3d)}},{key:"getMultiplyShape3D",value:function(){var e;if(O(this.model))return this.model.selectedModels.length<=1?null===(e=this.model.selectedModels[0])||void 0===e?void 0:e.shape3d:this.model.selectedModels.reduce((function(e,t){return Object(h.a)(e,t.shape3d)}),this.model.selectedModels[0].shape3d)}},{key:"getGroupShape3D",value:function(){var e=this.model;if(g(e)){var t,r=[];return Object(d.b)(e,(function(e){r.push(e)})),r.length<=1?null===(t=r[0])||void 0===t?void 0:t.shape3d:r.reduce((function(e,t){return Object(h.a)(e,t.shape3d)}),r[0].shape3d)}}},{key:"getElementBaseScene3D",value:function(){for(var e=this.model.parent;e;){if(e.type===c.d.GROUP&&e.scene3d)return e.scene3d;e=e.parent}}},{key:"updateChildExtrusionColor",value:function(e,t){var r=this;if(e.sdkData){this.updateModelShape3dProperties(e,(function(e){var n;e.shape3d||(e.shape3d={}),e.shape3d.extrusionColor||(e.shape3d.extrusionColor=new v.a({})),null===(n=e.shape3d.extrusionColor)||void 0===n||n.updateCustomColor(t),r.updateChildShape3D(e,e.shape3d)}))}}},{key:"updateChildLightRigPreset",value:function(e,t){e.sdkData&&this.canModelHaveScene3dProperty(e)&&(e.scene3d||(e.scene3d={}),e.scene3d.lightRig?e.scene3d.lightRig.rigPreset=t:e.scene3d.lightRig={rigPreset:t,direction:"t"},this.updateChildScene3D(e,e.scene3d))}},{key:"updateModelShape3dProperties",value:function(e,t){g(e)?Object(f.b)((function(){Object(d.b)(e,t)})):t(e)}},{key:"canModelHaveScene3dProperty",value:function(e){return g(e)||function(e){return e.type===c.d.SHAPE}(e)||function(e){return e.type===c.d.IMAGE}(e)}}]),e}()},f08da50217:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="链接已失效"},f216b3624d:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("e0e8dd9366"),i=r("2ba7871556"),o=r("f9193d718f");function a(e){var t,r=(null===(t=o.a.getInstance().getAppServices().viewableServiceLayer)||void 0===t?void 0:t.selectionService).getSelectedModel(),a=(null==r?void 0:r.type)===n.d.MULTIPLY;if(e.type===n.d.SHAPE&&((a?e.getBackgroundFill().getShownFillType():e.getBackgroundFill().getFillType())===i.b.ImageFill&&!e.isTextMath))return!0;return!1}},f22ee6a57a:function(e,t,r){"use strict";r.d(t,"a",(function(){return M}));r("73b854064b"),r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("14502724a6"),i=r.n(n),o=r("9132715560"),a=r.n(o),l=r("6a364eb35c"),u=r.n(l),c=r("547611bd96"),d=r.n(c),s=r("bd29e2df90"),f=r.n(s),h=r("ab5eb40518"),p=r.n(h),v=r("1b4cdd6a36"),y=r.n(v),b=r("85d0a7609b"),g=r.n(b),m=(r("b8217400dc"),r("e6f68cdf2e"),r("3bf1976a4f"),r("1bab7b5fb7"),r("9d7978d445"),r("34cd92f77a"),r("433247001a"),r("bd80bf2d0f"),r("826dc923b3"),r("304396ad9f")),O=r("9657b29818"),k=r("f9193d718f"),S=r("d3d31c86eb"),P=r("9da6335152");function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){g()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var M=function(e){f()(r,e);var t=A(r);function r(e){var n;return a()(this,r),n=t.call(this,e),g()(d()(n),"shapeModel",void 0),g()(d()(n),"cropWithWH",(function(e,t){var r,i,o,a=n.shapeModel.props.style,l=a.width,u=a.height,c=n.shapeModel.props.style,d=c.top,s=c.left,f=l,h=u,p=e/t,v=0,y=0;p>l/u?d+=y=u-(h=l/p)>>1:s+=v=l-(f=u*p)>>1;var b=null===(r=n.shapeModel.getBackgroundFill().getFillInfo())||void 0===r||null===(i=r.image)||void 0===i||null===(o=i.stretch)||void 0===o?void 0:o.fillRect;if(b){var g=n.shapeModel.getImageFillSize().getBackgroundImageSize({width:l,height:u,srcRect:b}),m=g.pl,O=g.pr,k=g.pt,S=g.pb;m+=v,O+=v,k+=y,S+=y,b.l=m/(f+O+m),b.r=O/(f+O+m),b.t=k/(h+S+k),b.b=S/(h+S+k)}else b={b:0,t:0,l:0,r:0};var P={top:d,left:s,width:f,height:h};n.updateProps(P,b)})),g()(d()(n),"updateProps",(function(e,t){Object(O.b)((function(){var r,i,o,a,l=[{style:R({},e)}],u=null===(r=n.shapeModel.getBackgroundFill().getCurrentFill())||void 0===r?void 0:r.fillInfo;n.shapeModel.getBackgroundFill().updateCurrentFill({image:R(R({},u),{},{stretch:{fillRect:t}})}),null===(i=n.shapeModel.selectionService)||void 0===i||null===(o=i.currentSlide)||void 0===o||o.updateElementsProps(l,[n.shapeModel]),null===(a=n.getBorderSketchManager())||void 0===a||a.updatePathListWhenSizeChange(n.shapeModel,l[0])}))})),n.shapeModel=e,n}return u()(r,[{key:"handleCrop",value:function(e){var t;if(e&&m.c.includes(e)){if(e!=="".concat(m.b,"-").concat("normal")){var r=e.replace(new RegExp("".concat(m.b,"-")),"").split("-"),n=i()(r,2),o=n[0],a=n[1];this.cropWithWH(Number(o),Number(a))}var l=this.shapeModel.getBackgroundFill().getFillInfo();null!=l&&null!==(t=l.image)&&void 0!==t&&t.tile||(this.getEditingStateManager().updateElementCropState(!0),Object(S.c)({opername:P.e.DOC_PPT,module:P.d.PC_OBJ,action:P.b.IMG_CUT}))}}},{key:"getEditingStateManager",value:function(){return k.a.getInstance().getAppServices().viewableServiceLayer.editingStateManager}},{key:"getBorderSketchManager",value:function(){var e;return null===(e=k.a.getInstance().getAppServices().editableServiceLayer)||void 0===e?void 0:e.borderSketchManager}}]),r}(m.a)},f6115d1d70:function(e,t,r){"use strict";r("73b854064b"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n=r("176815363d"),i=r.n(n),o=r("1f925d7f50"),a=r.n(o),l=r("9132715560"),u=r.n(l),c=r("6a364eb35c"),d=r.n(c),s=r("547611bd96"),f=r.n(s),h=r("bd29e2df90"),p=r.n(h),v=r("ab5eb40518"),y=r.n(v),b=r("8eec1e4a03"),g=r.n(b),m=r("1b4cdd6a36"),O=r.n(m),k=r("85d0a7609b"),S=r.n(k),P=r("2dc700e1e6"),C=r.n(P),R=(r("f1054791f4"),r("3ef2352f0b")),A=r.n(R),M=(r("8ee19818c4"),r("342844cefa"),r("a2a09da1e3"),r("c6244f7705"),r("081c8cafea"),r("8e7cce0ada"),r("85d48ef22b"),r("2a6f332b5e"),r("8f58e78419")),T=r.n(M),D=r("9541c1076d"),F=r.n(D),E=r("ee6bb53310"),I=r.n(E),j=r("d5c3deb8c7"),w=r("e0e8dd9366"),x=r("24ac29be2d"),L=r.n(x),B=r("3344f1a2e7"),N=r("ada2323558"),U=r("6fdf19cac3"),G=r("eb36e1b9a0"),_=r("405d9ef7a4"),V=r("9657b29818"),H=(r("fce3077cdf"),r("a487fa69e2")),z=r("cd1934c1b5"),W=r("54bdd803dc"),Y=r.n(W),K=r("4c10f0b0ac");function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){S()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z,J,Q,$=function(){function e(t){var r=this;u()(this,e),S()(this,"model",void 0),S()(this,"resetSize",(function(){var e,t,n,i,o=(null===(e=r.model.sdkData)||void 0===e||null===(t=e.props)||void 0===t||null===(n=t.blipFill)||void 0===n||null===(i=n.blip)||void 0===i?void 0:i.embed)||"",a=K.a.getAndUpdateImageOriginalSize(o,r.model.props.src,(function(e){r.updateNextSize(e.width,e.height)}));a&&r.updateNextSize(a.width,a.height)})),S()(this,"getOriginalSize",(function(){var e,t,n,i,o,a=null===(e=r.model.sdkData)||void 0===e||null===(t=e.props)||void 0===t||null===(n=t.blipFill)||void 0===n||null===(i=n.blip)||void 0===i?void 0:i.embed;return null!==(o=K.a.getImageOriginalSize(a||""))&&void 0!==o?o:z.a.getImageSizeFromUrl(r.model.props.src)})),this.model=t}return d()(e,[{key:"getRelativeResize",value:function(){var e;return this.model.isImage()&&(null===(e=this.model)||void 0===e?void 0:e.props.relativeResize)!==H.a.noRelative?H.a.isRelative:H.a.noRelative}},{key:"handleRelativeResize",value:function(e){this.model.updateProps({relativeResize:e?H.a.isRelative:H.a.noRelative})}},{key:"getForegroundImageSize",value:function(e){var t=q(q({},this.model.props.style),e),r=t.width,n=t.height,i=t.srcRect,o=0,a=0,l=0,u=0,c=r,d=n;if(!i)return{pl:o,pr:a,pt:l,pb:u,rw:c,rh:d};var s=i.l,f=void 0===s?0:s,h=i.r,p=void 0===h?0:h,v=i.t,y=void 0===v?0:v,b=i.b,g=void 0===b?0:b,m=Math.round(100*(1-f-p))/100==0;c=r+(o=m?-r/2:r*f/(1-f-p))+(a=m?-r/2:r*p/(1-f-p));var O=Math.round(100*(1-y-g))/100==0;return{pl:o,pr:a,pt:l=O?-n/2:n*y/(1-y-g),pb:u=O?-n/2:n*g/(1-y-g),rw:c,rh:d=n+l+u}}},{key:"updateForegroundImageSize",value:function(e){var t,r,n=this.model.props.style,i=n.width,o=n.height,a=n.srcRect,l=q(q({},this.getForegroundImageSize()),e),u=l.pl,c=l.pt,d=l.rw,s=l.rh,f=null!==(t=e.pr)&&void 0!==t?t:d-i-u,h=null!==(r=e.pb)&&void 0!==r?r:s-o-c;a={l:0===d?0:u/d,r:0===d?1:f/d,t:0===s?0:c/s,b:0===s?1:h/s},this.model.updateProps({style:{srcRect:a}})}},{key:"updateNextSize",value:function(e,t){var r=this,n=this.model.props.style,i=this.model.rootGroupModel||!n.srcRect||this.judgeObjIsZero(n.srcRect)?{nextLeft:n.left||0,nextTop:n.top||0}:this.computeNextLeftTop(n,e,t),o={left:i.nextLeft,top:i.nextTop,width:e,height:t,rotate:0},a=this.model.getFrame().getFrameInfo(),l={};Object.keys(o).forEach((function(e){l[e]=null==a?void 0:a[e]}));var u={l:0,r:0,t:0,b:0};Y()(l,o)&&Y()(u,this.model.props.style.srcRect)||Object(V.b)((function(){r.model.getFrame().updateFrame({frame:o}),r.model.updateProps({style:{srcRect:u}})}))}},{key:"computeNextLeftTop",value:function(e,t,r){var n,i,o,a,l=null!==(n=null===(i=e.srcRect)||void 0===i?void 0:i.l)&&void 0!==n?n:0,u=null!==(o=null===(a=e.srcRect)||void 0===a?void 0:a.t)&&void 0!==o?o:0;return{nextLeft:e.left-l*t,nextTop:e.top-u*r}}},{key:"judgeObjIsZero",value:function(e){return!!e&&Object.values(e).every((function(e){return 0===e}))}}]),e}(),ee=r("3d0dce06fe"),te=r("304396ad9f"),re=r("0e5d467d1a"),ne=r("836e76da54"),ie=r("862b984676"),oe=r("b55230b666"),ae=r("efe327c706");function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){S()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O()(e);if(t){var i=O()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return y()(this,r)}}var de=(Z=Reflect.metadata("design:type",void 0===U.IOperatingGraphicInfo?Object:U.IOperatingGraphicInfo),J=function(e){p()(n,e);var t,r=ce(n);function n(){var e;return u()(this,n),e=r.call(this),S()(f()(e),"props",void 0),S()(f()(e),"editorInstance",void 0),a()(f()(e),"operatingGraphicInfo",Q,f()(e)),S()(f()(e),"video",void 0),S()(f()(e),"audio",void 0),S()(f()(e),"graphicProperty",void 0),S()(f()(e),"imageSizeInstance",void 0),S()(f()(e),"imageCropInstance",void 0),S()(f()(e),"imageEffectInstance",void 0),S()(f()(e),"isImage",(function(){return!(e.audio||e.video||e.isAttachment())})),S()(f()(e),"resetAllProps",(function(t){var r,n,i=e.props.style,o={},a=ue({},t);i.border&&(a=F()(a,{border:{color:null,width:0}}),null===(r=(n=e).getBorder)||void 0===r||r.call(n).handleBorderSpecial(a.border));1!==T()(i,"fillBackground.noFill")&&(a=F()(a,{fillBackground:{noFill:1}})),i.effect&&Object.keys(i.effect).forEach((function(e){o.effect=o.effect||{},o.effect[e]=null})),e.updateAndRemoveProps({style:a},{style:o})})),S()(f()(e),"reset3DProps",(function(){e.removeProps({scene3d:null,shape3d:null})})),e.type=w.d.IMAGE,e.props={src:L.a,style:{left:0,top:0,isImage:!0,width:Object(B.C)(281),height:Object(B.C)(200),opacity:1,position:"absolute"}},e}return d()(n,[{key:"isAttachment",value:function(){var e;return!(null===(e=this.props)||void 0===e||!e.attachment)}},{key:"isAttachmentUploaded",value:function(){var e=T()(this,"props.attachment");return!(null==e||!e.objKey)}},{key:"isMedia",value:function(){return this.isVideo()||this.isAudio()}},{key:"isVideo",value:function(){return!!this.video}},{key:"isAudio",value:function(){return!!this.audio}},{key:"getMediaSize",value:function(){return this.video?this.video.size:this.audio?this.audio.size:void 0}},{key:"getGraphic",value:function(){return this.graphicProperty||(this.graphicProperty=new G.a(this)),this.graphicProperty}},{key:"handleAlpha",value:function(e,t){var r=this;Object(V.b)((function(){var n=r.getBackgroundFill().getFillInfo();null!=n&&n.image&&r.getBackgroundFill().updateCurrentFill({image:ue(ue({},n.image),{},{alpha:String(e.image.alpha)})},null==t?void 0:t.onlyChangeUI),r.updateImageAlpha(e,t)}))}},{key:"handleRotate",value:function(){var e=15;this.props.style.rotate&&(e=this.props.style.rotate+15,e%=360),I()(this,"props.style.rotate",e);var t={style:{rotate:e}};this.updateProps(t)}},{key:"handleResetPicture",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.props.style,i={image:ue(ue(ue({},_.b),_.a),{},{grayscl:null,duotone:null,biLevel:null,luminance:null})};"rect"!==n.bgShape&&(i=F()(i,{bgShape:"rect",controlValues:[]})),r&&1!==n.alpha&&(i=F()(i,{alpha:1})),Object(V.b)((function(){e&&t.getImageSize().resetSize(),t.resetAllProps(i),t.reset3DProps()}))}},{key:"getImageCrop",value:function(){return this.imageCropInstance||(this.imageCropInstance=new te.d(this)),this.imageCropInstance}},{key:"canSetArrowStyle",value:function(){if(!this.pathParser)return!1;var e=this.pathParser.svgPathInRect();return e.length>1?e.some((function(e){return-1===e.svgPath.indexOf("Z")&&-1===e.svgPath.indexOf("z")})):this.getGraphic().isPathOpened(e[0].svgPath)}},{key:"handleReplacePicture",value:function(e){var t=this;if(this.isVideo()){var r=this.getMediaManager();null==r||r.pauseVideoByRegion(this.key,ie.a.EDITOR)}if(Array.isArray(e)&&e.length>0){var n=e[0]||{},i=this.props.style.width;this.props.style.height>0&&i>0&&this.updateForegroundImage({src:n.src,backupSrc:n.backupSrc||"",style:{alpha:1,srcRect:!this.isVideo()&&function(e){if(e.srcRect){var r=e.srcRect,n=r.l,i=void 0===n?0:n,o=r.r,a=void 0===o?0:o,l=r.t,u=void 0===l?0:l,c=r.b;return{l:i,r:a,t:u,b:void 0===c?0:c}}var d=e.width,s=e.height,f=t.props.style.width,h=t.props.style.height,p=f/d,v=h/s,y=p<v?v:p,b=(d*y-f)/(d*y*2),g=(s*y-h)/(s*y*2);return{l:b,r:b,t:g,b:g}}(n),image:{brightness:_.d.BRIGHTNESS.defaultValue,colorTemperature:_.d.COLORTEMPERATURE.defaultValue,contrast:_.d.CONTRAST.defaultValue,saturate:_.d.SATURATE.defaultValue,sharpenSoften:_.d.ClARITY.defaultValue}},imageType:n.imageType})}}},{key:"getImageSize",value:function(){return this.imageSizeInstance||(this.imageSizeInstance=new $(this)),this.imageSizeInstance}},{key:"updateLatex",value:function(e){var t=e,r={width:Object(B.C)(t.width),height:Object(B.C)(t.height)},n=this.props.style,i=n.width,o=n.height,a=n.left+i/2,l=n.top+o/2;this.updateProps({src:t.src,addon:t.addon,style:{alpha:1,srcRect:{l:0,r:0,t:0,b:0},width:r.width,height:r.height,left:a-r.width/2,top:l-r.height/2}})}},{key:"getImageEffect",value:function(){return this.imageEffectInstance||(this.imageEffectInstance=new re.a(this)),this.imageEffectInstance}},{key:"updateStyle",value:function(e){this.updateProps({style:e})}},{key:"updateForegroundImage",value:function(e){if(this.sdkData){var t=this.prepareSDKPropsData(e);ne.a.sdkV3UpdateProps(this.sdkData,t)}}},{key:"updateImageAlpha",value:function(e,t){if(null!=t&&t.onlyChangeUI)I()(this,"props.style.alpha",e.image.alpha),this.previewChange+=1;else{var r={style:{alpha:e.image.alpha}};this.updateProps(r)}}}],[{key:"convertDataSdkToUi",value:(t=i()(A.a.mark((function e(t,r,i,o){var a,l,u;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g()(O()(n),"convertDataSdkToUi",this).call(this,t,r,i,o),l=[],u=ae.a.convertSdkToUi({type:w.d.IMAGE,sdkData:t,uiData:r}),l.push(u),null===(a=r.parent)||void 0===a||!a.asyncConvertChildren){e.next=7;break}return e.next=7,Promise.all(l);case 7:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i){return t.apply(this,arguments)})},{key:"didConvertDataSdkToUi",value:function(e,t,r,i){var o,a;g()(O()(n),"didConvertDataSdkToUi",this).call(this,e,t,r,i),ee.a.applyGrpFill(t),null===(o=t.getMenuManager())||void 0===o||o.event.emit(oe.a.REFRESH_MENU_ITEM_VALUES),null===(a=t.getMenuManager())||void 0===a||a.event.emit(oe.a.REFRESH_GROUP_ITEM_VALUES)}},{key:"convertDataUiToSdk",value:function(e,t,r){ae.a.convertUiToSdk({type:w.d.IMAGE,uiData:e,sdkData:t,rawUiData:r})}}]),n}(N.a),Q=C()(J.prototype,"operatingGraphicInfo",[j.q,Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J);t.a=de},fa06691231:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));r("342844cefa"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("8ee19818c4"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("85d0a7609b"),u=r.n(l),c=(r("4bbb5840d5"),r("dc68b581cd")),d=r("f9193d718f"),s=r("8930941e65"),f=r("e0e8dd9366");function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=function(){function e(t){var r=this;i()(this,e),u()(this,"model",void 0),u()(this,"getStyleProps",(function(e,t,n,i){var o=r.model.props.style,a=o.controlValues,l=o.bgLine,u=i;if(r.validateLineType(n)){if(0!==r.connectedNum()){var d=r.model.getConnectedValidateLineTypeStyle(e,t,n,u);return p(p({},d),{},{operationFrame:d.frame})}l=n.startsWith("bentConnector")?c.a.BENTCONNECTOR3:c.a.CURVEDCONNECTOR3,a=[.5]}return{operationFrame:r.getOffsetFrame(r.updatePointInGroup(e),r.updatePointInGroup(t)),controlValues:a,bgLine:l}})),u()(this,"getOffsetFrame",(function(e,t){var r=0,n=0,i=e.x,o=e.y,a=t.x,l=t.y;if(i>a){var u=i;i=a,a=u,r=1}if(o>l){var c=o;o=l,l=c,n=1}return{left:i,top:o,width:a-i,height:l-o,flipH:r,flipV:n,rotate:0}})),this.model=t}return a()(e,[{key:"getUpdateStyle",value:function(e,t){if(e||t){var r,n,i=null===(r=(n=this.model).getFrame)||void 0===r?void 0:r.call(n).getFrameInfo(!1),o=this.model.getStartEndPoints(i,t),a=o.startP,l=o.endP;if(this.onlyMove()){var u=this.isConnectorInGroup(),c=u?0:null==e?void 0:e.left,d=u?0:null==e?void 0:e.top;return{operationFrame:this.model.getUpdateStylePropsForOnlyMove({left:null!=c?c:0,top:null!=d?d:0})}}return this.getOperationFrameForNotOnlyMove(a,l)}return{operationFrame:null}}},{key:"updatePointInGroup",value:function(e){if(!(!this.model.parent||this.model.parent.type!==f.d.GROUP)){var t=this.model.getFrame().convertFrameOnSlideToSelf({left:e.x,top:e.y,width:0,height:0});e.x=t.left,e.y=t.top}return e}},{key:"validateLineType",value:function(e){return Object(s.a)(e).isString()&&e.startsWith("bentConnector")||Object(s.a)(e).isString()&&e.startsWith("curvedConnector")}},{key:"getOperationFrameForNotOnlyMove",value:function(e,t){var r=e,n=t,i=this.model.props.style.bgLine||c.a.STRAIGNTCONNECTOR1,o=this.getStyleProps(r,n,i),a=o.operationFrame,l=o.bgLine,u=o.controlValues;return this.model.rotateInGroup=null==a?void 0:a.rotate,{controlValues:u,bgLine:l,operationFrame:a}}},{key:"connectedNum",value:function(){var e=0;return this.model.startUIModel&&(e+=1),this.model.endUIModel&&(e+=1),e}},{key:"isConnectorInGroup",value:function(){var e,t,r=null===(e=this.model.startUIModel)||void 0===e?void 0:e.rootGroupModel,n=null===(t=this.model.endUIModel)||void 0===t?void 0:t.rootGroupModel,i=this.model.rootGroupModel;return 1===this.connectedNum()?!(!this.isRootGroupModelSelected(this.model.startUIModel)||(null==i?void 0:i.key)!==(null==r?void 0:r.key))||!(!this.isRootGroupModelSelected(this.model.endUIModel)||(null==i?void 0:i.key)!==(null==n?void 0:n.key)):!(!this.isRootGroupModelSelected(this.model.startUIModel)||!this.isRootGroupModelSelected(this.model.endUIModel)||(null==i?void 0:i.key)!==(null==r?void 0:r.key)&&(null==i?void 0:i.key)!==(null==n?void 0:n.key))}},{key:"isRootGroupModelSelected",value:function(e){var t=null==e?void 0:e.rootGroupModel;return(null==t?void 0:t.selected)&&!(null!=e&&e.selected)}},{key:"onlyMove",value:function(){var e,t;if(this.getEditingStateManager().isDragging&&(1===this.connectedNum()||null!==(e=this.model.startUIModel)&&void 0!==e&&e.selected&&null!==(t=this.model.endUIModel)&&void 0!==t&&t.selected||this.isOnlySelectRootGroupModel()))return!0;return!(!this.getEditingStateManager().isResizing||!this.isOnlySelectRootGroupModel())}},{key:"isOnlySelectRootGroupModel",value:function(){var e,t,r,n,i=null===(e=this.model.startUIModel)||void 0===e?void 0:e.rootGroupModel,o=null===(t=this.model.endUIModel)||void 0===t?void 0:t.rootGroupModel;return!(null==i||!i.selected||null!==(r=this.model.startUIModel)&&void 0!==r&&r.selected||null==o||!o.selected||null!==(n=this.model.endUIModel)&&void 0!==n&&n.selected)}},{key:"getEditingStateManager",value:function(){return d.a.getInstance().getAppServices().viewableServiceLayer.editingStateManager}}]),e}()},fb75408061:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n="addon-",i={NORMAL:"normal",IFRAME:"iframe"}},fc7fcd60bb:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return d})),r.d(t,"c",(function(){return s}));var n=r("14502724a6"),i=r.n(n),o=r("a7888a8b87"),a=r.n(o),l=r("af47f040ba"),u=r("75f19a1449");function c(e,t,r){var n=Object(l.b)(t),i=n.schemeClrs,o=n.variations,a=n.meth;if(i&&o){var c=e%i.length,d=Math.floor(e/i.length),s=i[c],f=o[d%o.length];return new u.a({themeKey:s,lumMod:null==f?void 0:f.lumMod,lumOff:null==f?void 0:f.lumOff,shade:null==f?void 0:f.shade,tint:null==f?void 0:f.tint})}if(i&&r){var h=Object(l.c)(r),p=a===l.a.withinLinearReversed?h.reverse()[e]:h[e];return new u.a({themeKey:i[0],shade:null==p?void 0:p.shade,tint:null==p?void 0:p.tint,lumMod:null==p?void 0:p.lumMod,lumOff:null==p?void 0:p.lumOff})}}function d(e){var t,r,n=(null==e||null===(t=e.fmtScheme)||void 0===t||null===(r=t.lnStyleLst)||void 0===r?void 0:r.ln)||[{}],o=i()(n,1)[0];return a()(o[0])}function s(e){var t={104:{borderScale:3,accentStartIndex:0},130:{borderScale:7,accentStartIndex:3}},r=t[e||104]||t[104];return{borderScale:r.borderScale,accentStartIndex:r.accentStartIndex}}},fe21233dd7:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));r("73b854064b"),r("a84962d637"),r("8a35b54c1d"),r("c554310b5c"),r("bcb5d93d36");var n=r("9132715560"),i=r.n(n),o=r("6a364eb35c"),a=r.n(o),l=r("547611bd96"),u=r.n(l),c=r("bd29e2df90"),d=r.n(c),s=r("ab5eb40518"),f=r.n(s),h=r("1b4cdd6a36"),p=r.n(h),v=r("85d0a7609b"),y=r.n(v),b=(r("8ee19818c4"),r("342844cefa"),r("405d9ef7a4")),g=r("9657b29818"),m=r("2ba7871556"),O=r("0e5d467d1a");function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var i=p()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var C=function(e){d()(r,e);var t=P(r);function r(e){var n;return i()(this,r),n=t.call(this,e),y()(u()(n),"shapeModel",void 0),n.shapeModel=e,n}return a()(r,[{key:"handleImageAlpha",value:function(e,t){var r;this.shapeModel.getBackgroundFill().getFillType()===m.b.ImageFill&&this.shapeModel.getBackgroundFill().updateCurrentFill({image:S(S({},null===(r=this.shapeModel.getBackgroundFill().getCurrentFill())||void 0===r?void 0:r.fillInfo),e.image)},null==t?void 0:t.onlyChangeUI)}},{key:"handleResetPicture",value:function(){var e=this,t=this.shapeModel.getBackgroundFill().getFillInfo();if(null!=t&&t.image){var r=S(S(S({},b.b),b.a),{},{grayscl:!1,duotone:null,biLevel:null,luminance:null});Object(g.b)((function(){var n;null!==(n=t.image)&&void 0!==n&&n.alpha&&e.handleImageAlpha({image:{alpha:1}}),Object.keys(r).forEach((function(e){r[e]=null})),e.shapeModel.updateProps({style:{image:S({},r)}})}))}}}]),r}(O.a)}}]);
//# sourceMappingURL=slide-base~62543e40-39f581.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([[24],{ee33749d07:function(t,e,o){"use strict";o.r(e),o.d(e,"CollectController",(function(){return Y})),o.d(e,"badgeContainerIdName",(function(){return J})),o.d(e,"default",(function(){return q}));var n=o("7273a2dc68"),i=o("69084d01d3"),a=o.n(i),c=o("65558e71fa"),s=o("4f3b15d017"),l=o("575f0b3365"),r=o.n(l),d=o("65c2c320da"),p=o.n(d),u=o("751e425094"),f=o("f35140e0a5"),h=o("dd2b766513"),_=o("8b13fcae36"),C=o("8e8c514bfb"),v=o("b0a47f8926"),g=o("c7530f2183"),b=o("d7a2286b24"),m=function(t,e){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},m(t,e)};function S(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}function O(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,a){function c(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){t.done?o(t.value):i(t.value).then(c,s)}l((n=n.apply(t,e||[])).next())}))}function D(t,e){var o,n,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return l([t,e])}}function l(s){if(o)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(c=0)),c;)try{if(o=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,n=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(i=c.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){c.label=s[1];break}if(6===s[0]&&c.label<i[1]){c.label=i[1],i=s;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(s);break}i[2]&&c.ops.pop(),c.trys.pop();continue}s=e.call(t,c)}catch(t){s=[6,t],n=0}finally{o=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}"function"==typeof SuppressedError&&SuppressedError;var E,T,w,I;function y(){r.a.show({message:Object(n.$t)("当前网络不可用，请检查你的网络设置。"),type:"info",duration:3e3,closable:!0})}!function(t,e){void 0===e&&(e={});var o=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}(".editor-badge-icon-wrapper{border-radius:2px;float:left;margin-left:8px;padding:2px}.editor-badge-icon-wrapper:first-child{margin-left:0}.editor-badge-icon-wrapper:hover{background-color:rgba(0,0,0,.04)}.editor-badge-icon-wrapper.disabled{cursor:not-allowed;opacity:.2}.editor-badge-icon-wrapper.disabled:hover{background-color:transparent}.editor-badge-icon-wrapper .editor-badge-icon-tooltip{display:block}.editor-badge-icon-wrapper .editor-badge-icon{background-repeat:no-repeat;background-size:100% 100%;height:16px;width:16px}.editor-badge-icon-wrapper .editor-badge-icon-star{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23a)'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8 1.693 6.546 4.549c-.14.276-.372.545-.632.749-.236.186-.61.407-1.074.435l-3.232.512 2.394 2.25.008.007c.494.485.69 1.15.69 1.737v.082l-.54 3.291 2.888-1.52a1.46 1.46 0 0 1 .835-.289h.019l.235-.004.21.006.023.002c.123.009.508.04.847.291l2.618 1.484-.535-3.261v-.082c0-.262.06-.564.15-.833.09-.262.251-.62.54-.904l.008-.008 2.394-2.25-3.232-.511c-.464-.028-.838-.25-1.074-.435a2.352 2.352 0 0 1-.632-.749L8 1.693Zm3.257 3.043 4.04.64c.781.128.912.64.39 1.023l-2.996 2.816c-.261.256-.391.768-.391 1.024l.651 3.968c.13.64-.26 1.024-.912.64l-3.388-1.92c-.086-.085-.231-.114-.357-.123l-.164-.005-.194.003c-.14.007-.234.034-.327.125l-3.648 1.92c-.615.362-.998.04-.93-.536l.67-4.072c0-.384-.131-.768-.392-1.024L.313 6.4c-.521-.511-.391-1.023.39-1.023l4.04-.64c.39 0 .781-.384.912-.64L7.479.512C7.609.256 7.869 0 8 0c.13 0 .39.128.521.512l1.824 3.584c.13.256.521.64.912.64Z' fill='%2381868F'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='a'%3E%3Cpath d='M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2Z' fill='%23fff'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E\")}.editor-badge-icon-wrapper .editor-badge-icon-star-yellow{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8.651 12.927c-.13-.128-.39-.128-.52-.128-.261 0-.392 0-.522.128l-3.648 1.92c-.652.384-1.042 0-.912-.64l.651-3.968c0-.384-.13-.768-.39-1.024L.312 6.4c-.521-.511-.391-1.023.39-1.023l4.04-.64c.39 0 .781-.384.912-.64L7.479.512C7.609.256 7.869 0 8 0c.13 0 .39.128.521.512l1.824 3.584c.13.256.521.64.912.64l4.04.64c.781.128.912.64.39 1.023l-2.996 2.816c-.261.256-.391.768-.391 1.024l.651 3.968c.13.64-.26 1.024-.912.64l-3.388-1.92Z' fill='%23FFAB00'/%3E%3C/svg%3E\")}.editor-badge-icon-wrapper .editor-badge-icon-add-file{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M1.85 15H10v-1H2V2h8.256L13 4.898V9h1V4.5L10.686 1H1.851C1.38 1 1 1.348 1 1.778v12.444c0 .43.38.778.85.778ZM14 12v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2Z' fill='%2381868F'/%3E%3C/svg%3E\")}.editor-badge-icon-wrapper .editor-badge-icon-move-file{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='m7.553 3.894.21.106H15v10H1V3h4.764l1.789.894ZM0 3a1 1 0 0 1 1-1h4.764a1 1 0 0 1 .447.106L8 3h7a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V3Zm9 8.28V9.5H4v-1h5V6.72c0-.122.093-.22.208-.22a.2.2 0 0 1 .133.051l2.584 2.28c.088.078.1.216.027.31l-.027.028-2.584 2.28a.2.2 0 0 1-.293-.028A.228.228 0 0 1 9 11.28Z' fill='%2381868F'/%3E%3C/svg%3E\")}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jb21wb25lbnRzL1BjSGVhZGVyQmFkZ2Uvc3R5bGUvaW5kZXgubGVzcyIsImluZGV4Lmxlc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsMkJBR0ksaUJBQUEsQ0FGQSxVQUFBLENBQ0EsZUFBQSxDQUVBLFdDQUosQ0RFSSx1Q0FDSSxhQ0FSLENER0ksaUNBQ0ksZ0NDRFIsQ0RJSSxvQ0FFSSxrQkFBQSxDQURBLFVDRFIsQ0RLSSwwQ0FDSSw0QkNIUixDRGpCQSxzREF3QlEsYUNKUixDRHBCQSw4Q0ErQlEsMkJBQUEsQ0FEQSx5QkFBQSxDQURBLFdBQUEsQ0FEQSxVQ0ZSLENEMUJBLG1EQW1DUSxnd0NDTlIsQ0Q3QkEsMERBdUNRLDZsQkNQUixDRGhDQSx1REE0Q1EsMldDVFIsQ0RuQ0Esd0RBZ0RRLGloQkNWUiIsImZpbGUiOiJpbmRleC5sZXNzIn0= */"),(T=E||(E={}))[T.DOC_STATUS_NORMAL=0]="DOC_STATUS_NORMAL",T[T.DOC_STATUS_DELETE=1]="DOC_STATUS_DELETE",T[T.DOC_STATUS_TRASH=2]="DOC_STATUS_TRASH",T[T.DOC_STATUS_HIDDEN=3]="DOC_STATUS_HIDDEN",T[T.DOC_STATUS_TRANS=4]="DOC_STATUS_TRANS",T[T.DOC_STATUS_IMPORT=5]="DOC_STATUS_IMPORT",T[T.DOC_STATUS_CHEKING=6]="DOC_STATUS_CHEKING",T[T.DOC_STATUS_FORBIDDEN=7]="DOC_STATUS_FORBIDDEN",T[T.DOC_STATUS_IMPORT_FAILED=8]="DOC_STATUS_IMPORT_FAILED",T[T.DOC_STATUS_COPY=9]="DOC_STATUS_COPY",T[T.DOC_STATUS_COPY_FAILED=10]="DOC_STATUS_COPY_FAILED",T[T.DOC_STATUS_PREPARE=11]="DOC_STATUS_PREPARE",T[T.DOC_STATUS_HIDDEN_UNTIL_MODIFY=12]="DOC_STATUS_HIDDEN_UNTIL_MODIFY",T[T.DOC_STATUS_FILE_UPLOADING=13]="DOC_STATUS_FILE_UPLOADING",function(t){t[t.QQ=1]="QQ",t[t.WX=2]="WX",t[t.WW=3]="WW",t[t.QFYF=4]="QFYF",t[t.QQ_Group=102]="QQ_Group",t[t.DISSCUSS=103]="DISSCUSS",t[t.AUTH_GROUP=104]="AUTH_GROUP",t[t.DEPARTMENT=105]="DEPARTMENT"}(w||(w={}));var k="//".concat(location.hostname,"/cgi-bin/online_docs/"),L="//".concat(location.hostname,"/cgi-go/"),U="DOC_GET_COLLECT",A="MOVE_INFO",R="DOC_COLLECT",M={DOC_GET_COLLECT_ENTRY_EXIST:315805},j="TAKE_DOC_EFFECT",F=((I={})[U]="".concat(k,"doc_getcollect"),I[A]="".concat(L,"can/move"),I[R]="".concat(k,"doc_collect"),I[j]="".concat(k,"doc_humtrans"),I);function N(t,e,o,n){var i={domain_id:t,pad_id:e,xsrf:Object(f.getXsrf)()};Object(u.ajaxGet)(F[U],i).then((function(t){t&&0===t.retcode?o&&o(t):n&&n(t&&t.retcode)})).catch((function(t){n&&n(!1)}))}function x(t,e,o,n,i){var a={domain_id:t,pad_id:e,is_cancel:o?1:0,xsrf:Object(f.getXsrf)()};Object(u.ajaxPost)(F[R],a).then((function(t){[0,M.DOC_GET_COLLECT_ENTRY_EXIST].indexOf(null==t?void 0:t.retcode)>-1?n&&n(t):i&&i(t&&t.retcode)})).catch((function(t){i&&i(!1)}))}function Q(t,e,o,n){var i={domain_id:t,pad_id:e,xsrf:Object(f.getXsrf)()};return Object(u.ajaxPost)(F[j],i).then((function(t){return t&&0===t.retcode?(window.SLR&&window.SLR.dispatch("DOC_HUMTRANS_DONE"),o&&o(t)):n&&n(t&&t.retcode)})).catch((function(){return n&&n(!1)}))}var P,G=function(t){function e(e){var o=t.call(this,e)||this;o.initialed=!1,o.checkIsCollected=Object(c.a)((function(){var t=o.props,e=t.domainId,n=t.localPadId;N.call(o,e,n,(function(t){var e=!!t.is_collected;e!==o.state.isCollected&&o.setState({isCollected:e})}))}),1e3),o.onClickStar=function(){return O(o,void 0,void 0,(function(){var t,e,o,i,a=this;return D(this,(function(c){switch(c.label){case 0:return this.props.online?this.props.checkLogin()?this.props.onClickStar?[4,this.props.onClickStar()]:[3,2]:[2]:(y(),[2]);case 1:c.sent(),c.label=2;case 2:return this.initialed?(this.state.isDoCollecting||(this.setDoCollect(!0),t=this.props,e=t.domainId,o=t.localPadId,i=this.state.isCollected,x.call(this,e,o,i,(function(){a.setDoCollect(!1),a.onCollect(i)}),(function(){a.setDoCollect(!1),r.a.show({type:"error",duration:3e3,message:Object(n.$t)("操作失败，请稍后重试。"),autoClose:!0})})),Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:i?"star_light_cancel":"star_clk"}),Object(h.tdwReport)({opername:"doc_menubar",module:"add_star_button",action:"click",ver5:i?2:1})),[2]):[2]}}))}))},o.state={isCollected:!1,isDoCollecting:!1};var i=o.props,a=i.domainId,s=i.localPadId;return N.call(o,a,s,(function(t){var e=!!t.is_collected;o.setState({isCollected:e},(function(){o.initialed=!0})),e&&Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"star_light_expo"})})),o}return S(e,t),e.prototype.setDoCollect=function(t){this.setState({isDoCollecting:!!t})},e.prototype.onCollect=function(t){if(t)this.setState({isCollected:!1}),r.a.show({type:"success",duration:3e3,message:Object(n.$t)("已取消收藏"),autoClose:!0});else{this.setState({isCollected:!0});var e=this.props.isToBUser;r.a.show({type:"success",duration:5e3,message:Object(n.$t)("已添加到收藏文档"),action:e&&s.default.isWxWork?"":Object(n.$t)("查看"),onClickAction:function(){Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"star_suc_toast_clk"}),setTimeout((function(){var t=e?"//".concat((null===C.npmConfig||void 0===C.npmConfig?void 0:C.npmConfig.WECOM_DOMAIN)||"doc.weixin.qq.com","/home/recent?tab=collect"):"//".concat(location.hostname,"/desktop/stared");Object(_.tencentDocOpenUrlForAll)({url:t})}),100)},autoClose:!0}),Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"star_suc_toast_expo"})}},e.prototype.render=function(){this.initialed&&this.checkIsCollected();var t="editor-badge-icon editor-badge-icon-star";return this.state.isCollected&&(t+=" editor-badge-icon-star-yellow"),a.a.createElement("div",{className:"editor-badge-icon-wrapper ".concat(this.props.online?"":"disabled")},a.a.createElement(p.a,{className:"editor-badge-icon-tooltip",title:this.state.isCollected?Object(n.$t)("取消收藏文档"):Object(n.$t)("添加收藏文档"),trigger:"hover"},a.a.createElement("div",{className:t,onClick:this.onClickStar})))},e}(i.Component);!function(t){t[t.OUTOF=0]="OUTOF",t[t.IN=1]="IN",t[t.SAFE=2]="SAFE"}(P||(P={}));var B="editor-badge-icon-add-file",H="editor-badge-icon-move-file",V=window,Z=function(t){function e(e){var o=t.call(this,e)||this;return o.onClickMove=function(){var t,e;Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:o.state.iconClass===H?"move_to_clk":"add_to_clk",ver12:o.props.isDisable?"1":"2"}),o.props.online?o.props.checkLogin()&&(o.props.isDisable||(null===(e=(t=o.props).onClickMove)||void 0===e||e.call(t),o.doGetMoveInfo((function(){1===o.state.status?r.a.show({type:"error",duration:5e3,message:Object(n.$t)("获取文件夹信息出错，请刷新重试。"),action:Object(n.$t)("刷新"),onClickAction:function(){var t=Object(_.getMultUrl)(location.href);window.location.replace(t)},autoClose:!0}):2===o.state.status?(r.a.show({type:"info",duration:5e3,message:Object(n.$t)("本文已有多个快捷方式，请前往首页整理。"),action:Object(n.$t)("去整理"),onClickAction:function(){Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"move_to_toast_golist_clk"});var t="//".concat(location.hostname,"/desktop/search?keyword=").concat(encodeURIComponent(o.props.padTitle),"&search_hl_padid=").concat(V.clientVars.localPadId);Object(_.tencentDocOpenUrlForAll)({url:t})},autoClose:!0}),Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"move_to_toast_golist_expo"})):4===o.state.status?r.a.show({type:"info",duration:5e3,message:Object(n.$t)("共享文档信息同步中，请稍后重试。"),autoClose:!0}):5===o.state.status?Object(v.showSizeLimitDialog)(!0):6===o.state.status?Object(v.showSizeLimitDialog)(!1):v.default.show({docInfo:{folder_id:"",list_info_type:1,parent_folder_id:o.state.folderId,is_owner:o.props.isCreator,doc_type:"sheet"===o.props.padType?1:"form"===o.props.padType?2:0,parent_folder_policy:o.state.folderPolicy,collaboration_flag:o.state.collaboration_flag,is_my_folder:o.state.isMyFolder,domain_id:o.props.domainId,pad_id:o.props.localPadId},operationType:o.isShowMove()?v.OPERATION_TYPE.MOVE:v.OPERATION_TYPE.ADD_TO,addSuccessCb:function(){var t,e;o.setState({iconClass:H}),null===(e=(t=o.props).addSuccessCb)||void 0===e||e.call(t)}})})))):y()},o.state={iconClass:o.getDefaultIconClass(),status:-1,folderId:"",parentFolderId:"",folderPolicy:0,collaboration_flag:P.OUTOF,isMyFolder:!1},o.isDoGetting=!1,o.props.isDisable||o.doGetMoveInfo((function(){var t;o.setState({iconClass:o.isShowMove()?H:B}),window.dispatchEvent(null===(t=o.props)||void 0===t?void 0:t.createEvent("pcHeaderBadge:didGetMoveInfo"))})),o.addTencentDocsClientListener(),o}return S(e,t),e.prototype.notifyTencentDocsClient=function(){var t;if(s.default.isElectronTencentDocsClient){var e=this.props.isDisable||!this.props.online,o=!e&&this.state.iconClass===H,n=!e&&this.state.iconClass===B&&!this.props.isHideAddTo;null===(t=null==V?void 0:V.mqq)||void 0===t||t.invoke("docx","breadcrumbSet",{canMove:o,canShortcuts:n},(function(t){console.log("window.mqq.invoke.docx.breadcrumbSet",t)}))}},e.prototype.addTencentDocsClientListener=function(){var t,e,o=this;s.default.isElectronTencentDocsClient&&(null===(t=null==V?void 0:V.mqq)||void 0===t||t.addEventListener("pc-titlebar_move",(function(){o.state.iconClass===H&&o.onClickMove()})),null===(e=null==V?void 0:V.mqq)||void 0===e||e.addEventListener("pc-titlebar_add-shortcut",(function(){o.state.iconClass===B&&o.onClickMove()})))},e.prototype.getDefaultIconClass=function(){var t=this.props,e=t.isDisable,o=t.isCreator,n=t.isOwner;return e?o?H:B:"boolean"==typeof n?n?H:B:""},e.prototype.doGetMoveInfo=function(t,e){var o=this;this.isDoGetting||(e=e||t,this.isDoGetting=!0,function(t,e,o,n){var i={domainId:t,padId:e,xsrf:Object(f.getXsrf)()};Object(u.ajaxGet)(F[A],i).then((function(t){t&&0===t.retcode&&t.data?o&&o(t):n&&n(t&&t.retcode)})).catch((function(t){n&&n(!1)}))}(this.props.domainId,this.props.localPadId,(function(e){o.isDoGetting=!1,o.setState({status:0,folderId:e.data.folder_info.folder_id,parentFolderId:e.data.folder_info.parent_folder_id,folderPolicy:e.data.folder_info.folder_policy,collaboration_flag:e.data.folder_info.collaboration_flag||P.OUTOF,isMyFolder:e.data.folder_info.is_my_folder}),null==t||t()}),(function(t){o.isDoGetting=!1,1e3===t?o.setState({status:2}):1004===t?o.setState({status:3,folderId:"",parentFolderId:"",folderPolicy:0,isMyFolder:!1}):1005===t?o.setState({status:4}):20010===t?o.setState({status:5}):20013===t?o.setState({status:6}):o.setState({status:1}),null==e||e()})))},e.prototype.isShowMove=function(){return 0===this.state.status&&(this.props.isOwner||this.state.isMyFolder)||2===this.state.status},e.prototype.render=function(){this.notifyTencentDocsClient();var t="";return this.state.iconClass!==H&&this.state.iconClass!==B||(Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:this.state.iconClass===H?"move_to_expo":"add_to_expo",ver12:this.props.isDisable?"1":"2"}),t=this.state.iconClass===H?Object(n.$t)("移动"):Object(n.$t)("添加到我的文档")),this.state.iconClass===B&&this.props.isHideAddTo?null:a.a.createElement("div",{className:"editor-badge-icon-wrapper ".concat(this.props.isDisable||!this.props.online?"disabled":"")},a.a.createElement(p.a,{className:"editor-badge-icon-tooltip",title:t,trigger:"hover"},a.a.createElement("div",{className:"editor-badge-icon ".concat(this.state.iconClass),onClick:this.onClickMove})))},e}(i.Component),$=window,W=function(){function t(t){var e=this;this.disableMove=this.isDocNotEffect(),this.checkLogin=function(){return!(!1===e.props.isLogin||"function"==typeof e.props.isLogin&&!e.props.isLogin())||(r.a.show({type:"info",duration:5e3,message:Object(n.$t)("你只能查看此文档，登录后可进行更多操作。"),action:Object(n.$t)("立即登录"),onClickAction:function(){var t,o;null===(o=(t=e.props).doLogin)||void 0===o||o.call(t)},autoClose:!0}),!1)},this.onClickStar=function(){e.doTakeDocEffect()},this.onClickMove=function(){e.doTakeDocEffect()},this.props=t,this.disableMove&&$.SLR&&$.SLR.listen("DOC_HUMTRANS_DONE",(function(){e.disableMove=!1}))}return t.prototype.doTakeDocEffect=function(){var t=this.props,e=t.domainId,o=t.localPadId;this.isDocNotEffect()&&($.clientVars.docStatus=E.DOC_STATUS_NORMAL,Q(e,o))},t.prototype.isDocNotEffect=function(){var t;return(null===(t=$.clientVars)||void 0===t?void 0:t.docStatus)===E.DOC_STATUS_HIDDEN_UNTIL_MODIFY},t}(),Y=function(){function t(t){var e=this;this.initialed=!1,this.isCollect=!1,this.isDoCollecting=!1,this.onClickStar=function(){if(e.commonController.checkLogin()&&(e.commonController.onClickStar(),e.initialed&&!e.isDoCollecting)){e.setDoCollect(!0);var t=e.props,o=t.domainId,i=t.localPadId,a=e.isCollect;x.call(e,o,i,a,(function(){e.setDoCollect(!1),e.onCollect(a)}),(function(){e.setDoCollect(!1),r.a.show({type:"error",duration:3e3,message:Object(n.$t)("操作失败，请稍后重试。"),autoClose:!0})})),Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:a?"star_light_cancel":"star_clk"}),Object(h.tdwReport)({opername:"doc_menubar",module:"add_star_button",action:"click",ver5:a?2:1})}},this.props=t;var o=t.isLogin,i=t.doLogin,a=t.domainId,c=t.localPadId;this.commonController=new W({isLogin:o,doLogin:i,domainId:a,localPadId:c}),N.call(this,a,c,(function(t){e.initialed=!0,e.isCollect=!!t.is_collected,t.is_collected&&Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"star_light_expo"})}),(function(){e.initialed=!0}))}return t.prototype.setDoCollect=function(t){this.isDoCollecting=!!t},t.prototype.onCollect=function(t){t?(this.isCollect=!1,r.a.show({type:"success",duration:3e3,message:Object(n.$t)("已取消收藏"),autoClose:!0})):(this.isCollect=!0,r.a.show({type:"success",duration:5e3,message:Object(n.$t)("已添加到收藏文档"),action:Object(n.$t)("查看"),onClickAction:function(){Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"star_suc_toast_clk"}),setTimeout((function(){var t="//".concat(location.hostname,"/desktop/stared");Object(_.tencentDocOpenUrlForAll)({url:t})}),100)},autoClose:!0}),Object(h.tdwReport)({opername:"doc_manage",module:"detail",action:"star_suc_toast_expo"}))},t}();Object(n.scL10nIniter)();var X=b.default.getInstance(),J="badge-container",z=window,q=function(t){function e(e){var o,i=this;(i=t.call(this,e)||this).checkLogin=function(){return!(!1===i.props.isLogin||"function"==typeof i.props.isLogin&&!i.props.isLogin())||(r.a.show({type:"info",duration:5e3,message:Object(n.$t)("你只能查看此文档，登录后可进行更多操作。"),action:Object(n.$t)("立即登录"),onClickAction:function(){var t,e;null===(e=(t=i.props).doLogin)||void 0===e||e.call(t)},autoClose:!0}),!1)},i.onClickStar=function(){return O(i,void 0,void 0,(function(){return D(this,(function(t){return[2,this.doTakeDocEffect()]}))}))},i.onClickMove=function(){i.doTakeDocEffect()},i.createEvent=function(t){var e;return"function"==typeof Event?e=new Event(t):(e=document.createEvent("Event")).initEvent(t,!0,!0),Object.assign(e,{data:{el:"#".concat(J)}}),e},i.networkChange=function(t){"online"===t?!i.state.online&&i.setState({online:!0}):i.state.online&&i.setState({online:!1})};var a=e.canCollect,c=void 0!==a&&a;return i.state={online:g.network.isOnline,disableMove:i.isDocNotEffect(),showCollect:!!X.getConfig("titlebar.collect")&&c,showMove:!!X.getConfig("titlebar.move")},i.state.disableMove&&(null===(o=z.SLR)||void 0===o||o.listen("DOC_HUMTRANS_DONE",(function(){i.setState({disableMove:!1})}))),i}return S(e,t),e.prototype.doTakeDocEffect=function(){return O(this,void 0,void 0,(function(){var t,e,o;return D(this,(function(n){return t=this.props,e=t.domainId,o=t.localPadId,this.isDocNotEffect()?(z.clientVars.docStatus=0,[2,Q(e,o)]):[2]}))}))},e.prototype.isDocNotEffect=function(){var t;return 12===(null===(t=z.clientVars)||void 0===t?void 0:t.docStatus)},e.prototype.componentDidMount=function(){window.dispatchEvent(this.createEvent("pcHeaderBadge:componentDidMount")),g.network.changeEnd(this.networkChange)},e.prototype.componentWillUnmount=function(){g.network.remove(this.networkChange)},e.prototype.render=function(){var t=this.props,e=t.user,o=t.isHideBadgeButton,n=void 0!==o&&o,i=t.domainId,c=t.localPadId,s=t.isToBUser,l=this.state,r=l.showCollect,d=l.showMove,p=l.disableMove,u=n&&(null==e?void 0:e.uid_source)===w.WW;return a.a.createElement("div",{id:J},r&&!u?a.a.createElement(G,{isToBUser:s,domainId:i,online:this.state.online,localPadId:c,onClickStar:this.onClickStar,checkLogin:this.checkLogin}):null,d&&!s?a.a.createElement(Z,{domainId:i,localPadId:c,isCreator:this.props.isCreator,isOwner:this.props.isOwner,padType:this.props.padType,padTitle:this.props.padTitle,online:this.state.online,isDisable:p,onClickMove:this.onClickMove,addSuccessCb:this.props.addSuccessCb,checkLogin:this.checkLogin,isHideAddTo:u,createEvent:this.createEvent}):null)},e}(i.Component)}}]);
//# sourceMappingURL=slide-24-690ef4.js.map